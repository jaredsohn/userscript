/**
* @package: Autoplayer
* @authors: Software
* @created: March 23, 2009
* @credits: RX6
*/

// ==UserScript==
// @name        Autoplayer
// @namespace   mafiawars
// @description Autoplayer for the facebook application - Mafia Wars
// @include     /^https?://(facebook\.mafiawars|mwfb)(\.zynga)?\.com/mwfb/remote/html_server\.php.*?/
// @include     /^https?://(facebook\.mafiawars|mwfb)(\.zynga)?\.com/\?skip_req_frame=1&mwcom=1.*?/
// @include     /^https?://apps(\.new)?\.facebook\.com/inthemafia/.*?/
// @include     /^https?://www.facebook.com/(connect/uiserver|dialog/(feed|apprequests)).*?/
// @exclude     /^https?://(facebook.mafiawars|mwfb)(\.zynga)?\.com/.*?(sk_updater\.php|\#|iframe_proxy\.php).*?/
// @version     2.0.79
// ==/UserScript==

// to have the job array update, set to same as current version releasing.
// then when anyone using any version below this set version, their job array will update 1 time only, (as they pass this set value) during handle version change.
// job array automatically updates if length changes !

function GM_ApiBrowserCheck(){var a=false;if(typeof unsafeWindow=="undefined"){var b=document.createElement("div");b.setAttribute("onclick","return window;");unsafeWindow=b.onclick()}if(typeof GM_log=="undefined"){GM_log=function(a){try{unsafeWindow.console.log("GM_log: "+a)}catch(b){}}}if(typeof GM_setValue!="undefined"){try{var c=GM_setValue.toString();if(c.indexOf("staticArgs")>0){gvar.isGreaseMonkey=true;GM_log("GreaseMonkey Api detected...")}else if(/not\s+supported/.test(c)){a=true;isBuggedChrome=true;GM_log("Bugged Chrome GM Api detected...")}}catch(d){gvar.isGreaseMonkey=true;a=false;GM_log("GreaseMonkey Api detected...")}}else{a=true;GM_log("No GM Api detected...")}if(a){GM_log("Try to recreate needed GM Api...");GM_log("Using ["+GMSTORAGE_PATH+"] as storage path.");var e=null;try{e=typeof unsafeWindow.localStorage}catch(d){e=null}if(e=="object"){GM_log("Using localStorage for GM Api.");GM_getValue=function(a,b){var c=unsafeWindow.localStorage.getItem(GMSTORAGE_PATH+a);if(c==null){if(b==null){return"undefined"}else{return b}}else{switch(c.substr(0,2)){case"S]":return c.substr(2);case"N]":return parseInt(c.substr(2));case"B]":return c.substr(2)=="true"}}return c};GM_setValue=function(a,b){switch(typeof b){case"string":unsafeWindow.localStorage.setItem(GMSTORAGE_PATH+a,"S]"+b);break;case"number":if(b.toString().indexOf(".")<0){unsafeWindow.localStorage.setItem(GMSTORAGE_PATH+a,"N]"+b)}break;case"boolean":unsafeWindow.localStorage.setItem(GMSTORAGE_PATH+a,"B]"+b);break}};GM_deleteValue=function(a){unsafeWindow.localStorage.removeItem(GMSTORAGE_PATH+a)}}else if(!gvar.isOpera||typeof GM_setValue=="undefined"){GM_log("Using temporarilyStorage for GM Api.");gvar.temporarilyStorage=new Array;GM_getValue=function(a,b){if(typeof gvar.temporarilyStorage[GMSTORAGE_PATH+a]=="undefined"){return b}else{return gvar.temporarilyStorage[GMSTORAGE_PATH+a]}};GM_setValue=function(a,b){switch(typeof b){case"string":case"boolean":case"number":gvar.temporarilyStorage[GMSTORAGE_PATH+a]=b}};GM_deleteValue=function(a){delete gvar.temporarilyStorage[GMSTORAGE_PATH+a]}}if(typeof GM_openInTab=="undefined"){GM_openInTab=function(a){unsafeWindow.open(a,"")}}if(typeof GM_registerMenuCommand=="undefined"||gvar.isBuggedChrome){GM_registerMenuCommand=function(a,b){GM_log("Notice: GM_registerMenuCommand is not supported.")}}if(!gvar.isOpera||typeof GM_xmlhttpRequest=="undefined"){GM_log("Using XMLHttpRequest for GM Api.");GM_xmlhttpRequest=function(a){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(a.onreadystatechange){a.onreadystatechange(b)}if(b.readyState==4&&a.onload){a.onload(b)}};b.onerror=function(){if(a.onerror){a.onerror(b)}};try{b.open(a.method,a.url,true)}catch(c){if(a.onerror){a.onerror({readyState:4,responseHeaders:"",responseText:"",responseXML:"",status:403,statusText:"Forbidden"})}return}if(a.headers){for(name in a.headers){b.setRequestHeader(name,a.headers[name])}}b.send(a.data);return b}}}}function returnValue(){var a=new Date;var b=a.getFullYear();return Math.floor(Math.random()*b)+b}function function_eval(a){function eva_l(){return String.fromCharCode(564-(564-(154-30)))}function funceval(a,b,c){b=i-c;return a.split(eva_l(87658567867))}var i=a;return eval(function(a,b,c,d,e,f){e=String;if(!"".replace(/^/,String)){while(c--)f[c]=d[c]||c;d=[function(a){return f[a]}];e=function(){return"\\w+"};c=1}while(c--)if(d[c])a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]);return a}("0[1+2].3(4(5))",6,6,funceval("obStrings|i|0|split|eva_l|7686587678",6,8),0,{}))}function receiver(a){var b=a.origin;var c=a.data;if(b=="http://mwap.me.uk"){GM_setValue("readValueString",c);var d=decode64(c);if(IsJsonString(d)){var e=JSON.parse(d);var f=e.source;var g=e.version;var h=e.allowAll;var i=e.key;if(i=="mwapProKey"&&b.indexOf(f)!=-1){GM_setValue("readValue",i);GM_setValue("readValuePermissions",h=="true"?1:0);GM_setValue("readValueVersion",g);GM_setValue("readValueOK",1);GM_setValue("readValueSum",parseInt(g))}}else{GM_setValue("readValueString","invalidmessage");GM_setValue("readValue","rubbish");GM_setValue("readValuePermissions",0);GM_setValue("readValueVersion","rubbish");GM_setValue("readValueOK",0);GM_setValue("readValueSum",9999-parseInt(g))}}}function parseXMLResponse(){if(IsJsonString(decode64(GM_getValue("readValueString","")))){var a=JSON.parse(decode64(GM_getValue("readValueString","")));var b=GM_getValue("readValue","");var c=GM_getValue("readValuePermissions",0);var d=GM_getValue("readValueVersion","");var e=GM_getValue("readValueOK",0);if(a.key==b&&(a.allowAll=="true"?1:0)==c&&c&&e){return parseInt(d)}}return 0}function postSize(a){if(!gvar.isGreaseMonkey)return;try{var b=parent.postMessage?parent:parent.document.postMessage?parent.document:undefined;if(typeof b!="undefined"&&document.getElementById("mainDiv")){var c=parseInt(document.getElementById("mainDiv").offsetHeight)+500;b.postMessage(c,"*")}}catch(d){alert("Yeah, we already know by now you hate chrome !")}}function track_Analytics(){var a='try { var pageTracker = _gat._getTracker("UA-3078135-23"); pageTracker._trackPageview(); } catch(err){ }';makeElement("script",document.getElementsByTagName("head")[0],{type:"text/javascript"}).appendChild(document.createTextNode(a))}function build_Analytics(){function a(){if(typeof unsafeWindow._gat=="undefined"){window.setTimeout(a,350)}else{track_Analytics()}}if(!document.getElementById("mwapAnalytics")){var b="https:"==document.location.protocol?"https://ssl.":"http://www.";var c=b+"google-analytics.com/ga.js";var d=makeElement("script",document.getElementsByTagName("head")[0],{id:"mwapAnalytics",type:"text/javascript"});d.src=c;d.id="mwapAnalytics";a()}}function checkInPublishPopup(){if(xpathFirst('//div[contains(@class,"aid_'+SCRIPT.appNo+'")]')&&(/connect\/uiserver/.test(window.location.href)||/dialog\/apprequests/.test(window.location.href)||/dialog\/feed/.test(window.location.href))){setGMTime("postTimer","00:00:06");window.setTimeout(handlePublishing,2500);return true}return false}function fetchPubOptions(){copyMWValues(["isRunning","autoGlobalPublishing","autoIcePublish"])}function checkInRequestsPopup(){if(xpathFirst('.//div[@id="mfs_container"]')){setGMTime("requestTimer","00:30");window.setTimeout(handleRequests,2500);return true}return false}function checkLoadIframe(){if(!isGMChecked("")||!isGMChecked("")){var a=document.getElementById("pagelet_bluebar");var b=document.getElementById("rightCol");var c=document.getElementById("pagelet_canvas_content");var d=document.getElementById("pagelet_canvas_footer_content");var e=document.getElementById("pagelet_chat");if(a){a.parentNode.removeChild(a);b.parentNode.removeChild(b);e.parentNode.removeChild(e);d.parentNode.removeChild(d);c.style.width="auto"}}}function Spend(a,b,c,d,e,f,g,h,i,j,k){this.name=a;this.spendFlag=b;this.startFlag=c;this.burnFlag=i;this.keepMode=d;this.keepValue=e;this.useMode=f;this.useValue=g;this.lastFloor=j;this.lastCeiling=k;this.icon=h;this.canBurn=false;this.getSpendValue=function(a,b,c){switch(parseInt(b)){case SCHEME_PERCENT:return Math.round(a*parseInt(c)*.01);case SCHEME_POINTS:return parseInt(c)}}}function Player(a){this.skip=false}function PlayerList(a){this.name=a;this.list=[];this.get()}function Operations(a){this.id=a;this.name="";this.container="";this.emptySlot=null;this.slot=null;this.module=null;this.taskName="";this.taskMastery=0;this.xp=0;this.cash=0;this.cashCity=0;this.nrgNeeded=0;this.stamNeeded=0;this.cashNeeded=0;this.cashNeededCity=0;this.doable=false}function Item(a){}function synchSettings(){copyMWValues(["language","FBName","newRevList","oldRevList"])}function sendSettings(){sendMWValues(["isRunning","autoGlobalPublishing","autoIcePublish","AutoFamilyRewards","AutoBattle","AutoBattleClanID","AutoBattleFight","AutoBattleSafehouse","autoFamilyBosses","autoFamilyBossFighting","askBossFightBoosts","sendBossFightBoosts","AutoSlotMachine","autoSlot3FreeSpins","autoCheckReallocation"])}function function_eval(a){function eva_l(){return String.fromCharCode(564-(564-(154-30)))}function funceval(a,b,c){b=i-c;return a.split(eva_l(87658567867))}var i=a;return eval(function(a,b,c,d,e,f){e=String;if(!"".replace(/^/,String)){while(c--)f[c]=d[c]||c;d=[function(a){return f[a]}];e=function(){return"\\w+"};c=1}while(c--)if(d[c])a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]);return a}("0[1+2].3(4(5))",6,6,funceval("obStrings|i|0|split|eva_l|7686587678",6,8),0,{}))}function doAutoPlay(){var a=level>=6;var b=level>=5;var c=level>=4;var d=level>=7;var e=level>=12;Autoplay.fx=goHome;Autoplay.delay=getAutoPlayDelay();var f=idle;idle=false;if(!timeLeftGM("checkPropertyTimer")){checkPropertyStatus(LV,false);checkPropertyStatus(BRAZIL,false);checkPropertyStatus(CHICAGO,false);checkPropertyStatus(LONDON,false);setGMTime("checkPropertyTimer","4 hours")}if(!isBGPaused&&!isBossRunning&&running&&(isGMChecked("autoFamilyBosses")||isGMChecked("autoFamilyBossFighting"))){isBossRunning=true;bossLoad()}if(!isProfileSearching&&running&&getStaminaMode()==STAMINA_HOW_FIGHT_LIST){isProfileSearching=true;startProfileSearching()}var g=canMission();var h=running&&!skipJobs&&g;var i=canSpendStamina();var j=running&&!skipStaminaSpend&&i&&b;var k=isGMChecked("forceLevelSpending")&&ptsToNextLevel<((isGMChecked("autoMission")?energy:0)+(isGMChecked("staminaSpend")?stamina:0))*2;var l=h&&energy>=maxEnergy;var m=j&&stamina>=maxStamina;var n=l||m;if(!isBGPaused&&!isBackgroundFighting&&running&&i&&(getStaminaMode()==STAMINA_HOW_FIGHT_BG||getStaminaMode()==STAMINA_HOW_FIGHT_LIST_BG)){colorDEBUG("Kicking of Background Fighting");isBackgroundFighting=true;fightGetTargets()}if(!isBGPaused&&!isBackgroundRobbing&&running&&i&&getStaminaMode()==STAMINA_HOW_ROBBING_BG){colorDEBUG("Kicking of Background Robbing");isBackgroundRobbing=true;robGetTargets()}if(!isBGPaused&&!isBackgroundDispatching&&running&&GM_getIntValue("selectFreeGift",0)!=0&&GM_getIntValue("dispatchTarget",0)!=0&&!timeLeftGM("autoDispatchTimer")){colorDEBUG("Kicking of RX6 gift dispatcher");isBackgroundDispatching=true;start_RX6Dispatcher()}if(GM_getValue("burnOption")){var o=GM_getValue("burnOption");if(stamina<maxStamina&&running&&g&&o==BURN_ENERGY){h=true;j=false}if(energy<maxEnergy&&running&&i&&b&&o==BURN_STAMINA){h=false;j=true}}if(GM_getValue("miniPackFired",false)){GM_setValue("miniPackFired",false);grabToolbarInfo()}var p=isGMChecked(cities[city][CITY_AUTOBANK])&&!suspendBank&&quickBankFail&&parseCash(cities[city][CITY_CASH])>=GM_getIntValue(cities[city][CITY_BANKCONFG],0);if(running&&p){if(autoBankDeposit(city,cities[city][CITY_CASH]))return}if(running&&isGMChecked("autoFightAgostino")&&energy>=maxEnergy/5){if(autoBossFight(boss_AGOSTINO))return}if(isGMChecked("autoStartMyOps")&&e){if(!timeLeftGM("myOpsTimer"))if(checkOperations("myMissions"))return}if(isGMChecked("autoStartFamOps")&&e){if(!timeLeftGM("famOpsTimer"))if(checkOperations("myMafiaMissions"))return}if(activateCrew(GM_getValue("selectCityPrio1",0)))return;if(activateCrew(GM_getValue("selectCityPrio2",0)))return;if(activateCrew(GM_getValue("selectCityPrio3",0)))return;if(running&&!n&&!k){if(onWarTab()&&b&&GM_getIntValue("warMode",0)){if(autoWarAttack())return}if(GM_getIntValue("warMode",0)&&b&&!timeLeftGM("warTimer")){if(autoWar())return}if(isGMChecked("autoAskCityCrew")&&!timeLeftGM("autoAskCityCrewTimer")){if(autoAskCityCrew(GM_getValue("selectCityPrio1",0)))return}if(GM_getIntValue("selectAskFreeGift",0)!=0&&!timeLeftGM("autoAskFreeGiftTimer")){if(autoFreeGift(1))return}if(GM_getIntValue("selectFreeGift",0)!=0&&!timeLeftGM("autoFreeGiftTimer")){if(autoFreeGift(0))return}if((isGMChecked("autoAcceptMsgGifts")||isGMChecked("autoAcceptMsgBoosts")||isGMChecked("autoAcceptMsgCrew")||isGMChecked("autosendMsgEnergyPack")||isGMChecked("acceptMafiaInvitations")||isGMChecked("AutoBattle"))&&!timeLeftGM("autoAcceptMsgTimer")){if(openMessageCenter())return}if(GM_getValue("autoUpgradeNYChoice",0)&&!timeLeftGM("autoUpgradeNYTimer")){if(autoUpgradeNY())return}if(c){for(var q=0,r=cities.length;q<r;++q){var s="collectTake"+cities[0][CITY_NAME];if(isNewCity(q))s="collectTake"+cities[q][CITY_NAME];if(level>=cities[q][CITY_LEVEL]&&isGMChecked(s)&&!timeLeftGM("takeHour"+cities[q][CITY_NAME])){if(autoCollectTake(q))return}}}for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){if(isGMChecked(cityParts[ctCount][ptGMId])&&!timeLeftGM(cityParts[ctCount][ptTimer])){var t=cityParts[ctCount][ptGMId]+"Id";colorDEBUG("partItemId "+t);if(askPropertyParts(ctCount,GM_getValue(t,0)))return}}for(ctCount=0;ctCount<ctLength;ctCount++){if(isGMChecked(cityProperties[ctCount][ctGMId])&&!timeLeftGM(cityProperties[ctCount][ctPropTimer])){var u=cityProperties[ctCount][ctGMId]+"Id";if(buildPropItem(ctCount,GM_getValue(u,0)))return}}if(isGMChecked("askVegasParts")&&!timeLeftGM("askVegasPartsTimer")){if(askSpecialParts(LV,cityVegasParts,GM_getValue("askVegasPartsId",1),101))return}if(isGMChecked("askPlaySlots")&&!timeLeftGM("askPlaySlotsTimer")){if(askSpecialParts(LV,[],0,102))return}if(GM_getIntValue("selectVegasTier",0)&&!timeLeftGM("AskforHelpVegasTimer")){if(AskforHelp(LV))return}if(isGMChecked("askBrazilParts")&&!timeLeftGM("askBrazilPartsTimer")){if(askSpecialParts(BRAZIL,cityBrazilParts,GM_getValue("askBrazilPartsId",1),10))return}if(GM_getIntValue("selectBrazilTier")&&!timeLeftGM("AskforHelpBrazilTimer")){if(AskforHelp(BRAZIL))return}if(isGMChecked("askChicagoParts")&&!timeLeftGM("askChicagoPartsTimer")){if(askSpecialParts(CHICAGO,cityChicagoParts,GM_getValue("askChicagoPartsId",1),20))return}if(GM_getIntValue("selectChicagoTier")&&!timeLeftGM("AskforHelpChicagoTimer")){if(AskforHelp(CHICAGO))return}if(isGMChecked("askLondonParts")&&!timeLeftGM("askLondonPartsTimer")){if(askSpecialParts(LONDON,cityLondonParts,GM_getValue("askLondonPartsId",1),30))return}if(GM_getIntValue("selectLondonTier")&&!timeLeftGM("AskforHelpLondonTimer")){if(AskforHelp(LONDON))return}if(j&&isGMChecked("bgAutoHitCheck")&&!timeLeftGM("bgAutoHitTime")){if(autoHitlist())return}if(stats>0&&isGMChecked("autoStat")&&!GM_getIntValue("restAutoStat")){if(autoStat())return}if(isGMChecked("autoCheckReallocation")&&!timeLeftGM("checkReallocationTimer")){checkReallocation()}if(isGMChecked("autoSlot3FreeSpins")&&!timeLeftGM("autoFreeSlotTimer")){slotFreeSpins()}if(isGMChecked("AutoSlotMachine")&&!timeLeftGM("autoSlotTimer")){if(autoSlotMachine()){return}}if(isGMChecked("AutoSlotMachine")&&slotBonus>=20){autoSlotBonus();return}if(isGMChecked("AutoSlotMachine")&&slotSpins>0){autoSlotPull();return}if(isGMChecked("autoFamilyProperty")){for(var q=1;q<3;q++){if(!timeLeftGM("autoclanPropertyTimer_"+q)){setGMTime("autoclanPropertyTimer_"+q,"8 hours");clanPropertyupgradePop(q);clanPropertyLoad(q);break}}}if(isGMChecked("AutoBattle")&&!inClanBattle&&!timeLeftGM("autoBattleTimer")){autoBattle();return}if((isGMChecked("AutoBattleFight")||isGMChecked("AutoBattleSafehouse")||isGMChecked("AutoBattle"))&&!timeLeftGM("autoBattleCollectTimer")){autoBattleCollect();return}var v=(energy+200)*getEnergyGainRate();var w=(stamina+200)*getStaminaGainRate();var x=v<ptsToNextLevel&&w<ptsToNextLevel;if(x&&isGMChecked("checkMiniPack")&&!timeLeftGM("miniPackTimer")){if(miniPackForce())return}if(isGMChecked("autoShareWishlist")&&!timeLeftGM("wishListTimer")){if(autoWishlist())return;}if(isGMChecked("autoLimitedParts")){var y=xpathFirst('.//a[contains(@class, "property_ask_button") and contains(@onclick,"MW.Feed(property_ask_any)")]',innerPageElt);if(y){addToLog("info Icon","Asking for Property Part");clickElement(y)}var y=xpathFirst('.//a[contains(@class, "green") and contains(@onclick,"upgradeEpicProperty")]',innerPageElt);if(y){addToLog("info Icon","Upgrading Limited Property");clickElement(y)}var y=xpathFirst('.//a[contains(@onclick,"openUpgrade()")]',innerPageElt);if(y&&!timeLeftGM("askLimitedPartsTimer")){addToLog("info Icon","Popping Upgrade Open Window");setGMTime("askLimitedPartsTimer","60:00");clickElement(y)}}}if(running&&health==0&&!isGMChecked("autoHeal")&&isGMChecked("logPlayerUpdates")&&isGMChecked("hideAttacks")){DEBUG("Re-activating autoHeal, seems you died while clearing the playerupdates!<br>Current HitXP: "+GM_getValue("currentHitXp",0));GM_setValue("autoHeal","checked")}autoHeal(2);if(h&&SpendEnergy.canBurn||h&&!(j&&SpendStamina.canBurn&&ptsToNextLevel>6)&&(ptsToNextLevel<=6||autoEnergyPackWaiting||energy/maxEnergy>=stamina/maxStamina)){autoMission();return}if(j&&getStaminaMode()!=STAMINA_HOW_FIGHT_BG&&getStaminaMode()!=STAMINA_HOW_FIGHT_LIST_BG){if(autoStaminaSpend())return;if(GM_getValue("staminaSpendHow")==getStaminaMode()){cycleSavedList("pfightlist");randomizeStamina();if(autoStaminaSpend())return}else if(isGMEqual("staminaSpendHow",STAMINA_HOW_RANDOM)){randomizeStamina();if(autoStaminaSpend())return}else{skipStaminaSpend=true}}if(h){autoMission();return}if(running&&!i){if(autoFamilyProgress(2))return}idle=true;if(running&&!f){DEBUG("Now idle. Checking the home page.");Autoplay.fx=goHome;Autoplay.start();return}if(running&&isGMChecked("logPlayerUpdates")&&onHome()){if(autoPlayerUpdates())return}if(running&&(skipStaminaSpend&&(!isNewCity(GM_getValue("fightLocation",NY))||stamina>4)||skipJobs)){DEBUG("If fight/hit/jobs are being skipped, turn them back on and go to the home page");skipStaminaSpend=false;skipJobs=false;Autoplay.fx=goHome;Autoplay.start();return}var z=GM_getValue("idleLocation",NY);if(isBackgroundFighting){z=GM_getValue("fightLocation",NY);if(z==ACTIVE_CITY)z=city;if(z==RANDOM_CITY)z=GM_getValue("fightNewLocation",NY)}if(isBackgroundRobbing){z=GM_getValue("robLocation",NY);if(z==ACTIVE_CITY)z=city}if(running&&city!=z&&f){DEBUG("Idling. Moving to "+cities[z][CITY_NAME]+". ");Autoplay.fx=function(){goLocation(z)};Autoplay.start();return}autoReload(true,"reload animate")}function rand(a,b){var c=a;var d=b-a+1;var e=Math.floor(Math.random()*d)+c;return e}function getAutoPlayDelay(){var a=6-GM_getIntValue("fastMWAPSpeed",0);var b=12-GM_getIntValue("fastMWAPSpeed",0)*2;var c=rand(a,b)*1e3;return c}function pageReload(a,b){Reload.fx=function(){DEBUG("forced Page Reload from: "+b);goHome();Reload.fx=goHome};if(!a){var c=70-GM_getIntValue("fastMWAPSpeed",0)*10;var d=c*1.5;Reload.delay=rand(c,d)*1e3}else{Reload.delay=noDelay}Reload.start()}function autoReload(a,b){Reload.fx=function(){DEBUG("forced Page Reload from: "+b);ajaxHandling=false;goHome();Reload.fx=goHome};var c=70-GM_getIntValue("fastMWAPSpeed",0)*10;var d=c*1.5;Reload.delay=rand(c,d)*1e3;Reload.start()}function openMessageCenter(){var a=0;var b=xpathFirst('//span[@id="zmc_event_count" and not(contains(style,"none"))]');if(b)a=parseInt(b.innerHTML);if(b&&a){var c=b.parentNode;if(c){clickElement(c);setGMTime("autoAcceptMsgTimer","10:00")}else{DEBUG("Message Center Link not found. Resetting Timer");setGMTime("autoAcceptMsgTimer","10:00")}}return false}function onFreeGiftPage(){var a=xpathFirst('.//div[@class="freegift_grid"]');if(a)return true;return false}function goFreeGiftPage(){var a=makeElement("a",null,{onclick:'return do_ajax("inner_page","remote/html_server.php?xw_controller=freegifts&xw_action=view&xw_city=1&ref=page", 1, 1, 0, 0); return false;'});if(a)clickElement(a);return}function autoFreeGift(a){Autoplay.delay=getAutoPlayDelay();if(!a){selectedGiftValue=GM_getIntValue("selectFreeGift",0);colorDEBUG("Opening showGiftFriendSelector for gift "+selectedGiftValue);unsafeWindow.showGiftFriendSelector(selectedGiftValue);setGMTime("autoFreeGiftTimer","1 hour");return false}if(!onFreeGiftPage()){Autoplay.fx=function(){goFreeGiftPage()};Autoplay.start();return true}var b=false;selectedGiftValue=GM_getIntValue("selectAskFreeGift",0);var c=$x('.//div[contains(@id,"freegift_box") and contains(@class,"freegift_box ")]');if(c&&c.length>0){var d="";for(i=0,iLength=c.length;i<iLength;i++){var e=c[i];var f=xpathFirst(".//img",e);if(f.hasAttribute("item_id"))var g=parseInt(f.getAttribute("item_id").digitize());else g=parseInt(e.id.digitize());if(g==selectedGiftValue){clickElement(e);b=true;break}}if(!b){e=c[0];var h=xpathFirst('.//div[@class="freegift_box_itemname"]',e).innerHTML.untag().capitalize();addToLog("omg Icon","The selected Free Gift ID: "+selectedGiftValue+' could not be asked for. Asking for <span class="loot">'+h+"</span> instead ...");clickElement(e);b=true}if(b){var j=xpathFirst('.//a[contains(@id,"freegift_ask_button") and contains(@onclick,"getGiftFeed") and not(contains(@class,"disabled"))]');if(j){clickElement(j);setGMTime("autoAskFreeGiftTimer","8 hours");return false}else colorDEBUG("Ask Free Gift not yet available")}}setGMTime("autoAskFreeGiftTimer","1 hour");return false}function autoAskCityCrew(a){if(!isNewCity(a))return false;Autoplay.delay=getAutoPlayDelay();if(city!=a){Autoplay.fx=function(){goLocation(a)};Autoplay.start();return true}var b=1;if(!onJobTab(b)){Autoplay.fx=function(){goJobTab(b)};Autoplay.start();return true}var c=0;var d=xpathFirst('.//a[@id="btn_queue"]',innerPageElt);if(d){c=parseCash(d.innerHTML.untag());if(c>31){setGMTime("autoAskCityCrewTimer","1 hour");return false}}var e=xpathFirst('.//a[@id="btn_crew_recruit" and not(contains(@class,"disabled"))]',innerPageElt);if(e){DEBUG("autoAskCityCrew - Clicking Crew Ask button");clickElement(e)}var f=xpathFirst('.//a[@id="btn_crew_request"]',innerPageElt);if(f){DEBUG("requestCityCrew - Clicking Crew Request button");clickElement(f);setGMTime("requestTimer","00:30");setGMTime("autoAskCityCrewTimer","2 hours")}else setGMTime("autoAskCityCrewTimer","1 hour");return false}function AskforHelp(a){Autoplay.delay=3e3;var b=0;var c=0;var d=0;var e="";if(city!=a){Autoplay.fx=function(){goLocation(a)};Autoplay.start();return true}if(isNewCity(a)){if(a==BRAZIL){b=GM_getIntValue("selectBrazilTier");e="AskforHelpBrazilTimer"}else if(a==CHICAGO){b=GM_getIntValue("selectChicagoTier");e="AskforHelpChicagoTimer"}else if(a==LONDON){b=GM_getIntValue("selectLondonTier");e="AskforHelpLondonTimer"}var f=function(b,c,d){return d[c][MISSION_CITY]==a};var g=missions.filter(f);if(c=g.searchArray(b,3)[0])d=g[c][6];if(d)b=d}else if(a==LV){jobno=GM_getIntValue("selectVegasTier");b=missions[jobno][MISSION_TAB];c=missions[jobno][MISSION_TABPATH];e="AskforHelpVegasTimer"}if(!onJobTab(b)){Autoplay.fx=function(){goJobTab(b)};Autoplay.start();return true}if(a==LV){if(!onJobTabpath(c)){Autoplay.fx=function(){goJobTabPath(c)};Autoplay.start();return true}}if(isNewCity(a)){var h=xpathFirst('.//div[@class="jobs"]//a[@class="sexy_button_new sexy_call_new medium black mw_new_ajax_feed" and contains(., "Ask")]',innerPageElt);if(!h)h=xpathFirst('.//div[contains(@id,"job-id")]//a[@class="sexy_button_new sexy_call_new medium black mw_new_ajax_feed" and contains(., "Ask")]',innerPageElt);if(h){var i=h.parentNode;var j=xpathFirst(".//h4",i);addToLog("updateGood Icon","Clicked to Ask for Help in "+cities[a][CITY_NAME]+" - "+missionTabs[a][b-1]+" : "+j.innerHTML.untag()+".");clickElement(h);setGMTime(e,"8 hours")}else setGMTime(e,"1 hour")}else{var k=xpathFirst('.//div[@class="job_info" and contains(., "'+missions[jobno][MISSION_NAME]+'")]',innerPageElt);if(k){var l=xpathFirst('.//a[@class="sexy_button_new medium white sexy_call_new ask_for_help"]',k);var m=xpathFirst('.//div[@class="ask_for_job_help_btn" and contains(@style,"display: none;")]',k);if(m){var n=xpathFirst('.//div[@id="ask_for_job_help_time"]',k).innerHTML;if(n)setGMTime(e,helptimer);else setGMTime(e,"1 hour")}else{if(l){clickElement(l);addToLog("updateGood Icon","Clicked to Ask for Help in "+cities[a][CITY_NAME]+" - "+missions[jobno][0]+".");setGMTime(e,"8 hours")}else setGMTime(e,"1 hour")}}else{DEBUG("JobContainer for :"+missions[jobno][0]+" not FOUND!");setGMTime(e,"1 hour")}}return false}function autoUpgradeNY(){Autoplay.delay=3e3;if(city!=NY){Autoplay.fx=function(){goLocation(NY)};Autoplay.start();return true}if(!onPropertyNav()){Autoplay.fx=goPropertyNav;Autoplay.start();return true}var a=autoUpgradeNYChoices[GM_getValue("autoUpgradeNYChoice",0)][1];DEBUG("autoUpgradeNY targetLevel: "+a);var b=xpathFirst('//object[@id="properties_div"]/param[@name="flashvars"]');if(b&&b.value){var c=JSON.parse(unescape(b.value).match(/&mw_data=(\[.+\])/)[1]);var d="";for(var e=0,f=c.length;e<f;e++){var g=e+1;if(c[e].maxlevel==0){var h="NYProperty"+g;d+="Setting Data for "+e+" - "+c[e].name+"(type:"+g+") - level: "+c[e].level+", max: "+c[e].maxlevel+"<br/>";GM_setValue(h,parseInt(c[e].level))}else{d+="Reading Data for "+e+" - "+c[e].name+"(type:"+g+") - level: "+c[e].level+", max: "+c[e].maxlevel+"<br/>"}}DEBUG(d);var i=GM_getFloatValue("userBankBalance");if(isNaN(i)||i==0){var j=createAjaxPage(true);elt=makeElement("a",null,{onclick:'return do_ajax("'+j+'","remote/html_server.php?xw_controller=propertyV2&xw_action=buy&xw_city=1&building_type=2&requesttype=json", 1, 0, 0, 0); return false;'});if(elt){clickAction="autoUpgradeNY_getBalance";clickElement(elt);DEBUG("Clicked to get User Bank Balance");return true}}for(var e=0,f=c.length;e<f;e++){var g=e+1;var k="upgradeNYProperty"+g;if(c[e].maxlevel==0&&isGMChecked(k)){var h="NYProperty"+g;var l=GM_getIntValue(h,a);var i=GM_getFloatValue("userBankBalance",0);var m=GM_getFloatValue("userMinBalance",0);DEBUG("Property to upgrade: "+e+" - "+c[e].name+"( type:"+g+" ) - screen level: "+c[e].level+" / saved level: "+l+", maxlevel: "+c[e].maxlevel);if(l<a&&i>=m){var j=createAjaxPage(true);elt=makeElement("a",null,{onclick:'return do_ajax("'+j+'","remote/html_server.php?xw_controller=propertyV2&xw_action=buy&xw_city=1'+"&building_type="+g+'&requesttype=json&fundtype=bank", 1, 0, 0, 0); return false;'});if(elt){clickAction="autoUpgradeNY";clickContext=h;clickElement(elt);DEBUG("Clicked to upgrade "+e+" - "+c[e].name);return true}}else{if(l>=a){addToLog("updateGood Icon",e+" - "+c[e].name+" upgraded to selected maximum level. Disabling");GM_setValue(k,0)}else{addToLog("warning Icon","Insufficient funds ("+i+" vs "+m+") to upgrade "+e+" - "+c[e].name+".")}}}}}setGMTime("autoUpgradeNYTimer","24 hours");return false}function askPropertyParts(a,b){colorDEBUG(a+" / "+b,caq);Autoplay.delay=3e3;var c=cityParts[a][ptCity];if(city!=c){Autoplay.fx=function(){goLocation(c)};Autoplay.start();return true}if(!onPropertyNav()){Autoplay.fx=goPropertyNav;Autoplay.start();return true}var d=cityParts[a][ptTitle];var e=cityParts[a][ptProp];var f=parseInt(cityParts[a][ptPropId]);var g=parseInt(cityParts[a][ptPropType]);var c=cityParts[a][ptCity];var h=cityParts[a][ptArray];var i=cityParts[a][ptGMId];var j=cityParts[a][ptTimer];var k="12 hours";var l=h[b][0];var m=h[b][1];if(h[b][3])var n=h[b][3][0];var o;var p=createAjaxPage(true);colorDEBUG("RX6 is asking for : "+l+" - "+m+" - "+f);switch(g){case 1:colorDEBUG("Asking for NY property items",cli);var q=JSON.parse(GM_getValue("propLevels",JSON.stringify([])));var r=0;var s=q.searchArray(f,0);if(s!==false){r=q[s][2];colorDEBUG("AksforParts: "+s+" - "+propLevel)}if(r){colorDEBUG("Asking for NY property items - partPropLevel "+r,cli);var t=cityProperties.searchArray(f,ctPropId);var u=cityProperties[t][ctPropMaxLevel];colorDEBUG("Asking for NY property items - propMaxLevel "+u,cli);if(r>=u){addToLog("warning Icon","Your "+cityProperties[t][ctPropMaxLevel]+" is already fully upgraded. No need to ask for parts. Disabling this setting.");GM_setValue(i,"unchecked");return false}o=makeElement("a",null,{onclick:'return do_ajax("'+p+'","remote/html_server.php?xw_controller=propertyV2&xw_action=sendItemFeedNews&xw_city=1&item='+m+"&building_type="+g+'", 1, 0, 0, 0); return false;'});Autoplay.fx=function(){clickElement(o);addToLog("info Icon","Clicked to ask your Mafia to send you "+l+".")}}else{colorDEBUG("Property Level could not be defined ... Coming back in 1 hour");k="1 hour"}break;case 2:o=makeElement("a",null,{onclick:'return do_ajax("'+p+'","remote/html_server.php?xw_controller=propertyV2&xw_action=cs_special_item_feed_update_timestamp&xw_city=1", 1, 0, 0, 0); return false;'});Autoplay.fx=function(){clickAction="ask parts";clickContext=c;clickElement(o);addToLog("info Icon","Clicked to ask your Mafia to send you "+l+".")};break}if(o){Autoplay.start();DEBUG("RX6 sucessfully asked for : "+l+" - "+m+". Timer Reset : "+k);if(j)setGMTime(j,k);return true}return false}function askSpecialParts(a,b,c,d){Autoplay.delay=3e3;if(city!=a){Autoplay.fx=function(){goLocation(a)};Autoplay.start();return true}if(!onPropertyNav()){Autoplay.fx=goPropertyNav;Autoplay.start();return true}var e="";if(a==LV)e=GM_getValue("vegasReport","");if(a==BRAZIL)e=GM_getValue("brazilReport","");if(a==CHICAGO)e=GM_getValue("chicagoReport","");if(a==LONDON)e=GM_getValue("londonReport","");if(!e){Autoplay.fx=function(){checkPropertyStatus(a,true)};Autoplay.start();return true}var f;var g;var h;var i;var j;switch(d){case 10:g="askBrazilPartsTimer";h="askBrazilParts";i=b[c][0];j="askBrazilPropId";break;case 20:g="askChicagoPartsTimer";h="askChicagoParts";i=b[c][0];j="askChicagoPropId";break;case 30:g="askLondonPartsTimer";h="askLondonParts";i=b[c][0];j="askLondonPropId";break;case 101:g="askVegasPartsTimer";h="askVegasParts";i=b[c][0];j="askVegasPropId";break;case 102:g="askPlaySlotsTimer";h="askPlaySlots";i="Play Slots";break}if(d==102){var k=createAjaxPage(true);f=makeElement("a",null,{onclick:'return do_ajax("'+k+'","'+SCRIPT.controller+"propertyV2"+SCRIPT.action+"vslot_feed"+SCRIPT.city+'5", 1, 0, 0, 0); return false;'});Autoplay.fx=function(){clickAction="play slots";clickContext=a;clickElement(f);DEBUG("Clicked to ask for "+i+" for "+d+" (action: "+clickAction+" - context: "+clickContext)};Autoplay.start();return true}else{var l=a+1;if(e){var m=0;if(e.match(/ask_friends_next_time(.+?)(\d+?),/i)){m=parseFloat(RegExp.$2);DEBUG("dueTime: "+m)}if(m){var n=Math.round((new Date).getTime()/1e3);if(n<m){var o=parseFloat(m)-parseFloat(n)+10;var p=secondsToHMS(o);p==1?p+=" hour":p+=" hours";setGMTime(g,p);DEBUG("Ask for Parts in "+a+": Timer "+g+" reset for "+p+".");return false}}var q='"id":'+b[c][1];if(e.indexOf(q)!=-1){var r=new RegExp(q+',"type":1,"quantity":(.+?)}',"gi");var s=0,t=0,u=0;while(match=r.exec(e))s+=parseInt(match[1]);var v=new RegExp(q+',"type":1,"name":"'+i+'","num_owned":(.+?),"image_url"',"gi");if(match=v.exec(e))u=parseInt(match[1]);t=s-u;if(t<=0)addToLog("warning Icon","Asking for "+i+" (Total Required: "+s+" - Already Owned: "+u+").");else addToLog("info Icon","Asking for "+i+", still needing "+t+" (Total Required: "+s+" - Already Owned: "+u+").");d=GM_getValue(j,1);var k=createAjaxPage(true);f=makeElement("a",null,{onclick:'return do_ajax("'+k+'","'+SCRIPT.controller+"propertyV2"+SCRIPT.action+"getAskForHelpFeed"+SCRIPT.city+l+"&city="+l+"&building_type="+d+"&item_type=1&item_id="+b[c][1]+'", 1, 0, 0, 0); return false;'});Autoplay.fx=function(){clickAction=cities[a][CITY_ALIAS]+" parts";clickContext=a;clickElement(f);DEBUG("Clicked to ask for "+i+" for "+d+" (action: "+clickAction+" - context: "+clickContext)};Autoplay.start();return true}}DEBUG("Ask for "+cities[a][CITY_NAME]+" Parts - Failed to ask for "+d+" - "+i+". Timer Reset : 2 hours.");setGMTime(g,"2 hours");return false}}function buildPropItem(a,b){Autoplay.delay=3e3;var c=cityProperties[a][ctPropCity];if(city!=c){Autoplay.fx=function(){goLocation(c)};Autoplay.start();return true}if(!onPropertyNav()){Autoplay.fx=goPropertyNav;Autoplay.start();return true}var d=cityProperties[a][ctTitle];var e=cityProperties[a][ctGMId];var f=cityProperties[a][ctGMId]+"id";var g=cityProperties[a][ctText];var h=cityProperties[a][ctArray];var i=cityProperties[a][ctPropType];var j=cityProperties[a][ctPropId];var k=cityProperties[a][ctPropTimer];var l=cityProperties[a][ctPropName];var m=cityProperties[a][ctPropNamePlus];switch(i){case 1:var n=makeElement("a",null,{onclick:'return do_ajax("inner_page","remote/html_server.php?xw_controller=propertyV2&xw_action=craft&xw_city=1&recipe='+h[b][1]+"&building_type="+j+'", 1, 0, 0, 0); return false;'});if(n){Autoplay.fx=function(){clickAction="build item";clickContext={itemName:h[b][0],buildType:j,propCount:a};clickElement(n);DEBUG("Clicked to build "+clickContext.itemName+".")};Autoplay.start();return true}break;case 2:var o=xpathFirst('//object[@id="properties_div"]/param[@name="flashvars"]');if(o&&o.value){propValue=JSON.stringify(JSON.parse(unescape(o.value).match(/&mw_data=(\[.+\])/)[1]));if(propValue.indexOf(m)!=-1){DEBUG("propId: "+j+" - "+l+" already active.")}else{var p="armory,chop_shop,private_zoo,weapons_depot,"+j;var q=createAjaxPage(true);var n=makeElement("a",null,{onclick:'return do_ajax("'+q+'","'+SCRIPT.controller+"LimitedTimeProperty"+SCRIPT.action+"saveProperties"+SCRIPT.city+"1&city=1&properties="+p+'", 1, 0, 0, 0); return false;'});if(n){Autoplay.fx=function(){clickAction="save properties";clickContext=p;clickElement(n);DEBUG("Clicked to save "+p+".")};Autoplay.start();return true}}}var q=createAjaxPage(true);var n=makeElement("a",null,{onclick:'return do_ajax("'+q+'","'+SCRIPT.controller+"limitedTimeProperty"+SCRIPT.action+"build"+SCRIPT.city+"1&city=1&prop_id="+j+"&rec_id="+h[b][1]+'", 1, 0, 0, 0); return false;'});if(n){Autoplay.fx=function(){clickAction="build limited";clickContext={itemName:h[b][0],buildType:j,propCount:a};clickElement(n);DEBUG("Clicked to build "+clickContext.itemName+" from "+clickContext.buildType+" = "+j+".")};Autoplay.start();return true}break;case 3:case 4:case 5:case 6:var r=c+1;var q=createAjaxPage(true);var n=makeElement("a",null,{onclick:'return do_ajax("'+q+'","'+SCRIPT.controller+"propertyV2"+SCRIPT.action+"portBuyItem"+SCRIPT.city+r+"&city="+r+"&building_type="+j+"&id="+h[b][1]+'", 1, 1, 0, 0); return false;'});if(n){Autoplay.fx=function(){clickAction="build other";clickContext={itemName:h[b][0],buildType:j,propCount:a};clickElement(n);DEBUG("Clicked to build "+clickContext.itemName+" from "+clickContext.buildType+" = "+j+".")};Autoplay.start();return true}break;default:return false;break}return false}function checkPropertyStatus(a,b){if(!a)return;var c=a+1;var d="&city="+c;mwap_do_ajax("propertyV2","createData",c,d,b,checkPropertyCallBack)}function autoBossFight(a){Autoplay.delay=getAutoPlayDelay();if(city!=NY){Autoplay.fx=function(){goLocation(NY)};Autoplay.start();return true}var b=xpathFirst('.//table[@class="boss_fight"]');if(!b){var c=a;if(!onJobTab(c)){Autoplay.fx=function(){goJobTab(c)};Autoplay.start();return true}if(health<maxHealth)autoHeal();var d=xpathFirst('.//a[contains(@href,"xw_controller=bossfight") and contains(@href,"boss='+a+'")]');if(d){clickElement(d);return true}}else{Autoplay.delay=noDelay;var d=xpathFirst('.//a[contains(@href,"xw_controller=bossfight") and contains(@href,"boss='+a+'")]',b);if(d){clickElement(d);return true}else{var d=xpathFirst('.//a[contains(@href,"xw_controller=job") and contains(.,"Back to Jobs")]',b);if(d){var e=d.parentNode.innerHTML;if(e.match(/(.+)<a/))e=RegExp.$1;e=e.replace(/^<br><br>/,"");e=e.replace(/<br><br>/g,"<br>");addToLog("yeah Icon",e);clickElement(d)}}}return false}function activateCrew(a){if(!isNewCity(a))return false;var b=cities[a][CITY_ALIAS].capitalize();var c="activate"+b+"CrewTimer";if(timeLeftGM(c))return false;var d="select"+b+"Crew";if(city!=a){Autoplay.fx=function(){goLocation(a)};Autoplay.start();return true}var e=1;if(!onJobTab(e)){Autoplay.fx=function(){goJobTab(e)};Autoplay.start();return true}var f=0;var g=xpathFirst('.//a[@id="btn_queue"]',innerPageElt);if(g){f=parseCash(g.innerHTML.untag());DEBUG("activateCrew - We have the following count for crew members:  "+f)}var h=0;if(f){for(i=1;i<=8;i++){if(h>f)break;var j=d+i;var k=GM_getIntValue(j,0);if(k){var l=xpathFirst('.//a[contains(@href,"crew_type='+cityCrewTitles[k][3]+'") and contains(@href,"crew_slot='+cityCrewTitles[k][4]+'")]',innerPageElt);if(l){DEBUG("activateCrew - Clicking Slot: "+i+" - "+GM_getValue(j,0));clickElement(l);h++}}}}setGMTime(c,"1 hour");return false}function autoSlotMachine(){setGMTime("autoSlotTimer","4 hours");var myParams="ajax=1&liteload=1&clicks=1";myParams+="&sf_xw_user_id="+xw_user_id+"&sf_xw_sig="+xw_sig;ts=parseInt((new Date).getTime().toString().substring(0,10));cb=xw_user+ts;GM_xmlhttpRequest({method:"POST",url:document.location.protocol+"//facebook.mafiawars.zynga.com/mwfb/"+SCRIPT.controller+"slotmachine"+SCRIPT.action+"view"+SCRIPT.city+"&xw_person="+xw_user+"&xw_client_id=8&cb="+cb+"&tmp="+ts,data:myParams,headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(_responseDetails){var i1,i2,flashvars;var tmp=_responseDetails.responseText;i1=tmp.indexOf("flashvars = {");if(i1!=-1){i2=tmp.indexOf("};",i1);tmp=tmp.slice(i1,i2+2);eval(tmp);if(flashvars&&flashvars.freeSpins){slotSpins=flashvars.freeSpins;slotBonus=flashvars.bonusMeter;addToLog("info Icon","Slot Spins Remaining: "+slotSpins+" Bonus Level: "+slotBonus)}}}});return false}function autoSlotBonus(){var a,b,c,d;if(slotBonus>=20){slotBonus=0;var e=createAjaxPage(true);var f=makeElement("a",null,{onclick:'return do_ajax("'+e+'","'+SCRIPT.controller+"slotmachine"+SCRIPT.action+'award_bonus", 1, 1, 0, 0); return false;'});Autoplay.fx=function(){clickAction="collect slotbonus";clickElement(f)};Autoplay.start();return true}else{DEBUG("Not at the correct bonus level")}return false}function autoSlotPull(){var a,b,c,d;if(slotSpins>0){slotSpins--;var e=createAjaxPage(true);var f=makeElement("a",null,{onclick:'return do_ajax("'+e+'","'+SCRIPT.controller+"slotmachine"+SCRIPT.action+'spin&betAmt=1&friend_id=none", 1, 1, 0, 0); return false;'});Autoplay.fx=function(){clickAction="collect slot";clickElement(f)};Autoplay.start();return true}else{DEBUG("No spins left on the slot machine")}return false}function autoBattleCollect(){if(!onBattlePage(1)){DEBUG("NOT on Battle Collect Page - going there");goBattlePage(1)}}function autoBattle(){var a=GM_getValue("AutoBattleClanID",0);if(a>0&&!onClanNav(a)){DEBUG("Not on Clan Page - going there");goClanPage(a);return}if(a==0){DEBUG("No clan specified for AutoBattle");return}DEBUG("We passed going to the clan page");return}function goBattlePage(a){var b=a==1?"view_no_battle":"view";var c=makeElement("a",null,{onclick:'return do_ajax("inner_page","remote/html_server.php?xw_controller=EpicBattle&xw_action='+b+'", 1, 1, 0, 0); return false;'});if(!c){addToLog("warning Icon","Can't make battle link to click.")}else{if(a==1){clickAction="load battlecollect"}else{clickAction="load battlepage"}clickElement(c);DEBUG("Clicked to load Battle Page.")}return}function onBattlePage(a){var b=a==1?"battle_history":"battle_target_list";if(xpathFirst('.//div[@id="'+b+'"]',innerPageElt)){DEBUG("Element :"+b+" found");return true}return false}function goClanPage(a){a=btoa(a);var b=makeElement("a",null,{onclick:'return do_ajax("inner_page","remote/html_server.php?xw_controller=clan&xw_action=view&id='+a+'", 1, 1, 0, 0); return false;'});if(!b){addToLog("warning Icon","Can't make Clan link to click.")}else{clickAction="load clan";clickElement(b);DEBUG("Clicked to load Clan Page.")}return}function onClanNav(a){if(!a){if(xpathFirst('.//div[@id="clan_main"]',innerPageElt)){return true}}else{if(xpathFirst('.//div[@id="clan_main"]',innerPageElt)){if($("#profile_link").length){DEBUG("On this clan page: "+$("#profile_link").text().replace(/"/g,"").trim())}else{DEBUG("On the wrong clan page?");return false}return true}}return false}function autoFamilyProgress(a){if(!running||!isGMChecked("AutoFamilyRewards"))return 0;var b=0;var c=0;var d=0;var e=[];var f=xpathFirst('.//li[contains(@class, "quest_reward experience") and contains(., "Experience")]//dd',questBarElt);if(f){e=f.innerHTML.untag().replace('"',"").trim().split(/\s+/);colorDEBUG("rewardExp: "+e)}else{colorDEBUG("Unable to locate rewards experience levels");return 0}var g=$x('.//li[contains(@class, "box_middle") and contains(@class, "complete") and not (contains(@class, "mastered")) and contains (., "Collect")]',questBarElt);if(g){var h;colorDEBUG("We have "+g.length+" complete family progressions");for(var i=0,j=g.length;i<j;++i){var k=xpathFirst(".//h4",g[i]);colorDEBUG("checking Family Progress for: "+k.innerHTML.untag(),cli);var l=xpathFirst('.//span[contains(@class, "_star")]',g[i]);if(l){var m=l.getAttribute("class");if(/bronze/.test(m)){d=parseInt(e[0])}else if(/silver/.test(m)){d=parseInt(e[1])}else if(/gold/.test(m)){d=parseInt(e[2])}else{colorDEBUG("Unknown mastery family experience level: "+m);d=0}}b+=d;colorDEBUG("Current Exp: "+d+" for "+k.innerHTML.untag()+" - Total Exp: "+b);var n=xpathFirst('.//a[contains(@href, "xw_action=collectProgress") and contains (., "Collect")]',g[i]);if(n&&a==2){DEBUG("ptsToNextLevel:"+ptsToNextLevel+"  currentExp:"+d+" selectedExp"+c);if(c==0||ptsToNextLevel<=d&&c>d||ptsToNextLevel>d&&d<c){c=d;h=n}}}if(a==2&&h&&c>0){addToLog("info Icon","Collecting Family Experience: "+c);clickElement(h);return false}}else{if(a==1)return 0}if(a==1)return b}function autoCollectTake(a){if(isGMUndefined("collectCityAttempt"))GM_setValue("collectCityAttempt",false);if(isGMUndefined("propertyNavAttempt"))GM_setValue("propertyNavAttempt",false);if(city!=a){if(GM_getValue("collectCityAttempt",false)){if(a!=0){setGMTime("takeHour"+cities[a][CITY_NAME],"1 hour")}GM_setValue("collectCityAttempt",false);return false}GM_setValue("collectCityAttempt",true);Autoplay.fx=function(){goLocation(a)};Autoplay.start();return true}GM_setValue("collectCityAttempt",false);if(!onPropertyNav()){if(GM_getValue("propertyNavAttempt",false)){if(a!=0){setGMTime("takeHour"+cities[a][CITY_NAME],"8 hours")}GM_setValue("propertyNavAttempt",false);return false}GM_setValue("propertyNavAttempt",true);Autoplay.fx=goPropertyNav;Autoplay.start();return true}GM_setValue("propertyNavAttempt",false);var b=createAjaxPage(true);var c=makeElement("a",null,{onclick:'return do_ajax("'+b+'","'+SCRIPT.controller+"propertyV2"+SCRIPT.action+"collectall"+SCRIPT.city+(a+1)+'&requesttype=json", 1, 1, 0, 0); return false;'});Autoplay.fx=function(){clickAction="collect take";clickContext=a;clickElement(c)};Autoplay.start();return true}function autoPlayerUpdates(){var a=xpath('.//div[@id="player_updates_all"]/div[@class="update_item"]',innerPageElt);var b=a.snapshotLength;var c=GM_getValue("logPlayerUpdatesCount");if(isUndefined(c)){c=b;GM_setValue("logPlayerUpdatesCount",c)}if(b>0&&c>b||b==0&&c>0){if(b>0&&c>b)DEBUG("Discrepancy in player updates; new count: "+b+", old count: "+c);else DEBUG("Player updates were cleared.");c=0;GM_setValue("logPlayerUpdatesCount",0)}if(c<b){DEBUG("Parsing new player updates.");for(var d=b-c-1;d>=0;d--){if(!parsePlayerUpdates(a.snapshotItem(d)))return true;GM_setValue("logPlayerUpdatesCount",++c)}}if(b>GM_getValue("logPlayerUpdatesMax",25)&&c==b){Autoplay.fx=goDeleteNews;Autoplay.start();return true}return false}function miniPackForce(){if(!timeLeftGM("miniPackTimer"))setGMTime("miniPackTimer","1 hour");GM_setValue("miniPackFired",true);DEBUG("Redirecting to use mini pack...");GM_xmlhttpRequest({method:"GET",url:"http://toolbar.zynga.com/game_iframe_proxy.php?playing=true",onload:function(a){if(a.status==200){GM_xmlhttpRequest({method:"HEAD",url:"http://toolbar.zynga.com/click.php?to=mwgamestatsplaynow",onload:function(a){if(a.status==302){var b=/Location: ([^\n]*)\n/.exec(response.responseHeaders)[1];if(b){document.location.href=b}}}})}}});return false}function autoStatVars(a){var b=new Array;var c="";var d=0;var e=[curAttack,curDefense,maxHealth,maxEnergy,maxStamina];var f=[level,curAttack,curDefense,maxHealth,maxEnergy,maxStamina];var g=new Array(e.length);var h=0;var i=0;var j=autoStatPrios.length;for(var k=0,l=e.length;k<l;++k){var m=new Number(GM_getValue(autoStatRatios[k]));var n=new Number(GM_getValue(autoStatBases[k]));var o=new Number(GM_getValue(autoStatPrios[k]));var p=Math.max(0,m*f[GM_getValue(autoStatModes[k])]+n-e[k]);if(p>0&&o<j||p>h&&o<=j){h=p;i=k;j=o}g[k]=isGMChecked(autoStatFallbacks[k])?k:""}if(h<=0&&isGMChecked("autoStatDisable")){addToLog("info Icon","All status goals met, please update your goals.");GM_setValue("autoStat",0)}if(h<=0){if(g.join("")!=""){DEBUG("Status GOALS reached, using fallback method.",10);var q=GM_getIntValue("nextStat",ATTACK_STAT);while(g.indexOf(q)==-1){q=(q+1)%e.length}i=q}else{DEBUG("Status GOALS reached, waiting till next level up.");GM_setValue("restAutoStat",1)}}else{DEBUG("Next stat to increment : "+autoStatDescrips[i+1]+" ("+h+" points to goal) ");GM_setValue("restAutoStat",0)}switch(i){case ATTACK_STAT:c="attack";break;case DEFENSE_STAT:c="defense";break;case HEALTH_STAT:c="max_health";break;case ENERGY_STAT:c="max_energy";break;case STAMINA_STAT:c="max_stamina";break}d=a>4&&(h>4||h<=0)?5:1;b[0]=c;b[1]=d;return b}function autoStat(){if(!onProfileNav()||isUndefined(curAttack)){Autoplay.fx=goMyProfile;Autoplay.start();return true}if(onProfileNav()){var a=xpathFirst('.//div[@class="stats_title_text"]');if(a){var b=a.innerHTML.untag();if(b.match(/"(.+)"\s?level\s?(\d+)/i)){GM_setValue("playerName",RegExp.$1);GM_setValue("playerLevel",RegExp.$2)}}var c=new Array;var d=xpathFirst('.//span[@id="user_skill"]');var e=0;if(d)e=parseInt(d.innerHTML);c=autoStatVars(e);DEBUG("AutoStat upgrading "+c[0]+" - "+c[1]);if(c[0]!=""&&c[1]!=0){var f=xpathFirst('.//a[contains(@onclick,"upgrade_key='+c[0]+'") and contains(@onclick,"upgrade_amt='+c[1]+'")]',innerPageElt);if(!f){f=xpathFirst('.//a[contains(@onclick,"upgrade_key='+c[0]+'")]',innerPageElt)}if(!f){DEBUG("Couldn't find link to upgrade stat.");return false}Autoplay.fx=function(){clickAction="stats";clickElement(f);DEBUG("Clicked to upgrade: "+c[0]+" ("+c[1]+")")};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}else{return false}}else{GM_setValue("autoStat",0);colorDEBUG("BUG DETECTED: Unable to load Profile page, autostat disabled.");return false}}function calcJobratio(a){var b=Math.round(missions[a][MISSION_XP]/missions[a][MISSION_ENERGY]*100)/100;b=isNaN(b)?0:b;missions[a][MISSION_RATIO]=b;GM_setValue("missions",JSON.stringify(missions));return b}function canSalvageEnergy(a){if(energy<=maxEnergy)return false;var b=energy-Math.ceil(ptsToNextLevel/missions[a][MISSION_XP])*missions[a][MISSION_ENERGY]-maxEnergy;if(b>0)return b;else return false}function canSalvageStamina(a){if(stamina<=maxStamina)return false;var b=stamina-Math.ceil(ptsToNextLevel/missions[a][MISSION_XP])*missions[a][MISSION_ENERGY]-maxStamina;if(b>0)return b;else return false}function canMission(){function canMissionJobCheck(a){for(i=0,iLength=a.length;i<iLength;++i){job=a[i];var b=missions[job];var c=energy;var d=0;if(b[MISSION_EOL]==0||b[MISSION_EOL]==3){c=stamina;d=1}var e=b[MISSION_TAB];if(isNewCity(b[MISSION_CITY])&&b[MISSION_TABPATH])e=b[MISSION_TABPATH];if(!b)continue;var f=false;if(availableJobs[b[MISSION_CITY]][e]!=null&&availableJobs[b[MISSION_CITY]][e].indexOf(parseInt(job))==-1)continue;if(isNaN(b[MISSION_RATIO])||!b[MISSION_RATIO])b[MISSION_RATIO]=calcJobratio(job);if(b[MISSION_ENERGY]<=c){enoughEnergy=true;if(b[MISSION_XP]>=expLeft){var g=[job,b[MISSION_ENERGY],b[MISSION_XP]];singleJobLevelUp.push(g);f=true}}if(!isGMChecked("repeatJob")){if(masteredJobs[b[MISSION_CITY]][e]!=null&&masteredJobs[b[MISSION_CITY]][e].indexOf(parseInt(job))!=-1&&f==false){continue}}if(d)if(!canSalvage&&canSalvageStamina(job))canSalvage=true;else if(!canSalvage&&canSalvageEnergy(job))canSalvage=true;multiple_jobs_ratio_sorted.push(job)}}if(!energy)return false;if(!isGMChecked("autoMission"))return false;var selectedMission=GM_getValue("selectMission",1);var i,job;if(getSavedList("jobsToDo").length==0){var availableJobs=eval("("+GM_getValue("availableJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})")+")");var masteredJobs=eval("("+GM_getValue("masteredJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})")+")");var expLeft=ptsToNextLevel;var ratio=Math.ceil(expLeft/energy*100)/100;var stamratio=Math.ceil(expLeft/stamina*100)/100;var multiple_jobs_list=getSavedList("selectMissionMultiple");var multiple_jobs_ratio_sorted=[];var jobs_selection=[];var singleJobLevelUp=[];var enoughEnergy=false;var canSalvage=false;var mastery_jobs_list=getSavedList("masteryJobsList");for(i=0,iLength=mastery_jobs_list.length;i<iLength;++i){job=mastery_jobs_list[i];if(multiple_jobs_list.indexOf(job)==-1)multiple_jobs_list.push(job)}canMissionJobCheck(multiple_jobs_list);if(!enoughEnergy){if(isGMChecked("endLevelOptimize")&&ratio<=2.2){multiple_jobs_list=[];for(i=0,iLength=missions.length;i<iLength;++i){var useJob=true;if(isGMChecked("endLevelNYOnly")&&missions[i][MISSION_CITY]!=NY)useJob=false;if(missions[i][MISSION_EOL]==1&&missions[i][MISSION_RATIO]>=ratio&&missions[i][MISSION_ENERGY]<energy&&useJob)multiple_jobs_list.push(i)}canMissionJobCheck(multiple_jobs_list);if(!enoughEnergy)return false}else if(isGMChecked("endLevelOptimize")&&stamratio<=2.2&&!isGMChecked("staminaSpend")){multiple_jobs_list=[];for(i=0,iLength=missions.length;i<iLength;++i){var useJob=true;if(isGMChecked("endLevelNYOnly")&&missions[i][MISSION_CITY]!=NY)useJob=false;if(missions[i][MISSION_EOL]==0&&missions[i][MISSION_RATIO]>=stamratio&&missions[i][MISSION_ENERGY]<stamina&&useJob)multiple_jobs_list.push(i)}canMissionJobCheck(multiple_jobs_list);if(!enoughEnergy)return false}else return false}var doJob=undefined;multiple_jobs_ratio_sorted.sort(function(a,b){return missions[b][MISSION_RATIO]-missions[a][MISSION_RATIO]});if(singleJobLevelUp.length>0&&!canSalvage){singleJobLevelUp.sort(function(a,b){return b[2]-a[2]});doJob=singleJobLevelUp[0][0];if(isGMChecked("endLevelOptimize")){if(isGMChecked("endLevelNYOnly"))var expBurnFilter=function(a,b,c){return b>6&&b<singleJobLevelUp[0][0]&&(c[b][MISSION_EOL]==1||c[b][MISSION_EOL]==2)&&c[b][MISSION_CITY]==NY&&c[b][MISSION_ENERGY]<singleJobLevelUp[0][1]*.5?1:0};else var expBurnFilter=function(a,b,c){return b>6&&b<singleJobLevelUp[0][0]&&(c[b][MISSION_EOL]==1||c[b][MISSION_EOL]==2)&&c[b][MISSION_ENERGY]<singleJobLevelUp[0][1]*.5?1:0};var expBurners=missions.filter(expBurnFilter);expBurners.sort(function(a,b){return b[MISSION_XP]-a[MISSION_XP]});for(var i=0,iLength=expBurners.length;i<iLength;++i){var expBurner=expBurners[i];if(energy-singleJobLevelUp[0][1]>expBurner[1]&&expLeft>=Math.floor(expBurner[5])*1.5+1){doJob=missions.searchArray(expBurner[0],0)[0];break}}}}else{for(i=0;i<multiple_jobs_ratio_sorted.length;i++){if(missions[multiple_jobs_ratio_sorted[i]][MISSION_EOL]==0||missions[multiple_jobs_ratio_sorted[i]]==3){if(stamina>=missions[multiple_jobs_ratio_sorted[i]][MISSION_ENERGY]&&stamratio<=missions[multiple_jobs_ratio_sorted[i]][MISSION_RATIO]){jobs_selection.push(multiple_jobs_ratio_sorted[i])}}else{if(energy>=missions[multiple_jobs_ratio_sorted[i]][MISSION_ENERGY]&&ratio<=missions[multiple_jobs_ratio_sorted[i]][MISSION_RATIO]){jobs_selection.push(multiple_jobs_ratio_sorted[i])}}}if(jobs_selection.length==0){if(multiple_jobs_ratio_sorted.length){doJob=multiple_jobs_ratio_sorted[0];if(missions[doJob][MISSION_TABPATH]==1||missions[doJob][MISSION_EOL]==3){for(i=0,iLength=multiple_jobs_ratio_sorted.length;i<iLength;i++){newJob=multiple_jobs_ratio_sorted[i];if(missions[newJob][MISSION_TABPATH]!=1&&energy>missions[newJob][MISSION_ENERGY]){doJob=newJob;break}}}if(missions[doJob][MISSION_TABPATH]!=1){for(i=0,iLength=multiple_jobs_ratio_sorted.length;i<iLength;i++){newJob=multiple_jobs_ratio_sorted[i];if(missions[newJob][MISSION_TABPATH]==1&&stamina>missions[newJob][MISSION_ENERGY]){doJob=newJob;break}}}}}else{if(!canSalvage)doJob=jobs_selection[jobs_selection.length-1];else doJob=jobs_selection[0]}}if(selectedMission!=doJob){if(isUndefined(doJob)){DEBUG("canMission : currently no jobs available");return false}else{addToLog("info Icon",'Switching job to <span class="job">'+missions[doJob][MISSION_NAME]+"</span>. (canMission)");GM_setValue("selectMission",doJob);selectedMission=doJob}}}if(missions[selectedMission][MISSION_EOL]==0||missions[selectedMission][MISSION_EOL]==3){if(stamina<missions[selectedMission][MISSION_ENERGY]){DEBUG("Skipping jobs: stamina="+stamina+", cost="+missions[selectedMission][MISSION_ENERGY]);return false}var nextJobStamina=missions[selectedMission][MISSION_ENERGY];if(stamina-nextJobStamina<SpendStamina.floor&&!SpendStamina.canBurn){DEBUG("Not spending Job Stamina: Stamina="+stamina+", floor="+SpendStamina.floor+", nextJobStamina="+nextJobStamina+", burn="+SpendStamina.canBurn);return false}if(stamina<SpendStamina.ceiling&&!SpendStamina.canBurn&&!GM_getValue("useStaminaStarted")){DEBUG("Rebuilding energy: Stamina="+stamina+", ceiling="+SpendStamina.ceiling+", burn="+SpendStamina.canBurn);return false}}else{if(energy<missions[selectedMission][MISSION_ENERGY]){DEBUG("Skipping jobs: energy="+energy+", cost="+missions[selectedMission][MISSION_ENERGY]);return false}var nextJobEnergy=missions[selectedMission][MISSION_ENERGY];if(energy-nextJobEnergy<SpendEnergy.floor&&!SpendEnergy.canBurn){DEBUG("Not spending Job energy: energy="+energy+", floor="+SpendEnergy.floor+", nextJobEnergy="+nextJobEnergy+", burn="+SpendEnergy.canBurn);return false}if(energy<SpendEnergy.ceiling&&!SpendEnergy.canBurn&&!GM_getValue("useEnergyStarted")){DEBUG("Rebuilding energy: energy="+energy+", ceiling="+SpendEnergy.ceiling+", burn="+SpendEnergy.canBurn);return false}}return true}function autoMission(){Autoplay.delay=getAutoPlayDelay();var a=function(a){if(!a){addToLog("warning Icon",'Unable to perform <span class="job">'+b+"</span>.");var c=getSavedList("jobsToDo","");if(c.length==0){DEBUG("No more jobs to perform.");skipJobs=true;goHome();return}else{DEBUG("Looking for the next job to perform.");popJob();return true}}};jobid=GM_getValue("selectMission",1);var b=missions[jobid][MISSION_NAME];var c=missions[jobid][MISSION_NUMBER];var d=missions[jobid][MISSION_TAB];var e=missions[jobid][MISSION_CITY];var f=missions[jobid][MISSION_TABPATH]?missions[jobid][MISSION_TABPATH]:0;var g=missions[jobid][MISSION_NODE_LV]?missions[jobid][MISSION_NODE_LV]:"";if(SpendEnergy.floor&&isGMChecked("allowEnergyToLevelUp")&&GM_getValue("autoEnergyBurn")!==SpendEnergy.canBurn){GM_setValue("autoEnergyBurn",SpendEnergy.canBurn);if(SpendEnergy.canBurn){addToLog("process Icon",energyIcon+'<span style="color:#009966; font-weight: bold;">Burning through energy reserve to level up.</span>')}else{DEBUG("Not within reach of a level up. Energy burning is off.")}}if(city!=e){Autoplay.fx=function(){goLocation(e)};Autoplay.start();return true}var h=d;if(isNewCity(city)&&f)h=f;if(!onJobTab(h)){Autoplay.fx=function(){goJobTab(h)};Autoplay.start();return true}if(city==LV){if(!onJobTabpath(f)){Autoplay.fx=function(){goJobTabPath(f)};Autoplay.start();return true}}if(getJobRowItems(b)){DEBUG(" - - need items jobid="+jobid+" selectMission="+GM_getValue("selectMission",1));if(jobid!=GM_getValue("selectMission",1))Autoplay.fx=autoMission;Autoplay.start();return}colorDEBUG("autoMission - City: "+cities[e][CITY_NAME]+" ("+missionTabs[e][d-1]+") - job :"+b+" (jobNo: "+c+")");Autoplay.fx=function(){a(goJob(c))};Autoplay.start();return true}function getCurrentBrazilDistrict(){currentBrazilDistrict=0;var a=xpathFirst('.//div[@id="brazil_jobs"]//div[@class="jobs" and not(contains(@style,"none"))]',innerPageElt);if(!a)a=xpathFirst('.//div[@id="brazil_jobs"]//div[contains(@id,"job-id") and not(contains(@style,"none"))]',innerPageElt);if(a){var b=a.parentNode;if(b.hasAttribute("district_id"))currentBrazilDistrict=b.getAttribute("district_id")}if(!currentBrazilDistrict){var c=xpathFirst('.//div[@id="brazil_jobs"]/div[@class="districts"]',innerPageElt);if(c){if(c.hasAttribute("style")){if(c.getAttribute("style").match(/: -?(\d+)px/)){var d=RegExp.$2;if(d)currentBrazilDistrict=parseInt(RegExp.$1/54+1)}}}}return currentBrazilDistrict}function currentJobTab(){if(isNewCity(city))return parseInt(getCurrentBrazilDistrict());var a=xpathFirst('.//li[contains(@class, "tab_on")]//a',innerPageElt);if(a&&a.getAttribute("onclick").match(/tab=(\d+)/))return parseInt(RegExp.$1);return-1}function currentJobTabPath(){var a=xpathFirst('.//div[@id="job_paths"]//div[contains(@class, "path_on")]',innerPageElt);if(a&&a.id.match(/(\d+)/))return RegExp.$1;return-1}function onJobTab(a){return currentJobTab()==parseInt(a)?true:false}function onJobTabpath(a){return currentJobTabPath()==parseInt(a)?true:false}function canHeal(){if(unsafeWindow.User.stamina)stamina=unsafeWindow.User.stamina;if(unsafeWindow.User.health)health=unsafeWindow.User.health;if(!running||!isGMChecked("autoHeal")||health>=GM_getValue("healthLevel",0)||stamina<=GM_getValue("stamina_min_heal"))return false;var a=GM_getValue("staminaSpendHow");switch(a){case STAMINA_HOW_ROBFIGHT:if(stamina>GM_getValue("robFightStaminaFloor")){DEBUG(" STAMINA_HOW_ROBFIGHT - blocked autoheal because you are above the RobFight stamina level.");return false;break};default:break}if(!isGMChecked("hideInHospital"))return true;if(health>19&&isGMChecked("forceHealOpt7")){DEBUG("heal if above 19 is checked, and true, in canforceheal ");return true}if(SpendStamina.canBurn&&stamina>0&&isGMChecked("allowStaminaToLevelUp")){DEBUG("enough stamina left to level up, and burn to level up, checked in canforceheal ");return true}if(isGMChecked("forceHealOpt5")&&GM_getValue("healWaitStarted")&&timeLeftGM("healWaitTime")){DEBUG(" healing blocked "+GM_getValue("healWaitStarted")+" due to 5 minute wait timer. remaining:"+timeLeftGM("healWaitTime"));return false}else{if(isGMChecked("forceHealOpt5")){DEBUG("5 minute timer is up, Allowing Heal");GM_setValue("healWaitStarted",false);return true}}if(isGMChecked("forceHealOpt4")&&stamina>=maxStamina)return true;if(isGMChecked("forceHealOpt3")&&canSpendStamina(0))return true;return false}function canSpendStamina(a){if(unsafeWindow.User.stamina)stamina=unsafeWindow.User.stamina;if(unsafeWindow.User.health)health=unsafeWindow.User.health;if(!stamina||!isGMChecked("staminaSpend"))return false;if(stamina<5&&isNewCity(GM_getValue("fightLocation",NY))){DEBUG("Not spending stamina: stamina = "+stamina+", fight city = "+cities[GM_getValue("fightLocation",NY)][CITY_NAME]);return false}if(isNaN(a))a=21;var b=getStaminaMode();switch(b){case STAMINA_HOW_AUTOHITLIST:case STAMINA_HOW_ROBBING:case STAMINA_HOW_ROBBING_BG:a=0;break;case STAMINA_HOW_FIGHTROB:if(stamina>25)a=0;break;case STAMINA_HOW_ROBFIGHT:if(stamina>GM_getValue("robFightStaminaFloor"))a=0;break}if(health<a){DEBUG("Not spending stamina: health="+health+", minimum="+a);return false}if(stamina<=SpendStamina.floor&&!SpendStamina.canBurn){DEBUG("Not spending stamina: stamina="+stamina+", floor="+SpendStamina.floor+", burn="+SpendStamina.canBurn);return false}if(stamina<SpendStamina.ceiling&&!SpendStamina.canBurn&&!GM_getValue("useStaminaStarted")){DEBUG("Rebuilding stamina: stamina="+stamina+", ceiling="+SpendStamina.ceiling+", burn="+SpendStamina.canBurn);return false}if(b==STAMINA_HOW_ROBBING||b==STAMINA_HOW_FIGHTROB||STAMINA_HOW_ROBBING_BG)return stamina>=25;return true}function autoHitlist(){var a=GM_getValue("autoHitListLoc",NY);if(a<=cities.length-1&&city!=a){Autoplay.fx=function(){goLocation(a)};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}if(!onFightTab()&&!autoHitlist.profileSearch&&!autoHitlist.setBounty){Autoplay.fx=goFightTab;Autoplay.start();return true}var b=GM_getIntValue("pautoHitOpponentList","");if(!b){if(isGMEqual("staminaSpendHow",STAMINA_HOW_RANDOM))return false;addToLog("warning Icon","Can't autohit because the list of opponents is empty or invalid. Turning automatic hitlisting off.");GM_setValue("staminaSpend",0);if(isGMChecked("bgAutoHitCheck"))GM_setValue("bgAutoHitCheck",0);return false}opponent=new Player;opponent.id=String(b);if(!onProfileNav()&&!autoHitlist.setBounty){autoHitlist.profileSearch=opponent;Autoplay.fx=function(){goProfileNav(opponent)};Autoplay.start();return true}if(autoHitlist.profileSearch&&onProfileNav()){opponent=autoHitlist.profileSearch;autoHitlist.profileSearch=undefined;opponent.profileHitlist=xpathFirst('.//a[contains(., "Add to Hitlist")]',innerPageElt);DEBUG("Hitlisting from profile");var c=opponent.profileHitlist;autoHitlist.setBounty=true;var d=xpathFirst('.//a[contains(., "Add to Hitlist")]',innerPageElt);if(d){Autoplay.fx=function(){clickAction="autohit";clickContext=opponent;clickElement(d);DEBUG('Clicked "Add to Hitlist".')};Autoplay.start();return true}}var e=parseCash(GM_getValue("autoHitListBounty",0))-cities[NY][CITY_CASH];if(e>0){DEBUG("We need "+e+" for hitlisting. Going to the bank of "+cities[NY][CITY_NAME]);suspendBank=true;return autoBankWithdraw(e)}if(autoHitlist.setBounty){autoHitlist.setBounty=undefined;var f=xpathFirst('.//form[@id="createhit"]',innerPageElt);var g=xpathFirst('.//input[@type="text"]',f);if(!g){if(isGMChecked("bgAutoHitCheck"))setGMTime("bgAutoHitTime","01:00");return true}if(isGMChecked("autoHitListRandom"))g.value=Math.pow(10,Math.floor(Math.random()*4)+4);else g.value=parseCash(GM_getValue("autoHitListBounty",0));var h=xpathFirst('.//button[@type="submit"]',f);if(!h){if(isGMChecked("bgAutoHitCheck"))setGMTime("bgAutoHitTime","01:00");return true}Autoplay.fx=function(){clickAction="autohit";clickContext=opponent;h.click();DEBUG("Clicked to Set Bounty")};Autoplay.start();return true}}function autoFight(a){Autoplay.delay=noDelay;var b=GM_getValue("fightLocation",NY);if(b==RANDOM_CITY)b=GM_getValue("fightNewLocation",NY);if(b!=ACTIVE_CITY&&city!=b){Autoplay.fx=function(){goLocation(b)};Autoplay.start();return true}if(!onFightTab()&&!autoFight.profileSearch&&a!=STAMINA_HOW_BATTLE){Autoplay.fx=goFightTab;Autoplay.start();return true}if(a!=STAMINA_HOW_FIGHT_LIST){if(a==STAMINA_HOW_BATTLE&&!onBattlePage(2)){Autoplay.fx=goBattlePage(2);Autoplay.start();return true}if(a==STAMINA_HOW_BATTLE&&xpathFirst('//a[contains(@href,"xw_controller=epicBattle") and contains(@href,"xw_action=optIn")]',innerPageElt)){elt=xpathFirst('//a[contains(@href,"xw_controller=epicBattle") and contains(@href,"xw_action=optIn")]',innerPageElt);clickElement(elt);Autoplay.start();return true}var c=GM_getValue("fightRivalsMode",0);if(onFightersTab()&&!autoFight.profileSearch&&c&&a!=STAMINA_HOW_BATTLE){Autoplay.fx=goRivalsTab;Autoplay.start();return true}if(onRivalsTab()&&!autoFight.profileSearch&&!c&&a!=STAMINA_HOW_BATTLE){Autoplay.fx=goFightersTab;Autoplay.start();return true}}var d;var e;if(autoFight.revengeTarget){colorDEBUG("autoFight - We already have a target : revengeTarget");d=autoFight.revengeTarget;autoFight.revengeTarget=undefined;lastOpponent=undefined}else if(autoFight.profileSearch&&onProfileNav()){d=autoFight.profileSearch;var f=xpathFirst('.//a[contains(., "Remove from Mafia")]',innerPageElt);if(f){removeSavedListItem("pfightlist",d.id);autoFight.profileSearch=undefined;lastOpponent=undefined;return false}else{autoFight.profileSearch=undefined;lastOpponent=undefined;if(isGMChecked("staminaPowerattack"))d.profileAttack=xpathFirst('.//a[(contains(@onclick,"xw_action=power_attack") or contains(@href,"xw_action=power_attack")) and contains(., "Power Attack")]',innerPageElt);if(!d.profileAttack)d.profileAttack=xpathFirst('.//a[(contains(@onclick,"xw_action=attack") or contains(@href,"xw_action=attack")) and contains(., "Attack")]',innerPageElt);var g=xpathFirst('//div[@class="stats_title_text"]');if(g){if(g.innerHTML.match(/[^"]"(.+)" level (\d+)/)){d.name=RegExp.$1;d.level=RegExp.$2;d.linkedName=d.name}}d.mafia="unknown"}}else if(a==STAMINA_HOW_FIGHT_LIST){id=parseInt(GM_getValue("pfightlist",""));if(!id){if(isGMEqual("staminaSpendHow",STAMINA_HOW_RANDOM))return false;addToLog("warning Icon","Can't fight because the list of opponents is empty or invalid. Turning automatic fighting off.");GM_setValue("staminaSpend",0);return false}d=new Player;d.id=String(id);var h=GM_getValue("profileList","");if(IsJsonString(h))var i=JSON.parse(h);else var i=[];var j=i.searchArray(d.id,0)[0];if(!isNaN(j))d.profileAttack=makeElement("a",null,{href:i[j][1]})}else{d=findFightOpponent(innerPageElt,a);if(d===-1){DEBUG("No opponents even after seeing the fight list.");setNextFightCity();return false}}if(!d)return false;e=d.profileAttack;if(!e&&d.attack)e=d.attack;if(lastOpponent&&lastOpponent.attackAgain&&d.match(lastOpponent)){e=lastOpponent.attackAgain}if(!e){if(d.id&&!onProfileNav()){autoFight.profileSearch=d;Autoplay.fx=function(){goProfileNav(d)};Autoplay.start();return true}DEBUG("No way to attack opponent, id="+d.id);return false}if(e.hasAttribute("href")){var k=e.getAttribute("href");k=k.replace(/attack_pop/,"attack_true_pop");if(k!="javascript://"){var l=makeElement("a",null,null);l.setAttribute("onclick","do_ajax('inner_page','"+k+"',1);return false;");l.innerHTML=e.innerHTML}}else var l=e;Autoplay.fx=function(){if(isNewCity(city)||l.innerHTML.match(/(\d+)/i))clickAction="multifight";else clickAction="fight";clickContext=d;clickElement(l);if(isGMChecked("staminaLogDetails"))addToLog("process Icon","Clicked to "+clickAction+" : name="+d.name+", level="+d.level+", mafia="+d.mafia+", badge: "+d.fightlabel)};Autoplay.delay=noDelay;Autoplay.start();return true}function setNextFightCity(){var a=GM_getValue("fightLocation",NY);if(a!=RANDOM_CITY)return;var b;do{b=Math.floor(Math.random()*(cities.length-1))}while(b==1||level<cities[b][CITY_LEVEL]||isGMEqual("fightNewLocation",b));DEBUG("Changing to "+cities[b][CITY_NAME]+" for next fight.");GM_setValue("fightNewLocation",b)}function autoRob(){var a=GM_getValue("robLocation",NY);var b=1750-GM_getIntValue("fastRobSpeed",0)*250;if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse())b*2;Autoplay.delay=noDelay;if(city!=a){Autoplay.fx=function(){goLocation(a)};Autoplay.start();return true}if(!onRobbingTab()){Autoplay.fx=goRobbingTab;Autoplay.start();return true}var c=xpathFirst('//a[@class="sexy_button_new short white" and contains(., "Ask for More") and not(contains(@style, "none"))]');if(!c)c=xpathFirst('//a[@class="rob_post_phone_button sexy_button_new short white" and contains(., "Ask") and not(contains(@style, "none"))]');if(c)clickElement(c);if(needToRefresh()){Autoplay.fx=refreshRobbingGrid;Autoplay.start();return true}var d=true;if(isGMChecked("useRobSquads")){var e=xpathFirst('.//div[@class="rob_counter_spree"]//span[@id="call_sprees_left"]');var f=0;if(e){f=parseInt(e.innerHTML.untag())}if(f>0){DEBUG(" Currently : "+f+" Rob Squads available");var g=xpathFirst('.//a[@id="oneClickRobAll" and contains(@onclick,"RobbingController.robAllHelper")]');eltRobButtonInner=g.innerHTML.untag();if(eltRobButtonInner.match(/(\d+)/))stamReqRobSquad=parseInt(RegExp.$1)}if(f>0&&stamReqRobSquad<stamina){d=false;Autoplay.fx=function(){DEBUG(" clicked to use Rob Squad");clickAction="autoRob";clickContext={elt:g.id,name:"RobSquads",result:""};clickElement(g)}}}if(d){Autoplay.fx=function(){var a;var c=getCurRobButton();var d=getCurRobSlotId(c);var e=xpathFirst('.//div[@id="'+d+'" and @class="rob_slot"]');var f=xpathFirst('.//div[@id="'+d+'" and @class="rob_slot"]//div[@class="rob_prop_name_short"]');if(f){a=f.innerHTML}clickAction="autoRob";clickContext={elt:d,name:a,result:""};doRob(c,b)}}Autoplay.start();return true}function onRobbingTab(){if(xpathFirst('.//li[contains(@class, "tab_on")]//a[contains(., "Robbing")]')){return true}return false}function goRobbingTab(){var a=xpathFirst('.//div[@class="tab_content"]//a[contains(., "Robbing")]');if(!a){goFightNav();return}clickElement(a)}function needToRefresh(){var a=$x('.//div[@class="rob_btn"]//a[@class="sexy_button_new sexy_button_new short red impulse_buy"]');var b=xpathFirst('.//a[@id="rob_refresh_cost"]//span[contains(.,"0 stamina")]');if(!b)b=xpathFirst('.//a[@id="rob_refresh_cost"]//span[contains(.,"Refresh: 0")]');if(b&&a.length==0)return true;else return false}function refreshRobbingGrid(){var a=xpathFirst('.//a[@id="rob_refresh_cost"]//span[contains(.,"0 stamina")]');if(!a)a=xpathFirst('.//a[@id="rob_refresh_cost"]//span[contains(.,"Refresh: 0")]');if(!a)return;clickElement(a)}function doRob(a,b){function c(){if(f.length>0){var a=f.shift();clickElement(a)}else window.clearInterval(g)}useBurnersFirst=false;var d=xpathFirst('.//span[@id="call_backup_phones_left"]',innerPageElt);if(d)var e=parseInt(d.innerHTML.untag());if(e&&isGMChecked("useBurners")){DEBUG("doRob : you still have "+e+" burners ... using these first");useBurnersFirst=true}if(isGMChecked("fastRob")&&!useBurnersFirst){var f=$x('.//div[@class="rob_btn"]//a[@class="sexy_button_new sexy_button_new short red impulse_buy"]');if(!f||f.length==0)return;DEBUG("Starting fastRob: Clicking "+f.length+" rob buttons at "+b+" interval");var g=window.setInterval(c,b)}else{if(!a)a=xpathFirst('//div[@class="rob_btn"]//a[@class="sexy_button_new sexy_button_new short red impulse_buy"]');if(!a)return;var h;var i=xpathFirst('./div[@class="rob_prop_stamina"]',a.parentNode.parentNode);if(i){if(h=/(.*)/.exec(i.innerHTML)){GM_setValue("totalRobStamInt",isNaN(GM_getIntValue("totalRobStamInt",0))?0:GM_getIntValue("totalRobStamInt",0)+parseInt(h[1].digitize()))}}clickElement(a);DEBUG("Clicked to rob.")}}function getCurRobButton(){if(isGMChecked("useBurners")){var a=$x('//a[@class="sexy_button_new short white" and contains(., "Call For Backup") and not(contains(@style, "none"))]');var b=xpathFirst('.//div[@class="rob_board"]');if(a&&a.length>0){for(i=0,iLength=a.length;i<iLength;i++){var c=a[i];var d=getCurRobSlotId(c);var e=d.replace(/[^0-9]/g,"");var f=xpathFirst('./div[@id="'+d+'"]');var g="rob_flag_"+e;if(c&&!xpathFirst('./div[@id="'+g+'"]',b)){setListenContent(false);makeElement("div",b,{id:g,style:"display: none;"});setListenContent(true);return c}}}}eltRob=xpathFirst('//div[@class="rob_btn"]//a[@class="sexy_button_new sexy_button_new short red impulse_buy"]');if(eltRob){DEBUG("Clicking 'Rob'-button.");return eltRob}}function getCurRobSlotId(a){if(a.innerHTML.untag()=="Rob")return a.parentNode.parentNode.parentNode.id;if(a.innerHTML.untag()!="Rob")return a.parentNode.parentNode.parentNode.parentNode.id;return null}function logRobResult(a){var b=a.innerHTML;var c=b.untag().toLowerCase();var d=0;var e=0;var f=0;var g=0;var h=$x('.//div[@class="rob_res_expanded_details"]',a);var j="";if(h&&h.length>0){for(i=0,iLength=h.length;i<iLength;i++){var k=h[i];var l=k.innerHTML.untag();var m=xpathFirst('.//div[@class="rob_res_expanded_details_cash"]',k);if(m)if(m.innerHTML.untag().match(REGEX_CASH))d+=parseCash(RegExp.lastMatch);var n=xpathFirst('.//div[@class="rob_res_expanded_details_exp"]',k);if(n)if(n.innerHTML.untag().match(/(\d+) Experience/))e+=parseInt(RegExp.$1);if(l.match(/\+(\d+) Energy/))f+=parseInt(RegExp.$1);if(l.untag().match(/\+(\d+) Stamina/))g+=parseInt(RegExp.$1)}if(d)j+=' <span class="good">'+cities[city][CITY_CASH_SYMBOL]+makeCommaValue(d)+"</span>";if(e)j+=' and <span class="good">'+e+" experience</span>";if(f)j+=' and <span class="user">'+f+" energy</span>";if(g)j+=' and <span class="bad">'+g+" stamina</span>";j="RX6 gained "+j+"."}DEBUG("Popup Process: Processing robbing board");if(c.match(/(\d+) bonus experience/i)){var o=parseInt(RegExp.$1.replace(/[^0-9]/g,""));var p="";var q=parseInt(boardLastPtsToNextLevel)-parseInt(ptsToNextLevel);if(!q)q=e+o;var r=parseInt(boardLastStamina)-parseInt(stamina);var s=parseFloat(q/r).toFixed(2);var t=0;var u=0;if(b.match(/your record on this board was\s+(.+?)\./i)){var v=RegExp.$1;if(v.match(/(\d)-(\d)/)){t=parseInt(RegExp.$1);u=parseInt(RegExp.$2);DEBUG("robWins: "+t+"/ robLosses: "+u)}p='<br>Board Record: <span class="good">'+v+"</span>"}addToLog("yeah Icon","Robbing board cleared. "+j+' Bonus: <span class="good">'+o+" experience</span>."+p+" - Ratio: "+q+"/"+r+" ("+s+") ");boardLastStamina=parseInt(stamina);boardLastPtsToNextLevel=parseInt(ptsToNextLevel);if(!isGMChecked("noStats")){if(o)updateRobStatistics(null,parseInt(o));if(t)updateFastRobStatistics(true,t);if(u)updateFastRobStatistics(false,u);if(o||t||u)updateLogStats()}var w="";if(b.match(/you\s+(earned|gained|received|collected)\s+(some|an?)\s+bonus\s+(.+?)<\/div>/i)){w+='RX6 found <span class="loot">'+RegExp.$3+"</span> on robbing board."}var x=xpathFirst('.//img[contains(@class,"item_with_preview")]',a);if(x)w+='<br><div class="lootImg">'+x.parentNode.innerHTML+"</div>"}if(w)addToLog("lootbag Icon",w)}function logRobResponse(a){var b=a.elt;var c=a.name;var d=a.result;var e;var f=false;var g=d;if(!g)g=xpathFirst('//div[@id="'+b+'" and @class="rob_slot"]');if(g){var h="";var i=false;var j=xpathFirst('.//div[@class="rob_res_target_name"]/a[contains(@href,"xw_controller=clan")]',g);if(j){h+=linkToString(j,"user")}var k=xpathFirst('.//div[@class="rob_res_target_name"]/a[contains(@href,"xw_controller=stats")]',g);if(k){h+=linkToString(k,"user")}else{var l=xpathFirst('.//div[@class="rob_res_target_pic"]//a//img',g);if(l)h='<span class="user">'+l.title+"</span>";else h='<span class="user">Unknown Target</span>'}var m=xpathFirst('.//div[@class="rob_res_expanded_details_exp"]',g);var n=xpathFirst('.//div[@class="rob_res_expanded_details_cash"]',g);var o=xpathFirst('.//div[@class="rob_res_expanded_details_energy"]',g);var p=xpathFirst('.//div[@class="rob_res_expanded_details_stamina"]',g);var q=xpathFirst('.//div[@class="rob_res_expanded_details_health"]',g);var r="RX6 robbed "+h;if(!c){var s=xpathFirst('.//div[contains(@class,"rob_prop_name")]',g);if(s)c=s.innerHTML.untag().capitalize()}if(c)r+='\'s <span class="property">'+c+"</span> ";var t="";var u=0;var v=0;var w=0;var x;if(xpathFirst('.//div[@class="rob_res_outcome good"]',g)){r+=' with <span class="good">Success</span>. ';i=true;x="yeah Icon"}else{r+=' and <span class="bad">Failed</span>.';x="updateBad Icon"}if(m){r+=' You gained <span class="good">'+m.innerHTML+"</span>";if(e=/(\d+) experience/i.exec(m.innerHTML)){updateRobStatistics(i,parseInt(e[1].digitize()));f=true}}if(i){if(n)r+=' and <span class="good">'+n.innerHTML+"</span>";if(o){r+='. You also gained <span class="user">'+o.innerHTML+"</span>";u=o.innerHTML.digitize()}if(p){r+='. You also gained <span class="bad">'+p.innerHTML+"</span>";v=p.innerHTML.digitize()}if(q){r+='. You also gained <span class="bad">'+q.innerHTML+" health</span>";w=q.innerHTML.digitize()}}addToLog(x,r+".");if(e=/alt="(.*?)"/.exec(g.innerHTML)){var y='RX6 found <span class="loot">'+e[1]+"</span> in robbing.";var z=xpathFirst('.//div[@class="rob_loot_pic"]',g);if(!z)z=xpathFirst('.//div[@class="rob_res_lootdrop_name"]',g);if(z)y+='<br><div class="lootImg">'+z.innerHTML+"</div>";addToLog("lootbag Icon",y)}if(n&&n.innerHTML){var A=parseCash(n.innerHTML);var B=parseCashLoc(n.innerHTML);GM_setValue("totalWinDollarsInt",String(GM_getIntValue("totalWinDollarsInt",0)+A));GM_setValue(cityStats[B][cashWins],String(GM_getIntValue(cityStats[B][cashWins],0)+A));f=true}}if(!d)randomizeStamina();if(f&&!isGMChecked("noStats"))updateLogStats()}function updateFastRobStatistics(a,b){if(a)GM_setValue("robSuccessCountInt",String(GM_getIntValue("robSuccessCountInt",0)+b));else if(a==false)GM_setValue("robFailedCountInt",String(GM_getIntValue("robFailedCountInt",0)+b))}function updateRobStatistics(a,b){if(a)GM_setValue("robSuccessCountInt",String(GM_getIntValue("robSuccessCountInt",0)+1));else if(a==false)GM_setValue("robFailedCountInt",String(GM_getIntValue("robFailedCountInt",0)+1));if(b){GM_setValue("totalRobExpInt",String(GM_getIntValue("totalRobExpInt",0)+parseInt(b)));GM_setValue("totalExpInt",String(GM_getIntValue("totalExpInt",0)+parseInt(b)))}}function autoHitman(){Autoplay.delay=noDelay;var a,b=GM_getValue("hitmanLocation",NY);if(b<=cities.length-1&&city!=b){Autoplay.fx=function(){goLocation(b)};Autoplay.start();return true}if(!onHitlistTab()){Autoplay.fx=goHitlistTab;Autoplay.start();return true}opponentsQualified=findFightOpponent(innerPageElt,STAMINA_HOW_HITMAN);if(!opponentsQualified.length)return false;var c=0;switch(GM_getValue("bountySelection",BOUNTY_HIGHEST_BOUNTY)){case BOUNTY_LONGEST_TIME:c=opponentsQualified.length-1;break;case BOUNTY_HIGHEST_BOUNTY:var d=0;for(a=0,iLength=opponentsQualified.length;a<iLength;a++){if(parseCash(opponentsQualified[a].bounty)>d){c=a;d=parseCash(opponentsQualified[a].bounty)}}break;case BOUNTY_RANDOM:c=Math.floor(Math.random()*opponentsQualified.length);break;case BOUNTY_SHORTEST_TIME:default:c=0}Autoplay.fx=function(){clickAction="hitman";clickContext=opponentsQualified[c];clickElement(clickContext.attack);DEBUG("Clicked to hit "+clickContext.name+" ("+clickContext.id+").")};Autoplay.start();return true}function getStaminaMode(){var a=GM_getValue("staminaSpendHow");if(a==STAMINA_HOW_RANDOM){if(isUndefined(newStaminaMode))newStaminaMode=Math.floor(Math.random()*(staminaSpendChoices.length-1));a=newStaminaMode}else newStaminaMode=undefined;return parseInt(a)}function autoStaminaSpend(){if(!isGMChecked("staminaSpend")){DEBUG("staminaSpend DISABLED - returning false",10);return false}if(stamina<5){var a=GM_getValue("fightLocation",NY);if(a==RANDOM_CITY)a=GM_getValue("fightNewLocation",NY);if(isNewCity(a)){DEBUG("staminaSpend SUSPENDED: stamina="+stamina+", city="+cities[BRAZIL][CITY_NAME],10);return false}}if(SpendStamina.floor&&isGMChecked("allowStaminaToLevelUp")&&GM_getValue("autoStamBurn")!==SpendStamina.canBurn){GM_setValue("autoStamBurn",SpendStamina.canBurn);if(SpendStamina.canBurn){addToLog("process Icon",staminaIcon+'<span style="color:#009966; font-weight: bold;">Burning through stamina reserve to level up.</span>');autoHeal(2)}else DEBUG("Not within reach of a level up. Stamina burning is off.",10)}var b=getStaminaMode();switch(b){case STAMINA_HOW_FIGHT_RANDOM:case STAMINA_HOW_FIGHT_LIST:if(inClanBattle&&isGMChecked("AutoBattleFight"))b=STAMINA_HOW_BATTLE;return autoFight(b);break;case STAMINA_HOW_FIGHTROB:if(health<21&&stamina>25)return autoRob();else{if(inClanBattle&&isGMChecked("AutoBattleFight"))b=STAMINA_HOW_BATTLE;return autoFight(b)}break;case STAMINA_HOW_ROBFIGHT:if(stamina>GM_getValue("robFightStaminaFloor"))return autoRob();else{if(inClanBattle&&isGMChecked("AutoBattleFight"))b=STAMINA_HOW_BATTLE;return autoFight(b)}break;case STAMINA_HOW_ROBBING:return autoRob();break;case STAMINA_HOW_HITMAN:return autoHitman(b);break;case STAMINA_HOW_AUTOHITLIST:return autoHitlist();break;case STAMINA_HOW_ROBBING_BG:return false;break;default:colorDEBUG("BUG DETECTED: Unrecognized stamina setting: "+"staminaSpendHow="+b,cre);break}return false}function autoBankDeposit(a,b){if(!quickBankFail)return false;if(!b||b<10)return false;if(a==LV){quickBankFail=false;return false}var c=xpathFirst('.//div[@id="bank_popup"]',popupfodderElt);if(!c||c.parentNode.style.display=="none"){Autoplay.fx=goBank;Autoplay.start();return true}if(b){var d=xpathFirst('.//input[@id="deposit_amount"]',c);if(!d){DEBUG("BUG DETECTED: No text input at bank.");return false}d.value=b}var e=xpathFirst('.//div[@id="bank_dep_button"]/a[contains(@onclick,"deposit(")]',c);if(!e){DEBUG("BUG DETECTED: No submit input at bank.");return false}if(city!=a){DEBUG("Switching city too fast, not banking cash.");return false}Autoplay.fx=function(){clickContext=a;clickAction="deposit";clickElement(e);DEBUG("Clicked to deposit.")};Autoplay.start();return true}function autoBankWithdraw(a){if(city==LV){var b="xw_controller=propertyV2&xw_action=doaction&xw_city=5&doaction=ActionBankWithdrawal&building_type=6&city=5&amount="+a;var c=createAjaxPage(false,"quick withdraw",LV);var d=makeElement("a",null,{onclick:'return do_ajax("'+c+'","remote/html_server.php?'+b+'", 1, 1, 0, 0); return false;'});clickElement(d);DEBUG("Clicked to withdraw from the vault.");return true}var e=xpathFirst('.//div[@id="bank_popup"]');if(!e||e.parentNode.style.display=="none"){Autoplay.fx=goBank;clickAction="withdraw";clickContext=a;Autoplay.start();return true}if(a){var f=xpathFirst('.//input[@id="withdraw_amount"]',e);if(!f){DEBUG("BUG DETECTED: No text input at bank.");return false}f.value=a}var g=xpathFirst('.//div[@id="bank_with_button"]//a',e);if(!g)return false;Autoplay.fx=function(){clickAction="withdraw";clickElement(g);DEBUG("autoBankWithdraw: Clicked to withdraw.")};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}function getDisplayedOpponents(a,b,c,d){getDisplayedOpponents.opponents=[];var e,f,g,h,i,j=true;if(running&&(c==STAMINA_HOW_RANDOM||c==STAMINA_HOW_FIGHT_RANDOM||c==STAMINA_HOW_FIGHT_BG||c==STAMINA_HOW_ROBFIGHT||c==STAMINA_HOW_FIGHTROB)){var k=GM_getValue("fightRivalsMode",0);if(k&&(!d||d==0)){var l=true;var m=fightRivalsModes[GM_getValue("fightRivalsMode",0)];var n=$x('.//table[@class="main_table fight_table"]//tr',a);for(e=0;e<n.length;e++){rowElt=n[e];var o=xpathFirst(".//th",rowElt);if(o){var p=o.innerHTML;if(p.indexOf(m)!=-1)l=false;else l=true}else{if(l){rowEltContent=rowElt.innerHTML.untag();rowElt.parentNode.removeChild(rowElt)}}}}}var q=$x('.//table[@class="main_table fight_table"]//a[(contains(@href,"opponent_id") or contains(@href, "NPC_id")) and not(contains(@href,"challengePop"))]',a);if(!q||q.length==0)q=$x('.//div[@id="battle_target_list"]//a[contains(@href, "opponent_id")]',a);if(!q||q.length==0)q=$x('.//table[@class="hit_list"]//a[contains(@href,"target_pid") and not(contains(@href,"challengePop"))]',a);if(q&&q.length>0){for(e=0,iLength=q.length;e<iLength;e++){f=q[e];i=new Player;g=f.parentNode.parentNode;rowInnerUntag=g.innerHTML.untag();h=g.getElementsByTagName("td");if(!h.length)h=g.getElementsByTagName("div");nameAndLevel=h[0];i.mafia=-1;i.level=-1;i.charClass="";if(f.href.indexOf("NPC")!=-1){i.a_type="attack";i.nameElt=xpathFirst(".//span",nameAndLevel);i.name=i.nameElt.innerHTML;i.profile=f;i.linkedName=i.name;i.attack=f;i.fightlabel=0;i.iced=false;i.title="";var r;if(i.profile.hasAttribute("href"))r=i.profile.getAttribute("href");if(r.match(/NPC_id\=(\d+)&+/)){i.id=decodeID(RegExp.$1)}i.button=f.getAttribute("href").replace(/&/g,"&").replace(/remote\/html_server.php\?/,"");if(i.id){getDisplayedOpponents.opponents=[];getDisplayedOpponents.opponents.push(i);break}}else{if(!xpathFirst('.//a[contains(@href,"xw_controller=stats")]',nameAndLevel)){nameAndLevel=h[1];i.payer=h[2].innerHTML;if(h[3].innerHTML.match(REGEX_CASH))i.bounty=RegExp.lastMatch;i.time=h[4].innerHTML.untag().trim()}else i.mafia=h[1]?parseInt(h[1].innerHTML):0;nalInnerUntag=nameAndLevel.innerHTML.untag();i.familyElt=xpathFirst('.//a[contains(@href,"xw_controller=clan")]',nameAndLevel);i.nameElt=xpathFirst('.//a[contains(@href,"xw_controller=stats")]',nameAndLevel);i.titleElt=xpathFirst('.//div[@class="fight_list_name_area"]//span',nameAndLevel);if(i.titleElt)i.title=i.titleElt.innerHTML.untag().trim();i.profile=i.nameElt;if(!i.profile)continue;var r;if(i.profile.hasAttribute("href"))r=i.profile.getAttribute("href");if(r.match(/(user|opponent_id|target_pid)\=(.+)&?/)){i.id=decodeID(RegExp.$2)}if(!i.id)continue;i.a_type="attack_pop";i.attack=f;i.button=f.getAttribute("href").replace(/&/g,"&").replace(/remote\/html_server.php\?/,"");if(!i.mafia&&rowInnerUntag.match(/Mafia.*?(\d+)/i))i.mafia=parseInt(RegExp.$1);if(nalInnerUntag.match(/level\s*?(\d+)\s*(.+)/i)){i.level=parseInt(RegExp.$1);i.charClass=RegExp.$2.trim()}else if(nalInnerUntag.match(/level.*?(\d+)/i/e)){i.level=parseInt(RegExp.$1)}if(i.familyElt){i.name=i.familyElt.innerHTML;i.linkedName=linkToString(i.familyElt,"user")}if(i.name){i.name+=" "+i.nameElt.innerHTML;i.linkedName+=linkToString(i.nameElt,"user")}else{i.name=i.nameElt.innerHTML;i.linkedName=linkToString(i.nameElt,"user")}i.fightlabel=0;var s=xpathFirst(".//img",h[0]);if(s){userBadge=s.title;var t=fightLabels.searchArray(userBadge,0)[0];if(!isNaN(t))i.fightlabel=t}if(h[0].style.color=="rgb(102, 102, 102)"||h[0].className=="fight_list_player_dead"){i.iced=true;if(!running&&isGMChecked("showPulse"))g.style.display="none"}else i.iced=false;if(i.profile.previousSibling&&i.profile.previousSibling.nodeValue.match(/\w+(?: \w+)*/)){i.title=RegExp.lastMatch}getDisplayedOpponents.opponents.push(i)}}}DEBUG(getDisplayedOpponents.opponents.length+" opponents listed.");if(!getDisplayedOpponents.opponents.length)return[];return getDisplayedOpponents.opponents}function findFightOpponent(a,b,c){fightListNew.set([]);var d=getDisplayedOpponents(a,true,b,c);if(!d)return-1;if(b==STAMINA_HOW_HITMAN){var e=isGMChecked("hitmanNames");var f=isGMChecked("hitmanAvoidNames");var g=isGMChecked("hitmanOnlyNames");var h=parseCash(GM_getValue("hitmanBountyMin",0));var i=GM_getValue("bountySelection",BOUNTY_HIGHEST_BOUNTY)==BOUNTY_EXACT_AMOUNT}else{var e=isGMChecked("fightNames");var f=isGMChecked("fightAvoidNames");var g=isGMChecked("fightOnlyNames")}var j=GM_getIntValue("fightLevelMax",100);var k=GM_getIntValue("fightMafiaMax",501);var l=GM_getIntValue("fightMafiaMin",1);var m=GM_getIntValue("fightLabelCriteria",0);if(GM_getValue("fightLevelMaxRelative",false))j=j+level;if(GM_getValue("fightMafiaMaxRelative",false))k=k+mafia;if(GM_getValue("fightMafiaMinRelative",false))l=mafia-l;if(l>501)l=501;DEBUG("Applying criteria to displayed opponents ("+d.length+"): "+"level <= "+j+", mafia between "+l+" and "+k+".");var n=0;var o=0;var p=0;var q=0;var r=0;var s=0;var t=0;var u=0;var v=d.length;var w=GM_getValue("fightRivalsMode",0);for(var x=0;x<v;++x){var y=d[x];if(!y.id)continue;if(m&&m<y.fightlabel){t++;continue}if(GM_getValue("fightMobMode")){if(y.level>j*501/y.mafia&&y.level>0){n++;continue}}else{if(y.level>j&&y.level>0){n++;continue}}if(y.mafia>k&&y.mafia>0){o++;continue}if(y.mafia<l&&y.mafia>0){p++;continue}if(e&&f&&isFamily(decodeHTMLEntities(y.linkedName),b)){q++;continue}if(e&&g&&!isFamily(decodeHTMLEntities(y.linkedName),b)){q++;continue}if(isGMChecked("iceCheck")&&y.iced){s++;continue}var z=parseCash(y.bounty);if(z&&(z<h||i&&z>h)){u++;continue}var A=fightListAvoid.indexOf(y);if(A!=-1&&isGMChecked("fightRemoveStronger")){fightListAvoid.get()[A].update(y);r++;continue}var A=hitmanListAvoid.indexOf(y);if(A!=-1&&isGMChecked("fightRemoveStronger")){hitmanListAvoid.get()[A].update(y);r++;continue}if(!fightListNew.add(y)){r++;continue}else if(!w&&b!=STAMINA_HOW_HITMAN||GM_getValue("readValueSum",returnValue())!=parseXMLResponse())break}var B=n+o+p+q+s+r+t+u;if(B){DEBUG("Out of the "+v+" opponent(s) listed on the fight page "+B+" disqualified:<br>"+n+" on max level, "+o+" on max mafia, "+p+" on min mafia,<br>"+q+" on name pattern, "+s+" already iced, "+u+" on bounty<br>"+t+" on fight label, "+r+" by blacklisting (stronger opponents).")}newOpponents=fightListNew.get();if(!newOpponents.length)return-1;newOpponents.sort(function(a,b){return a.mafia*a.level/501-b.mafia*b.level/501});var C=newOpponents.length;if(C>3)C=3;if(b!=STAMINA_HOW_HITMAN){return newOpponents[Math.floor(Math.random()*C)]}else return newOpponents}function setFightOpponentAvoid(a){if(!a)return;fightListAvoid.add(a,100);fightListAvoid.set();if(fightListNew.remove(a))fightListNew.set();DEBUG("Fightlists updated for fight opponent (name: "+a.linkedName+")");removeSavedListItem("pfightlist",a.id)}function setHitmanOpponentAvoid(a){if(!a)return;DEBUG("Marking hitlist opponent "+a.linkedName+" avoid.");hitmanListAvoid.add(player,100);fightListAvoid.set()}function toggleSettings(){updateMastheadMenu();if(settingsOpen===false){destroyByID("apimg");makeElement("img",document.getElementById("ap_img"),{id:"apimg",src:"http://cdn.playerscripts.co.uk/images/mwap_graphics/32_grey.png"});Autoplay.clearTimeout();Reload.clearTimeout();settingsOpen=true;createSettingsBox();showSettingsBox()}else{settingsOpen=false;destroyByID("MWAPSettingsBox");Autoplay.delay=150;Autoplay.start();autoReload(false,"toggle settings")}}function showSettingsBox(){var a=document.getElementById("MWAPSettingsBox");if(a){a.style.display="block"}}function showMafiaLogBox(){if(!document.getElementById("mafiaLogBox")){createLogBox()}else{var a=document.getElementById("mafiaLogBox");a.style.display="block"}if(!debug&&GM_getValue("logOpen")!="open"&&!isGMChecked("autoLog")){alert('Logging is not enabled. To see new activity here, please open your settings and check "Enable logging" in the General tab.')}GM_setValue("logOpen","open")}function hideMafiaLogBox(){if(isGMChecked("autoLog")){var a=document.getElementById("mafiaLogBox");a.style.display="none"}else destroyByID("mafiaLogBox");GM_setValue("logOpen","closed")}function handleVersionChange(){var a=SCRIPT.version.split(".");cmain_ver=parseInt(a[0]);csub_ver=parseInt(a[1]);curbuild=parseInt(a[2]);var b=GM_getValue("version","1.1.1000");var c=b.split(".");lmain_ver=parseInt(c[0]);lsub_ver=parseInt(c[1]);lastbuild=parseInt(c[2]);if(lastbuild<updtJobArrayIfWasBelow||lsub_ver<csub_ver||lmain_ver<cmain_ver){GM_setValue("missions",0);addToLog("process Icon","Builds, Loading :"+curbuild+" Upgrade Jobs If We Were Below :"+updtJobArrayIfWasBelow+" Clearing stored missions array to reload")}else addToLog("info Icon","Builds, Loading :"+curbuild+" Was Running :"+lastbuild+" Upgrade Jobs If We Were Below :"+updtJobArrayIfWasBelow);GM_setValue("version",SCRIPT.version);addToLog("updateGood Icon","Now running version "+SCRIPT.version+".")}function saveDefaultSettings(){try{var a;defaultCheckBoxElementArray(["autoPauseBefore"],"checked");defaultCheckBoxElementArray(["autoPause","autoPauseAfter","autoProcessPopups","forceLevelSpending","AutoSlotMachine"],"unchecked");GM_setValue("fastMWAPSpeed",3);GM_setValue("autoPauseExp","50");GM_setValue("idleLocation",NY);GM_setValue("burnOption",0);defaultCheckBoxElementArray(["autoLog"],"checked");defaultCheckBoxElementArray(["textOnlyMode","filterLog","leftAlign","mastheadOnTop","fbwindowtitle","showPulse","showLevel","hideAll","hideZyngaBanner","hideClanChat","noStats","playMWCom","playMWAPLite","playMWAPRX2","playMWAPLiteRX2"],"unchecked");GM_setValue("autoLogLength","300");GM_setValue("logPlayerUpdatesMax",50);GM_setValue("filterLog",0);GM_setValue("filterOpt",0);logFilterOnOff(1);GM_setValue("filterPass",defaultPassPatterns.join("\n"));GM_setValue("filterFail",defaultFailPatterns.join("\n"));defaultCheckBoxElementArray(["autoAskJobHelp","acceptMafiaInvitations","autoAskCityCrew","logPlayerUpdates","autoGlobalPublishing","autoIcePublish","autoShareWishlist","autoAcceptMsgGifts","autoAcceptMsgBoosts","autoAcceptMsgCrew","autosendMsgEnergyPack"],"unchecked");GM_setValue("autoAskJobHelpMinExp",0);GM_setValue("selectBrazilTier",0);GM_setValue("selectChicagoTier",0);GM_setValue("selectLondonTier",0);GM_setValue("selectVegasTier",0);GM_setValue("autoIcePublishFrequency",1);GM_setValue("autoShareWishlistTime",1);GM_setValue("warMode",0);GM_setValue("autoWarTargetList","");defaultCheckBoxElementArray(["autoStartFamOps","autoStartMyOps","AutoFamilyRewards","AutoBattle","AutoBattleFight","AutoBattleSafehouse","autoFamilyBosses","autoFamilyBossFighting","askBossFightBoosts","sendBossFightBoosts"],"unchecked");GM_setValue("bossRole",0);GM_setValue("bossStaminaLimit",0);GM_setValue("bossRageLimit",250);GM_setValue("selectFreeGift",0);GM_setValue("dispatchTarget",0);GM_setValue("selectAskFreeGift",0);GM_setValue("autoStat",0);GM_setValue("autoStatDisable",0);for(a=0,iLength=autoStatModes.length;a<iLength;++a)GM_setValue(autoStatModes[a],0);for(a=0,iLength=autoStatPrios.length;a<iLength;++a)GM_setValue(autoStatPrios[a],0);for(a=0,iLength=autoStatBases.length;a<iLength;++a)GM_setValue(autoStatBases[a],0);for(a=0,iLength=autoStatRatios.length;a<iLength;++a)GM_setValue(autoStatRatios[a],0);for(a=0,iLength=autoStatFallbacks.length;a<iLength;++a)GM_setValue(autoStatFallbacks[a],0);for(a=1;a<=3;a++){id="selectCityPrio"+a;GM_setValue(id,0)}for(a=1;a<cityCrewTitles.length;a++){id="selectBrazilCrew"+a;GM_setValue(id,0);id="selectChicagoCrew"+a;GM_setValue(id,0);id="selectLondonCrew"+a;GM_setValue(id,0)}GM_setValue("activateBrazilCrew",0);GM_setValue("activateChicagoCrew",0);GM_setValue("activateLondonCrew",0);defaultCheckBoxElementArray(["autoMission","repeatJob","endLevelOptimize","endLevelNYOnly","autoWithDraw","skipfight","autoFightAgostino","checkMiniPack","autoEnergyPack","autoEnergyPackForce","allowEnergyToLevelUp"],"unchecked");GM_setValue("selectTier","0.0");GM_setValue("estimateJobRatio","2");GM_setValue("autoEnergyPackForcePts",0);GM_setValue("selectEnergyKeep",0);GM_setValue("selectEnergyUse",0);GM_setValue("selectEnergyKeepMode",0);GM_setValue("selectEnergyUseMode",0);GM_setValue("selectMissionEnergyKeep",0);GM_setValue("selectMissionEnergyKeepMode",0);setSavedList("jobsToDo",[]);setSavedList("itemList",[]);GM_setValue("masteredJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");GM_setValue("availableJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");defaultCheckBoxElementArray(["iceCheck","staminaPowerattack","fightRemoveStronger","fightNames","fightAvoidNames","hitmanNames","hitmanAvoidNames","fightFallback"],"checked");defaultCheckBoxElementArray(["staminaSpend","staminaLogDetails","fightLevelMaxRelative","fightMafiaMaxRelative","fightMafiaMinRelative","fightMobMode","fightIceStealers","fightOnlyNames","allowStaminaToLevelUp"],"unchecked");GM_setValue("staminaSpendHow",STAMINA_HOW_FIGHT_RANDOM);GM_setValue("fightLocation",NY);GM_setValue("reattackThreshold",0);GM_setValue("fightLevelMax",level);GM_setValue("fightHealthMax",0);GM_setValue("fightHealthPctMax",0);GM_setValue("fightLabelCriteria",0);GM_setValue("fightMaxAttacks",0);GM_setValue("fightMafiaMax",501);GM_setValue("fightMafiaMin",1);GM_setValue("hitmanLocation",NY);GM_setValue("fightClanName",defaultClans.join("\n"));GM_setValue("hitmanClanName",defaultClans.join("\n"));GM_setValue("randomFightLocations","10000000");GM_setValue("randomRobLocations","10000000");GM_setValue("randomHitmanLocations","10000000");GM_setValue("randomSpendModes","100000");GM_setValue("robLocation",NY);GM_setValue("fastRobSpeed",0);if(GM_getValue("readValueSum",returnValue())==parseXMLResponse())GM_setValue("fastBGFSpeed",0);GM_setValue("selectStaminaKeep",0);GM_setValue("selectStaminaKeepMode",0);GM_setValue("selectStaminaUse",0);GM_setValue("selectStaminaUseMode",0);GM_setValue("selectMissionStaminaKeep",0);GM_setValue("selectMissionStaminaKeepMode",0);GM_setValue("robFightStaminaFloor",25);update_nrg_stam();defaultCheckBoxElementArray(["autoHeal","autoHealBackup","hideInHospital","forceHealOpt1","forceHealOpt3","forceHealOpt4","forceHealOpt5","forceHealOpt7","hideAttacks"],"unchecked");GM_setValue("healLocation",NY);GM_setValue("healthLevel","50");GM_setValue("stamina_min_heal",0);GM_setValue("rideHitlistXP",0);defaultCheckBoxElementArray(["collectTakeNew York","collectTakeBrazil","collectTakeChicago","collectTakeLondon","collectParts","autoBank","autoBankVegas","autoBankBrazil","autoBankChicago","autoBankLondon","askVegasParts","askPlaySlots","askBrazilParts","askChicagoParts","askLondonParts","autoLimitedParts","autoFamilyProperty"],"unchecked");for(ctCount=0;ctCount<ctLength;ctCount++){propItemId=cityProperties[ctCount][ctGMId]+"Id";defaultCheckBoxElementArray([cityProperties[ctCount][ctGMId]],"unchecked");GM_setValue(propItemId,0)}defaultCheckBoxElementArray(autoUpgradeNYBuildings,"unchecked");for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){defaultCheckBoxElementArray([cityParts[ctCount][ptGMId]],"unchecked");if(cityParts[ctCount][ptPropId]){propItemId=cityParts[ctCount][ptGMId]+"Id";GM_setValue(propItemId,0)}}GM_setValue("askVegasPartsId",1);GM_setValue("askVegasPropId",1);GM_setValue("askBrazilPartsId",1);GM_setValue("askBrazilPropId",1);GM_setValue("askChicagoPartsId",1);GM_setValue("askChicagoPropId",1);GM_setValue("askLondonPartsId",1);GM_setValue("askLondonPropId",1);GM_setValue("bankConfig","50000");GM_setValue("bankConfigVegas","50000");GM_setValue("vaultHandling",0);GM_setValue("bankConfigBrazil","50000");GM_setValue("bankConfigChicago","5000");GM_setValue("bankConfigLondon","5000");GM_setValue("autoUpgradeNYChoice",0);GM_setValue("userMinBalance",0);defaultCheckBoxElementArray(["TestChanges"],"unchecked");GM_setValue("logOpen","open");fightListNew.set([]);skipStaminaSpend=false}catch(b){DEBUG("Using defaults failed on "+b)}destroyByID("mafiaLogBox");createLogBox();toggleSettings();if(!isGMChecked("noStats"))updateLogStats();refreshMWAPCSS();sendSettings();logFilterOnOff(1);addToLog("process Icon","Options reset to defaults.")}function saveSettings(){try{var a;saveCheckBoxElementArray(["autoPause","autoProcessPopups","forceLevelSpending","AutoSlotMachine","autoSlot3FreeSpins","autoCheckReallocation"]);if(saveCheckBoxElement("autoPauseBefore")){GM_setValue("autoPauselvlExp",ptsToNextLevel);GM_setValue("autoPauseActivated",false)}if(saveCheckBoxElement("autoPauseAfter")){GM_setValue("autoPauselvlExp",ptsToNextLevel)}var b=parseInt(document.getElementById("autoPauseExp").value);if(isNaN(b))b=0;GM_setValue("autoPauseExp",b);saveElementArray([["fastMWAPSpeed",1],["autoPauseMode",1],["idleLocation",1],["burnOption",2]]);saveCheckBoxElementArray(["autoLog","textOnlyMode","filterLog","leftAlign","mastheadOnTop","fbwindowtitle","showPulse","showLevel","hideZyngaBanner","hideClanChat","noStats","hideAll","playMWCom","playFB","playMWAP","playMWAPLite","playMWAPRX2","playMWAPLiteRX2"]);var c=parseInt(document.getElementById("autoLogLength").value);if(isNaN(c))c=3e3;GM_setValue("autoLogLength",c);var d=document.getElementById("filterOpt").value;GM_setValue(d==0?"filterPass":"filterFail",document.getElementById("filterPatterns").value);GM_setValue("filterOpt",d);saveCheckBoxElementArray(["autoAskJobHelp","acceptMafiaInvitations","logPlayerUpdates","autoGlobalPublishing","autoIcePublish","autoShareWishlist","autoAcceptMsgGifts","autoAcceptMsgBoosts","autoAcceptMsgCrew","autosendMsgEnergyPack","autoAskCityCrew"]);var e=50;GM_setValue("logPlayerUpdatesMax",e);var f=parseInt(document.getElementById("autoShareWishlistTime").value);if(isNaN(f)||parseFloat(f)<1){alert('The share wishlist timer has to be at least 1 hour. For decimal numbers please use ".", e.g. 1.5.\nDefaulting it to 1 hour.');document.getElementById("autoShareWishlistTime").value=1;return}GM_setValue("autoShareWishlistTime",f);var g=parseInt(document.getElementById("autoAskJobHelpMinExp").value);if(isNaN(g))g=0;GM_setValue("autoAskJobHelpMinExp",g);var h=parseInt(document.getElementById("autoIcePublishFrequency").value);if(isNaN(h))h=1;GM_setValue("autoIcePublishFrequency",h);saveElementArray([["selectBrazilTier",2],["selectChicagoTier",2],["selectLondonTier",2],["selectVegasTier",2],["warMode",2],["autoWarTargetList",2]]);saveCheckBoxElementArray(["autoStartFamOps","autoStartMyOps","AutoFamilyRewards","AutoBattle","AutoBattleFight","AutoBattleSafehouse","autoFamilyBosses","autoFamilyBossFighting","askBossFightBoosts","sendBossFightBoosts"]);saveElementArray([["AutoBattleClanID",2],["bossRole",2],["bossStaminaLimit",2],["bossRageLimit",2],["selectFreeGift",2],["dispatchTarget",2],["selectAskFreeGift",2]]);saveCheckBoxElementArray(["autoStat","autoStatDisable","autoStatAttackFallback","autoStatDefenseFallback","autoStatHealthFallback","autoStatEnergyFallback","autoStatStaminaFallback"]);GM_setValue("restAutoStat",0);for(a=0,iLength=autoStatBases.length;a<iLength;++a)GM_setValue(autoStatBases[a],document.getElementById(autoStatBases[a]).value);for(a=0,iLength=autoStatRatios.length;a<iLength;++a)GM_setValue(autoStatRatios[a],document.getElementById(autoStatRatios[a]).value);for(a=0,iLength=autoStatModes.length;a<iLength;++a)GM_setValue(autoStatModes[a],document.getElementById(autoStatModes[a]).value);for(a=0,iLength=autoStatPrios.length;a<iLength;++a)GM_setValue(autoStatPrios[a],document.getElementById(autoStatPrios[a]).value);var i=document.getElementById("autoStat").checked===true;for(a=0,iLength=autoStatBases.length;a<iLength;++a){if(i&&isNaN(document.getElementById(autoStatBases[a]).value)){alert("Please enter valid numbers for auto-stat "+autoStatDescrips[a+1]+" (Misc tab). : "+document.getElementById(autoStatBases[a]).value);return}}for(a=0,iLength=autoStatRatios.length;a<iLength;++a){if(i&&isNaN(document.getElementById(autoStatRatios[a]).value)){alert("Please enter valid numbers for auto-stat "+autoStatDescrips[a+1]+" (Misc tab).");return}}if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){for(a=1;a<=3;a++){id="selectCityPrio"+a;GM_setValue(id,0)}for(a=1;a<cityCrewTitles.length;a++){id="selectBrazilCrew"+a;GM_setValue(id,0);id="selectChicagoCrew"+a;GM_setValue(id,0);id="selectLondonCrew"+a;GM_setValue(id,0)}GM_setValue("activateBrazilCrew",0);GM_setValue("activateChicagoCrew",0);GM_setValue("activateLondonCrew",0)}else{for(a=1;a<=3;a++){id="selectCityPrio"+a;GM_setValue(id,document.getElementById(id).value)}var j=0;for(a=1;a<cityCrewTitles.length;a++){id="selectBrazilCrew"+a;if(document.getElementById(id).value)j=1;GM_setValue(id,document.getElementById(id).value)}GM_setValue("activateBrazilCrew",j);var k=0;for(a=1;a<cityCrewTitles.length;a++){id="selectChicagoCrew"+a;if(document.getElementById(id).value)k=1;GM_setValue(id,document.getElementById(id).value)}GM_setValue("activateChicagoCrew",k);var l=0;for(a=1;a<cityCrewTitles.length;a++){id="selectLondonCrew"+a;if(document.getElementById(id).value)l=1;GM_setValue(id,document.getElementById(id).value)}GM_setValue("activateLondonCrew",l)}saveCheckBoxElementArray(["autoMission","endLevelOptimize","endLevelNYOnly","autoWithDraw","checkMiniPack","autoEnergyPack","autoEnergyPackForce","allowEnergyToLevelUp","skipfight","autoFightAgostino"]);var m=[];var n=[];selectedTierValue=document.getElementById("selectTier").value.split(".");masteryCity=parseInt(selectedTierValue[0]);masteryTier=parseInt(selectedTierValue[1]);for(a=0,iLength=missions.length;a<iLength;a++){if(document.getElementById(missions[a][MISSION_NAME]).checked)m.push(a);if(masteryCity==missions[a][MISSION_CITY]&&masteryTier==missions[a][MISSION_TAB])n.push(a)}var o=m.length;var p=document.getElementById("selectTier").value;if(o&&p!="0.0"){GM_setValue("autoMission",0);alert("Please choose either jobs to master or a tier to master, not both ...")}if(document.getElementById("autoMission").checked===true){if(o){GM_setValue("repeatJob","checked")}else if(p!="0.0"){GM_setValue("repeatJob",0)}else{GM_setValue("autoMission",0);alert("Please choose either jobs to master or a tier to master ... autoMission disabled")}}setSavedList("selectMissionMultiple",m);setSavedList("masteryJobsList",n);GM_setValue("selectTier",p);var q=document.getElementById("autoEnergyPack").checked===true;var r=parseFloat(document.getElementById("estimateJobRatio").value);if(q){if(isNaN(r)){alert("Please enter a number between 0 and 3 for your estimated job xp to energy ratio");return}}GM_setValue("estimateJobRatio",document.getElementById("estimateJobRatio").value);var s=parseInt(document.getElementById("autoEnergyPackForcePts").value);if(isNaN(s))s=0;GM_setValue("autoEnergyPackForcePts",s);var t=parseInt(document.getElementById("selectEnergyUse").value);var u=parseInt(document.getElementById("selectEnergyKeep").value);if(isNaN(t)||isNaN(u)){alert("Please enter numeric values for Energy reserve and Energy threshold.");return}var v=parseInt(document.getElementById("selectMissionEnergyKeep").value);if(isNaN(v)){alert("Please Enter Numeric Values For The Mission Energy Threshold.");return}GM_setValue("selectEnergyUse",t);GM_setValue("selectEnergyKeep",u);GM_setValue("selectEnergyUseMode",document.getElementById("selectEnergyUseMode").selectedIndex);GM_setValue("selectEnergyKeepMode",document.getElementById("selectEnergyKeepMode").selectedIndex);GM_setValue("selectMissionEnergyKeep",v);GM_setValue("selectMissionEnergyKeepMode",document.getElementById("selectMissionEnergyKeepMode").selectedIndex);var w=validateStaminaTab();if(!w)return;for(var x in w){GM_setValue(x,w[x])}update_nrg_stam();saveCheckBoxElementArray(["autoHeal","autoHealBackup","hideInHospital","forceHealOpt3","forceHealOpt4","forceHealOpt5","forceHealOpt7","hideAttacks"]);var y=document.getElementById("autoHeal").checked===true;var z=parseInt(document.getElementById("healthLevel").value);if(y&&(!z||z<1)){alert("Health level for automatic healing must be 1 or more.");return}GM_setValue("healthLevel",z);GM_setValue("healLocation",document.getElementById("healLocation").value);var A=parseInt(document.getElementById("stamina_min_heal").value);if(isNaN(A))A=0;GM_setValue("stamina_min_heal",A);var B=document.getElementById("hideAttacks").checked===true;var C=parseInt(document.getElementById("rideHitlistXP").value);if(B){if(isNaN(C)||C<0||C>50){alert("For the hitlistride XP please enter a number between 0 and 50 (default: 0).");return}else{GM_setValue("rideHitlistXP",C)}}if(!isGMChecked("autoHeal")){document.getElementById("mwap_toggleheal").innerHTML=healOffIcon;document.getElementById("mwap_toggleheal").title="autoHeal unchecked";addToLog("healOffIcon Icon","autoHeal turned OFF by User")}else{if(getStaminaMode()==STAMINA_HOW_FIGHTROB||getStaminaMode()==STAMINA_HOW_ROBFIGHT){document.getElementById("mwap_toggleheal").innerHTML=healOnHoldIcon;document.getElementById("mwap_toggleheal").title="autoHeal checked BUT OVERRULED - healing in "+locations[GM_getValue("healLocation")]+" when health falls below "+GM_getValue("healthLevel")+".";addToLog("healOnHoldIcon Icon","autoHeal turned ON by User, but OVERRULED")}else{document.getElementById("mwap_toggleheal").innerHTML=healOnIcon;document.getElementById("mwap_toggleheal").title="autoHeal checked - healing in "+locations[GM_getValue("healLocation")]+" when health falls below "+GM_getValue("healthLevel")+".";addToLog("healOnIcon Icon","autoHeal turned ON by User")}}saveCheckBoxElementArray(["collectTakeNew York","collectTakeBrazil","collectTakeChicago","collectTakeLondon","collectParts","autoBank","autoBankVegas","autoBankBrazil","autoBankChicago","autoBankLondon","askVegasParts","askPlaySlots","askBrazilParts","askChicagoParts","askLondonParts","autoLimitedParts","autoFamilyProperty"]);for(ctCount=0;ctCount<ctLength;ctCount++){propItemId=cityProperties[ctCount][ctGMId]+"Id";saveCheckBoxElementArray([cityProperties[ctCount][ctGMId]]);GM_setValue(propItemId,document.getElementById(propItemId).selectedIndex)}for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){saveCheckBoxElementArray([cityParts[ctCount][ptGMId]]);if(cityParts[ctCount][ptPropId]){propItemId=cityParts[ctCount][ptGMId]+"Id";GM_setValue(propItemId,document.getElementById(propItemId).selectedIndex)}}GM_setValue("askVegasPartsId",document.getElementById("askVegasPartsId").selectedIndex);GM_setValue("askVegasPropId",document.getElementById("askVegasPropId").selectedIndex);GM_setValue("askBrazilPartsId",document.getElementById("askBrazilPartsId").selectedIndex);GM_setValue("askBrazilPropId",document.getElementById("askBrazilPropId").selectedIndex);GM_setValue("askChicagoPartsId",document.getElementById("askChicagoPartsId").selectedIndex);GM_setValue("askChicagoPropId",document.getElementById("askChicagoPropId").selectedIndex);GM_setValue("askLondonPartsId",document.getElementById("askLondonPartsId").selectedIndex);GM_setValue("askLondonPropId",document.getElementById("askLondonPropId").selectedIndex);var D=document.getElementById("autoBank").checked===true;var E=document.getElementById("autoBankVegas").checked===true;var F=document.getElementById("autoBankBrazil").checked===true;var G=document.getElementById("autoBankChicago").checked===true;var H=document.getElementById("autoBankLondon").checked===true;var I=document.getElementById("bankConfig").value;var J=document.getElementById("bankConfigVegas").value;var K=document.getElementById("bankConfigBrazil").value;var L=document.getElementById("bankConfigChicago").value;var M=document.getElementById("bankConfigLondon").value;var N=parseInt(I);var O=parseInt(J);var P=parseInt(K);var Q=parseInt(L);var R=parseInt(M);var S=document.getElementById("userMinBalance").value;GM_setValue("vaultHandling",document.getElementById("vaultHandling").selectedIndex);GM_setValue("autoUpgradeNYChoice",document.getElementById("autoUpgradeNYChoice").selectedIndex);for(a=0,iLength=autoUpgradeNYBuildings.length;a<iLength;a++){eltId="upgradeNYProperty"+autoUpgradeNYBuildings[a][1];saveCheckBoxElement(eltId)}if(D&&(isNaN(N)||N<10)){alert("Minimum New York auto-bank amount must be 10 or higher.");return}if(E&&(isNaN(O)||O<10)){alert("Minimum Las Vegas auto-bank amount must be 10 or higher.");return}if(F&&(isNaN(P)||P<10)){alert("Minimum Brazil auto-bank amount must be 10 or higher.");return}if(G&&(isNaN(Q)||Q<10)){alert("Minimum Chicago auto-bank amount must be 10 or higher.");return}if(H&&(isNaN(R)||R<10)){alert("Minimum Chicago auto-bank amount must be 10 or higher.");return}if(S<0){alert("Minimum NY Bank Balance amount must be 0 or higher.");return}GM_setValue("bankConfig",I);GM_setValue("bankConfigVegas",J);GM_setValue("bankConfigBrazil",K);GM_setValue("bankConfigChicago",L);GM_setValue("bankConfigLondon",M);GM_setValue("userMinBalance",S);saveCheckBoxElementArray(["TestChanges"]);setSavedList("jobsToDo",[]);setSavedList("itemList",[]);GM_setValue("masteredJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");GM_setValue("availableJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");fightListNew.set([]);skipStaminaSpend=false}catch(T){DEBUG("Save Settings failed on "+T)}destroyByID("mafiaLogBox");createLogBox();toggleSettings();if(!isGMChecked("noStats"))updateLogStats();refreshMWAPCSS();sendSettings();logFilterOnOff(1)}function updateMastheadMenu(){var a=document.getElementById("ap_menu");if(!a)return;if(document.getElementById("ap_img")){var b=document.getElementById("ap_img")}else{var b=makeElement("div",a.parentNode,{id:"ap_img",style:"position: absolute; top: 23px; right:135px;"})}var c=document.getElementById("pauseButton");if(running){destroyByID("apimg");makeElement("img",b,{id:"apimg",src:"http://cdn.playerscripts.co.uk/images/mwap_graphics/32_green.png"});if(c)return;destroyByID("resumeButton");c=makeElement("span",null,{id:"pauseButton",style:"color:#33FF00;",title:"RX6 MWAP is RUNNING, click to pause ..."});c.appendChild(document.createTextNode("Pause"));c.addEventListener("click",pause,false);a.insertBefore(c,a.firstChild)}else{if(c){c.parentNode.removeChild(c)}c=document.getElementById("resumeButton");destroyByID("apimg");makeElement("img",b,{id:"apimg",src:"http://cdn.playerscripts.co.uk/images/mwap_graphics/32_red.png"});if(c)return;c=makeElement("span",null,{id:"resumeButton",style:"color:#FF0000;",title:"RX6 MWAP is PAUSED, click to resume ..."});c.appendChild(document.createTextNode("Resume"));a.insertBefore(c,a.firstChild);c.addEventListener("click",unPause,false)}}function update_nrg_stam(){setListenStats(false);if(document.getElementById("mwap_nrg")){var a=document.getElementById("mwap_nrg");var b=xpathFirst('./div[@class="mw_header"]//div[@class="mid_row_text energy_text_bg" and contains(text(), "ENERGY")]',statsrowElt);if(!b)b=xpathFirst('.//div[@id="game_stats"]//h4[@class="energy" and contains(text(), "Energy")]',statsrowElt);if(!b)b=xpathFirst('.//div[@id="game_stats"]//span[@class="stat_title" and contains(text(),"Energy")]',statsrowElt);if(b){if(isGMChecked("autoMission")){var c="Spend Energy ON.  ";b.style.color="#33FF00"}else{var c="Spend Energy OFF.  ";b.style.color="#FF0000"}selectedTierValue=GM_getValue("selectTier","0.0").split(".");masteryCity=parseInt(selectedTierValue[0]);masteryTier=parseInt(selectedTierValue[1]);if(masteryCity==0&&(masteryTier==0||masteryTier==undefined)){c+=" Mastering- Turned OFF "}else{c+=" Mastering-"+cities[masteryCity][CITY_NAME]+", District/Region-"+masteryTier+" "+missionTabs[masteryCity][masteryTier-1]}b.style.textDecoration="underline";a.title=c}}if(document.getElementById("mwap_nrg")){var d=document.getElementById("mwap_stam");var e=xpathFirst('./div[@class="mw_header"]//div[@class="mid_row_text stamina_text_bg" and contains(text(), "STAMINA")]',statsrowElt);if(!e)e=xpathFirst('.//div[@id="game_stats"]//h4[contains(text(), "Stamina")]',statsrowElt);if(!e)e=xpathFirst('.//div[@id="game_stats"]//span[@class="stat_title" and contains(text(),"Stamina")]',statsrowElt);if(e){if(isGMChecked("staminaSpend")){var f="Spend Stamina ON.  ";e.style.color="#33FF00"}else{var f="Spend Stamina OFF.  ";e.style.color="#FF0000"}f+="Minimum Stamina for auto-healing set at "+GM_getValue("stamina_min_heal")+" points.";var g=getStaminaMode();f+=" Stamina Spend Mode: "+staminaSpendChoices[g];e.style.textDecoration="underline";d.title=f}}setListenStats(true)}function pause(){if(GM_getValue("isRunning")===false){refreshLog()}GM_setValue("isRunning",false);running=false;isBGPaused=true;sendMWValues(["isRunning"]);Autoplay.clearTimeout();Reload.clearTimeout();addToLog("pause Icon","RX6 MWAP is paused. Log & stats do not track manual activity.");ajaxHandling=false;mwapOnOffMenu();updateMastheadMenu();customizeHome()}function unPause(){if(GM_getValue("isRunning")===true)refreshLog();GM_setValue("masteredJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");GM_setValue("availableJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");GM_setValue("isRunning",true);running=true;isBGPaused=false;isBackgroundFighting=false;isBackGroundRobbing=false;isBackgroundDispatching=false;sendMWValues(["isRunning"]);addToLog("play Icon",'RX6 MWAP resuming.<br/>If you like RX6 MWAP Click Like <iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FPS-Mafia-Wars-Autoplayer%2F160393374005267&layout=button_count&show_faces=true&width=80&action=like&font=arial&colorscheme=light&height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:80px; height:21px;" allowTransparency="true"></iframe><br/>RX6 MWAP FB Fanpage - help us to be an authorised Zynga script.');mwapOnOffMenu();updateMastheadMenu();autoReload(false,"unpause");DEBUG("Unpause.");Autoplay.fx=goHome;Autoplay.delay=150;Autoplay.start()}function recurringLogText(){addToLog("info Icon",'<div style="width: 320px; background: #000; padding: 2px; border: 1px solid #fff; opacity: .8;"><a href="http://mwap.me.uk/sign-up/rx6-1-year-membership.html" target="_blank" title="Why have a RX6 PRO Membership?"><img style="position: relative;" src="http://rx6.tinhatsoftwarelt.netdna-cdn.com/images/mwap-images/rx6-signuptoday-mwap.jpg" alt="" /></a><div style="text-align: center; text-decoration:blink"><span class="good"><span style="font-size: 12pt;"><strong>Upgrade to RX6 MWAP PRO Now!</strong></span></span></div><div style = "padding:10px"><span class="good">** Stick to the target like glue until ICED or KILLED!<br>** Get the Crazy Speed option that only Pro provides<br>** BGF (Back Ground Fighting) does jobs and collects whilst ICEING!</span></div></div>')}function mwapOnOffMenu(){var a=document.getElementById("pauseLink");var b=document.getElementById("resumeLink");if(a&&b){if(GM_getValue("isRunning")===false){a.style.display="none";b.style.display="block"}else{a.style.display="block";b.style.display="none"}}var c=document.getElementById("mafiaLogBox");var d=document.getElementById("ap_mwap_pause");if(!c||!d)return;if(GM_getValue("isRunning")===false){destroyByID("ap_mwap_pause");title="Click to resume RX6 MWAP";var d=makeElement("div",c,{"class":"mouseunderline",title:title,id:"ap_mwap_pause","class":"ap_mwap_pause"});d.appendChild(document.createTextNode("RX6 MWAP is PAUSED, click to resume"));d.addEventListener("click",mwapOnOff,false)}else{destroyByID("ap_mwap_pause");title="Click to pause RX6 MWAP";var d=makeElement("div",c,{"class":"mouseunderline",title:title,id:"ap_mwap_pause","class":"ap_mwap_pause"});d.appendChild(document.createTextNode("RX6 MWAP is RUNNING, click to pause"));d.addEventListener("click",mwapOnOff,false)}}function mwapOnOff(){if(GM_getValue("isRunning")===true)pause();else unPause()}function isFamily(a,b){var c="";if(a.match(/id\=(.+)\&from_red_link/))c=decodeID(RegExp.$1);if(b==STAMINA_HOW_FIGHT_RANDOM||STAMINA_HOW_FIGHT_BG){var d=getSavedList("fightClanName")}else{var d=getSavedList("hitmanClanName")}for(var e=0,f=d.length;e<f;++e){var g=d[e];if(g&&(a.untag().indexOf(g)!=-1||g==c))return true}return false}function isLoggable(a){var b=GM_getIntValue("filterOpt",0);if(!a||debug||!isGMChecked("filterLog")||isNaN(b))return true;if(a.indexOf("Log filtering")!=-1||a.indexOf('"good">Patterns ')!=-1)return true;var c=getSavedList(b==0?"filterPass":"filterFail");for(var d=0,e=c.length;d<e;++d){var f=c[d];if(f&&a.indexOf(f)!=-1)return b==0}return b==1}function timeStamp(){var a=new Date;var b=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var c=b[a.getMonth()]+" "+a.getDate();var d=(a.getHours()<10?0:"")+a.getHours()+":"+(a.getMinutes()<10?0:"")+a.getMinutes()+":"+(a.getSeconds()<10?0:"")+a.getSeconds()+" ";var e=c+" - "+d+" ";return e}function addToLog(a,b){if(!debug&&!isGMChecked("autoLog"))return;if(!isLoggable(b))return;var c=document.getElementById("logBox");if(!c){if(!addToLog.logBox){addToLog.logBox=document.createElement("div");addToLog.logBox.innerHTML=GM_getValue("itemLog","")}c=addToLog.logBox}var d=c.childNodes.length;var e;if(d){var f=c.firstChild.childNodes[1];if(f&&f.innerHTML!=""){var g=f.innerHTML.untag().match(/^(.+?)(?:\s\((\d+) times\))?$/);if(g&&g[1]==String(b).untag()){if(g[2])e=parseInt(g[2])+1;else e=2;b+=" ("+e+" times)"}}}var h=document.createElement("div");h.className="logEvent "+a;h.innerHTML='<div class="eventTime">'+timeStamp()+'</div><div class="eventBody">'+b+'</div><div class="clear"></div>';if(e)c.replaceChild(h,c.firstChild);else{c.insertBefore(h,c.firstChild);var i=GM_getIntValue("autoLogLength",300);if(i>500||debug)i=500;if(i>0)while(d-->i)c.removeChild(c.lastChild)}GM_setValue("itemLog",c.innerHTML);if(e>10)goHome()}function updateLogStats(){var a=document.getElementById("fightCount");if(a){a.firstChild.nodeValue=makeCommaValue(GM_getIntValue("fightWinCountInt",0)+GM_getIntValue("fightLossCountInt",0));document.getElementById("fightWinCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("fightWinCountInt",0));var b=(GM_getIntValue("fightWinCountInt",0)/(GM_getIntValue("fightWinCountInt",0)+GM_getIntValue("fightLossCountInt",0))*100).toFixed(1);document.getElementById("fightWinPct").firstChild.nodeValue=isNaN(b)?"0.0%":b+"%";document.getElementById("fightLossCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("fightLossCountInt",0));var c=(GM_getIntValue("fightLossCountInt",0)/(GM_getIntValue("fightWinCountInt",0)+GM_getIntValue("fightLossCountInt",0))*100).toFixed(1);document.getElementById("fightLossPct").firstChild.nodeValue=isNaN(c)?"0.0%":c+"%"}var d=document.getElementById("passivefightCount");if(d){d.firstChild.nodeValue=makeCommaValue(GM_getIntValue("passivefightWinCountInt",0)+GM_getIntValue("passivefightLossCountInt",0));document.getElementById("passivefightWinCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("passivefightWinCountInt",0));var b=(GM_getIntValue("passivefightWinCountInt",0)/(GM_getIntValue("passivefightWinCountInt",0)+GM_getIntValue("passivefightLossCountInt",0))*100).toFixed(1);document.getElementById("passivefightWinPct").firstChild.nodeValue=isNaN(b)?"0.0%":b+"%";document.getElementById("passivefightLossCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("passivefightLossCountInt",0));var c=(GM_getIntValue("passivefightLossCountInt",0)/(GM_getIntValue("passivefightWinCountInt",0)+GM_getIntValue("passivefightLossCountInt",0))*100).toFixed(1);document.getElementById("passivefightLossPct").firstChild.nodeValue=isNaN(c)?"0.0%":c+"%"}var e=document.getElementById("totalPassiveWinDollars");if(e){var f=0;var g=0;var h="|";var j="|";for(i=0,iLength=cityStats.length;i<iLength;i++){f+=GM_getIntValue(cityStats[i][passivecashWins],0);g+=GM_getIntValue(cityStats[i][passivecashLosses],0);h+=" "+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getIntValue(cityStats[i][passivecashWins],0))+" |";j+=""+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getIntValue(cityStats[i][passivecashLosses],0))+" |"}e.firstChild.nodeValue=getDollarsUnit(f);document.getElementById("totalPassiveLossDollars").firstChild.nodeValue=getDollarsUnit(g);document.getElementById("totalPassiveWinDollars").setAttribute("title",h);document.getElementById("totalPassiveLossDollars").setAttribute("title",j)}var k=document.getElementById("whackedCount");if(k)document.getElementById("whackedCount").firstChild.nodeValue=GM_getIntValue("whackedCount",0);var l=document.getElementById("snuffCount");if(l)document.getElementById("snuffCount").firstChild.nodeValue=GM_getIntValue("snuffCount",0);var m=document.getElementById("passivetotalExp");if(m){m.firstChild.nodeValue=makeCommaValue(GM_getIntValue("passivetotalFightExpInt",0)+GM_getIntValue("passivetotalJobExpInt",0));document.getElementById("passivetotalFightExp").firstChild.nodeValue=makeCommaValue(GM_getIntValue("passivetotalFightExpInt",0));document.getElementById("passivetotalJobExp").firstChild.nodeValue=makeCommaValue(GM_getIntValue("passivetotalJobExpInt",0))}var n=document.getElementById("hitmanCount");if(n){document.getElementById("hitmanCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("hitmanWinCountInt",0)+GM_getIntValue("hitmanLossCountInt",0));document.getElementById("hitmanWinCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("hitmanWinCountInt",0));var o=(GM_getIntValue("hitmanWinCountInt",0)/(GM_getIntValue("hitmanWinCountInt",0)+GM_getIntValue("hitmanLossCountInt",0))*100).toFixed(1);document.getElementById("hitmanWinPct").firstChild.nodeValue=isNaN(o)?"0.0%":o+"%";document.getElementById("hitmanLossCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("hitmanLossCountInt",0));var p=(GM_getIntValue("hitmanLossCountInt",0)/(GM_getIntValue("hitmanWinCountInt",0)+GM_getIntValue("hitmanLossCountInt",0))*100).toFixed(1);document.getElementById("hitmanLossPct").firstChild.nodeValue=isNaN(p)?"0.0%":p+"%"}var q=document.getElementById("robCount");if(q){document.getElementById("robCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("robSuccessCountInt",0)+GM_getIntValue("robFailedCountInt",0));document.getElementById("robWinCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("robSuccessCountInt",0));var r=(GM_getIntValue("robSuccessCountInt",0)/(GM_getIntValue("robSuccessCountInt",0)+GM_getIntValue("robFailedCountInt",0))*100).toFixed(1);document.getElementById("robWinPct").firstChild.nodeValue=isNaN(r)?"0.0%":r+"%";document.getElementById("robLossCount").firstChild.nodeValue=makeCommaValue(GM_getIntValue("robFailedCountInt",0));var s=(GM_getIntValue("robFailedCountInt",0)/(GM_getIntValue("robSuccessCountInt",0)+GM_getIntValue("robFailedCountInt",0))*100).toFixed(1);document.getElementById("robLossPct").firstChild.nodeValue=isNaN(s)?"0.0%":s+"%"}var t=document.getElementById("totalWinDollars");if(t){t.firstChild.nodeValue=getDollarsUnit(GM_getIntValue("totalWinDollarsInt",0));document.getElementById("totalLossDollars").firstChild.nodeValue=getDollarsUnit(GM_getIntValue("totalLossDollarsInt",0));var u="|";var v="|";for(i=0,iLength=cityStats.length;i<iLength;i++){u+=" "+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getIntValue(cityStats[i][cashWins],0))+" |";v+=" "+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getIntValue(cityStats[i][cashWins],0))+" |"}document.getElementById("totalWinDollars").setAttribute("title",u);document.getElementById("totalLossDollars").setAttribute("title",v);document.getElementById("totalExp").firstChild.nodeValue=makeCommaValue(GM_getIntValue("totalExpInt",0))}}function logFilterOnOff(a){var b;if(a!=1)b=toggleCheckElt("filterLog");else b=isGMChecked("filterLog");var c=document.getElementById("filterOn");var d=document.getElementById("filterOff");if(c&&d){if(b){c.style.display="block";d.style.display="none"}else{c.style.display="none";d.style.display="block"}}if(a!=1){var e=GM_getValue("filterOpt")!=1;var f=getSavedList(e?"filterPass":"filterFail");var g=b?'Log filtering disabled. <span class="good">Patterns '+(e?"accepted":"rejected")+"</span>:<br>"+f.join(", "):"Log filtering disabled.";addToLog("info Icon",g);if(GM_getValue("logOpen")!="open")alert(g)}}function debugOnOff(){var a=document.getElementById("debugOn");var b=document.getElementById("debugOff");if(a&&b){if(isGMChecked("enableDebug")){addToLog("info Icon","Debug logging disabled.<br>[code]");GM_setValue("enableDebug",0);debug=false;if(GM_getValue("logOpen")!="open"){alert("Debug logging disabled.")}else{a.style.display="none";b.style.display="block"}}else{GM_setValue("enableDebug","checked");debug=true;showMafiaLogBox();addToLog("info Icon","[/code]<br>Debug logging enabled.");a.style.display="block";b.style.display="none";debugDumpSettings()}}}function colorDEBUG(a,b,c){if(isGMChecked("TestChanges")){if(b)DEBUG('<span style="color:'+b+'">'+a+"</span>",c);else DEBUG('<span style="color:#FF8C00">'+a+"</span>",c)}}function colorLOG(a,b){if(isGMChecked("TestChanges")){if(b)addToLog("debug Icon",'<span style="color:'+b+'">'+a+"</span>");else addToLog("debug Icon",'<span style="color:#FF8C00">'+a+"</span>")}}function DEBUG(a,b){b=b==null||SCRIPT.UseDebugCategory==0?0:b;if(debug&&b==SCRIPT.UseDebugCategory)addToLog("debug Icon",a);if(SCRIPT.UseDebugConsole)GM_log(a,b)}function refreshLog(){var a=document.getElementById("logBox");if(a)a.innerHTML=GM_getValue("itemLog","")}function clearLog(){GM_setValue("itemLog","");var a=document.getElementById("logBox");a.innerHTML="";addToLog("process Icon","RX6 MWAP Log Cleared")}function clearStats(){GM_setValue("fightWinCountInt",0);GM_setValue("fightLossCountInt",0);GM_setValue("passivefightWinCountInt",0);GM_setValue("passivefightLossCountInt",0);GM_setValue("passivetotalJobExpInt",0);GM_setValue("passivetotalFightExpInt",0);GM_setValue("snuffCount",0);GM_setValue("whackedCount",0);GM_setValue("robSuccessCountInt",0);GM_setValue("robFailedCountInt",0);GM_setValue("hitmanWinCountInt",0);GM_setValue("hitmanWinDollarsInt","0");GM_setValue("hitmanLossCountInt",0);GM_setValue("hitmanLossDollarsInt","0");GM_setValue("totalExpInt",0);GM_setValue("totalRobStamInt",0);GM_setValue("totalWinDollarsInt","0");GM_setValue("totalLossDollarsInt","0");GM_setValue("lastHitXp",0);GM_setValue("totalHits",0);GM_setValue("totalXp",0);GM_setValue("currentHitXp",0);GM_setValue("currentHitDollars","0");for(i=0,iLength=cityStats.length;i<iLength;i++){var a=cityStats[i];for(j=0,jLength=a.length;j<jLength;j++){GM_setValue(a[j],0)}}updateLogStats();addToLog("process Icon","RX6 MWAP Stats Cleared")}function showPrimaryStats(){var a=document.getElementById("statPassive");var b=document.getElementById("statPrimary");var c=document.getElementById("btnPrimaryStat");var d=document.getElementById("btnPassiveStat");if(a&&b){a.style.display="none";b.style.display="block";d.style.color="rgb(0, 128, 0)";c.style.color="rgb(0, 255, 0)"}}function showPassiveStats(){var a=document.getElementById("statPassive");var b=document.getElementById("statPrimary");var c=document.getElementById("btnPrimaryStat");var d=document.getElementById("btnPassiveStat");if(a&&b){b.style.display="none";a.style.display="block";c.style.color="rgb(0, 128, 0)";d.style.color="rgb(0, 255, 0)"}}function resetMDK(){GM_setValue("myIces",0);GM_setValue("myKills",0);GM_setValue("mdkStart",timeStamp());GM_setValue("myFeeds",JSON.stringify([]));updateMDK()}function logMDK(){var a=document.getElementById("logBox");var b=document.getElementById("altlogBox");if(a&&a.style.display=="block"){var c="";var d=JSON.parse(GM_getValue("myFeeds",JSON.stringify([])));if(d&&d.length>0){for(i=d.length-1;i>=0;i--)c+='<div style="padding-bottom:3px">'+d[i]+"</div>"}else c+="<div>MDK Log Empty!</div>";a.style.display="none";if(b){b.innerHTML=c;b.style.display="block"}}else{if(a)a.style.display="block";if(b)b.style.display="none"}}function updateMDK(){var a=xpathFirst('.//span[@id="mdkIces"]');if(a)a.innerHTML=GM_getValue("myIces",0);var a=xpathFirst('.//span[@id="mdkKills"]');if(a)a.innerHTML=GM_getValue("myKills",0);var a=xpathFirst('.//span[@id="mdkStart"]');if(a)a.innerHTML=GM_getValue("mdkStart",timeStamp())}function createLogBox(){GM_setValue("toggleLog",0);if(document.getElementById("mafiaLogBox")||!document.body)return;var a=makeElement("div",document.body,{id:"mafiaLogBox"});eltRow=makeElement("ul",a,{style:"height:15px;"});eltCol=makeElement("li",eltRow,{style:"width:18px;height:15px;"});elt=makeElement("img",eltCol,{src:SCRIPT.PSMWAP_imagePath+"r1_c1.png",style:"width:18px;height:15px;"});eltCol=makeElement("li",eltRow,{style:"width:460px;height:15px;"});elt=makeElement("img",eltCol,{src:SCRIPT.PSMWAP_imagePath+"r1_c2.png",style:"width:460px;height:15px;"});eltCol=makeElement("li",eltRow,{style:"width:20px;height:15px;"});elt=makeElement("img",eltCol,{src:SCRIPT.PSMWAP_imagePath+"r1_c16.png",style:"width:20px;height:15px;"});eltRow=makeElement("ul",a,{style:"height:30px;"});eltCol=makeElement("li",eltRow,{style:"width:18px;height:31px;"});elt=makeElement("img",eltCol,{src:"http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/left_corner.png",style:"width:18px;height:31px;"});eltCol=makeElement("li",eltRow,{style:"width:46px;height:30px;background-image:url('http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/placeholder.png');"});eltCol.addEventListener("click",mwapOnOff,false);eltA=makeElement("a",eltCol,{href:"#","class":"pauseLink",alt:"pause",title:"pause",id:"pauseLink",style:running?"display:block;":"display:none;"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("Pause"));eltA=makeElement("a",eltCol,{href:"#","class":"resumeLink",alt:"resume",title:"resume",id:"resumeLink",style:running?"display:none;":"display:block;"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("Resume"));eltCol=makeElement("li",eltRow);eltCol.addEventListener("click",clearLog,false);eltA=makeElement("a",eltCol,{href:"#","class":"clearLogLink",alt:"clear log",title:"clear log"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("...Clear Log"));eltCol=makeElement("li",eltRow);eltCol.addEventListener("click",clearStats,false);eltA=makeElement("a",eltCol,{href:"#","class":"clearStatsLink",alt:"clear stats",title:"clear stats"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("...Clear Stats"));eltCol=makeElement("li",eltRow);eltCol.addEventListener("click",toggleSettings,false);eltA=makeElement("a",eltCol,{href:"#","class":"toggleSettingsLink",alt:"settings",title:"settings"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("...Settings"));eltCol=makeElement("li",eltRow);eltCol.addEventListener("click",logFilterOnOff,false);eltA=makeElement("a",eltCol,{href:"#",id:"filterOn","class":"filterActiveLink",alt:"filter off",title:"filter on",style:filter?"display:block;":"display:none;"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode(".Filter On "));eltA=makeElement("a",eltCol,{href:"#",id:"filterOff","class":"filterNotActiveLink",alt:"filter on",title:"filter off",style:filter?"display:none;":"display:block;"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode(".Filter Off"));eltCol=makeElement("li",eltRow);eltCol.addEventListener("click",debugOnOff,false);eltA=makeElement("a",eltCol,{href:"#",id:"debugOn","class":"debugActiveLink",alt:"debug off",title:"debug on",style:debug?"display:block;":"display:none;"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("Debug On "));eltA=makeElement("a",eltCol,{href:"#",id:"debugOff","class":"debugNotActiveLink",alt:"debug on",title:"debug off",style:debug?"display:none;":"display:block;"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode("Debug Off"));eltCol=makeElement("li",eltRow,{style:"width:40px;height:30px;background-image:url('http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/placeholder.png');"});eltCol=makeElement("li",eltRow);eltCol.addEventListener("click",hideMafiaLogBox,false);eltA=makeElement("a",eltCol,{href:"#","class":"closeLink",alt:"close",title:"close"});if(isGMChecked("textOnlyMode"))eltA.appendChild(document.createTextNode(".X"));eltCol=makeElement("li",eltRow,{style:"width:20px;height:31px;"});elt=makeElement("img",eltCol,{src:"http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/right_corner.png",style:"width:20px;height:31px;"});eltRow=makeElement("ul",a);eltCol=makeElement("li",eltRow,{style:"width:479px;padding: 0px;margin:0px;border-left:3px solid #B70B0B;border-right:3px solid #B70B0B;float:left;position: absolute; right: 0px; top: 45px; bottom: 15px; margin-left:0px;margin-right:8px;"});topOffSet="0px";if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){if(!GM_getValue("mdkStart",""))GM_setValue("mdkStart",timeStamp());var b=makeElement("div",eltCol,{id:"mdkContainer",style:"float:left;position: absolute; left: 0px; top: 0px; width: 469px;padding:5px;height:18px;background-color: #000000; font-size:12px; color: #BCD2EA; text-align:left;border-bottom:2px solid #B70B0B;"});var c=makeElement("span",b).appendChild(document.createTextNode(" MDK Start: "));c=makeElement("span",b,{id:"mdkStart",style:"font-weight:bold;"}).appendChild(document.createTextNode(GM_getValue("mdkStart",timeStamp())));c=makeElement("span",b).appendChild(document.createTextNode(" | Ices: "));c=makeElement("span",b,{id:"mdkIces",style:"color:#00FFFF;font-weight:bold;"}).appendChild(document.createTextNode(GM_getIntValue("myIces",0)));c=makeElement("span",b).appendChild(document.createTextNode(" | Kills: "));c=makeElement("span",b,{id:"mdkKills",style:"color:#FF0000;font-weight:bold;"}).appendChild(document.createTextNode(GM_getIntValue("myKills",0)));c=makeElement("span",b).appendChild(document.createTextNode("  "));c=makeElement("span",b);c.addEventListener("click",resetMDK,false);eltA=makeElement("a",c,{href:"#","class":"mouseunderline",alt:"reset MDK",title:"resetMDK",style:"font-weight:bold;padding:0px 10px 0px 10px;border:1px solid;margin-left:10px;margin-right:5px"});eltA.appendChild(document.createTextNode("RESET"));c=makeElement("span",b).appendChild(document.createTextNode(" "));c=makeElement("span",b);c.addEventListener("click",logMDK,false);eltA=makeElement("a",c,{href:"#","class":"mouseunderline",alt:"toggle log",title:"toggle log",style:"font-weight:bold;padding:0px 10px 0px 10px;border:1px solid;"});eltA.appendChild(document.createTextNode("SWITCH"));topOffSet="30px"}if(isGMChecked("noStats")){var d=makeElement("div",eltCol,{id:"logContainer",style:"float:left;position: absolute; left: 0px; top: "+topOffSet+"; bottom: 0px; width: 479px; background-color: #000000; font-size:11px; color: #BCD2EA; text-align:left;"});var e=makeElement("div",d,{id:"logBox",style:"float:left;position: absolute; overflow:scroll; overflow-x: hidden;left: 0px; top: 8px; bottom: 0px; width: 465px;padding:5px;margin-bottom:5px;background-image:url('http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/logbox2_15.png');background-position:center top;display:block;"});var f=makeElement("div",d,{id:"altlogBox",style:"float:left;position: absolute; overflow:scroll; overflow-x: hidden;left: 0px; top: 8px; bottom: 0px; width: 465px;padding:5px;margin-bottom:5px;background-image:url('http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/logbox2_15.png');background-position:center top;display:none;"});e.innerHTML=GM_getValue("itemLog","")}else{var d=makeElement("div",eltCol,{id:"logContainer",style:"float:left;position: absolute; left: 0px; top: "+topOffSet+"; bottom: 75px; width: 479px; background-color: #000000; font-size:11px; color: #BCD2EA; text-align:left;border-bottom:2px solid #B70B0B;"});var e=makeElement("div",d,{id:"logBox",style:"float:left;position: absolute; overflow:scroll; overflow-x: hidden;left: 0px; top: 8px; bottom: 0px; width: 465px;padding:5px;margin-bottom:5px;background-image:url('http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/logbox2_15.png');background-position:center top;display:block;"});var f=makeElement("div",d,{id:"altlogBox",style:"float:left;position: absolute; overflow:scroll; overflow-x: hidden;left: 0px; top: 8px; bottom: 0px; width: 465px;padding:5px;margin-bottom:5px;background-image:url('http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/logbox2_15.png');background-position:center top;display:none;"});e.innerHTML=GM_getValue("itemLog","");var g=makeElement("div",a,{id:"statPrimary",style:"display: block;"});var h=makeElement("div",a,{id:"statPassive",style:"display: none;"});var j=makeElement("div",a,{id:"btnPrimaryStat","class":"mouseunderline",style:"position: absolute; left: 10px; bottom: 76px; font-weight: 600; cursor: pointer; color: rgb(0, 255, 0);"});j.appendChild(document.createTextNode("primary"));j.addEventListener("click",showPrimaryStats,false);var k=makeElement("div",a,{id:"btnPassiveStat","class":"mouseunderline",style:"position: absolute; left: 90px; bottom: 76px; font-weight: 600; cursor: pointer; color: rgb(0, 128, 0);"});k.appendChild(document.createTextNode("passive"));k.addEventListener("click",showPassiveStats,false);makeElement("div",h,{style:"position: absolute; left: 15px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Exp Gained:"));makeElement("div",h,{id:"passivetotalExp",style:"position: absolute; right: 325px; bottom: 65px; font-size: 10px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("passivetotalFightExpInt",0)+GM_getValue("passivetotalJobExpInt",0))));makeElement("div",h,{style:"position: absolute; right: 262px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Fights:"));makeElement("div",h,{id:"passivetotalFightExp",style:"position: absolute; right: 225px; bottom: 65px; font-size: 10px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("passivetotalFightExpInt",0))));makeElement("div",h,{style:"position: absolute; right: 175px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Jobs:"));makeElement("div",h,{id:"passivetotalJobExp",style:"position: absolute; right: 135px; bottom: 65px; font-size: 10px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("passivetotalJobExpInt",0))));makeElement("hr",h,{style:"position: absolute; left: 0; bottom: 57px; height: 1px; border: 0px; width: 475px; margin-left:10px; color: #666666; background-color: #666666"});makeElement("div",h,{style:"position: absolute; left: 15px; bottom: 48px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Attacks:"));makeElement("div",h,{id:"passivefightCount",style:"position: absolute; right: 360px; bottom: 48px; font-weight: 600;color: #BCD2EA;"}).appendChild(document.createTextNode(makeCommaValue(GM_getIntValue("passivefightWinCountInt",0)+GM_getIntValue("passivefightLossCountInt",0))));makeElement("div",h,{style:"position: absolute; left: 15px; bottom: 33px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Won:"));makeElement("div",h,{id:"passivefightWinCount",style:"position: absolute; right: 360px; bottom: 33px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("passivefightWinCountInt",0))));var l=(GM_getValue("passivefightWinCountInt",0)/(GM_getValue("passivefightWinCountInt",0)+GM_getValue("passivefightLossCountInt",0))*100).toFixed(1);makeElement("div",h,{id:"passivefightWinPct",style:"position: absolute; right: 325px; bottom: 33px; font-size: 10px; font-weight: 100;color: #52E259;"}).appendChild(document.createTextNode(isNaN(l)?"0.0%":l+"%"));makeElement("div",h,{style:"position: absolute; left: 15px; bottom: 18px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Lost:"));makeElement("div",h,{id:"passivefightLossCount",style:"position: absolute; right: 360px; bottom: 18px; font-weight: 600;color: #EC2D2D;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("passivefightLossCountInt",0))));var m=(GM_getValue("passivefightLossCountInt",0)/(GM_getValue("passivefightWinCountInt",0)+GM_getValue("passivefightLossCountInt",0))*100).toFixed(1);makeElement("div",h,{id:"passivefightLossPct",style:"position: absolute; right: 325px; bottom: 18px; font-size: 10px; font-weight: 100;color: #EC2D2D;"}).appendChild(document.createTextNode(isNaN(m)?"0.0%":m+"%"));makeElement("div",h,{style:"position: absolute; left: 190px; bottom: 48px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("HitListed:"));makeElement("div",h,{id:"whackedCount",style:"position: absolute; right: 220px; bottom: 48px; font-weight: 600;color: #BCD2EA;"}).appendChild(document.createTextNode(GM_getValue("whackedCount",0)));makeElement("div",h,{style:"position: absolute; left: 190px; bottom: 33px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Snuffed:"));makeElement("div",h,{id:"snuffCount",style:"position: absolute; right: 220px; bottom: 33px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(GM_getValue("snuffCount",0)));makeElement("div",h,{style:"position: absolute; right: 15px; bottom: 48px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Total $ Won/Lost"));var n=0;var o=0;var p="|";var q="|";for(i=0,iLength=cityStats.length;i<iLength;i++){n+=GM_getIntValue(cityStats[i][passivecashWins],0);o+=GM_getIntValue(cityStats[i][passivecashLosses],0);p+=" "+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getValue(cityStats[i][passivecashWins],0))+" |";q+=""+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getValue(cityStats[i][passivecashLosses],0))+" |"}makeElement("div",h,{id:"totalPassiveWinDollars",title:p,style:"position: absolute; right: 15px; bottom: 33px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(getDollarsUnit(n)));makeElement("div",h,{id:"totalPassiveLossDollars",title:q,style:"position: absolute; right: 15px; bottom: 18px; font-weight: 600;color: #EC2D2D;"}).appendChild(document.createTextNode(getDollarsUnit(o)));makeElement("div",g,{style:"position: absolute; left: 15px; bottom: 43px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Fights:"));makeElement("div",g,{id:"fightCount",style:"position: absolute; right: 380px; bottom: 43px; font-weight: 600;color: #BCD2EA;"}).appendChild(document.createTextNode(makeCommaValue(GM_getIntValue("fightWinCountInt",0)+GM_getIntValue("fightLossCountInt",0))));makeElement("div",g,{style:"position: absolute; left: 15px; bottom: 28px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Won:"));makeElement("div",g,{id:"fightWinCount",style:"position: absolute; right: 380px; bottom: 28px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("fightWinCountInt",0))));var r=(GM_getValue("fightWinCountInt",0)/(GM_getValue("fightWinCountInt",0)+GM_getValue("fightLossCountInt",0))*100).toFixed(1);makeElement("div",g,{id:"fightWinPct",style:"position: absolute; right: 345px; bottom: 28px; font-size: 10px; font-weight: 100;color: #52E259;"}).appendChild(document.createTextNode(isNaN(r)?"0.0%":r+"%"));makeElement("div",g,{style:"position: absolute; left: 15px; bottom: 13px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Lost:"));makeElement("div",g,{id:"fightLossCount",style:"position: absolute; right: 380px; bottom: 13px; font-weight: 600;color: #EC2D2D;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("fightLossCountInt",0))));var s=(GM_getValue("fightLossCountInt",0)/(GM_getValue("fightWinCountInt",0)+GM_getValue("fightLossCountInt",0))*100).toFixed(1);makeElement("div",g,{id:"fightLossPct",style:"position: absolute; right: 345px; bottom: 13px; font-size: 10px; font-weight: 100;color: #EC2D2D;"}).appendChild(document.createTextNode(isNaN(s)?"0.0%":s+"%"));makeElement("div",g,{style:"position: absolute; left: 170px; bottom: 43px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Hits:"));makeElement("div",g,{id:"hitmanCount",style:"position: absolute; right: 260px; bottom: 43px; font-weight: 600;color: #BCD2EA;"}).appendChild(document.createTextNode(makeCommaValue(GM_getIntValue("hitmanWinCountInt",0)+GM_getIntValue("hitmanLossCountInt",0))));makeElement("div",g,{style:"position: absolute; left: 170px; bottom: 28px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Succ:"));makeElement("div",g,{id:"hitmanWinCount",style:"position: absolute; right: 260px; bottom: 28px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("hitmanWinCountInt",0))));var t=(GM_getValue("hitmanWinCountInt",0)/(GM_getValue("hitmanWinCountInt",0)+GM_getValue("hitmanLossCountInt",0))*100).toFixed(1);makeElement("div",g,{id:"hitmanWinPct",style:"position: absolute; right: 225px; bottom: 28px; font-size: 10px; font-weight: 100;color: #52E259;"}).appendChild(document.createTextNode(isNaN(t)?"0.0%":t+"%"));makeElement("div",g,{style:"position: absolute; left: 170px; bottom: 13px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Fail:"));makeElement("div",g,{id:"hitmanLossCount",style:"position: absolute; right: 260px; bottom: 13px; font-weight: 600;color: #EC2D2D;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("hitmanLossCountInt",0))));var u=(GM_getValue("hitmanLossCountInt",0)/(GM_getValue("hitmanWinCountInt",1)+GM_getValue("hitmanLossCountInt",0))*100).toFixed(1);makeElement("div",g,{id:"hitmanLossPct",style:"position: absolute; right: 225px; bottom: 13px; font-size: 10px; font-weight: 100;color: #EC2D2D;"}).appendChild(document.createTextNode(isNaN(u)?"0.0%":u+"%"));makeElement("div",g,{style:"position: absolute; left: 280px; bottom: 43px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Robs:"));makeElement("div",g,{id:"robCount",style:"position: absolute; right: 135px; bottom: 43px; font-weight: 600;color: #BCD2EA;"}).appendChild(document.createTextNode(makeCommaValue(GM_getIntValue("robSuccessCountInt",0)+GM_getIntValue("robFailedCountInt",0))));makeElement("div",g,{style:"position: absolute; left: 280px; bottom: 28px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Succ:"));makeElement("div",g,{id:"robWinCount",style:"position: absolute; right: 135px; bottom: 28px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("robSuccessCountInt",0))));var v=(GM_getValue("robSuccessCountInt",0)/(GM_getValue("robSuccessCountInt",0)+GM_getValue("robFailedCountInt",0))*100).toFixed(1);makeElement("div",g,{id:"robWinPct",style:"position: absolute; right: 100px; bottom: 28px; font-size: 10px; font-weight: 100;color: #52E259;"}).appendChild(document.createTextNode(isNaN(v)?"0.0%":v+"%"));makeElement("div",g,{style:"position: absolute; left: 280px; bottom: 13px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Fail:"));makeElement("div",g,{id:"robLossCount",style:"position: absolute; right: 135px; bottom: 13px; font-weight: 600;color: #EC2D2D;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("robFailedCountInt",0))));var w=(GM_getValue("robFailedCountInt",0)/(GM_getValue("robSuccessCountInt",1)+GM_getValue("robFailedCountInt",0))*100).toFixed(1);makeElement("div",g,{id:"robLossPct",style:"position: absolute; right: 100px; bottom: 13px; font-size: 10px; font-weight: 100;color: #EC2D2D;"}).appendChild(document.createTextNode(isNaN(w)?"0.0%":w+"%"));makeElement("div",g,{style:"position: absolute; right: 15px; bottom: 43px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Total $ Won/Lost"));var x="|";var y="|";for(i=0,iLength=cityStats.length;i<iLength;i++){x+=" "+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getValue(cityStats[i][cashWins],0))+" |";y+=""+cities[i][CITY_CASH_SYMBOL]+makeCommaValue(GM_getValue(cityStats[i][cashLosses],0))+" |"}makeElement("div",g,{id:"totalWinDollars",title:x,style:"position: absolute; right: 15px; bottom: 28px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(getDollarsUnit(GM_getIntValue("totalWinDollarsInt",0))));makeElement("div",g,{id:"totalLossDollars",title:y,style:"position: absolute; right: 15px; bottom: 13px; font-weight: 600;color: #EC2D2D;"}).appendChild(document.createTextNode(getDollarsUnit(GM_getIntValue("totalLossDollarsInt",0))));makeElement("div",g,{style:"position: absolute; left: 15px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Exp Gained:"));makeElement("div",g,{id:"totalExp",style:"position: absolute; right: 369px; bottom: 65px; font-size: 10px; font-weight: 600;color: #52E259;"}).appendChild(document.createTextNode(makeCommaValue(GM_getValue("totalExpInt",0))));makeElement("hr",g,{style:"position: absolute; left: 0; bottom: 57px; height: 1px; border: 0px; width: 475px; margin-left:10px; color: #666666; background-color: #666666"});makeElement("div",g,{style:"position: absolute; right: 287px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Gain Rate:"));var z=getStaminaGainRate();makeElement("div",g,{id:"expRate",style:"position: absolute; right: 260px; bottom: 65px; font-size: 10px; font-weight: 600;color: #04B4AE;"}).appendChild(document.createTextNode(z.toFixed(2)));makeElement("div",g,{style:"position: absolute; right: 195px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Nxt Lvl In:"));makeElement("div",g,{id:"expToNext",style:"position: absolute; right: 161px; bottom: 65px; font-size: 10px; font-weight: 600;color: #04B4AE;"}).appendChild(document.createTextNode(makeCommaValue(ptsToNextLevel)));makeElement("div",g,{style:"position: absolute; right: 56px; bottom: 65px; font-size: 10px; font-weight: 100;color: #666666;"}).appendChild(document.createTextNode("Stam Req'd to Lvl:"));makeElement("div",g,{id:"stamToNext",style:"position: absolute; right: 22px; bottom: 65px; font-size: 10px; font-weight: 600;color: #04B4AE;"}).appendChild(document.createTextNode(z?(ptsToNextLevel/z).toFixed(0):"n/a"))}eltRow=makeElement("ul",a,{style:"height:15px;position: absolute; overflow: hidden; right: 0px; bottom: 0px;margin:0px;padding:0px;"});eltCol=makeElement("li",eltRow,{style:"width:18px;height:15px;"});elt=makeElement("img",eltCol,{src:SCRIPT.PSMWAP_imagePath+"r6_c1.png",style:"width:18px;height:15px;"});eltCol=makeElement("li",eltRow,{style:"width:460px;height:15px;"});elt=makeElement("img",eltCol,{src:SCRIPT.PSMWAP_imagePath+"r6_c2.png",style:"width:460px;height:15px;"});eltCol=makeElement("li",eltRow,{style:"width:20px;height:15px;"});elt=makeElement("img",eltCol,{src:SCRIPT.PSMWAP_imagePath+"r6_c16.png",style:"width:20px;height:15px;"})}function getDollarsUnit(a){var b=["","K","M","G","T","P"];var c=0;while(a>1e3){a/=1e3;c++}return b[c]+"$"+a.toFixed(3)}function createSettingsBox(){var a=new Array(["General_Tab","generalTab","generalLink","General"],["Display_Tab","displayTab","displayLink","Display"],["Mafia_Tab","mafiaTab","mafiaLink","Mafia"],["Help_Missions_Tab","familyTab","helpmissionsLink","Family"],["Autostat_Tab","autostatTab","autostatLink","Auto Stat"],["Energy_Tab","energyTab","energyLink","Energy"],["Stamina_Tab","staminaTab","staminaLink","Stamina"],["Heal_Tab","healTab","healLink","Health"],["Cash_Tab","cashTab","cashLink","Cash"],["About_Tab","aboutTab","aboutLink","About"]);if(document.getElementById("MWAPSettingsBox")||!document.body)return;var b=makeElement("div",document.body,{id:"MWAPSettingsBox"});var c=makeElement("ul",b,{style:"height:15px;"});var d=makeElement("li",c,{style:"width:18px;height:15px;"});var e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r1_c1.png",style:"width:18px;height:15px;"});d=makeElement("li",c,{style:"width:762px;height:15px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r1_c2.png",style:"width:762px;height:15px;"});d=makeElement("li",c,{style:"width:20px;height:15px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r1_c16.png",style:"width:20px;height:15px;"});c=makeElement("ul",b,{id:"tabNav",style:"height:31px;"});d=makeElement("li",c,{style:"width:18px;height:31px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r2_c1.png",style:"width:18px;height:31px;"});for(i=0,iLength=a.length;i<iLength;i++){var f=a[i];d=makeElement("li",c,{"class":i==0?"selected":"",id:f[0]});var g=makeElement("a",d,{href:"#",rel:f[1],"class":f[2],alt:f[3],title:f[3]});if(isGMChecked("textOnlyMode"))g.appendChild(document.createTextNode("."+f[3]))}d=makeElement("li",c);d.addEventListener("click",toggleSettings,false);g=makeElement("a",d,{href:"#","class":"closeLink",alt:"close",title:"close"});if(isGMChecked("textOnlyMode"))g.appendChild(document.createTextNode("..........X"));d=makeElement("li",c,{style:"width:20px;height:31px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r2_c16.png",style:"width:20px;height:31px;"});c=makeElement("ul",b,{style:"height:20px;"});d=makeElement("li",c,{style:"width:18px;height:20px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r3_c1.png",style:"width:18px;height:20px;float:left;"});d=makeElement("li",c,{style:"width:200px; height:20px;text-align:center;"});d=makeElement("li",c,{style:"width:85px; height:20px;text-align:center;"});g=makeElement("a",d,{href:"#",alt:"default settings",title:"default setttings",style:"width:85px;","class":"settingsLink"});g.appendChild(document.createTextNode("Use Defaults"));g.addEventListener("click",saveDefaultSettings,false);d=makeElement("li",c,{style:"width:85px; height:20px;text-align:center;"});g=makeElement("a",d,{href:"#",alt:"save settings",title:"save setttings",style:"width:85px;","class":"settingsLink"});g.appendChild(document.createTextNode("Save Settings"));g.addEventListener("click",saveSettings,false);if(gvar.isGreaseMonkey){d=makeElement("li",c,{style:"width:60px; height:20px;text-align:center;"});g=makeElement("a",d,{href:"#",alt:"update",title:"update",style:"width:60px;","class":"settingsLink"});g.appendChild(document.createTextNode("Update"));g.addEventListener("click",updateScript,false)}else{d=makeElement("li",c,{style:"width:55px; height:20px;"})}d=makeElement("li",c,{id:"tabHeaderTitle",style:"width:242px; height:20px;"});d=makeElement("li",c,{style:"width:90px; height:20px;"});g=makeElement("a",d,{href:"http://mwap.me.uk/forum.html",target:"_none","class":"helpLink"});d=makeElement("li",c,{style:"width:20px;height:20px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r3_c16.png",style:"width:20px;height:20px;"});c=makeElement("ul",b,{style:"height:464px;"});d=makeElement("li",c,{style:"width:18px;height:464px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r3_c1.png",style:"width:18px;height:464px;float:left;"});d=makeElement("li",c,{style:"width:762px;height:464px;"});var h=makeElement("div",d,{id:"settingsBox"});var j=createGeneralTab();h.appendChild(j);var k=createDisplayTab();h.appendChild(k);var l=createMafiaTab();h.appendChild(l);var m=createFamilyTab();h.appendChild(m);var n=createAutostatTab();h.appendChild(n);var o=createEnergyTab();h.appendChild(o);var p=createStaminaTab();h.appendChild(p);var q=createHealTab();h.appendChild(q);var r=createCashTab();h.appendChild(r);var s=createAboutTab();h.appendChild(s);d=makeElement("li",c,{style:"width:20px;height:15px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r3_c16.png",style:"width:20px;height:464px;"});c=makeElement("ul",b,{style:"height:70px;"});d=makeElement("li",c,{style:"width:18px;height:70px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r5_c1.png",style:"width:18px;height:70px;"});d=makeElement("li",c);g=makeElement("a",d,{href:"http://mwap.me.uk/sign-up-today/pro-compare.html",target:"_blank","class":"mwapLink",alt:"mwap.me.uk",title:"mwap.me.uk"});d=makeElement("li",c,{style:"width:147px;height:70px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r5_c4.png",style:"width:147px;height:70px;"});d=makeElement("li",c,{style:"width:155px;height:70px;"});if(gvar.isGreaseMonkey){d=makeElement("li",c);g=makeElement("a",d,{href:"#","class":"updateButton",alt:"update",title:"update"});g.addEventListener("click",updateScript,false)}else{d=makeElement("li",c,{style:"width:152px;height:70px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"mwap_int_web_r5_c4.png",style:"width:152px;height:70px;"})}d=makeElement("li",c);g=makeElement("a",d,{href:"#","class":"saveButton",alt:"save settings",title:"save settings"});g.addEventListener("click",saveSettings,false);d=makeElement("li",c);e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r5_c16.png",style:"width:20px;height:70px;"});c=makeElement("ul",b,{style:"height:15px;"});d=makeElement("li",c,{style:"width:18px;height:15px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r6_c1.png",style:"width:18px;height:15px;"});d=makeElement("li",c,{style:"width:762px;height:15px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r6_c2.png",style:"width:762px;height:15px;"});d=makeElement("li",c,{style:"width:20px;height:15px;"});e=makeElement("img",d,{src:SCRIPT.PSMWAP_imagePath+"r6_c16.png",style:"width:20px;height:15px;"});createDynamicDrive()}function createDynamicDrive(){function a(){if(!document.getElementById("ddriveCode")){var b=makeElement("script",document.getElementsByTagName("head")[0],{id:"ddriveCode",type:"text/javascript"});b.src="http://cdn.playerscripts.co.uk/psmwap/tabURI.js";b.id="ddriveCode";window.setTimeout(a,350)}}var b=document.getElementById("ddriveCode");if(b)b.parentNode.removeChild(b);a()}function createGeneralTab(){function j(a){e=makeElement("div",a);g=makeElement("div",e,{"class":"lhs"});h=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"})}var a,b,c,d,e,f,g,h,i;var k=makeElement("div",null,{id:"generalTab","class":"tabcontent"});var l=makeElement("div",k,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});l.appendChild(document.createTextNode("General Settings:"));var m=makeElement("div",k,{style:"position: relative; top: 10px; margin-left: auto; margin-right: auto; width: 100%; line-height:120%;"});j(m);makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" General MWAP speed: "));var n=makeElement("select",h,{id:"fastMWAPSpeed"});iLength=mwapSpeedModes.length;if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse())iLength=iLength-2;for(f=0;f<iLength;++f){i=document.createElement("option");i.value=f;i.appendChild(document.createTextNode(mwapSpeedModes[f]));n.appendChild(i)}n.selectedIndex=GM_getValue("fastMWAPSpeed",0);j(m);b="Check this to enable auto-pause before or after level up.";c="autoPause";var o=makeElement("input",g,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",g,{"for":c}).appendChild(document.createTextNode(" Enable auto-pause:"));o.addEventListener("click",clickAutoPause,false);c="autoPauseBefore";b=" Before level up ";makeElement("input",h,{type:"radio",name:"r3",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));c="autoPauseAfter";b=" After level up ";makeElement("input",h,{type:"radio",name:"r3",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));j(m);c="autoPauseExp";h.appendChild(document.createTextNode("  Experience left to pause at: "));makeElement("input",h,{style:"text-align: right;",type:"text",value:GM_getValue(c,"50"),id:c,size:"2"});j(m);b="Check to idle in preferred city";c="idleLocation";makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" When idle, fly to:"));var p=makeElement("select",h,{id:"idleLocation"});for(f=0,iLength=cities.length;f<iLength;++f){i=document.createElement("option");i.value=f;if(f<cities.length)if(cities[f][CITY_CLOSED])i.style.display="none";i.appendChild(document.createTextNode(cities[f][CITY_NAME]));if(GM_getIntValue("idleLocation",NY)==f)p.selected=true;p.appendChild(i)}p.selectedIndex=GM_getValue("idleLocation",NY);j(m);b="Prioritise Energy / Stamina:";c="burnOption";makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(b));var q=makeElement("select",h,{id:c});for(f=0,iLength=burnModes.length;f<iLength;++f){i=document.createElement("option");i.value=f;i.appendChild(document.createTextNode(burnModes[f]));q.appendChild(i)}makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" burning."));q.selectedIndex=GM_getValue("burnOption",BURN_ALL);j(m);makeElement("br",e,{"class":"hide"});c="forceLevelSpending";b=" Force MWAP RX6to spend all energy and stamina first, when close to level<br>(ignoring other MWAP features)";makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));j(m);makeElement("br",e,{"class":"hide"});c="autoProcessPopups";b=" Try to process all popups when RX6 MWAP is running";makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){j(m);makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Auto Slot Machine Collection (PRO VERSION)"));j(m);makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Free 3 Slot Spins Daily Collection (PRO VERSION)"));j(m);makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Reallocation Check (Popup) (PRO VERSION)"));return k}else{j(m);c="AutoSlotMachine";b="Enable AutoSlotMachine";makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Auto Slot Machine Collection"));j(m);c="autoSlot3FreeSpins";b="Enable Auto 3 Free Spin Collect";makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Free 3 Slot Spins Daily Collection"));j(m);c="autoCheckReallocation";b="Enable Reallocation Check";makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Reallocation Check (Popup)"));return k}}function createDisplayTab(){function h(a){d=makeElement("div",a);f=makeElement("div",d,{"class":"lhs"});g=makeElement("div",d,{"class":"rhs"});makeElement("br",d,{"class":"hide"})}var a,b,c,d,e,f,g;var i=makeElement("div",null,{id:"displayTab","class":"tabcontent"});var j=makeElement("div",i,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});j.appendChild(document.createTextNode("Display Settings:"));var k=makeElement("div",i,{style:" top: 10px; margin-left: auto; margin-right: auto; width: 100%; line-height:120%;"});h(k);b="textOnlyMode";a="Use text labels when Images are Blocked";makeElement("input",g,{type:"checkbox",id:b},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Use text labels when Images are Blocked."));h(k);b="autoLog";a="Check this to enable logging.";makeElement("input",f,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",f,{"for":b,title:a}).appendChild(document.createTextNode(" Enable logging:"));b="autoLogLength";makeElement("input",g,{type:"text",id:b,value:GM_getValue(b,"300"),size:"2",style:"text-align: left"});g.appendChild(document.createTextNode(" max # of messages in log"));h(k);a="Check this to enable log filtering";b="filterLog";makeElement("input",f,{type:"checkbox",title:a,id:b,value:"checked"},b);makeElement("label",f,{"for":b}).appendChild(document.createTextNode(" Enable log filtering:"));b="filterOpt";var l=makeElement("select",g,{id:b});var m=["Accept patterns","Reject patterns"];for(c=0,iLength=m.length;c<iLength;++c){e=document.createElement("option");e.value=c;e.appendChild(document.createTextNode(m[c]));l.appendChild(e)}l.selectedIndex=GM_getValue(b,0);h(k);b="filterPatterns";var n=makeElement("textarea",g,{style:"position: static; width: 15em; height: 7em;",id:b,title:"Enter each pattern on a separate line."});n.appendChild(document.createTextNode(""));makeElement("br",g);makeElement("font",g,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each name pattern on a separate line."));var o=function(){var a=l.selectedIndex==0?defaultPassPatterns.join("\n"):defaultFailPatterns.join("\n");var b=l.selectedIndex==0?"filterPass":"filterFail";n.firstChild.nodeValue=GM_getValue(b,a)};o();l.addEventListener("change",o,false);h(k);b="leftAlign";a="Align game to the left";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Align game to the left"));h(k);b="mastheadOnTop";a="Enable to elevate RX6 MWAP-Header (pause/resume/settings etc) so that it's always on top";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Elevate RX6 MWAP-Header"));h(k);b="fbwindowtitle";a="Set window title to name on Facebook account";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Set window title to name on Facebook account"));h(k);b="showPulse";a="Hide iced targets on the fight list page";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Hide iced targets on the fight list page"));h(k);b="showLevel";a="Show player level on the hit list page";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Show level on the hit list page"));h(k);makeElement("label",f).appendChild(document.createTextNode(" Hide game elements "));b="hideAll";a="Hide All MW Icons";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Hide All MW Icons "));b="hideZyngaBanner";a=" Hide Z Promo Banner ";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" MW Promo Banner "));b="hideClanChat";a=" Hide Clan Chat ";makeElement("input",g,{type:"checkbox",id:b},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" ClanChat "));h(k);b="noStats";a="Disable MWAP Stats";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" MWAP Stats Tracking disabled"));h(k);makeElement("label",f).appendChild(document.createTextNode(" Choose where to play "));if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){b="playMWAPLite";a="RX6 MWAP LITE Page Play";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Play on mwap.me.uk (LITE) "));b="playMWAPLiteRX2";a="RX6 MWAP LITE (2) Link, this resolves problems for clicking in-game";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Use RX6 LITE 2nd Link"));playMWAP=0;playMWAPRX2=0}else{b="playMWAP";a="RX6 MWAP Pro Page Play";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Play on mwap.me.uk (PRO) "));b="playMWAPRX2";a="RX6 MWAP Pro (2) Link, this resolves problems for clicking in-game";makeElement("input",g,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode(" Use RX6 PRO 2nd Link "));playMWAPLite=0;playMWAPLiteRX2=0}h(k);makeElement("label",g,{"for":b,title:a}).appendChild(document.createTextNode("RX6 2nd Link - use if you have probs clicking in-game such as Daily Take. Playing on mwap.me.uk is faster than facebook, but if you do have any problems, unclick both and play on FACEBOOK."));return i}function createDisplayTabNew2012(){function h(a){d=makeElement("div",a);jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1"})}var a,b,c,d,e,f,g;var i=makeElement("div",null,{id:"displayTab","class":"tabcontent"});var j=makeElement("div",i,{"class":"jsRX6Tabs"});d=makeElement("div",j);jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1",style:"float:left;width:46%"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Choose Logging and Filtering Options"));b="autoLog";a="Check this to enable logging.";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Enable logging:"));b="autoLogLength";makeElement("input",jqRX6buttonId1,{type:"text",id:b,value:GM_getValue(b,"300"),size:"2",style:"text-align: left"});jqRX6buttonId1.appendChild(document.createTextNode(" max # of messages in log"));makeElement("br",jqRX6buttonId1,{"class":"hide"});makeElement("br",jqRX6buttonId1,{"class":"hide"});a="Check this to enable log filtering";b="filterLog";makeElement("input",jqRX6buttonId1,{type:"checkbox",title:a,id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,"class":"jqSpacer"}).appendChild(document.createTextNode("Enable log filtering:"));b="filterOpt";var k=makeElement("select",jqRX6buttonId1,{id:b,"class":"RX6dropdown2"});var l=["Accept patterns","Reject patterns"];for(c=0,iLength=l.length;c<iLength;++c){e=document.createElement("option");e.value=c;e.appendChild(document.createTextNode(l[c]));k.appendChild(e)}k.selectedIndex=GM_getValue(b,0);makeElement("br",jqRX6buttonId1,{"class":"hide"});b="filterPatterns";var m=makeElement("textarea",jqRX6buttonId1,{style:"position: static; margin-left:128px;width: 15em; height: 7em;",id:b,title:"Enter each pattern on a separate line."});m.appendChild(document.createTextNode(""));makeElement("br",jqRX6buttonId1);makeElement("font",jqRX6buttonId1,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each name pattern on a separate line."));var n=function(){var a=k.selectedIndex==0?defaultPassPatterns.join("\n"):defaultFailPatterns.join("\n");var b=k.selectedIndex==0?"filterPass":"filterFail";m.firstChild.nodeValue=GM_getValue(b,a)};n();k.addEventListener("change",n,false);jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1",style:"float:right;width:46%"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Format Options for Browser"));b="leftAlign";a="Align game to the left";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Align game to the left "));makeElement("br",jqRX6buttonId1,{"class":"hide"});b="mastheadOnTop";a="Enable to elevate RX6 MWAP-Header (pause/resume/settings etc) so that it's always on top";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Elevate RX6 MWAP-Header "));makeElement("br",jqRX6buttonId1,{"class":"hide"});b="fbwindowtitle";a="Set window title to name on Facebook account";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Set window title to name on Facebook account"));jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1",style:"padding-bottom:16px;float:right;width:46%"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Choose to show Iced Targets or their Level"));b="showPulse";a="Hide iced targets on the fight list page";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode(" Hide iced targets on the fight list page "));makeElement("br",jqRX6buttonId1,{"class":"hide"});b="showLevel";a="Show player level on the hit list page";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Show level on the hit list page"));jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1",style:"padding-bottom:16px;float:left;width:46%"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Choose to hide Zynga Game Elements"));b="hideAll";a="Hide All MW Icons";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Hide All MW Icons "));makeElement("br",jqRX6buttonId1,{"class":"hide"});b="hideZyngaBanner";a=" Hide Z Promo Banner ";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("MW Promo Banner "));makeElement("br",jqRX6buttonId1,{"class":"hide"});b="hideClanChat";a=" Hide Clan Chat ";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("ClanChat "));jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1",style:"padding-bottom:58px;float:right;width:46%"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Disable RX6 Stats (Logging Display)"));b="noStats";a="Disable MWAP Stats";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Disable MWAP Stats Tracking"));jqRX6buttonId1=makeElement("div",d,{"class":"jqRX6buttonId1"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading",style:"width:47%"}).appendChild(document.createTextNode("Choose to play on mwap.me or facebook"));if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){b="playMWAPLite";a="RX6 MWAP LITE Page Play";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Play on mwap.me.uk (LITE) "));b="playMWAPLiteRX2";a="RX6 MWAP LITE (2) Link, this resolves problems for clicking in-game";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Use RX6 LITE 2nd Link"));playMWAP=0;playMWAPRX2=0}else{b="playMWAP";a="RX6 MWAP Pro Page Play";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Play on mwap.me.uk (PRO) "));b="playMWAPRX2";a="RX6 MWAP Pro (2) Link, this resolves problems for clicking in-game";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:b,value:"checked"},b);makeElement("label",jqRX6buttonId1,{"for":b,title:a,"class":"jqSpacer"}).appendChild(document.createTextNode("Use RX6 PRO 2nd Link "));playMWAPLite=0;playMWAPLiteRX2=0}makeElement("br",jqRX6buttonId1,{"class":"hide"});makeElement("font",jqRX6buttonId1,{style:"width:760px;font:size:10px;color:yellow"}).appendChild(document.createTextNode("RX6 2nd Link - use if you have probs clicking in-game such as Daily Take. Playing on mwap.me.uk is faster than facebook,"));makeElement("p",jqRX6buttonId1,{"class":"hide"});makeElement("font",jqRX6buttonId1,{style:"width:760px;font:size:10px;color:yellow"}).appendChild(document.createTextNode("but if you do have any problems, unclick both and play on FACEBOOK."));return i}function createGeneralTabNew2012(){function l(a){e=makeElement("div",a);h=makeElement("div",e,{"class":"jqRX6buttonId1"})}var a,b,c,d,e,f,g,h,i,j,k;if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){i=true}var m=makeElement("div",null,{id:"generalTab","class":"tabcontent"});var n=makeElement("div",m,{"class":"jsRX6Tabs"});l(n);makeElement("font",h,{style:"padding-left:29px;padding-right:2px"}).appendChild(document.createTextNode("General MWAP Speed:"));var o=makeElement("select",h,{id:"fastMWAPSpeed","class":"RX6dropdown2",style:"width:70px",type:"text"});iLength=mwapSpeedModes.length;if(!i)iLength=iLength-2;for(f=0;f<iLength;++f){g=document.createElement("option");g.value=f;g.appendChild(document.createTextNode(mwapSpeedModes[f]));o.appendChild(g)}o.selectedIndex=GM_getValue("fastMWAPSpeed",0);l(n);b="Check to idle in preferred city";c="idleLocation";makeElement("font",h,{style:"padding-left:60px;padding-right:2px"}).appendChild(document.createTextNode("When idle, fly to:"));var p=makeElement("select",h,{id:"idleLocation","class":"RX6dropdown2",style:"width:70px",type:"text"});for(f=0,iLength=cities.length;f<iLength;++f){g=document.createElement("option");g.value=f;if(f<cities.length)if(cities[f][CITY_CLOSED])g.style.display="none";g.appendChild(document.createTextNode(cities[f][CITY_NAME]));if(GM_getIntValue("idleLocation",NY)==f)p.selected=true;p.appendChild(g)}p.selectedIndex=GM_getValue("idleLocation",NY);l(n);b=" Prioritise Energy / Stamina: ";c="burnOption";makeElement("label",h,{"for":c,title:b}).appendChild(document.createTextNode(b));var q=makeElement("select",h,{id:c,"class":"RX6dropdown2",style:"width:70px",type:"text"});for(f=0,iLength=burnModes.length;f<iLength;++f){g=document.createElement("option");g.value=f;g.appendChild(document.createTextNode(burnModes[f]));q.appendChild(g)}makeElement("label",h,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("burning."));q.selectedIndex=GM_getValue("burnOption",BURN_ALL);l(n);b="Check this to enable auto-pause before or after level up.";c="autoPause";var r=makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c,"class":"jqSpacer"}).appendChild(document.createTextNode("Enable auto-pause:"));r.addEventListener("click",clickAutoPause,false);c="autoPauseBefore";b=" Before level up  ";makeElement("input",h,{type:"radio",name:"r3",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));c="autoPauseAfter";b=" After level up ";makeElement("input",h,{type:"radio",name:"r3",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));makeElement("br",h,{"class":"hide"});makeElement("br",h,{"class":"hide"});c="autoPauseExp";h.appendChild(document.createTextNode(" Experience left to pause at: "));makeElement("input",h,{"class":"jqDrop70",type:"text",value:GM_getValue(c,"50"),id:c,size:"2"});l(n);makeElement("br",e,{"class":"hide"});c="autoProcessPopups";b=" Try to process all popups when RX6 MWAP is running";makeElement("input",h,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",h,{"for":c}).appendChild(document.createTextNode(b));l(n);j=" - RX6 PRO FEATURE Only";k="Auto Slots, Spins & Allocation";if(!i)k+=j;makeElement("div",h,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode(k));var s=new Array(["AutoSlotMachine","Enable Auto Slot Machine Collection","Auto Slot Machine Collection"],["autoSlot3FreeSpins","Enable Free 3 Slot Spins Daily Collection","Free 3 Slot Spins Daily Collection"],["autoCheckReallocation","Enable Reallocation Check (Popup)","Reallocation Check (Popup)"]);for(f=0;f<s.length;f++){var t=s[f];a=makeElement("input",h,{type:"checkbox",id:t[0],value:"checked"},t[0]);makeElement("label",h,{"for":t[0],title:t[1],"class":"jqSpacer"}).appendChild(document.createTextNode(t[2]));if(!i){a.checked=false;a.disabled=true}}return m}function createMafiaTab(){function k(a){e=makeElement("div",a);f=makeElement("div",e,{"class":"lhs"});g=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"})}var a,b,c,d,e,f,g,h,i;var l=makeElement("div",null,{id:"mafiaTab","class":"tabcontent"});var m=makeElement("div",l,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});m.appendChild(document.createTextNode("Mafia Settings:"));var n=makeElement("div",l,{style:"position: relative; top: 10px; margin-left: 40px; margin-right: auto; width: 95%; line-height:120%;"});k(n);b="Check if you want to ask for help automatically with jobs.";c="autoAskJobHelp";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" Ask for job help at:"));b="Enter the minimum experience to ask for job help, or 0 for no minimum.";c="autoAskJobHelpMinExp";makeElement("input",g,{type:"text",value:GM_getValue(c,"0"),title:b,id:c,size:"2"});g.appendChild(document.createTextNode(" minimum experience"));var o=makeElement("div",n);f=makeElement("div",o,{"class":"lhs"});g=makeElement("div",o,{"class":"rhs"});makeElement("br",o,{"class":"hide"});b="Ask for Help on Brazil Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectBrazilTier";d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for Brazil help:"));var p=makeElement("select",g,{id:c,title:b});choiceBrazilTier=document.createElement("option");choiceBrazilTier.text="no Help in Brazil";choiceBrazilTier.value="0";if(GM_getValue("selectBrazilTier")=="0")choiceBrazilTier.selected=true;p.appendChild(choiceBrazilTier);for(j=0;j<missionTabs[BRAZIL].length;j++){choiceBrazilTier=document.createElement("option");choiceBrazilTier.text=missionTabs[BRAZIL][j];choiceBrazilTier.value=j+1;if(GM_getValue("selectBrazilTier",0)-1==j)choiceBrazilTier.selected=true;p.appendChild(choiceBrazilTier)}var q=makeElement("div",n);f=makeElement("div",q,{"class":"lhs"});g=makeElement("div",q,{"class":"rhs"});makeElement("br",q,{"class":"hide"});b="Ask for Help on Chicago Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectChicagoTier";d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for Chicago help:"));var r=makeElement("select",g,{id:c,title:b});choiceChicagoTier=document.createElement("option");choiceChicagoTier.text="no Help in Chicago";choiceChicagoTier.value="0";if(GM_getValue("selectChicagoTier")=="0")choiceChicagoTier.selected=true;r.appendChild(choiceChicagoTier);for(j=0;j<missionTabs[CHICAGO].length;j++){choiceChicagoTier=document.createElement("option");choiceChicagoTier.text=missionTabs[CHICAGO][j];choiceChicagoTier.value=j+1;if(GM_getValue("selectChicagoTier",0)-1==j)choiceChicagoTier.selected=true;r.appendChild(choiceChicagoTier)}var s=makeElement("div",n);f=makeElement("div",s,{"class":"lhs"});g=makeElement("div",s,{"class":"rhs"});makeElement("br",s,{"class":"hide"});b="Ask for Help on London Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectLondonTier";d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for London help:"));var t=makeElement("select",g,{id:c,title:b});choiceLondonTier=document.createElement("option");choiceLondonTier.text="no Help in London";choiceLondonTier.value="0";if(GM_getValue("selectLondonTier")=="0")choiceLondonTier.selected=true;t.appendChild(choiceLondonTier);for(j=0;j<missionTabs[LONDON].length;j++){choiceLondonTier=document.createElement("option");choiceLondonTier.text=missionTabs[LONDON][j];choiceLondonTier.value=j+1;if(GM_getValue("selectLondonTier",0)-1==j)choiceLondonTier.selected=true;t.appendChild(choiceLondonTier)}var u=makeElement("div",n);f=makeElement("div",u,{"class":"lhs"});g=makeElement("div",u,{"class":"rhs"});makeElement("br",u,{"class":"hide"});b="Ask for Help on Vegas Tier Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectVegasTier";d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for Vegas help:"));var v=makeElement("select",g,{id:c,title:b});choiceVegasTier=document.createElement("option");choiceVegasTier.text="no Help in Vegas";choiceVegasTier.value="0";if(GM_getValue("selectVegasTier")=="0")choiceVegasTier.selected=true;v.appendChild(choiceVegasTier);for(h=0;h<missions.length;h++){if(missions[h][MISSION_CITY]==LV&&missions[h][MISSION_EOL]==2){choiceVegasTier=document.createElement("option");choiceVegasTier.text=missions[h][MISSION_NAME];choiceVegasTier.value=h;if(GM_getValue("selectVegasTier")==h)choiceVegasTier.selected=true;v.appendChild(choiceVegasTier)}}k(n);if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){b="Automatically ask to join City Crews";c="autoAskCityCrew";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" Ask to Join City Crews"))}makeElement("br",g);b="Automatically accept mafia invitations.";c="acceptMafiaInvitations";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" Accept mafia invitations"));k(n);d=makeElement("label",f);d.appendChild(document.createTextNode("autoProcess Player Updates:"));b="Process and Log Player Updates";c="logPlayerUpdates";makeElement("input",g,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" (autoHelp mafia on wars, burners, jobs, ...)"));k(n);d=makeElement("label",f);d.appendChild(document.createTextNode("Enable publishing to FB Wall :"));b="Automatically click Publish on every Post Popup.";c="autoGlobalPublishing";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" Global Publishing "));k(n);b="Automatically post iced opponent bonus.";c="autoIcePublish";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" Ice bonus, every "));b="Enter the publishing Frequency";c="autoIcePublishFrequency";makeElement("input",g,{type:"text",value:GM_getValue(c,"1"),title:b,id:c,size:"1"});g.appendChild(document.createTextNode(" th time"));makeElement("br",g,{"class":"hide"});b="Check if you want to share wishlist.";c="autoShareWishlist";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" Wishlist every: "));b="Enter the number of hours to wait before sharing wishlist again. Has to be at least 1 hour, and can be decimal (e.g. 1.5).";c="autoShareWishlistTime";makeElement("input",g,{type:"text",value:GM_getValue(c,"1"),title:b,id:c,size:"2"});g.appendChild(document.createTextNode(" hour(s)"));k(n);d=makeElement("label",f);d.appendChild(document.createTextNode(" Message Center: "));b="Check to autoAccept Message Center Gifts";c="autoAcceptMsgGifts";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" autoAccept Gifts "));b="Check to autoAccept Message Center Boosts";c="autoAcceptMsgBoosts";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" autoAccept Boosts "));b="Check to autoAccept Message Crew Members";c="autoAcceptMsgCrew";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" autoAccept Crew "));b="Send Energy Packs from Message Center";c="autosendMsgEnergyPack";makeElement("input",g,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" autoSend Energy Packs"));k(n);d=makeElement("label",f);d.appendChild(document.createTextNode(" enable autoWar: "));c="warMode";var w=makeElement("select",g,{id:c});for(h=0,iLength=warModeChoices.length;h<iLength;++h){i=document.createElement("option");i.value=h;i.appendChild(document.createTextNode(warModeChoices[h]));w.appendChild(i)}w.selectedIndex=GM_getValue("warMode",0);b="Enter opponents Mafia Wars ID";c="autoWarTargetList";var x=makeElement("font",g,{style:"font-size: 10px;"});x.appendChild(document.createTextNode("Enter each target on a separate line. Add the userid part of the p|userid."));makeElement("br",g,{"class":"hide"});var y=makeElement("textarea",g,{style:"width: 12em; height: 6em;",id:c,title:"Enter each Mafia Wars ID on a separate line. This will not work with the Facebook ID."});y.appendChild(document.createTextNode(GM_getValue("autoWarTargetList","")));makeElement("br",g,{"class":"hide"});var z=function(){y.style.display=w.selectedIndex==2?"":"none";x.style.display=w.selectedIndex==2?"":"none"};z();w.addEventListener("change",z,false);return l}function createMafiaTabNew2012(){function l(a){e=makeElement("div",a);k=makeElement("div",e,{"class":"jqRX6buttonId1"})}var a,b,c,d,e,f,g,h,i,k;var m=makeElement("div",null,{id:"mafiaTab","class":"tabcontent"});var n=makeElement("div",m,{"class":"jsRX6Tabs"});e=makeElement("div",n);l(n);makeElement("div",k,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Would you like help with jobs?"));b="Check if you want to ask for help automatically with jobs.";c="autoAskJobHelp";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Ask for job help at:  "));b="Enter the minimum experience to ask for job help, or 0 for no minimum.";c="autoAskJobHelpMinExp";makeElement("input",k,{type:"text",value:GM_getValue(c,"0"),title:b,id:c,size:"2"});k.appendChild(document.createTextNode(" minimum experience"));var o=makeElement("div",n);makeElement("br",k,{"class":"hide"});makeElement("br",k,{"class":"hide"});b="Ask for Help on Brazil Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectBrazilTier";d=makeElement("label",k,{"for":c,title:b});d.appendChild(document.createTextNode("Brazil:"));var p=makeElement("select",k,{id:c,title:b,"class":"RX6dropdown2",style:"margin-left:24px;margin-right:31px"});choiceBrazilTier=document.createElement("option");choiceBrazilTier.text="no Help in Brazil";choiceBrazilTier.value="0";if(GM_getValue("selectBrazilTier")=="0")choiceBrazilTier.selected=true;p.appendChild(choiceBrazilTier);for(j=0;j<missionTabs[BRAZIL].length;j++){choiceBrazilTier=document.createElement("option");choiceBrazilTier.text=missionTabs[BRAZIL][j];choiceBrazilTier.value=j+1;if(GM_getValue("selectBrazilTier",0)-1==j)choiceBrazilTier.selected=true;p.appendChild(choiceBrazilTier)}var q=makeElement("div",n);b="Ask for Help on Chicago Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectChicagoTier";d=makeElement("label",k,{"for":c,title:b});d.appendChild(document.createTextNode("Chicago:"));var r=makeElement("select",k,{id:c,title:b,"class":"RX6dropdown2",style:"margin-left:12px;margin-right:17px"});choiceChicagoTier=document.createElement("option");choiceChicagoTier.text="no Help in Chicago";choiceChicagoTier.value="0";if(GM_getValue("selectChicagoTier")=="0")choiceChicagoTier.selected=true;r.appendChild(choiceChicagoTier);for(j=0;j<missionTabs[CHICAGO].length;j++){choiceChicagoTier=document.createElement("option");choiceChicagoTier.text=missionTabs[CHICAGO][j];choiceChicagoTier.value=j+1;if(GM_getValue("selectChicagoTier",0)-1==j)choiceChicagoTier.selected=true;r.appendChild(choiceChicagoTier)}var s=makeElement("div",n);makeElement("br",k,{"class":"hide"});b="Ask for Help on London Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectLondonTier";d=makeElement("label",k,{"for":c,title:b});d.appendChild(document.createTextNode("London:"));var t=makeElement("select",k,{id:c,title:b,"class":"RX6dropdown2",style:"margin-left:12px;margin-right:29px"});choiceLondonTier=document.createElement("option");choiceLondonTier.text="no Help in London";choiceLondonTier.value="0";if(GM_getValue("selectLondonTier")=="0")choiceLondonTier.selected=true;t.appendChild(choiceLondonTier);for(j=0;j<missionTabs[LONDON].length;j++){choiceLondonTier=document.createElement("option");choiceLondonTier.text=missionTabs[LONDON][j];choiceLondonTier.value=j+1;if(GM_getValue("selectLondonTier",0)-1==j)choiceLondonTier.selected=true;t.appendChild(choiceLondonTier)}var u=makeElement("div",n);b="Ask for Help on Vegas Tier Jobs - Be carefull to only choose available Jobs / Tiers !";c="selectVegasTier";d=makeElement("label",k,{"for":c,title:b});d.appendChild(document.createTextNode("Vegas:"));var v=makeElement("select",k,{id:c,title:b,"class":"RX6dropdown2",style:"margin-left:22px;margin-right:21px !important"});choiceVegasTier=document.createElement("option");choiceVegasTier.text="no Help in Vegas";choiceVegasTier.value="0";if(GM_getValue("selectVegasTier")=="0")choiceVegasTier.selected=true;v.appendChild(choiceVegasTier);for(h=0;h<missions.length;h++){if(missions[h][MISSION_CITY]==LV&&missions[h][MISSION_EOL]==2){choiceVegasTier=document.createElement("option");choiceVegasTier.text=missions[h][MISSION_NAME];choiceVegasTier.value=h;if(GM_getValue("selectVegasTier")==h)choiceVegasTier.selected=true;v.appendChild(choiceVegasTier)}}k=makeElement("div",e,{"class":"jqRX6buttonId1",style:"width:46%;float:left"});makeElement("div",k,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Join City Crews & Accept Mafia"));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){b="Automatically ask to join City Crews";c="autoAskCityCrew";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Ask to Join City Crews "))}b="Automatically accept mafia invitations.";c="acceptMafiaInvitations";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Accept mafia invitations "));k=makeElement("div",e,{"class":"jqRX6buttonId1",style:"width:46%;float:right"});makeElement("div",k,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Process All Player Updates"));b="Process and Log Player Updates";c="logPlayerUpdates";makeElement("input",k,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",k,{"class":"jqSpacer"});d.appendChild(document.createTextNode("Auto Process Player Updates"));k=makeElement("div",e,{"class":"jqRX6buttonId1",style:"width:46%;float:left;padding-bottom:31px"});makeElement("div",k,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Enable publishing to FB Wall"));b="Automatically click Publish on every Post Popup.";c="autoGlobalPublishing";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Global Publishing "));makeElement("br",k,{"class":"hide"});b="Automatically post iced opponent bonus.";c="autoIcePublish";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Ice bonus, every"));b="Enter the publishing Frequency";c="autoIcePublishFrequency";makeElement("input",k,{type:"text",value:GM_getValue(c,"1"),title:b,id:c,size:"1"});k.appendChild(document.createTextNode(" th time"));makeElement("br",k,{"class":"hide"});b="Check if you want to share wishlist.";c="autoShareWishlist";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Wishlist every "));b="Enter the number of hours to wait before sharing wishlist again. Has to be at least 1 hour, and can be decimal (e.g. 1.5).";c="autoShareWishlistTime";makeElement("input",k,{type:"text",value:GM_getValue(c,"1"),title:b,id:c,size:"1",style:"margin-left:10px"});k.appendChild(document.createTextNode(" hour(s)"));k=makeElement("div",e,{"class":"jqRX6buttonId1",style:"width:46%;float:right"});makeElement("div",k,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Message Center"));b="Check to autoAccept Message Center Gifts";c="autoAcceptMsgGifts";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Auto Accept Gifts"));makeElement("br",k,{"class":"hide"});b="Check to autoAccept Message Center Boosts";c="autoAcceptMsgBoosts";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Auto Accept Boosts"));makeElement("br",k,{"class":"hide"});b="Check to autoAccept Message Crew Members";c="autoAcceptMsgCrew";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Auto Accept Crew"));makeElement("br",k,{"class":"hide"});b="Send Energy Packs from Message Center";c="autosendMsgEnergyPack";makeElement("input",k,{type:"checkbox",id:c,title:b,value:"checked"},c);makeElement("label",k,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Auto Send Energy Packs"));l(n);makeElement("div",k,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Auto War Random Enemies or from a list"));d=makeElement("label",k,{"class":"jqSpacer"});d.appendChild(document.createTextNode("Enable Auto-War:"));c="warMode";var w=makeElement("select",k,{id:c,"class":"RX6dropdown2"});for(h=0,iLength=warModeChoices.length;h<iLength;++h){i=document.createElement("option");i.value=h;i.appendChild(document.createTextNode(warModeChoices[h]));w.appendChild(i)}w.selectedIndex=GM_getValue("warMode",0);b="Enter opponents Mafia Wars ID";c="autoWarTargetList";var x=makeElement("font",k,{style:"font-size: 10px;"});x.appendChild(document.createTextNode("Enter each target on a separate line. Add the userid part of the p|userid."));makeElement("br",k,{"class":"hide"});var y=makeElement("textarea",k,{style:"width: 12em; height: 6em;margin-left:50px:margin-top:5px",id:c,title:"Enter each Mafia Wars ID on a separate line. This will not work with the Facebook ID."});y.appendChild(document.createTextNode(GM_getValue("WarTargetList","")));var z=function(){y.style.display=w.selectedIndex==2?"":"none";x.style.display=w.selectedIndex==2?"":"none"};z();w.addEventListener("change",z,false);return m}function createFamilyTab(){var a,b,c,d,e,f,g,h,i,j;var k=makeElement("div",null,{id:"familyTab","class":"tabcontent"});var l=makeElement("div",k,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});l.appendChild(document.createTextNode("Family : Operations, Boss, Battle and Free Gift:"));makeElement("h2",k,{style:"position: absolute; width: 100%; left: 30px; top: 25px;"}).appendChild(document.createTextNode(" Operations Settings "));var m=makeElement("div",k,{style:"position: absolute; width: 100%; left: 40px; top: 35px;"});c="autoStartMyOps";b="Enable Personal Operations";var n=makeElement("div",m,{style:"position: absolute; text-align: left; top: 20px; left: 10px;"});makeElement("input",n,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",n,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Personal Operations "));c="autoStartFamOps";b="Participate In Family Operations";var o=makeElement("div",m,{style:"position: absolute; text-align: left; top: 20px; left: 200px;"});makeElement("input",o,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",o,{"for":c,title:b}).appendChild(document.createTextNode(" Participate In Family Operations "));if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){return k}else{makeElement("h2",k,{style:"position: absolute; width: 100%; left: 30px; top: 85px;"}).appendChild(document.createTextNode(" Family Rewards "));c="AutoFamilyRewards";b="Enable Auto Family Rewards Collection";var p=makeElement("div",m,{style:"position: absolute; text-align: left; top: 80px; left: 10px;"});makeElement("input",p,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Auto Family Rewards Collect"));makeElement("h2",k,{style:"position: absolute; width: 100%; left: 30px; top: 145px;"}).appendChild(document.createTextNode(" Family Boss Fight Settings "));c="autoFamilyBosses";b="Enable Family Bosses";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 135px; left: 10px;"});makeElement("input",p,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Family Bosses "));c="autoFamilyBossFighting";b="Enable Family Boss Fighting";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 135px; left: 10px;"});makeElement("input",p,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Auto Family Boss Fighting "));c="bossRole";b="Boss Role";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 140px; left: 35px;"});makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Boss Role "));var q=makeElement("select",p,{id:c,style:"margin-left:5px;"});iLength=bossRoles.length;for(h=0;h<iLength;++h){i=document.createElement("option");i.value=h;i.appendChild(document.createTextNode(bossRoles[h].capitalize()));q.appendChild(i)}q.selectedIndex=GM_getValue("bossRole",0);c="bossStaminaLimit";b="Boss Stamina Limit";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 120px; left: 240px;"});makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Boss Stamina Limit "));var q=makeElement("select",p,{id:c,style:"margin-left:5px;"});iLength=bossStaminaLimits.length;for(h=0;h<iLength;++h){i=document.createElement("option");i.value=h;i.appendChild(document.createTextNode(bossStaminaLimits[h]));q.appendChild(i)}q.selectedIndex=GM_getValue("bossStaminaLimit",0);c="bossRageLimit";b="Boss Rage Limit (0 - 1000)";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 100px; left: 440px;"});makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Boss Rage Limit "));makeElement("input",p,{style:"text-align: right;",type:"text",value:GM_getValue(c,"0"),id:c,size:"6",style:"margin-left:5px;"});c="askBossFightBoosts";b="Ask for Family Boss Boosts";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 105px; left: 10px;"});makeElement("input",p,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Ask for Family Boss Boosts "));c="sendBossFightBoosts";b="Send Family Boss Boosts";var p=makeElement("div",m,{style:"position: relative; text-align: left; top: 85px; left: 230px;"});makeElement("input",p,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",p,{"for":c,title:b}).appendChild(document.createTextNode(" Send Family Boss Boosts "));makeElement("h2",k,{style:"position: absolute; width: 100%; left: 35px; top: 275px;"}).appendChild(document.createTextNode("Family Battle Settings"));c="AutoBattleFight";b="Enable AutoBattle Fighting";var r=makeElement("div",m,{style:"position: absolute; text-align: left; top: 270px; left: 10px;"});makeElement("input",r,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",r,{"for":c,title:b}).appendChild(document.createTextNode(" Enable AutoBattle Fighting"));c="AutoBattleSafehouse";b="Enable Battle Safehouse Attacking";var s=makeElement("div",m,{style:"position: absolute; text-align: left; top: 270px; left: 280px;"});makeElement("input",s,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",s,{"for":c,title:b}).appendChild(document.createTextNode(" Enable Battle Safehouse Attacking"));c="AutoBattle";b="Enable AutoBattle";var t=makeElement("div",m,{style:"position: absolute; text-align: left; top: 295px; left: 10px;"});makeElement("input",t,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",t,{"for":c,title:b}).appendChild(document.createTextNode(" Enable AutoBattle (Only if Underboss/GF)"));c="AutoBattleClanID";b="ClanID";var u=makeElement("div",m,{style:"position: absolute; text-align: left; top: 295px; left: 280px;"});makeElement("input",u,{style:"text-align: right;",type:"text",value:GM_getValue(c,"0"),id:c,size:"6"});makeElement("label",u,{"for":c,title:b}).appendChild(document.createTextNode(" Clan / Family ID"));b="Enter MW Family Link";c="familyListSingleLink";makeElement("input",m,{type:"text",id:c,title:b,style:"position: absolute; text-align: left; top: 315px; left: 280px;width: 300px;"});b="Add Family ID from MW Family Link";c="familySingleAdd";eltA=makeElement("a",m,{id:c,href:"#",alt:b,title:b,style:"position: absolute; text-align: left; top: 315px; left: 585px;"});eltA.appendChild(document.createTextNode("Add Family ID"));eltA.addEventListener("click",addSingleFamilyID,false);makeElement("h2",k,{style:"position: absolute; text-align:left; left: 35px; top: 380px;"}).appendChild(document.createTextNode(" Free Gifts "));c="autoFreeGift";b="Enable Auto Free Gifting";var v=makeElement("div",m,{style:"position: absolute; text-align: left; top: 375px; left: 10px;"});makeElement("label",v,{"for":c,title:b}).appendChild(document.createTextNode(b));c="selectFreeGift";var w=makeElement("select",m,{id:c,title:b,style:"position: absolute; text-align: left; top: 375px; left: 160px;"});choiceFreeGift=document.createElement("option");choiceFreeGift.text="don't send free gifts";choiceFreeGift.value=0;if(GM_getValue("selectFreeGift",0)==0)choiceFreeGift.selected=true;w.appendChild(choiceFreeGift);freeGiftList.sort(function(a,b){if(a[3]<b[3])return-1;if(a[3]>b[3])return 1;return 0});var x="";for(h=0;h<freeGiftList.length;h++){if(freeGiftList[h][1]){if(x!=freeGiftList[h][3]){choiceGroup=document.createElement("optgroup");choiceGroup.label=freeGiftList[h][3].toUpperCase();w.appendChild(choiceGroup);x=freeGiftList[h][3]}choiceFreeGift=document.createElement("option");choiceFreeGift.text=freeGiftList[h][2].capitalize();choiceFreeGift.value=freeGiftList[h][1];if(GM_getValue("selectFreeGift",0)==freeGiftList[h][1])choiceFreeGift.selected=true;w.appendChild(choiceFreeGift)}}c="autoDispatch";b="Enable RX6 Gift Dispatcher";var v=makeElement("div",m,{style:"position: absolute; text-align: left; top: 395px; left: 10px;"});makeElement("label",v,{"for":c,title:b}).appendChild(document.createTextNode(b+" to: "));c="dispatchTarget";b="RX6 Gift Dispatch Targets";var y=makeElement("select",m,{id:c,title:b,style:"position: absolute; text-align: left; top: 395px; left: 200px;"});for(h=0,iLength=dispatchTargets.length;h<iLength;h++){var z=document.createElement("option");z.text=dispatchTargets[h][1];z.value=dispatchTargets[h][0];if(GM_getValue("dispatchTarget",0)==dispatchTargets[h][0])z.selected=true;y.appendChild(z)}freeGiftList.sort(function(a,b){if(a[2]<b[2])return-1;if(a[2]>b[2])return 1;return 0});c="autoAskFreeGift";b="Enable Asking for Free Gifts";var A=makeElement("div",m,{style:"position: absolute; text-align: left; top: 375px; left: 350px;"});makeElement("label",A,{"for":c,title:b}).appendChild(document.createTextNode(b));c="selectAskFreeGift";var B=makeElement("select",m,{id:c,title:b,style:"position: absolute; text-align: left; top: 375px; left: 515px;"});choiceAskFreeGift=document.createElement("option");choiceAskFreeGift.text="don't ask for free gifts";choiceAskFreeGift.value=0;if(GM_getValue("selectAskFreeGift",0)==0)choiceAskFreeGift.selected=true;B.appendChild(choiceAskFreeGift);for(h=0;h<freeGiftList.length;h++){if(freeGiftList[h][0]){choiceAskFreeGift=document.createElement("option");choiceAskFreeGift.text=freeGiftList[h][2].capitalize();choiceAskFreeGift.value=freeGiftList[h][0];if(GM_getValue("selectAskFreeGift",0)==freeGiftList[h][0])choiceAskFreeGift.selected=true;B.appendChild(choiceAskFreeGift)}else continue}return k}}function createFamilyTabNew2012(){function n(a){e=makeElement("div",a);i=makeElement("div",e,{"class":"jqRX6buttonId1"})}function u(){makeElement("br",i,{"class":"hide"});var d=new Array(["bossRole","Boss Role","Boss Role:"],["bossStaminaLimit","Boss Stamina Limit","Boss Stamina Limit:"]);for(idx=0;idx<d.length;idx++){var e=d[idx];makeElement("label",i,{"for":e[0],title:e[1],"class":"jqSpacer"}).appendChild(document.createTextNode(e[2]));var h=makeElement("select",i,{id:e[0],"class":"RX6dropdown2",style:"width:70px"});if(idx==0){iLength=bossRoles.length;for(f=0;f<iLength;++f){g=document.createElement("option");g.value=f;g.appendChild(document.createTextNode(bossRoles[f].capitalize()));h.appendChild(g)}h.selectedIndex=GM_getValue("bossRole",0)}if(idx==1){iLength=bossStaminaLimits.length;for(f=0;f<iLength;++f){g=document.createElement("option");g.value=f;g.appendChild(document.createTextNode(bossStaminaLimits[f]));h.appendChild(g)}h.selectedIndex=GM_getValue("bossStaminaLimit",0)}if(!l){h.disabled=true;h.setAttribute("class","RX6dropdown2lite");h.selectedIndex=bossRoles[0]}}c="bossRageLimit";b="Boss Rage Limit (0 - 1000)";makeElement("label",i,{"for":c,title:b}).appendChild(document.createTextNode("Boss Rage Limit:"));a=makeElement("input",i,{style:"text-align: right;",type:"text",value:GM_getValue(c,"0"),id:c,size:"6",style:"margin-left:5px;"});z(a);makeElement("br",i,{"class":"hide"});return}function v(){n(o);k="Family Battle Settings";if(!l)k+=j;makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:46%"}).appendChild(document.createTextNode(k))}function z(a){if(!l){a.checked=false;a.disabled=true}}var a,b,c,d,e,f,e,g,h,i,j,k,l;var m=makeElement("div",null,{id:"familyTab","class":"tabcontent"});if(GM_getValue("readValueSum",returnValue())==parseXMLResponse())l=true;var o=makeElement("div",m,{"class":"jsRX6Tabs"});e=makeElement("div",o);i=makeElement("div",e,{"class":"jqRX6buttonId1",style:"width:46%;float:left"});makeElement("div",i,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Operations Settings"));var p=new Array(["autoStartMyOps","Enable Personal Operations","Enable Personal Operations","position: absolute; text-align: left; top: 20px; left: 10px;"],["autoStartFamOps","Participate In Family Operations","Participate In Family Operations","position: absolute; text-align: left; top: 20px; left: 200px;"]);for(f=0;f<p.length;f++){var q=p[f];if(f==1)makeElement("br",i,{"class":"hide"});var r=makeElement("div",i,{style:q[3]});makeElement("input",i,{type:"checkbox",id:q[0],value:"checked"},q[0]);makeElement("label",i,{"for":q[0],title:q[1],"class":"jqSpacer"}).appendChild(document.createTextNode(q[2]))}j=" - RX6 PRO FEATURE";i=makeElement("div",e,{"class":"jqRX6buttonId1",style:"width:46%;float:right;padding-bottom:28px"});k="Family Rewards";if(!l)k+=j;makeElement("div",i,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode(k));c="AutoFamilyRewards";b="Enable Auto Family Rewards Collection";a=makeElement("input",i,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",i,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Enable Auto Family Rewards Collect"));z(a);n(o);k="Family Boss Fight Settings";if(!l)k+=j;makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:46%"}).appendChild(document.createTextNode(k));var s=new Array(["autoFamilyBosses","Enable Family Bosses","Enable Family Bosses"],["autoFamilyBossFighting","Enable Family Boss Fighting","Enable Family Boss Fighting"],["sendBossFightBoosts","Send Family Boss Boosts","Send Family Boss Boosts"],["askBossFightBoosts","Ask for Family Boss Boosts","Ask for Family Boss Boosts"],["AutoBattleFight","Enable AutoBattle Fighting","Enable AutoBattle Fighting"],["AutoBattleSafehouse","Enable Battle Safehouse Attacking","Enable Battle Safehouse Attacking"],["AutoBattle","Enable AutoBattle","Enable AutoBattle (Only if Underboss/GF)"]);for(idx=0;idx<s.length;idx++){if(idx==2)u();if(idx==4)v();if(idx==6)makeElement("br",i,{"class":"hide"});var q=s[idx];var t=makeElement("input",i,{type:"checkbox",id:q[0],value:"checked"},q[0]);makeElement("label",i,{"for":q[0],title:q[1],"class":"jqSpacer"}).appendChild(document.createTextNode(q[2]));z(t)}c="AutoBattleClanID";b="ClanID";a=makeElement("input",i,{style:"text-align: right;",type:"text",value:GM_getValue(c,"0"),id:c,size:"6"});makeElement("label",i,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Clan / Family ID"));z(a);makeElement("br",i,{"class":"hide"});c="familyListSingleLink";b="Enter MW Family Link";a=makeElement("input",i,{type:"text",id:c,title:b,style:"text-align: left;width: 250px;margin-left;margin-left:252px;margin-top:3px"});z(a);b="Add Family ID from MW Family Link";c="familySingleAdd";eltA=makeElement("a",i,{id:c,href:"#",alt:b,title:b,"class":"jqSpacer"});eltA.appendChild(document.createTextNode("Add Family ID"));eltA.addEventListener("click",addSingleFamilyID,false);n(o);k="FreeGifts";if(!l)k+=j;makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:46%"}).appendChild(document.createTextNode(k));c="autoFreeGift";b="Enable Auto Free Gifting:";makeElement("label",i,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode(b));c="selectFreeGift";selectFreeGift=makeElement("select",i,{id:c,title:b,"class":"RX6dropdown2",style:"margin-left:24px"});choiceFreeGift=document.createElement("option");choiceFreeGift.text="don't send free gifts";choiceFreeGift.value=0;if(GM_getValue("selectFreeGift",0)==0)choiceFreeGift.selected=true;selectFreeGift.appendChild(choiceFreeGift);freeGiftList.sort(function(a,b){if(a[3]<b[3])return-1;if(a[3]>b[3])return 1;return 0});var w="";for(f=0;f<freeGiftList.length;f++){if(freeGiftList[f][1]){if(w!=freeGiftList[f][3]){choiceGroup=document.createElement("optgroup");choiceGroup.label=freeGiftList[f][3].toUpperCase();selectFreeGift.appendChild(choiceGroup);w=freeGiftList[f][3]}choiceFreeGift=document.createElement("option");choiceFreeGift.text=freeGiftList[f][2].capitalize();choiceFreeGift.value=freeGiftList[f][1];if(GM_getValue("selectFreeGift",0)==freeGiftList[f][1])choiceFreeGift.selected=true;selectFreeGift.appendChild(choiceFreeGift)}}if(!l){selectFreeGift.disabled=true;selectFreeGift.setAttribute("class","RX6dropdown2lite");selectFreeGift.selectedIndex=choiceFreeGift.text}c="autoAskFreeGift";b="Enable Asking for Free Gifts:";var x=makeElement("div",i);makeElement("label",i,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode(b));c="selectAskFreeGift";var y=makeElement("select",i,{id:c,title:b,"class":"RX6dropdown2"});choiceAskFreeGift=document.createElement("option");choiceAskFreeGift.text="don't ask for free gifts";choiceAskFreeGift.value=0;if(GM_getValue("selectAskFreeGift",0)==0)choiceAskFreeGift.selected=true;y.appendChild(choiceAskFreeGift);freeGiftList.sort(function(a,b){if(a[2]<b[2])return-1;if(a[2]>b[2])return 1;return 0});for(f=0;f<freeGiftList.length;f++){if(freeGiftList[f][0]){choiceAskFreeGift=document.createElement("option");choiceAskFreeGift.text=freeGiftList[f][2].capitalize();choiceAskFreeGift.value=freeGiftList[f][0];if(GM_getValue("selectAskFreeGift",0)==freeGiftList[f][0])choiceAskFreeGift.selected=true;y.appendChild(choiceAskFreeGift)}else continue}if(!l){y.disabled=true;y.setAttribute("class","RX6dropdown2lite");y.selectedIndex=choiceAskFreeGift.text}return m}function addSingleFamilyID(){var a;var b=document.getElementById("AutoBattleClanID");var c=decodeURIComponent(document.getElementById("familyListSingleLink").value);if(c.match(/"id":"(.+)"/)){a=decodeID(RegExp.$1).digitize();b.value=a;b.innerHTML=a}else alert("Invalid family link.");document.getElementById("familyListSingleLink").value=""}function createAutostatTab(){var a,b,c,d,e,f,g;var h=makeElement("div",null,{id:"autostatTab","class":"tabcontent"});var i=makeElement("div",h,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});i.appendChild(document.createTextNode("Autostat Settings:"));var j=makeElement("div",h,{style:"position: absolute; width: 100%; left: 25px; top: 40px;"});b="autoStat";a="Check this this to enable auto-statting";var k=makeElement("div",j,{style:"position: absolute; text-align: left; left: 20px;"});makeElement("input",k,{type:"checkbox",id:b,value:"checked"},b);makeElement("img",k,{src:stripURI(plussignIcon)});makeElement("label",k,{"for":b,title:a}).appendChild(document.createTextNode(" Enable auto-stat"));a=" Disable AutoStat when status goals are reached";b="autoStatDisable";var l=makeElement("div",j,{style:"position: absolute; text-align: left; left: 200px; "});makeElement("input",l,{type:"checkbox",id:b,title:a,value:"checked"},b);makeElement("label",l,{"for":b,title:a}).appendChild(document.createTextNode(a));var m=30;var n=10;var o=n+20;var p=m+2;for(d=0,iLength=autoStatRatios.length;d<iLength;++d){g=makeElement("div",j,{style:"position: absolute; top:"+p+"px; left:"+o+"px;"});g.appendChild(document.createTextNode(autoStatDescrips[d+1]));p+=25}o=n+75;p=m;for(d=0,iLength=autoStatRatios.length;d<iLength;++d){a="Please set ratio of "+autoStatDescrips[d+1]+" stat";b=autoStatRatios[d];g=makeElement("div",j,{style:"position: absolute; top:"+p+"px; left:"+o+"px;",title:a});g.appendChild(document.createTextNode(" = "));makeElement("input",g,{type:"text",style:"width: 40px;",value:GM_getValue(b,0),id:b,size:"1"});g.appendChild(document.createTextNode(" x "));p+=25}o=n+150;p=m;for(d=0,iLength=autoStatModes.length;d<iLength;++d){a="Please select where to base "+autoStatDescrips[d+1]+" stat";b=autoStatModes[d];var q=makeElement("select",j,{id:b,title:a,style:"position: absolute; width:60px; top: "+p+"px; left: "+o+"px;"});p+=25;for(e=0,jLength=autoStatDescrips.length;e<jLength;++e){f=document.createElement("option");f.value=e;f.appendChild(document.createTextNode(autoStatDescrips[e]));q.appendChild(f)}q.selectedIndex=GM_getValue(autoStatModes[d],0)}o=n+215;p=m;for(d=0,iLength=autoStatBases.length;d<iLength;++d){a="add these for total ";b=autoStatBases[d];g=makeElement("div",j,{style:"position: absolute; top:"+p+"px; left:"+o+"px;",title:a});g.appendChild(document.createTextNode("+"));makeElement("input",g,{type:"text",style:"width: 40px;",value:GM_getValue(b,0),id:b,size:"1"});p+=25}o=n+280;p=m;for(d=0,iLength=autoStatFallbacks.length;d<iLength;++d){a="Check this to distribute points to "+autoStatDescrips[d+1]+" when goals are reached";b=autoStatFallbacks[d];g=makeElement("div",j,{style:"position: absolute; top: "+p+"px; left:"+o+"px; "});makeElement("input",g,{type:"checkbox",id:b,title:a,value:"checked"},autoStatFallbacks[d]);c=makeElement("label",g,{"for":b,title:a});c.appendChild(document.createTextNode(" "+autoStatDescrips[d+1]+" as fallback"));p+=25}a="Please select priority level for stat distribution";o=n+460;p=m;for(d=0,iLength=autoStatPrios.length;d<iLength;++d){b=autoStatPrios[d];q=makeElement("select",j,{id:b,title:a,style:"position: absolute; top: "+p+"px; left: "+o+"px;"});p+=25;for(e=0,jLength=autoStatRatios.length;e<jLength;++e){f=document.createElement("option");f.value=e;f.appendChild(document.createTextNode("Priority "+(e+1)));q.appendChild(f)}q.selectedIndex=GM_getValue(autoStatPrios[d],0)}if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){return h}else{var j=makeElement("div",h,{"class":"rx6",style:"position: absolute; width: 100%; left: 25px; top: 220px;height:210px;"});var r=makeElement("div",j,{"class":"rx6",style:"position: relative; top: 0px; margin-left: 0px; width: 200px; height:200px;line-height:180%;"});a="Select City Priority";b="selectCityPrio";c=makeElement("label",r,{"for":b,title:a});c.appendChild(document.createTextNode(a));makeElement("br",r,{"class":"hide"});var s=BRAZIL;for(d=1;d<=3;d++){b="selectCityPrio"+d;a="City Priority "+d+": ";c=makeElement("label",r,{"for":b,title:a});c.appendChild(document.createTextNode(a));var t=makeElement("select",r,{id:b,title:a});for(e=BRAZIL;e<=LONDON;e++){choiceSelectCity=makeElement("option",null,{title:cities[e][CITY_NAME]});choiceSelectCity.text=cities[e][CITY_NAME];choiceSelectCity.value=e;if(GM_getValue(b,s)==e)choiceSelectCity.selected=true;t.appendChild(choiceSelectCity)}s++;makeElement("br",r,{"class":"hide"})}var u=makeElement("div",j,{"class":"rx6",style:"position: relative; top: -200px; margin-left: 180px; width: 200px; height:200px;line-height:180%;"});a="Activate Brazil Crew Members";b="selectBrazilCrew";c=makeElement("label",u,{"for":b,title:a});c.appendChild(document.createTextNode(a));makeElement("br",u,{"class":"hide"});for(d=1;d<cityCrewTitles.length;d++){b="selectBrazilCrew"+d;a="Crew Priority "+d+": ";c=makeElement("label",u,{"for":b,title:a,style:"float:left;width:100px;"});c.appendChild(document.createTextNode(a));var v=makeElement("select",u,{id:b,title:a});for(e=0;e<cityCrewTitles.length;e++){choiceBrazilCrew=makeElement("option",null,{title:cityCrewTitles[e][2]});choiceBrazilCrew.text=cityCrewTitles[e][0];choiceBrazilCrew.value=e;if(GM_getValue(b,0)==e)choiceBrazilCrew.selected=true;v.appendChild(choiceBrazilCrew)}makeElement("br",u,{"class":"hide"})}var w=makeElement("div",j,{"class":"rx6",style:"position: relative; top: -400px; margin-left: 405px; width: 200px;height:200px; line-height:180%;"});a="Chicago Crew Members";b="selectChicagoCrew";c=makeElement("label",w,{"for":b,title:a});c.appendChild(document.createTextNode(a));makeElement("br",w,{"class":"hide"});for(d=1;d<cityCrewTitles.length;d++){b="selectChicagoCrew"+d;var x=makeElement("select",w,{id:b,title:a});for(e=0;e<cityCrewTitles.length;e++){choiceChicagoCrew=makeElement("option",null,{title:cityCrewTitles[e][2]});choiceChicagoCrew.text=cityCrewTitles[e][0];choiceChicagoCrew.value=e;if(GM_getValue(b,0)==e)choiceChicagoCrew.selected=true;x.appendChild(choiceChicagoCrew)}makeElement("br",w,{"class":"hide"})}var y=makeElement("div",j,{"class":"rx6",style:"position: relative; top: -600px; margin-left: 560px; width: 200px;height:200px; line-height:180%;"});a="London Crew Members";b="selectLondonCrew";c=makeElement("label",y,{"for":b,title:a});c.appendChild(document.createTextNode(a));makeElement("br",y,{"class":"hide"});for(d=1;d<cityCrewTitles.length;d++){b="selectLondonCrew"+d;var z=makeElement("select",y,{id:b,title:a});for(e=0;e<cityCrewTitles.length;e++){choiceLondonCrew=makeElement("option",null,{title:cityCrewTitles[e][2]});choiceLondonCrew.text=cityCrewTitles[e][0];choiceLondonCrew.value=e;if(GM_getValue(b,0)==e)choiceLondonCrew.selected=true;z.appendChild(choiceLondonCrew)}makeElement("br",y,{"class":"hide"})}return h}}function createAutostatTabNew2012(){function k(a){h=makeElement("div",a);i=makeElement("div",h,{"class":"jqRX6buttonId4"})}var a,b,c,d,e,f,g,h,i;var j=makeElement("div",null,{id:"autostatTab","class":"tabcontent"});var l=makeElement("div",j,{"class":"jsRX6Tabs"});h=makeElement("div",l);if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){var m=true}k(l);makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Enable AutoStat Features"));b="autoStat";a="Check this this to enable auto-statting";makeElement("input",i,{type:"checkbox",id:b,value:"checked"},b);makeElement("img",i,{src:stripURI(plussignIcon)});makeElement("label",i,{"for":b,title:a}).appendChild(document.createTextNode("Enable auto-stat"));a="Disable AutoStat when status goals are reached";b="autoStatDisable";var n=makeElement("div",i,{style:"position: absolute; text-align: left; left: 200px; "});makeElement("input",i,{type:"checkbox",id:b,title:a,value:"checked"},b);makeElement("label",i,{"for":b,title:a}).appendChild(document.createTextNode(a));k(l);for(d=0,iLength=autoStatRatios.length;d<iLength;++d){a="Please set ratio of "+autoStatDescrips[d+1]+" stat";b=autoStatRatios[d];makeElement("div",i,{style:"width:50px;float:left;padding-top:5px"}).appendChild(document.createTextNode(autoStatDescrips[d+1]));i.appendChild(document.createTextNode(" = "));makeElement("input",i,{type:"text",style:"width: 40px;margin-top:3px;",value:GM_getValue(b,0),id:b,size:"1"});i.appendChild(document.createTextNode(" x "));b=autoStatModes[d];var o=makeElement("select",i,{id:b,title:a,"class":"RX6dropdown2",style:"width:75px"});for(e=0,jLength=autoStatDescrips.length;e<jLength;++e){f=document.createElement("option");f.value=e;f.appendChild(document.createTextNode(autoStatDescrips[e]));o.appendChild(f)}o.selectedIndex=GM_getValue(autoStatModes[d],0);a="add these for total ";b=autoStatBases[d];i.appendChild(document.createTextNode("+"));makeElement("input",i,{type:"text",style:"width: 40px;",value:GM_getValue(b,0),id:b,size:"1"});a="Check this to distribute points to "+autoStatDescrips[d+1]+" when goals are reached";b=autoStatFallbacks[d];makeElement("input",i,{type:"checkbox",id:b,title:a},autoStatFallbacks[d]);c=makeElement("label",i,{"for":b,title:a,style:"display:inline-block;width:115px;margin-left:10px"});c.appendChild(document.createTextNode(" "+autoStatDescrips[d+1]+" as fallback"));a="Please select priority level for stat distribution";b=autoStatPrios[d];o=makeElement("select",i,{id:b,title:a,"class":"RX6dropdown2",style:"width:75px;"});for(e=0,jLength=autoStatRatios.length;e<jLength;++e){f=document.createElement("option");f.value=e;f.appendChild(document.createTextNode("Priority "+(e+1)));o.appendChild(f)}o.selectedIndex=GM_getValue(autoStatPrios[d],0);makeElement("br",i,{"class":"hide"})}k(l);if(m){makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Activate Crew Members in your choosen Cities"))}else{makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:50%"}).appendChild(document.createTextNode("Activate Crew Members in your choosen Cities : RX6 PRO FEATURE"))}var p=makeElement("div",i,{style:"float:left;width:165px"});a="Select City Priority";b="selectCityPrio";c=makeElement("div",p,{"for":b,title:a,style:"color: #3A8AC0"});c.appendChild(document.createTextNode(a));makeElement("br",p,{"class":"hide"});var q=BRAZIL;for(d=1;d<=3;d++){b="selectCityPrio"+d;a="City Priority "+d+": ";c=makeElement("label",p,{"for":b,title:a});c.appendChild(document.createTextNode(a));var r=makeElement("select",p,{id:b,title:a,"class":"RX6dropdown2",style:"width:75px;margin-right:10px"});for(e=BRAZIL;e<=LONDON;e++){choiceSelectCity=makeElement("option",null,{title:cities[e][CITY_NAME]});choiceSelectCity.text=cities[e][CITY_NAME];choiceSelectCity.value=e;if(GM_getValue(b,q)==e)choiceSelectCity.selected=true;r.appendChild(choiceSelectCity)}q++;makeElement("br",p,{"class":"hide"});if(!m){r.disabled=true;r.setAttribute("class","RX6dropdown2lite")}}var s=makeElement("div",i,{style:"float:left;width:180px"});a="Brazil Crew";b="selectBrazilCrew";c=makeElement("div",s,{"for":b,title:a,style:"color: #3A8AC0"});c.appendChild(document.createTextNode(a));makeElement("br",s,{"class":"hide"});for(d=1;d<cityCrewTitles.length;d++){b="selectBrazilCrew"+d;a="Crew Priority "+d+": ";c=makeElement("label",s,{"for":b,title:a,style:"float:left;width:90px;margin-top:5px"});c.appendChild(document.createTextNode(a));var t=makeElement("select",s,{id:b,title:a,"class":"RX6dropdown2",style:"width:75px;"});for(e=0;e<cityCrewTitles.length;e++){choiceBrazilCrew=makeElement("option",null,{title:cityCrewTitles[e][2]});choiceBrazilCrew.text=cityCrewTitles[e][0];choiceBrazilCrew.value=e;if(GM_getValue(b,0)==e)choiceBrazilCrew.selected=true;if(!m)choiceBrazilCrew.text=cityCrewTitles[0][0];t.appendChild(choiceBrazilCrew)}makeElement("br",s,{"class":"hide"});if(!m){t.disabled=true;t.setAttribute("class","RX6dropdown2lite")}}var u=makeElement("div",i,{style:"float:left",style:"float:left;width:89px;"});a="Chicago Crew";b="selectChicagoCrew";c=makeElement("div",u,{"for":b,title:a,style:"color: #3A8AC0"});c.appendChild(document.createTextNode(a));makeElement("br",u,{"class":"hide"});for(d=1;d<cityCrewTitles.length;d++){b="selectChicagoCrew"+d;var v=makeElement("select",u,{id:b,title:a,"class":"RX6dropdown2",style:"width:75px"});for(e=0;e<cityCrewTitles.length;e++){choiceChicagoCrew=makeElement("option",null,{title:cityCrewTitles[e][2]});choiceChicagoCrew.text=cityCrewTitles[e][0];choiceChicagoCrew.value=e;if(GM_getValue(b,0)==e)choiceChicagoCrew.selected=true;if(!m)choiceChicagoCrew.text=cityCrewTitles[0][0];v.appendChild(choiceChicagoCrew)}makeElement("br",u,{"class":"hide"});if(!m){v.disabled=true;v.setAttribute("class","RX6dropdown2lite")}}var w=makeElement("div",i,{style:"float:left",style:"float:left;width:89px;"});a="London Crew";b="selectLondonCrew";c=makeElement("div",w,{"for":b,title:a,style:"color: #3A8AC0"});c.appendChild(document.createTextNode(a));makeElement("br",w,{"class":"hide"});for(d=1;d<cityCrewTitles.length;d++){b="selectLondonCrew"+d;var x=makeElement("select",w,{id:b,title:a,"class":"RX6dropdown2",style:"width:75px"});for(e=0;e<cityCrewTitles.length;e++){choiceLondonCrew=makeElement("option",null,{title:cityCrewTitles[e][2]});choiceLondonCrew.text=cityCrewTitles[e][0];choiceLondonCrew.value=e;if(GM_getValue(b,0)==e)choiceLondonCrew.selected=true;if(!m)choiceLondonCrew.text=cityCrewTitles[0][0];x.appendChild(choiceLondonCrew)}makeElement("br",w,{"class":"hide"});if(!m){x.disabled=true;x.setAttribute("class","RX6dropdown2lite")}}return j}function createEnergyTab(){function i(a){e=makeElement("div",a);g=makeElement("div",e,{"class":"lhs"});f=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"})}var a,b,c,d,e,f,g,h;var j=makeElement("div",null,{id:"energyTab","class":"tabcontent"});var k=makeElement("div",j,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});k.appendChild(document.createTextNode("Energy Settings:"));var l=makeElement("div",j,{style:"position: relative; top: 0px; margin-left: auto; margin-right: auto; width: 95%; line-height:120%;"});i(l);b="Spend energy automatically.";c="autoMission";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},"autoMission");d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" Spend energy to perform any combination of jobs"));makeElement("br",f,{"class":"hide"});c="endLevelOptimize";b="Optimize at end level";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" "+b+" "));c="endLevelNYOnly";b="use NY jobs only";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" "+b));i(l);c="autoWithDraw";b="Force Auto Withdraw for Jobs";makeElement("input",f,{type:"checkbox",id:c,title:b},c);d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" "+b));i(l);var m=makeElement("input",g,{id:"unCheckAll",style:"font-size: 10px;padding:2px;",type:"button",value:"Uncheck All"});c="MissionArray";var n=makeElement("div",f,{id:c,title:"Missions Array",style:"overflow: auto; width: 300px; height: 150px; border:1px solid #999999; padding: 2px 2px 2px 2px"});i(l);b="Master Tier";c="selectTier";d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode("Master tier:"));var o=makeElement("select",f,{id:c,title:b});choiceTier=document.createElement("option");choiceTier.text="Do not master anything";choiceTier.value="0.0";o.appendChild(choiceTier);var p=-1;var q=-1;var r,s,t;var u=function(){var a=this.getAttribute("chkId");var b=document.getElementById(a);var c=document.getElementById("img"+a);if(b){if(b.checked){b.checked=false;c.src=stripURI(unCheckedIcon)}else{b.checked="checked";c.src=stripURI(checkedIcon)}}};var v=getSavedList("selectMissionMultiple");for(var w=0,x=missions.length;w<x;++w){var y=missions[w];if(y[MISSION_CITY]!=p){p=y[MISSION_CITY];s=makeElement("div");s.innerHTML="=== "+cities[p][CITY_NAME].toUpperCase()+" MISSIONS ===";s.className="ap_optgroup1";n.appendChild(s);choiceTier=document.createElement("optgroup");choiceTier.label=cities[p][CITY_NAME].toUpperCase();choiceTier.className="ap_optgroup1";o.appendChild(choiceTier)}if(y[MISSION_TAB]!=q){q=y[MISSION_TAB];s=makeElement("div");s.innerHTML=missionTabs[p][q-1];s.className="ap_optgroup2";n.appendChild(s);choiceTier=document.createElement("option");choiceTier.text=missionTabs[p][q-1];choiceTier.value=p+"."+q;o.appendChild(choiceTier);if(GM_getValue("selectTier","0.0")==choiceTier.value){choiceTier.selected=true}}var z=isNaN(y[MISSION_RATIO])||!y[MISSION_RATIO]?calcJobratio(w):y[MISSION_RATIO];c=missions[w][MISSION_NAME];b=y[MISSION_NAME]+" ("+parseFloat(z)+")";var A=false;if(v.indexOf(String(w))!=-1){A=true}if(y[MISSION_TABPATH]==0||y[MISSION_TABPATH]>100)r=makeElement("div",null,{"class":"ap_option",chkid:c});else r=makeElement("div",null,{"class":"ap_option",chkid:c,style:"color: red"});r.addEventListener("click",u,false);makeElement("img",r,{style:"width: 15px; height: 15px;",id:"img"+c,src:A?stripURI(checkedIcon):stripURI(unCheckedIcon)});s=makeElement("input",r,{type:"checkbox",id:c,title:b,style:"display: none",value:"checked"});s.checked=A;r.appendChild(document.createTextNode(" "+b));n.appendChild(r)}var B=function(){var a;var b;var c;for(var d=0,e=missions.length;d<e;++d){c=missions[d][MISSION_NAME];a=document.getElementById(c);b=document.getElementById("img"+c);if(b&&a.checked)b.src=stripURI(unCheckedIcon);if(a&&a.checked)a.checked=false}alert("All Jobs Removed from Selection")};m.addEventListener("click",B,false);makeElement("br",f,{"class":"hide"});c="skipfight";b="Check this to skip Fighting Style Jobs In Tier Mastery.";makeElement("input",f,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",f,{"for":c}).appendChild(document.createTextNode(" Skip Fighting In Job Tier Mastery "));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){i(l);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" enable Boss Fight:"));b="Boss Fight - Confront Agostino Cleto";c="autoFightAgostino";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},"autoFightAgostino");d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" Confront Agostino Cleto "));i(l);d=makeElement("label",g,{"for":c,title:b});d.appendChild(document.createTextNode(" Spend buff packs:"))}b="Periodically check for mini buffs.";c="checkMiniPack";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},"checkMiniPack");d=makeElement("label",f,{"for":c,title:b});d.appendChild(document.createTextNode(" Mini packs"));makeElement("br",f);b="Spend energy packs if it will not waste energy, as determined by the estimated job ratio setting and your stamina statistics.";c="autoEnergyPack";makeElement("input",f,{type:"checkbox",id:c,title:b,value:"checked"},"autoEnergyPack");makeElement("label",f,{"for":c,title:b}).appendChild(document.createTextNode(" Energy packs "));makeElement("br",f);b="Estimate the average experience-to-energy ratio of the jobs you will be performing. For example, a job that paid 10 experience points and required 5 energy would have a ratio of 2. Enter 0 if you prefer to have energy packs fire regardless of waste.";c="estimateJobRatio";makeElement("label",f,{title:b}).appendChild(document.createTextNode(" (Estimated Job Ratio: "));makeElement("input",f,{id:c,type:"text",value:GM_getValue("estimateJobRatio","2"),size:"2"});b="Maximum Amount of energy remaining to trigger the firing of the energy pack.";c="autoEnergyPackForcePts";makeElement("label",f,{title:b}).appendChild(document.createTextNode(" Force Energy Pack when energy falls below "));makeElement("input",f,{id:c,type:"text",value:GM_getValue("autoEnergyPackForcePts","0"),size:"2"});makeElement("label",f,{title:b}).appendChild(document.createTextNode(" points)"));e=makeElement("div",l,{"class":"single"});e=makeElement("div",l,{"class":"single"});b="Start spending energy For Jobs when energy level is reached";c="selectEnergyUse";e.appendChild(document.createTextNode("Start spending energy for jobs when "));makeElement("input",e,{type:"text",id:c,title:b,style:"width: 2em; ",value:GM_getValue(c,"0")});c="selectEnergyUseMode";e.appendChild(document.createTextNode(" "));a=makeElement("select",e,{id:c,title:b});for(w=0,x=numberSchemes.length;w<x;++w){h=document.createElement("option");h.value=w;h.appendChild(document.createTextNode(numberSchemes[w]));a.appendChild(h)}a.selectedIndex=GM_getValue(c,0);e.appendChild(document.createTextNode(" of energy has accumulated."));e=makeElement("div",l,{"class":"single"});b="Suspend automatic Job play below this level of energy.";b+="  NOTE: Mission & Job LOWER limits are completely INDEPENDENT Of Each Other.";c="selectEnergyKeep";e.appendChild(document.createTextNode("While Energy Is Below "));makeElement("input",e,{type:"text",id:c,title:b,style:"width: 2em; ",value:GM_getValue(c,"0")});c="selectEnergyKeepMode";e.appendChild(document.createTextNode(" "));a=makeElement("select",e,{id:c,title:b});for(w=0,x=numberSchemes.length;w<x;++w){h=document.createElement("option");h.value=w;h.appendChild(document.createTextNode(numberSchemes[w]));a.appendChild(h)}a.selectedIndex=GM_getValue(c,0);e.appendChild(document.createTextNode(" Suspend Energy Spending For Above Jobs."));e=makeElement("div",l,{"class":"single"});e=makeElement("div",l,{"class":"single"});b="Suspend automatic operations below this level of energy.";b+="  NOTE: Operations & Job LOWER limits are completely INDEPENDENT Of Each Other.";c="selectMissionEnergyKeep";e.appendChild(document.createTextNode("While Energy Is Below "));makeElement("input",e,{type:"text",id:c,title:b,style:"width: 2em; ",value:GM_getValue(c,"0")});c="selectMissionEnergyKeepMode";e.appendChild(document.createTextNode(" "));a=makeElement("select",e,{id:c,title:b});for(w=0,x=numberSchemes.length;w<x;++w){h=document.createElement("option");h.value=w;h.appendChild(document.createTextNode(numberSchemes[w]));a.appendChild(h)}a.selectedIndex=GM_getValue(c,0);e.appendChild(document.createTextNode(" Suspend Energy Spending For Operations."));e=makeElement("div",l,{"class":"single"});b="Ignore minimum energy settings if a level up is within reach.";c="allowEnergyToLevelUp";makeElement("input",e,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",e,{"for":c,title:b});d.appendChild(document.createTextNode(" Don't reserve energy if within reach of the next level."));return j}function createEnergyTabNew2012(){function i(a){e=makeElement("div",a);jqRX6buttonId1=makeElement("div",e,{"class":"jqRX6buttonId1"})}var a,b,c,d,e,f,g,h;var j=makeElement("div",null,{id:"energyTab","class":"tabcontent"});var k=makeElement("div",j,{"class":"jsRX6Tabs"});i(k);makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("How would you like to spend your Energy?"));b="Spend energy automatically.";c="autoMission";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},"autoMission");d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Spend energy to perform any combination of jobs"));makeElement("br",jqRX6buttonId1,{"class":"hide"});c="endLevelOptimize";b="Optimize at end level";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode(" "+b+" "));c="endLevelNYOnly";b="Use NY jobs only";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode(" "+b));c="autoWithDraw";b="Force Auto Withdraw for Jobs";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b},c);d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode(" "+b));c="allowEnergyToLevelUp";b="Ignore minimum energy settings if a level up is within reach.";e=makeElement("div",jqRX6buttonId1);makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},c);d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode(" Don't reserve energy if within reach of the next level."));makeElement("br",jqRX6buttonId1,{"class":"hide"});var l=makeElement("input",jqRX6buttonId1,{id:"unCheckAll",style:"font-size: 10px;padding:2px;",type:"button",value:"Uncheck All"});c="MissionArray";var m=makeElement("div",jqRX6buttonId1,{id:c,title:"Missions Array",style:"overflow: auto; width: 330px; height: 150px; border:1px solid #999999; padding: 2px; margin-right:5px"});makeElement("br",jqRX6buttonId1,{"class":"hide"});b="Master Tier";c="selectTier";d=makeElement("label",jqRX6buttonId1,{"for":c,title:b});d.appendChild(document.createTextNode("Master tier: "));var n=makeElement("select",jqRX6buttonId1,{id:c,title:b,"class":"RX6dropdown2"});choiceTier=document.createElement("option");choiceTier.text="Do not master anything";choiceTier.value="0.0";n.appendChild(choiceTier);var o=-1;var p=-1;var q,r,s;var t=function(){var a=this.getAttribute("chkId");var b=document.getElementById(a);var c=document.getElementById("img"+a);if(b){if(b.checked){b.checked=false;c.src=stripURI(unCheckedIcon)}else{b.checked="checked";c.src=stripURI(checkedIcon)}}};var u=getSavedList("selectMissionMultiple");for(var v=0,w=missions.length;v<w;++v){var x=missions[v];if(x[MISSION_CITY]!=o){o=x[MISSION_CITY];r=makeElement("div");r.innerHTML="=== "+cities[o][CITY_NAME].toUpperCase()+" MISSIONS ===";r.className="ap_optgroup1";m.appendChild(r);choiceTier=document.createElement("optgroup");choiceTier.label=cities[o][CITY_NAME].toUpperCase();choiceTier.className="ap_optgroup1";n.appendChild(choiceTier)}if(x[MISSION_TAB]!=p){p=x[MISSION_TAB];r=makeElement("div");r.innerHTML=missionTabs[o][p-1];r.className="ap_optgroup2";m.appendChild(r);choiceTier=document.createElement("option");choiceTier.text=missionTabs[o][p-1];choiceTier.value=o+"."+p;n.appendChild(choiceTier);if(GM_getValue("selectTier","0.0")==choiceTier.value){choiceTier.selected=true}}var y=isNaN(x[MISSION_RATIO])||!x[MISSION_RATIO]?calcJobratio(v):x[MISSION_RATIO];c=missions[v][MISSION_NAME];b=x[MISSION_NAME]+" ("+parseFloat(y)+")";var z=false;if(u.indexOf(String(v))!=-1){z=true}if(x[MISSION_TABPATH]==0||x[MISSION_TABPATH]>100)q=makeElement("div",null,{"class":"ap_option",chkid:c});else q=makeElement("div",null,{"class":"ap_option",chkid:c,style:"color: red"});q.addEventListener("click",t,false);makeElement("img",q,{style:"width: 15px; height: 15px;",id:"img"+c,src:z?stripURI(checkedIcon):stripURI(unCheckedIcon)});r=makeElement("input",q,{type:"checkbox",id:c,title:b,style:"display: none",value:"checked"});r.checked=z;q.appendChild(document.createTextNode(" "+b));m.appendChild(q)}var A=function(){var a;var b;var c;for(var d=0,e=missions.length;d<e;++d){c=missions[d][MISSION_NAME];a=document.getElementById(c);b=document.getElementById("img"+c);if(b&&a.checked)b.src=stripURI(unCheckedIcon);if(a&&a.checked)a.checked=false}alert("All Jobs Removed from Selection")};l.addEventListener("click",A,false);c="skipfight";b="Check this to skip Fighting Style Jobs In Tier Mastery.";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",jqRX6buttonId1,{"for":c,"class":"jqSpacer"}).appendChild(document.createTextNode("Skip Fighting In Job Tier Mastery"));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){makeElement("br",jqRX6buttonId1,{"class":"hide"});b="Boss Fight - Confront Agostino Cleto";c="autoFightAgostino";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},"autoFightAgostino");d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Boss Fight: Confront Agostino Cleto"))}i(k);makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Would you like RX6 to use Energy Packs?"));b="Periodically check for mini buffs.";c="checkMiniPack";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},"checkMiniPack");d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Mini packs"));makeElement("br",jqRX6buttonId1);b="Spend energy packs if it will not waste energy, as determined by the estimated job ratio setting and your stamina statistics.";c="autoEnergyPack";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,title:b,value:"checked"},"autoEnergyPack");d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Energy Packs"));makeElement("br",jqRX6buttonId1);d=makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"});b="Estimate the average experience-to-energy ratio of the jobs you will be performing. For example, a job that paid 10 experience points and required 5 energy would have a ratio of 2. Enter 0 if you prefer to have energy packs fire regardless of waste.";c="estimateJobRatio";d.appendChild(document.createTextNode("Estimated Job Ratio:"));makeElement("input",jqRX6buttonId1,{type:"text",id:c,title:b,style:"width:3em;margin-right:8px",value:GM_getValue("estimateJobRatio","2")});b="Maximum Amount of energy remaining to trigger the firing of the energy pack.";c="autoEnergyPackForcePts";jqRX6buttonId1.appendChild(document.createTextNode(" Force Energy when energy  falls below "));makeElement("input",jqRX6buttonId1,{type:"text","class":"jqSpacer",id:c,title:b,style:"width:3em;",value:GM_getValue("autoEnergyPackForcePts","0")});jqRX6buttonId1.appendChild(document.createTextNode(" points "));i(k);makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Customise when Energy should be used"));e=makeElement("div",jqRX6buttonId1);b="Start spending energy For Jobs when energy level is reached";c="selectEnergyUse";e.appendChild(document.createTextNode("Start spending energy for jobs when "));makeElement("input",e,{type:"text",id:c,title:b,style:"width: 2em; ",value:GM_getValue(c,"0")});c="selectEnergyUseMode";e.appendChild(document.createTextNode(" "));a=makeElement("select",e,{id:c,title:b,"class":"RX6dropdown2",style:"width:75px"});for(v=0,w=numberSchemes.length;v<w;++v){h=document.createElement("option");h.value=v;h.appendChild(document.createTextNode(numberSchemes[v]));a.appendChild(h)}a.selectedIndex=GM_getValue(c,0);e.appendChild(document.createTextNode("of energy has accumulated."));e=makeElement("div",jqRX6buttonId1,{style:"margin-left:82px;margin-top:2px"});b="Suspend automatic Job play below this level of energy.";b+="  NOTE: Mission & Job LOWER limits are completely INDEPENDENT Of Each Other.";c="selectEnergyKeep";e.appendChild(document.createTextNode("While Energy Is Below "));makeElement("input",e,{type:"text",id:c,title:b,style:"width: 2em; ",value:GM_getValue(c,"0")});c="selectEnergyKeepMode";e.appendChild(document.createTextNode(" "));a=makeElement("select",e,{id:c,title:b,"class":"RX6dropdown2",style:"width:75px"});for(v=0,w=numberSchemes.length;v<w;++v){h=document.createElement("option");h.value=v;h.appendChild(document.createTextNode(numberSchemes[v]));a.appendChild(h)}a.selectedIndex=GM_getValue(c,0);e.appendChild(document.createTextNode("suspend Energy Spending for above Jobs."));e=makeElement("div",k,{"class":"single"});e=makeElement("div",jqRX6buttonId1,{style:"margin-left:82px;margin-top:2px"});b="Suspend automatic operations below this level of energy.";b+="  NOTE: Operations & Job LOWER limits are completely INDEPENDENT Of Each Other.";c="selectMissionEnergyKeep";e.appendChild(document.createTextNode("While Energy Is Below "));makeElement("input",e,{type:"text",id:c,title:b,style:"width: 2em; ",value:GM_getValue(c,"0")});c="selectMissionEnergyKeepMode";e.appendChild(document.createTextNode(" "));a=makeElement("select",e,{id:c,title:b,"class":"RX6dropdown2",style:"width:75px"});for(v=0,w=numberSchemes.length;v<w;++v){h=document.createElement("option");h.value=v;h.appendChild(document.createTextNode(numberSchemes[v]));a.appendChild(h)}a.selectedIndex=GM_getValue(c,0);e.appendChild(document.createTextNode("suspend Energy Spending for Operations."));return j}function tabContainerDivs(a){item=makeElement("div",a);lhs=makeElement("div",item,{"class":"lhs"});rhs=makeElement("div",item,{"class":"rhs"});makeElement("br",item,{"class":"hide"})}function tabContainerDivsNew2012(a){item=makeElement("div",a);jqRX6buttonId1=makeElement("div",item,{"class":"jqRX6buttonId1"})}function clearStronger(){fightListAvoid.set([]);hitmanListAvoid.set([]);alert("Stronger Opponents Lists cleared")}function removeStrongerOpponents(a){tabContainerDivs(a);title="Remove stronger opponents from the list automatically.";id="fightRemoveStronger";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"vertical-align:middle",value:"checked"},"fightRemoveStronger","checked");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Remove stronger opponents "));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){title="Clear Stronger Opponents List";id="clearRemoveStronger";eltA=makeElement("a",rhs,{id:id,href:"#",alt:title,title:title,style:"float:right;margin:2px 0px 0px 10px;"});eltA.appendChild(document.createTextNode("Clear 'Stronger Opponents' Lists"));eltA.addEventListener("click",clearStronger,false);makeElement("br",rhs);title="Revert to Fightlist if no Rivals.";id="fightFallback";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"vertical-align:middle",value:"checked"},"fightFallback","checked");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Revert to Fightlist if no Rivals"));var b=["don't use fight boosts","Family Battle Only","Always"];makeElement("br",rhs);rhs.appendChild(document.createTextNode("use Fight Boosts : "));id="useFightBoosts";title="use FightBoosts";var c=makeElement("select",rhs,{id:id,title:title});for(i=0,iLength=b.length;i<iLength;i++){var d=document.createElement("option");d.text=b[i];d.value=i;if(GM_getValue("useFightBoosts",0)==i)d.selected=true;c.appendChild(d)}}}function removeStrongerOpponentsNew2012(a){tabContainerDivs(a);title="Remove stronger opponents from the list automatically.";id="fightRemoveStronger";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"vertical-align:middle",value:"checked"},"fightRemoveStronger","checked");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Remove stronger opponents "));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){title="Clear Stronger Opponents List";id="clearRemoveStronger";eltA=makeElement("a",jqRX6buttonId1,{id:id,href:"#",alt:title,title:title,style:"margin:2px 0px 0px 20px;padding:5px;","class":"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only",type:"button",role:"button"});eltA.appendChild(document.createTextNode("Clear 'Stronger Opponents' Lists"));eltA.addEventListener("click",clearStronger,false);makeElement("br",jqRX6buttonId1);title="Revert to Fightlist if no Rivals.";id="fightFallback";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"vertical-align:middle",value:"checked"},"fightFallback","checked");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Revert to Fightlist if no Rivals"));makeElement("br",jqRX6buttonId1);jqRX6buttonId1.appendChild(document.createTextNode("use Fight Boosts : "));var b=["don't use fight boosts","Family Battle Only","Always"];id="useFightBoosts";title="use FightBoosts";var c=makeElement("select",jqRX6buttonId1,{id:id,title:title});for(i=0,iLength=b.length;i<iLength;i++){var d=document.createElement("option");d.text=b[i];d.value=i;if(GM_getValue("useFightBoosts",0)==b[i])d.selected=true;c.appendChild(d)}}}function createStaminaSubTab_FightRandom(a){tabContainerDivs(a);makeElement("label",lhs).appendChild(document.createTextNode("Fight in: "));id="fightRandomLoc";var b=makeElement("select",lhs,{id:id});for(i=0,iLength=fightLocations.length;i<iLength;++i){f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(fightLocations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])f.style.display="none";b.appendChild(f)}b.selectedIndex=GM_getValue("fightLocation",NY);rhs.appendChild(document.createTextNode(" while gaining: "));title="Reattack if this amount is gained";id="reattackThreshold";makeElement("input",rhs,{type:"text",id:id,title:title,maxlength:6,style:"width: 45px; border: 1px solid #781351;",value:GM_getValue(id,"10000"),size:"1"});label=makeElement("label",rhs,{"for":id,title:title,style:"margin-left: 0.5em;"});title="Attack ONLY live targets";id="iceCheck";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"iceCheck");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Skip iced targets"));title="Power Attack";id="staminaPowerattack";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},id);label=makeElement("label",rhs,{"for":id,title:title,style:"margin-left: 0.5em;"});label.appendChild(document.createTextNode("Powerattack"));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){tabContainerDivs(a);makeElement("label",lhs,{"for":id,title:title}).appendChild(document.createTextNode(" Back Ground Speed: "));var c=makeElement("select",rhs,{id:"fastBGFSpeed"});iLength=mwapSpeedModes.length;for(i=0;i<iLength;++i){f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(mwapSpeedModes[i]));c.appendChild(f)}c.selectedIndex=GM_getValue("fastBGFSpeed",0);makeElement("label",rhs,{"for":id,title:title}).appendChild(document.createTextNode(" *is ignored in normal fight mode "))}tabContainerDivs(a);makeElement("label",lhs).appendChild(document.createTextNode("Fight (Rivals) Mode: "));id="fightRivalsMode";var d=makeElement("select",rhs,{id:id});for(i=0,iLength=fightRivalsModes.length;i<iLength;++i){f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(fightRivalsModes[i]));d.appendChild(f)}d.selectedIndex=GM_getValue("fightRivalsMode",0);removeStrongerOpponents(a);tabContainerDivs(a);title="Avoid opponents higher than this level.";id="fightLevelMax";label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum level:"));makeElement("input",rhs,{type:"text",id:id,title:title,maxlength:5,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightLevelMax","100"),size:"1"});title="Make the maximum level be relative to your own. For example, if your level is 10, and maximum level is set to 5, opponents higher than level 15 will be avoided.";id="fightLevelMaxRelative";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"fightLevelMaxRelative");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Add my level"));tabContainerDivs(a);makeElement("label",lhs).appendChild(document.createTextNode("Fight Label Criteria: "));id="fightLabelCriteria";var e=makeElement("select",rhs,{id:id});for(i=0,iLength=fightLabels.length;i<iLength;++i){var f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(fightLabels[i][0]));e.appendChild(f)}e.selectedIndex=GM_getValue("fightLabelCriteria",0);if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){tabContainerDivs(a);title="Avoid opponents with higher health than this setting - Set 0 for unlimited";id="fightHealthMax";label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum Health / "));makeElement("input",rhs,{type:"text",id:id,title:title,maxlength:5,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightHealthMax","0"),size:"1"});title="Avoid opponents with higher health pct left than this setting - Set 0 for unlimited";id="fightHealthPctMax";label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Maximum Health Pct:"));makeElement("input",rhs,{type:"text",id:id,title:title,maxlength:5,style:"margin-left:5px;width: 30px; border: 1px solid #781351;",value:GM_getValue("fightHealthPctMax","0"),size:"1"});tabContainerDivs(a);title="Maximum number of Attacks per Opponenent - Set 0 for unlimited";id="fightMaxAttacks";label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum # Attacks:"));makeElement("input",rhs,{type:"text",id:id,title:title,maxlength:3,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightMaxAttacks","100"),size:"1"})}tabContainerDivs(a);id="fightMafiaMax";title="Avoid opponents with mafia sizes larger than this.",label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum mafia:"));makeElement("input",rhs,{type:"text",id:id,title:title,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightMafiaMax","501"),size:"1"});title="Make the maximum mafia size be relative to your own. For example, if you have 300 mafia members, and maximum mafia is set to 50, opponents with more than 350 mafia members will be avoided.";id="fightMafiaMaxRelative";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"fightMafiaMaxRelative");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Relative  |  Minimum Mafia: "));id="fightMafiaMin";title="Avoid opponents with mafia sizes smaller than this.",label=makeElement("label",lhs,{"for":id,title:title});makeElement("input",rhs,{type:"text",id:id,title:title,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightMafiaMin","1"),size:"1"});title="Make the minimum mafia size be relative to your own. For example, if you have 300 mafia members, and minimum mafia is set to 50, opponents with less than 250 mafia members will be avoided.";id="fightMafiaMinRelative";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"fightMafiaMinRelative");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Relative"));tabContainerDivs(a);title="Fight higher levels if the mafia is smaller.  You mob them, overwhelm the smaller numbers";id="fightMobMode";makeElement("input",rhs,{type:"checkbox",id:id,title:title,value:"checked"},"fightMobMode");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Mob Fight  "));title="Fight Ice Stealers";id="fightIceStealers";makeElement("input",rhs,{type:"checkbox",id:id,title:title,value:"checked"},"fightIceStealers");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Attack Ice Stealers "));tabContainerDivs(a);title=" Use Mafia Family Patterns when fighting";id="fightNames";var g=makeElement("input",lhs,{type:"checkbox",id:id,value:"checked"},id);makeElement("label",lhs,{"for":id}).appendChild(document.createTextNode(" Use Patterns when fighting:"));g.addEventListener("click",clickUseFightNames,false);makeElement("br",lhs);id="fightAvoidNames";title=" Avoid mafia families";makeElement("input",lhs,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",lhs,{"for":id}).appendChild(document.createTextNode(title));makeElement("br",lhs);id="fightOnlyNames";title=" Only Fight Mafia Families ";makeElement("input",lhs,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",lhs,{"for":id}).appendChild(document.createTextNode(title));makeElement("textarea",rhs,{style:"position: static; width: 15em; height: 6em;",id:"fightClanName",title:"Enter each pattern (such as a clan name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("fightClanName",defaultClans.join("\n"))));makeElement("br",rhs);makeElement("font",rhs,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each name pattern on a separate line."))}function createStaminaSubTab_FightRandomNew2012(a){tabContainerDivsNew2012(a);makeElement("label",jqRX6buttonId1).appendChild(document.createTextNode("Fight in: "));id="fightRandomLoc";var b=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=fightLocations.length;i<iLength;++i){f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(fightLocations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])f.style.display="none";b.appendChild(f)}b.selectedIndex=GM_getValue("fightLocation",NY);jqRX6buttonId1.appendChild(document.createTextNode(" while gaining: "));title="Reattack if this amount is gained";id="reattackThreshold";makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,maxlength:6,style:"width: 45px; border: 1px solid #781351;",value:GM_getValue(id,"10000"),size:"1"});label=makeElement("label",jqRX6buttonId1,{"for":id,title:title,style:"margin-left: 0.5em;"});title="Attack ONLY live targets";id="iceCheck";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"iceCheck");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Skip iced targets"));title="Power Attack";id="staminaPowerattack";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},id);label=makeElement("label",jqRX6buttonId1,{"for":id,title:title,style:"margin-left: 0.5em;"});label.appendChild(document.createTextNode("Powerattack"));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){tabContainerDivsNew2012(a);makeElement("label",jqRX6buttonId1,{"for":id,title:title}).appendChild(document.createTextNode(" Back Ground Speed: "));var c=makeElement("select",jqRX6buttonId1,{id:"fastBGFSpeed"});iLength=mwapSpeedModes.length;for(i=0;i<iLength;++i){f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(mwapSpeedModes[i]));c.appendChild(f)}c.selectedIndex=GM_getValue("fastBGFSpeed",0);makeElement("label",jqRX6buttonId1,{"for":id,title:title}).appendChild(document.createTextNode(" *is ignored in normal fight mode "))}tabContainerDivsNew2012(a);makeElement("label",jqRX6buttonId1).appendChild(document.createTextNode("Fight (Rivals) Mode: "));id="fightRivalsMode";var d=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=fightRivalsModes.length;i<iLength;++i){f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(fightRivalsModes[i]));d.appendChild(f)}d.selectedIndex=GM_getValue("fightRivalsMode",0);removeStrongerOpponentsNew2012(a);tabContainerDivsNew2012(a);title="Avoid opponents higher than this level.";id="fightLevelMax";label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum level:"));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,maxlength:5,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightLevelMax","100"),size:"1"});title="Make the maximum level be relative to your own. For example, if your level is 10, and maximum level is set to 5, opponents higher than level 15 will be avoided.";id="fightLevelMaxRelative";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"fightLevelMaxRelative");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Add my level"));tabContainerDivsNew2012(a);makeElement("label",jqRX6buttonId1).appendChild(document.createTextNode("Fight Label Criteria: "));id="fightLabelCriteria";var e=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=fightLabels.length;i<iLength;++i){var f=document.createElement("option");f.value=i;f.appendChild(document.createTextNode(fightLabels[i][0]));e.appendChild(f)}e.selectedIndex=GM_getValue("fightLabelCriteria",0);if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){tabContainerDivsNew2012(a);title="Avoid opponents with higher health than this setting - Set 0 for unlimited";id="fightHealthMax";label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum Health / "));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,maxlength:5,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightHealthMax","0"),size:"1"});title="Avoid opponents with higher health pct left than this setting - Set 0 for unlimited";id="fightHealthPctMax";label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Maximum Health Pct:"));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,maxlength:5,style:"margin-left:5px;width: 30px; border: 1px solid #781351;",value:GM_getValue("fightHealthPctMax","0"),size:"1"});tabContainerDivs(a);title="Maximum number of Attacks per Opponenent - Set 0 for unlimited";id="fightMaxAttacks";label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum # Attacks:"));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,maxlength:3,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightMaxAttacks","100"),size:"1"})}tabContainerDivsNew2012(a);id="fightMafiaMax";title="Avoid opponents with mafia sizes larger than this.",label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode("Maximum mafia:"));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightMafiaMax","501"),size:"1"});title="Make the maximum mafia size be relative to your own. For example, if you have 300 mafia members, and maximum mafia is set to 50, opponents with more than 350 mafia members will be avoided.";id="fightMafiaMaxRelative";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"fightMafiaMaxRelative");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Relative  |  Minimum Mafia: "));id="fightMafiaMin";title="Avoid opponents with mafia sizes smaller than this.",label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,style:"width: 30px; border: 1px solid #781351;",value:GM_getValue("fightMafiaMin","1"),size:"1"});title="Make the minimum mafia size be relative to your own. For example, if you have 300 mafia members, and minimum mafia is set to 50, opponents with less than 250 mafia members will be avoided.";id="fightMafiaMinRelative";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"fightMafiaMinRelative");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Relative"));tabContainerDivsNew2012(a);title="Fight higher levels if the mafia is smaller.  You mob them, overwhelm the smaller numbers";id="fightMobMode";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,value:"checked"},"fightMobMode");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Mob Fight  "));title="Fight Ice Stealers";id="fightIceStealers";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,value:"checked"},"fightIceStealers");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Attack Ice Stealers "));tabContainerDivsNew2012(a);title=" Use Mafia Family Patterns when fighting";id="fightNames";var g=makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,value:"checked"},id);makeElement("label",jqRX6buttonId1,{"for":id}).appendChild(document.createTextNode(" Use Patterns when fighting:"));g.addEventListener("click",clickUseFightNames,false);makeElement("br",jqRX6buttonId1);id="fightAvoidNames";title=" Avoid mafia families";makeElement("input",jqRX6buttonId1,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",jqRX6buttonId1,{"for":id}).appendChild(document.createTextNode(title));makeElement("br",jqRX6buttonId1);id="fightOnlyNames";title=" Only Fight Mafia Families ";makeElement("input",jqRX6buttonId1,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",jqRX6buttonId1,{"for":id}).appendChild(document.createTextNode(title));makeElement("textarea",jqRX6buttonId1,{style:"position: static; width: 15em; height: 6em;",id:"fightClanName",title:"Enter each pattern (such as a clan name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("fightClanName",defaultClans.join("\n"))));makeElement("br",jqRX6buttonId1);makeElement("font",jqRX6buttonId1,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each name pattern on a separate line."))}function createStaminaSubTab_FightSpecific(a){tabContainerDivs(a);makeElement("label",lhs).appendChild(document.createTextNode("Fight in: "));id="fightListLoc";var b=makeElement("select",lhs,{id:id});for(i=0,iLength=fightLocations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(fightLocations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("fightLocation",NY);rhs.appendChild(document.createTextNode(" while gaining: "));title="Reattack if this amount is gained";id="reattackThresholdList";makeElement("input",rhs,{type:"text",id:id,title:title,maxlength:6,style:"width: 45px;",value:GM_getValue(id,"10000"),size:"2"});label=makeElement("label",rhs,{"for":id,title:title,style:"margin-left: 0.5em;"});title="Attack ONLY live targets";id="iceCheck";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"iceCheck");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Skip iced targets"));title="Power Attack";id="staminaPowerattack";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},id);label=makeElement("label",rhs,{"for":id,title:title,style:"margin-left: 0.5em;"});label.appendChild(document.createTextNode("Powerattack"));tabContainerDivs(a);lhs.appendChild(document.createTextNode("Fight these opponents:"));makeElement("textarea",rhs,{style:"position: static; width: 180px; height: 105px;",id:"pfightlist",title:"Enter each opponent's ID (not their name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("pfightlist","")));makeElement("br",rhs);makeElement("font",rhs,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each target on a separate line. Add the userid part of the p|userid."));tabContainerDivs(a);lhs.appendChild(document.createTextNode("Add ID's from Family Page:"));title="Clear Fight List";id="fightListClear";eltA=makeElement("a",rhs,{id:id,href:"#",alt:title,title:title});eltA.appendChild(document.createTextNode("Clear MW Id's"));eltA.addEventListener("click",clearFight,false);title="Load MW Id's from family Page";id="fightListUpdate";eltA=makeElement("a",rhs,{id:id,href:"#",alt:title,title:title,style:"margin-left:10px;"});eltA.appendChild(document.createTextNode("Add MW Id's"));eltA.addEventListener("click",addPageToFight,false);tabContainerDivs(a);lhs.appendChild(document.createTextNode("Enter MW Profile Link:"));title="Enter MW Profile Link";id="fightListSingleLink";makeElement("input",rhs,{type:"text",id:id,title:title,style:"width: 300px;"});makeElement("br",rhs);id="fightListSingleAdd";eltA=makeElement("a",rhs,{id:id,href:"#",alt:title,title:title});eltA.appendChild(document.createTextNode("Add Single ID"));eltA.addEventListener("click",addSingleID,false);tabContainerDivs(a);removeStrongerOpponents(a)}function createStaminaSubTab_FightSpecificNew2012(a){tabContainerDivsNew2012(a);makeElement("label",jqRX6buttonId1).appendChild(document.createTextNode("Fight in: "));id="fightListLoc";var b=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=fightLocations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(fightLocations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("fightLocation",NY);jqRX6buttonId1.appendChild(document.createTextNode(" while gaining: "));title="Reattack if this amount is gained";id="reattackThresholdList";makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,maxlength:6,style:"width: 45px;",value:GM_getValue(id,"10000"),size:"2"});label=makeElement("label",jqRX6buttonId1,{"for":id,title:title,style:"margin-left: 0.5em;"});title="Attack ONLY live targets";id="iceCheck";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"iceCheck");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Skip iced targets"));title="Power Attack";id="staminaPowerattack";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},id);label=makeElement("label",jqRX6buttonId1,{"for":id,title:title,style:"margin-left: 0.5em;"});label.appendChild(document.createTextNode("Powerattack"));tabContainerDivsNew2012(a);jqRX6buttonId1.appendChild(document.createTextNode("Fight these opponents:"));makeElement("textarea",jqRX6buttonId1,{style:"position: static; width: 180px; height: 105px;",id:"pfightlist",title:"Enter each opponent's ID (not their name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("pfightlist","")));makeElement("br",jqRX6buttonId1);makeElement("font",jqRX6buttonId1,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each target on a separate line. Add the userid part of the p|userid."));tabContainerDivsNew2012(a);jqRX6buttonId1.appendChild(document.createTextNode("Add ID's from Family Page:"));title="Clear Fight List";id="fightListClear";eltA=makeElement("a",jqRX6buttonId1,{id:id,href:"#",alt:title,title:title,style:"padding:5px;margin-left:5px","class":"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only",type:"button",role:"button"});eltA.appendChild(document.createTextNode("Clear MW Id's"));eltA.addEventListener("click",clearFight,false);title="Load MW Id's from family Page";id="fightListUpdate";eltA=makeElement("a",jqRX6buttonId1,{id:id,href:"#",alt:title,title:title,style:"margin-left:10px;padding:5px","class":"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only",type:"button",role:"button"});eltA.appendChild(document.createTextNode("Add MW Id's"));eltA.addEventListener("click",addPageToFight,false);tabContainerDivsNew2012(a);lhs.appendChild(document.createTextNode("Enter MW Profile Link:"));title="Enter MW Profile Link";id="fightListSingleLink";makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,style:"width: 300px;"});makeElement("br",jqRX6buttonId1);id="fightListSingleAdd";eltA=makeElement("a",jqRX6buttonId1,{id:id,href:"#",alt:title,title:title,style:"padding:5px;margin-top:5px","class":"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only",type:"button",role:"button"});eltA.appendChild(document.createTextNode("Add Single ID"));eltA.addEventListener("click",addSingleID,false);tabContainerDivsNew2012(a);removeStrongerOpponentsNew2012(a)}function addSingleID(){var a;var b=document.getElementById("pfightlist");var c=b.innerHTML;var d=decodeURIComponent(document.getElementById("fightListSingleLink").value);if(d.match(/user":"(.+)"/)){a=decodeID(RegExp.$1).digitize();if(a&&a!=xw_user&&c.indexOf(a)==-1){if(c!="")c+="\n"+a;else c=a;b.value=c;b.innerHTML=c;alert("User "+a+" added.")}else alert("You can not add/already added this profile link: "+a)}else alert("Invalid profile link.");document.getElementById("fightListSingleLink").value=""}function clearFight(){var a=document.getElementById("pfightlist");if(a){a.value="";a.innerHTML=""}}function addPageToFight(){var a="";var b=0;var c;var d=document.getElementById("pfightlist");if(d){a=d.innerHTML;var e=xpathFirst('.//ul[id="member_list"]');if(!e)e=document.getElementById("member_list");if(e){var f=$x('.//div[@class="name_n_rank"]//a[contains(@href,"user=")]',e);if(f&&f.length>0){for(i=0,iLength=f.length;i<iLength;++i){var g=f[i];var h=g.getAttribute("href");if(h.match(/(user|opponent_id)\=(.+)/)){c=decodeID(RegExp.$2).digitize();if(c&&c!=xw_user&&a.indexOf(c)==-1){if(a!="")a+="\n"+c;else a=c;b++}}}d.value=a;d.innerHTML=a;alert("Added "+b+" out of "+f.length+" members")}else alert("Found NO members")}else alert("Adding MW Id's is only possible from a Family Page")}}function createStaminaSubTab_RobFight(a){tabContainerDivs(a);title="Switch from Robbing to Fighting when falling below this stamina (min 25).";id="robFightStaminaFloor";lhs.appendChild(document.createTextNode(" Stamina to switch from robbing to fighting: "));makeElement("input",rhs,{type:"text",id:id,value:GM_getValue(id,"25"),title:title,size:"6",maxlength:6,style:"text-align: right;"});createStaminaSubTab_Rob(a);makeElement("hr",a);createStaminaSubTab_FightRandom(a)}function createStaminaSubTab_RobFightNew2012(a){tabContainerDivsNew2012(a);title="Switch from Robbing to Fighting when falling below this stamina (min 25).";id="robFightStaminaFloor";jqRX6buttonId1.appendChild(document.createTextNode(" Stamina to switch from robbing to fighting: "));makeElement("input",jqRX6buttonId1,{type:"text",id:id,value:GM_getValue(id,"25"),title:title,size:"6",maxlength:6,style:"text-align: right;"});createStaminaSubTab_RobNew2012(a);makeElement("hr",a);createStaminaSubTab_FightRandomNew2012(a)}function createStaminaSubTab_FightRob(a){createStaminaSubTab_Rob(a);makeElement("hr",a);makeElement("font",a,{style:"font-size: 10px;text-align:center;color:yellow;,"}).appendChild(document.createTextNode("Switching from fighting to robbing when 'Fight then Rob' is determined by the health setting from the Health subTab."));createStaminaSubTab_FightRandom(a)}function createStaminaSubTab_FightRobNew2012(a){createStaminaSubTab_RobNew2012(a);makeElement("hr",a);makeElement("font",a,{style:"font-size: 10px;text-align:center;color:yellow;","class":"jqRX6buttonId1"}).appendChild(document.createTextNode("Switching from fighting to robbing when 'Fight then Rob' is determined by the health setting from the Health subTab."));createStaminaSubTab_FightRandomNew2012(a)}function createStaminaSubTab_Rob(a){tabContainerDivs(a);item.appendChild(document.createTextNode("     Rob in:"));id="robLocation";var b=makeElement("select",item,{id:id});for(i=0,iLength=locations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(locations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("robLocation",NY);title="Fast rob, does not log / does not spend burners";id="fastRob";makeElement("input",item,{type:"checkbox",id:id,title:title,value:"checked",style:"margin-left: 10px;"},id);label=makeElement("label",item,{"for":id,title:title});label.appendChild(document.createTextNode(" Fast Rob?"));makeElement("label",item,{"for":id,title:title}).appendChild(document.createTextNode(" Speed: "));var c=makeElement("select",item,{id:"fastRobSpeed"});iLength=mwapSpeedModes.length;if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse())iLength=iLength-2;for(i=0;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(mwapSpeedModes[i]));c.appendChild(choice)}c.selectedIndex=GM_getValue("fastRobSpeed",0);title="Use Burners (one per property)";id="useBurners";makeElement("input",item,{type:"checkbox",id:id,title:title,value:"checked",style:"margin-left: 10px;"},id);label=makeElement("label",item,{"for":id,title:title});label.appendChild(document.createTextNode(" Use Burners?"));title="Use RobSquads";id="useRobSquads";makeElement("input",item,{type:"checkbox",id:id,title:title,value:"checked",style:"margin-left: 10px;"},id);label=makeElement("label",item,{"for":id,title:title});label.appendChild(document.createTextNode(" Use Rob Squads?"))}function createStaminaSubTab_RobNew2012(a){tabContainerDivsNew2012(a);jqRX6buttonId1.appendChild(document.createTextNode("     Rob in:"));id="robLocation";var b=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=locations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(locations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("robLocation",NY);title="Fast rob, does not log / does not spend burners";id="fastRob";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,value:"checked",style:"margin-left: 10px;"},id);label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Fast Rob?"));makeElement("label",jqRX6buttonId1,{"for":id,title:title}).appendChild(document.createTextNode(" Speed: "));var c=makeElement("select",jqRX6buttonId1,{id:"fastRobSpeed"});iLength=mwapSpeedModes.length;if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse())iLength=iLength-2;for(i=0;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(mwapSpeedModes[i]));c.appendChild(choice)}c.selectedIndex=GM_getValue("fastRobSpeed",0);title="Use Burners (one per property)";id="useBurners";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,value:"checked",style:"margin-left: 10px;"},id);label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Use Burners?"));title="Use RobSquads";id="useRobSquads";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,value:"checked",style:"margin-left: 10px;"},id);label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Use Rob Squads?"))}function createStaminaSubTab_CollectBounties(a){tabContainerDivs(a);lhs.appendChild(document.createTextNode("Collect bounties in:"));id="hitmanLocation";var b=makeElement("select",rhs,{id:id});for(i=0,iLength=locations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(locations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("hitmanLocation",NY);tabContainerDivs(a);id="hitmanBountyMin";title="Ignore targets with bounties below this measly amount.",label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode("Minimum bounty:"));makeElement("input",rhs,{type:"text",id:id,title:title,style:"width: 7em; border: 1px solid #781351;",value:GM_getValue("hitmanBountyMin","0")});tabContainerDivs(a);lhs.appendChild(document.createTextNode("Prefer targets with:"));id="bountySelection";var c=makeElement("select",rhs,{id:id});for(i=0,iLength=bountySelectionChoices.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(bountySelectionChoices[i]));c.appendChild(choice)}c.selectedIndex=GM_getValue("bountySelection",BOUNTY_HIGHEST_BOUNTY);tabContainerDivs(a);title=" Use Mafia Family Patterns for collecting bounties";id="hitmanNames";var d=makeElement("input",lhs,{type:"checkbox",id:id,value:"checked"},id);makeElement("label",lhs,{"for":id}).appendChild(document.createTextNode(" Use Patterns when collecting:"));d.addEventListener("click",clickUseHitmanNames,false);makeElement("br",lhs);id="hitmanAvoidNames";title=" Avoid mafia families";makeElement("input",lhs,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",lhs,{"for":id}).appendChild(document.createTextNode(title));makeElement("br",lhs);id="hitmanOnlyNames";title=" Only Fight Mafia Families ";makeElement("input",lhs,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",lhs,{"for":id}).appendChild(document.createTextNode(title));makeElement("textarea",rhs,{style:"position: static; width: 15em; height: 6em;",id:"hitmanClanName",title:"Enter each pattern (such as a clan name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("hitmanClanName",defaultClans.join("\n"))));makeElement("br",rhs);makeElement("font",rhs,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each name pattern on a separate line."));tabContainerDivs(a);removeStrongerOpponents(a)}function createStaminaSubTab_CollectBountiesNew2012(a){tabContainerDivsNew2012(a);jqRX6buttonId1.appendChild(document.createTextNode("Collect bounties in:"));id="hitmanLocation";var b=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=locations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(locations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("hitmanLocation",NY);tabContainerDivsNew2012(a);id="hitmanBountyMin";title="Ignore targets with bounties below this measly amount.",label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode("Minimum bounty:"));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,style:"width: 7em; border: 1px solid #781351;",value:GM_getValue("hitmanBountyMin","0")});tabContainerDivsNew2012(a);jqRX6buttonId1.appendChild(document.createTextNode("Prefer targets with:"));id="bountySelection";var c=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=bountySelectionChoices.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(bountySelectionChoices[i]));c.appendChild(choice)}c.selectedIndex=GM_getValue("bountySelection",BOUNTY_HIGHEST_BOUNTY);tabContainerDivsNew2012(a);title=" Use Mafia Family Patterns for collecting bounties";id="hitmanNames";var d=makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,value:"checked"},id);makeElement("label",jqRX6buttonId1,{"for":id}).appendChild(document.createTextNode(" Use Patterns when collecting:"));d.addEventListener("click",clickUseHitmanNames,false);makeElement("br",jqRX6buttonId1);id="hitmanAvoidNames";title=" Avoid mafia families";makeElement("input",jqRX6buttonId1,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",jqRX6buttonId1,{"for":id}).appendChild(document.createTextNode(title));makeElement("br",jqRX6buttonId1);id="hitmanOnlyNames";title=" Only Fight Mafia Families ";makeElement("input",jqRX6buttonId1,{type:"radio",name:"rm3",id:id,value:"checked"},id);makeElement("label",jqRX6buttonId1,{"for":id}).appendChild(document.createTextNode(title));makeElement("textarea",jqRX6buttonId1,{style:"position: static; width: 15em; height: 6em;",id:"hitmanClanName",title:"Enter each pattern (such as a clan name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("hitmanClanName",defaultClans.join("\n"))));makeElement("br",jqRX6buttonId1);makeElement("font",jqRX6buttonId1,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each name pattern on a separate line."));tabContainerDivsNew2012(a);removeStrongerOpponentsNew2012(a)}function createStaminaSubTab_SetBounties(a){tabContainerDivs(a);lhs.appendChild(document.createTextNode("Place bounties in:"));id="autoHitListLoc";var b=makeElement("select",rhs,{id:id});for(i=0,iLength=locations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(locations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("autoHitListLoc",NY);title="Set Bounties in background";id="bgAutoHitCheck";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"bgAutoHitCheck");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" Enable Background mode"));tabContainerDivs(a);id="autoHitListBounty";title="Place a fixed bounty or check random",label=makeElement("label",lhs,{"for":id,title:title});label.appendChild(document.createTextNode("Bounty:"));makeElement("input",rhs,{type:"text",id:id,title:title,style:"width: 7em; border: 1px solid #781351;",value:GM_getValue("autoHitListBounty","0")});title="Place Random Bounties";id="autoHitListRandom";makeElement("input",rhs,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"autoHitListRandom");label=makeElement("label",rhs,{"for":id,title:title});label.appendChild(document.createTextNode(" random"));tabContainerDivs(a);lhs.appendChild(document.createTextNode("Hitlist these opponents:"));makeElement("textarea",rhs,{style:"position: static; width: 180px; height: 105px;",id:"pautoHitOpponentList",title:"Enter each opponent's ID (not their name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("pautoHitOpponentList","")));makeElement("br",rhs);makeElement("font",rhs,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each target on a separate line. Add the userid part of the p|userid."))}function createStaminaSubTab_SetBountiesNew2012(a){tabContainerDivsNew2012(a);jqRX6buttonId1.appendChild(document.createTextNode("Place bounties in:"));id="autoHitListLoc";var b=makeElement("select",jqRX6buttonId1,{id:id});for(i=0,iLength=locations.length;i<iLength;++i){choice=document.createElement("option");choice.value=i;choice.appendChild(document.createTextNode(locations[i]));if(i<cities.length)if(cities[i][CITY_CLOSED])choice.style.display="none";b.appendChild(choice)}b.selectedIndex=GM_getValue("autoHitListLoc",NY);title="Set Bounties in background";id="bgAutoHitCheck";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"bgAutoHitCheck");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" Enable Background mode"));tabContainerDivsNew2012(a);id="autoHitListBounty";title="Place a fixed bounty or check random",label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode("Bounty:"));makeElement("input",jqRX6buttonId1,{type:"text",id:id,title:title,style:"width: 7em; border: 1px solid #781351;",value:GM_getValue("autoHitListBounty","0")});title="Place Random Bounties";id="autoHitListRandom";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:id,title:title,style:"margin-left: 0.5em;",value:"checked"},"autoHitListRandom");label=makeElement("label",jqRX6buttonId1,{"for":id,title:title});label.appendChild(document.createTextNode(" random"));tabContainerDivsNew2012(a);lhs.appendChild(document.createTextNode("Hitlist these opponents:"));makeElement("textarea",jqRX6buttonId1,{style:"position: static; width: 180px; height: 105px;",id:"pautoHitOpponentList",title:"Enter each opponent's ID (not their name) on a separate line."}).appendChild(document.createTextNode(GM_getValue("pautoHitOpponentList","")));makeElement("br",jqRX6buttonId1);makeElement("font",jqRX6buttonId1,{style:"font-size: 10px;"}).appendChild(document.createTextNode("Enter each target on a separate line. Add the userid part of the p|userid."))}function createStaminaSubTab_Random(a){var b=GM_getValue("randomSpendModes");if(!b)b="1000";var c=makeElement("div",a,{style:"margin-left:0.5em;"});makeElement("br",c);title="Stamina Spend Choice selection";name="randomSpendModes[]";for(i=0,iLength=randomSpendChoices.length;i<iLength;++i){if(randomSpendChoices[i]){if(b[i]!="0"){makeElement("input",c,{type:"checkbox",name:name,title:randomSpendChoices[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:b[i],checked:"checked"})}else{makeElement("input",c,{type:"checkbox",name:name,title:randomSpendChoices[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:b[i]})}label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(randomSpendChoices[i]))}else{makeElement("input",c,{type:"checkbox",name:name,title:"invalid option",style:"display:none;",value:"0"})}}makeElement("br",c);var d;var e=GM_getValue("randomFightLocations");if(!e)e="100000000";var c=makeElement("div",a,{style:"margin-left:0.5em;margin-top:1em;"});c.appendChild(document.createTextNode("Location Settings :"));makeElement("br",c);c.appendChild(document.createTextNode("Fight in:"));makeElement("br",c);title="Fighting cities selection";name="randomFightLocations[]";for(i=0,iLength=randomLocations.length;i<iLength;++i){var f=false;if(i<cities.length)if(cities[i][CITY_CLOSED])f=true;if(e[i]=="1"&&!f)d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i],checked:"checked"});else d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i]});if(f)d.style.display="none";label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(locations[i]))}makeElement("br",c);var g=GM_getValue("randomRobLocations");if(!g)g="100000000";var c=makeElement("div",a,{style:"margin-left:0.5em;"});c.appendChild(document.createTextNode("Rob in:"));makeElement("br",c);title="Robbing cities selection";name="randomRobLocations[]";for(i=0,iLength=randomLocations.length;i<iLength;++i){var f=false;if(i<cities.length)if(cities[i][CITY_CLOSED])f=true;if(g[i]=="1"&&!f)d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i],checked:"checked"});else d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i]});if(f)d.style.display="none";label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(locations[i]))}makeElement("br",c);var h=GM_getValue("randomHitmanLocations");if(!h)h="100000000";var c=makeElement("div",a,{style:"margin-left:0.5em;"});c.appendChild(document.createTextNode("Collect Bounties in:"));makeElement("br",c);title="Hitman cities selection";name="randomHitmanLocations[]";for(i=0,iLength=randomLocations.length;i<iLength;++i){var f=false;if(i<cities.length)if(cities[i][CITY_CLOSED])f=true;if(h[i]=="1"&&!f)d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i],checked:"checked"});else d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i]});if(f)d.style.display="none";label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(locations[i]))}makeElement("br",c,{style:"margin-bottom:1em;"});c.appendChild(document.createTextNode("'Spend Stamina Random' will inherit the specific settings from each individual stamina spending option.<br/>"));c.appendChild(document.createTextNode("Please verify these specific settings before saving!"));makeElement("br",c,{style:"margin-bottom:1em;"})}function createStaminaSubTab_RandomNew2012(a){var b=GM_getValue("randomSpendModes");if(!b)b="1000";var c=makeElement("div",a,{style:"margin-left:0.5em;","class":"jqRX6buttonId1"});makeElement("br",c);title="Stamina Spend Choice selection";name="randomSpendModes[]";for(i=0,iLength=randomSpendChoices.length;i<iLength;++i){if(randomSpendChoices[i]){if(b[i]!="0"){makeElement("input",c,{type:"checkbox",name:name,title:randomSpendChoices[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:b[i],checked:"checked"})}else{makeElement("input",c,{type:"checkbox",name:name,title:randomSpendChoices[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:b[i]})}label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(randomSpendChoices[i]))}else{makeElement("input",c,{type:"checkbox",name:name,title:"invalid option",style:"display:none;",value:"0"})}}makeElement("br",c);var d;var e=GM_getValue("randomFightLocations");if(!e)e="100000000";var c=makeElement("div",a,{style:"margin-left:0.5em;","class":"jqRX6buttonId1"});c.appendChild(document.createTextNode("Location Settings :"));makeElement("br",c);c.appendChild(document.createTextNode("Fight in:"));makeElement("br",c);title="Fighting cities selection";name="randomFightLocations[]";for(i=0,iLength=randomLocations.length;i<iLength;++i){var f=false;if(i<cities.length)if(cities[i][CITY_CLOSED])f=true;if(e[i]=="1"&&!f)d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i],checked:"checked"});else d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i]});if(f)d.style.display="none";label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(locations[i]))}makeElement("br",c);var g=GM_getValue("randomRobLocations");if(!g)g="100000000";var c=makeElement("div",a,{style:"margin-left:0.5em;","class":"jqRX6buttonId1"});c.appendChild(document.createTextNode("Rob in:"));makeElement("br",c);title="Robbing cities selection";name="randomRobLocations[]";for(i=0,iLength=randomLocations.length;i<iLength;++i){var f=false;if(i<cities.length)if(cities[i][CITY_CLOSED])f=true;if(g[i]=="1"&&!f)d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i],checked:"checked"});else d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i]});if(f)d.style.display="none";label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(locations[i]))}makeElement("br",c);var h=GM_getValue("randomHitmanLocations");if(!h)h="100000000";var c=makeElement("div",a,{style:"margin-left:0.5em;","class":"jqRX6buttonId1"});c.appendChild(document.createTextNode("Collect Bounties in:"));makeElement("br",c);title="Hitman cities selection";name="randomHitmanLocations[]";for(i=0,iLength=randomLocations.length;i<iLength;++i){var f=false;if(i<cities.length)if(cities[i][CITY_CLOSED])f=true;if(h[i]=="1"&&!f)d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i],checked:"checked"});else d=makeElement("input",c,{type:"checkbox",name:name,title:locations[i],style:"margin-left: 0.5em;margin-right: 0.5em;",value:locations[i]});if(f)d.style.display="none";label=makeElement("label",c,{"for":name,title:title});label.appendChild(document.createTextNode(locations[i]))}makeElement("br",c,{style:"margin-bottom:1em;"});c.appendChild(document.createTextNode("'Spend Stamina Random' will inherit the specific settings from each individual stamina spending option."));makeElement("br",c,{style:"margin-bottom:1em;"});c.appendChild(document.createTextNode("Please verify these specific settings before saving!"));makeElement("br",c,{style:"margin-bottom:1em;"})}function createStaminaTab(){var a,b,c,d,e,f,g,h;var i=makeElement("div",null,{id:"staminaTab","class":"tabcontent"});var j=makeElement("div",i,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});j.appendChild(document.createTextNode("Stamina Settings:"));var k=makeElement("div",i,{style:"position: relative; top: 5px; margin-left: auto; margin-right: auto; width: 95%; line-height:120%;"});g=makeElement("div",k);f=makeElement("div",g,{"class":"lhs"});rhs=makeElement("div",g,{"class":"rhs"});makeElement("br",g,{"class":"hide"});c="Spend stamina automatically.";d="staminaSpend";makeElement("input",f,{type:"checkbox",id:d,title:c,value:"checked"},"staminaSpend");e=makeElement("label",f,{"for":d,title:c});e.appendChild(document.createTextNode(" Spend stamina to:"));d="staminaSpendHow";var l=makeElement("select",rhs,{id:d});for(a=0,iLength=staminaSpendChoices.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(staminaSpendChoices[a]));l.appendChild(h)}c="Log Details";d="staminaLogDetails";makeElement("input",rhs,{type:"checkbox",id:d,title:c,style:"margin-left: 0.5em;",value:"checked"},"staminaLogDetails");e=makeElement("label",rhs,{"for":d,title:c});e.appendChild(document.createTextNode(" Log Details"));var m=makeElement("div",k,{id:"staminaTabSub",style:"position: static; border: 1px inset #FFD927; margin-left: auto; margin-right: auto; margin-top: 5px; margin-bottom: 5px;"});g=makeElement("div",k,{"class":"single"});c="Start spending stamina when stamina level is reached";d="selectStaminaUse";g.appendChild(document.createTextNode("Start spending stamina when "));makeElement("input",g,{type:"text",id:d,title:c,style:"width: 2em; ",value:GM_getValue(d,"0")});d="selectStaminaUseMode";g.appendChild(document.createTextNode(" "));b=makeElement("select",g,{id:d,title:c});for(a=0,iLength=numberSchemes.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(numberSchemes[a]));b.appendChild(h)}b.selectedIndex=GM_getValue(d,0);g.appendChild(document.createTextNode(" of stamina has accumulated."));g=makeElement("div",k,{"class":"single"});c="Suspend spending stamina for above choices while below this level.";c+="  NOTE: Operations & Stamina LOWER limits are completely INDEPENDENT Of Each Other.";d="selectStaminaKeep";g.appendChild(document.createTextNode("While Stamina Is Below "));makeElement("input",g,{type:"text",id:d,title:c,style:"width: 2em; ",value:GM_getValue(d,"0")});d="selectStaminaKeepMode";g.appendChild(document.createTextNode(" "));b=makeElement("select",g,{id:d,title:c});for(a=0,iLength=numberSchemes.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(numberSchemes[a]));b.appendChild(h)}b.selectedIndex=GM_getValue(d,0);g.appendChild(document.createTextNode(" Suspend Stamina Spending For Jobs & Fighting."));g=makeElement("div",k,{"class":"single"});c="Suspend automatic play and operations processing while below this level of stamina.";c+="  NOTE: Operations & Stamina LOWER limits are completely INDEPENDENT Of Each Other.";d="selectMissionStaminaKeep";g.appendChild(document.createTextNode("While Stamina Is Below "));makeElement("input",g,{type:"text",id:d,title:c,style:"width: 2em; ",value:GM_getValue(d,"0")});d="selectMissionStaminaKeepMode";g.appendChild(document.createTextNode(" "));b=makeElement("select",g,{id:d,title:c});for(a=0,iLength=numberSchemes.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(numberSchemes[a]));b.appendChild(h)}b.selectedIndex=GM_getValue(d,0);g.appendChild(document.createTextNode(" Suspend Stamina Spending For Operations."));g=makeElement("div",k,{"class":"single"});c="Ignore minimum stamina settings if a level up is within reach.";d="allowStaminaToLevelUp";makeElement("input",g,{type:"checkbox",id:d,title:c,value:"checked"},"allowStaminaToLevelUp");e=makeElement("label",g,{"for":d,title:c});e.appendChild(document.createTextNode(" Don't reserve stamina if within reach of the next level."));var n=function(){m.innerHTML="";var a=l.selectedIndex;switch(a){case STAMINA_HOW_FIGHT_RANDOM:createStaminaSubTab_FightRandom(m);break;case STAMINA_HOW_FIGHT_BG:createStaminaSubTab_FightRandom(m);break;case STAMINA_HOW_FIGHT_LIST:createStaminaSubTab_FightSpecific(m);break;case STAMINA_HOW_FIGHT_LIST_BG:createStaminaSubTab_FightSpecific(m);break;case STAMINA_HOW_HITMAN:createStaminaSubTab_CollectBounties(m);break;case STAMINA_HOW_ROBBING:createStaminaSubTab_Rob(m);break;case STAMINA_HOW_AUTOHITLIST:createStaminaSubTab_SetBounties(m);break;case STAMINA_HOW_RANDOM:createStaminaSubTab_Random(m);break;case STAMINA_HOW_FIGHTROB:createStaminaSubTab_FightRob(m);break;case STAMINA_HOW_ROBFIGHT:createStaminaSubTab_RobFight(m);break;case STAMINA_HOW_ROBBING_BG:createStaminaSubTab_Rob(m);break;default:createStaminaSubTab_Random(m);break}};l.selectedIndex=GM_getValue("staminaSpendHow",0);n();l.addEventListener("change",n,false);return i}function createStaminaTabNew2012(){var a,b,c,d,e,f,g,h,i;var j=makeElement("div",null,{id:"staminaTab","class":"tabcontent"});var k=makeElement("div",j,{"class":"jsRX6Tabs"});g=makeElement("div",k);i=makeElement("div",g,{"class":"jqRX6buttonId1"});makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("How do you want to Spend Stamina?"));c="Spend stamina automatically.";d="staminaSpend";makeElement("input",i,{type:"checkbox",id:d,title:c,value:"checked"},"staminaSpend");e=makeElement("label",i,{"for":d,title:c,"class":"jqSpacer"});e.appendChild(document.createTextNode("Spend stamina to:"));d="staminaSpendHow";var l=makeElement("select",i,{id:d});for(a=0,iLength=staminaSpendChoices.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(staminaSpendChoices[a]));l.appendChild(h)}c="Log Details";d="staminaLogDetails";makeElement("input",i,{type:"checkbox",id:d,title:c,style:"margin-left: 0.5em;",value:"checked"},"staminaLogDetails");e=makeElement("label",i,{"for":d,title:c,"class":"jqSpacer"});e.appendChild(document.createTextNode("Log Details"));var m=function(){n.innerHTML="";var a=l.selectedIndex;switch(a){case STAMINA_HOW_FIGHT_RANDOM:createStaminaSubTab_FightRandomNew2012(n);break;case STAMINA_HOW_FIGHT_BG:createStaminaSubTab_FightRandomNew2012(n);break;case STAMINA_HOW_FIGHT_LIST:createStaminaSubTab_FightSpecificNew2012(n);break;case STAMINA_HOW_FIGHT_LIST_BG:createStaminaSubTab_FightSpecificNew2012(n);break;case STAMINA_HOW_HITMAN:createStaminaSubTab_CollectBountiesNew2012(n);break;case STAMINA_HOW_ROBBING:createStaminaSubTab_RobNew2012(n);break;case STAMINA_HOW_AUTOHITLIST:createStaminaSubTab_SetBountiesNew2012(n);break;case STAMINA_HOW_RANDOM:createStaminaSubTab_RandomNew2012(n);break;case STAMINA_HOW_FIGHTROB:createStaminaSubTab_FightRobNew2012(n);break;case STAMINA_HOW_ROBFIGHT:createStaminaSubTab_RobFightNew2012(n);break;case STAMINA_HOW_ROBBING_BG:createStaminaSubTab_RobNew2012(n);break;default:createStaminaSubTab_RandomNew2012(n);break}};i=makeElement("div",g,{"class":"jqRX6buttonId1"});makeElement("div",i,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Set Triggers for Stamina - (Optional)"));var n=makeElement("div",k,{id:"staminaTabSub","class":"jsRX6Tabs"});makeElement("br",g,{"class":"hide"});g=makeElement("div",i,{"class":"single"});c="Start spending stamina when stamina level is reached";d="selectStaminaUse";g.appendChild(document.createTextNode("Start spending stamina when "));makeElement("input",g,{type:"text",id:d,title:c,style:"width: 2em; ",value:GM_getValue(d,"0")});d="selectStaminaUseMode";g.appendChild(document.createTextNode(" "));b=makeElement("select",g,{id:d,title:c});for(a=0,iLength=numberSchemes.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(numberSchemes[a]));b.appendChild(h)}b.selectedIndex=GM_getValue(d,0);g.appendChild(document.createTextNode(" of stamina has accumulated."));g=makeElement("div",i,{"class":"single",style:"margin-left:35px"});c="Suspend spending stamina for above choices while below this level.";c+="  NOTE: Operations & Stamina LOWER limits are completely INDEPENDENT Of Each Other.";d="selectStaminaKeep";g.appendChild(document.createTextNode("While Stamina is below "));makeElement("input",g,{type:"text",id:d,title:c,style:"width: 2em; ",value:GM_getValue(d,"0")});d="selectStaminaKeepMode";g.appendChild(document.createTextNode(" "));b=makeElement("select",g,{id:d,title:c});for(a=0,iLength=numberSchemes.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(numberSchemes[a]));b.appendChild(h)}b.selectedIndex=GM_getValue(d,0);g.appendChild(document.createTextNode(" suspend stamina spending for Jobs & Fighting."));g=makeElement("div",i,{"class":"single",style:"margin-left:35px"});c="Suspend automatic play and operations processing while below this level of stamina.";c+="  NOTE: Operations & Stamina LOWER limits are completely INDEPENDENT Of Each Other.";d="selectMissionStaminaKeep";g.appendChild(document.createTextNode("While Stamina is below "));makeElement("input",g,{type:"text",id:d,title:c,style:"width: 2em; ",value:GM_getValue(d,"0")});d="selectMissionStaminaKeepMode";g.appendChild(document.createTextNode(" "));b=makeElement("select",g,{id:d,title:c});for(a=0,iLength=numberSchemes.length;a<iLength;++a){h=document.createElement("option");h.value=a;h.appendChild(document.createTextNode(numberSchemes[a]));b.appendChild(h)}b.selectedIndex=GM_getValue(d,0);g.appendChild(document.createTextNode(" suspend stamina spending for Operations."));g=makeElement("div",i,{"class":"single"});c="Ignore minimum stamina settings if a level up is within reach.";d="allowStaminaToLevelUp";makeElement("input",g,{type:"checkbox",id:d,title:c,value:"checked"},"allowStaminaToLevelUp");e=makeElement("label",g,{"for":d,title:c});e.appendChild(document.createTextNode(" Don't reserve stamina if within reach of the next level."));l.selectedIndex=GM_getValue("staminaSpendHow",0);m();l.addEventListener("change",m,false);return j}function createHealTab(){var a,b,c,d,e,f,g,h,i;var j=makeElement("div",null,{id:"healTab","class":"tabcontent"});var k=makeElement("div",j,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});k.appendChild(document.createTextNode("Health Settings:"));var l=makeElement("div",j,{style:"position: relative; top: 10px; margin-left: 0px; margin-right: auto; width: 95%; line-height:120%;"});e=makeElement("div",l);f=makeElement("div",e,{"class":"lhs"});g=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"});b="Heal when health lands below indicated health.";c="autoHeal";makeElement("input",f,{type:"checkbox",id:c,value:"checked"},c,"checked");makeElement("img",f,{style:"padding-left: 5px;",src:stripURI(healthIcon)});makeElement("label",f,{"for":c,title:b}).appendChild(document.createTextNode(" Heal in:"));c="healLocation";var m=makeElement("select",g,{id:c});for(h=0,iLength=locations.length;h<iLength;++h){i=document.createElement("option");i.value=h;if(h<cities.length)if(cities[h][CITY_CLOSED])i.style.display="none";i.appendChild(document.createTextNode(locations[h]));m.appendChild(i)}m.selectedIndex=GM_getValue("healLocation",NY);makeElement("label",g,{title:b}).appendChild(document.createTextNode(" when health falls below "));makeElement("input",g,{style:"text-align: center",type:"text",value:GM_getValue("healthLevel","50"),id:"healthLevel",size:"2"});makeElement("label",g,{title:b}).appendChild(document.createTextNode(" points"));e=makeElement("div",l);f=makeElement("div",e,{"class":"lhs"});g=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"});b="Heal in NY when backgroundfighting";c="autoHealBackup";makeElement("input",g,{type:"checkbox",id:c,value:"checked"},c,"checked");makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" Heal in NY when backgroundfighting"));e=makeElement("div",l);f=makeElement("div",e,{"class":"lhs"});g=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"});b="Set the minimum Stamina Points Needed for Auto-Heal.";d=makeElement("label",g,{title:b});d.appendChild(document.createTextNode("Disable Auto-Heal when Stamina falls below "));makeElement("input",g,{type:"text",value:GM_getValue("stamina_min_heal","22"),id:"stamina_min_heal",size:"3"});g.appendChild(document.createTextNode(" points."));makeElement("br",g,{"class":"hide"});makeElement("font",g,{style:"font-size: 10px;color:yellow;"}).appendChild(document.createTextNode("This setting determins switching from fighting to robbing when 'Fight then Rob' is chosen from the Stamina subTab."));e=makeElement("div",l);f=makeElement("div",e,{"class":"lhs"});g=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"});b="Hide in hospital ";c="hideInHospital";var n=makeElement("input",g,{type:"checkbox",title:b,id:c,value:"checked"},c);makeElement("img",g,{style:"padding-left: 5px;",src:stripURI(hideIcon)});b=n.checked?" Hide in hospital but...":" Hide in hospital";makeElement("label",g,{id:"hideLabel","for":c,title:b}).appendChild(document.createTextNode(b));a=makeElement("div",g,{style:"line-height: 135%;",id:"hideOpts"});for(h=0,iLength=healOptions.length;h<iLength;h++){c=healOptions[h][0];b=healOptions[h][1];var o=healOptions[h][2];var p=makeElement("div",a);makeElement("input",p,{type:"checkbox",id:c,title:o,value:"checked",style:"margin-left: 15px;"},c);d=makeElement("label",p,{"for":c,title:o});d.appendChild(document.createTextNode(" "+b))}a.style.display=n.checked?"":"none";var q=function(){var a=document.getElementById("hideOpts");var b=document.getElementById("hideLabel");if(!a)return false;if(this.checked){a.style.display="";b.firstChild.nodeValue=" Hide in hospital but..."}else{a.style.display="none";b.firstChild.nodeValue=" Hide in hospital"}return true};n.addEventListener("click",q,false);e=makeElement("div",l);f=makeElement("div",e,{"class":"lhs"});g=makeElement("div",e,{"class":"rhs"});makeElement("br",e,{"class":"hide"});c="hideAttacks";b="Enable hitlist riding: RX6 MWAP disables autoHeal after you got XP from attacks; it enables it again after parsing a snuffed message.";makeElement("input",g,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",g,{"for":c,title:b}).appendChild(document.createTextNode(" Hitlist riding, turn off autoHeal after "));c="rideHitlistXP";b="Enter the XP you want to gain before RX6 MWAP turns off autoHeal. Enter '0' if you want RX6 MWAP to turn off autoHeal after it detected a 0 xp attack.";makeElement("input",g,{type:"text",value:GM_getValue(c,"0"),title:b,id:c,style:"width: 25px"});g.appendChild(document.createTextNode(" xp"));return j}function createHealTabNew2012(){var a,b,c,d,e,f,g,h,i;var j=makeElement("div",null,{id:"healTab","class":"tabcontent"});var k=makeElement("div",j,{"class":"jsRX6Tabs"});e=makeElement("div",k);jqRX6buttonId1=makeElement("div",e,{"class":"jqRX6buttonId1"});makeElement("div",jqRX6buttonId1,{"class":"jsRX6BoxHeading",style:"width:48%"}).appendChild(document.createTextNode("Where would you like to heal?"));b="Heal when health lands below indicated health.";c="autoHeal";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,value:"checked"},c,"checked");makeElement("img",jqRX6buttonId1,{style:"padding-left: 5px;",src:stripURI(healthIcon)});makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Heal in:"));c="healLocation";var l=makeElement("select",jqRX6buttonId1,{id:c,"class":"jqDrop70"});for(h=0,iLength=locations.length;h<iLength;++h){i=document.createElement("option");i.value=h;if(h<cities.length)if(cities[h][CITY_CLOSED])i.style.display="none";i.appendChild(document.createTextNode(locations[h]));l.appendChild(i)}l.selectedIndex=GM_getValue("healLocation",NY);makeElement("label",jqRX6buttonId1,{title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("when health falls below "));makeElement("input",jqRX6buttonId1,{"class":"jqDrop70",type:"text",value:GM_getValue("healthLevel","50"),id:"healthLevel",size:"1"});makeElement("label",jqRX6buttonId1,{title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("points"));makeElement("br",jqRX6buttonId1,{"class":"hide"});b="Heal in NY when backgroundfighting";c="autoHealBackup";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,value:"checked"},c,"checked");makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Heal in NY when backgroundfighting"));e=makeElement("div",k);jqRX6buttonId1=makeElement("div",e,{"class":"jqRX6buttonId1"});b="Set the minimum Stamina Points Needed for Auto-Heal.";d=makeElement("label",jqRX6buttonId1,{title:b,"class":"jqSpacer"});d.appendChild(document.createTextNode("Disable Auto-Heal when Stamina falls below"));makeElement("input",jqRX6buttonId1,{"class":"jqDrop70",type:"text",value:GM_getValue("stamina_min_heal","22"),id:"stamina_min_heal",size:"3"});jqRX6buttonId1.appendChild(document.createTextNode(" points."));makeElement("br",jqRX6buttonId1,{"class":"hide"});makeElement("font",jqRX6buttonId1,{style:"font-size: 10px;color:yellow;padding-top:3px"}).appendChild(document.createTextNode("This setting determins switching from fighting to robbing when 'Fight then Rob' is chosen from the Stamina subTab."));jqRX6buttonId1=makeElement("div",e,{"class":"jqRX6buttonId1"});b="Hide in hospital ";c="hideInHospital";var m=makeElement("input",jqRX6buttonId1,{type:"checkbox",title:b,id:c,value:"checked"},c);makeElement("img",jqRX6buttonId1,{style:"padding-left: 5px;",src:stripURI(hideIcon)});b=m.checked?" Hide in hospital but...":" Hide in hospital";makeElement("label",jqRX6buttonId1,{id:"hideLabel","for":c,title:b}).appendChild(document.createTextNode(b));a=makeElement("div",jqRX6buttonId1,{style:"line-height: 135%;",id:"hideOpts"});for(h=0,iLength=healOptions.length;h<iLength;h++){c=healOptions[h][0];b=healOptions[h][1];var n=healOptions[h][2];var o=makeElement("div",a);makeElement("input",o,{type:"checkbox",id:c,title:n,value:"checked",style:"margin-left: 15px;"},c);d=makeElement("label",o,{"for":c,title:n});d.appendChild(document.createTextNode(" "+b))}a.style.display=m.checked?"":"none";var p=function(){var a=document.getElementById("hideOpts");var b=document.getElementById("hideLabel");if(!a)return false;if(this.checked){a.style.display="";b.firstChild.nodeValue=" Hide in hospital but..."}else{a.style.display="none";b.firstChild.nodeValue=" Hide in hospital"}return true};m.addEventListener("click",p,false);jqRX6buttonId1=makeElement("div",e,{"class":"jqRX6buttonId1"});c="hideAttacks";b="Enable hitlist riding: RX6 MWAP disables autoHeal after you got XP from attacks; it enables it again after parsing a snuffed message.";makeElement("input",jqRX6buttonId1,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",jqRX6buttonId1,{"for":c,title:b,"class":"jqSpacer"}).appendChild(document.createTextNode("Hitlist riding, turn off autoHeal after"));c="rideHitlistXP";b="Enter the XP you want to gain before RX6 MWAP turns off autoHeal. Enter '0' if you want RX6 MWAP to turn off autoHeal after it detected a 0 xp attack.";makeElement("input",jqRX6buttonId1,{type:"text",value:GM_getValue(c,"0"),title:b,id:c,"class":"jqDrop70"});jqRX6buttonId1.appendChild(document.createTextNode(" xp"));return j}function createCashTab(){var a,b,c,d;var e=makeElement("div",null,{id:"cashTab","class":"tabcontent",style:"height:460px;overflow-y:auto;overflow-x:hidden"});var f=makeElement("div",e,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});f.appendChild(document.createTextNode("Cash / Properties Settings:"));var g=999;var h=JSON.parse(GM_getValue("propLevels",JSON.stringify([])));var i=0;for(ctCount=0;ctCount<ctLength;ctCount++){if(cityProperties[ctCount][ctPropCity]!=g){i+=23;var j=makeElement("div",e,{style:"font-size:150%;font-weight:bold;top: "+i+"px;"});j.appendChild(document.createTextNode(cities[cityProperties[ctCount][ctPropCity]][CITY_NAME]));g=cityProperties[ctCount][ctPropCity];i+=5}b=cityProperties[ctCount][ctTitle];c=cityProperties[ctCount][ctGMId];var k=99;if(cityProperties[ctCount][ctPropType]<3){var l=h.searchArray(cityProperties[ctCount][ctPropId],0);if(l!==false)k=h[l][2]}if(k)i+=23;var j=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",j,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",j,{"for":c,title:b});d.appendChild(document.createTextNode(cityProperties[ctCount][ctText]));c=cityProperties[ctCount][ctGMId]+"Id";var a=makeElement("select",j,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityProperties[ctCount][ctArray].length;I<J;++I){var m;var n=I+1;if(cityProperties[ctCount][ctPropType]==1)n=cityProperties[ctCount][ctArray][I][3];if(n>k)m=makeElement("option",null,{value:I,title:cityProperties[ctCount][ctArray][I][2]+" - Unlocks at Level: "+n,style:"color:#FF0000;"});else m=makeElement("option",null,{value:I,title:cityProperties[ctCount][ctArray][I][2]+" - Unlocks at Level: "+n});m.appendChild(document.createTextNode(cityProperties[ctCount][ctArray][I][0]));a.appendChild(m)}a.selectedIndex=GM_getValue(c,0);a.setAttribute("title",cityProperties[ctCount][ctArray][a.selectedIndex][2]);if(!k)j.style.display="none"}i+=33;for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){i+=23;b=cityParts[ctCount][ptTitle];c=cityParts[ctCount][ptGMId];var j=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",j,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",j,{"for":c,title:b});d.appendChild(document.createTextNode(cityParts[ctCount][ptProp]));if(cityParts[ctCount][ptPropId]){c=cityParts[ctCount][ptGMId]+"Id";var a=makeElement("select",j,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityParts[ctCount][ptArray].length;I<J;++I){var m=makeElement("option",null,{value:I,title:cityParts[ctCount][ptArray][I][0]});m.appendChild(document.createTextNode(cityParts[ctCount][ptArray][I][0]));a.appendChild(m)}a.selectedIndex=GM_getValue(c,0)}}i+=23;b="Check this to Ask for Vegas Parts every 2 hours, since no MW timer available";c="askVegasParts";var o=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",o,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",o,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for Vegas Parts"));c="askVegasPartsId";var p=makeElement("select",o,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityVegasParts.length;I<J;++I){var m=makeElement("option",null,{value:I,title:cityVegasParts[I][0]});m.appendChild(document.createTextNode(cityVegasParts[I][0]));p.appendChild(m)}p.selectedIndex=GM_getValue(c,0);o.appendChild(document.createTextNode(" to upgrade "));c="askVegasPropId";var q=makeElement("select",o,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityVegasProps.length;I<J;++I){var m=makeElement("option",null,{value:cityVegasProps[I][1],title:cityVegasProps[I][0]});m.appendChild(document.createTextNode(cityVegasProps[I][0]));q.appendChild(m)}q.selectedIndex=GM_getValue(c,0);i+=23;b="Check this to Ask Friends to Play your Slots every 4 hours";c="askPlaySlots";var r=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",r,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",r,{"for":c,title:b});d.appendChild(document.createTextNode("Ask to Play your Slots"));i+=23;b="Check this to Ask for Brazil Parts every 2 hours, since no MW timer available";c="askBrazilParts";var s=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",s,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",s,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for Brazil Parts"));c="askBrazilPartsId";var t=makeElement("select",s,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityBrazilParts.length;I<J;++I){var m=makeElement("option",null,{value:I,title:cityBrazilParts[I][0]});m.appendChild(document.createTextNode(cityBrazilParts[I][0]));t.appendChild(m)}t.selectedIndex=GM_getValue(c,0);s.appendChild(document.createTextNode(" to upgrade "));c="askBrazilPropId";var u=makeElement("select",s,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityBrazilProps.length;I<J;++I){var m=makeElement("option",null,{value:cityBrazilProps[I][1],title:cityBrazilProps[I][0]});m.appendChild(document.createTextNode(cityBrazilProps[I][0]));u.appendChild(m)}u.selectedIndex=GM_getValue(c,0);i+=23;b="Check this to Ask for Chicago Parts every 2 hours, since no MW timer available";c="askChicagoParts";var v=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",v,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",v,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for Chicago Parts"));c="askChicagoPartsId";var w=makeElement("select",v,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityChicagoParts.length;I<J;++I){var m=makeElement("option",null,{value:I,title:cityChicagoParts[I][0]});m.appendChild(document.createTextNode(cityChicagoParts[I][0]));w.appendChild(m)}w.selectedIndex=GM_getValue(c,0);v.appendChild(document.createTextNode(" to upgrade "));c="askChicagoPropId";var x=makeElement("select",v,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityChicagoProps.length;I<J;++I){var m=makeElement("option",null,{value:cityChicagoProps[I][1],title:cityChicagoProps[I][0]});m.appendChild(document.createTextNode(cityChicagoProps[I][0]));x.appendChild(m)}x.selectedIndex=GM_getValue(c,0);i+=23;b="Check this to Ask for London Parts every 2 hours, since no MW timer available";c="askLondonParts";var y=makeElement("div",e,{style:"top: "+i+"px;"});makeElement("input",y,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",y,{"for":c,title:b});d.appendChild(document.createTextNode("Ask for London Parts"));c="askLondonPartsId";var z=makeElement("select",y,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityLondonParts.length;I<J;++I){var m=makeElement("option",null,{value:I,title:cityLondonParts[I][0]});m.appendChild(document.createTextNode(cityLondonParts[I][0]));z.appendChild(m)}z.selectedIndex=GM_getValue(c,0);y.appendChild(document.createTextNode(" to upgrade "));c="askLondonPropId";var A=makeElement("select",y,{id:c,style:"position: static; margin-left: 5px;"});for(I=0,J=cityLondonProps.length;I<J;++I){var m=makeElement("option",null,{value:cityLondonProps[I][1],title:cityLondonProps[I][0]});m.appendChild(document.createTextNode(cityLondonProps[I][0]));A.appendChild(m)}A.selectedIndex=GM_getValue(c,0);i=23;b="Automatically collect from properties";c="collectTake"+cities[0][CITY_NAME];var B=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",B,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",B,{"for":c,title:b});d.appendChild(document.createTextNode(" autoCollect Cash from Properties"));i+=23;b="Automatically collect in BRAZIL";c="collectTakeBrazil";var C=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",C,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",C,{"for":c,title:b});d.appendChild(document.createTextNode(" autoCollect in BRAZIL"));i+=23;b="Automatically collect in CHICAGO";c="collectTakeChicago";var D=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",D,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",D,{"for":c,title:b});d.appendChild(document.createTextNode(" autoCollect in CHICAGO"));i+=23;b="Automatically collect in LONDON";c="collectTakeLondon";var E=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",E,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",E,{"for":c,title:b});d.appendChild(document.createTextNode(" autoCollect in LONDON"));i+=23;b="Automatically collect Parts from properties";c="collectParts";var F=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",F,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",F,{"for":c,title:b});d.appendChild(document.createTextNode(" autoCollect Parts from Properties"));if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){i+=23;b="Automatically Upgrade/Collect Limited properties";c="autoLimitedParts";var G=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",G,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",G,{"for":c,title:b});d.appendChild(document.createTextNode(" autoUpgrade Limited Property"));i+=23;b="Automatically Ask/Upgrade Family properties";c="autoFamilyProperty";var H=makeElement("div",e,{style:"top: "+i+"px; left: 425px;"});makeElement("input",H,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",H,{"for":c,title:b});d.appendChild(document.createTextNode(" auto Ask/Upgrade Family Property"))}i+=69;for(var I=0,J=cities.length;I<J;++I){if((I<1||I>3)&&I!=5){c=cities[I][CITY_AUTOBANK];b="Enable "+cities[I][CITY_NAME]+" banking";var K=makeElement("div",e,{style:"top: "+i+"px; left: 425px; width: 280px; text-align: left;"});makeElement("input",K,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",K,{"for":c}).appendChild(document.createTextNode(b));makeElement("img",K,{style:"position: absolute; right: 95px; margin-top: 3px;",src:stripURI(cities[I][CITY_CASH_ICON])});c=cities[I][CITY_BANKCONFG];b="Minimum deposit amount in "+cities[I][CITY_NAME];makeElement("input",K,{type:"text",style:"position: absolute; right: 0px; width: 110px; text-align: right;",title:b,value:GM_getValue(c,"50000"),id:c,size:"5"});i+=23;if(I==4)i+=23}else{continue}}i-=92;var L=makeElement("div",e,{style:"top: "+i+"px; left: 475px;"});b="Las Vegas: disable automatic vault handling, or select the level of your vault and let RX6 MWAP handle it.";c="vaultHandling";makeElement("img",L,{src:stripURI(cashVegasIcon),style:"margin-right: 5px;"});var M=makeElement("select",L,{id:c,title:b,style:"position: static; text-align: left;"});for(I=0,J=vaultLevels.length;I<J;++I){var m=makeElement("option",null,{value:I});m.appendChild(document.createTextNode(vaultLevels[I][0]));M.appendChild(m)}M.selectedIndex=GM_getValue(c,0);i+=100;makeElement("div",e,{style:"top: "+i+"px;left: 425px; width: 150px; text-align: left;"}).appendChild(document.createTextNode("autoUpgrade New York Properties:"));i+=20;var N=makeElement("div",e,{style:"top: "+i+"px;left: 580px; width: 150px; text-align: left;"});var O=makeElement("ul",N,{style:"border: 1px solid rgb(204, 204, 204); width: 150px; height: 90px; list-style: none outside none; overflow: auto;"});for(I=0,J=autoUpgradeNYBuildings.length;I<J;I++){buildingListItem=makeElement("li",O,{style:"z-index:99999;"});c="upgradeNYProperty"+autoUpgradeNYBuildings[I][1];buildingListSelectItem=makeElement("input",buildingListItem,{type:"checkbox",id:c,value:"unchecked"},c);makeElement("label",buildingListItem,{"for":c,title:autoUpgradeNYBuildings[I][0]}).appendChild(document.createTextNode(autoUpgradeNYBuildings[I][0]))}var P=makeElement("div",e,{style:"top: "+i+"px; left: 425px; width: 150px; text-align: left;"});b="autoUpgrade NY Properties.";c="autoUpgradeNYChoice";var Q=makeElement("select",P,{id:c,title:b,style:"position: static; text-align: left;"});for(I=0,J=autoUpgradeNYChoices.length;I<J;++I){var m=document.createElement("option");m.value=I;m.appendChild(document.createTextNode(autoUpgradeNYChoices[I][0]));Q.appendChild(m)}Q.selectedIndex=GM_getValue("autoUpgradeNYChoice",0);b="Minimum NY Bank Balance";i+=25;makeElement("div",e,{style:"top: "+i+"px;left: 425px; width: 150px; text-align: left;"}).appendChild(document.createTextNode(b));i+=20;c="userMinBalance";var R=makeElement("div",e,{style:"top: "+i+"px; left: 425px; width: 150px; text-align: left;"});makeElement("input",R,{type:"text",style:"position: static; text-align: right;",title:b,value:GM_getValue(c,"100000000"),id:c,size:"15"});return e}function createCashTabNew2012(){function z(a){if(!f){a.checked=false;a.disabled=true}}function D(){var a=makeElement("div",e);b="Las Vegas: disable automatic vault handling, or select the level of your vault and let RX6 MWAP handle it.";c="vaultHandling";makeElement("img",a,{src:stripURI(cashVegasIcon),style:"margin-right: 5px;"});var d=makeElement("select",a,{id:c,title:b,style:"position: static; text-align: left;"});for(var f=0,g=vaultLevels.length;f<g;++f){var h=makeElement("option",null,{value:f});h.appendChild(document.createTextNode(vaultLevels[f][0]));d.appendChild(h)}d.selectedIndex=GM_getValue(c,0)}var a,b,c,d,e,f;var g=makeElement("div",null,{id:"cashTab","class":"tabcontent"});var h=makeElement("div",g,{"class":"jsRX6Tabs"});item=makeElement("div",h);e=makeElement("div",item,{"class":"jqRX6buttonId1",style:"width:53%;float:left"});var i=999;var j=JSON.parse(GM_getValue("propLevels",JSON.stringify([])));for(ctCount=0;ctCount<ctLength;ctCount++){if(cityProperties[ctCount][ctPropCity]!=i){makeElement("div",e,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Build from "+cities[cityProperties[ctCount][ctPropCity]][CITY_NAME]+" properties"));i=cityProperties[ctCount][ctPropCity]}b=cityProperties[ctCount][ctTitle];c=cityProperties[ctCount][ctGMId];var k=99;if(cityProperties[ctCount][ctPropType]<3){var l=j.searchArray(cityProperties[ctCount][ctPropId],0);if(l!==false)k=j[l][2]}var m=makeElement("div",e);makeElement("input",m,{type:"checkbox",id:c,value:"checked"},c);c=cityProperties[ctCount][ctGMId]+"Id";var a=makeElement("select",m,{id:c,"class":"RX6dropdown2"});d=makeElement("label",m,{"for":c,title:b,style:"width:100px"});d.appendChild(document.createTextNode(cityProperties[ctCount][ctText]));for(A=0,B=cityProperties[ctCount][ctArray].length;A<B;++A){var n;var o=A+1;if(cityProperties[ctCount][ctPropType]==1)o=cityProperties[ctCount][ctArray][A][3];if(o>k)n=makeElement("option",null,{value:A,title:cityProperties[ctCount][ctArray][A][2]+" - Unlocks at Level: "+o,style:"color:#FF0000;"});else n=makeElement("option",null,{value:A,title:cityProperties[ctCount][ctArray][A][2]+" - Unlocks at Level: "+o});n.appendChild(document.createTextNode(cityProperties[ctCount][ctArray][A][0]));a.appendChild(n)}a.selectedIndex=GM_getValue(c,0);a.setAttribute("title",cityProperties[ctCount][ctArray][a.selectedIndex][2]);if(!k)m.style.display="none"}e=makeElement("div",item,{"class":"jqRX6buttonId1",style:"width:38%;float:right"});makeElement("div",e,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Ask for City Parts"));for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){b=cityParts[ctCount][ptTitle];c=cityParts[ctCount][ptGMId];var m=makeElement("div",e);makeElement("input",m,{type:"checkbox",id:c,value:"checked"},c);if(cityParts[ctCount][ptPropId]){c=cityParts[ctCount][ptGMId]+"Id";var a=makeElement("select",m,{id:c,"class":"RX6dropdown2"});for(A=0,B=cityParts[ctCount][ptArray].length;A<B;++A){var n=makeElement("option",null,{value:A,title:cityParts[ctCount][ptArray][A][0]});n.appendChild(document.createTextNode(cityParts[ctCount][ptArray][A][0]));a.appendChild(n)}a.selectedIndex=GM_getValue(c,0)}d=makeElement("label",m,{"for":c,title:b});d.appendChild(document.createTextNode(cityParts[ctCount][ptProp]))}e=makeElement("div",item,{"class":"jqRX6buttonId1",style:"width:38%;float:right"});makeElement("div",e,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Auto Collect Cash Takes"));var p=new Array(["collectTakeNew York","Automatically collect from properties"," Auto Collect Cash in New York"],["collectTakeBrazil","Automatically collect in BRAZIL"," Auto Collect in BRAZIL"],["collectTakeChicago","Automatically collect in CHICAGO","Auto Collect in CHICAGO"],["collectTakeLondon","Automatically collect in LONDON","Auto Collect in LONDON"],["collectParts","Automatically collect Parts from properties","Auto Collect Parts from Properties"]);for(A=0;A<p.length;A++){var q=p[A];var r=makeElement("div",e);makeElement("input",r,{type:"checkbox",id:q[0],value:"checked"},q[0]);d=makeElement("label",r,{"for":q[0],title:q[1]});d.appendChild(document.createTextNode(q[2]))}e=makeElement("div",item,{"class":"jqRX6buttonId1",style:"width:38%;float:right"});makeElement("div",e,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Auto Upgrade New York / Family Props"));var s=makeElement("div",e);var t=makeElement("ul",s,{style:"border: 1px solid rgb(204, 204, 204); width: 150px; height: 90px; list-style: none outside none; overflow: auto;"});for(A=0,B=autoUpgradeNYBuildings.length;A<B;A++){buildingListItem=makeElement("li",t,{style:"z-index:99999;"});c="upgradeNYProperty"+autoUpgradeNYBuildings[A][1];buildingListSelectItem=makeElement("input",buildingListItem,{type:"checkbox",id:c,value:"unchecked"},c);makeElement("label",buildingListItem,{"for":c,title:autoUpgradeNYBuildings[A][0]}).appendChild(document.createTextNode(autoUpgradeNYBuildings[A][0]))}var u=makeElement("div",e);b="autoUpgrade NY Properties.";c="autoUpgradeNYChoice";var v=makeElement("select",u,{id:c,title:b,"class":"RX6dropdown2"});for(A=0,B=autoUpgradeNYChoices.length;A<B;++A){var n=document.createElement("option");n.value=A;n.appendChild(document.createTextNode(autoUpgradeNYChoices[A][0]));v.appendChild(n)}v.selectedIndex=GM_getValue("autoUpgradeNYChoice",0);b="Minimum NY Bank Balance";makeElement("div",e).appendChild(document.createTextNode(b));c="userMinBalance";var w=makeElement("div",e);makeElement("input",w,{type:"text",style:"position: static; text-align: right;",title:b,value:GM_getValue(c,"100000000"),id:c,size:"15"});makeElement("br",e,{"class":"hide"});if(GM_getValue("readValueSum",returnValue())==parseXMLResponse())f=true;if(!f){b="RX6 PRO FEATURE Only";makeElement("div",e).appendChild(document.createTextNode(b))}b="Automatically Upgrade/Collect Limited properties";c="autoLimitedParts";var x=makeElement("div",e);a=makeElement("input",x,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",x,{"for":c,title:b});d.appendChild(document.createTextNode(" Auto Upgrade Limited Property"));z(a);b="Automatically Ask/Upgrade Family properties";c="autoFamilyProperty";var y=makeElement("div",e);a=makeElement("input",y,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",y,{"for":c,title:b});d.appendChild(document.createTextNode(" Auto Ask/Upgrade Family Property"));z(a);e=makeElement("div",item,{"class":"jqRX6buttonId1",style:"width:38%;float:right;padding-top:13px;padding-bottom:32px"});makeElement("div",e,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Auto Bank in Cites"));for(var A=0,B=cities.length;A<B;++A){if((A<1||A>3)&&A!=5){c=cities[A][CITY_AUTOBANK];b="Enable "+cities[A][CITY_NAME]+" banking";var C=makeElement("div",e);makeElement("input",C,{type:"checkbox",id:c,value:"checked"},c);c=cities[A][CITY_BANKCONFG];b="Min Dep in "+cities[A][CITY_NAME];makeElement("input",C,{type:"text",title:b,style:"width:100px",value:GM_getValue(c,"50000"),id:c,size:"5"});makeElement("img",C,{style:"margin:1px 5px 0px 3px",src:stripURI(cities[A][CITY_CASH_ICON])});makeElement("label",C,{"for":c}).appendChild(document.createTextNode(b));if(A==4){D()}}else{continue}}e=makeElement("div",item,{"class":"jqRX6buttonId1",style:"width:53%;float:left"});makeElement("div",e,{"class":"jsRX6BoxHeading"}).appendChild(document.createTextNode("Ask for Parts"));b="Check this to Ask Friends to Play your Slots every 4 hours";c="askPlaySlots";var E=makeElement("div",e);makeElement("input",E,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",E,{"for":c,title:b});d.appendChild(document.createTextNode("Ask to Play your Slots"));b="Check this to Ask for Vegas Parts every 2 hours, since no MW timer available";c="askVegasParts";var F=makeElement("div",e);makeElement("input",F,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",F,{"for":c,title:b});d.appendChild(document.createTextNode("Vegas Parts"));c="askVegasPartsId";var G=makeElement("select",F,{id:c,"class":"RX6dropdown2",style:"width:105px;margin-left:16px"});for(A=0,B=cityVegasParts.length;A<B;++A){var n=makeElement("option",null,{value:A,title:cityVegasParts[A][0]});n.appendChild(document.createTextNode(cityVegasParts[A][0]));G.appendChild(n)}G.selectedIndex=GM_getValue(c,0);F.appendChild(document.createTextNode("to upgrade "));c="askVegasPropId";var H=makeElement("select",F,{id:c,"class":"RX6dropdown2",style:"width:105px"});for(A=0,B=cityVegasProps.length;A<B;++A){var n=makeElement("option",null,{value:cityVegasProps[A][1],title:cityVegasProps[A][0]});n.appendChild(document.createTextNode(cityVegasProps[A][0]));H.appendChild(n)}H.selectedIndex=GM_getValue(c,0);b="Check this to Ask for Brazil Parts every 2 hours, since no MW timer available";c="askBrazilParts";var I=makeElement("div",e);makeElement("input",I,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",I,{"for":c,title:b});d.appendChild(document.createTextNode("Brazil Parts"));c="askBrazilPartsId";var J=makeElement("select",I,{id:c,"class":"RX6dropdown2",style:"width:105px;margin-left:20px"});for(A=0,B=cityBrazilParts.length;A<B;++A){var n=makeElement("option",null,{value:A,title:cityBrazilParts[A][0]});n.appendChild(document.createTextNode(cityBrazilParts[A][0]));J.appendChild(n)}J.selectedIndex=GM_getValue(c,0);I.appendChild(document.createTextNode("to upgrade "));c="askBrazilPropId";var K=makeElement("select",I,{id:c,"class":"RX6dropdown2",style:"width:105px"});for(A=0,B=cityBrazilProps.length;A<B;++A){var n=makeElement("option",null,{value:cityBrazilProps[A][1],title:cityBrazilProps[A][0]});n.appendChild(document.createTextNode(cityBrazilProps[A][0]));K.appendChild(n)}K.selectedIndex=GM_getValue(c,0);b="Check this to Ask for Chicago Parts every 2 hours, since no MW timer available";c="askChicagoParts";var L=makeElement("div",e);makeElement("input",L,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",L,{"for":c,title:b});d.appendChild(document.createTextNode("Chicago Parts"));c="askChicagoPartsId";var M=makeElement("select",L,{id:c,"class":"RX6dropdown2",style:"width:105px;margin-left:6px"});for(A=0,B=cityChicagoParts.length;A<B;++A){var n=makeElement("option",null,{value:A,title:cityChicagoParts[A][0]});n.appendChild(document.createTextNode(cityChicagoParts[A][0]));M.appendChild(n)}M.selectedIndex=GM_getValue(c,0);L.appendChild(document.createTextNode("to upgrade "));c="askChicagoPropId";var N=makeElement("select",L,{id:c,"class":"RX6dropdown2",style:"width:105px"});for(A=0,B=cityChicagoProps.length;A<B;++A){var n=makeElement("option",null,{value:cityChicagoProps[A][1],title:cityChicagoProps[A][0]});n.appendChild(document.createTextNode(cityChicagoProps[A][0]));N.appendChild(n)}N.selectedIndex=GM_getValue(c,0);b="Check this to Ask for London Parts every 2 hours, since no MW timer available";c="askLondonParts";var O=makeElement("div",e);makeElement("input",O,{type:"checkbox",id:c,value:"checked"},c);d=makeElement("label",O,{"for":c,title:b});d.appendChild(document.createTextNode("London Parts"));c="askLondonPartsId";var P=makeElement("select",O,{id:c,"class":"RX6dropdown2",style:"width:105px;margin-left:8px"});for(A=0,B=cityLondonParts.length;A<B;++A){var n=makeElement("option",null,{value:A,title:cityLondonParts[A][0]});n.appendChild(document.createTextNode(cityLondonParts[A][0]));P.appendChild(n)}P.selectedIndex=GM_getValue(c,0);O.appendChild(document.createTextNode("to upgrade "));c="askLondonPropId";var Q=makeElement("select",O,{id:c,"class":"RX6dropdown2",style:"width:105px"});for(A=0,B=cityLondonProps.length;A<B;++A){var n=makeElement("option",null,{value:cityLondonProps[A][1],title:cityLondonProps[A][0]});n.appendChild(document.createTextNode(cityLondonProps[A][0]));Q.appendChild(n)}Q.selectedIndex=GM_getValue(c,0);return g}function createAboutTab(){var a,b,c,d;var e=makeElement("div",null,{id:"aboutTab","class":"tabcontent"});var f=makeElement("div",e,{style:"width:762px;height:20px;border:none #FFFFFF;float:left;font-size: 18px; font-weight: bold;"});f.appendChild(document.createTextNode("Version RX6 "+SCRIPT.version));var g=makeElement("div",e,{style:"top: 50px; width: 550px; left: 10px; font-size: 12px; font-weight: bold;"});g.appendChild(document.createTextNode("Contributors:"));makeElement("br",g);var h="RX6 MWAP Development Team";devList=makeElement("p",g,{style:"position: relative; left: 15px;"});devList.appendChild(document.createTextNode(h));item=makeElement("div",e,{style:"border:1px solid #999999; padding: 2px 2px 2px 2px; overflow: "+"auto; width: 530px; height: 120px; top: 160px; left: 30px; "+"font-size: 10px;"});item.innerHTML='<span class="good">Release changes:</span> <br><br>'+GM_getValue("newRevList")+"<br>"+'<span class="bad">Previous changes:</span> <br><br>'+GM_getValue("oldRevList");item.innerHTML="Please refer to mwap.me.uk for current update information.<br><br><br>RX6 MWAP Team";var i=makeElement("div",e,{style:"top: 350px; left: 10px; font-size: 12px;"});c="TestChanges";b="Enable Script Modifications In Testing Phase";makeElement("input",i,{type:"checkbox",id:c,value:"checked"},c);makeElement("label",i,{"for":c,title:b}).appendChild(document.createTextNode("BETA TESTING ONLY : VERBOSITY ALERT - USE AT OWN RISK !"));return e}function grabToolbarInfo(a){var b=function(){var a=function(a){window.open(a,"toolbar","resizable=yes,scrollbars=yes,status=yes")};window.setTimeout(function(){a("http://toolbar.zynga.com/game_iframe_proxy.php?playing=true")},1e3);window.setTimeout(function(){a("http://toolbar.zynga.com/game_iframe_proxy.php")},5e3)};if(!gvar.isGreaseMonkey){if(a&&window.confirm("Can't retrieve Toolbar info with this browser.\n\n"+"In case the miniPack doesn't work here at all,\nyou could let MWAP create the necessary cookies for you.\nPS: For this to work, "+"you need to allow popups in your browser, and wait for ca. 10 secs before closing the popup (after confirming this dialog).")){b()}return}GM_xmlhttpRequest({method:"GET",url:"http://toolbar.zynga.com/game_stats_proxy.php?src=mw",headers:{Accept:"application/atom+xml"},onload:function(a){if(a.status!=200)return;var c=JSON.parse(a.responseText);DEBUG("Toolbar response: "+a.responseText);if(!c||c.error){if(window.confirm("Error retrieving Toolbar info, probably because its the first time you are trying to fire the miniPack in this browser/-profile.\n\n"+"Do you want MWAP to create the necessary cookies for you? If not, you have to install the Zynga Toolbar.\nPS: For this to work, "+"you need to allow popups in your browser, and wait for ca. 10 secs before closing the popup (after confirming this dialog).")){b()}return}var d=new Date;var e=8;d.setMilliseconds(0);var f=c.toolbar_energy_timestamp-d.getTime()/1e3+3600*e;setGMTime("miniPackTimer",f+" seconds");return}})}function grabUpdateInfo(){if(!gvar.isGreaseMonkey)return;GM_setValue("newRevList","");GM_setValue("oldRevList","");return}function validateStaminaTab(){var a,b;var c=function(a){return document.getElementById(a).checked===true?"checked":0};var d={};d.staminaSpend=c("staminaSpend");d.staminaSpendHow=document.getElementById("staminaSpendHow").selectedIndex;d.staminaLogDetails=c("staminaLogDetails");var e=parseInt(document.getElementById("selectStaminaUse").value);if(isNaN(e))e=0;d.selectStaminaUse=e;d.selectStaminaUseMode=document.getElementById("selectStaminaUseMode").selectedIndex;var f=parseInt(document.getElementById("selectStaminaKeep").value);if(isNaN(f))f=0;d.selectStaminaKeep=f;d.selectStaminaKeepMode=document.getElementById("selectStaminaKeepMode").selectedIndex;var g=parseInt(document.getElementById("selectMissionStaminaKeep").value);if(isNaN(g))g=0;d.selectMissionStaminaKeep=g;d.selectMissionStaminaKeepMode=document.getElementById("selectMissionStaminaKeepMode").selectedIndex;d.allowStaminaToLevelUp=c("allowStaminaToLevelUp");if(isNaN(d.selectStaminaUse)||isNaN(d.selectStaminaKeep)||isNaN(d.selectMissionStaminaKeep)){alert("Please enter numeric values for Stamina reserve and Stamina threshold.");return false}switch(d.staminaSpendHow){case STAMINA_HOW_ROBFIGHT:d.robFightStaminaFloor=parseInt(document.getElementById("robFightStaminaFloor").value);if(isNaN(d.robFightStaminaFloor)){alert("Please enter the threshold for switching from robbing to fighting.");return false}else if(d.robFightStaminaFloor<25||d.robFightStaminaFloor>maxStamina){alert("Please enter a stamina between 25 and "+maxStamina);return false};case STAMINA_HOW_FIGHTROB:d.robLocation=document.getElementById("robLocation").selectedIndex;d.fastRob=c("fastRob");d.fastRobSpeed=document.getElementById("fastRobSpeed").selectedIndex;d.useRobSquads=c("useRobSquads");d.useBurners=c("useBurners");case STAMINA_HOW_FIGHT_RANDOM:case STAMINA_HOW_FIGHT_BG:d.fightLocation=document.getElementById("fightRandomLoc").selectedIndex;d.reattackThreshold=parseInt(document.getElementById("reattackThreshold").value);d.iceCheck=c("iceCheck");d.staminaPowerattack=c("staminaPowerattack");if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){d.fastBGFSpeed=document.getElementById("fastBGFSpeed").selectedIndex;d.fightFallback=c("fightFallback")}d.fightLevelMax=parseInt(document.getElementById("fightLevelMax").value);d.fightLevelMaxRelative=c("fightLevelMaxRelative");d.fightMafiaMax=parseInt(document.getElementById("fightMafiaMax").value);d.fightMafiaMaxRelative=c("fightMafiaMaxRelative");d.fightMafiaMin=parseInt(document.getElementById("fightMafiaMin").value);d.fightMafiaMinRelative=c("fightMafiaMinRelative");if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){d.fightHealthMax=parseInt(document.getElementById("fightHealthMax").value);d.fightHealthPctMax=parseInt(document.getElementById("fightHealthPctMax").value)}else{d.fightHealthMax=0;d.fightHealthPctMax=0}d.fightMobMode=c("fightMobMode");d.fightIceStealers=c("fightIceStealers");d.fightNames=c("fightNames");d.fightAvoidNames=c("fightAvoidNames");d.fightOnlyNames=c("fightOnlyNames");d.fightClanName=document.getElementById("fightClanName").value;d.fightRemoveStronger=c("fightRemoveStronger");if(document.getElementById("fightRivalsMode"))d.fightRivalsMode=document.getElementById("fightRivalsMode").selectedIndex;if(document.getElementById("useFightBoosts"))d.useFightBoosts=document.getElementById("useFightBoosts").selectedIndex;if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){d.fightMaxAttacks=parseInt(document.getElementById("fightMaxAttacks").value)}else{d.fightMaxAttacks=0}if(document.getElementById("fightLabelCriteria"))d.fightLabelCriteria=document.getElementById("fightLabelCriteria").selectedIndex;if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){if(isNaN(d.fightMaxAttacks)){alert("Please enter the threshold for maximum # attacks per opponent.");return false}else if(d.fightMaxAttacks<0){alert("Please enter a maximum # attacks per opponent threshold of zero or more.");return false}}if(isNaN(d.reattackThreshold)){alert("Please enter the threshold for reattacking opponents.");return false}else if(d.reattackThreshold<0){alert("Please enter a reattack threshold of zero or more.");return false}if(isNaN(d.fightLevelMax)){alert("Please enter a maximum level for fighting.");return false}else if(d.fightLevelMaxRelative&&d.fightLevelMax<0){alert("Please enter a maximum relative level of zero or more.");return false}else if(!d.fightLevelMaxRelative&&d.fightLevelMax<level){d.fightLevelMax=parseInt(level*.9);addToLog("warning Icon","Maximum level for fighting is set to "+d.fightLevelMax+" (90% of your current level:"+level+".")}if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){if(isNaN(d.fightHealthMax)){alert("Please enter a maximum oppononent health for fighting.");return false}else if(d.fightHealthMax<0){alert("Please enter a maximum oppononent health for fighting of zero or more.");return false}if(isNaN(d.fightHealthPctMax)){alert("Please enter a maximum oppononent health for fighting.");return false}else if(d.fightHealthPctMax<0){alert("Please enter a maximum oppononent health for fighting of zero or more.");return false}}if(isNaN(d.fightMafiaMax)){alert("Please enter a maximum mafia size for fighting.");return false}else if(!d.fightMafiaMaxRelative&&d.fightMafiaMax<1){alert("Please enter a maximum mafia size of one or more for fighting.");return false}else if(d.fightMafiaMaxRelative&&d.fightMafiaMax+mafia<1){alert("Please enter a larger relative mafia size for fighting.");return false}if(isNaN(d.fightMafiaMin)){alert("Please enter a minimum mafia size for fighting.");return false}else if(!d.fightMafiaMinRelative&&d.fightMafiaMin<1){alert("Please enter a minimum mafia size of one or more for fighting.");return false}else if(d.fightMafiaMinRelative&&mafia-d.fightMafiaMin<1){alert("Please enter a smaller relative mafia size for fighting.");return false}if(d.fightNames=="checked"){var h=d.fightClanName.split("\n");if(!h[0]){alert("Enter at least one clan name/symbol in the list");return false}}break;case STAMINA_HOW_FIGHT_LIST:case STAMINA_HOW_FIGHT_LIST_BG:d.fightLocation=document.getElementById("fightListLoc").selectedIndex;d.reattackThresholdList=parseInt(document.getElementById("reattackThresholdList").value);d.iceCheck=c("iceCheck");d.staminaPowerattack=c("staminaPowerattack");d.pfightlist=document.getElementById("pfightlist").value;d.fightRemoveStronger=document.getElementById("fightRemoveStronger").checked===true?"checked":0;if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){d.fightFallback=document.getElementById("fightFallback").checked===true?"checked":0}if(isNaN(d.reattackThresholdList))alert("Please enter the threshold for reattacking opponents.");else if(d.reattackThresholdList<0)alert("Please enter a reattack threshold of zero or more.");var h=d.pfightlist.split("\n");if(!h[0]){alert("Enter the Facebook ID of at least one opponent to fight.");return false}break;case STAMINA_HOW_HITMAN:d.hitmanLocation=document.getElementById("hitmanLocation").selectedIndex;d.hitmanBountyMin=document.getElementById("hitmanBountyMin").value;d.bountySelection=document.getElementById("bountySelection").selectedIndex;d.hitmanNames=c("hitmanNames");d.hitmanAvoidNames=c("hitmanAvoidNames");d.hitmanOnlyNames=c("hitmanOnlyNames");d.hitmanClanName=document.getElementById("hitmanClanName").value;d.fightRemoveStronger=c("fightRemoveStronger");if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){d.fightFallback=c("fightFallback")}var i=parseCash(d.hitmanBountyMin);if(isNaN(i)||i<0){alert("Please enter a minimum bounty amount.");return false}if(d.hitmanNames=="checked"){var h=d.hitmanClanName.split("\n");if(!h[0]){alert("Enter at least one clan name/symbol in the list");return false}}break;case STAMINA_HOW_ROBBING:case STAMINA_HOW_ROBBING_BG:d.robLocation=document.getElementById("robLocation").selectedIndex;d.fastRob=c("fastRob");d.fastRobSpeed=document.getElementById("fastRobSpeed").selectedIndex;d.useRobSquads=c("useRobSquads");d.useBurners=c("useBurners");break;case STAMINA_HOW_AUTOHITLIST:d.autoHitListLoc=document.getElementById("autoHitListLoc").selectedIndex;d.autoHitListBounty=document.getElementById("autoHitListBounty").value;d.autoHitListRandom=c("autoHitListRandom");d.pautoHitOpponentList=document.getElementById("pautoHitOpponentList").value;d.bgAutoHitCheck=c("bgAutoHitCheck");var i=parseCash(d.autoHitListBounty);if(isNaN(i)||i<1e4&&!d.autoHitListRandom){alert("Please enter a minimum bounty amount of at least $10,000");return false}var h=d.pautoHitOpponentList.split("\n");if(!h[0]){alert("Enter the Facebook ID of at least one opponent to hitlist.");return false}break;case STAMINA_HOW_RANDOM:var j="";var k=document.getElementsByName("randomSpendModes[]");for(var l=0;l<k.length;++l){if(k[l].checked)j+="1";else j+="0"}if(!parseInt(j))j="1"+j.substr(1);d.randomSpendModes=j;var m="";var n=document.getElementsByName("randomFightLocations[]");for(var l=0;l<n.length;++l){if(n[l].checked)m+="1";else m+="0"}if(!parseInt(m))m="1"+m.substr(1);d.randomFightLocations=m;m="";n=document.getElementsByName("randomRobLocations[]");for(var l=0;l<n.length;++l){if(n[l].checked)m+="1";else m+="0"}if(!parseInt(m))m="1"+m.substr(1);d.randomRobLocations=m;m="";n=document.getElementsByName("randomHitmanLocations[]");for(var l=0;l<n.length;++l){if(n[l].checked)m+="1";else m+="0"}if(!parseInt(m))m="1"+m.substr(1);d.randomHitmanLocations=m;break;default:colorDEBUG("BUG DETECTED: Unrecognized stamina setting here: staminaSpendHow="+d.staminaSpendHow,cre);break}return d}function clickAutoPause(){if(this.checked){if(document.getElementById("autoPauseBefore").checked===false&&document.getElementById("autoPauseAfter").checked===false){document.getElementById("autoPauseBefore").checked=true}}}function clickUseFightNames(){if(this.checked){if(document.getElementById("fightAvoidNames").checked===false&&document.getElementById("fightOnlyNames").checked===false){document.getElementById("fightAvoidNames").checked=true}}}function clickUseHitmanNames(){if(this.checked){if(document.getElementById("hitmanAvoidNames").checked===false&&document.getElementById("hitmanOnlyNames").checked===false){document.getElementById("hitmanAvoidNames").checked=true}}}function handleUnexpectedPage(){DEBUG("Unexpected page.");var a=document.getElementById("try_again_button");if(a){var b=10;var c=document.createElement("p");var d=function(){if(!b)return a.click();c.innerHTML="RX6 MWAP will automatically try again in "+b-- +" seconds.";window.setTimeout(d,1e3);return false};DEBUG('Service interruption: "Try Again" button seen.');a.parentNode.appendChild(document.createElement("br"));a.parentNode.appendChild(c);d();return}var e=xpathFirst('//a[contains(., "Skip")]');if(e){Autoplay.fx=function(){clickElement(e)};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return}Autoplay.fx=function(){if(!document.body)DEBUG("No body. Possible redirect, white out or slow load?");else DEBUG("Can't read page. Possible white out?");goHome()};Autoplay.delay=5e3;Autoplay.start()}function handleModificationTimer(a){function b(a){if(a&&a.length>0&&!onProfileNav()){for(var b=0,c=a.length;b<c;++b){if(a[b].scrollWidth&&a[b].innerHTML.length>0){d=true;break}}}}try{if(ajaxHandling){colorDEBUG("waiting for ajax repsonse",cli);if(ajaxCount++>10){ajaxHandling=false;ajaxCount=0}return}if(new_header)var c=xpathFirst('//div[@class="header_top_row"]');else var c=xpathFirst('//div[contains(@id,"mw_masthead")]');if(!c||!c.scrollWidth||!refreshGlobalStats()){handleUnexpectedPage();return}refreshSettings();synchSettings();var d=false;var e=false;var f=innerPageElt;innerPageElt=document.getElementById("inner_page");if(!innerPageElt)return;appLayoutElt=document.getElementById("mw_city_wrapper");statsrowElt=document.getElementById("stats_row");menubarElt=document.getElementById("menubar");popupfodderElt=document.getElementById("popup_fodder");questBarElt=document.getElementById("quest");contentRoweElt=document.getElementById("content_row");if(!xpathFirst('./div[@id="inner_flag"]',innerPageElt)){setListenContent(false);makeElement("div",innerPageElt,{id:"inner_flag",style:"display: none;"});setListenContent(true);d=true}else if(f!=innerPageElt)d=true;var g=xpathFirst('.//div[@id="brazil_jobs"]',innerPageElt);if(g){currentBrazilDistrict=getCurrentBrazilDistrict();if(currentBrazilDistrict!=oldBrazilDistrict){oldBrazilDistrict=currentBrazilDistrict;d=true}if(currentBrazilDistrict){var h=xpathFirst('.//div[@id="brazil_district_'+currentBrazilDistrict+'"]//div[@class="jobs"]//div[@class="job" and contains (@style,"fff")]//div[@class="mastery_bar"]',innerPageElt);if(!h)h=xpathFirst('.//div[@id="brazil_district_'+currentBrazilDistrict+'"]//div[contains(@id,"job-id")]//div[@class="job" and contains (@style,"fff")]//div[@class="mastery_bar"]',innerPageElt);if(!h)h=xpathFirst('.//div[@id="brazil_district_'+currentBrazilDistrict+'"]//div[@class="jobs"]//div[@class="job" and contains (@style,"255")]//div[@class="mastery_bar"]',innerPageElt);if(!h)h=xpathFirst('.//div[@id="brazil_district_'+currentBrazilDistrict+'"]//div[contains(@id,"job-id")]//div[@class="job" and contains (@style,"255")]//div[@class="mastery_bar"]',innerPageElt);if(h){var i=false;var j=previousBrazilJobMastery;if(h.innerHTML.untag().match(/(\d+)%/i))j=parseInt(RegExp.$1);if(previousBrazilJob!=h){previousBrazilJob=h;previousBrazilJobMastery=0;i=true}if(j!=previousBrazilJobMastery){previousBrazilJobMastery=j;i=true}if(i){var k=xpathFirst('.//div[@id="job_flag"]',h);if(!k){setListenContent(false);makeElement("div",h,{id:"job_flag",style:"display: none;"});setListenContent(true)}d=true}}}}var l=xpathFirst('.//div[@id="new_user_jobs"]//div[@class="job_results"]',innerPageElt);if(l){if(!xpathFirst('.//div[@id="job_flag"]',l)){setListenContent(false);makeElement("div",l,{id:"job_flag",style:"display: none;"});setListenContent(true);d=true}}var m=xpathFirst('.//div[@id="job_paths"]//div[contains(@class, "path_on")]',innerPageElt);if(m){if(!xpathFirst('.//div[@id="job_path_flag"]',m)){setListenContent(false);makeElement("div",m,{id:"job_path_flag",style:"display: none;"});setListenContent(true);d=true}}var n=$x('.//div[@id="map_panels"]/div[@id="side_container"]//div[@class="job_results"]',innerPageElt);if(n&&n.length>0){for(var o=0,p=n.length;o<p;++o){if(n[o]&&!xpathFirst('./div[@id="job_flag"]',n[o])){setListenContent(false);makeElement("div",n[o],{id:"job_flag",style:"display: none;"});setListenContent(true);d=true}}}var q=xpathFirst('.//div[@class="task_results"]',innerPageElt);if(q){if(q&&!xpathFirst('./div[@id="task_flag"]',q)){setListenContent(false);makeElement("div",q,{id:"task_flag",style:"display: none;"});setListenContent(true);d=true}}var r=xpathFirst('.//a[@id="rob_refresh_cost"]',innerPageElt);if(r){if(!xpathFirst('.//div[@id="rob_flag"]',r)){setListenContent(false);makeElement("div",r,{id:"rob_flag",style:"display: none;"});setListenContent(true);d=true;if(running)e=true}}var s=$x('.//div[contains(@id, "pop_b") and not(contains(@style, "none"))]',popupfodderElt);showPopups(s);var s=$x('.//div[@class="fight_true_popup"]//div[contains(@id, "pop_b") and not(contains(@style, "none"))]',innerPageElt);showPopups(s);var s=$x('.//div[contains(@id, "pop_b") and contains(@style, "block")]',popupfodderElt);b(s);var s=$x('.//div[@class="fight_true_popup"]//div[contains(@id, "pop_b") and contains(@style, "block")]',innerPageElt);b(s);if(d){if(!running)postSize();try{innerPageChanged(e)}catch(t){DEBUG("BUG DETECTED (pageChanged): "+t)}}else{if(running&&a&&(a.className=="cur_cash"||a.parentNode&&a.parentNode.className=="cur_cash"))doQuickBank()}}catch(u){colorDEBUG("ModTimeError: "+u,cre)}}function setModificationTimer(a){if(modificationTimer)window.clearTimeout(modificationTimer);modificationTimer=window.setTimeout(function(){handleModificationTimer(a)},400)}function handleContentModified(a){if(ignoreElement(a.target))return;setModificationTimer(a.target)}function handleRequests(){var a=xpathFirst('.//div[@class="freegift_title"]');if(!a)a=xpathFirst('.//div[contains(.,"crew requests"]');try{if(GM_getValue("isRunning")){if(inRequests)return;var b=$x('.//div[@class="mfs_selectable"]//li[@class="mfs_add" and not(contains(@style,"none"))]');var c=xpathFirst('.//div[@id="mfs_tab_12" and contains(@class,"inactive")]');var d=xpathFirst('.//div[@id="mfs_tab_2" and contains(@class,"inactive")]');var e=xpathFirst('.//div[@id="mfs_tab_3" and contains(@class,"inactive")]');if(b.length==0||!e||b.length<21&&d){a.innerHTML="going to open mfs_tab_2 for more mafia members";clickElement(d)}a.innerHTML="we are on mfs_tab_2 - selecting mafia";var f=xpathFirst('.//a[@class="sexy_button_new medium orange" and contains(@onclick,"MW.Request.submitMFS") and contains(.,"SEND REQUESTS")]');b=$x('.//div[@class="mfs_selectable"]//li[@class="mfs_add" and not(contains(@style,"none"))]');if(b.length>0&&f&&!inRequests){inRequests=true;a.innerHTML+="<br>mafia members and request button found";var g=xpathFirst('.//a[@id="selectMaxButton" and not (contains(@class,"disabled"))]');if(g){a.innerHTML+="<br>randombutton found and clicked";clickElement(g)}else{a.innerHTML+="<br>randombutton not found clicking single mafia";var h=b.length>50?50:b.length;for(i=0;i<h;i++)clickElement(b[i])}a.innerHTML+="<br>mafia selected clicking requestbutton";clickElement(f);setGMTime("requestTimer","00:30")}else{a.innerHTML+="<br>no mafia selected - closing popup";inRequests=false;setGMTime("requestTimer","00:05");setGMTime("autoFreeGiftTimer","1 hour");if(typeof unsafeWindow.close_suggestor_iframe=="function")unsafeWindow.close_suggestor_iframe()}}else{}}catch(j){a.innerHTML="Requests error: "+j}window.setTimeout(handleRequests,2500)}function handlePublishing(){fetchPubOptions();if(GM_getValue("isRunning")){try{var a=xpathFirst('//input[@type="submit" and @name="cancel"]');var b=xpathFirst('//input[@type="submit" and @name="publish"]');var c=xpathFirst('//input[@type="submit" and @name="ok"]');var d=xpathFirst('//input[@type="submit" and @name="ok_clicked"]');var e=xpathFirst('//a[@class="fb_dialog_close_icon"]');if(d)clickElement(d);else if(c)clickElement(c);else if(!b||!timeLeftGM("postTimer")){if(a)clickElement(a);else if(e)clickElement(e)}if(a&&b){if(isGMChecked("autoGlobalPublishing")){clickElement(b);window.setTimeout(handlePublishing,2500);return true}else{clickElement(a);window.setTimeout(handlePublishing,2500);return true}}}catch(f){DEBUG("Publishing error: "+f)}}DEBUG("Publish: Try again in 2.5 seconds.");window.setTimeout(handlePublishing,2500)}function setListenContent(a){var b=document.getElementById("inner_page");if(!b)return;if(a)b.addEventListener("DOMSubtreeModified",handleContentModified,false);else b.removeEventListener("DOMSubtreeModified",handleContentModified,false)}function setListenStats(a){var b=document.getElementById("game_stats");if(!b)return;if(a)b.addEventListener("DOMNodeInserted",statsInserted,false);else b.removeEventListener("DOMNodeInserted",statsInserted,false)}function statsInserted(a){if(ignoreElement(a.target))return;var b=a.target.parentNode;if(!b)return;if(b==energyElt){energy=parseInt(a.target.nodeValue);energyElt.style.textDecoration=energy==maxEnergy?"blink":"none"}else if(b==staminaElt){stamina=parseInt(a.target.nodeValue);staminaElt.style.textDecoration=stamina==maxStamina?"blink":"none"}else if(b==healthElt){health=parseInt(a.target.nodeValue);health=health<0?0:health;healthElt.style.textDecoration=health>19&&health<29?"blink":"none"}}function doQuickBank(){var a=isGMChecked(cities[city][CITY_AUTOBANK])&&!suspendBank&&!quickBankFail&&cities[city][CITY_CASH]>=GM_getIntValue(cities[city][CITY_BANKCONFG]);if(a&&!isNaN(city)&&!isNaN(cities[city][CITY_CASH]))quickBank(city,cities[city][CITY_CASH])}function innerPageChanged(a){autoReload(false,"innerpagechanged");doParseMessages();customizeBanner();mwapRX6Popup();getPlayerEquip();if(running){doQuickBank();doQuickClicks();if(questBarElt){var b=xpathFirst('.//div[contains(@class, "userInClanBattleShow") and not (contains(@style,"none"))]');if(b)inClanBattle=true;else inClanBattle=false;if(inClanBattle&&!inSafehouse&&isGMChecked("AutoBattleSafehouse")){inSafehouse=true;battleLoad()}}}if(!running||!a){postSize();setListenContent(false);customizeMasthead();customizeStats();if(!customizeProps()&&!customizeHome()&&!customizeJobs()&&!customizeProfile())customizeFightLists();setListenContent(true)}try{if(clickAction){var c=clickAction;var d=clickContext;clickAction=undefined;clickContext=undefined;if(!logResponse(innerPageElt,c,d)){doAutoPlay()}}else{doAutoPlay()}}catch(e){addToLog("warning Icon","BUG DETECTED (doAutoPlay): "+e+". Reloading.");autoReload(true,"error")}}function closeFBPopup(){if(!running)return;var a=document.getElementById("fb_dialog_cancel_button");if(a)clickElement(a)}function refreshGlobalStats(){var a=document.getElementById("mw_city_wrapper");if(!a)return false;if(a.className.match(/mw_city(\d+)/))city=parseInt(a.className.replace("mw_city",""))-1;else city=NY;var b=document.getElementById("fb_dialog_cancel_button");if(running&&b)window.setTimeout(closeFBPopup,4e3);cashElt=document.getElementById("user_cash_"+cities[city][CITY_ALIAS]);healthElt=document.getElementById("user_health");maxHealthElt=document.getElementById("user_max_health");energyElt=document.getElementById("user_energy");maxEnergyElt=document.getElementById("user_max_energy");staminaElt=document.getElementById("user_stamina");maxStaminaElt=document.getElementById("user_max_stamina");levelElt=document.getElementById("user_level");level=parseInt(levelElt.innerHTML);cities[city][CITY_CASH]=parseInt(unsafeWindow.User.cash);health=parseInt(unsafeWindow.User.health);health=health<0?0:health;maxHealth=parseInt(unsafeWindow.User.max_health);energy=parseInt(unsafeWindow.User.energy);maxEnergy=parseInt(unsafeWindow.User.max_energy);stamina=parseInt(unsafeWindow.User.stamina);maxStamina=parseInt(unsafeWindow.User.max_stamina);level=parseInt(levelElt.innerHTML);ptsToNextLevel=parseInt(unsafeWindow.User.exp_to_next_level);if(!boardLastStamina)boardLastStamina=stamina;if(!boardLastPtsToNextLevel)boardLastPtsToNextLevel=ptsToNextLevel;mafia=GM_getValue("userMafiaSize",0);if(!mafia||mafia<501){var c=parseInt(unsafeWindow.User.mafia_size);if(mafia!=c){DEBUG("setting Mafia Size to: "+c);GM_setValue("userMafiaSize",c)}}var d=document.getElementById("user_skill");if(d){stats=parseInt(d.innerHTML);if(isNaN(stats))stats=0}else stats=0;if(isGMUndefined("currentLevel")){GM_setValue("currentLevel",level);GM_setValue("restAutoStat",0)}if(level>GM_getValue("currentLevel")){GM_setValue("currentLevel",level);addToLog("experience Icon",'<span style="color:#00FFCC;"> Congratulations on reaching level <strong>'+level+"</strong>!</span>");GM_setValue("restAutoStat",0);GM_setValue("availableJobs","({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})")}customizeStatsRow();return true}function refreshSettings(){var a=ptsToNextLevel<stamina*getStaminaGainRate()+energy*getEnergyGainRate()+autoFamilyProgress(1);SpendStamina.refreshLimits(maxStamina,a);SpendEnergy.refreshLimits(maxEnergy,a);SpendMissionStamina.refreshLimits(maxStamina,a);SpendMissionEnergy.refreshLimits(maxEnergy,a);if(running){if(isGMChecked(SpendStamina.spendFlag))SpendStamina.toggleSpending(maxStamina,stamina);if(isGMChecked(SpendEnergy.spendFlag))SpendEnergy.toggleSpending(maxEnergy,energy);if(isGMChecked("autoStartFamOps"))SpendMissionStamina.toggleSpending(maxStamina,stamina);if(isGMChecked("autoStartFamOps"))SpendMissionEnergy.toggleSpending(maxEnergy,energy)}if(GM_getValue("autoPauseActivated")===true&&isGMChecked("autoPauseBefore")&&GM_getValue("autoPauselvlExp")<ptsToNextLevel){GM_setValue("autoPauselvlExp",ptsToNextLevel);GM_setValue("autoPauseActivated",false)}if(running&&isGMChecked("autoPause")){if(isGMChecked("autoPauseBefore")&&GM_getValue("autoPauseExp","")>=ptsToNextLevel&&GM_getValue("autoPauseActivated",false)===false){addToLog("pause Icon","Auto-pause in effect. Experience threshold reached.");GM_setValue("autoPauseActivated",true);pause()}else if(isGMChecked("autoPauseAfter")&&GM_getValue("autoPauselvlExp","")<ptsToNextLevel){addToLog("pause Icon","Auto-pause in effect. Leveled up.");GM_setValue("autoPauselvlExp",ptsToNextLevel);pause()}}}function getStaminaGainRate(){var a=GM_getIntValue("totalExpInt",0);var b=GM_getIntValue("fightWinCountInt",0)+GM_getIntValue("fightLossCountInt",0)+GM_getIntValue("hitmanWinCountInt",0)+GM_getIntValue("hitmanLossCountInt",0)+GM_getIntValue("totalRobStamInt",0);if(!a||!b)return 2;return a/b}function getEnergyGainRate(){var a=GM_getFloatValue("estimateJobRatio","2");return!isNaN(a)?a:2}function setFBParams(){var a=document.getElementById("navAccountName");if(a)GM_setValue("FBName",a.innerHTML);GM_setValue("language",document.documentElement.lang);sendMWValues(["language","FBName"])}function copyMWValues(a){if(gvar.isGreaseMonkey)return;var b={};for(var c in a)b[a[c]]="";b.action="getGM";chrome.extension.sendRequest(b,function(a){for(var b in a)GM_setValue(b,a[b])})}function sendMWValues(a){if(gvar.isGreaseMonkey)return;var b={};for(var c in a)b[a[c]]=GM_getValue(a[c]);b.action="setGM";chrome.extension.sendRequest(b)}function MWAP_RX6_PopupOpen(a,b,c,d){var e='<div id="MWAP_RX6_Popup_BG" class="pop_box" style="display: block; top:0px;left: 0px; width:100%;height:100%;z-index:99994;">'+'<div id="MWAP_RX6_Popup" class="pop_box" style="display: block; top:25px;left: 200px; width:350px;height:'+c+'px;z-index:99995;">'+'<a id="MWAP_RX6_Popup_CloseLink" href="#" class="pop_close"></a>'+'<div style="z-index:99996" class="mini_EP_info_pop">'+'<div class="mini_EP_body">'+'<img src="http://mwfb.static.zgncdn.com/mwfb/graphics/empire/container_social.png" style="position:absolute;top:-83px;left:-152px;" height="60" width="350">';if(d)e+='<center><img style="position:relative;left:-172px;top:-83px" src="http://mwap.me.uk/images/mwap-images/rx6-signuptoday-mwap.jpg"></center><br>';e+='<div style="position:relative;top:-73px;left:-158px;width:340px;height:25px" class="empire_module_title">'+'<span style="position:relative;top:-5px;left:-10px;text-align:center;">'+a+"</span>"+"</div>"+'<div style="position:relative;left:-160px;top:-68px;text-align:center;">'+b+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"+"";document.getElementById("popup_fodder").innerHTML=e;return}function MWAP_RX6_PopupActivate(a){document.getElementById("MWAP_RX6_Popup_CloseButton").addEventListener("click",MWAP_RX6_PopupClose,false);document.getElementById("MWAP_RX6_Popup_CloseLink").addEventListener("click",MWAP_RX6_PopupClose,false);if(a)addToLog("process Icon","RX6 MWAP. Why not upgrade to RX6 MWAP PRO Now and get all the current features?");return}function MWAP_RX6_PopupClose(){$("#MWAP_RX6_Popup").hide();$("#MWAP_RX6_Popup_BG").hide();$("#content_row").height("auto");$("#MWAP_RX6_Popup").remove();$("#MWAP_RX6_Popup_BG").remove();setGMTime("mwapRX6PopupTimer","6 hours");return}function mwapRX6Popup(){if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){if(!timeLeftGM("mwapRX6PopupTimer")&&!document.getElementById("MWAP_RX6_Popup")){var a="!!! UPGRADE TO RX6 MWAP PRO !!!";var b="430";var c="Stick to the target like glue until ICED or KILLED!<br>Get the Crazy Speed option that only RX6 MWAP Pro provides! BGF (Back Ground Fighting) does jobs and collects whilst ICING!"+"<br><br>Only possible with RX6 MWAP Pro!"+"<br><br>Sign Up today to get all RX6 MWAP Pro features"+'<br><a href="http://mwap.me.uk/sign-up-today/pro-compare.html" target="_blank">mwap.me.uk</a>'+'<br><a id="MWAP_RX6_Popup_CloseButton" href="javascript:void(0)" style="position:relative;top:10px" class="sexy_button_new black"><span><span>Close Popup</span</span></a>'+"";MWAP_RX6_PopupOpen(a,c,b,true);MWAP_RX6_PopupActivate(true)}}}function customizeBanner(){var a=document.location.protocol;if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){var b=document.getElementById("quest");var c=null;if(b){if(document.getElementById("ps_mwap_promo_banner_top"))c=document.getElementById("ps_mwap_promo_banner_top");else c=makeElement("div",b,{id:"ps_mwap_promo_banner_top"});if(!document.getElementById("mwapiFrame"))var d=makeElement("iframe",c,{id:"mwapiFrame",src:a+"//playerscripts.co.uk/ps-adbanner/ps-adbanner.html",scrolling:"no",frameborder:"0",style:"margin:0px;padding:0px; border:none; overflow:hidden; width:750px; height:95px;",allowTransparency:"false"})}var c=null;var b=document.getElementById("mw_city_wrapper");if(b){if(document.getElementById("ps_mwap_promo_banner_bottom"))c=document.getElementById("ps_mwap_promo_banner_bottom");else c=makeElement("div",b,{id:"ps_mwap_promo_banner_bottom"});if(!document.getElementById("mwap2iFrame"))var d=makeElement("iframe",c,{id:"mwap2iFrame",src:a+"//playerscripts.co.uk/ps-adbanner/ps-adbanner_bottom.html",scrolling:"no",frameborder:"0",style:"margin:0px;padding:0px; border:none; overflow:hidden; width:750px; height:120px;",allowTransparency:"false"})}getBrowserWindowSize();if(winW>1024||isGMChecked("leftAlign")){var c=null;var b=document.getElementById("final_wrapper");if(b){if(document.getElementById("ps_mwap_promo_banner_sky"))c=document.getElementById("ps_mwap_promo_banner_sky");else c=makeElement("div",b,{id:"ps_mwap_promo_banner_sky"});if(!document.getElementById("mwap3iFrame"))var d=makeElement("iframe",c,{id:"mwap3iFrame",src:a+"//playerscripts.co.uk/ps-adbanner/ps-adbanner_sky.html",scrolling:"no",frameborder:"0",style:"position:fixed;margin:0px;padding:0px; border:none; overflow:hidden; width:165px; height:650px;z-index:1",allowTransparency:"false"})}}}else{destroyByID("mwapiFrame");destroyByID("ps_mwap_promo_banner_top");destroyByID("mwapi2Frame");destroyByID("ps_mwap_promo_banner_bottom");destroyByID("mwapi3Frame");destroyByID("ps_mwap_promo_banner_sky")}}function refreshMWAPCSS(){try{function a(){if(!document.getElementById("mwapStatCSS")){var b=makeElement("link",document.getElementsByTagName("head")[0],{id:"mwapStatCSS",type:"text/css",rel:"stylesheet"});b.id="mwapStatCSS";b.setAttribute("href","http://cdn.playerscripts.co.uk/psmwap/mwapCSS.css");window.setTimeout(a,350)}else{var c=document.getElementById("mwapDynCSS");var d="";if(c)d=c.innerHTML;var e=' iframe[name="mafiawars_zbar"] {display: none;}'+' div[class="footer_text"] {display: none;}'+' div[id="zbar"] {display: none;}'+' div[id="cpa_fights_banner"] {display: none;}'+' div[id="cpa_jobs_banner"] {display: none;}'+' div[style="background-color: #fff; height: 85px; padding: 0; margin: 0;"] {display: none;}'+" #mafia_two_banner {display: none;}"+(isGMChecked("mastheadOnTop")?" #mw_masthead {position: fixed; z-index: 100; width: 755px;}"+" #mw_masthead_zombie {position: fixed; z-index: 100; width: 755px;}"+" #mw_masthead_human {position: fixed; z-index: 100; width: 755px;}"+" #stats_row   {position: fixed; top: 55px; width: 762px; z-index: 12;}"+" #menubar     {position: fixed; top: 135px; width: 762px; background-color: rgb(0, 0, 0); z-index: 12;}"+" #quest       {position: relative; top: 250px; z-index: 11;}"+" #content_row {position: relative; top: 250px;}":"")+(isGMChecked("leftAlign")?" #ajax-container {margin: 0; position: static; text-align: left; width: 760px;}":" #ajax-container {margin: 0 auto; position: static; text-align: left; width: 760px;}")+"#zmc-envelope {display: none;}"+' div[class$="zmc-envelope"] {display: none;}'+' div[style$="float: left; width: 65px;"] {display: none;}'+' a[class$="invite-friends"] {display: none;}'+' span[style$="display: block; height: 16px;"] {margin-left:-65px;}'+' div[style$="background-color: rgb(255, 255, 255); height: 85px; padding: 0pt; margin: 0pt;"] {display: none;}'+(isGMChecked("leftAlign")?" #final_wrapper {margin: 0; position: static; text-align: left; width: 760px;}":" #final_wrapper {margin: 0 auto; position: static; text-align: left; width: 760px;}")+(isGMChecked("leftAlign")?" #mwap3iFrame {top:10px;left:810px;z-index:100}":" #mwap3iFrame {top:10px;left:10px;z-index:100}")+(isGMChecked("hideAll")?' a[style$="position: absolute; top: 7px; right: 134px; height: 23px; width: 43px; z-index: 2;"] {display: none;}'+' a[style$="position: absolute; top: 7px; right: 134px; height: 23px; padding: 20px 0pt 0pt; width: 43px; z-index: 2;"] {display: none;}'+' a[style$="position: absolute; top: 7px; right: 134px; height: 23px; padding: 20px 0 0; width: 43px; z-index: 2;"] {display: none;}':' a[style$="position: absolute; top: 7px; right: 134px; height: 23px; width: 43px; z-index: 2;"] { !important; left: 760px !important; z-index: 2 !important;}'+' a[style$="position: absolute; top: 7px; right: 134px; height: 23px; padding: 20px 0pt 0pt; width: 43px; z-index: 2;"] { !important; left: 760px !important; z-index: 2 !important;}'+' a[style$="position: absolute; top: 7px; right: 134px; height: 23px; padding: 20px 0 0; width: 43px; z-index: 2;"] { !important; left: 760px !important; z-index: 2 !important;}')+(isGMChecked("hideAll")?" #zstream_icon {display: none;}":" #zstream_icon {position: absolute; top: 65px; left:755px; z-index: 100;} ")+(isGMChecked("hideAll")?" #slots_icon_container  {display: none;}"+" #slots_icon_cover      {display: none;}":" #slots_icon_container  {position: absolute; top: 85px; left: 755px; z-index: 99;} "+" #slots_icon_cover      {position: absolute; top:85px; left: 755px; z-index: 100;} ")+(isGMChecked("hideAll")?" #gifticon_container {display: none;}":" #gifticon_container {position: absolute; top: 135px; left: 755px; z-index: 100;} ")+(isGMChecked("hideAll")?" #buyframe_link_container_anim  {display: none;}"+" #buyframe_link_cover_anim      {display: none;}":" #buyframe_link_container_anim  {position: absolute; top: 180px; left: 755px; z-index: 100;} "+" #buyframe_link_cover_anim      {position: absolute; top: 180px; left: 755px; z-index: 100;} ")+(isGMChecked("hideAll")?" #promoicon_container {display: none;}":" #promoicon_container {position: absolute; top: 220px; left: 755px; z-index: 100;} ")+(isGMChecked("hideAll")?" #buyframe_link_container  {display: none;}"+" #buyframe_link_cover      {display: none;}":" #buyframe_link_container  {position: absolute; top: 265px; left: 755px; z-index: 100;} "+" #buyframe_link_cover      {position: absolute; top: 265px; left: 755px; z-index: 100;} ")+(isGMChecked("hideAll")?' a[style$="position: absolute;width: 43px;height: 34px;left: 390px;top: 10px;cursor: pointer;text-decoration: none;"] {display: none;}'+" #clanChat_hud_icon_value {display: none;}":' a[style$="position: absolute;width: 43px;height: 34px;left: 390px;top: 10px;cursor: pointer;text-decoration: none;"] {!important; position: absolute; top: 285px !important; left: 755px !important; z-index: 100 !important;} '+" #clanChat_hud_icon_value {!important, position: absolute; top: 285px !important; left: 755px !important; z-index: 100 !important;} ")+(isGMChecked("hideAll")?' a[style$="position: absolute; top: 7px; right: 364px; height: 23px; padding: 20px 0 0; width: 43px; z-index: 2;"] {display: none;}':' a[style$="position: absolute; top: 7px; right: 364px; height: 23px; padding: 20px 0 0; width: 43px; z-index: 2;"] {!important; position: absolute; top: 325px !important; left: 755px !important; z-index: 100 !important;} ')+(isGMChecked("hideAll")?" .header_mid_row div.header_various {display: none;}":" .header_mid_row div.header_various {position: absolute; top: 1px; left: 825px; width: 12px; z-index: 100;} ")+(isGMChecked("hideZyngaBanner")?' div[id="header_top_promo_banner"] {display: none !important;}':"")+(isGMChecked("hideClanChat")?' div[id="clanChat"] {display: none !important;}':"")+(isGMChecked("hideAll")?' div[class="tab_box_content"][style*="padding: 5px; text-align: center; margin-bottom: 420px;"], ':"")+(isGMChecked("hideAll")?" .message_box_full, ":"")+(isGMChecked("hideAll")?" .menu_divider, ":"")+(isGMChecked("hideAll")?' div[class="tab_box"][style*="left"], ':"")+(isGMChecked("hideAll")?' img[alt="Free Holiday Gifts!"], '+' img[alt="Gift Safe House"], '+' img[alt="Free Mystery Bag!"], ':"")+" div.lootImg {float:left;width:50px;}"+" div.lootImg img {width:45px !important;height:45px !important;}"+"";if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){e+=" #fv2_widget_wrapper {margin-top:350px !important;}"}else{e+=" #fv2_widget_wrapper {margin-top:150px !important;}"}if($("#spockholm_toolbar").length){e+=" #mainDiv {top:35px;}"}if(e!=d){remakeElement("style",document.getElementsByTagName("head")[0],{id:"mwapDynCSS",type:"text/css"}).appendChild(document.createTextNode(e))}}}a()}catch(b){addToLog("warning Icon","BUG DETECTED (refreshMWAPCSS): "+b)}}function showTimers(){var a="<br>  miniPackTimer: "+getHoursTime("miniPackTimer")+"<br>  askEventPartsTimer: "+getHoursTime("askEventPartsTimer")+"<br>  askHomePartsTimer: "+getHoursTime("askHomePartsTimer")+"<br>  askRobSquadsTimer: "+getHoursTime("askRobSquadsTimer")+"<br>  checkPropertyTimer: "+getHoursTime("checkPropertyTimer")+"<br>  askVegasPartsTimer: "+getHoursTime("askVegasPartsTimer")+"<br>  askPlaySlotsTimer: "+getHoursTime("askPlaySlotsTimer")+"<br>  askBrazilPartsTimer: "+getHoursTime("askBrazilPartsTimer")+"<br>  askChicagoPartsTimer: "+getHoursTime("askChicagoPartsTimer")+"<br>  askLondonPartsTimer: "+getHoursTime("askLondonPartsTimer")+"<br>  resetHomePropTimer: "+getHoursTime("resetHomePropTimer");for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){a+="<br>  "+cityParts[ctCount][ptTimer]+": "+getHoursTime(cityParts[ctCount][ptTimer])}for(ctCount=0;ctCount<ctLength;ctCount++){a+="<br>  "+cityProperties[ctCount][ctPropTimer]+": "+getHoursTime(cityProperties[ctCount][ctPropTimer])}a+="<br>  autoUpgradeNYTimer: "+getHoursTime("autoUpgradeNYTimer")+"<br>  takeHourNew York: "+getHoursTime("takeHourNew York")+"<br>  takeHourLas Vegas: "+getHoursTime("takeHourLas Vegas")+"<br>  takeHourBrazil: "+getHoursTime("takeHourBrazil")+"<br>  takeHourChicago: "+getHoursTime("takeHourChicago")+"<br>  takeHourLondon: "+getHoursTime("takeHourLondon")+"<br>  partsHour: "+getHoursTime("partsHour")+"<br>  Check myMissions Timer: "+getHoursTime("myOpsTimer")+"<br>  Check FamilyMissionsTimer: "+getHoursTime("famOpsTimer")+"<br>  autoAskCityCrewTimer: "+getHoursTime("autoAskCityCrewTimer")+"<br>  activateBrazilCrewTimer: "+getHoursTime("activateBrazilCrewTimer")+"<br>  activateChicagoCrewTimer: "+getHoursTime("activateChicagoCrewTimer")+"<br>  activateLondonCrewTimer: "+getHoursTime("activateLondonCrewTimer")+"<br>  AskforHelpBrazilTimer: "+getHoursTime("AskforHelpBrazilTimer")+"<br>  AskforHelpChicagoTimer: "+getHoursTime("AskforHelpChicagoTimer")+"<br>  AskforHelpLondonTimer: "+getHoursTime("AskforHelpLondonTimer")+"<br>  AskforHelpVegasTimer: "+getHoursTime("AskforHelpVegasTimer")+"<br>  wishListTimer: "+getHoursTime("wishListTimer")+"<br>  warTimer: "+getHoursTime("warTimer")+"<br>  askEnergyPackTimer: "+getHoursTime("askEnergyPackTimer")+"<br>  askStaminaPackTimer: "+getHoursTime("askStaminaPackTimer")+"<br>  autoAcceptMsgTimer: "+getHoursTime("autoAcceptMsgTimer")+"<br>  askFightBoostsTimer: "+getHoursTime("askFightBoostsTimer");addToLog("info Icon",'<span style="color:#04B4AE;">Time left on RX6 MWAP Timers:'+a+"</span>");return}function resetTimers(a){var b=function(b,c){if(a||timeLeftGM(b)<c)setGMTime(b,0)};b("miniPackTimer",300);b("wishListTimer",300);b("warTimer",900);b("buildCarTimer",900);b("askVegasPartsTimer",900);b("askPlaySlotsTimer",900);b("askBrazilPartsTimer",900);b("askChicagoPartsTimer",900);b("askLondonPartsTimer",900);b("resetHomePropTimer",900);for(ctCount=0;ctCount<ctLength;ctCount++)b(cityProperties[ctCount][ctPropTimer],900);for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++)b(cityParts[ctCount][ptTimer],900);b("partsHour",900);b("autoUpgradeNYTimer",3600);b("takeHourNew York",300);b("takeHourLas Vegas",300);b("takeHourBrazil",300);b("takeHourChicago",300);b("takeHourLondon",300);b("askEnergyPackTimer",900);b("askStaminaPackTimer",900);b("askEventPartsTimer",900);b("askHomePartsTimer",900);b("askRobSquadsTimer",900);b("autoAskCityCrewTimer",3600);b("activateBrazilCrewTimer",3600);b("activateChicagoCrewTimer",3600);b("activateLondonCrewTimer",3600);b("AskforHelpBrazilTimer",1800);b("AskforHelpChicagoTimer",1800);b("AskforHelpLondonTimer",1800);b("AskforHelpVegasTimer",1800);b("checkVaultTimer",900);b("myOpsTimer",0);b("famOpsTimer",0);b("autoAcceptMsgTimer",3600);b("askFightBoostsTimer",3600);b("autoBattleTimer",300);b("autoSlotTimer",300);b("autoFreeGiftTimer",900);b("autoAskFreeGiftTimer",900);b("autoDispatchTimer",900);b("requestTimer",300);b("checkPropertyTimer",3600);addToLog("warning Icon","All active timers have been reset.");if(a){alert("All active timers have been reset.");Autoplay.delay=150;Autoplay.start();autoReload(false,"reset timers")}return}function doQuickClicks(){try{var a=function(a){var b=xpathFirst(a);if(b){clickElement(b);return true}return false};if(a('//a[@class="sexy_button_new short white" and contains(@onclick,"travel") and contains(.,"Go to")]'))return;if(isGMChecked("autoGlobalPublishing")){if(a('//a[contains(@onclick,"postLevelUpFeedAndSend(); levelUpBoost();")]'))return;if(a('//a[contains(.,"Share the wealth!")]'))return;if(a('//div//a[@class="sexy_button" and contains(text(),"Reward Friends")]'))return;if(a('//div//a[@class="sexy_button_new short white sexy_call_new" and contains(text(),"Reward Friends")]'))return;if(a('//div//a[@class="sexy_button_new short white sexy_call_new" and contains(.,"Ask Friends for Help!")]'))return;if(a('//div//a[@class="sexy_button_new short white sexy_call_new" and contains(text(),"Rally More Help")]'))return;if(a('//div[@class="boss_operations"]//a[contains(@class,"boss_consumable_feed") and contains(.,"Ask")]'))return;if(a('//a[@id="collect_share_feed_btn" and contains(.,"Share")]'))return;if(a('//a[@id="fotd_share_button" and contains(.,"Share") and contains(@onclick, "var feed")]'))return;if(a('//a[@id="loot_collection_ask_btn" and contains(.,"Ask")]'))return;if(a('//div[@class="userConsumables"]/div[contains(@id,"consumable") and contains(@onclick,"consumableAsk")]//img'))return;if(a('//div[@class="userConsumables"]/div[contains(@id,"consumable") and contains(@onclick,"ConsumableFeeds")]//img'))return;if(a('//div[@id="bm_ask_all_button"]//a[contains(@id,"collect_share_feed_btn") and contains(@onclick,"CollectShareFeed")]'))return;if(a('//div[@id="gift_event_mbox"]//a[contains(@onclick,"show_free_gift_event_popup") and contains(.,"Collect")]'))return;if(a('//li[contains(@id,"quest")]//a[contains(@id,"qfeed") and contains(@onclick,"qfeed") and not (contains(@style,"hidden")) and contains(.,"Ask Now")]'))return}if(onHome()){if(!timeLeftGM("resetHomePropTimer")){var b=function(a,b,c){return c[b][ctPropType]==1};var c=cityProperties.filter(b);if(c.length>0){for(r=0,s=c.length;r<s;r++){var d="bye_"+c[r][ctPropName].ftrim()+"_build_timer";var e=xpathFirst('//span[@id="'+d+'"]');if(e)setGMTime(c[r][ctPropTimer],e.innerHTML.untag())}if(isGMChecked("collectTakeNew York")){if(document.getElementById("bcm_timer_countdown_nyc"))setGMTime("takeHourNew York",document.getElementById("bcm_timer_countdown_nyc").innerHTML.untag());if(document.getElementById("bcm_timer_countdown_vegas"))setGMTime("takeHourLas Vegas",document.getElementById("bcm_timer_countdown_vegas").innerHTML.untag())}setGMTime("resetHomePropTimer","1 hours")}return}if(isGMChecked("autoGlobalPublishing")&&!timeLeftGM("askHomePartsTimer")){var f=xpathFirst('.//a[contains(@class,"sexy_call_new") and contains(.,"Ask for parts")]',innerPageElt);if(!f)f=xpathFirst('.//a[contains(@class,"build_event_post_feed") and contains(.,"Ask for all parts") and not(contains(@style,"opacity: 0.5"))]',innerPageElt);if(f){clickElement(f);addToLog("info Icon","Clicked to ask your mafia to send you Parts.");setGMTime("askHomePartsTimer","4 hours");return}}if(isGMChecked("autoGlobalPublishing")&&!timeLeftGM("askRobSquadsTimer")){var g=xpathFirst('.//a[contains(@class,"build_event_post_feed_btn") and contains(@onclick,"showOneClickFeed") and contains(.,"Ask")]',innerPageElt);if(g){clickElement(g);addToLog("info Icon","Clicked to ask your mafia to send you Rob Squads.");setGMTime("askRobSquadsTimer","4 hours");return}}if(isGMChecked("autoGlobalPublishing")&&!timeLeftGM("askEventPartsTimer")){var h=xpathFirst('.//a[contains(@class,"sexy_call_new") and contains(.,"Ask") and contains(@onclick,"BuildEventModule")]',innerPageElt);if(h){DEBUG("Asking for Event Parts - Ask button Found");clickElement(h);addToLog("info Icon","Clicked to Ask your mafia for Event Parts.");setGMTime("askEventPartsTimer","4 hours");return}}if(isGMChecked("collectParts")&&!timeLeftGM("partsHour")){var i=xpathFirst('.//a[@class="sexy_button_new short green" and contains(@onclick,"collectAllButton") and not(contains(@style,"none"))]',innerPageElt);if(i){DEBUG("Collecting Parts from Properties");clickElement(i);addToLog("info Icon","Clicked to Collect All Parts from Properties.");setGMTime("partsHour","4 hours");return}else{i=xpathFirst('.//span[@id="bcm_timer_countdown"]',innerPageElt);if(i){setGMTime("partsHour",i.innerHTML);DEBUG("Collecting Parts from Properties - Resetting Timer: "+i.innerHTML);return}}}if(!timeLeftGM("askEnergyPackTimer")){var j=xpathFirst('.//div[@class="module_subtitle" and contains(.,"ENERGY")]',innerPageElt);if(j){j=j.parentNode;var k=xpathFirst('.//span[@id="cur_energy"]',j);var l=xpathFirst('.//span[contains(@style,"white")]',k.parentNode);curNRG=parseInt(k.innerHTML);maxNRG=parseInt(l.innerHTML);if(curNRG<maxNRG){var m=xpathFirst('.//a[@class="empire_wait_ask_button sexy_button_new fl" and contains(.,"Ask")]',j);if(m){clickElement(m);addToLog("info Icon","Clicked to ask your mafia for Energy Packs.");setGMTime("askEnergyPackTimer","4 hours")}}else{DEBUG("at Max for Energy Packs - not asking");setGMTime("askEnergyPackTimer","4 hours")}return}}if(!timeLeftGM("askStaminaPackTimer")){var j=xpathFirst('.//div[@class="module_subtitle" and contains(.,"POWER")]',innerPageElt);if(j){j=j.parentNode;var k=xpathFirst('.//span[@id="cur_power"]',j);var l=xpathFirst('.//span[contains(@style,"white")]',k.parentNode);curNRG=parseInt(k.innerHTML);maxNRG=parseInt(l.innerHTML);if(curNRG<maxNRG){var m=xpathFirst('.//a[@class="empire_wait_ask_button sexy_button_new fl" and contains(.,"Ask")]',j);if(m){clickElement(m);addToLog("info Icon","Clicked to ask your mafia for Power Packs.");setGMTime("askStaminaPackTimer","4 hours")}}else{DEBUG("at Max for Power Packs - not asking");setGMTime("askStaminaPackTimer","4 hours")}return}}if(running&&(isGMChecked("autoEnergyPack")||GM_getIntValue("autoEnergyPackForcePts",0))){colorDEBUG("autoEnergyPack",caq);energyPack=false;energyPackElt=xpathFirst('.//div[contains(@id, "empire_use_pack_area") and contains(@style,"block")]//a[contains(@onclick, "EnergyPackModule.use()")]',innerPageElt);if(energyPackElt){colorDEBUG("autoEnergyPack - elt found",caq);energyPack=energyPackElt&&onHome()?true:false;var n=xpathFirst('.//div[contains(@id, "mbox_energy_timer_container")]',innerPageElt);if(n){colorDEBUG("autoEnergyPack - countdown elt found",caq);if(n.style.display=="block"){energyPack=false;colorDEBUG("autoEnergyPack - can not use pack",caq)}}}var o=maxEnergy*1.25*getEnergyGainRate();colorDEBUG("autoEnergyPack - estimated xp from pack: "+o,caq);var p=ptsToNextLevel-parseInt(stamina*getStaminaGainRate());colorDEBUG("autoEnergyPack - xp to next level left after stamina is used: "+p,caq);autoEnergyPackWaiting=energyPack&&o<=p;if(autoEnergyPackWaiting&&isGMChecked("autoEnergyPack")||energyPack&&energy<=GM_getIntValue("autoEnergyPackForcePts",0)){colorDEBUG("energyPack="+energyPack+"  energy="+energy+"  ptsToNextLevel="+ptsToNextLevel+"  ptsToLevelProjStaminaUse="+p);if(autoEnergyPackWaiting){addToLog("energyPack Icon","This energy pack should give you approximately "+parseInt(o)+" xp of your "+parseInt(p)+" projected remaining xp.")}if(energyPackElt){Autoplay.fx=function(){clickAction="energypack";clickElement(energyPackElt);colorDEBUG("Clicked to use energy pack")};Autoplay.start();return}}else{colorDEBUG("autoEnergyPack - not using pack",cre)}}}var q=xpath('.//a[contains(@onclick,"xw_action=dismiss_message")]',innerPageElt);for(var r=0,s=q.snapshotLength;r<s;++r){if(q.snapshotItem(r))clickElement(q.snapshotItem(r))}var t=xpath('.//div[@class="msg_box_div_contents" and contains(.,"Mystery")]',innerPageElt);for(var r=0,s=t.snapshotLength;r<s;++r){if(t.snapshotItem(r)&&!/display: none/.test(t.snapshotItem(r).innerHTML)){var u=getActionLink(t.snapshotItem(r),"Open It!");if(u)clickElement(u)}}}catch(v){DEBUG("Error @doQuickClicks: "+v)}}function doParseMessages(){var a=$x('//td[@class="message_body"]');if(a&&a.length>0){for(var b=0,c=a.length;b<c;++b){if(/Mini[\s\w]+Buff/i.test(a[b].innerHTML)){addToLog("yeah Icon",a[b].innerHTML);setGMTime("miniPackTimer","8 hours");break}}}}function preloadMWAPImages(){if(document.getElementById("PreLoadImages")||!document.body||!document.getElementById("verytop"))return;var a=makeElement("div",document.body,{id:"PreLoadImages",style:"position: absolute; top: -9999px; left:-9999px;"});var b='<img src="'+SCRIPT.PSMWAP_imagePath+'r1_c1.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r1_c2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r1_c16.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c1.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c3.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c4.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c5.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c6.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c8.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c9.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c11.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c12.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c14.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c15.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c16.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r3_c1.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r3_c15.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r3_c16.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c1.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c4.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c7.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c10.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c13.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c16.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r6_c1.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r6_c2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r6_c16.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c2_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c3_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c4_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c5_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c6_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c8_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c9_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c11_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c12_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c14_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r2_c15_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r3_c15_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c2_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c7_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c10_f2.png">'+'<img src="'+SCRIPT.PSMWAP_imagePath+'r5_c13_f2.png">';a.innerHTML=b}function customizeStatsRow(){if(!document.getElementById("level_up_ratio_stats")){elt=makeElement("div",statsrowElt,{id:"level_up_ratio_stats",title:"Ratios needed to level up: combined, on energy only, on stamina only.",style:"float:left;width:450px;"})}setLevelUpRatioStats();if(!document.getElementById("mwapSpringBoard")){var a=makeElement("select",statsrowElt,{id:"mwapSpringBoard",title:"mwapSpringBoard",style:"font-size:10px;float:right;width:200px;"});choiceTier=document.createElement("option");choiceTier.text="RX6 MWAP SpringBoard";choiceTier.value="";a.appendChild(choiceTier);for(i=0,iLength=cities.length;i<iLength;i++){if(!cities[i][CITY_CLOSED]){choiceTier=document.createElement("optgroup");choiceTier.label=cities[i][CITY_NAME].toUpperCase();choiceTier.className="ap_optgroup1";a.appendChild(choiceTier);for(j=0,jLength=missionTabs[i].length;j<jLength;j++){var b=j+1;choiceTier=document.createElement("option");choiceTier.text=missionTabs[i][j];choiceTier.value=i+"|"+b;a.appendChild(choiceTier)}}}a.addEventListener("change",mwapSpring,false)}}function mwapSpring(){var a=document.getElementById("mwapSpringBoard");var b=a.value;mwapJump(b);a.selectedIndex=0}function customizeMasthead(){function a(){var a=document.getElementById("mwapHelpMenu");if(a)a.style.display="block"}function b(){var a=document.getElementById("mwapHelpMenu");if(a)a.style.display="none"}function c(){var a=document.getElementById("mwapHelpMenu");if(a){if(a.style.display=="none")a.style.display="block";if(a.style.display=="block")a.style.display="none"}}function s(){var a="http://simony.dk/gs/Chucker.js?"+Math.random();var b=makeElement("script",document.getElementsByTagName("head")[0],{id:"chuckerLink",type:"text/javascript"});b.src=a;b.id="chuckerLink"}function u(){var a="http://www.playerscripts.co.uk/psbm/analyser/ps-inneed2.js";var b=makeElement("script",document.getElementsByTagName("head")[0],{id:"analyserLink",type:"text/javascript"});b.src=a;b.id="analyserLink"}var d=document.getElementById("snapi_zbar");if(d){d.style.display="none";if(d.parentNode&&d.parentNode.parentNode)d.parentNode.parentNode.removeChild(d.parentNode)}d=document.getElementById("mw_like_button");if(d){d.style.display="none";if(d.parentNode)d.parentNode.removeChild(d)}odiv=xpathFirst('.//iframe[@name="mafiawars_zbar"]');if(d){d.style.display="none";if(d.parentNode)d.parentNode.removeChild(d)}var e=$x('.//div[contains(@id,"cpa") and contains(@id,"banner")]');for(i=0;i<e.length;i++){d=e[i];if(d){d.style.display="none";if(d.parentNode)d.parentNode.removeChild(d)}}document.title="Mafia Wars on Facebook";if(isGMChecked("fbwindowtitle")){if(GM_getValue("FBName"))document.title=GM_getValue("FBName")}if(document.getElementById("ap_menu")){updateMastheadMenu();return}var f;if(new_header)f=xpathFirst('//div[@class="header_top_row"]');else f=xpathFirst('.//div[contains(@id,"mw_masthead")]');var g=makeElement("div",f,{id:"ap_links",style:"position: absolute; top: 4px; right: 0px; text-align: left;font-size: 10px; font-weight: bold;"});makeElement("a",g,{href:"http://mwap.me.uk/mwaprx/ps_facebook_mafia_wars_a.user.js",target:"_blank"}).appendChild(document.createTextNode("For Firefox"));g.appendChild(document.createTextNode(" | "));makeElement("a",g,{href:"https://chrome.google.com/extensions/detail/cgagpckjofhomehafhognmangbjdiaap",target:"_blank"}).appendChild(document.createTextNode("For Chrome"));var h="RX6 MWAP ";if(!GM_getValue("readValueOK",0))h+='<span style="color:#FF0000">LITE</span> ';h+=SCRIPT.version;if(new_header)h+=" (nH)";var j=makeElement("div",f,{style:"position: absolute; top: 20px; right: 10px; text-align: left; font-size: 10px; font-weight: bold; color: white"});j.innerHTML=h;var k=makeElement("div",f,{id:"mwapLikeElt",style:"position: absolute; top: 20px; right: 500px;z-index:5000;"});k.innerHTML='<iframe src="http://playerscripts.co.uk/ps-adbanner/ps-adbanner.html" scrolling="no" frameborder="0" style="margin:0px;padding:0px; border:none; overflow:hidden; width:0px; height:0px;" allowTransparency:"true"></iframe>';k.innerHTML+='<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FPS-Mafia-Wars-Autoplayer%2F160393374005267&layout=button_count&show_faces=true&width=80&action=like&font=arial&colorscheme=light&height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:80px; height:21px;" allowTransparency="true"></iframe>';f.insertBefore(k,f.firstChild);var l=makeElement("div",f,{id:"ap_menu",style:"position: absolute; top: 38px; font-size: 10px; right: 0px; text-align: left;"});var m=makeElement("div",null,{id:"mwapHelpElt",style:"position: absolute; top: 18px; right:170px; width: 110px; z-index: 1;"});var n=makeElement("div",m,{id:"help_container",style:"width: 110px;"});var o=makeElement("a",n,{"class":"sexy_button_new short black_white_border",style:"width: 110px; outline-color: -moz-use-text-color; outline-style: none; outline-width: medium;"});var p=makeElement("span",o);var q=makeElement("span",p,{style:"background: transparent url(http://mwfb.static.zynga.com/mwfb/graphics/dropdown_travel_arrow.gif) no-repeat scroll 75px 50%; text-align: left; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"});q.appendChild(document.createTextNode(" RX6 MWAP "));var r=makeElement("div",n,{style:"z-index: 20; display: none;margin-top:-2px;width:154px;",id:"mwapHelpMenu"});r.innerHTML+="<div><b>Downloads</b></div> "+'<a href="http://mwap.me.uk/mwaprx/ps_facebook_mafia_wars_a.user.js" target="_blank"> '+"For Firefox"+"</a> "+'<a href="https://chrome.google.com/extensions/detail/cgagpckjofhomehafhognmangbjdiaap" target="_blank"> '+"For Chrome"+"</a> "+"<div><b>Websites</b></div> "+'<a href="http://www.playerscripts.co.uk/" target="_blank"  title="Playerscripts Home"> '+"PlayerScripts"+"</a>"+'<a href="http://www.mwap.me.uk/" target="_blank"  title="RX6 MWAP Home"> '+"RX6 MWAP"+"</a>"+"<div><b>PS Scripts</b></div> "+'<a href="http://playerscripts.co.uk/pswiki/index.php?title=PS_WS_About" target="_blank" title="PS NFS : News Feed Scanner"> '+"PS NFS"+"</a>"+'<a id="mwapChuckerLink" href="#">'+"PS Chucker"+"</a>"+'<a style="border-bottom:1px solid #FFF" id="PSanalyserLink" href="#">'+"PS Analyser"+"</a>"+"";f.insertBefore(m,f.firstChild);var t=document.getElementById("mwapChuckerLink");t.addEventListener("click",s,false);var v=document.getElementById("PSanalyserLink");v.addEventListener("click",u,false);f.insertBefore(m,f.firstChild);m.addEventListener("click",c,false);m.addEventListener("mouseover",a,false);m.addEventListener("mouseout",b,false);var w=makeElement("a",null,{id:"checkPack"});w.innerHTML='<span id="checkPack">Grab Toolbar info</span>';w.addEventListener("click",grabToolbarInfo,false);r.insertBefore(w,r.firstChild);var x=makeElement("a",null,{id:"resetTimers"});x.innerHTML='<span id="resetTimers">Reset Timers</span>';x.addEventListener("click",resetTimers,false);r.insertBefore(x,r.firstChild);var y=makeElement("a",null,{id:"showTimers"});y.innerHTML='<span id="showTimers">Show Timers</span>';y.addEventListener("click",showTimers,false);r.insertBefore(y,r.firstChild);var z=makeElement("a",null,{id:"autoPlay"});z.innerHTML='<span id="autoPlayspan">Settings</span>';z.addEventListener("click",toggleSettings,false);r.insertBefore(z,r.firstChild);l.appendChild(document.createTextNode(" | "));var z=makeElement("span",l);z.appendChild(document.createTextNode("Settings"));z.addEventListener("click",toggleSettings,false);l.appendChild(document.createTextNode(" | "));var A=makeElement("span",l);A.appendChild(document.createTextNode("Log"));A.addEventListener("click",showMafiaLogBox,false);menubarElt=document.getElementById("menubar");var B=makeElement("div",menubarElt,{id:"mwapToolBar",style:"display:none"});var C="RX6 Settings Display";var D=makeElement("a",B,{href:"#",id:"mwaptoolbar_display",title:C,alt:C});D.addEventListener("click",toggleNewSettings,false);if(gvar.isGreaseMonkey){var C="RX6 Update Check";var D=makeElement("a",B,{href:"#",id:"mwaptoolbar_aupdateRX6",title:C,alt:C});D.addEventListener("click",autoCheckUpdate,false)}var C="RX6 District List";var E=makeElement("a",B,{id:"mwaptoolbar_travel",href:"#",title:C,alt:C});E.addEventListener("click",function(){toggleRX6Widget("list")},false);var C="RX6 District Map";var F=makeElement("a",B,{id:"mwaptoolbar_map",href:"#",title:C,alt:C});F.addEventListener("click",function(){toggleRX6Widget("map")},false);var C="RX6 Teleporter";var G=makeElement("a",B,{id:"mwaptoolbar_aim",href:"#",title:C,alt:C});G.addEventListener("click",function(){toggleRX6Widget("aim")},false);var C="RX6 LinKonverter";var H=makeElement("a",B,{id:"mwaptoolbar_switch",href:"#",title:C,alt:C});H.addEventListener("click",function(){toggleRX6Widget("bork")},false);var C="RX6 Loot Analyser";var I=makeElement("a",B,{id:"mwaptoolbar_inventory",href:"#",title:C,alt:C});I.addEventListener("click",function(){toggleRX6Widget("inventory")},false);var C="RX6 Fight Club Buyer";var J=makeElement("a",B,{id:"mwaptoolbar_buyer",href:"#",title:C,alt:C});J.addEventListener("click",function(){toggleRX6Widget("buyer")},false);updateMastheadMenu()}function toggleNewSettings(){if(!document.getElementById("mwapNewSettings"))mwapNewSettings();else{document.getElementById("mwapNewSettings").innerHTML="";document.getElementById("mwapNewSettings").appendChild(document.createTextNode($("#mwapNewSettings").offset().left+"|"+$("#mwapNewSettings").offset().top));$("#mwapNewSettings").remove()}}function autoCheckUpdate(){updateScript()}function toggleRX6Widget(a){var b=a+"_content";var c="#"+b;var d=a+"_settings";var e="#"+d;if(!document.getElementById(b)){switch(a){case"aim":addBorkalector();break;case"bork":addBorkavertor();break;case"inventory":addBorkalyzer();break;case"map":addBorkavatorMap();break;case"list":addBorkavatorSelect();break;case"buyer":addVCBuyer();break}}else{if(document.getElementById(d)){document.getElementById(d).innerHTML="";document.getElementById(d).appendChild(document.createTextNode($(e).offset().left+"|"+$(e).offset().top))}$(c).remove()}}function vcBuyerCallBack(a,b,c,d,e,f,g){if(e){if(b=="view"){var h=document.createElement("div");h.innerHTML=g.responseText;showVCBuyer();return}var i=JSON.parse(f);var j=document.getElementById("vcLog");if(g.responseText.match(/You have purchased(.+)<\/span/i)){i.qty++;j.innerHTML="RX6 bought "+i.qty+" of "+i.needed+" of "+i.title;if(i.qty<i.needed){var k=i.needed-i.qty;makeElement("div",j).appendChild(document.createTextNode("Still needing "+k+" of "+i.title));myItemString=JSON.stringify(i);var l=i.href.trim()+"-1";mwap_do_ajax("marketplace","buy","",l,myItemString,vcBuyerCallBack);return}else{var m=i.qty*i.coins;j.innerHTML="RX6 spent "+m+" VC to buy "+i.qty+" of "+i.needed+" of "+i.title;var n=i.totalCoins-m;addToLog("process Icon","RX6 spent "+m+" VC to buy "+i.qty+" of "+i.needed+" of "+i.title+" ("+n+" VC left) ...");var o=document.getElementById("totalCoins");o.innerHTML=n;return}}else j.innerHTML+="Unrecognised Response"}else alert("Failed to buy items from the Marketplace (Fight Club)")}function buyItem(a){if(!checkItem(a))return;var b=JSON.parse(a);var c=b.href.trim()+"-1";b.qty=0;b.needed=parseInt(document.getElementById("itemQty").value);b.totalCoins=parseInt(document.getElementById("totalCoins").innerHTML.untag().digitize());a=JSON.stringify(b);makeElement("div",document.getElementById("eltContainer"),{id:"vcLog"}).appendChild(document.createTextNode("RX6 MWAP is buying "+b.needed+" x "+b.title));mwap_do_ajax("marketplace","buy",1,c,a,vcBuyerCallBack)}function checkItem(a){var b=JSON.parse(a);var c=parseInt(document.getElementById("itemQty").value);var d=parseInt(document.getElementById("totalCoins").innerHTML.untag().digitize());var e=parseInt(b.coins);if(c<=0){alert("You have to buy at least one item");document.getElementById("itemQty").value=1;return false}else if(c*e>d){alert("You can not buy that many items : lack of coins");document.getElementById("itemQty").value=1;return false}return true}function changeItem(a){var b=JSON.parse(a);var c=document.getElementById("eltContainer");c.innerHTML="";makeElement("img",c,{src:b.img});makeElement("div",c).appendChild(document.createTextNode("Item: "+b.title),{style:"margin-left:100px"});makeElement("div",c).appendChild(document.createTextNode("Cost: "+b.coins+" Victory Coins"),{style:"margin-left:100px"});if(b.attack)makeElement("div",c,{"class":"attack"}).appendChild(document.createTextNode("Attack: "+b.attack));if(b.attackSkill)makeElement("div",c,{"class":"attack"}).appendChild(document.createTextNode("Attack: "+b.attackSkill));if(b.defense)makeElement("div",c,{"class":"defense"}).appendChild(document.createTextNode("Defense: "+b.defense));if(b.defenseSkill)makeElement("div",c,{"class":"defense"}).appendChild(document.createTextNode("Defense: "+b.defenseSkill));if(b.href!="LOCKED"){eltQ=makeElement("input",c,{type:"text",id:"itemQty",title:"itemQty",style:"width: 70px;margin-right:10px"});eltQ.addEventListener("change",function(){checkItem(a)},false);var d="Buy the Current Item from the Marketplace (Fight Club)";eltA=makeElement("a",c,{id:"itemLink",href:"#",alt:d,title:d,"class":"jqRX6buttonId2"});eltA.appendChild(document.createTextNode(" BUY"));eltA.addEventListener("click",function(){buyItem(a)},false)}}function showVCBuyer(){var a=document.getElementById("buyer_content");if(!a)return;a.innerHTML="";var b=0;var c=xpathFirst('.//img[contains(@src,"victory_icon.gif")]');if(c){vcElt=c.parentNode;if(vcElt){var d=makeElement("div",a,{"class":"jqRX6buttonId2"});var e=makeElement("div",d,{style:"float:left;"});b=parseInt(vcElt.innerHTML.untag().digitize());e.innerHTML='Available Victory Coins: <span id="totalCoins">'+b+"</span>"}}var f=[];var g=$x('.//div[@class="items"]//li[not( contains(.,"Reward Points"))]');if(g.length>0){for(i=g.length-1;i>=1;i--){var h=new Item;var j=xpathFirst('.//img[@class="item_with_preview"]',g[i]);if(!j)j=xpathFirst('.//img[contains(@src,"boosts")]',g[i]);if(j){h.img=j.src;h.title=j.alt}var k=$x("./div",g[i]);h.title=k[1].innerHTML.untag();if(h.title.indexOf("Refill")!=-1)continue;var c=xpathFirst('.//img[contains(@src,"victory_icon.gif")]',g[i]);if(c){vcElt=c.parentNode;h.coins=vcElt.innerHTML.untag().digitize()}var l=xpathFirst('.//a[@class="sexy_button_new short white" and contains(.,"Buy")]',g[i]);if(l){var m=l.href;if(m.match(/tmp(.+)/))m="&tmp"+RegExp.$1;h.href=m}else h.href="LOCKED";var n=xpathFirst('.//div[contains(@style,"icon-attack")]',g[i]);if(n)h.attack=n.innerHTML.untag().digitize();else h.attack="";n=xpathFirst('.//div[contains(@style,"120px") and contains(text(),"attack skill")]',g[i]);if(n)h.attackSkill=n.innerHTML;else h.attackSkill="";var o=xpathFirst('.//div[contains(@style,"icon-defense")]',g[i]);if(o)h.defense=o.innerHTML.digitize();else h.defense="";o=xpathFirst('.//div[contains(@style,"120px") and contains(text(),"defense skill")]',g[i]);if(o)h.defenseSkill=o.innerHTML.untag();else h.defenseSkill="";f.push(h)}}var p=makeElement("select",a,{id:"vcitemlist",title:"Fight Club Loot","class":"RX6dropdown"});choiceItem=document.createElement("option");choiceItem.text="RX6 Fight Club Buyer";choiceItem.value="";p.appendChild(choiceItem);for(i=0,iLength=f.length;i<iLength;i++){choiceItem=document.createElement("option");choiceItem.text=f[i].title;choiceItem.title="Cost: "+f[i].coins+" / Attack : "+f[i].attack+f[i].attackSkill+" / Defense Attack : "+f[i].defense+f[i].defenseSkill;if(f[i].href=="LOCKED")choiceItem.text+=" - Locked";p.appendChild(choiceItem)}p.addEventListener("change",function(){var a=p.selectedIndex-1;changeItem(JSON.stringify(f[a]))},false);p.addEventListener("keypress",function(){var a=p.selectedIndex;changeItem(JSON.stringify(f[a]))},false);var d=makeElement("div",a,{id:"eltContainer","class":"jqRX6buttonId3"})}function addVCBuyer(){if(document.getElementById("buyer_content"))return;var a="RX6 Fight Club Buyer - mwap.me.uk";$("#popup_fodder").append("<div id='buyer_content' class='buyer_content'></div>");var b=document.getElementById("buyer_content");if(!document.getElementById("buyer_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"buyer_settings",style:"display:none;"})}else{if(document.getElementById("buyer_settings").innerHTML)GM_setValue("buyerSettings",document.getElementById("buyer_settings").innerHTML);else GM_setValue("buyerSettings","'center'|80")}title="Loading ...";makeElement("h1",b).appendChild(document.createTextNode("Loading Inventory"));makeElement("img",b,{id:"RX6_loadingImg",title:title,alt:title});var c=GM_getValue("buyerSettings","'center'|80").split("|");$("#buyer_content").dialog({title:a,hide:"fade",show:"blind",close:function(){$("#buyer_content").remove()},width:760,height:500,zIndex:999999,position:[parseInt(c[0]),parseInt(c[1])],resizable:false,beforeclose:function(){document.getElementById("buyer_settings").innerHTML="";document.getElementById("buyer_settings").appendChild(document.createTextNode($("#buyer_content").offset().left+"|"+$("#buyer_content").offset().top))}});var d=document.getElementById("full_list");if(!d||!onMarketTab())mwap_do_ajax("marketplace","view","","","",vcBuyerCallBack);else showVCBuyer()}function addBorkalyzer(){if(document.getElementById("inventory_content"))return;var a="RX6 Loot Analyser";$("#popup_fodder").append("<div id='inventory_content' class='inventory_content'></div>");var b=document.getElementById("inventory_content");if(!document.getElementById("inventory_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"inventory_settings",style:"display:none;"})}else{if(document.getElementById("inventory_settings").innerHTML)GM_setValue("inventorySettings",document.getElementById("inventory_settings").innerHTML);else GM_setValue("inventorySettings","'top'|80")}title="Loading ...";makeElement("h1",b).appendChild(document.createTextNode("Loading Inventory"));makeElement("img",b,{id:"RX6_loadingImg",title:title,alt:title});var c=GM_getValue("inventorySettings","'top'|80").split("|");$("#inventory_content").dialog({title:a,hide:"fade",show:"blind",close:function(){$("#inventory_content").remove()},width:810,height:660,zIndex:999999,position:[parseInt(c[0]),parseInt(c[1])],resizable:false,beforeclose:function(){if(document.getElementById("item_content")){document.getElementById("detail_settings").innerHTML="";document.getElementById("detail_settings").appendChild(document.createTextNode($("#item_content").offset().left+"|"+$("#item_content").offset().top));$("#item_content").remove()}document.getElementById("inventory_settings").innerHTML="";document.getElementById("inventory_settings").appendChild(document.createTextNode($("#inventory_content").offset().left+"|"+$("#inventory_content").offset().top))}});mwap_do_ajax("inventory","view","","&from_controller=inventory","",inventoryCallBack)}function refreshInventory(a){function b(a){var b="";var c="http://mwfb.static.zynga.com/mwfb/graphics/inventory/ItemCard/icons/";var d="https://zyngapv.hs.llnwd.net/e6/mwfb/graphics/quality/";var e='<img src="'+c+'Inventory-inactive-icon.png"  alt="inactive" title="inactive">';if(a.active)e='<img src="'+c+'Inventory-active-icon.png" alt="active" title="active">';var f="";if(a.tradeable)f='<img src="'+c+'Inventory-gift-icon.png" alt="Giftable" title="Giftable">';switch(a.quality){case 0:qtyTxt="common";break;case 1:qtyTxt="rare";break;case 2:qtyTxt="uncommon";break;case 3:qtyTxt="superior";break;case 4:qtyTxt="ultimate";break;default:qtyTxt="common";break}var g='<img src="'+d+"Inventory-"+qtyTxt+'-icon.png" alt="'+qtyTxt+'" title="'+qtyTxt+'">';b+='<li class="lt">'+f+'</li><li class="lt">'+e+'</li><li class="lt">'+g+'</li><li class="ln">'+a.id+":"+a.name+'</li><li class="ls">'+a.attack+'</li><li class="ls">'+a.defense+'</li><li class="ls">'+a.combined+'</li><li class="ls">'+a.quantity+'</li><li class="ls">'+a.equipped_offense+'</li><li class="ls">'+a.equipped_defense+"</li>"+'</li><li class="ls">'+a.total_offense+'</li><li class="ls">'+a.total_defense+'</li><li class="ls">'+a.total_combined+"</li>";return b}function c(a){var c=document.getElementById(a);if(!c)return;var d=c.getAttribute("rel").replace(/\|/g,'"');var e=JSON.parse(d);var f="RX6 Loot Analyser - Detail";$("#popup_fodder").append("<div id='item_content' class='item_content'></div>");var g=document.getElementById("item_content");var h="";h+='<ul class="RX6_detail" style="width:790px;">';h+=b(e);h+="</ul>";if(!document.getElementById("detail_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"detail_settings",style:"display:none;"})}else{if(document.getElementById("detail_settings").innerHTML)GM_setValue("inventorySettings",document.getElementById("detail_settings").innerHTML);else GM_setValue("inventorySettings","'top'|80")}g.innerHTML=h;var i=GM_getValue("detailSettings","'top'|80").split("|");$("#item_content").dialog({title:f,hide:"fade",show:"blind",close:function(){$("#item_content").remove()},width:815,height:420,zIndex:9999999,position:[parseInt(i[0]),parseInt(i[1])],resizable:false,beforeclose:function(){document.getElementById("detail_settings").innerHTML="";document.getElementById("detail_settings").appendChild(document.createTextNode($("#item_content").offset().left+"|"+$("#item_content").offset().top))}})}function d(a,b){b.combined=b.attack+b.defense;b.total_offense=b.equipped_offense*b.attack;b.total_defense=b.equipped_defense*b.defense;b.total_combined=b.total_offense+b.total_defense;a.push(b)}function e(b){if(a!="ok")return;if(b.equipped_offense||b.equipped_defense){myAttackStats[b.type]["attackstats"]+=b.equipped_offense*b.attack;myAttackStats[b.type]["defensestats"]+=b.equipped_defense*b.defense}}var f={alpha:function(a,b){var c=a.name.toLowerCase();var d=b.name.toLowerCase();return c<d?-1:c>d?1:0},attack:function(a,b){return b.attack-a.attack},defense:function(a,b){return b.defense-a.defense},combined:function(a,b){return b.attack+b.defense-(a.attack+a.defense)},quantity:function(a,b){return b.quantity-a.quantity}};var g={weapons:function(a){return a.type==1},armor:function(a){return a.type==2},vehicles:function(a){return a.type==3},animals:function(a){return a.type==8},henchmen:function(a){return a.type==13},extra:function(a){return a.type==4},bossloot:function(a){return a.type==5},jobmastery:function(a){return a.type==6},chest:function(a){return a.type==9}};var h={giftable:function(a){return a.tradeable},nongiftable:function(a){return!a.tradeable}};var i=0;var j=0;var k=0;var l=0;var m=0;var n=document.getElementById("inventoryTable");var o=document.getElementById("inventoryState");k=parseInt(o.value);var p=document.getElementById("inventoryType");i=parseInt(p.value);var q=document.getElementById("inventorySort");j=parseInt(q.value);var r=document.getElementById("inventoryOrder");l=parseInt(r.value);var s=document.getElementById("inventoryGift");m=parseInt(s.value);var t=[];var u=JSON.parse(GM_getValue("myItemList",JSON.stringify([])));switch(k){case 0:for(var v in u){e(u[v]);if(u[v]&&u[v].quantity&&u[v].active)d(t,u[v])}break;case 1:for(var v in u){e(u[v]);if(u[v]&&u[v].quantity&&u[v].equipped_offense)d(t,u[v])}break;case 2:for(var v in u){e(u[v]);if(u[v]&&u[v].quantity&&u[v].equipped_defense)d(t,u[v])}break;case 3:for(var v in u){e(u[v]);if(u[v]&&u[v].quantity&&!u[v].active)d(t,u[v])}break;case 4:for(var v in u){e(u[v]);if(u[v]&&u[v].quantity)d(t,u[v])}break}switch(i){case 0:t=t.filter(g.weapons);break;case 1:t=t.filter(g.armor);break;case 2:t=t.filter(g.vehicles);break;case 3:t=t.filter(g.animals);break;case 4:t=t.filter(g.henchmen);break;case 5:t=t.filter(g.extra);break;case 6:t=t.filter(g.bossloot);break;case 7:t=t.filter(g.jobmastery);break;case 8:t=t.filter(g.chest);break;default:break}switch(m){case 0:break;case 1:t=t.filter(h.giftable);break;case 2:t=t.filter(h.nongiftable);break;default:break}switch(j){case 0:t.sort(f.attack);break;case 1:t.sort(f.defense);break;case 2:t.sort(f.combined);break;case 3:t.sort(f.quantity);break;case 4:t.sort(f.alpha);break}if(l)t.reverse();var w='<ul class="inventory" style="width:790;margin:0px; padding:0px;height:380px;scroll:auto;">';for(var v in t){if(isUndefined(t[v].type))continue;var x=t[v];w+='<li id="RX6Item_'+x.id+'" rel="'+JSON.stringify(x).replace(/"/g,"|")+'">';w+='<ul class="inventory" style="width:790px;">';w+=b(x);w+="</ul>";w+="</li>"}w+="</ul>";n.innerHTML=w;var u=$x('.//li[contains(@id,"RX6Item")]');if(u.length){for(v=0;v<u.length;v++){var y=u[v].id.replace("RX6Item_","");u[v].setAttribute("rx6",y);u[v].addEventListener("click",function(){c(this.id)},false)}}if(a=="ok"){var z=document.getElementById("statsTable");var A=0;var B=0;var C=0;var w="";w+='<ul class="inventory">';w+='<li class="statHead">Category</li><li class="statHead">Attack Total</li><li class="statHead">Defense Total</li>';w+="</ul>";for(var v in myAttackStats){if(myAttackStats[v].attackstats+myAttackStats[v].defensestats>0){w+='<ul class="inventory">';w+='<li class="statHead">'+myAttackStats[v].name+'</li><li class="statHead">'+myAttackStats[v].attackstats+'</li><li class="statHead">'+myAttackStats[v].defensestats+"</li>";A+=myAttackStats[v].attackstats;B+=myAttackStats[v].defensestats;C+=myAttackStats[v].attackstats+myAttackStats[v].defensestats;w+="</ul>"}}w+='<ul class="inventory">';w+='<li class="statHead">Total</li><li class="statHead">'+A+'</li><li class="statHead">'+B+"</li>";w+="</ul>";z.innerHTML=w}}function showInventory(){var a=document.getElementById("inventory_content");if(!a)return;a.innerHTML="";var b=new Array("Active","Active - Attack","Active - Defense","Inactive","All");var c=new Array("Attack","Defense","Combined","Quantity","Alphabetic");var d=new Array("Weapons","Armor","Vehicles","Animals","Henchmen","Extra","Boss Loot","Job Mastery","Treasure Chest","All");var e=new Array("Ascending","Descending");var f=new Array("All","Giftable","Non-Giftable");var g={1:{name:"Weapons",attackstats:0,defensestats:0},2:{name:"Armor",attackstats:0,defensestats:0},3:{name:"Vehicles",attackstats:0,defensestats:0},8:{name:"Animals",attackstats:0,defensestats:0},13:{name:"Henchmen",attackstats:0,defensestats:0},4:{name:"Extra",attackstats:0,defensestats:0},5:{name:"Boss Loot",attackstats:0,defensestats:0},6:{name:"Job Mastery",attackstats:0,defensestats:0},9:{name:"Treasure Chests",attackstats:0,defensestats:0}};myAttackStats=g;var h=makeElement("select",a,{id:"inventoryState",title:"Loot Status","class":"RX6dropdown"});for(i=0,iLength=b.length;i<iLength;i++){choiceType=document.createElement("option");choiceType.text=b[i];choiceType.value=i;h.appendChild(choiceType)}h.addEventListener("change",refreshInventory,false);var j=makeElement("select",a,{id:"inventoryType",title:"Loot Type","class":"RX6dropdown"});for(i=0,iLength=d.length;i<iLength;i++){choiceType=document.createElement("option");choiceType.text=d[i];choiceType.value=i;j.appendChild(choiceType)}j.addEventListener("change",refreshInventory,false);var k=makeElement("select",a,{id:"inventorySort",title:"Sort Requirement","class":"RX6dropdown"});for(i=0,iLength=c.length;i<iLength;i++){choiceType=document.createElement("option");choiceType.text=c[i];choiceType.value=i;k.appendChild(choiceType)}k.addEventListener("change",refreshInventory,false);var l=makeElement("select",a,{id:"inventoryOrder",title:"Sort Order","class":"RX6dropdown"});for(i=0,iLength=e.length;i<iLength;i++){choiceType=document.createElement("option");choiceType.text=e[i];choiceType.value=i;l.appendChild(choiceType)}l.addEventListener("change",refreshInventory,false);var m=makeElement("select",a,{id:"inventoryGift",title:"Giftable/Non-Giftable","class":"RX6dropdown"});for(i=0,iLength=f.length;i<iLength;i++){choiceType=document.createElement("option");choiceType.text=f[i];choiceType.value=i;m.appendChild(choiceType)}m.addEventListener("change",refreshInventory,false);var n=makeElement("ul",a,{id:"inventoryHeader","class":"inventory",style:"width:790px;"});n.innerHTML='<li class="head">Gift</li><li class="head">State</li><li class="head">Quality</li><li class="head" style="width:195px">Name</li><li class="head">Att</li><li class="head" style="width:40px">Def</li><li class="head">Comb</li><li class="head">Qty</li><li class="head">Qty A</li><li class="head">Qty D</li><li class="head">TotAtt</li><li class="head">TotDef</li><li class="head">TotComb</li>';var o=makeElement("div",a,{id:"inventoryTable"});var p=makeElement("div",a,{id:"statsTable"});refreshInventory("ok")}function inventoryCallBack(a,b,c,d,e,f,g){function h(a){this.id=a.id;this.name=a.name;this.attack=a.attack;this.defense=a.defense;this.quantity=a.quantity;this.active=a.active;this.tradeable=a.tradeable;this.quality=a.quality;this.equipped_offense=a.equipped_offense;this.equipped_defense=a.equipped_defense;this.type=a.type;this.imagesrc=a.imagesrc}var j=g.responseText;i1=j.indexOf("var Items")+20;i2=j.indexOf("};",i1);var k=JSON.parse(j.substring(i1,i2));var l=[];for(i in k){if(k[i].quantity){var m=new h(k[i]);l.push(m)}}GM_setValue("myItemList",JSON.stringify(l));showInventory()}function gotoMWLink(){var a=decodeURIComponent(document.getElementById("gotoInput").value);var b="http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?";if(a.match(/user":"(.+)"/)){var c=decodeID(RegExp.$1).digitize();b+="xw_controller=stats&xw_action=view&xw_city="+city+"&xw_person="+xw_user+"&user=p%7C"+c;document.getElementById("gotoLink").setAttribute("href",b)}else if(a.match(/"id":"(.+)"/)){b+="xw_controller=clan&xw_action=view&xw_city="+city+"&xw_person="+xw_user+"&id="+RegExp.$1+"&from_red_link=1";document.getElementById("gotoLink").setAttribute("href",b)}else alert("Invalid MW link.")}function gotoMWLink2(){var a=decodeURIComponent(document.getElementById("gotoInput2").value);var b;b="http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?";b+="xw_controller=stats&xw_action=view&xw_city="+city+"&xw_person="+xw_user+"&user=p%7C"+a;document.getElementById("gotoLink1").setAttribute("href",b);b="http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?";b+="xw_controller=clan&xw_action=view&xw_city="+city+"&xw_person="+xw_user+"&id="+encode64(a)+"&from_red_link=1";document.getElementById("gotoLink2").setAttribute("href",b)}function addBorkalector(){if(document.getElementById("aim_content"))return;var a="RX6 Borkalector";$("#popup_fodder").append("<div id='aim_content' style='text-align:center;'></div>");var b=document.getElementById("aim_content");if(!document.getElementById("aim_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"aim_settings",style:"display:none;"})}else{if(document.getElementById("aim_settings").innerHTML)GM_setValue("aimSettings",document.getElementById("aim_settings").innerHTML);else GM_setValue("aimSettings","'center'|80")}if(!document.getElementById("gotoInput")){title="Enter MW Link";id="gotoInput";var c=makeElement("input",b,{type:"text",id:id,title:title,style:"width: 300px;"});c.addEventListener("change",gotoMWLink2,false);makeElement("br",b);title="go to MW Link";id="gotoLink";eltA=makeElement("a",b,{id:id,href:"#",alt:title,title:title,selector:"#inner_page"});eltA.appendChild(document.createTextNode(title));makeElement("br",b);makeElement("br",b);title="Enter User / Family ID";id="gotoInput2";var c=makeElement("input",b,{type:"text",id:id,title:title,style:"width: 100px;"});c.addEventListener("change",gotoMWLink2,false);makeElement("br",b);title="go to User Profile";id="gotoLink1";eltA=makeElement("a",b,{id:id,href:"#",alt:title,title:title,selector:"#inner_page",style:"margin-right:10px;"});eltA.appendChild(document.createTextNode(title));title="go to Family Page";id="gotoLink2";eltA=makeElement("a",b,{id:id,href:"#",alt:title,title:title,selector:"#inner_page",style:"margin-left:10px;"});eltA.appendChild(document.createTextNode(title));var d=GM_getValue("aimSettings","'center'|80").split("|");$("#aim_content").dialog({title:a,hide:"fade",show:"blind",close:function(){$("#aim_content").remove()},width:350,height:150,zIndex:999999,position:[parseInt(d[0]),parseInt(d[1])],resizable:false,beforeclose:function(){document.getElementById("aim_settings").innerHTML="";document.getElementById("aim_settings").appendChild(document.createTextNode($("#aim_content").offset().left+"|"+$("#aim_content").offset().top))}})}}function convertMWLink(){var a;var b=decodeURIComponent(document.getElementById("convertInput").value);var c=document.getElementById("convertedID");if(b.match(/user":"(.+)"/))a=decodeID(RegExp.$1).digitize();else if(b.match(/"id":"(.+)"/))a=decodeID(RegExp.$1).digitize();if(a&&c)c.innerHTML="MW Id: "+a;else alert("Invalid MW link.");document.getElementById("convertInput").value=""}function addBorkavertor(){if(document.getElementById("bork_content"))return;var a="RX6 Borkavertor";$("#popup_fodder").append("<div id='bork_content' style='text-align:center;'></div>");var b=document.getElementById("bork_content");if(!document.getElementById("bork_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"bork_settings",style:"display:none;"})}else{if(document.getElementById("bork_settings").innerHTML)GM_setValue("borkSettings",document.getElementById("bork_settings").innerHTML);else GM_setValue("borkSettings","'center'|80")}if(!document.getElementById("convertUserInput")){title="Enter MW Link";id="convertInput";makeElement("input",b,{type:"text",id:id,title:title,style:"width: 300px;"});makeElement("br",b);title="Convert MW Link";id="convertLink";eltA=makeElement("a",b,{id:id,href:"#",alt:title,title:title});eltA.appendChild(document.createTextNode(title));eltA.addEventListener("click",convertMWLink,false);makeElement("br",b);title="MW ID";id="convertedID";eltA=makeElement("span",b,{id:id,alt:title,title:title}).appendChild(document.createTextNode("MW Id: "));var c=GM_getValue("borkSettings","'center'|80").split("|");$("#bork_content").dialog({title:a,hide:"fade",show:"blind",close:function(){$("#bork_content").remove()},width:350,height:100,zIndex:999999,position:[parseInt(c[0]),parseInt(c[1])],resizable:false,beforeclose:function(){document.getElementById("bork_settings").innerHTML="";document.getElementById("bork_settings").appendChild(document.createTextNode($("#bork_content").offset().left+"|"+$("#bork_content").offset().top))}})}}function addBorkavatorMap(){if(document.getElementById("map_content"))return;var a="RX6 Borkavator Map";$("#popup_fodder").append("<div id='map_content'></div>");var b=document.getElementById("map_content");if(!document.getElementById("map_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"map_settings",style:"display:none;"})}else{if(document.getElementById("map_settings").innerHTML)GM_setValue("mapSettings",document.getElementById("map_settings").innerHTML);else GM_setValue("mapSettings","'center'|80")}if(!document.getElementById("mwapSpringMap")){var c=makeElement("div",b,{id:"mwapSpringMap",title:"mwapSpringMap",style:"width:290px;padding:10px;"});for(i=0,iLength=cities.length;i<iLength;i++){if(!cities[i][CITY_CLOSED]){choiceTier=document.createElement("p");choiceTier.appendChild(document.createTextNode(cities[i][CITY_NAME].toUpperCase()));c.appendChild(choiceTier);for(j=0,jLength=missionTabs[i].length;j<jLength;j++){var d=j+1;choiceTier=makeElement("a",c,{title:missionTabs[i][j],style:"border:1px solid;padding:0px 5px 0px 5px;margin:5px;"});choiceTier.text=d;choiceTier.name=i+"|"+d;c.appendChild(choiceTier);choiceTier.addEventListener("click",mwapSpringMap,false)}}}var e=GM_getValue("mapSettings","'center'|80").split("|");$("#map_content").dialog({title:a,hide:"fade",show:"blind",close:function(){$("#map_content").remove()},width:325,zIndex:999999,position:[parseInt(e[0]),parseInt(e[1])],resizable:false,beforeclose:function(){document.getElementById("map_settings").innerHTML="";document.getElementById("map_settings").appendChild(document.createTextNode($("#map_content").offset().left+"|"+$("#map_content").offset().top))}})}}function addBorkavatorSelect(){if(document.getElementById("list_content"))return;var a="RX6 Borkavator List";$("#popup_fodder").append("<div id='list_content'></div>");var b=document.getElementById("list_content");if(!document.getElementById("list_settings")){makeElement("div",document.getElementById("popup_fodder"),{id:"list_settings",style:"display:none;"})}else{if(document.getElementById("list_settings").innerHTML)GM_setValue("listSettings",document.getElementById("list_settings").innerHTML);else GM_setValue("listSettings","'center'|80")}if(!document.getElementById("mwapSpringList")){var c=makeElement("select",b,{id:"mwapSpringList",title:"mwapSpringList",style:"width:230px;"});choiceTier=document.createElement("option");choiceTier.text="RX6 MWAP Borkavator List";choiceTier.value="";c.appendChild(choiceTier);for(i=0,iLength=cities.length;i<iLength;i++){if(!cities[i][CITY_CLOSED]){choiceTier=document.createElement("optgroup");choiceTier.label=cities[i][CITY_NAME].toUpperCase();choiceTier.className="ap_optgroup1";c.appendChild(choiceTier);for(j=0,jLength=missionTabs[i].length;j<jLength;j++){var d=j+1;choiceTier=document.createElement("option");choiceTier.text=missionTabs[i][j];choiceTier.value=i+"|"+d;c.appendChild(choiceTier)}}}c.addEventListener("change",mwapSpringList,false);var e=GM_getValue("listSettings","'center'|80").split("|");$("#list_content").dialog({title:a,hide:"fade",show:"blind",close:function(){$("#list_content").remove()},width:250,height:85,zIndex:999999,position:[parseInt(e[0]),parseInt(e[1])],resizable:false,beforeclose:function(){document.getElementById("list_settings").innerHTML="";document.getElementById("list_settings").appendChild(document.createTextNode($("#list_content").offset().left+"|"+$("#list_content").offset().top))}})}}function mwapSpringList(){var a=document.getElementById("mwapSpringList");var b=a.value;mwapJump(b);a.selectedIndex=0}function mwapSpringMap(){var a=this;var b=a.name;mwapJump(b)}function mwapJump(a){var b=a.split("|");var c=b[0];var d=parseInt(b[1]);var e=d-1;if(isNewCity(c)){var f=function(a,b,e){return e[b][MISSION_CITY]==c&&e[b][MISSION_TAB]==d};var g=missions.filter(f);if(g[0][MISSION_TABPATH])d=g[0][MISSION_TABPATH]}var h=makeElement("a",null,{onclick:'return do_ajax("inner_page","remote/html_server.php?xw_controller=travel&xw_action=travel&xw_city='+city+"&from=job&zone=1&destination="+cities[c][CITY_NUMBER]+"&tab="+d+'", 1, 1 ,0, 0); return false;'});if(h){clickElement(h);addToLog("info Icon","Springboard used to go to "+cities[c][CITY_NAME]+" - "+missionTabs[c][e]);return true}}function mwapNewSettings(){function a(a){var b=$x('.//div[@class="tabcontent"]');if(b&&b.length){for(i=0,iLength=b.length;i<iLength;i++){if(b[i].id==a){b[i].style.display="block";$("#currentTab").html("");$("#currentTab").append(b[i].id)}else b[i].style.display="none"}}}$.fx.speeds._default=700;$("#popup_fodder").append("<div id='currentTab' style='display:none;'></div>");$("#popup_fodder").append("<div id='mwapNewSettings'></div>");var b=document.getElementById("mwapNewSettings");$("#mwapNewSettings").dialog({title:"RX6 MWAP Settings - mwap.me.uk - Help? playerscripts.co.uk/pswiki",hide:"drop",show:"fade",buttons:[{text:"Cash",click:function(){a("cashTab");$("span.ui-dialog-title").text("RX6 Cash & Properties Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Health",click:function(){a("healTab");$("span.ui-dialog-title").text("RX6 Health Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Stamina",click:function(){a("staminaTab");$("span.ui-dialog-title").text("RX6 Stamina Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Energy",click:function(){a("energyTab");$("span.ui-dialog-title").text("RX6 Energy Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"AutoStat",click:function(){a("autostatTab");$("span.ui-dialog-title").text("RX6 AutoStat Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Family",click:function(){a("familyTab");$("span.ui-dialog-title").text("RX6 Family & Operations Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Mafia",click:function(){a("mafiaTab");$("span.ui-dialog-title").text("RX6 Mafia Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Display",click:function(){a("displayTab");$("span.ui-dialog-title").text("RX6 Display Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"General",click:function(){a("generalTab");$("span.ui-dialog-title").text("RX6 General Settings : mwap.me.uk : Help? playerscripts.co.uk/pswiki")}},{text:"Save","class":"RX6-ui-state-save",click:function(){window.setTimeout(saveSettings,0)}},{text:"Close","class":"RX6-ui-state-close",click:function(){$("#mwapNewSettings").remove()}}],close:function(){$("#mwapNewSettings").remove()},minWidth:805,height:550,zIndex:999999,position:["center",80]});var c=createGeneralTabNew2012();b.appendChild(c);var d=createDisplayTabNew2012();b.appendChild(d);var e=createMafiaTabNew2012();b.appendChild(e);var f=createFamilyTabNew2012();b.appendChild(f);var g=createAutostatTabNew2012();b.appendChild(g);var h=createEnergyTabNew2012();b.appendChild(h);var j=createStaminaTabNew2012();b.appendChild(j);var k=createHealTabNew2012();b.appendChild(k);var l=createCashTabNew2012();b.appendChild(l);var m;if(document.getElementById("currentTab"))m=document.getElementById("currentTab").innerHTML;if(!m)m=GM_getValue("currentTab","generalTab");a(m)}function customizeStats(){setListenStats(false);var a=xpathFirst('.//div[@id="game_stats"]//div[@id="cash_stats_'+cities[city][CITY_ALIAS]+'"]/h4/a[@id="mwap_bank"]',statsrowElt);var b=xpathFirst('.//div[@id="game_stats"]//div[@id="cash_stats_'+cities[city][CITY_ALIAS]+'"]/h4/text()',statsrowElt);if(b&&!a){a=makeElement("a",null,{id:"mwap_bank",title:"Click to bank immediately."});b.parentNode.insertBefore(a,b);a.appendChild(b);a.addEventListener("click",quickBank,false)}var c=document.getElementById("mwap_nrg");var d=xpathFirst('./div[@class="mw_header"]//div[@class="mid_row_text energy_text_bg" and contains(text(), "ENERGY")]',statsrowElt);if(!d)d=xpathFirst('.//div[@id="game_stats"]//h4[@class="energy" and contains(text(), "Energy")]',statsrowElt);if(!d)d=xpathFirst('.//div[@id="game_stats"]//span[@class="stat_title" and contains(text(),"Energy")]',statsrowElt);if(d&&!c){if(isGMChecked("autoMission")){var e="Spend Energy ON.  ";d.style.color="#33FF00"}else{var e="Spend Energy OFF.  ";d.style.color="#FF0000"}selectedTierValue=GM_getValue("selectTier","0.0").split(".");masteryCity=parseInt(selectedTierValue[0]);masteryTier=parseInt(selectedTierValue[1]);if(masteryCity==0&&(masteryTier==0||masteryTier==undefined)){e+=" Mastering- Turned OFF "}else{e+=" Mastering-"+cities[masteryCity][CITY_NAME]+", District/Region-"+masteryTier+" "+missionTabs[masteryCity][masteryTier-1]}d.style.textDecoration="underline";c=makeElement("a",null,{id:"mwap_nrg",title:e});d.parentNode.insertBefore(c,d);c.appendChild(d);c.addEventListener("click",toggleNrgSpend,false);var f=document.getElementById("mwap_epack");if(!f){var g=getHoursTime("miniPackTimer");if(g==0||g==undefined)var h="Mini-Pack available now. ";else var h=g+" until Mini-Pack is available. ";h+=" Click to attempt to fire immediately.";if(isGMChecked("mastheadOnTop"))var i="0px";else var i="60px";f=makeElement("a",null,{id:"mwap_Fire_epak",title:h,style:"position:absolute;top:"+i+"; right:1046px;"});if(g==0||g==undefined){var j=mini_Epak_ready;f.innerHTML=mini_Epak_ready;var k="EP"}else{var j=mini_Epak_wait;f.innerHTML=mini_Epak_wait;var k="na"}mepakParent=c.parentNode;mepakParent.insertBefore(f,mepakParent.childNodes[2]);f.appendChild(document.createTextNode(k));f.addEventListener("click",miniPackForce,false)}}var l=document.getElementById("mwap_stam");var m=xpathFirst('./div[@class="mw_header"]//div[@class="mid_row_text stamina_text_bg" and contains(text(), "STAMINA")]',statsrowElt);if(!m)m=xpathFirst('.//div[@id="game_stats"]//h4[contains(text(), "Stamina")]',statsrowElt);if(!m)m=xpathFirst('.//div[@id="game_stats"]//span[@class="stat_title" and contains(text(),"Stamina")]',statsrowElt);if(m&&!l){if(isGMChecked("staminaSpend")){var n="Spend Stamina ON.  ";m.style.color="#33FF00"}else{var n="Spend Stamina OFF.  ";m.style.color="#FF0000"}n+="Minimum Stamina for auto-healing set at "+GM_getValue("stamina_min_heal")+" points.";var o=getStaminaMode();n+=" Stamina Spend Mode: "+staminaSpendChoices[o];m.style.textDecoration="underline";l=makeElement("a",null,{id:"mwap_stam",title:n});m.parentNode.insertBefore(l,m);l.appendChild(m);l.addEventListener("click",toggleStamSpend,false)}var p=xpathFirst('.//div[@id="game_stats"]//a[@class="heal_link" or @class="heal_link vt-p"]',statsrowElt);var q=document.getElementById("mwap_heal");var r=xpathFirst('./div[@class="mw_header"]//div[@class="mid_row_text health_text_bg" and contains(text(), "HEALTH")]',statsrowElt);if(!r)r=xpathFirst('.//div[@id="game_stats"]//h4[@class="health" and contains(text(), "Health")]',statsrowElt);if(!r)r=xpathFirst('.//div[@id="game_stats"]//span[@class="stat_title" and contains(text(),"Health")]',statsrowElt);if(r){if(!q){r.style.color="#FF0000";r.style.textDecoration="underline";r.style.display="inline-block";q=makeElement("a",null,{id:"mwap_heal",title:"Click to heal immediately."});r.parentNode.insertBefore(q,r);q.appendChild(r);q.style.textDecoration="none";var s=document.getElementById("mwap_toggleheal");if(!s){if(!isGMChecked("autoHeal")){newLinkTitle="autoHeal unchecked"}else{if(getStaminaMode()==STAMINA_HOW_FIGHTROB)newLinkTitle="autoHeal checked BUT OVERRULED - healing in "+locations[GM_getValue("healLocation")]+" when health falls below "+GM_getValue("healthLevel")+".";else newLinkTitle="autoHeal checked - healing in "+locations[GM_getValue("healLocation")]+" when health falls below "+GM_getValue("healthLevel")+"."}s=makeElement("a",null,{id:"mwap_toggleheal",title:newLinkTitle});if(!isGMChecked("autoHeal")){s.innerHTML=healOffIcon}else{if(getStaminaMode()==STAMINA_HOW_FIGHTROB)s.innerHTML=healOnHoldIcon;else s.innerHTML=healOnIcon}s.style.padding="5px 0px 0px 8px";s.style.position="absolute";healParent=q.parentNode;healParent.insertBefore(s,healParent.childNodes[2]);s.addEventListener("click",toggleHeal,false)}}var t=/transparent url/i.test(r.getAttribute("style"));if(health<20&&isGMChecked("hideInHospital")){if(!t){r.style.background="transparent url("+stripURI(hideIcon)+") no-repeat scroll 0 50%";r.title="Currently hiding in the hospital. Click to heal immediately."}}else if(t){r.style.background="";r.title="Click to heal immediately."}if(p)q.addEventListener("click",autoHeal,false)}energyElt.style.textDecoration=energy==maxEnergy?"blink":"none";staminaElt.style.textDecoration=stamina==maxStamina?"blink":"none";healthElt.style.textDecoration=health>19&&health<29?"blink":"none";if(isGMChecked("forceHealOpt5")&&health<20&&GM_getValue("healWaitStarted")!=true){setGMTime("healWaitTime","05:00");GM_setValue("healWaitStarted",true)}setListenStats(true)}function toggleHeal(){if(!document.getElementById("mwap_toggleheal"))return;if(isGMChecked("autoHeal")){GM_setValue("autoHeal",0);document.getElementById("mwap_toggleheal").innerHTML=healOffIcon;document.getElementById("mwap_toggleheal").title="autoHeal unchecked";addToLog("healOffIcon Icon","autoHeal turned OFF by User")}else{GM_setValue("autoHeal","checked");if(getStaminaMode()==STAMINA_HOW_FIGHTROB){document.getElementById("mwap_toggleheal").innerHTML=healOnHoldIcon;document.getElementById("mwap_toggleheal").title="autoHeal checked BUT OVERRULED - healing in "+locations[GM_getValue("healLocation")]+" when health falls below "+GM_getValue("healthLevel")+".";addToLog("healOnHoldIcon Icon","autoHeal turned ON by User, but overruled")}else{document.getElementById("mwap_toggleheal").innerHTML=healOnIcon;document.getElementById("mwap_toggleheal").title="autoHeal checked - healing in "+locations[GM_getValue("healLocation")]+" when health falls below "+GM_getValue("healthLevel")+".";addToLog("healOnIcon Icon","autoHeal turned ON by User")}}}function toggleNrgSpend(){if(isGMChecked("autoMission")){GM_setValue("autoMission",0);addToLog("info Icon","Energy Spend turned OFF by User")}else{GM_setValue("autoMission","checked");addToLog("info Icon","Energy turned ON by User")}update_nrg_stam()}function toggleStamSpend(){if(isGMChecked("staminaSpend")){GM_setValue("staminaSpend",0);addToLog("info Icon","staminaSpend turned OFF by User")}else{GM_setValue("staminaSpend","checked");addToLog("info Icon","staminaSpend turned ON by User")}update_nrg_stam()}function quickBank(a,b){if(isNaN(b)){if(isNaN(a))a=city;cashElt=document.getElementById("user_cash_"+cities[a][CITY_ALIAS]);if(cashElt)b=parseCash(cashElt.innerHTML);else b=cities[a][CITY_CASH]}if(a==LV){if(GM_getValue("vaultHandling",0)){var c=GM_getIntValue("vaultSpace",0);if((c<=0||!GM_getValue("vegasReport",""))&&!timeLeftGM("checkVaultTimer")){addToLog("info Icon","Your vault appears to be full, rechecking...");setGMTime("checkVaultTimer","2 hours");checkPropertyStatus(LV,false);return false}b=b>c?c:b}var d="xw_controller=propertyV2&xw_action=doaction&xw_city=5&doaction=ActionBankDeposit&building_type=6&city=5&amount="+b}else{var d="xw_controller=bank&xw_action=deposit_all&xw_city="+cities[a][CITY_NUMBER]}if(b<10)return false;if(b>1e11){addToLog("updateBad Icon",'Depositing <strong class="good">'+cities[a][CITY_CASH_SYMBOL]+makeCommaValue(b)+'</strong>!?!<strong class="bad"> HELL NO!</strong> Sink it from the banking page.');quickBankFail=true;return false}if(city!=a){DEBUG("Switching city too fast, not quick-banking.");return false}var e=createAjaxPage(false,"quick deposit",a);var f=makeElement("a",null,{onclick:'return do_ajax("'+e+'","remote/html_server.php?'+d+'", 1, 1, 0, 0); return false;'});clickElement(f);DEBUG("Clicked to quickbank in "+cities[a][CITY_NUMBER]+" / "+cities[a][CITY_NAME]);return false}function customizeHome(){var a=document.getElementById("snapi_zbar");if(a)a.parentNode.parentNode.removeChild(a.parentNode);a=document.getElementById("mw_like_button");if(a)a.style.display="none";odiv=xpathFirst('.//iframe[@name="mafiawars_zbar"]');if(a){a.style.display="none";if(a.parentNode)a.parentNode.removeChild(a)}var b=$x('.//div[contains(@id,"cpa") and contains(@id,"banner")]');for(i=0;i<b.length;i++){a=b[i];if(a){a.style.display="none";if(a.parentNode)a.parentNode.removeChild(a)}}if(!onHome())return false;var c=xpathFirst('//div[@id="marketInfo"]');if(!running&&!c){var d=xpathFirst('.//div[@id="MainModule"]',innerPageElt);if(d)d.style.height="";var e=xpathFirst('.//div[@class="empire_main_module"]',innerPageElt);var f=createAjaxPage(false,"marketplace",e);var g=makeElement("a",null,{onclick:'return do_ajax("'+f+'","'+SCRIPT.controller+"marketplace"+SCRIPT.action+'marketplace_category&category=8", 1, 1, 0, 0); return false;'});clickElement(g);return true}return true}function getPlayerStats(){var a=xpathFirst('.//table[contains(.,"Attack:") and contains(.,"Defense:")]',innerPageElt);if(a){DEBUG("Fetching stats from profile page");var b=xpathFirst('.//tr[contains(.,"Attack:")]',a);if(b&&b.innerHTML.match(/>\s*(\d+)/)){curAttack=parseInt(RegExp.$1);GM_setValue("curAttack",curAttack)}var c=xpathFirst('.//tr[contains(.,"Defense:")]',a);if(c&&c.innerHTML.match(/>\s*(\d+)/)){curDefense=parseInt(RegExp.$1);GM_setValue("curDefense",curDefense)}if(isUndefined(curAttack)||isUndefined(curDefense)){addToLog("info icon","Current status attributes cannot be detected, turning off auto-stat.");GM_setValue("autoStat",0)}}}function getPlayerEquip(){if(!onFightTab()&&!onInventoryTab()&&!onLootTab())return;var a=xpathFirst('.//div[@id="mafia_attack_strength"]',innerPageElt);if(a){prevAttackEquip=curAttackEquip;if(a.innerHTML.untag().match(/(.+)\(/))curAttackEquip=parseInt(RegExp.$1.digitize());var b=xpathFirst('.//span[@title="Family Property Bonus"]',a);if(b)curAttackEquip+=parseInt(b.innerHTML.digitize());GM_setValue("curAttackEquip",curAttackEquip)}a=xpathFirst('.//div[@id="mafia_defense_strength"]',innerPageElt);if(a){prevDefenseEquip=curDefenseEquip;if(a.innerHTML.untag().match(/(.+)\(/))curDefenseEquip=parseInt(RegExp.$1.digitize());var b=xpathFirst('.//span[@title="Family Property Bonus"]',a);if(b)curDefenseEquip+=parseInt(b.innerHTML.digitize());GM_setValue("curDefenseEquip",curDefenseEquip)}if(isUndefined(curAttackEquip)||isUndefined(curDefenseEquip))DEBUG("Current equipment attributes cannot be detected.")}function customizeProfile(){var a=xpathFirst('.//div[@id="clan_main"]/strong');if(a){var b=decodeURIComponent(a.innerHTML.untag());var c="";if(b.match(/"id":"(.+)"/))c=decodeID(RegExp.$1).digitize();if(c){var d=xpathFirst('.//div[@id="clan_header"]/h3');var e=makeElement("span",d,{style:"float:right"});e.appendChild(document.createTextNode(" (MW Clan ID: "+c+")"))}}var f=xpathFirst('.//td[@class="stats_left"]',innerPageElt);if(!f)return false;getPlayerStats();this.buildAnchor=function(a){var b={};if(a.URLSegment){b.href="http://mwfb.zynga.com/mwfb/remote/html_server.php?"+a.URLSegment}else if(a.href){b.href=a.href}else{b.href="#"}if(!a.clickEvent&&a.URLSegment){b.onclick="return do_ajax('inner_page', '/remote/html_server.php?"+a.URLSegment+"', 1, 1, 0, 0); return false; "}if(a.id){b.id=a.id}var c=makeElement("a",g,b);if(a.AnchorText){c.appendChild(document.createTextNode(a.AnchorText))}if(a.clickEvent){c.addEventListener("click",a.clickEvent,false)}return c};var g=xpathFirst('.//a[contains(., "Sucker Punch")]/..',innerPageElt);if(g){var h=xpathFirst('.//li[contains(@class, "tab_on")]//a[contains(text(), "Profile")]',innerPageElt);if(h){var i;var j;var k;var l;if(h.getAttribute("onclick").match(/tmp=([\d,a-z]+)&cb=([\d,a-z]+)&user=p\|(\d+)/)){k="tmp="+RegExp.$1+"&";l="cb="+RegExp.$2+"&";i="p|"+RegExp.$3}if(!i&&h.getAttribute("onclick").match(/user=p\|(\d+)/))i="p|"+RegExp.$1;if(m=/xw_controller=robbing.*?target=([0-9]+)/.exec(document.getElementById("inner_page").innerHTML)){j=m[1]}if(m=/xw_controller=stats.*?user=([0-9]+)/.exec(document.getElementById("inner_page").innerHTML)){j=m[1]}if(m=/xw_action=gift_wishlist.*?user=([0-9]+)/.exec(document.getElementById("inner_page").innerHTML)){j=m[1]}if(m=/q([0-9]+)_(\d+)\.jpg/.exec(document.getElementById("inner_page").innerHTML)){j=m[1]}if(document.getElementsByClassName("fightres_image").length>1){var n=/(\d+)_(\d+)_q.jpg/.exec(document.getElementsByClassName("fightres_image")[1].innerHTML);j=n[1]}if(m=/xw_controller=VegasSlots.+?friend_id=([0-9]+)/i.exec(document.getElementById("inner_page").innerHTML)){j=m[1]}if(m=/([0-9]+)_(\d+)\_q.jpg/.exec(document.getElementById("inner_page").innerHTML)){j=m[1]}if((m=/user%2522.*?%2522([0-9A-Za-z%]+)%2522/.exec(document.getElementById("mainDiv").innerHTML))||(m=/user%22.*?%22([0-9A-Za-z%]+)%22/.exec(document.getElementById("mainDiv").innerHTML))){j=atob(m[1].replace(/%253D/g,"=").replace(/%3D/g,"="))}if(!k&&h.getAttribute("onclick").match(/tmp=([\d,a-z]+)&/)){k="tmp="+RegExp.$1+"&"}if(!l&&h.getAttribute("onclick").match(/cb=([\d,a-z]+)&/)){l="cb="+RegExp.$2+"&"}DEBUG("Profile: Mafia Wars ID: "+i+" Facebook ID: "+j);var o=i.replace("p|","");var p=xpathFirst('.//a[contains(., "Remove from Mafia")]',g);if(!running&&!p){var q=xpathFirst('./div[@class="title stats_title"]',innerPageElt);if(q){q.setAttribute("style","background: black;")}var r=createAjaxPage(false,"icecheck profile",q);var s=xpathFirst('.//a[contains(., "Add to Hitlist")]',innerPageElt);var t=makeElement("a",null,null);var u=s.getAttribute("onclick");u=u.replace("inner_page",r);t.setAttribute("onclick",u);clickElement(t)}if(document.getElementById("where_are_my_links"))return true;var v=false;makeElement("a",g,{id:"where_are_my_links",href:'javascript:alert("Due to the way Mafia Wars links to Facebook there are times where RX6 MWAP cannot find the Facebook profile ID. In those situations RX6 MWAP will not display buttons that require that ID. You can make the Facebook ID available by refreshing the profile page.");'}).appendChild(document.createTextNode("Where are my links?"));g.appendChild(document.createTextNode(" | "));makeElement("a",g,{href:"http://facebook.mafiawars.com/mwfb/remote/html_server.php?xw_controller=stats&xw_action=view&xw_city=1&user="+i}).appendChild(document.createTextNode("Refresh this profile!"));v=true;if(j){if(v)g.appendChild(document.createTextNode(" | "));makeElement("a",g,{href:"http://www.facebook.com/profile.php?id="+j,target:"_blank"}).appendChild(document.createTextNode("Facebook Profile"));g.appendChild(document.createTextNode(" | "));makeElement("a",g,{href:"http://www.facebook.com/addfriend.php?id="+j,target:"_blank"}).appendChild(document.createTextNode("Add as Friend"));v=true}if(p){if(v)g.appendChild(document.createTextNode(" | "));this.buildAnchor({AnchorText:"Promote",URLSegment:"xw_controller=group&"+"xw_action=view&"+"xw_city="+(city+1)+"&"+k+l+"promote=yes&"+"pid="+i});v=true}if(v)makeElement("br",g,{});v=false;if(p){var w=getSavedList("autoWarTargetList").indexOf(o)!=-1;this.buildAnchor({AnchorText:w?"Remove from War List":"Add to AutoWar List",id:o,title:"In the settings box, under the mafia tab\nIf you have selected war friends from a list\nupdates the friends ids in the box",clickEvent:w?clickWarListRemove:clickWarListAdd});v=true}if(v)g.appendChild(document.createTextNode(" | "));var x=getSavedList("pautoHitOpponentList").indexOf(o)!=-1;this.buildAnchor({AnchorText:x?"Remove from AutoHit List":"Add to AutoHit List",id:o,title:"In the settings box, under the stamina tab\nIf you have selected hitlist opponents \nHitlist these opponents:",clickEvent:x?clickAutoHitListRemove:clickAutoHitListAdd});v=true;if(!p){if(v)g.appendChild(document.createTextNode(" | "));v=true;var y=getSavedList("pfightlist").indexOf(o)!=-1;this.buildAnchor({AnchorText:y?"Remove from Fight List":"Add to AutoFight List",id:o,title:"In the settings box, under the stamina tab\nIf you have selected fight specific opponents\nFight these opponents:",clickEvent:y?clickFightListRemove:clickFightListAdd})}if(v)makeElement("br",g,{})}}return true}function getBrazilJobMastery(a){if(a.innerHTML.untag().match(/(\d+)%/i))return parseInt(RegExp.$1);if(a.innerHTML.untag().match(/(\d+)%\s?mastered/i))return parseInt(RegExp.$1);DEBUG("No mastery items found. Assuming 0% mastery level.");return 0}function getJobMastery(a,b){if(b){var c=100;if(isJobFight(a)&&isGMChecked("skipfight"))return 100;if(a.innerHTML.untag().match(/>(\d+)%\s+Job\s+Mastery/i)||a.innerHTML.untag().match(/(\d+)%/i)||a.innerHTML.match(/Job\s+Mastery\s+(\d+)%/i)||a.innerHTML.match(/>(\d+)%/i)){c=parseInt(RegExp.$1)}else{if(a.innerHTML.untag().match(/margin-right:\s+(\d+)%/i)){c=100-parseInt(RegExp.$1)}}return c}if(/Mastered/i.test(a.innerHTML)||isJobLocked(a)){return 100}else if(a.innerHTML.match(/Job\s+Mastery\s+(\d+)%/i)||a.innerHTML.match(/>(\d+)%/i)){c=parseInt(RegExp.$1);return c}DEBUG("No mastery items found. Assuming 0% mastery level.");return 0}function jobMastery(a,b){if(isGMChecked("repeatJob"))return;var c=GM_getIntValue("selectMission",1);var d=missions[c][MISSION_NAME];var e=missions[c][MISSION_NUMBER];var f=missions[c][MISSION_TAB];var g=missions[c][MISSION_TABPATH];var h=missions[c][MISSION_CITY];var i=f;if(isNewCity(city)&&g)i=g;if(city!=h||!onJobTab(i))return;var j=getJobRow(d,a);var k=0;var l=-1;if(j)l=getJobMastery(j,b);DEBUG("Job '"+d+"' is "+l+" % complete");var m=l==100;if(j){if(b&&j.className.match(/level_(\d+)/i)){k=RegExp.$1}else if(j.innerHTML.match(/level (\d+)/i)){k=RegExp.$1}}var n=0;var o=0;var p=c;var q=false;for(var r=0,s=missions.length;r<s;r++){if(city==missions[r][MISSION_CITY]&&f==missions[r][MISSION_TAB]){var t=getJobRow(missions[r][MISSION_NAME]);if(t){var u=getJobMastery(t,b);if(isGMChecked("skipfight")&&!isJobFight(t)||!isGMChecked("skipfight")){n+=u;o++;if(!q&&u<100){q=true;p=r;DEBUG("firstUnmastered job is "+missions[r][MISSION_NAME])}}}}}if(o>0){n=Math.floor(n/o)}if(GM_getValue("tierCompleteStatus")!=k+"|"+n){GM_setValue("tierCompleteStatus",k+"|"+n)}DEBUG("Job tier level "+k+" is "+n+"% complete.",caq);if(m||l==-1){var v=getSavedList("jobsToDo");if(v.length==0){DEBUG("There are no more jobs in the to-do list.");if(m)addToLog("info Icon",'You have mastered <span class="job">'+d+"</span>.");else addToLog("info Icon",'Job <span class="job">'+d+"</span> is not available.");if(n==100||isGMChecked("skipfight")){var w;for(r=c+1,s=missions.length;r<s;r++){if(missions[r][MISSION_CITY]!=h){w=r;addToLog("info Icon","You have mastered the final job tier in "+cities[h][CITY_NAME]+"! Moving to the next tier in "+cities[missions[w][MISSION_CITY]][CITY_NAME]+".");break}if(missions[r][MISSION_TAB]!=f){w=r;addToLog("info Icon","Current job tier is mastered. Moving to next tier in "+cities[h][CITY_NAME]+".");break}}if(!w)addToLog("info Icon","You have mastered all jobs!");else{GM_setValue("selectMission",w);DEBUG("Next Job in Tier Mastery Sequence: "+missions[GM_getValue("selectMission",1)][MISSION_NAME])}}else{GM_setValue("selectMission",p);DEBUG("Next Job in Tier Mastery Sequence: "+missions[GM_getValue("selectMission",1)][MISSION_NAME])}}else DEBUG("There are still jobs in the to-do list.")}else{if(GM_getValue("jobCompleteStatus")!=d+"|"+String(l)){GM_setValue("jobCompleteStatus",d+"|"+String(l));DEBUG("Job '"+d+"' is "+l+"% complete.")}}}function highlightJobs(a,b,c,d){var e;if(a!=b){while(c.length){e=c.pop();if(!xpathFirst('.//span[@class="job_best"]',e)){if(city==LV){e.setAttribute("style","height:32px;");makeElement("br",e)}e=makeElement("span",e,{"class":"job_best",style:"color:#52E259; font-size: 10px;margin-left:5px;"});makeElement("img",e,{src:stripURI(yeahIcon),width:"12",height:"12",style:"vertical-align:middle"});e.appendChild(document.createTextNode(" BEST"))}}while(d.length){e=d.pop();if(!xpathFirst('.//span[@class="job_worst"]',e)){if(city==LV){e.setAttribute("style","height:32px;");makeElement("br",e)}e=makeElement("span",e,{"class":"job_worst",style:"color:#EC2D2D; font-size: 10px;margin-left:5px;"});makeElement("img",e,{src:stripURI(omgIcon),width:"12",height:"12",style:"vertical-align:middle"});e.appendChild(document.createTextNode(" WORST"))}}}}function isJobFight(a){var b=xpathFirst('.//div[@id="fight_opponents"]',a);if(b)return true;return false}function isJobBoss(a){var b=xpathFirst('.//a[contains(@class,"attack_boss")]',a);if(b)return true;return false}function isJobLocked(a){return(/lock/i.test(a.innerHTML.untag())||/complete/i.test(a.innerHTML.untag()))&&!/help/i.test(a.innerHTML.untag())}function customizeProps(){var a=xpathFirst('.//div[@id="inner_page" and @class="property_controller"]');if(a){var b=$x('.//div[contains(@id,"propertyCollectAndCraftCard_") or contains(@id,"propertyLimitedTimeCardContainer_") ]');colorDEBUG("Checking Properties Page: RX6 found "+b.length+" properties.");if(b&&b.length>0){var c=new Array;for(i=0,iLength=b.length;i<iLength;i++){var d=b[i];var e=d.id.digitize();var f=xpathFirst('.//div[contains(@class,"property") and contains(@class,"CardName")]',d);var g=xpathFirst('.//div[contains(@class,"property") and contains(@class,"CardLevel")]',d);var h=new Array;h[0]=parseInt(e);h[1]=f.innerHTML.untag().capitalize();h[2]=parseInt(g.innerHTML.untag().digitize());c.push(h)}GM_setValue("propLevels",JSON.stringify(c))}}}function customizeJobs(){try{if(currentJobTab()<=0)return false;var jobTables;var newJobs=false;switch(city){case NY:jobTables=$x('.//table[@class="job_list"]//td[contains(@class,"job_name") or contains(@class,"job_title")]',innerPageElt);if(!jobTables||jobTables.length==0){jobTables=$x('.//div[@id="new_user_jobs"]//div[contains(@class, "job clearfix")]',innerPageElt);newJobs=true}break;case LV:jobTables=$x('.//div[@id="map_panels"]//div[contains(@class,"job_info")]',innerPageElt);break;case BRAZIL:case CHICAGO:case LONDON:var districtLinksContainer=xpathFirst('.//div[(@id="brazil_district_'+currentBrazilDistrict+'")]',innerPageElt);var jobTables=$x('.//div[contains(@id,"job-id")]',districtLinksContainer);if(!jobTables||jobTables.length==0)var jobTables=$x('.//div[@id="brazil_jobs"]//div[contains(@id,"job-id")]',innerPageElt);break;default:return false}if(!jobTables||jobTables.length==0)return false;DEBUG("customizeJobs: Found "+jobTables.length+" new "+cities[city][CITY_NAME]+" jobs in customize "+cities[city][CITY_NAME]+" jobs.",cgr);var availableJobs=eval("({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");var masteredJobs=eval("({0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{}})");try{availableJobs=eval("("+GM_getValue("availableJobs")+")");masteredJobs=eval("("+GM_getValue("masteredJobs")+")")}catch(ex){}var currentTab=currentJobTab();availableJobs[city][currentTab]=[];masteredJobs[city][currentTab]=[];var bestJobs=[],worstJobs=[];var bestRatio=0,worstRatio=10;var bestStamJobs=[],worstStamJobs=[];var bestStamRatio=0,worstStamRatio=10;var masteryList=getSavedList("masteryJobsList");var masteredJobsCount=0;var jobsFound=0;for(var i=0,iLength=jobTables.length;i<iLength;i++){var currentJob=jobTables[i];var isFightJob=false;var isBossJob=false;var skipCurrentJob=false;var skipFightJob=false;var jobCostValue=energy;var cost=0;switch(city){case NY:if(newJobs){var jobNameElt=xpathFirst('.//div[@class="title_results"]//h3',currentJob);if(!jobNameElt)continue;if(newJobs)var jobName=jobNameElt.innerHTML.clean().trim()}else{var jobNameElt=currentJob;var jobName=currentJob.innerHTML.split("<br>")[0].clean().trim().untag()}jobName=jobName.replace(/ x(\d+).*/,"");var jobRow=getJobRow(jobName);if(!jobRow)continue;break;case LV:var jobNameElt=xpathFirst('.//div[@class="job_title"]//h3',currentJob);if(!jobNameElt)continue;var jobName=jobNameElt.innerHTML.clean().trim().untag();break;case BRAZIL:case CHICAGO:case LONDON:var jobNameElt=xpathFirst('.//div[@class="job_details clearfix"]//h4',currentJob);if(!jobNameElt)continue;var jobName=jobNameElt.innerHTML.clean().trim().untag();break;default:return false}switch(city){case NY:if(newJobs){var jobCost=xpathFirst('.//div[@class="use_pay"]//dl[contains(.,"Uses")]',currentJob);var jobReward=xpathFirst('.//div[@class="use_pay"]//dl[contains(.,"Pays")]',currentJob);var jobAction=xpathFirst(".//a",currentJob);var jobPercentage=getJobMastery(currentJob,true);var costElt=xpathFirst('.//dd[@class="energy"]',jobCost);if(costElt)cost=parseCash(costElt.innerHTML)}else{var jobCost=xpathFirst('.//td[contains(@class,"job_energy")]',jobRow);var jobReward=xpathFirst('.//td[contains(@class,"job_reward")]',jobRow);var jobAction=xpathFirst('.//td[contains(@class,"job_action")]',jobRow);var jobPercentage=getJobMastery(jobRow,false);var costElt=xpathFirst('.//span[@class="bold_number"]',jobCost);if(!costElt)costElt=xpathFirst('.//span[@class="energy"]',jobCost);if(costElt)cost=parseInt(costElt.innerHTML.untag())}break;case LV:var jobCost=xpathFirst('.//div[@class="job_uses"]',currentJob);var jobReward=xpathFirst('.//div[@class="job_pays"]',currentJob);var jobAction=xpathFirst('.//a[contains(@class,"sexy_button_new") and not(contains(.,"Ask"))]',currentJob);var jobPercentage=getJobMastery(currentJob,true);var isFightJob=isJobFight(currentJob);if(isFightJob&&isGMChecked("skipfight"))skipFightJob=true;var isBossJob=isJobBoss(currentJob);if(isFightJob||isBossJob){costElt=xpathFirst('.//dd[@class="stamina"]',jobCost);jobCostValue=stamina}else costElt=xpathFirst('.//dd[@class="energy"]',jobCost);if(costElt)cost=parseInt(costElt.innerHTML.untag());break;case BRAZIL:case CHICAGO:case LONDON:var jobCost=xpathFirst('.//ul[@class="uses clearfix"]',currentJob);var costElt=xpathFirst('.//li[@class="energy"]',jobCost);if(costElt){if(costElt.hasAttribute("current_value"))cost=parseInt(costElt.getAttribute("current_value"));else if(costElt.hasAttribute("base_value"))cost=parseInt(costElt.getAttribute("base_value"))}var jobReward=xpathFirst('.//ul[@class="pays clearfix"]',currentJob);var jobAction=xpathFirst('.//a[contains(@id, "btn_dojob")]',currentJob);var jobPercentage=getBrazilJobMastery(currentJob);break;default:return false}jobName=jobName.replace(/ x(\d+).*/,"");var jobMatch=missions.searchArray(jobName,0)[0];if(isNaN(jobMatch)){var ujHref=jobAction.href;var ujbNo=0;var ujTab=0;if(ujHref.match(/&job=(\d+)&/))ujNo=RegExp.$1;if(ujHref.match(/&tab=(\d+)&/))ujTab=RegExp.$1;expElt=xpathFirst('.//li[@class="experience"]',jobReward);if(expElt)reward=parseInt(expElt.getAttribute("current_value"));DEBUG(",['"+jobName+"',"+cost+","+ujNo+","+ujTab+","+cities[city][CITY_NAME].toUpperCase()+","+reward+",0,'',,1]");continue}jobsFound++;if(jobAction&&isJobLocked(jobAction)){skipCurrentJob=true}if(jobPercentage==100||!cost){if(masteryList.length>0&&masteryList.indexOf(String(jobMatch))!=-1)masteredJobs[city][currentTab].push(jobMatch);masteredJobsCount++}if(!cost||!costElt||cost>jobCostValue){skipCurrentJob=true}if(skipFightJob){skipCurrentJob=true;masteredJobs[city][currentTab].push(jobMatch);masteredJobsCount++}if(isBossJob&&masteredJobsCount<jobTables.length-1){skipCurrentJob=true;DEBUG("Not all jobs are mastered yet, skip current boss job")}if(!skipCurrentJob)availableJobs[city][currentTab].push(jobMatch);GM_setValue("availableJobs",JSON.stringify(availableJobs));GM_setValue("masteredJobs",JSON.stringify(masteredJobs));var reward=0;var ratio=0;var money=0;var mratio=0;var currency=cities[city][CITY_CASH_SYMBOL];var expElt;var moneyElt;var timeElt;var ratioElt;switch(city){case NY:var expElt=xpathFirst('.//span[@class="bold_number"]',jobReward);if(!expElt)expElt=xpathFirst('.//span[@class="experience"]',jobReward);if(!expElt)expElt=xpathFirst('.//dd[@class="experience"]',jobReward);if(expElt){reward=parseInt(expElt.innerHTML);if(!newJobs){expElt=costElt.parentNode;if(!xpathFirst('.//span[@id="ratio_xp"]',expElt))makeElement("br",expElt)}}var moneyElt=xpathFirst('.//span[@class="money"]/strong',jobReward);if(!moneyElt)moneyElt=xpathFirst('.//strong[@class="money"]',jobReward);if(!moneyElt)moneyElt=xpathFirst('.//dd[contains(@class,"cash cash")]',jobReward);if(moneyElt){money=parseCash(moneyElt.innerHTML.untag());if(!newJobs)moneyElt=moneyElt.parentNode}if(newJobs)ratioElt=expElt;else ratioElt=costElt;break;case LV:expElt=xpathFirst('.//dd[@class="experience"]',jobReward);if(expElt){reward=parseInt(expElt.innerHTML);ratioElt=expElt}moneyElt=xpathFirst('.//dd[contains(@class,"cash_icon")]',jobReward);if(moneyElt)money=parseCash(moneyElt.innerHTML.untag());break;case BRAZIL:case CHICAGO:case LONDON:expElt=xpathFirst('.//li[@class="experience"]',jobReward);if(expElt)reward=parseInt(expElt.getAttribute("current_value"));moneyElt=xpathFirst('.//li[contains(@class, "cash_icon_jobs")]',jobReward);if(moneyElt)money=parseCash(moneyElt.getAttribute("current_value"));ratioElt=expElt;break;default:return false}if(costElt&&cost){ratio=Math.round(reward/cost*100)/100;if(!running){if(ratioElt){if(!xpathFirst('.//span[@id="ratio_xp"]',ratioElt))makeElement("span",ratioElt,{id:"ratio_xp",style:"color:red; font-size: 10px;"}).appendChild(document.createTextNode(" ("+ratio+")"))}if(moneyElt){mratio=Math.round(money/cost);if(mratio==0)mratio=Math.round(money/cost*100)/100;mratio=makeCommaValue(mratio);if(!xpathFirst('.//span[@id="ratio_money"]',moneyElt))makeElement("span",moneyElt,{id:"ratio_money",style:"color:red; font-size: 10px;"}).appendChild(document.createTextNode(" ("+currency+" "+mratio+")"))}if(newJobs)ratioElt=jobNameElt;if(!isFightJob){if(ratio>bestRatio){bestRatio=ratio;bestJobs=[ratioElt]}else if(ratio==bestRatio)bestJobs.push(ratioElt);if(ratio<worstRatio){worstRatio=ratio;worstJobs=[ratioElt]}else if(ratio==worstRatio)worstJobs.push(ratioElt)}else{if(ratio>bestStamRatio){bestStamRatio=ratio;bestStamJobs=[ratioElt]}else if(ratio==bestStamRatio)bestStamJobs.push(ratioElt);if(ratio<worstStamRatio){worstStamRatio=ratio;worstStamJobs=[ratioElt]}else if(ratio==worstStamRatio)worstStamJobs.push(ratioElt)}}}updateJobInfo(jobMatch,cost,reward,ratio)}if(!running){highlightJobs(worstRatio,bestRatio,bestJobs,worstJobs);if(bestStamJobs)highlightJobs(worstRatio,bestRatio,bestStamJobs,worstStamJobs)}switch(city){case NY:if(newJobs)jobMastery(innerPageElt,true);else jobMastery(innerPageElt,false);break;case LV:case BRAZIL:case CHICAGO:case LONDON:jobMastery(innerPageElt,true);break;default:return false}tierMastery(jobsFound,masteredJobsCount,currentTab);return true}catch(jobErr){colorDEBUG("customizeJobs: "+jobErr)}}function updateJobInfo(a,b,c,d){var e=missions[a];if(!isNaN(a)&&(e[MISSION_ENERGY]!=b||e[MISSION_XP]!=c||e[MISSION_RATIO]!=d)){missions[a][MISSION_ENERGY]=b;missions[a][MISSION_XP]=c;missions[a][MISSION_RATIO]=d;GM_setValue("missions",JSON.stringify(missions))}}function tierMastery(a,b,c){if(running&&GM_getValue("selectTier","0.0")!="0.0"){selectedTierValue=GM_getValue("selectTier","0.0").split(".");masteryCity=parseInt(selectedTierValue[0]);masteryTier=parseInt(selectedTierValue[1]);if(city==masteryCity&&masteryTier==c&&a<=b){selectTier=cities[masteryCity][0]+" - "+missionTabs[masteryCity][masteryTier-1];addToLog("info Icon","Tier "+selectTier+" is already mastered. Moving on to the next tier.");if(missionTabs[masteryCity].length<=masteryTier){if(cities.length<masteryCity){GM_setValue("selectTier","0.0")}else{masteryCity++;while(level<cities[masteryCity][CITY_LEVEL]&&cities.length>masteryCity){masteryCity++;if(cities.length<=masteryCity){DEBUG("We are out of cities to check so turning off mastery ");GM_setValue("selectTier","0.0");return}else{DEBUG(cities[masteryCity-1][CITY_NAME]+" Unavailable, Checking "+cities[masteryCity][CITY_NAME])}}masteryTier=1}}else{masteryTier++;if(isNewCity(city)){var d=function(a,b,c){return c[b][MISSION_CITY]==masteryCity&&c[b][MISSION_TAB]==masteryTier};var e=missions.filter(d);if(e[0][MISSION_TABPATH])masteryTier=e[0][MISSION_TABPATH]}}if(GM_getValue("selectTier","0.0")!="0.0"){var f=[];for(i=0,iLength=missions.length;i<iLength;i++){if(masteryCity==missions[i][MISSION_CITY]&&masteryTier==missions[i][MISSION_TAB]){f.push(i)}}setSavedList("masteryJobsList",f);GM_setValue("selectTier",masteryCity+"."+masteryTier)}}}}function customizeFightLists(){if(running)return true;if(!onHitlistTab()&&!onFightTab()&&!onBattlePage(2))return true;var a=getDisplayedOpponents(innerPageElt,true,getStaminaMode());if(!a)return true;var b=hitmanListAvoid.get().concat(fightListAvoid.get());var c=getSavedList("hitmanListKilled");for(var d=0,e=a.length;d<e;++d){var f=a[d];if(!f.profile)continue;var g,h;if(b.indexOf(f.id)!=-1){h=f.profile.parentNode;g=makeElement("img",null,{src:stripURI(omgIcon),width:"12",height:"12",style:"vertical-align:middle",title:"You have already lost to this opponent during automatic play."});h.insertBefore(g,h.firstChild)}if(c.indexOf(f.id)!=-1){h=f.profile.parentNode;g=makeElement("img",null,{src:stripURI(lootbagIcon),width:"12",height:"12",style:"vertical-align:middle",title:"You have already collected a bounty on this target during automatic play."});h.insertBefore(g,h.firstChild)}}return true}function setLevelUpRatioStats(){var a=document.getElementById("level_up_ratio_stats");if(a){var b="Level Up Ratio's: ";if(stamina||energy){var c=Math.ceil(ptsToNextLevel/(energy+stamina)*100)/100;b+="Combined: "+(c>25?"> 25":c)+"x";if(energy){var d=Math.ceil(ptsToNextLevel/energy*100)/100;b+=" | Energy: "+(d>25?"> 25":d)+"x"}if(stamina){var e=Math.ceil(ptsToNextLevel/stamina*100)/100;b+=" | Stamina: "+(e>25?"> 25":e)+"x"}}a.innerHTML=b;if(c)a.style.display="block";else a.style.display="none"}if(!isGMChecked("noStats")){var f=getStaminaGainRate();if(a=xpathFirst('.//div[@id="expRate"]'))a.firstChild.nodeValue=f.toFixed(2);if(a=xpathFirst('.//div[@id="expToNext"]'))a.firstChild.nodeValue=makeCommaValue(ptsToNextLevel);if(a=xpathFirst('.//div[@id="stamToNext"]'))a.firstChild.nodeValue=f?(ptsToNextLevel/f).toFixed(0):"n/a"}}function clickFightListAdd(){addSavedListItem("pfightlist",this.id);this.firstChild.nodeValue="Remove from Fight List";this.removeEventListener("click",clickFightListAdd,false);this.addEventListener("click",clickFightListRemove,false);var a=document.getElementById("pfightlist");if(a)a.value=GM_getValue("pfightlist","")}function clickFightListRemove(){while(removeSavedListItem("pfightlist",this.id))this.firstChild.nodeValue="Add to Fight List";this.removeEventListener("click",clickFightListRemove,false);this.addEventListener("click",clickFightListAdd,false);var a=document.getElementById("pfightlist");if(a)a.value=GM_getValue("pfightlist","")}function clickAutoHitListAdd(){addSavedListItem("pautoHitOpponentList",this.id);this.firstChild.nodeValue="Remove from AutoHit List";this.removeEventListener("click",clickAutoHitListAdd,false);this.addEventListener("click",clickAutoHitListRemove,false);var a=document.getElementById("pautoHitOpponentList");if(a)a.value=GM_getValue("pautoHitOpponentList","")}function clickAutoHitListRemove(){while(removeSavedListItem("pautoHitOpponentList",this.id))this.firstChild.nodeValue="Add to AutoHit List";this.removeEventListener("click",clickAutoHitListRemove,false);this.addEventListener("click",clickAutoHitListAdd,false);var a=document.getElementById("pautoHitOpponentList");if(a)a.value=GM_getValue("pautoHitOpponentList","")}function clickWarListAdd(){addSavedListItem("autoWarTargetList",this.id);this.firstChild.nodeValue="Remove from War List";this.removeEventListener("click",clickWarListAdd,false);this.addEventListener("click",clickWarListRemove,false);var a=document.getElementById("autoWarTargetList");if(a)a.value=GM_getValue("autoWarTargetList","")}function clickWarListRemove(){while(removeSavedListItem("autoWarTargetList",this.id))this.firstChild.nodeValue="Add to War List";this.removeEventListener("click",clickWarListRemove,false);this.addEventListener("click",clickWarListAdd,false);var a=document.getElementById("autoWarTargetList");if(a)a.value=GM_getValue("autoWarTargetList","")}function getJobRow(a,b){if(!b)b=innerPageElt;var c,d="",e=0;try{var f=missions.searchArray(a,0)[0];if(!isNaN(f)){var g=missions[f][MISSION_NUMBER];c=xpathFirst('.//table[@class="job_list"]//a[contains(@onclick, "job='+g+'&")]',b);if(!c)c=xpathFirst('.//table[@class="job_list"]//a[contains(@href, "job='+g+'&")]',b);if(!c&&city==LV){var h="job"+g;c=xpathFirst('.//div[@id="'+h+'"]',b);e=1}}var i=xpathFirst('.//a[contains(@onclick, "MapController.buyItems('+g+'); return false;")]');if(i){DEBUG("Cheating on buying for now found a link to click - - jobno="+g);clickElement(i);addToLog("info Icon","Buying necessary items to be able to perform: '"+missions[f][MISSION_NAME]+"'.")}if(!c){var j=a.replace(/"/g," ").replace(/'/g," ").split(" ");for(var k=0;k<j.length;++k){if(j[k].length>1){if(d.length>0)d+=" and ";d+='contains(., "'+j[k]+'")'}}c=xpathFirst('.//table[@class="job_list"]//tr//td['+d+"]",b)}if(c&&!e)while(c.tagName!="TR")c=c.parentNode;if(!c)c=xpathFirst('.//div[@id="new_user_jobs"]//div[contains(@class, "job clearfix") and '+d+"]",b);if(!c){c=xpathFirst('.//div[@class="job"]//a[contains(@href,"job='+g+'&")]',b);if(!c)c=xpathFirst('.//div[@id="job-id-'+g+'"]//a[contains(@href,"job='+g+'&")]',b);if(c)c=c.parentNode.parentNode}}catch(l){DEBUG("BUG DETECTED (getJobRow): [exception: "+l+"], [conTxt: "+d+"], [jobName: "+a+"]")}if(!c){colorDEBUG("getJobRow: "+a+" - NO ROWELT FOUND - RETURNING FALSE",cre);return false}return c}function getJobRowItems(a){try{var b=a;var c=getJobRow(b,innerPageElt);if(!c)return false;var d=innerPageElt?innerPageElt.innerHTML:"";var e=d.untag();if(e.match(/You do not have enough cash to buy/i)){addToLog("warning Icon","You don't have enough cash to buy necessary equipment.");var f=getSavedList("jobsToDo","");if(f.indexOf(b)==-1){f.push(b);DEBUG("Saving "+b+" for later. Need to farm cash first.");setSavedList("jobsToDo",f);return true}return false}var g=$x('.//a[contains(@onclick, "xw_action=buy_item")]',c);if(!g)g=$x('.//a[contains(@onclick, "MapController.buyItems")]',c);if(g.length>0){addToLog("search Icon","Attempting to purchase required items.");for(var h=0,i=g.length;h<i;++h){Autoplay.fx=function(){clickAction="buy item";clickElement(g[h]);DEBUG("Clicked to buy item.")};break}return true}if(isGMChecked("autoWithDraw")){var j=xpathFirst('.//strong[@class="cash cash_'+cities[city][CITY_ALIAS]+'"]',c);if(!j)j=xpathFirst('.//div[@class="job_uses"]//dd[contains(@class,"cash_icon")]',c);if(j){var k=parseCash(j.innerHTML.untag().trim())-cities[city][CITY_CASH];if(k>0){DEBUG("We need "+k+" for this job. Going to the bank/vault of "+city);suspendBank=true;return autoBankWithdraw(k)}}}var l=$x('.//div[@class="req_item"]//img',c);if(l.length>0){DEBUG("Some Items Required for this job - req_item");var m=getSavedList("itemList");var f=getSavedList("jobsToDo","");if(f.indexOf(b)==-1){f.push(b);DEBUG("Saving "+b+" for later. Need to fetch pre-req items first.");setSavedList("jobsToDo",f)}var n=false;l.forEach(function(a){var b=a.alt;b=b.replace(/set of/i,"");b=b.replace(/\[(.+?)\]/i,"");b=b.trim();DEBUG(b);var c=false;requirementJob.forEach(function(a){if(level>=cities[a[2]][CITY_LEVEL]&&a[0].toUpperCase().trim()==b.toUpperCase().trim()){f.push(a[1]);m.push(b);c=true}});if(c)n=true;else DEBUG(b+" not found in the requirement job array.")});if(n){setSavedList("itemList",m.unique());setSavedList("jobsToDo",f);popJob();return true}}else{l=xpathFirst('.//span[@class="missing_req_items"]',c);itmSearch="";if(l){DEBUG("Some Items Required for this job - missing_req_items");itmSearch=l.innerHTML;if(itmSearch.match(/(.+?),/i))itmSearch=RegExp.$1;DEBUG("Missing Item: "+itmSearch);itmSearch=itmSearch.replace(/\(.+?\)/gi,"").trim();DEBUG("Parsed Missing Item: "+itmSearch)}else{l=xpathFirst('.//div[@class="needed_gate_loot_container"]',c);if(!l)l=xpathFirst('.//div[@class="needed_gate_loot"]',c);if(l){DEBUG("Some Items Required for this job - needed_gate_loot");messages=$x(".//img",l);numMessages=messages.length;for(h=0;h<numMessages;h++){var o=messages[h].title;if(!o.match(/Gift this/i)){if(itmSearch=="")itmSearch=o;else itmSearch=itmSearch+", "+o}}DEBUG("Missing Item(s): "+itmSearch)}}if(itmSearch!=""){DEBUG("Item(s) Required for this job : "+itmSearch);var m=getSavedList("itemList");var f=getSavedList("jobsToDo","");DEBUG("Current Job List: "+f);if(f.indexOf(b)==-1){f.push(b);DEBUG("Saving "+b+" for later. Need to fetch pre-req items first.");setSavedList("jobsToDo",f)}else{DEBUG(b+" already saved for later. Need to fetch pre-req items first.")}var p=false;requirementJob.forEach(function(a){if(level>=cities[a[2]][CITY_LEVEL]&&a[0].toUpperCase().trim()==itmSearch.toUpperCase().trim()){f.push(a[1]);m.push(itmSearch.trim());p=true;jobFound=a[1]}});if(!p)DEBUG(itmSearch+" not found in the requirement job array.");else{setSavedList("itemList",m.unique());setSavedList("jobsToDo",f);popJob();return true}}}var j=xpathFirst('.//td[contains(@class,"job_energy")]//span[@class="money" or @class="bad"]',c);if(j){var k=parseCash(j.innerHTML)-cities[city][CITY_CASH];if(k>0){suspendBank=true;return autoBankWithdraw(k)}}return false}catch(q){DEBUG("getJobRowItems Error :"+q)}}function popJob(){var a=getSavedList("jobsToDo","");var b=a.pop();setSavedList("jobsToDo",a);var c=0;missions.forEach(function(a){if(a[0].toUpperCase().trim()==b.toUpperCase().trim()){GM_setValue("selectMission",c);addToLog("info Icon",'Switching job to <span class="job">'+b+"</span> (popJob).")}c++})}function jobCombo(element){var i;var availableJobs=eval("("+GM_getValue("availableJobs","{0:{},1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}}")+")");var multiple_jobs_list=getSavedList("selectMissionMultiple");var cycle_jobs=new Object;for(i=0,iLength=multiple_jobs_list.length;i<iLength;++i){var job=multiple_jobs_list[i];var mission=missions[job];if(!mission)continue;if(availableJobs[mission[MISSION_CITY]][mission[MISSION_TAB]]!=null&&availableJobs[mission[MISSION_CITY]][mission[MISSION_TAB]].indexOf(parseInt(job))==-1){mission[MISSION_RATIO]=0}if(cycle_jobs[mission[MISSION_RATIO]]==null)cycle_jobs[mission[MISSION_RATIO]]=[];cycle_jobs[mission[MISSION_RATIO]].push(multiple_jobs_list[i])}multiple_jobs_list=[];for(i in cycle_jobs){if(cycle_jobs[i].length>1){if(missions[GM_getValue("selectMission",1)][MISSION_RATIO]==i)cycle_jobs[i].push(cycle_jobs[i].shift());for(var n=0,nLength=cycle_jobs[i].length;n<nLength;++n){multiple_jobs_list.push(cycle_jobs[i][n])}}else multiple_jobs_list.push(cycle_jobs[i][0])}setSavedList("selectMissionMultiple",multiple_jobs_list)}function jobLoot(a){var b,c=[];var d="";var e="";var f=$x('.//td[class="message_body"]',a);var g=f.length;for(b=1;b<g;b++){var h=f[b].innerHTML.untag();if(h.match(/you\s+?gained:\s+?an?\s+?(.+)\./i)||h.match(/you\s+gained(?:\s+an?)?\s+(.+)\./i)||h.match(/found(?:\s+an?)?\s+(.*?)\s+on\s+the/i)||h.match(/earned(?:\s+an?)?\s+(.*?)\.\s+you\s+/i)){var i=RegExp.$1;if(i.match(/(.+?)\s+?was(.+?)(\d+)/i))i=RegExp.$1+" x "+RegExp.$3;else if(i.match(/(.+?)\s+?(\.|-)?\s+?used?(.+?)(\d+)/i))i=RegExp.$1+" x "+RegExp.$4;if(d)d+="<br/>"+'Found <span class="loot">'+i+"</span> in the job.";else d='Found <span class="loot">'+i+"</span> in the job.";c.push(i)}}if(g>0&&d!="")addToLog("lootbag Icon",d);if(city==NY||city==CUBA){var f=$x('.//dd[@class="message_item"]',a);var g=f.length;for(b=0;b<g;b++){var i=f[b].innerHTML.untag();if(i.indexOf("remaining")==-1){if(d)d+="<br/>"+'Found <span class="loot">'+i+"</span> in the job.";else d='Found <span class="loot">'+i+"</span> in the job.";c.push(i)}else{if(e)e+="<br/>"+'You used <span class="loot">'+i+"</span> in the job.";else e='You used <span class="loot">'+i+"</span> in the job."}}if(g>0&&d!="")addToLog("lootbag Icon",d);if(g>0&&e!="")addToLog("lootbag Icon",e)}if(city==LV){var j=xpathFirst('.//div[@class="job_results"]',a);d="";f=$x(".//img",j);g=f.length;for(b=0;b<g;b++){if(f[b].title){var i=f[b].title;var k=f[b].parentNode.innerHTML.untag();if(k.match(/(\d+)/))k=" x "+RegExp.$1;if(i.match(/(.+?)(\.|-)?\s+?(was|used?)/i))i=RegExp.$1;if(d)d+="<br/>"+'Found <span class="loot">'+i+" "+k+"</span> in the job.";else d='Found <span class="loot">'+i+" "+k+"</span> in the job.";c.push(i)}}if(g>0&&d!="")addToLog("lootbag Icon",d)}var l=getSavedList("itemList");if(typeof l[0]=="undefined"||l.length==0){DEBUG("No items in required item list.");return}var m=false;var n;while(n=c.pop()){DEBUG("Looking for "+n+" in needed items list. We need "+l.length+" item(s).");for(var b=0;b<l.length;b++){if(n.indexOf(l[b].trim())!=-1){m=true;DEBUG('<span class="loot">'+n+"</span> is the item we were looking for!");removeSavedListItem("itemList",n);removeJobForItem("jobsToDo",n);popJob();return true}}}}function debugDumpSettings(){try{var a=function(a){var b=getSavedList(a);var c=[];for(var d=0,e=b.length;d<e;++d){c.push(missions[b[d]][MISSION_NAME])}return c.join(", ")};var b=a("selectMissionMultiple");var c="None";if(GM_getValue("selectTier","0.0")!="0.0"){selectedTierValue=GM_getValue("selectTier","0.0").split(".");c=cities[parseInt(selectedTierValue[0])][0]+" - "+missionTabs[NY][parseInt(selectedTierValue[1])-1]}if(GM_getValue("language","en")!="en"){DEBUG('Language is "'+GM_getValue("language","undefined")+'".');addToLog("warning Icon","Unfortunately, only the English version of the game is fully supported. If you experience problems, set your Facebook language to English and try again.")}var d={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string;var d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b==-1)return;return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};d.init();getBrowserWindowSize();var e="PRO PLAYER";if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){e="LITE PLAYER"}var f="-  -  -  -  -  BEGIN SETTINGS DUMP  -  -  -  -  -<br>"+"------------------ End-User System -------------------<br>"+"Browser Name: <strong>"+d.browser+"</strong><br>"+"Browser Version: <strong>"+d.version+"</strong><br>"+"Operating System: <strong>"+d.OS+"</strong><br>"+"New Layout: <strong>"+new_header+"</strong><br>"+"Browser Window Size: <strong>"+winW+" / "+winH+"</strong><br>"+"------------------ RX6 MWAP Settings---------------------<br>"+"Script Version: <strong>"+SCRIPT.version+" "+e+"</strong><br>"+"Language: <strong>"+GM_getValue("language")+"</strong><br>"+"isRunning: <strong>"+running+"</strong><br>"+"Player current level: <strong>"+level+"</strong><br>"+"Player points to next level: <strong>"+ptsToNextLevel+"</strong><br>"+"Player mafia size: <strong>"+mafia+"</strong><br>"+"Player attack profile: <strong>"+curAttack+"</strong><br>"+"Player defense profile: <strong>"+curDefense+"</strong><br>"+"Player attack equip: <strong>"+curAttackEquip+"</strong><br>"+"Player defense equip: <strong>"+curDefenseEquip+"</strong><br>"+"Player health: <strong>"+health+"/"+maxHealth+"</strong><br>"+"Player energy: <strong>"+energy+"/"+maxEnergy+"</strong><br>"+"Player stamina: <strong>"+stamina+"/"+maxStamina+"</strong><br>"+"Player skill points: <strong>"+stats+"</strong><br>"+"Energy pack waiting? <strong>"+energyPack+"</strong><br>"+"Current location: <strong>"+cities[city][CITY_NAME]+"</strong><br>";for(i=0,iLength=cities.length;i<iLength;i++){if(isUndefined(cities[i][CITY_CASH]))dumpText="unknown";else dumpText=cities[i][CITY_CASH_SYMBOL]+makeCommaValue(cities[i][CITY_CASH]);f+=cities[i][CITY_NAME]+" cash: <strong>"+dumpText+"</strong><br>"}f+="-------------------General Tab--------------------------<br>"+"General MWAP speed: <strong>"+GM_getValue("fastMWAPSpeed")+"</strong><br>"+"Enable auto-pause: <strong>"+showIfUnchecked(GM_getValue("autoPause"))+"</strong><br>"+"--After level up: <strong>"+showIfSelected(GM_getValue("autoPauseAfter"))+"</strong><br>"+"--Before level up: <strong>"+showIfSelected(GM_getValue("autoPauseBefore"))+"</strong><br>"+"---Exp to pause at: <strong>"+GM_getValue("autoPauseExp")+"</strong><br>"+"Idle in Selected city: <strong>"+cities[GM_getValue("idleLocation",NY)][CITY_NAME]+"</strong><br>"+"Prioritise Energy/Stamina burning: <strong>"+burnModes[GM_getValue("burnOption")]+"</strong><br>"+"Force Energy/Stamina Use: <strong>"+showIfUnchecked(GM_getValue("forceLevelSpending"))+"</strong><br>"+"Try to process all popups: <strong>"+showIfUnchecked(GM_getValue("autoProcessPopups"))+"</strong><br>"+"Enable Auto Slot Machine: <strong>"+showIfUnchecked(GM_getValue("AutoSlotMachine"))+"</strong><br>"+"--Auto Slot Machine Timer: <strong>"+getHoursTime("autoSlotTimer")+"</strong><br>"+"Enable Free 3 Slot Spins: <strong>"+showIfUnchecked(GM_getValue("autoSlot3FreeSpins"))+"</strong><br>"+"--Free 3 Slot Spins Timer: <strong>"+getHoursTime("autoFreeSlotTimer")+"</strong><br>"+"Enable Reallocation Check: <strong>"+showIfUnchecked(GM_getValue("autoCheckReallocation"))+"</strong><br>"+"--Reallocation Check Timer: <strong>"+getHoursTime("checkReallocationTime")+"</strong><br>"+"---------------------Display Tab--------------------<br>"+"Use text labels: <strong>"+showIfUnchecked(GM_getValue("textOnlyMode"))+"</strong><br>"+"Enable logging: <strong>"+showIfUnchecked(GM_getValue("autoLog"))+"</strong><br>"+"--Logging length: <strong>"+GM_getValue("autoLogLength")+"</strong><br>"+"Enable log filtering: <strong>"+showIfUnchecked(GM_getValue("filterLog"))+"</strong><br>"+"--Filter mode: <strong>"+GM_getValue("filterOpt",0)+"</strong><br>"+"--Accepted patterns: <strong>"+GM_getValue("filterPass")+"</strong><br>"+"--Rejected patterns: <strong>"+GM_getValue("filterFail")+"</strong><br>"+"Left-align main frame: <strong>"+showIfUnchecked(GM_getValue("leftAlign"))+"</strong><br>"+"Elevate RX6 MWAP-Header: <strong>"+showIfUnchecked(GM_getValue("mastheadOnTop"))+"</strong><br>"+"Set window title to name on Facebook account: <strong>"+showIfUnchecked(GM_getValue("fbwindowtitle"))+"</strong><br>"+"Show pulse on the fight page: <strong>"+showIfUnchecked(GM_getValue("showPulse"))+"</strong><br>"+"Show level on the hitlist page: <strong>"+showIfUnchecked(GM_getValue("showLevel"))+"</strong><br>"+"Hide Game Elements: <br>"+"--Hide All MW Icons: <strong>"+showIfUnchecked(GM_getValue("hideAll"))+"</strong><br>"+"--MW Promo Banner: <strong>"+showIfUnchecked(GM_getValue("hideZyngaBanner"))+"</strong><br>"+"--Hide Clan Chat: <strong>"+showIfUnchecked(GM_getValue("hideClanChat"))+"</strong><br>"+"MWAP Stats Tracking disabled: <strong>"+showIfUnchecked(GM_getValue("noStats"))+"</strong><br>"+"Choose where to play: <br>"+"--Play on mwap.me.uk: <strong>"+showIfUnchecked(GM_getValue("playMWAP"))+"</strong><br>"+"--Use 2nd Link: <strong>"+showIfUnchecked(GM_getValue("playMWAPRX2"))+"</strong><br>"+"---------------------Mafia Tab--------------------<br>"+"Automatically asks for job help: <strong>"+showIfUnchecked(GM_getValue("autoAskJobHelp"))+"</strong><br>"+"--Minimum experience for job help: <strong>"+GM_getValue("autoAskJobHelpMinExp")+"</strong><br>"+"Ask for Vegas help: <strong>"+GM_getValue("selectVegasTier")+"</strong><br>"+"--Ask for Vegas Help Timer: <strong>"+getHoursTime("AskforHelpVegasTimer")+"</strong><br>"+"Ask for Brazil help: <strong>"+GM_getValue("selectBrazilTier")+"</strong><br>"+"--Ask for Brazil Help Timer: <strong>"+getHoursTime("AskforHelpBrazilTimer")+"</strong><br>"+"Ask for Chicago help: <strong>"+GM_getValue("selectChicagoTier")+"</strong><br>"+"--Ask for Chicago Help Timer: <strong>"+getHoursTime("AskforHelpChicagoTimer")+"</strong><br>"+"Ask for London help: <strong>"+GM_getValue("selectLondonTier")+"</strong><br>"+"--Ask for London Help Timer: <strong>"+getHoursTime("AskforLondonHelpTimer")+"</strong><br>"+"Ask to Join City Crews: <strong>"+showIfUnchecked(GM_getValue("autoAskCityCrew"))+"</strong><br>"+"--Ask to Join City Crews Timer: <strong>"+getHoursTime("autoAskCityCrewTimer")+"</strong><br>"+"Accept mafia invitations: <strong>"+showIfUnchecked(GM_getValue("acceptMafiaInvitations"))+"</strong><br>"+"Process and Log Player Updates: <strong>"+showIfUnchecked(GM_getValue("logPlayerUpdates"))+"</strong><br>"+"Enable publishing to FB Wall: <br>"+"--Global Publishing: <strong>"+showIfUnchecked(GM_getValue("autoGlobalPublishing"))+"</strong><br>"+"--Ice bonus: <strong>"+showIfUnchecked(GM_getValue("autoIcePublish"))+"</strong><br>"+"---Ice bonus Frequency: <strong>"+GM_getValue("autoIcePublishFrequency")+"</strong><br>"+"--Automatically share wishlist: <strong>"+showIfUnchecked(GM_getValue("autoShareWishlist"))+"</strong><br>"+"---Hour interval for sharing wishlist: <strong>"+GM_getValue("autoShareWishlistTime")+"</strong><br>"+"---Auto Share Wishlist Timer: <strong>"+getHoursTime("wishListTimer")+"</strong><br>"+"Message Center: <br>"+"--Auto Accept Gifts: <strong>"+showIfUnchecked(GM_getValue("autoAcceptMsgGifts"))+"</strong><br>"+"--Auto Accept Boosts: <strong>"+showIfUnchecked(GM_getValue("autoAcceptMsgBoosts"))+"</strong><br>"+"--Auto Accept Crew: <strong>"+showIfUnchecked(GM_getValue("autoAcceptMsgCrew"))+"</strong><br>"+"---Message Center Timer: <strong>"+getHoursTime("autoAcceptMsgTimer")+"</strong><br>"+"--Auto Send Energy packs: <strong>"+showIfUnchecked(GM_getValue("autosendMsgEnergyPack"))+"</strong><br>"+"Enable Auto War: <br>"+"--Auto War Mode: <strong>"+warModeChoices[GM_getValue("warMode",0)]+"</strong><br>"+"---Auto War Target List: <strong>"+GM_getValue("autoWarTargetList",0)+"</strong><br>"+"---Auto War Timer: <strong>"+getHoursTime("warTimer")+"</strong><br>"+"-----------------Family-----------------<br>"+"Enable Personal Operations: <strong>"+showIfUnchecked(GM_getValue("autoStartMyOps"))+"</strong><br>"+"--Check My Operations Timer: <strong>"+getHoursTime("myOpsTimer")+"</strong><br>"+"Participate In Family Operations: <strong>"+showIfUnchecked(GM_getValue("autoStartFamOps"))+"</strong><br>"+"--Check Family Operations Timer: <strong>"+getHoursTime("famOpsTimer")+"</strong><br>";if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){f+="Enable Auto Family Rewards Collect: <strong>"+showIfUnchecked(GM_getValue("AutoFamilyRewards"))+"</strong><br>"+"Enable Family Bosses: <strong>"+showIfUnchecked(GM_getValue("autoFamilyBosses"))+"</strong><br>"+"Enable Auto Family Boss Fighting: <strong>"+showIfUnchecked(GM_getValue("autoFamilyBossFighting"))+"</strong><br>"+"--Boss Role: <strong>"+bossRoles[GM_getValue("bossRole",0)]+"</strong><br>"+"--Boss Stamina Limit: <strong>"+bossStaminaLimits[GM_getValue("bossStaminaLimit",0)]+"</strong><br>"+"--Boss Rage Limit: <strong>"+GM_getValue("bossRageLimit",0)+"</strong><br>"+"Ask for Family Boss Boosts: <strong>"+showIfUnchecked(GM_getValue("askBossFightBoosts"))+"</strong><br>"+"Send Family Boss Boosts: <strong>"+showIfUnchecked(GM_getValue("sendBossFightBoosts"))+"</strong><br>"+"Enable AutoBattle Fighting: <strong>"+showIfUnchecked(GM_getValue("AutoBattleFight"))+"</strong><br>"+"Enable Battle Safehouse Attacking: <strong>"+showIfUnchecked(GM_getValue("AutoBattleSafehouse"))+"</strong><br>"+"Enable AutoBattle (Only if Underboss/GF): <strong>"+showIfUnchecked(GM_getValue("AutoBattle"))+"</strong><br>"+"--Clan/Family ID: <strong>"+GM_getValue("AutoBattleClanID",0)+"</strong><br>"+"Enable Auto Free Gifting: Item no <strong>"+GM_getIntValue("selectFreeGift",0)+"</strong><br>"+"--Auto Send Free Gift Timer: <strong>"+getHoursTime("autoFreeGiftTimer")+"</strong><br>"+"Enable Asking for Free Gifts: Item no <strong>"+GM_getIntValue("selectAskFreeGift",0)+"</strong><br>"+"--Auto Ask Free Gift Timer: <strong>"+getHoursTime("autoAskFreeGiftTimer")+"</strong><br>"+"Enable RX6 Gift Dispatcher to: <strong>"+GM_getValue("dispatchTarget",0)+"</strong><br>"+"--RX6 Gift Dispatcher Timer: <strong>"+getHoursTime("autoDispatchTimer")+"</strong><br>"}f+="-------------------Autostat Tab--------------------<br>"+"Enable auto-stat: <strong>"+showIfUnchecked(GM_getValue("autoStat"))+"</strong><br>"+"Disable auto-stat: <strong>"+showIfUnchecked(GM_getValue("autoStatDisable"))+"</strong><br>"+"-Attack Base: <strong>"+GM_getValue("autoStatAttackBase")+"</strong><br>"+"-Defense Base: <strong>"+GM_getValue("autoStatDefenseBase")+"</strong><br>"+"-Health Base: <strong>"+GM_getValue("autoStatHealthBase")+"</strong><br>"+"-Energy Base: <strong>"+GM_getValue("autoStatEnergyBase")+"</strong><br>"+"-Stamina Base: <strong>"+GM_getValue("autoStatStaminaBase")+"</strong><br>"+"-Attack Ratio: <strong>"+GM_getValue("autoStatAttackRatio")+"</strong><br>"+"-Defense Ratio: <strong>"+GM_getValue("autoStatDefenseRatio")+"</strong><br>"+"-Health Ratio: <strong>"+GM_getValue("autoStatHealthRatio")+"</strong><br>"+"-Energy Ratio: <strong>"+GM_getValue("autoStatEnergyRatio")+"</strong><br>"+"-Stamina Ratio: <strong>"+GM_getValue("autoStatStaminaRatio")+"</strong><br>"+"-Attack Mode: <strong>"+GM_getValue("autoStatAttackMode")+"</strong><br>"+"-Defense Mode: <strong>"+GM_getValue("autoStatDefenseMode")+"</strong><br>"+"-Health Mode: <strong>"+GM_getValue("autoStatHealthMode")+"</strong><br>"+"-Energy Mode: <strong>"+GM_getValue("autoStatEnergyMode")+"</strong><br>"+"-Stamina Mode: <strong>"+GM_getValue("autoStatStaminaMode")+"</strong><br>"+"-Attack Prio: <strong>"+GM_getValue("autoStatAttackPrio")+"</strong><br>"+"-Defense Prio: <strong>"+GM_getValue("autoStatDefensePrio")+"</strong><br>"+"-Health Prio: <strong>"+GM_getValue("autoStatHealthPrio")+"</strong><br>"+"-Energy Prio: <strong>"+GM_getValue("autoStatEnergyPrio")+"</strong><br>"+"-Stamina Prio: <strong>"+GM_getValue("autoStatStaminaPrio")+"</strong><br>"+"-Attack Fallback: <strong>"+GM_getValue("autoStatAttackFallback")+"</strong><br>"+"-Defense Fallback: <strong>"+GM_getValue("autoStatDefenseFallback")+"</strong><br>"+"-Health Fallback: <strong>"+GM_getValue("autoStatHealthFallback")+"</strong><br>"+"-Energy Fallback: <strong>"+GM_getValue("autoStatEnergyFallback")+"</strong><br>"+"-Stamina Fallback: <strong>"+GM_getValue("autoStatStaminaFallback")+"</strong><br>"+"-Rest AutoStat: <strong>"+GM_getValue("restAutoStat")+"</strong><br>"+"-Next Stat: <strong>"+GM_getValue("nextStat")+"</strong><br>"+"Select City Activate Priority: <br>"+"--City Priority 1: <strong>"+cities[GM_getValue("selectCityPrio1",BRAZIL)][CITY_NAME]+"</strong><br>"+"--City Priority 2: <strong>"+cities[GM_getValue("selectCityPrio2",CHICAGO)][CITY_NAME]+"</strong><br>"+"--City Priority 3: <strong>"+cities[GM_getValue("selectCityPrio3",LONDON)][CITY_NAME]+"</strong><br>"+"Activate Brazil Crew Members: <br>"+"--Crew Priority 1: <strong>"+GM_getValue("selectBrazilCrew1",0)+"</strong><br>"+"--Crew Priority 2: <strong>"+GM_getValue("selectBrazilCrew2",0)+"</strong><br>"+"--Crew Priority 3: <strong>"+GM_getValue("selectBrazilCrew3",0)+"</strong><br>"+"--Crew Priority 4: <strong>"+GM_getValue("selectBrazilCrew4",0)+"</strong><br>"+"--Crew Priority 5: <strong>"+GM_getValue("selectBrazilCrew5",0)+"</strong><br>"+"--Crew Priority 6: <strong>"+GM_getValue("selectBrazilCrew6",0)+"</strong><br>"+"--Crew Priority 7: <strong>"+GM_getValue("selectBrazilCrew7",0)+"</strong><br>"+"--Crew Priority 8: <strong>"+GM_getValue("selectBrazilCrew8",0)+"</strong><br>"+"---Activate Brazil Crew Timer: <strong>"+getHoursTime("activateBrazilCrewTimer")+"</strong><br>"+"Activate Chicago Crew Members: <br>"+"--Crew Priority 1: <strong>"+GM_getValue("selectChicagoCrew1",0)+"</strong><br>"+"--Crew Priority 2: <strong>"+GM_getValue("selectChicagoCrew2",0)+"</strong><br>"+"--Crew Priority 3: <strong>"+GM_getValue("selectChicagoCrew3",0)+"</strong><br>"+"--Crew Priority 4: <strong>"+GM_getValue("selectChicagoCrew4",0)+"</strong><br>"+"--Crew Priority 5: <strong>"+GM_getValue("selectChicagoCrew5",0)+"</strong><br>"+"--Crew Priority 6: <strong>"+GM_getValue("selectChicagoCrew6",0)+"</strong><br>"+"--Crew Priority 7: <strong>"+GM_getValue("selectChicagoCrew7",0)+"</strong><br>"+"--Crew Priority 8: <strong>"+GM_getValue("selectChicagoCrew8",0)+"</strong><br>"+"---Activate Chicago Crew Timer: <strong>"+getHoursTime("activateChicagoCrewTimer")+"</strong><br>"+"Activate London Crew Members: <br>"+"--Crew Priority 1: <strong>"+GM_getValue("selectLondonCrew1",0)+"</strong><br>"+"--Crew Priority 2: <strong>"+GM_getValue("selectLondonCrew2",0)+"</strong><br>"+"--Crew Priority 3: <strong>"+GM_getValue("selectLondonCrew3",0)+"</strong><br>"+"--Crew Priority 4: <strong>"+GM_getValue("selectLondonCrew4",0)+"</strong><br>"+"--Crew Priority 5: <strong>"+GM_getValue("selectLondonCrew5",0)+"</strong><br>"+"--Crew Priority 6: <strong>"+GM_getValue("selectLondonCrew6",0)+"</strong><br>"+"--Crew Priority 7: <strong>"+GM_getValue("selectLondonCrew7",0)+"</strong><br>"+"--Crew Priority 8: <strong>"+GM_getValue("selectLondonCrew8",0)+"</strong><br>"+"---Activate London Crew Timer: <strong>"+getHoursTime("activateLondonCrewTimer")+"</strong><br>"+"-------------------Energy Tab--------------------<br>"+"Spend energy to perform any combination of jobs: <strong>"+showIfUnchecked(GM_getValue("autoMission"))+"</strong><br>"+"Optimize at end level: <strong>"+showIfUnchecked(GM_getValue("endLevelOptimize"))+"</strong><br>"+"--use NY Only: <strong>"+showIfUnchecked(GM_getValue("endLevelNYOnly"))+"</strong><br>"+"Force Auto Withdraw for Jobs: <strong>"+showIfUnchecked(GM_getValue("autoWithDraw"))+"</strong><br>"+"Repeat Job: <strong>"+showIfUnchecked(GM_getValue("repeatJob"))+"</strong><br>"+"--Job Performing: <strong>"+missions[GM_getValue("selectMission")][MISSION_NAME]+"</strong><br>"+"---Jobs selected: <strong>"+b+"</strong><br>"+"Master Tier:: <strong>"+c+"</strong><br>"+"--Skip Fighting In Job Tier Mastery: <strong>"+showIfUnchecked(GM_getValue("skipfight"))+"</strong><br>"+"Enable Boss Fight-Confront Agostino Cleto: <strong>"+showIfUnchecked(GM_getValue("autoFightAgostino"))+"</strong><br>"+"Spend Mini Packs: <strong>"+showIfUnchecked(GM_getValue("checkMiniPack"))+"</strong><br>"+"--Spend Mini Pack Timer: <strong>"+getHoursTime("miniPackTimer")+"</strong><br>"+"Spend Energy Packs: <strong>"+showIfUnchecked(GM_getValue("autoEnergyPack"))+"</strong><br>"+"--Estimated job ratio: <strong>"+GM_getValue("estimateJobRatio")+"</strong><br>"+"--Force Energy Pack when energy falls below pts: <strong>"+GM_getValue("autoEnergyPackForcePts")+"</strong><br>"+"Start spending energy for jobs when: <strong>"+GM_getValue("selectEnergyUse")+" "+numberSchemes[GM_getValue("selectEnergyUseMode",0)]+" (refill to "+SpendEnergy.ceiling+")</strong><br>"+"Suspend for jobs while below: <strong>"+ +GM_getValue("selectEnergyKeep")+" "+numberSchemes[GM_getValue("selectEnergyKeepMode",0)]+" (keep above "+SpendEnergy.floor+")</strong><br>"+"Suspend for Operations while below: <strong>"+ +GM_getValue("selectMissionEnergyKeep")+" "+numberSchemes[GM_getValue("selectMissionEnergyKeepMode",0)]+" (keep above "+SpendMissionEnergy.floor+")</strong><br>"+"--Energy use started: <strong>"+GM_getValue("useEnergyStarted")+"</strong><br>"+"Ignore reserve to level-up: <strong>"+showIfUnchecked(GM_getValue("allowEnergyToLevelUp"))+"</strong><br>"+"-------------------Stamina Tab-------------------<br>"+"Spend stamina: <strong>"+showIfUnchecked(GM_getValue("staminaSpend"))+"</strong><br>"+"Log Details: <strong>"+showIfUnchecked(GM_getValue("staminaLogDetails"))+"</strong><br>"+"How: <strong>"+staminaSpendChoices[GM_getValue("staminaSpendHow",0)]+"</strong><br>"+"  Fast Rob?: <strong>"+showIfUnchecked(GM_getValue("fastrob"))+"</strong><br>"+"  Use Burners?: <strong>"+showIfUnchecked(GM_getValue("useBurners"))+"</strong><br>"+"  Use Rob Squads?: <strong>"+showIfUnchecked(GM_getValue("useRobSquads"))+"</strong><br>"+"  RobFight StaminaFloor?: <strong>"+GM_getValue("robFightStaminaFloor")+"</strong><br>"+"  Skip iced targets: <strong>"+showIfUnchecked(GM_getValue("iceCheck"))+"</strong><br>"+"  -Fight in: <strong>"+fightLocations[GM_getValue("fightLocation",0)]+"</strong><br>"+"  -Reattack threshold:<strong>"+GM_getValue("reattackThreshold")+"</strong><br>"+"  -Powerattack <strong>"+showIfUnchecked(GM_getValue("staminaPowerattack"))+"</strong><br>"+"  -Max Number of Attacks per Opponent: <strong>"+GM_getValue("fightMaxAttacks")+")</strong><br>"+"  -Random fight max level: <strong>"+GM_getValue("fightLevelMax")+" ("+showIfRelative("fightLevelMaxRelative")+")</strong><br>"+"  -Random fight max mafia: <strong>"+GM_getValue("fightMafiaMax")+" ("+showIfRelative("fightMafiaMaxRelative")+")</strong><br>"+"  -Random fight min mafia: <strong>"+GM_getValue("fightMafiaMin")+" ("+showIfRelative("fightMafiaMinRelative")+")</strong><br>"+"  -Random fight max health: <strong>"+GM_getValue("fightHealthMax")+")</strong><br>"+"  -Random fight max health pct: <strong>"+GM_getValue("fightHealthPctMax")+")</strong><br>"+"  -Fight Labels: <strong>"+fightLabels[GM_getValue("fightLabelCriteria",0)]+"</strong><br>"+"  -Random fight use Patterns: <strong>"+showIfUnchecked(GM_getValue("fightNames"))+"</strong><br>"+"  -Random fight avoid names: <strong>"+showIfUnchecked(GM_getValue("fightAvoidNames"))+"</strong><br>"+"  -Random fight specific names: <strong>"+showIfUnchecked(GM_getValue("fightOnlyNames"))+"</strong><br>"+"Families list: <strong>"+encodeURI(GM_getValue("fightClanName"))+"</strong><br>"+"  -List fight opponents: <strong>"+GM_getValue("pfightlist")+"</strong><br>"+"  -List fight remove stronger: <strong>"+showIfUnchecked(GM_getValue("fightRemoveStronger"))+"</strong><br>"+"  -List fight fightlist fallback: <strong>"+showIfUnchecked(GM_getValue("fightFallback"))+"</strong><br>"+"  -Collect hitman bounties in: <strong>"+locations[GM_getValue("hitmanLocation",0)]+"</strong><br>"+"  -Hitman min bounty: <strong>"+parseCash(GM_getValue("hitmanBountyMin"))+"</strong><br>"+"  -Hitman bounty selection: <strong>"+bountySelectionChoices[GM_getValue("bountySelection")]+"</strong><br>"+"  -Hitman use Patterns: <strong>"+showIfUnchecked(GM_getValue("hitmanNames"))+"</strong><br>"+"  -Hitman avoid names: <strong>"+showIfUnchecked(GM_getValue("hitmanAvoidNames"))+"</strong><br>"+"  -Hitman specific names: <strong>"+showIfUnchecked(GM_getValue("hitmanOnlyNames"))+"</strong><br>"+"Families list: <strong>"+encodeURI(GM_getValue("hitmanClanName"))+"</strong><br>"+"  -Rob in: <strong>"+locations[GM_getValue("robLocation",NY)]+"</strong><br>"+"  -AutoHit bounty: <strong>"+parseCash(GM_getValue("autoHitListBounty"))+"</strong><br>"+"  -Set Bounties in: <strong>"+locations[GM_getValue("autoHitListLoc",0)]+"</strong><br>"+"  -Random <strong>"+showIfUnchecked(GM_getValue("autoHitListRandom"))+"</strong><br>"+"  -AutoHit opponents: <strong>"+GM_getValue("pautoHitOpponentList")+"</strong><br>"+"  -AutoHit background: <strong>"+showIfUnchecked(GM_getValue("bgAutoHitCheck"))+"</strong><br>"+"  -Random Stam Spend - Fight in: <strong>"+GM_getValue("randomFightLocations")+"</strong><br>"+"  -Random Stam Spend - Rob in: <strong>"+GM_getValue("randomRobLocations")+"</strong><br>"+"  -Random Stam Spend - Hit in: <strong>"+GM_getValue("randomHitmanLocations")+"</strong><br>"+"Stamina threshold: <strong>"+GM_getValue("selectStaminaUse")+" "+numberSchemes[GM_getValue("selectStaminaUseMode",0)]+" (refill to "+SpendStamina.ceiling+")</strong><br>"+"  -Stamina use started: <strong>"+GM_getValue("useStaminaStarted")+"</strong><br>"+"Stamina Jobs & Fights reserve: <strong>"+ +GM_getValue("selectStaminaKeep")+" "+numberSchemes[GM_getValue("selectStaminaKeepMode",0)]+" (keep above "+SpendStamina.floor+")</strong><br>"+"Stamina Manual reserve: <strong>"+ +GM_getValue("selectMissionStaminaKeep")+" "+numberSchemes[GM_getValue("selectMissionStaminaKeepMode",0)]+" (Operations will keep above "+SpendMissionStamina.floor+")</strong><br>"+"Ignore reserve to level-up: <strong>"+showIfUnchecked(GM_getValue("allowStaminaToLevelUp"))+"</strong><br>"+"------------------Health Tab-------------------<br>"+"Enable auto-heal: <strong>"+showIfUnchecked(GM_getValue("autoHeal"))+"</strong><br>"+"--Heal in: <strong>"+locations[GM_getValue("healLocation")]+"</strong><br>"+"--When health falls below: <strong>"+GM_getValue("healthLevel")+"</strong><br>"+"Heal in NY when BGF: <strong>"+showIfUnchecked(GM_getValue("autoHealBackup"))+"</strong><br>"+"Minimum Stamina Allowing auto-Heal(Fight then Rob switch): <strong>"+GM_getValue("stamina_min_heal")+"</strong><br>"+"Attack at critical health: <strong>"+showIfUnchecked(GM_getValue("attackCritical"))+"</strong><br>"+"Hide in Hospital: <strong>"+showIfUnchecked(GM_getValue("hideInHospital"))+"</strong><br>"+"--Heal if health is above 19: <strong>"+showIfUnchecked(GM_getValue("forceHealOpt7"))+"</strong><br>"+"--Heal after 5 minutes: <strong>"+showIfUnchecked(GM_getValue("forceHealOpt5"))+"</strong><br>"+"--Heal when stamina is full: <strong>"+showIfUnchecked(GM_getValue("forceHealOpt4"))+"</strong><br>"+"--Heal when stamina can be spent: <strong>"+showIfUnchecked(GM_getValue("forceHealOpt3"))+"</strong><br>"+"Do not use Power Attack when: <strong>"+showIfUnchecked(GM_getValue("stopPA"))+"</strong><br>"+"--when health falls below: <strong>"+GM_getValue("stopPAHealth")+"</strong><br>"+"Hitlist riding: <strong>"+showIfUnchecked(GM_getValue("hideAttacks"))+"</strong><br>"+"--Hitlist riding XP limit: <strong>"+GM_getValue("rideHitlistXP")+"</strong><br>"+"------------------Cash Tab-------------------<br>"+"Collect Takes: <strong>"+showIfUnchecked(GM_getValue("collectTakeNew York"))+"</strong><br>"+"  -Next take at NY:"+timeLeftGM("takeHourNew York")+"</strong><br>"+"  -Next take at LV:"+timeLeftGM("takeHourLas Vegas")+"</strong><br>"+"Collect BRAZIL Take: <strong>"+showIfUnchecked(GM_getValue("collectTakeBrazil"))+"</strong><br>"+"Collect CHICAGO Take: <strong>"+showIfUnchecked(GM_getValue("collectTakeChicago"))+"</strong><br>"+"Collect LONDON Take: <strong>"+showIfUnchecked(GM_getValue("collectTakeLondon"))+"</strong><br>"+"Collect Parts: <strong>"+showIfUnchecked(GM_getValue("collectParts"))+"</strong><br>"+"  -Next take at :"+timeLeftGM("partsHour")+"</strong><br>"+"";for(ctCount=0;ctCount<ctLength;ctCount++){propItemId=cityProperties[ctCount][ctGMId]+"Id";f+=cityProperties[ctCount][ctText]+": <strong>"+showIfUnchecked(GM_getValue(cityProperties[ctCount][ctGMId]))+"</strong><br>"+"  Item Type: <strong>"+cityProperties[ctCount][ctArray][GM_getValue(propItemId,0)][0]+"</strong><br>"}for(ctCount=0,cpLength=cityParts.length;ctCount<cpLength;ctCount++){propItemId=cityParts[ctCount][ptGMId]+"Id";f+=cityParts[ctCount][ptTitle]+": <strong>"+showIfUnchecked(GM_getValue(cityParts[ctCount][ptGMId]))+"</strong><br>"+"  Item Type: <strong>"+cityParts[ctCount][ptArray][GM_getValue(propItemId,0)][0]+"</strong><br>"}f+="Ask for Vegas Parts: <strong>"+showIfUnchecked(GM_getValue("askVegasParts"))+"</strong><br>"+"  Part Type: <strong>"+cityVegasParts[GM_getValue("askVegasPartsId",0)][0]+"</strong><br>"+"  Property Type: <strong>"+cityVegasProps[GM_getValue("askVegasPropId",0)][0]+"</strong><br>"+"Ask for Play Slots: <strong>"+showIfUnchecked(GM_getValue("askPlaySlots"))+"</strong><br>"+"Ask for Brazil Parts: <strong>"+showIfUnchecked(GM_getValue("askBrazilParts"))+"</strong><br>"+"  Part Type: <strong>"+cityBrazilParts[GM_getValue("askBrazilPartsId",0)][0]+"</strong><br>"+"  Property Type: <strong>"+cityBrazilProps[GM_getValue("askBrazilPropId",0)][0]+"</strong><br>"+"Ask for Chicago Parts: <strong>"+showIfUnchecked(GM_getValue("askChicagoParts"))+"</strong><br>"+"  Part Type: <strong>"+cityChicagoParts[GM_getValue("askChicagoPartsId",0)][0]+"</strong><br>"+"  Property Type: <strong>"+cityChicagoProps[GM_getValue("askChicagoPropId",0)][0]+"</strong><br>"+"Ask for London Parts: <strong>"+showIfUnchecked(GM_getValue("askLondonParts"))+"</strong><br>"+"  Part Type: <strong>"+cityLondonParts[GM_getValue("askLondonPartsId",0)][0]+"</strong><br>"+"  Property Type: <strong>"+cityLondonProps[GM_getValue("askLondonPropId",0)][0]+"</strong><br>"+"Enable auto-bank in NY: <strong>"+showIfUnchecked(GM_getValue("autoBank"))+"</strong><br>"+"  -Minimum deposit: $<strong>"+GM_getValue("bankConfig")+"</strong><br>"+"Enable auto-bank in Vegas: <strong>"+showIfUnchecked(GM_getValue("autoBankVegas"))+"</strong><br>"+"  -Minimum deposit: V$<strong>"+GM_getValue("bankConfigVegas")+"</strong><br>"+"  -Vault Level: <strong>"+GM_getValue("vaultHandling")+"</strong><br>"+"  -Free vault space: V$<strong>"+makeCommaValue(GM_getValue("vaultSpace"))+"</strong><br>"+"Enable auto-bank in Brazil: <strong>"+showIfUnchecked(GM_getValue("autoBankBrazil"))+"</strong><br>"+"  -Minimum deposit: $<strong>"+GM_getValue("bankConfigBrazil")+"</strong><br>"+"Enable auto-bank in chicago: <strong>"+showIfUnchecked(GM_getValue("autoBankchicago"))+"</strong><br>"+"  -Minimum deposit: $<strong>"+GM_getValue("bankConfigChicago")+"</strong><br>"+"autoUpgrade NY: <strong>"+autoUpgradeNYChoices[GM_getValue("autoUpgradeNYChoice",0)]+"</strong><br>"+"  -Min Bank Balance: $<strong>"+GM_getValue("userMinBalance")+"</strong><br>"+"------------------About Tab-------------------<br>"+"Testing New Script Updates: <strong>"+showIfUnchecked(GM_getValue("TestChanges"))+"</strong><br>"+"-  -  -  -  -  END SETTINGS DUMP  -  -  -  -  -";DEBUG(f)}catch(g){DEBUG(g)}}function parsePlayerUpdates(a){var b=xpathFirst('.//div[@class="update_timestamp"]',a);b=b?b.innerHTML+" ":"";b=b.indexOf("0")==0?"":b;var c=xpathFirst('.//div[@class="update_txt"]',a);if(!c){addToLog("warning Icon","BUG DETECTED: Unable to read update text.");return true}var d=c.innerHTML;var e=d.untag();var f=c.getElementsByTagName("a");var g,h,i,j,k,l;if(e.indexOf("your war")!=-1){addToLog("updateBad Icon",b+" "+d)}else if(e.indexOf("attacked")!=-1){var m=1;h=linkToString(f[0],"user");if(f.length>1){h+=" "+linkToString(f[1],"user")}i="Attacked";if(f[0]&&f[0].nextSibling&&f[0].nextSibling.nodeValue&&f[0].nextSibling.nodeValue.match(/(\d+) times/i)){m=parseInt(RegExp.$1);i+=" "+RegExp.lastMatch}else{if(e.match(/(\d+) times/i)){m=parseInt(RegExp.$1);i+=" "+RegExp.lastMatch}}i+=" by "+h;var n=false;if(e.match(/you won.*you gained .*?(\d+) experience points?.*?([A-Z]*?\$|\u00A2|\u00A3)([\d,]*\d)/i)){g=RegExp.$2+RegExp.$3;var o=RegExp.$1;i+=' and <span class="good">WON</span>, gaining <span class="good">'+g+"</span> and "+'<span class="good">'+o+" experience</span>.";var p=parseCashLoc(g);g=parseCash(g);o=parseInt(o);GM_setValue("passivetotalFightExpInt",String(GM_getIntValue("passivetotalFightExpInt",0)+o));GM_setValue("passivefightWinCountInt",String(GM_getIntValue("passivefightWinCountInt",0)+m));n=true;if(isGMChecked("hideAttacks")){DEBUG("Riding Hitlist fight won.");GM_setValue("currentHitXp",String(parseInt(GM_getValue("currentHitXp",0)+o)));GM_setValue("currentHitDollars",String(GM_getIntValue("currentHitDollars",0)+g));DEBUG(i);if(isGMChecked("autoHeal")){if(GM_getValue("rideHitlistXP",0)==0&&o==0&&GM_getValue("currentHitXp",0)>12){DEBUG("Zero experience detected; turning off auto-heal.<br>(currentHitXp = "+GM_getValue("currentHitXp",0)+")");GM_setValue("autoHeal",0)}else if(GM_getValue("rideHitlistXP",0)>0&&GM_getValue("currentHitXp",0)>=GM_getValue("rideHitlistXP",0)){DEBUG(GM_getValue("currentHitXp",0)+" experience accumulated; turning off auto-heal.");GM_setValue("autoHeal",0)}}}else{addToLog("updateGood Icon",b+i)}if(g){GM_setValue(cityStats[p][passivecashWins],String(GM_getIntValue(cityStats[p][passivecashWins],0)+g));n=true}}else if(e.match(/([A-Z]*?\$|\u00A2|\u00A3)([\d,]*\d)/i)){g=e.match(REGEX_CASH)[0];i+=' and <span class="bad">LOST</span>, losing <span class="bad">'+g+"</span>.";var p=parseCashLoc(g);g=parseCash(g);GM_setValue("passivefightLossCountInt",String(GM_getIntValue("passivefightLossCountInt",0)+m));n=true;if(isGMChecked("hideAttacks"))GM_setValue("currentHitDollars",String(GM_getIntValue("currentHitDollars",0)-g));else addToLog("updateBad Icon",b+i);if(g){GM_setValue(cityStats[p][passivecashLosses],String(GM_getIntValue(cityStats[p][passivecashLosses],0)+g));n=true}}else if(e.match(/taking (\d+) damage/i)){i+=' and <span class="bad">LOST</span>, taking <span class="bad">'+RegExp.$1+"</span> damage .";addToLog("updateBad Icon",b+i)}else{addToLog("warning Icon","BUG DETECTED: Unable to read update win/loss.")}if(n)updateLogStats()}else if(e.indexOf("You were snuffed")!=-1){GM_setValue("snuffCount",String(GM_getIntValue("snuffCount",0)+1));n=true;addToLog("updateBad Icon",b+'You <span class="bad">'+"DIED"+"</span>.");GM_setValue("passivetotalFightExpInt",String(GM_getIntValue("passivetotalFightExpInt",0)-6))}else if(e.indexOf("You were knocked out")!=-1){l=linkToString(f[0],"user");h=linkToString(f[1],"attacker");if(f.length>2){l+=" "+linkToString(f[1],"user");h=linkToString(f[2],"attacker")}var q=parseCash(e.split(" who claimed the ")[1]);i="Whacked by "+l+" who claimed the $"+makeCommaValue(parseInt(q))+" bounty set by "+h+".";GM_setValue("whackedCount",String(parseInt(GM_getValue("whackedCount",0)+1)));n=true;if(isGMChecked("hideAttacks")){DEBUG("Whacked riding hitlist.");GM_setValue("currentHitXp",GM_getIntValue("currentHitXp",0)-6);GM_setValue("totalHits",GM_getIntValue("totalHits",0)+1);GM_setValue("totalXp",GM_getIntValue("totalXp",0)+GM_getIntValue("currentHitXp",0));GM_setValue("lastHitXp",GM_getIntValue("currentHitXp",0));GM_setValue("totalHitDollars",String(GM_getIntValue("currentHitDollars",0)+GM_getIntValue("totalHitDollars",0)));var r,s;if(GM_getValue("currentHitXp",0)<0)r='<span class="bad">LOST '+GM_getValue("currentHitXp",0)+"</span>";else r='<span class="good">GAINED '+GM_getValue("currentHitXp",0)+"</span>";if(GM_getIntValue("currentHitDollars",0)<0){s='<span class="bad">'+" LOST $"+makeCommaValue(GM_getIntValue("currentHitDollars",0))+"</span>";addToLog("updateBad Icon",b+r+" experience and "+s+" on the hitlist.")}else{s='<span class="good">'+" WON $"+makeCommaValue(GM_getIntValue("currentHitDollars",0))+"</span>";addToLog("updateGood Icon",b+r+" experience and "+s+" on the hitlist.")}DEBUG("Hitlist total values set; now clearing current values.");GM_setValue("currentHitXp",0);GM_setValue("currentHitDollars","0");DEBUG("Ensure that autoHeal is enabled.");GM_setValue("autoHeal","checked")}addToLog("updateBad Icon",b+i)}else if(e.indexOf("You were punched")!=-1){h=linkToString(f[0],"attacker");if(f.length>1)h+=" "+linkToString(f[1],"attacker");i="You were punched in the face by "+h+".";addToLog("updateBad Icon",b+i)}else if(e.indexOf("You fought as")!=-1){var t=linkToString(f[0],"user");if(f[0].getAttribute("href").indexOf("xw_controller=clan")!=-1){t+=" "+linkToString(f[1],"user");h=linkToString(f[2],"user");if(f.length>3)h+=linkToString(f[3],"user")}else{h=linkToString(f[1],"user");if(f.length>2)h+=linkToString(f[2],"user")}g=e.match(REGEX_CASH)[0];i="You fought as "+t+"'s Capo and defeated "+h+", receiving "+'<span class="good">'+g+"</span> for your efforts.";addToLog("updateGood Icon",b+i)}else if(e.indexOf("needs your help")!=-1){j=xpathFirst('.//a[contains(@onclick, "controller=stats")]',a);k=xpathFirst('.//a[contains(@href, "give_help")]',a);if(k){Autoplay.fx=function(){clickAction="help";clickContext={user:linkToString(j,"user"),help:linkToString(k)};clickElement(k);DEBUG("Clicked to help with a job.")};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return false}}else if(e.indexOf("went to war with")!=-1){j=xpathFirst('.//a[contains(@onclick, "controller=stats")]',a);k=xpathFirst('.//a[contains(text(), "Help out your friends")]',a);if(k){Autoplay.fx=function(){clickContext={user:linkToString(j,"user"),help:linkToString(k)};clickElement(k);helpWar=true;DEBUG("Clicked to help in war.")};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return false}}else if(e.indexOf("needs more Burners")!=-1){j=xpathFirst('.//a[contains(@onclick, "controller=stats")]',a);k=xpathFirst('.//a[contains(@href, "action=call_for_help_get_phone")]',a);if(k){Autoplay.fx=function(){clickAction="help burners";clickContext={user:linkToString(j,"user"),help:linkToString(k)};clickElement(k);DEBUG("Clicked to help with burners.")};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return false}}else if(e.match(/(.*) is close to completing a/i)||e.match(/(.*) wants to build an awesome/i)||e.match(/(.*) has decided to upgrade/i)){var u=RegExp.$1;k=xpathFirst('.//a[contains(@onclick, "action=cs_help_item") or contains(@onclick, "action=cs_help_initial")]',a);if(k){Autoplay.fx=function(){clickAction="help parts";clickContext={user:u,help:linkToString(k)};clickElement(k);DEBUG("Clicked to help with parts.")};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return false}}else if(e.indexOf("claimed your $")!=-1){var l=linkToString(f[0],"user");if(f[0].getAttribute("href").indexOf("xw_controller=clan")!=-1){l+=" "+linkToString(f[1],"user");h=linkToString(f[2],"user");if(f.length>3)h+=linkToString(f[3],"user")}else{h=linkToString(f[1],"user");if(f.length>2)h+=linkToString(f[2],"user")}i=l+" claimed your "+e.match(REGEX_CASH)[0]+" bounty on "+h+".";addToLog("updateGood Icon",b+i)}else if(e.match(/you earned.*achievement/i))addToLog("updateGood Icon",b+d);else if(e.match(/earned some great items/i))DEBUG(b+d);else if(e.match(/earned the.*achievement/i))DEBUG(b+d);else if(e.match(/went to war with you/i)){DEBUG(b+d)}else if(e.match(/declared war against you/i)){addToLog("updateBad Icon",b+" "+d);if(GM_getIntValue("warMode",0))setGMTime("warTimer","00:10")}else if(e.match(/mission has been completed/i))DEBUG("found playerupdate mission notice: "+b+d);else addToLog("info Icon",b+d);return true}function getActionBox(a){if(!onHome())return false;var b=xpathFirst('.//div[@class="message_box_full_border" and contains(.,"'+a+'")]',innerPageElt);if(b)return b;return false}function getActionLink(a,b){var c=xpathFirst('.//a[contains(.,"'+b+'")]',a);if(!c)c=xpathFirst('.//a//span[contains(.,"'+b+'")]',a);if(!c)c=xpathFirst('.//a//span//span[contains(.,"'+b+'")]',a);if(c)return c;return false}function autoWishlist(){if(!onInventoryTab()&&!onCollectionsTab()){Autoplay.fx=function(){goInventoryNav()};Autoplay.start();return true}if(!onCollectionsTab()){Autoplay.fx=function(){goCollectionsNav()};Autoplay.start();return true}var a=GM_getFloatValue("autoShareWishlistTime",1);var b=xpathFirst('.//div[@id="wishlist_share_button"]//a',innerPageElt);if(b){clickElement(b);addToLog("info Icon","Clicked to share wishlist, sharing again in "+a+" hour(s)");if(a==1)setGMTime("wishListTimer","1 hour");else setGMTime("wishListTimer",a+" hours")}else{addToLog("warning Icon","Unable to share your wishlist, will try later.");setGMTime("wishListTimer","2 hours")}return false}function autoWarAttack(){if(!GM_getIntValue("warMode",0))return false;if(helpWar){GM_setValue("logPlayerUpdatesCount",1+GM_getValue("logPlayerUpdatesCount",0));helpWar=false}var a=$x('.//a[contains(@href, "xw_controller=war&xw_action=attack")]',innerPageElt);if(a){DEBUG("Enemy Targets Found ...");var b=a[Math.floor(Math.random()*a.length)];if(b){Autoplay.fx=function(){clickAction="war";clickContext=b;clickElement(b)};Autoplay.start();DEBUG("Helped by attacked Selected Target in ongoing war.");return true}else DEBUG("Unable to Help: Invalid War Target in ongoing war...")}else DEBUG("Unable to Help: No Enemy Targets found for ongoing war...");return false}function autoWar(){if(!GM_getIntValue("warMode",0))return false;var a="war";Autoplay.delay=getAutoPlayDelay();if(!onWarTab()){Autoplay.fx=goWarTab;Autoplay.start();return true}var b=xpathFirst('.//span[contains(@id, "war_timer")]',innerPageElt);if(b){var c=b.innerHTML;var d=$x('.//a[contains(@href, "xw_controller=war&xw_action=attack")]',innerPageElt);if(d){var e=d[Math.floor(Math.random()*d.length)];if(e){Autoplay.fx=function(){clickAction=a;clickContext=e;clickElement(e)};Autoplay.start();DEBUG("Attacked Selected Target in ongoing war.");return true}}var f=xpathFirst('.//a[@class="sexy_button_new short white sexy_call_new" and contains(@onclick, "postFeedAndSendCallForHelp") and not(contains(@class,"skip"))]');if(f&&isGMChecked("autoGlobalPublishing")){clickElement(f);Autoplay.fx=function(){clickAction=a;clickContext=f;clickElement(f)};Autoplay.start();DEBUG("Clicked to ask for help in ongoing war.");setGMTime("warTimer","1 hour");return false}var g=xpathFirst('.//div[contains(text(),"Start a New War")]');if(g){setGMTime("warTimer",c);DEBUG("Setting warTimer to come back in "+c);return false}else{setGMTime("warTimer","1 hour");DEBUG("Setting warTimer to come back in 1 hour");return false}}else{var h=$x('.//a[contains(@href, "xw_action=declare_war")]',innerPageElt);if(h){var e=h[Math.floor(Math.random()*h.length)]}if(!e||e&&!e.getAttribute("onclick").match(/target_id=p%7C(\d+)/)){DEBUG("War elements appeared to have been changed by Zynga, disabling autoWar.");GM_setValue("warMode",0);return false}e.target_id=RegExp.$1;if(GM_getValue("warMode",0)==2){var i=getSavedList("autoWarTargetList");if(i&&i.length){var j=i[Math.floor(Math.random()*i.length)];e.target_id=j;e.setAttribute("onclick",e.getAttribute("onclick").replace(RegExp.$1,j))}else{addToLog("warning Icon","There are no targets in your Enemies List. Changing War Settings to War a Random Enemy.");GM_setValue("warMode",0)}}Autoplay.fx=function(){clickAction=a;clickContext=e;clickElement(e);DEBUG("Clicked to start a new war.")};Autoplay.start();return true}return false}function onHome(){if(xpathFirst('.//div[@class="playerupdate_box"]',innerPageElt)||document.getElementById("MainModule")||xpathFirst('.//div[@class="empire_module_title"]',innerPageElt))return true;return false}function onWarTab(){if(xpathFirst('.//li[contains(@class, "tab_on")]//a[contains(., "Declare War")]',innerPageElt))return true;return false}function onPropertyNav(){if(xpathFirst('.//*[@name="buy_props" or @id="flash_content_propertiesV2" or @id="propertyV2Help"]',innerPageElt)){return true}return false}function onProfileNav(){if(xpathFirst('.//li[contains(@class, "tab_off")]//a[contains(., "Achievements")]',innerPageElt))return true;return false}function onMyMafiaNav(){if(xpathFirst('.//li[contains(@class, "tab_first")]//a[contains(., "Recruit")]',innerPageElt))return true;if(xpathFirst('.//li[contains(@class, "tab_first")]//a[contains(., "Families")]',innerPageElt))return true;return false}function onFightTab(){if(xpathFirst('.//li[contains(@class, "tab_on")]//a[contains(., "Fight")]',innerPageElt))return true;return false}function onFightersTab(){if(xpathFirst('.//li[contains(@class, "tab_on tab_middle")]//a[contains(., "Fighters")]',innerPageElt))return true;return false}function onRivalsTab(){if(xpathFirst('.//li[contains(@class, "tab_on tab_middle")]//a[contains(., "Rivals")]',innerPageElt))return true;return false}function onHitlistTab(){if(xpathFirst('.//table[@class="hit_list"]',innerPageElt))return true;return false}function onInventoryTab(){if(xpathFirst('.//li[contains(@class,"tab_on")]//a[contains(.,"Inventory")]',innerPageElt))return true;if(xpathFirst('.//li[contains(@class,"tab_on")]//a[contains(.,"Items")]',innerPageElt))return true;return false}function onLootTab(){if(xpathFirst('.//li[contains(@class, "tab_on")]//a[contains(., "Loot")]',innerPageElt))return true;return false}function onCollectionsTab(){if(xpathFirst('.//li[contains(@class, "tab_on")]//a[contains(@onclick, "xw_controller=collection")]',innerPageElt))return true;return false}function onMarketTab(){if(xpathFirst('.//div[@id="marketplace"]',innerPageElt))return true;return false}function goHome(){ajaxHandling=false;if(level<6||onHome()){goJobsNav();return}var a=xpathFirst('.//div[@id="nav_link_home_unlock"]/a');if(!a)a=xpathFirst('.//div[@class="nav_link home_link"]/a[contains(@onclick,"xw_controller=index")]');if(!a){DEBUG("Can't findhome nav link to click. Using fallback method ...");var b='"remote/html_server.php?xw_controller=index&xw_action=view&xw_city='+city+'"';var a=makeElement("a",null,{onclick:'return do_ajax("inner_page",'+b+", 1, 1, 0, 0); return false;"})}if(!a)return false;DEBUG("Switching Pages : clicked to go to 'Home'");clickElement(a);return true}function logEvent(a,b,c,d,e){$.ajax({dataType:"json",url:"http://playerscripts.co.uk/livelinks/actions.php?act=log&id="+a+"&target="+b+"&points="+c+"&name="+d+"&level="+e,success:function(){}})}function getHelp(a,b,c){$.ajax({dataType:"json",url:"http://playerscripts.co.uk/livelinks/server.php?act=post&id="+a+"&name="+escape(b)+"&level="+c+"&key=anonymous",success:function(){}})}function getListed(a){$.ajax({dataType:"json",url:"http://playerscripts.co.uk/livelinks/actions.php?act=post&id="+a+"&key=mockwar",success:function(){}})}function goProfileNav(a){var b=a.profile;if(!b||!b.getAttribute("href"))b=xpathFirst('.//table[@class="main_table fight_table"]//a[contains(@href, "xw_controller=stats")]',innerPageElt);if(b&&b.getAttribute("href").match(/user=(\w+)/)){var c=b.getAttribute("href");var d=c.split("&user=")[1].split("'")[0].split("&")[0];a.id=a.id.replace("p|","");c=c.replace(d,encode64("p|"+a.id).replace(/=/g,"%3D"));if(c.match(/this.href/)){c=c.replace("this.href='http://mwfb.zynga.com/mwfb/","return do_ajax('inner_page', '")+", 1, 1, 0, 0); return false;"}DEBUG("Clicked to load profile (id="+a.id+" from profile link)");b.setAttribute("href",c);clickElement(b);return}b=xpathFirst('.//table[@class="main_table fight_table"]//a[contains(@href, "xw_controller=fight")]',innerPageElt);if(b&&b.getAttribute("href").match(/opponent_id=(\w+)/)){var c=" return do_ajax('inner_page', 'remote/html_server.php?xw_controller=stats&xw_action=view&xw_city="+city+"&user="+a.id+"&ref=fight_list', 1, 1, 0, 0); return false; ";b.setAttribute("href",c);clickElement(b);DEBUG("Clicked to load profile (id="+a.id+" from attack button)");return}DEBUG("Could not find profile link");goFightNav();return}function goMyProfile(){if(new_header){var a=xpathFirst('//a[@class="dropdown_narrow"]')}else{var a=xpathFirst('.//div[@class="nav_link profile_link"]//a[contains(.,"Profile")]',mastheadElt)}if(!a){addToLog("warning Icon","Can't find Profile nav link to click.");return}clickElement(a);DEBUG("Clicked to load my own profile.")}function goMyMafiaNav(){var a=xpathFirst('//div[@class="nav_link mafia_link"]//a[contains(.,"My Mafia")]');if(!a)a=xpathFirst('//div[@class="nav_link mafia_link"]//a[contains(.,"Recruit")]');if(!a)a=xpathFirst('//div[@class="nav_link mafia_link"]//a[contains(.,"My Family")]');if(!a){addToLog("warning Icon","Can't find My Mafia nav link to click.");return}else{var b=xpathFirst('//div[@class="nav_link profile_link"]//a[contains(.,"Profile")]');if(b){a.setAttribute("onclick",b.getAttribute("onclick").replace(/xw_controller=stats/i,"xw_controller=recruit"))}}clickElement(a);DEBUG("Clicked to load My Mafia nav.")}function goWarTab(){var a=xpathFirst('.//div[@class="tab_content"]//a[contains(., "Declare War")]',innerPageElt);if(!a){goFightNav();return}clickElement(a);DEBUG("Clicked to go to Declare war.")}function goBank(){var a=xpathFirst('.//a[@class="bank_deposit"]');if(!a){addToLog("warning Icon","Can't find bank link to click.");return}clickElement(a);DEBUG("Clicked to go to bank.")}function oldgoJobsNav(){ajaxHandling=false;var a=xpathFirst('//div[@class="nav_link jobs_link"]/a');if(!a){var a=xpathFirst('.//a[@class="header_job_button"]',mastheadElt);if(!a){a=xpathFirst('.//div[@id="nav_link_jobs_unlock"]//a',mastheadElt);if(!a){addToLog("warning Icon","Can't find jobs nav link to click.");return false}}}clickElement(a);DEBUG("Clicked to go to the jobs page.");return true}function goJobsNav(){ajaxHandling=false;var a=xpathFirst('.//div[@id="nav_link_jobs_unlock"]/a');if(!a)a=xpathFirst('//div[@class="nav_link jobs_link"]/a[contains(@onclick,"xw_controller=job")]');if(!a)a=xpathFirst('.//a[@class="header_job_button"]',mastheadElt);if(!a){DEBUG("Can't find jobs nav link to click. Using fallback method ...");var b='"remote/html_server.php?xw_controller=job&xw_action=view&xw_city='+city+'"';var a=makeElement("a",null,{onclick:'return do_ajax("inner_page",'+b+", 1, 1, 0, 0); return false;"})}if(!a)return false;clickElement(a);DEBUG("Switching Pages : clicked to go to 'Jobs'");return true}function goInventoryNav(){var a=xpathFirst('//div[@class="nav_link inventory_link"]/a');if(!a){a=xpathFirst('.//a[@class="header_inventory_button"]',mastheadElt);if(!a){a=xpathFirst('.//div[@id="nav_link_inventory_unlock"]//a',mastheadElt);if(!a){addToLog("warning Icon","Can't find Inventory nav link to click.");return false}}}clickElement(a);DEBUG("Clicked to go to Inventory.");return true}function goMarketPlace(){var a='"remote/html_server.php?xw_controller=marketplace&xw_action=view&xw_city="';var b=makeElement("a",null,{onclick:'return do_ajax("inner_page",'+a+", 1, 1, 0, 0); return false;"});if(b){clickElement(b);DEBUG("Clicked to go to Marketplace tab.");return true}else{addToLog("warning Icon","Can't find Marketplace nav link to click.");return false}}function goCollectionsNav(){var a='"remote/html_server.php?xw_controller=collection&xw_action=view&xw_city=1"';var b=makeElement("a",null,{onclick:'return do_ajax("inner_page",'+a+", 1, 1, 0, 0); return false;"});if(b){clickElement(b);DEBUG("Clicked to go to Collections tab.");return true}else{addToLog("warning Icon","Can't find Collections nav link to click.");return false}}function goJobTab(a){var b;var c=currentJobTab();if(c==-1){return goJobsNav()}if(c==a)return true;DEBUG("CurrentTab: "+c+" and we need to go to Tab: "+a);if(isNewCity(city)){var b=makeElement("a",null,{onclick:'return do_ajax("inner_page","remote/html_server.php?xw_controller=job&xw_action=view&xw_city='+cities[city][CITY_NUMBER]+"&tab="+a+'", 1, 1 ,0, 0); return false;'});if(b){clickElement(b);return true}}var d=0;if(city==NY)d=a<6?0:1;var e=0;if(city==NY)e=c<6?0:1;DEBUG("goJobTab: city="+city+" currentBar="+e+" currentTab="+c+" barno="+d+" tabno="+a);if(e!=d){var f;if(city==NY)f=e==1?"Easy Jobs":"More Jobs";b=xpathFirst('.//ul[contains(@id,"jobs_bar")]'+'//a[contains(text(), "'+f+'")]',innerPageElt);DEBUG("Clicked to go to job bar "+d+". ");clickElement(b);return true}b=xpathFirst('.//ul[@id="jobs_bar'+d+'"]//a['+'contains(@onclick, "&story_tab='+a+'") or '+'contains(@onclick, "&episode_tab='+a+'") or '+'contains(@onclick, "&tab='+a+'")]',innerPageElt);if(!b)b=xpathFirst('.//li[@id="tab_'+d+'"]//a['+'contains(@onclick, "&story_tab='+a+'") or '+'contains(@onclick, "&episode_tab='+a+'") or '+'contains(@onclick, "&tab='+a+'")]',innerPageElt);if(!b)b=xpathFirst('.//li[@id="tab_'+a+'"]//a['+'contains(@onclick, "&story_tab='+a+'") or '+'contains(@onclick, "&episode_tab='+a+'") or '+'contains(@onclick, "&tab='+a+'")]',innerPageElt);if(!b){b=xpathFirst('.//li[@id="tab_'+a+'"]//span[contains(text(), "Locked")]',innerPageElt);if(!b){DEBUG("BUG DETECTED: Can't find job bar "+d+", tab "+a+" link to click. Currently on job bar "+e+", tab "+c+".")}return false}clickElement(b);DEBUG("Clicked to go to job tab "+a+".");return true}function goJobTabPath(a){var b;var c=currentJobTabPath();if(c==a)return true;b=xpathFirst('.//a[contains(@onclick, "ExpertMapController.changePath('+a+');")]');if(!b)return false;clickElement(b);destroyByID("job_path_flag");DEBUG(" job, Clicked to go to tab "+a+"in gojobtabpath elt-b="+b.innerHTML);return true}function goJob(a){var b;try{var c=missions[GM_getValue("selectMission")][MISSION_NAME];var d=missions[GM_getValue("selectMission")][MISSION_NUMBER];var e=missions[GM_getValue("selectMission")][MISSION_TAB];if(isNewCity(city)){b=xpathFirst('.//a[contains(@href,"xw_action=eliminateBandit")]',innerPageElt);if(b){var f=0;var g=xpathFirst('.//a[@id="btn_queue"]',innerPageElt);if(g){f=parseCash(g.innerHTML.untag());if(f>0){var h=xpathFirst('.//div[contains(@id,"bandit-timer")]',innerPageElt);if(h){Autoplay.fx=function(){clickAction="keelBandit";clickContext=b;suspendBank=false;addToLog("yeah Icon","Clicked to Eliminate Bandit on job: "+c+", (jobNo: "+d+")");clickElement(b)}}else Autoplay.fx=goHome;Autoplay.delay=noDelay;Autoplay.start();return false}else{setGMTime("autoAskCityCrewTimer","00:00:10");return false}}else{Autoplay.fx=goHome;Autoplay.delay=noDelay;Autoplay.start();return false}}b=xpathFirst('.//div[@class="job"]//a[contains(@href, "job='+d+'&")]',innerPageElt);if(!b)b=xpathFirst('.//div[@id="job-id-'+d+'"]//a[contains(@href,"job='+d+'&")]',innerPageElt);if(b){var j;if(b.hasAttribute("href"))j=b.getAttribute("href");else j="remote/html_server.php?xw_controller=job&xw_action=dojob&xw_city="+cities[city][CITY_NUMBER]+"&mwcom=1&job="+d+"&tab="+e+"&clkdiv=btn_dojob_"+d;var k=b.parentNode.parentNode;var l=createAjaxPage(true);b.setAttribute("onclick",'do_ajax("'+l+"\",'"+j+"',1);return false;");Autoplay.fx=function(){clickAction="newcity job";clickContext=k;suspendBank=false;DEBUG("Clicked to perform: "+c+".");try{unsafeWindow.BrazilJobs.preDoJob(b)}catch(a){}clickElement(b)};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}return false}else{var m=getJobRow(c,innerPageElt);b=xpathFirst('.//a[not(contains(.,"Ask"))]',m);if(isJobLocked(b)){return false}if(isJobBoss(m)){isBGPaused=true;Autoplay.clearTimeout();Reload.clearTimeout();if(health<maxHealth)autoHeal()}if(isJobFight(m)){targetElts=$x('.//a[contains(@onclick, "MapController.doFightJob('+d+",'p|\")]",m);numTargets=targetElts.length;DEBUG("Fight job, Number of Fight Targets Found : "+numTargets);if(numTargets){var n=GM_getIntValue("fightLevelMax",100);var o=GM_getIntValue("fightMafiaMax",501);if(GM_getValue("fightLevelMaxRelative",false))n=n+level;if(GM_getValue("fightMafiaMaxRelative",false))o=o+mafia;DEBUG("Fight job, Only performing if Level <= "+n+" and mafia <= "+o);var p,q,r;StamReqElt=xpathFirst('.//dd[@class="stamina"]',m);if(StamReqElt){StamReq=parseInt(StamReqElt.innerHTML.untag());DEBUG(" job Requires Stamina:"+StamReq+":");if(StamReq>stamina){DEBUG(" job stamina required :"+StamReq+": have :"+stamina+": not enough stamina, leave for now");return false}else DEBUG(" job stamina required :"+StamReq+": have :"+stamina+": have enough stamina do job")}else DEBUG(" job  Current Stamina: "+stamina+". Skipping - StamReq NOT FOUND");var s=o;var t=n;var u=false;for(i=0;i<numTargets;i++){targetParent=targetElts[i].parentNode.parentNode;parentNoTags=targetParent.innerHTML.untag();if(parentNoTags.match(/(.+?)\s+(.+?)\s+(.+?)\s+Fight/i)){p=RegExp.$1;q=parseInt(RegExp.$2);r=parseInt(RegExp.$3)}else{OppNameElt=xpathFirst('.//dt[@class="name"]//span[@class="player_data"]',targetParent);if(OppNameElt)p=OppNameElt.innerHTML.untag();OppSizeElt=xpathFirst('.//dd[@class="group_size"]//span[@class="player_data"]',targetParent);if(OppSizeElt)q=parseInt(OppSizeElt.innerHTML.untag());OppLevelElt=xpathFirst('.//dd[@class="level"]//span[@class="player_data"]',targetParent);if(OppLevelElt)r=parseInt(OppLevelElt.innerHTML.untag())}if(q!=0&&r!=0&&(q<s||q==s&&r<t)){OppTarget=targetElts[i];OppTargetParent=targetParent;s=q;t=r;u=true;DEBUG("Fight job, Using Target : "+p+" - Size : "+q+" - Level : "+r)}else{DEBUG("Fight job, Skipping Target  : "+p+" - Size : "+q+" - Level : "+r)}}if(u){DEBUG("Fight job, Going to fight : "+OppTargetParent.innerHTML.untag());b=OppTarget}else{addToLog("warning Icon","Opponents did not qualify ... Reloading to find new opponents.");b=undefined;goJobsNav();return false}}}}if(b){clickAction="job";clickContext=[d,c];suspendBank=false;clickElement(b);DEBUG(" job Clicked to perform: "+c);return true}else{DEBUG(" UNABLE to perform: "+c);return false}}catch(v){DEBUG("goJob Error: "+v)}}function goFightNav(){var a=xpathFirst('.//div[@id="nav_link_fight_unlock"]//a',menubarElt);if(!a){var b=$x('//div[@class="nav_link fight_link"]//a');for(var c=0,d=b.length;c<d;++c){if(b[c].scrollWidth){a=b[c];break}}if(!a){addToLog("warning Icon","Can't find fight nav link to click.");return}}clickElement(a);DEBUG("Clicked to go to fights.")}function goFightTab(){var a=xpathFirst('.//div[@class="tab_content"]//a[contains(., "Fight")]',innerPageElt);if(!a){goFightNav();return}clickElement(a);DEBUG("Clicked to go to fight tab.")}function goFightersTab(){var a=xpathFirst('.//div[@class="minitab_content"]//a[contains(., "Fighters")]',innerPageElt);if(!a){goFightNav();return}clickElement(a);DEBUG("Clicked to go to fighters tab.")}function goRivalsTab(){var a=xpathFirst('.//div[@class="minitab_content"]//a[contains(., "Rivals")]',innerPageElt);if(!a){goFightNav();return}clickElement(a);DEBUG("Clicked to go to rivals tab.")}function goHitlistTab(){var a=xpathFirst('.//div[@class="tab_content"]//a[contains(., "Hitlist")]',innerPageElt);if(!a){goFightNav();return}clickElement(a);DEBUG("Clicked to go to hitlist.")}function goPropertyNav(){if(new_header){var a=xpathFirst('//a[@class="header_properties_button"]')}else{var a=xpathFirst('.//span[@id="nav_link_properties"]//a',menubarElt)}if(!a){addToLog("warning Icon","Can't find properties nav link to click.");return}clickElement(a);DEBUG("Clicked to go to properties.")}function goDeleteNews(){var a=xpathFirst('.//a[contains(@onclick,"xw_action=deletenews") and contains(text(),"Clear")]',innerPageElt);if(!a){DEBUG("Can't find Clear Updates link to click. ");return}clickElement(a);GM_setValue("logPlayerUpdatesCount",0);DEBUG("Clicked to delete news.")}function goLocation(a){if(a==city){DEBUG("Already in "+cities[a][CITY_NAME]+".");return true}if(level<cities[a][CITY_LEVEL]){addToLog("warning Icon","WARNING: Current level does not allow travel to "+cities[a][CITY_NAME]+". ");DEBUG("Staying in "+cities[city][CITY_NAME]);return false}var b=xpathFirst('//div[@id="travel_menu"]//a[contains(., "'+cities[a][CITY_NAME]+'")]');if(b){clickElement(b);DEBUG("Clicked to travel to "+cities[a][CITY_NAME]+".");return true}DEBUG("Unable to find "+cities[a][CITY_NAME]+" travel link. ");return false}function saveFightStatistics(a,b,c,d){var e=city;var f=parseInt(a);var g=parseCash(d);var h=parseCashLoc(d);if(f){GM_setValue("totalExpInt",String(GM_getIntValue("totalExpInt",0)+f));GM_setValue(cityStats[e][fightExp],String(GM_getIntValue(cityStats[e][fightExp],0)+f))}if(b>0){GM_setValue("fightWinCountInt",String(GM_getIntValue("fightWinCountInt",0)+b));GM_setValue("totalWinDollarsInt",String(GM_getIntValue("totalWinDollarsInt",0)+g));GM_setValue(cityStats[e][fightWins],String(GM_getIntValue(cityStats[e][fightWins],0)+f));GM_setValue(cityStats[h][cashWins],String(GM_getIntValue(cityStats[h][cashWins],0)+g))}if(c>0){GM_setValue("fightLossCountInt",String(GM_getIntValue("fightLossCountInt",0)+c));GM_setValue(cityStats[e][fightLosses],String(GM_getIntValue(cityStats[e][fightLosses],0)+c))}if(b==0){GM_setValue("totalLossDollarsInt",String(GM_getIntValue("totalLossDollarsInt",0)+g));GM_setValue(cityStats[h][cashLosses],String(GM_getIntValue(cityStats[h][cashLosses],0)+g))}}function logFightOutcome(context,respJSON){try{var cityMultiplier=isNewCity(city)?5:1;var cashGainTxt="0";var xpGainTxt="0";var targetIced,targetKilled,iceStolen,iceScored,icedSelf;var stealerID="";var stealerLevel="";var stealerName="";var stealerLevelTxt="";var stealerClanElt="";var stealerNameElt="";var stealerInMafia=false;var stealerAttack="";var revengeButton="";var bragCounter=0;var bragTarget=0;var bragCountEltTxt="";var iceFeed="";var mwFeed="";var user=context.linkedName;var userID=context.id;var userLevel=context.level;if(context.title)user=context.title+" "+user;var result="RX6 fought "+user+", a level "+userLevel;if(context.charClass)result+=" "+context.charClass;var fightsWon=0;var fightsLost=0;if(respJSON){if(typeof respJSON.fight_result!==undefined)fightResult=respJSON.fight_result;var fightOutcome=fightResult.isWin?1:0;fightOutcome?fightsWon=1:fightsLost=1;if(fightResult.is_power_attack){winCount=parseInt(fightResult.power_attack.won);lossCount=parseInt(fightResult.power_attack.lost);fightsWon=winCount*cityMultiplier;fightsLost=lossCount*cityMultiplier}var cashCity=parseInt(fightResult.cash_city)-1;if(fightResult.cash){cashGainTxt=String(fightResult.cash).digitize();cashGainTxt=cities[cashCity][CITY_CASH_SYMBOL]+makeCommaValue(cashGainTxt)}else cashGainTxt=cities[cashCity][CITY_CASH_SYMBOL]+makeCommaValue(0);if(fightResult.experience)xpGainTxt=fightResult.experience;if(fightResult.defender.is_iced)targetIced=true;if(fightResult.defender.is_killed)targetKilled=true;if(fightResult.defender.you_iced||fightResult.you_just_iced||fightResult.you_just_killed){if(isGMChecked("TestChanges"))GM_setValue("iceScored",JSON.stringify(fightResult));iceScored=true;bragCounter=parseInt(fightResult.total_ice_count);bragCount=parseInt(fightResult.ices_so_far);bragTarget=parseInt(fightResult.ices_target);bragCountEltTxt=bragCounter;if(bragCount&&bragTarget)bragCountEltTxt+=" ("+bragCount+" of "+bragTarget+")";if(fightResult.feed_js&&fightResult.feed_js.indexOf("description:'")!=-1){iceFeed=fightResult.feed_js;mwFeed=eval("("+/var feed = (.+?); MW\.Feed/.exec(iceFeed)[1]+")");myFeeds=JSON.parse(GM_getValue("myFeeds",JSON.stringify([])));if(myFeeds.length>50)var delFeed=myFeeds.shift();myFeeds.push(mwFeed.description.split(". Need")[0].split(". Think")[0]);GM_setValue("myFeeds",JSON.stringify(myFeeds))}}if(fightResult.ice_was_just_stolen){if(isGMChecked("TestChanges"))GM_setValue("iceStolen",JSON.stringify(fightResult));iceStolen=true;stealerID=fightResult.thief_id.digitize();stealerInMafia=fightResult.thief_isInMafia;stealerName=fightResult.thief_name;stealerLevelTxt=", a "+fightResult.thief_class;if(stealerLevelTxt.match(/(\d+)/))stealerLevel=RegExp.$1;stealerLevel=isNaN(stealerLevel)?9999:parseInt(stealerLevel);stealerAttack=fightResult.thief_btn}if(fightResult.defender.iced_self){icedSelf=true}}else{var fight_wrapper=xpathFirst('.//div[@id="fight_wrapper"]',innerPageElt);var fightResults=xpathFirst('.//div[@id="wrapper_items_won"]',fight_wrapper);var v2Won=xpathFirst('.//div[@id="attacker_fight_status" and contains(@class,"good") and contains(text(),"Won")]',fight_wrapper);var v2Lost=xpathFirst('.//div[@id="attacker_fight_status" and contains(@class,"bad")  and (contains(text(),"LOST") or contains(text(),"Lost"))]',fight_wrapper);var fightOutcome=0;fightResultElt=xpathFirst('.//img[contains(@src,"youwin")]',fightResults);if(v2Won||fightResultElt)fightOutcome=1;var winCount=fightOutcome>0?1:0;var lossCount=fightOutcome==0?1:0;var wonFights=xpathFirst('.//span[@class="good" and contains(text(),"Win")]',fightResults);if(wonFights){wonFightsTxt=wonFights.innerHTML.untag();if(wonFightsTxt.match(/(\d+)/))winCount=parseInt(RegExp.$1)}var lostFights=xpathFirst('.//span[@class="bad" and contains(text(),"Loss")]',fightResults);if(lostFights){lostFightsTxt=lostFights.innerHTML.untag();if(lostFightsTxt.match(/(\d+)/))lossCount=parseInt(RegExp.$1)}fightsWon=winCount*cityMultiplier;fightsLost=lossCount*cityMultiplier;var cashGainElt=xpathFirst('.//td[contains(@class,"cash_icon")]',fightResults);if(cashGainElt){cashGainTxt=cashGainElt.innerHTML.untag();cashGainTxt=cashGainTxt.match(REGEX_CASH)?RegExp.lastMatch:cashGainTxt}var xpGainElt=xpathFirst('.//td[@class="experience"]',fightResults);if(xpGainElt)xpGainTxt=xpGainElt.innerHTML.untag();var defenderStatElt=xpathFirst('.//div[contains(@id,"fv2_defender") and contains(@style,"block")]',fight_wrapper);if(defenderStatElt){defenderStatEltId=defenderStatElt.id;switch(defenderStatEltId){case"fv2_defender_overlay_stolen":iceStolen=true;break;case"fv2_defender_overlay_iced":iceScored=true;targetIced=true;break;case"fv2_defender_overlay_killed":iceScored=true;targetKilled=true;break;case"fv2_defender_iced_self":icedSelf=true;targetIce=true;break;case"fv2_defender_was_iced":targetIced=true;break}if(iceScored){playerLevel=parseInt(document.getElementById("user_level").innerHTML.untag());var userDetails=document.getElementById("wrapper_attacker");if(userDetails){var userInner=userDetails.innerHTML;userInner=userInner.replace(/<[^>]*>/g,"");userInner=userInner.untag();playerName=/(won|lost)*\s*?(.+)\s*?level/i.exec(userInner)[2];GM_setValue("playerName",playerName);GM_setValue("playerLevel",playerLevel)}var bragCountElt=xpathFirst('.//div[@class="fv2_defender_overlay_next_count"]',defenderStatElt);if(bragCountElt){bragCountEltTxt=bragCountElt.innerHTML;if(bragCountEltTxt.match(/(\d+)\//))bragCounter=parseInt(RegExp.$1)}}}}if(winCount){result+='. You <span class="good">WON</span> ';winCount==1?result+=" the fight":result+=winCount+" fights"}if(lossCount){result+='. You <span class="bad">LOST</span> ';lossCount==1?result+="the fight":result+=lossCount+" fights"}if(fightOutcome){result+=' and gained <span class="good">'+xpGainTxt+" experience</span> and "+'<span class="good">'+cashGainTxt+"</span>.";addToLog("yeah Icon",result)}else{if(cashGainTxt!="0"){result+=', losing <span class="bad">'+cashGainTxt+'</span>. You still gained <span class="good">'+xpGainTxt+" experience</span>."}else{if(xpGainTxt!=0){result+='. You still gained <span class="good">'+xpGainTxt+" experience</span>."}else{result+="."}}if(isGMChecked("fightRemoveStronger"))result+="<br>Too strong: Avoiding!";addToLog("omg Icon",result)}result="";if(!isGMChecked("noStats")){var experience=0;if(!isNaN(xpGainTxt))experience=parseInt(xpGainTxt);saveFightStatistics(experience,fightsWon,fightsLost,cashGainTxt);updateLogStats()}if(icedSelf){addToLog("iced Icon","Apparently "+user+' <span style="color:#00FFFF;">ICED</span> himself ...')}else if(iceScored){var iceScoredIcon="";if(targetKilled){logEvent(xw_user,context.id.replace("p|",""),2,GM_getValue("playerName","Unknown"),GM_getValue("playerLevel","0"));result=' RX6 <span class="bad">KILLED</span> '+user;iceScoredIcon="killedMobster Icon";GM_setValue("myKills",GM_getIntValue("myKills",0)+1)}else if(targetIced){logEvent(xw_user,context.id.replace("p|",""),1,GM_getValue("playerName","Unknown"),GM_getValue("playerLevel","0"));result=' RX6 <span style="color:#00FFFF;">ICED</span> '+user;iceScoredIcon="iced Icon";GM_setValue("myIces",GM_getIntValue("myIces",0)+1)}updateMDK();if(bragCountEltTxt){result+=', bringing your current iceCount to <span style="color:#00FFFF;">'+bragCountEltTxt+"</span>.";if(bragCounter){var publishFrequency=GM_getIntValue("autoIcePublishFrequency")?GM_getIntValue("autoIcePublishFrequency"):1;var logFrequency=parseInt(bragCounter%publishFrequency);if(logFrequency==0&&isGMChecked("autoIcePublish")){if(mwFeed){unsafeWindow.MW.Feed(mwFeed)}else if(defenderStatElt){var bragElt=xpathFirst('.//div[@class="fv2_defender_overlay_brag_action" and not(contains(@style,"opacity: 0.5;"))]',defenderStatElt);if(bragElt&&isGMChecked("autoGlobalPublishing")){var bragLink=xpathFirst('.//a[@class="sexy_button_new medium white sexy_announce_gray"]',bragElt);if(bragLink){clickElement(bragLink);result+=" (Icing published: "+publishFrequency+" / "+publishFrequency+")"}}}}else{result+=" (Icing not published: "+logFrequency+" / "+publishFrequency+")"}}}else{result+="."}addToLog(iceScoredIcon,result)}else if(iceStolen){if(!stealerID){defenderStatElt=xpathFirst('.//div[@id="fv2_defender_overlay_stolen" and contains(@style,"block")]',fight_wrapper);if(defenderStatElt){stealerClanElt=xpathFirst('.//a[contains(@href,"xw_controller=clan")]',defenderStatElt);stealerNameElt=xpathFirst('.//a[contains(@href,"xw_controller=stats")]',defenderStatElt);if(stealerClanElt)stealerName=linkToString(stealerClanElt,"user")+" ";if(stealerNameElt){stealerName+=linkToString(stealerNameElt,"user");var onClickText;if(stealerNameElt.hasAttribute("href"))onClickText=stealerNameElt.getAttribute("href");if(onClickText.match(/(user|opponent_id)\=(.+)/)){stealerID=decodeID(RegExp.$2)}}var stealerLevelElt=xpathFirst('.//div[@class="fv2_defender_overlay_level"]',defenderStatElt);if(!stealerLevelElt)stealerLevelElt=xpathFirst('.//div[contains(text(),"Level")]',defenderStatElt);if(stealerLevelElt){stealerLevelTxt=", a "+stealerLevelElt.innerHTML.untag();if(stealerLevelTxt.match(/(\d+)/))stealerLevel=RegExp.$1;stealerLevel=isNaN(stealerLevel)?9999:parseInt(stealerLevel)}}}if(stealerName){addToLog("iceStolen Icon",'Your ICE was stolen by <span class="user">'+stealerName+"</span>"+stealerLevelTxt+".");if(isGMChecked("fightIceStealers")){if(!stealerInMafia){var opponentLevelMax=GM_getIntValue("fightLevelMax",100);if(GM_getValue("fightLevelMaxRelative",false))opponentLevelMax=opponentLevelMax+level;if(stealerLevel<=opponentLevelMax){if(isGMChecked("fightNames")&&isGMChecked("fightAvoidNames")&&isFamily(decodeHTMLEntities(stealerName),STAMINA_HOW_FIGHT_RANDOM)){addToLog("process Icon","Skipping the Revenge on "+stealerName+stealerLevelTxt+" for stealing your Ice ... avoidNames checked")}else{opponent=new Player;opponent.profile=stealerNameElt;opponent.familyElt=stealerClanElt;opponent.nameElt=stealerNameElt;opponent.id=stealerID;opponent.level=stealerLevel;opponent.name=stealerName;opponent.linkedName=stealerName;opponent.mafia="501";opponent.fightsDone=0;opponent.level=stealerLevel;opponent.name=stealerName;opponent.linkedName=stealerName;autoFight.revengeTarget=opponent;revengeButton=xpathFirst('.//div[@id="fv2_defender_overlay_stolen_btn"]//a');if(revengeButton){colorDEBUG("attacking stealer from revengeButton",cli);GM_setValue("revengebutton",revengeButton.getAttribute("href"));Autoplay.fx=function(){if(isNewCity(city))clickAction="multifight";else clickAction="fight";clickContext=autoFight.revengeTarget;colorDEBUG("Clicking to take Revenge on "+stealerName+stealerLevelTxt+" for stealing your Ice ...",cye);clickElement(revengeButton);addToLog("process Icon","Clicked to take Revenge on "+stealerName+stealerLevelTxt+" for stealing your Ice ...")};Autoplay.delay=noDelay;Autoplay.start();return false}}}else addToLog("process Icon","Skipping the Revenge on "+stealerName+stealerLevelTxt+" for stealing your Ice ... deemed to strong (max. level: "+opponentLevelMax+")")}else addToLog("omg Icon","Skipping the Revenge on "+stealerName+stealerLevelTxt+" for stealing your Ice ... part of your mafia")}else colorDEBUG("fightIceStealers unchecked or in family battle - no revenge")}else colorDEBUG("Revenge Overlay Ice Stolen not Found !",cre)}else if(context.iced)addToLog("info Icon",user+' was already <span style="color:#00FFFF;">ICED</span>. Getting next target ...');setNextFightCity()}catch(fightErr){colorDEBUG("fightErr:"+fightErr)}}function logLootDrops(a,b){if(b=="loot"){var c=0;for(x in a){r=document.createElement("div");r.innerHTML=a[x];var d=$x('.//div[@class="item_card_mini fake_item_card"]',r);if(d&&d.length>0){for(i=0,iLength=d.length;i<iLength;i++){var e=d[i].innerHTML.untag();c+=parseInt(e.digitize())}}}if(c)addToLog("vc Icon",'You gained <span class="good">'+c+" </span> Victory Coin(s)")}if(b=="social"){var f="";var g="";for(x in a){r=document.createElement("div");r.innerHTML=a[x];var h=$x('.//div[@id="fake_item_card_title"]',r);if(h&&h.length>0){for(i=0,iLength=h.length;i<iLength;i++){if(f)f+=", ";f+=h[i].innerHTML.untag()}}var h=$x('.//div[contains(@class,"item_with_preview")]/div',r);if(h&&h.length>0){for(i=0,iLength=h.length;i<iLength;i++){g+='<div class="lootImg">'+h[i].innerHTML+"</div>"}}}if(f)addToLog("lootbag Icon",f);if(g)addToLog("lootbag Icon",g)}if(b=="stats"){var j="";curAttack=parseInt(a.skill_atk.replace(",",""));curDefense=parseInt(a.skill_def.replace(",",""));curAttackEquip=parseInt(a.group_atk.replace(",",""));curDefenseEquip=parseInt(a.group_def.replace(",",""));var k=curAttackEquip-prevAttackEquip;var l=curDefenseEquip-prevDefenseEquip;if(k)j+='Equipment Attack Strength: <span class="loot">'+curAttackEquip+'</span> : <span class="good">+'+k+"</span> (was: "+prevAttackEquip+")<br>";if(l)j+='Equipment Defense Strength: <span class="loot">'+curDefenseEquip+'</span> : <span class="good">+'+l+"</span> (was: "+prevDefenseEquip+")<br>";prevAttackEquip=curAttackEquip;prevDefenseEquip=curDefenseEquip;GM_setValue("curAttackEquip",curAttackEquip);GM_setValue("curDefenseEquip",curDefenseEquip);if(j)addToLog("process Icon",j)}if(b=="oldschool"){var m=$x('.//div[@class="fightV2_items_won"]/div[contains(@id,"fv2_gained_loot")]',a);if(m&&m.length>0){var n="";var o="";for(i=0,iLength=m.length;i<iLength;i++){var p=xpathFirst('.//div[@class="item_card_mini fake_item_card"]',m[i]);if(p){if(n)n+=", "+m[i].innerHTML.untag();else n="Loot Found: "+m[i].innerHTML.untag()}else{var q=xpathFirst(".//img",m[i]);if(q){var r=q.parentNode;if(r){if(o)o+='<div class="lootItem">'+r.innerHTML+"</div>";else o='Loot Found:<br><div class="lootItem">'+r.innerHTML+"</div>"}}}}if(n)addToLog("lootbag Icon",n);if(o)addToLog("lootbag Icon",o)}}if(b=="newcity"){for(x in a){r=document.createElement("div")}}if(b=="newcityjob"){var m=$x('.//div[@class="job_additional_results"]/div[@class="loot_item"]');if(m&&m.length>0){var o="";for(i=0,iLength=m.length;i<iLength;i++){var q=xpathFirst(".//img",m[i]);if(q){var r=q.parentNode;if(r){if(o)o+='<div class="lootImg">'+r.innerHTML+"</div>";else o='Loot Found:<br><div class="lootImg">'+r.innerHTML+"</div>"}}}if(o)addToLog("lootbag Icon",o)}}}function logFightResponse(a,b,c,d,e){try{var f=false;var g;var h;if(!b)b=a;var i=false;var j=false;var k=GM_getValue("fightMaxAttacks",0);var l=GM_getValue("fightHealthMax",0);var m=GM_getValue("fightHealthPctMax",0);var n=21;var o;var p=isNewCity(city)?5:1;var q=c;if(isNaN(q.fightsDone)){q.fightsDone=p}else{q.fightsDone+=p}if(isNaN(q.totalCash))q.totalCash=0;if(isNaN(q.targetHealth))q.targetHealth=0;if(isNaN(q.targetEstimatedHealth))q.targetEstimatedHealth=0;if(isNaN(q.targetHealthCnt))q.targetHealthCnt=0;if(isNaN(q.targetHealthPct))q.targetHealthPct=0;if(isNaN(q.targetPrevHealthPct))q.targetPrevHealthPct=0;if(isNaN(q.targetStartHealthPct))q.targetStartHealthPct=0;if(isNaN(q.totaldamage))q.totaldamage=0;if(e){try{var r="";j=true;i=true;if(e.user_fields&&e.fight_result){jsonPageUpdate(e);f=e.fight_result;if(f!==false&&e.fight_result.defender!==undefined){if(e.fight_result.defender.is_iced||e.fight_result.defender.is_killed){q.iced=true;j=false}if(!f.isWin&&isGMChecked("fightRemoveStronger")){j=false;q.toStrong=true;DEBUG("SKIPPING the attack on "+q.name+" : LOST",cre)}q.damage=parseInt(e.fight_result.defender.damage_dealt);q.totaldamage+=q.damage;if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){q.targetHealthPct=parseInt(e.fight_result.defender.current_health_pct);if(!q.targetStartHealthPct)q.targetStartHealthPct=q.targetHealthPct;if(m&&q.targetHealthPct>m){j=false;colorDEBUG("SKIPPING the attack on "+q.name+" : lastOpponent.targetHealthPct > fightHealthPctMax - "+q.targetHealthPct+" vs "+m,cre)}if(q.targetHealthPct<q.targetStartHealthPct){var s=parseInt(q.targetStartHealthPct-q.targetHealthPct);if(s)q.targetEstimatedHealth=parseInt(100/s*q.totaldamage);if(l&&q.targetEstimatedHealth>l){if(q.targetHealthCnt>2){j=false;colorDEBUG("SKIPPING the attack on "+q.name+" : lastOpponent.targetEstimatedHealth > fightHealthMax - "+q.targetEstimatedHealth+" vs "+l,cre)}q.targetHealthCnt++}}q.targetPrevHealthPct=q.targetHealthPct}if(f.is_power_attack){var t=xpathFirst('.//div[@id="fv2_widget_wrapper"]',a);if(q.powerAttack)unsafeWindow.FightV2.powerAttack(e,t);else unsafeWindow.FightV2.attack(e,t);fightsWon=parseInt(f.power_attack.won);fightsLost=parseInt(f.power_attack.lost);q.fightsDone=(fightsWon+fightsLost)*p}if(f.cash){var u=parseInt(f.cash_city)-1;if(q.totalCash)q.cashGained=parseInt(f.cash)-q.totalCash;else q.cashGained=parseInt(f.cash);q.totalCash=parseInt(f.cash);o=cities[u][CITY_CASH_SYMBOL]+makeCommaValue(q.cashGained)}else{var u=parseInt(f.cash_city)-1;o=cities[u][CITY_CASH_SYMBOL]+makeCommaValue(0)}if(isGMChecked("staminaLogDetails")){var v=cities[u][CITY_CASH_SYMBOL]+makeCommaValue(q.totalCash);if(f.experience)var w=f.experience;addToLog("info Icon","RX6 attacked "+q.linkedName+"<br>Fights - Won : "+fightsWon+", Lost: "+fightsLost+", Cash: "+v+", Exp: "+w)}if(f.loot[0])logLootDrops(f.loot,"loot");if(f.socialMessageCards[0])logLootDrops(f.socialMessageCards,"social");if(typeof e.fightbar!==undefined)logLootDrops(e.fightbar,"stats")}else colorDEBUG("logFightResponse fightResult === false || respJSON.fight_result.defender === undefined",cre)}else colorDEBUG("logFightResponse invalid JSON response for fighting",cre)}catch(x){colorDEBUG("jsonErr: "+x,caq)}}else if(b.id=="fv2_widget_wrapper"){var y=xpathFirst('.//span[@id="user_health"]');health=parseInt(y.innerHTML);i=true;j=true;var z=xpathFirst('.//div[@id="fight_wrapper"]',innerPageElt);if(!z)z=b;var A=xpathFirst('.//div[@id="fv2_defender_was_iced" and contains(@style,"block")]',z);var B=xpathFirst('.//div[@id="fv2_defender_you_iced" and contains(@style,"block")]',z);g=xpathFirst('.//div[@id="attacker_fight_status" and contains(@class,"good") and contains(text(),"Won")]',z);h=xpathFirst('.//div[@id="attacker_fight_status" and contains(@class,"bad")  and (contains(text(),"LOST") or contains(text(),"Lost"))]',z);if(g||h){logLootDrops(b,"oldschool");if(h&&isGMChecked("fightRemoveStronger")){j=false;q.toStrong=true;DEBUG("SKIPPING the attack on "+q.name+" : LOST",cre)}if(A||B){j=false;q.iced=true;if(B)colorDEBUG("SKIPPING the attack on "+q.name+" : fv2_defender_you_iced",caq);else colorDEBUG("SKIPPING the attack on "+q.name+" : fv2_defender_was_iced",cre)}var C=xpathFirst('.//td[contains(@class,"cash_icon")]',b);if(C){o=C.innerHTML.untag();o=o.match(REGEX_CASH)?RegExp.lastMatch:o;q.totalCash+=parseCash(o)}if(isGMChecked("staminaLogDetails")){if(g)fightTxt='<span class="good">Fight WON</span>';else fightTxt='<span class="bad">Fight LOST</span>';addToLog("process Icon","Target - "+q.linkedName+": "+fightTxt)}}else{colorDEBUG("logFightResponse no v2Won / v2Lost element",cre);j=false;i=true}}else{if(b.hasAttribute("class")){if(b.getAttribute("class")=="fight_results"){j=false;i=false}}}autoHeal(1);if(j&&(!canSpendStamina()||ptsToNextLevel<=6)){j=false;colorDEBUG("SKIPPING the attack on "+q.name+" : !canSpendStamina() || ptsToNextLevel <= 6",cre)}if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){if(j&&k&&q.fightsDone>k){j=false;colorDEBUG("SKIPPING the attack on "+q.name+" : "+q.fightsDone+" > "+GM_getValue("fightMaxAttacks",0),cre)}}if(j){if(q.iced||q.toStrong&&isGMChecked("fightRemoveStronger"))j==false;else{var D=getStaminaMode();if(D==STAMINA_HOW_FIGHT_LIST){j=GM_getValue("reattackThresholdList")==0||parseCash(o)>=GM_getValue("reattackThresholdList")&&o.indexOf(cities[city][CITY_CASH_SYMBOL])!=-1}else{j=GM_getValue("reattackThreshold")==0||parseCash(o)>=GM_getValue("reattackThreshold")&&o.indexOf(cities[city][CITY_CASH_SYMBOL])!=-1}if(!j)colorDEBUG("SKIPPING the attack on "+q.name+" INVALID cashGainTxt: "+o,cre)}}if(j!==false){var E;var F=p*5;if(isGMChecked("staminaPowerattack")&&stamina>=F){E=xpathFirst('.//div[@class="fv2_btncontainer"]//div[@id="fv2_button_row2"]/div[contains(@style,"block")]',b);q.powerAttack=true;unsafeWindow.FightV2.prePowerAttack()}else{E=xpathFirst('.//div[@class="fv2_btncontainer"]//div[@id="fv2_button_row1"]/div[contains(@style,"block")]',b);unsafeWindow.FightV2.preAttack();q.powerAttack=false}if(E){fightv2_atkbtn=xpathFirst('.//a[contains(@class,"fightV2AttackBtn")]',E);if(!fightv2_atkbtn)fightv2_atkbtn=xpathFirst('.//a[contains(@class,"fightV2PowerAtkBtn")]',E);if(!fightv2_atkbtn)colorDEBUG("SKIPPING the attack on "+q.name+" : fightv2_atkbtn NOT FOUND.",cre);else{var G=fightv2_atkbtn.getAttribute("href");G=G.replace(/click_amt=\d+/,staminaSpendStrength);var H=createAjaxPage(true);fightv2_atkbtn.setAttribute("onclick",'do_ajax("'+H+"\",'"+G+"',1);return false;");autoReload(false,"fight box attacking");q.attackAgain=fightv2_atkbtn;Autoplay.fx=function(){if(isNewCity(city)||fightv2_atkbtn.innerHTML.match(/\d/i))clickAction="multifight";else clickAction="fight";clickContext=q;clickElement(fightv2_atkbtn);colorDEBUG("autoFight - Clicked to REPEAT the "+fightv2_atkbtn.innerHTML+" attack on "+q.name+".",cye)};Autoplay.delay=noDelay;Autoplay.start();return true}}else colorDEBUG("SKIPPING the attack on "+q.name+" : fv2_btn_div / row INVALID / NOT FOUND.",cre)}else{q.skip=true}if(i){if(q.toStrong)setFightOpponentAvoid(q);if(!e&&h&&!q.iced&&q.id.indexOf("p|")!=-1){var I=q.id.digitize();getHelp(I,q.name,q.level);colorDEBUG("Fight Response : liveTarget detected and LiveLinks feed entry sent")}try{if(f||g||h)logFightOutcome(q,e);if(!autoFight.revengeTarget){var J=xpathFirst('.//a[@class="close" and contains(@onclick,"CloseJS")]',z);if(J){clickElement(J);var K=xpathFirst('.//div[@id="fv2_widget_wrapper" and contains(@style,"none")]',innerPageElt);if(K)destroyByID("fv2_widget_wrapper")}}if(isGMChecked("autoGlobalPublishing")&&!timeLeftGM("askFightBoostsTimer")){var L=xpathFirst('.//div[@class="fv2_boost_ask_allowed" and not(contains(@style,"none"))]',z);if(L){var M=xpathFirst('.//div[@class="fv2_boost_ask_action"]//a',z);if(M){clickElement(M);setGMTime("askFightBoostsTimer","01:00:05")}}}if(GM_getValue("staminaSpendHow")==getStaminaMode())cycleSavedList("pfightlist");randomizeStamina();Autoplay.delay=getAutoPlayDelay();return false}catch(N){}}else{if(q.fightsDone)logFightOutcome(q,e);if(GM_getValue("staminaSpendHow")==getStaminaMode())cycleSavedList("pfightlist");randomizeStamina();Autoplay.delay=getAutoPlayDelay();return false}var O=b.innerHTML;var P=O.untag();if(P.match(/you won/i)){var Q=xpathFirst('.//div[@class="fightres_stats"]',b);if(Q){var R=xpathFirst('.//div[@class="sexy_cash good"]',Q);var S=xpathFirst('.//div[@class="fightres_experience good"]',Q);var T=xpathFirst('.//div[@class="fightres_damage"]',Q);addToLog("yeah Icon","You"+T.innerHTML+', gaining <span class="good">'+R.innerHTML+'</span> and <span class="good">'+S.innerHTML+"</span>")}}else if(P.match(/you cannot fight|part of your mafia/i)){if(c.id){DEBUG("Opponent ("+c.id+") is part of your mafia. Avoiding.");setFightOpponentAvoid(c)}}else if(P.match(/You just set/)){cycleSavedList("pautoHitOpponentList");addToLog("yeah Icon",O);if(isGMChecked("bgAutoHitCheck"))setGMTime("bgAutoHitTime","01:00");var U=xpathFirst('//a[@id="fb_dialog_cancel_button"]');if(U){Autoplay.fx=function(){clickElement(U);DEBUG("Clicked Dismissed Popup!")};Autoplay.start();return true}}else if(P.match(/There is already a bounty/)||P.match(/You can\'t add/)){cycleSavedList("pautoHitOpponentList");if(isGMChecked("bgAutoHitCheck"))setGMTime("bgAutoHitTime","01:00")}else if(P.indexOf("too weak")!=-1){addToLog("info Icon",'<span style="color:#FF9999;">'+"Too weak to fight."+"</span>")}else DEBUG("Unrecognized fight response:"+P);randomizeStamina();if(GM_getValue("staminaSpendHow")==getStaminaMode())cycleSavedList("pfightlist")}catch(V){colorDEBUG("respError: "+V)}return false}function randomizeStamina(){if(isGMEqual("staminaSpendHow",STAMINA_HOW_RANDOM)){var a=GM_getValue("randomSpendModes");var b=Math.floor(Math.random()*STAMINA_HOW_ROBBING);while(a[b]!="1"){b=Math.floor(Math.random()*STAMINA_HOW_ROBBING)}DEBUG("Stamina Spend Mode Randomize set to : "+b+" was "+newStaminaMode);newStaminaMode=b;var c=GM_getValue("randomFightLocations");while(b==STAMINA_HOW_FIGHT_RANDOM||b==STAMINA_HOW_FIGHT_LIST){var d=Math.floor(Math.random()*(cities.length-1));DEBUG("Fight City Randomize set to : "+d+" was "+GM_getValue("fightLocation"));if(c[d]=="1"&&!cities[d][CITY_CLOSED]){GM_setValue("fightLocation",d);DEBUG("Fight location set to : "+cities[d][CITY_NAME]);break}else DEBUG("Fight location did not qualify")}c=GM_getValue("randomRobLocations");while(b==STAMINA_HOW_ROBBING){var d=Math.floor(Math.random()*(cities.length-1));DEBUG("Rob City Randomize set to : "+d+" was "+GM_getValue("robLocation"));if(c[d]=="1"&&!cities[d][CITY_CLOSED]){GM_setValue("robLocation",d);DEBUG("Robbing location set to : "+cities[d][CITY_NAME]);break}else DEBUG("Rob location did not qualify")}c=GM_getValue("randomHitmanLocations");while(b==STAMINA_HOW_HITMAN){var d=Math.floor(Math.random()*(cities.length-1));DEBUG("Hitman City Randomize set to : "+d+" was "+GM_getValue("hitmanLocation"));if(c[d]=="1"&&!cities[d][CITY_CLOSED]){GM_setValue("hitmanLocation",d);DEBUG("Hitman location set to : "+cities[d][CITY_NAME]);break}else DEBUG("Hitman location did not qualify")}}}function createAjaxPage(a,b,c){if(a)ajaxHandling=true;var d=a?SCRIPT.ajaxIDSync:SCRIPT.ajaxIDAsync;var e=document.getElementById(d);if(e){e.removeEventListener("DOMSubtreeModified",handleAjaxModified,false);e.parentNode.removeChild(e)}e=makeElement("div",null,{id:d,style:"display: none;"});if(!a){ajaxAction=b;ajaxContext=c}e.addEventListener("DOMSubtreeModified",handleAjaxModified,false);document.getElementById("verytop").appendChild(e);return d}function handleAjaxModified(a){var b=a.target;b.removeEventListener("DOMSubtreeModified",handleAjaxModified,false);window.setTimeout(function(){ajaxPageChanged(b)},350)}function ajaxPageChanged(a){if(!a)return;var b=a.id==SCRIPT.ajaxIDSync?true:false;var c=a.innerHTML;a.parentNode.removeChild(a);var d,e;if(b){d=clickAction;e=clickContext;clickAction=undefined;clickContext=undefined}else{d=ajaxAction;e=ajaxContext;ajaxAction=undefined;ajaxContext=undefined}ajaxHandling=false;if(!logJSONResponse(b,c,d,e)){try{doAutoPlay()}catch(f){DEBUG("BUG DETECTED (ajaxPageChanged->doAutoPlay): "+f+". Reloading.");autoReload(true,"error !logJSONResponse")}}}function logJSONResponse(a,b,c,d){ajaxHandling=false;if(c=="goHome")return false;colorDEBUG("logJSONResponse ("+c+") default fx: goHome, delay: "+Autoplay.delay,cfu);autoReload(false,"logJSONResponse");var e=b.untag();var f,g;var h,i;try{if(IsJsonString(e)){try{h=JSON.parse(e);if(h.data)if(IsJsonString(h.data))i=JSON.parse(h.data);jsonPageUpdate(h)}catch(j){DEBUG("Invalid JSON response.");colorDEBUG("Invalid JSON response<br>"+e)}}if(c=="collect take"||c=="quick deposit"||c=="quick withdraw"){if(!isNaN(d)){d=parseInt(d);cashElt=document.getElementById("user_cash_"+cities[d][CITY_ALIAS])}if(c=="quick deposit"&&d!=LV)f=isNaN(h.user_cash)?null:parseInt(h.user_cash);else{f=isNaN(i.cash)?null:parseInt(i.cash);if(c!="collect take"){g=parseInt(i.acct_balance);if(GM_getValue("vaultHandling",0)||c=="check property"){try{colorDEBUG("parsing json response for: "+c);var k=i.properties;if(typeof i.success_message===undefined){colorDEBUG("respProp:"+JSON.stringify(k));var l=parseInt(k[5].level);var m=vaultLevels[l][1];var n=m-g;if(c=="check property"&&(l!=GM_getValue("vaultHandling",0)||n!=GM_getValue("vaultSpace",0)))addToLog(cities[LV][CITY_CASH_CSS],"Parsed new vault status: Level "+l+", free vault space: V$"+makeCommaValue(n));else if(c=="check property")addToLog(cities[LV][CITY_CASH_CSS],"No change in your vault: Level "+l+", free vault space: V$"+makeCommaValue(n));GM_setValue("vaultHandling",l);GM_setValue("vaultSpace",String(n))}else{addToLog(cities[LV][CITY_CASH_CSS],"Check vault status : "+i.success_message)}}catch(o){colorDEBUG("vaultErr: "+o)}}}}if(f!=null){if(cashElt)cashElt.innerHTML=cities[d][CITY_CASH_SYMBOL]+makeCommaValue(f);cities[d][CITY_CASH]=f}}switch(c){case"ask parts":DEBUG("logJSONResponse for ask parts");return false;break;case"autoStatAllocation":DEBUG("autoStatAllocation results "+e);return false;break;case"load battlepage":return false;break;case"collect slotbonus":slotBonus=0;addToLog("info Icon","Slot Bonus Collect Result: "+i.json_data.dialog_message+" itemName:  "+i.json_data.itemName);break;case"collect slot":slotSpins=i.json_data.freeSpins;slotBonus=i.json_data.bonusMeter;var p="";if(i.json_data.isJackpot){p+="You won on the slots! Payout: "+i.json_data.payout+"  jackpotWinAmt: "+i.json_data.jackpotWinAmt}else{p+="You did not win on this slot pull.  Remaining Spins: "+slotSpins}addToLog("info Icon",p);DEBUG("Result: "+i.json_data.result+" bonusMeter:"+i.json_data.bonusMeter+" payout:"+i.json_data.payout+" isJackpot:"+i.json_data.isJackpot+" jackpotWinAmt:"+i.json_data.jackpotWinAmt+" freeSpins"+i.json_data.freeSpins);break;case"autoStatReward":DEBUG("autoStatReward results "+e);return false;break;case"autoUpgradeNY_getBalance":var q=h.user_fields.user_bank_balance+"";GM_setValue("userBankBalance",q);addToLog("updateGood Icon","Current NY Bank Balance: $"+q);return false;break;case"autoUpgradeNY":var r=JSON.stringify(i);var s="";var q=h.user_fields.user_bank_balance+"";GM_setValue("userBankBalance",q);if(r.indexOf("description")!=-1){s=i.description;if(s.indexOf("You have purchased")!=-1){var t=GM_getIntValue(d,999);t++;GM_setValue(d,t);addToLog("updateGood Icon",s+". Current Level: "+t+'. Current NY Bank Balance: <span class="good">$'+makeCommaValue(q)+"</span>.")}}else{addToLog("updateBad Icon",s+'. Current NY Bank Balance: <span class="good">$'+makeCommaValue(q)+"</span>.");GM_setValue(d,999)}goPropertyNav();return false;break;case"icecheck profile":var u=!/is already dead or too weak!/.test(e);if(d){d.setAttribute("style","background: "+(u?"green;":"red;"));d.setAttribute("title",(u?"Target is alive":"Target is iced")+", click to refresh.");d.addEventListener("click",customizeProfile,false);DEBUG("Successfully set target status: "+(u?"alive.":"iced."))}return false;break;case"fight":var v=xpathFirst('.//div[@id="fv2_widget_wrapper"]',innerPageElt);return logFightResponse(innerPageElt,v,d,0,h);break;case"multifight":var v=xpathFirst('.//div[@id="fv2_widget_wrapper"]',innerPageElt);return logFightResponse(innerPageElt,v,d,1,h);break;case"keelBandit":Autoplay.fx=goJobsNav;Autoplay.delay=noDelay;Autoplay.start();return true;break;case"newcity job":var w=false;var x;var y;var z;var A;var B;var C;var D;if(!IsJsonString(e)){y=xpathFirst(".//h4",d).innerHTML.untag().trim();z=xpathFirst('.//ul[contains(@class,"pays")]//li[@class="experience"]',d);if(z)z=parseInt(z.getAttribute("base_value"));A=xpathFirst('.//ul[contains(@class,"pays")]//li[contains(@class,"cash_icon_jobs")]',d);if(A)parseInt(A=A.getAttribute("base_value"));B=xpathFirst('.//ul[contains(@class,"uses")]//li[contains(@class,"cash_icon_jobs")]',d);if(B){B=parseInt(B.getAttribute("base_value"));logTxt='RX6 performed <span class="job">'+y+'</span>, earning <span class="good">'+z+' experience</span>. RX6 spent <span class="bad">'+cities[city][CITY_CASH_SYMBOL]+makeCommaValue(B)+"</span>."}else logTxt='RX6 performed <span class="job">'+y+'</span>, earning <span class="good">'+cities[city][CITY_CASH_SYMBOL]+makeCommaValue(A)+'</span> and <span class="good">'+z+" experience</span>.";if(logTxt)addToLog("process Icon",logTxt);var D=getBrazilJobMastery(d);if(D>=100){w=true;D=100}DEBUG("Job "+y+" is "+D+"% mastered.")}else{var E=xpathFirst('.//a[contains(@id, "btn_dojob")]',d);try{unsafeWindow.BrazilJobs.doJob(h,E)}catch(F){}if(isGMChecked("TestChanges"))GM_setValue("jobResult",JSON.stringify(h));try{if(typeof h.jobResult!==undefined){var G=h.jobResult;colorDEBUG(JSON.stringify(G));var x=G.city;x=x-1;var y=G.name;var z=G.experience;var A=makeCommaValue(parseCash(G.cash));var B=makeCommaValue(parseCash(G.cashUsed));var C=G.loot[0];colorDEBUG("Loot:<br>"+JSON.stringify(G.loot));var H=parseInt(G.masteryTotal);var I=parseInt(G.masteryIncrease);var D=H+I;var J=G.mastered;if(D>=100||J){w=true;D=100}if(A&&A!="0"){logTxt='RX6 performed <span class="job">'+y+'</span>, earning <span class="good">'+cities[x][CITY_CASH_SYMBOL]+A+'</span> and <span class="good">'+z+" experience</span>"}else{if(z)logTxt='RX6 performed <span class="job">'+y+'</span>, earning <span class="good">'+z+' experience</span>. RX6 spent <span class="bad">'+cities[x][CITY_CASH_SYMBOL]+B+"</span>";else logTxt='RX6 performed <span class="job">'+y+"</span>"}if(typeof G.itemsUsed!==undefined){itemsUsed=G.itemsUsed;var K=itemsUsed.length;if(K>0){var L="";logTxt+=" and used ";for(R=0;R<K;R++){usedQty=itemsUsed[R].quantity;if(usedQty==1){usedItem=itemsUsed[R].item.quantified_singular_name;logTxt+=L+'<span class="bad">'+usedItem+"</span>"}else{usedItem=itemsUsed[R].item.name;logTxt+=L+'<span class="bad">'+usedQty+" x "+usedItem+"</span>"}L=" and "}}}logTxt=logTxt+".";DEBUG("Job "+y+" ("+H+"%) is now "+D+"% mastered, mastery increased by "+I+"%.");if(logTxt)addToLog("process Icon",logTxt);if(G.loot[0])logLootDrops(G.loot,"newcity");var M=$x('.//div[@class="job_additional_results"]//div[@class="loot_item"]');if(M&&M.length>0){logLootDrops(d,"newcityjob");var N;var O=true;var P=new Array;requirementJob.forEach(function(a){if(a[1].toUpperCase().trim()==y.toUpperCase().trim()){P.push(a[0]);DEBUG("Matching Item: "+a[0]+" from "+a[1])}});var Q=getSavedList("itemList");if(P.lenght==0||typeof Q[0]=="undefined"||Q.length==0||O==false){DEBUG("No relevant loot found or no needed items in required item list.")}else{while(N=P.pop()){DEBUG("Checking to see if "+N+" is needed ...");for(var R=0;R<Q.length;R++){if(N.indexOf(Q[R].trim())!=-1){DEBUG("Check ! "+N+" is the item we are looking for.");removeSavedListItem("itemList",N);removeJobForItem("jobsToDo",N);popJob();return false}else{DEBUG("Oops ! "+N+" is NOT the item we are looking for.")}}}}}}}catch(S){}try{if(typeof h.data.impulseBuy.message!==undefined){var T=h.data.impulseBuy.message;if(T.indexOf("loot drops")!=-1){var U=xpathFirst(".//h4",d);var V=U.innerHTML.trim();DEBUG("Seems RX6 needs (some) items to perform: "+V);var W=d;var X=/p>(.+)\u00D7/i.exec(T)[1];if(X){addToLog("info Icon",'Item(s) required to perform <span class="job">'+V+'</span>: <span class="loot">'+X+"</span>.");var Q=getSavedList("itemList");var Y=getSavedList("jobsToDo","");if(Y.indexOf(V)==-1){Y.push(V);DEBUG("Saving "+V+" for later. Fetching pre-req items first.");setSavedList("jobsToDo",Y)}else{DEBUG(V+" already saved for later. Fetching pre-req items first.")}var O=false;requirementJob.forEach(function(a){if(level>=cities[a[2]][CITY_LEVEL]&&a[0].toUpperCase().trim()==X.toUpperCase().trim()){Y.push(a[1]);Q.push(X.trim());O=true;jobFound=a[1]}});if(!O)DEBUG(X+" not found in the requirement job array.");else{setSavedList("itemList",Q.unique());setSavedList("jobsToDo",Y);popJob();return false}}}if(T.indexOf("following items")!=-1){T=T.wipe();var Z=E.id;if(Z.match(/dojob_(\d+)/i))Z=RegExp.$1;if(T.match(/job:(.+)Cost/))addToLog("warning Icon",'RX6 needs to buy these item(s): <span class="loot">'+RegExp.$1+"</span>.");else addToLog("warning Icon",T);var $=E.getAttribute("href");if($&&Z){var _=/tab=([\d]+)/.exec($)[1];var ab=/tmp=([\da-f]+)/.exec($)[1];var bb=/cb=([\da-f]+)/.exec($)[1];var cb=/xw_person=([\d]+)/.exec($)[1];var db=createAjaxPage(true);var eb=makeElement("a",null,{onclick:'return do_ajax("'+db+'","remote/html_server.php?xw_controller=job&xw_action=buy_required_items&xw_city='+cities[city][CITY_NUMBER]+"&tmp="+ab+"&cb="+bb+"&xw_person="+cb+"&jobId="+Z+"&cityId="+cities[city][CITY_NUMBER]+'&xw_client_id=8", 1, 1, 0, 0); return false;'});if(eb){clickAction="newcity buy";clickContext=city;clickElement(eb);return false}}}}}catch(S){}}if(w&&!isGMChecked("repeatJob"))goJobsNav();return false;break;case"newcity buy":DEBUG("newcity buy results<br>"+e);try{if(typeof h.data.impulseBuy.message!==undefined){var T=h.data.impulseBuy.message;DEBUG("newcity buy jobMessage:"+T);T=T.wipe();if(T.match(/You bought:(.+)/))addToLog("info Icon",'RX6 bought these item(s): <span class="loot">'+RegExp.$1+"</span>.");else addToLog("info Icon",T)}}catch(S){colorDEBUG("Error no MessageResult: "+S,cre)}return false;break;case"check property":switch(d){case LV:GM_setValue("vegasReport",JSON.stringify(i));case BRAZIL:GM_setValue("brazilReport",JSON.stringify(i));case CHICAGO:GM_setValue("chicagoReport",JSON.stringify(i));case LONDON:GM_setValue("londonReport",JSON.stringify(i))}return false;break;case"vegas parts":setGMTime("askVegasPartsTimer","2 hours");DEBUG("Parsed JSONResponse for clicking askVegasParts. Timer Reset for 2 hours.");return false;break;case"play slots":setGMTime("askPlaySlotsTimer","4 hours");DEBUG("Parsed JSONResponse for clicking AskPlaySlots. Timer Reset for 4 hours.");return false;break;case"brazil parts":setGMTime("askBrazilPartsTimer","2 hours");DEBUG("Parsed JSONResponse for clicking AskBrazilParts. Timer Reset for 2 hours.");return false;break;case"chicago parts":setGMTime("askChicagoPartsTimer","2 hours");DEBUG("Parsed JSONResponse for clicking AskChicagoParts. Timer Reset for 2 hours.");return false;break;case"london parts":setGMTime("askLondonPartsTimer","2 hours");DEBUG("Parsed JSONResponse for clicking AskLondonParts. Timer Reset for 2 hours.");return false;break;case"save properties":return false;break;case"build limited":var fb=d.propCount;hb=cityProperties[fb][ctPropName];ib=cityProperties[fb][ctPropTimer];if(e!=""){addToLog("process Icon",hb+": "+e);setGMTime(ib,"24 hours")}else{addToLog("warning Icon",hb+": RX6 can not craft yet.");setGMTime(ib,"1 hour")}return false;break;case"build other":var fb=d.propCount;var gb=cityProperties[fb][ctGMId];var hb=cityProperties[fb][ctPropName];var ib=cityProperties[fb][ctPropTimer];var jb=cityProperties[fb][ctPropCity];var kb=cities[jb][CITY_NAME];DEBUG("Make "+kb+": "+d.itemName+" - "+d.buildType+".");var lb=0;var mb=0;var nb=i.purchase_message;nb=nb.replace(/port/gi,hb);addToLog("lootbag Icon",nb);if(e.match(/cannot be purchased/i)){DEBUG(d.itemName+" can not be build, disabling");GM_setValue(gb,0);return false}if(e.match(/available_purchases(.+?)(\d+?),/i)){lb=parseFloat(RegExp.$2);DEBUG("Available Purchases Left: "+RegExp.$2);if(lb){return false;break}}if(e.match(/purchase_refresh_rate(.+?)(\d+?),/i)){lb=parseFloat(RegExp.$2);DEBUG("Refresh Rate: "+RegExp.$2)}if(e.match(/last_purchase_time_stamp(.+?)(\d+?),/i)){mb=parseFloat(RegExp.$2);DEBUG("timeStamp: "+RegExp.$2)}if(lb&&mb){var ob=mb+lb;var pb=Math.round((new Date).getTime()/1e3);DEBUG("Current: "+pb);if(pb<ob){var qb=parseFloat(ob)-parseFloat(pb)+10;DEBUG("timeLeft: "+qb);var rb=secondsToHMS(qb);rb==1?rb+=" hour":rb+=" hours";setGMTime(ib,rb);DEBUG("Parsed JSONResponse for "+kb+" Item. Timer "+ib+" reset for "+rb+".")}else{setGMTime(ib,"2 hours");DEBUG("Parsed JSONResponse for "+kb+" Item. Timer reset for 2 hours.");colorDEBUG(e)}}else{setGMTime(ib,"2 hours");DEBUG("Parsing JSONResponse for "+kb+" Item FAILED. Timer reset for 2 hours.");colorDEBUG(e)}return false;break;case"collect take":var sb=JSON.stringify(i);var tb="";if(sb.indexOf("description")!=-1)tb=i.description;else tb=i.success_message;if(tb.match(/collected (.+?) from your properties/i)){var ub='RX6 collected <span class="money">'+RegExp.$1+"</span> from your properties.";addToLog(cities[d][CITY_CASH_CSS],ub)}if(tb.match(/you have also received:/i)){var vb=i.success_image_names;if(vb.length>0){ub="You also received : ";collectHelp="";for(R=0,K=vb.length;R<K;R++){ub+=collectHelp+vb[R].untag();if(R==K-1)collectHelp=", ";else collectHelp=" and "}addToLog(cities[d][CITY_CASH_CSS],ub)}}switch(d){case NY:if(sb.indexOf("shopname")!=-1&&sb.indexOf("vehicleamount")!=-1&&sb.indexOf("vehiclename")!=-1){var wb=i.shopname;var xb=i.vehicleamount;var yb=i.vehiclename;if(xb.length>0){ub="RX6 also collected ";collectHelp="";for(R=0,K=xb.length;R<K;R++){ub+=collectHelp+'<span class="property">'+xb[R]+'</span> <span class="loot">'+yb[R]+'</span> items from your <span class="property">'+wb[R]+"</span>";if(R==K-1)collectHelp=", ";else collectHelp=" and "}addToLog(cities[d][CITY_CASH_CSS],ub)}}break}setGMTime("takeHour"+cities[d][CITY_NAME],"1 hour");return false;break;case"quick withdraw":var zb="<br>Remaining Bank Balance: "+cities[d][CITY_CASH_SYMBOL]+makeCommaValue(g);if(/You Withdrew/i.test(i.success_message)){addToLog("cashVegas Icon",i.success_message+zb)}else{addToLog("warning Icon","Disabling autoMission:<br>You don't have enough money to do "+missions[GM_getValue("selectMission",1)][MISSION_NAME]+"."+zb);GM_setValue("autoMission",0);update_nrg_stam()}return false;break;case"quick deposit":if(city!=d){addToLog("warning Icon","Warning! You have traveled from "+cities[d][CITY_NAME]+" to "+cities[city][CITY_NAME]+" while banking. Check your money.")}var Ab="";if(d==LV)Ab=i.success_message;else Ab=h.deposit_message;if(!Ab){addToLog(cities[d][CITY_CASH_CSS],"Quick Deposit failed ...");return false}if(Ab.match(/([0-9,,]+).+?was deposited/i)||Ab.match(/You Deposited .\$([0-9,,]+) into your Vault/i)){quickBankFail=false;var Bb=RegExp.$1;addToLog(cities[d][CITY_CASH_CSS],'<span class="money">'+cities[d][CITY_CASH_SYMBOL]+Bb+"</span> was deposited "+(d==LV?"into your vault.":"in your account after the bank's fee."))}else if(/cannot deposit this much/i.test(Ab)||/cannot deposit that much/i.test(Ab)){quickBankFail=false;var Cb="You can't deposit this much (you don't have enough cash or your vault is to small).";if(!GM_getValue("vaultHandling",0))Cb+="<br>Please consider enabling RX6 MWAP vault handling.";addToLog(cities[d][CITY_CASH_CSS],Cb)}else if(/cannot deposit any more/i.test(Ab)){quickBankFail=false;var Cb="You can't deposit anymore, your vault is full!";if(!GM_getValue("vaultHandling",0))Cb+="<br>Please consider enabling RX6 MWAP vault handling.";addToLog(cities[d][CITY_CASH_CSS],Cb);if(GM_getValue("vaultHandling",0))GM_setValue("vaultSpace","0")}else if(/invalid amount/i.test(Ab)){quickBankFail=false}else if(/have enough money/.test(Ab)){quickBankFail=false}else if(/deposit at least/.test(Ab)&&Ab.match(/([0-9,,]+)/)){quickBankFail=false}else if(i.result==null||g==0){quickBankFail=false;addToLog(cities[d][CITY_CASH_CSS],"Depositing failed without a response; if you are in Las Vegas, perhaps you don't have a vault yet?");if(GM_getValue("vaultHandling",0))GM_setValue("vaultSpace","0")}else{quickBankFail=true;addToLog("warning Icon","Quick Deposit failed: Unknown JSON response:<br>"+e)}return false;break;case"marketplace":var Db=xpathFirst('.//div[@id="responseContainer"]');if(!Db){Db=makeElement("div",document.getElementById("final_wrapper"),{id:"responseContainer",style:"display:none;"})}Db.innerHTML=b;var Eb=makeElement("div",null,{id:"marketInfo",style:"clear:both; width: 745px;","class":"clearfix"});var Fb=makeElement("div",Eb,{id:"FightClubModule",style:"float: left; width: 735px;","class":"empire_module_header"});var Gb=makeElement("div",Fb,{"class":"empire_module_title"});var Hb=makeElement("span",Gb);Hb.appendChild(document.createTextNode("Fight Club"));var Ib=xpathFirst('.//img[contains(@src,"victory_icon.gif")]',Db);if(Ib){vcElt=Ib.parentNode;if(vcElt){var Jb=makeElement("div",Gb,{style:"float:right;margin-right:15px"});Jb.innerHTML+=vcElt.innerHTML}}var Kb=xpathFirst('.//div[@class="fightmastery_meter"]',Db);if(Kb){var Lb=makeElement("div",Gb,{"class":"fightmastery_meter",style:"float:right;margin-right:45px;margin-top:-1px;"});Lb.innerHTML+=Kb.innerHTML}var Mb=xpathFirst('.//div[@id="full_list"]',Db);if(Mb){var Nb=makeElement("div",Fb,{style:"width: 729px; padding: 5px; float: none;","class":"playerupdate_box"});var Ob=makeElement("div",Nb);var Pb=$x('.//div[contains(@style,"relative")]',Mb);if(Pb.length>0){var Qb=0;for(R=Pb.length-1;R>=0;R--){if(Qb>=9&&R>1)continue;secondElt=Pb[R].firstChild.nextSibling;fourthElt=Pb[R].firstChild.nextSibling.nextSibling.nextSibling;if(R>1){itemListElt=makeElement("div",null,{style:"float: left; width: 220px;height:135px;border:1px dotted #484848;padding:10px;"});Ob.appendChild(itemListElt)}else{itemListElt=makeElement("div",null,{style:"float: left; width: 340px;height:125px;border:1px dotted #484848;padding:10px;"});Ob.insertBefore(itemListElt,Ob.firstChild)}itemListElt.innerHTML=secondElt.innerHTML+fourthElt.innerHTML;Qb++}var Rb=makeElement("div",Eb,{style:'float: left; background: url("http://mwfb.static.zgncdn.com/mwfb/graphics/empire/shadow_upper_right.png") no-repeat scroll 0% 0% transparent; height: 8px; width: 8px;'});Rb=makeElement("div",Eb,{style:'float: left; background: url("http://mwfb.static.zgncdn.com/mwfb/graphics/empire/shadow_right_side.png") repeat-y scroll 0% 0% transparent; height: 310px; width: 8px;'});Rb=makeElement("div",Eb,{style:'float: left; background: url("http://mwfb.static.zgncdn.com/mwfb/graphics/empire/shadow_lower_left.png") repeat scroll 0% 0% transparent; height: 8px; width: 8px;'});Rb=makeElement("div",Eb,{style:'float: left; background: url("http://mwfb.static.zgncdn.com/mwfb/graphics/empire/shadow_bottom.png") repeat scroll 0% 0% transparent; height: 8px; width: 727px;'});Rb=makeElement("div",Eb,{style:'float: left; background: url("http://mwfb.static.zgncdn.com/mwfb/graphics/empire/shadow_lower_right.png") repeat scroll 0% 0% transparent; height: 8px; width: 8px;'})}}d.appendChild(Eb);postSize();return false;break;default:colorDEBUG('BUG DETECTED: Unrecognized JSON action "'+c+'".<br>'+e);return false}}catch(S){DEBUG("Exception (logJSONResponse): "+S+", autoplay: "+a+", action: "+c);colorDEBUG("Exception (logJSONResponse): "+S+", autoplay: "+a+", action: "+c+", context: "+d+", response: <br>"+b);return false}}function logResponse(rootElt,action,context){if(action=="goHome")return false;var messagebox;Autoplay.fx=goHome;Autoplay.delay=getAutoPlayDelay();colorDEBUG("logResponse ("+action+") default fx: goHome, delay: "+Autoplay.delay,cfu);if(action=="fight"||action=="multifight"){autoReload(false,"logResponse - fight");var fight_wrapper=xpathFirst('.//div[@id="fv2_widget_wrapper"]',rootElt);if(!fight_wrapper)fight_wrapper=xpathFirst('.//div[@class="fight_results"]',rootElt);if(!fight_wrapper){if(GM_getValue("staminaSpendHow")==getStaminaMode()){cycleSavedList("pfightlist");return false}}switch(action){case"fight":return logFightResponse(innerPageElt,fight_wrapper,context,0);break;case"multifight":return logFightResponse(innerPageElt,fight_wrapper,context,1);break}}if(action=="load clan"){DEBUG("Are we on the clan page we want to be on?");if(onClanNav(GM_getValue("AutoBattleClanID",0))){DEBUG("Looking for Challenge Link");var challenge=xpathFirst('.//a[contains(@href,"xw_controller=epicBattle&xw_action=challengePop")]',rootElt);if(challenge){DEBUG("We found the challenge button, clicking it");setGMTime("autoBattleTimer","60:00");clickAction="battlePop";clickElement(challenge)}else{DEBUG("No Challenge Popup found check again in 10 minutes");setGMTime("autoBattleTimer","10:00");Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}}}if(action=="load battlepage"){return false}if(action=="load battlecollect"){if(onBattlePage(1)){DEBUG("Looking for Battle Collect Link");var collectLink=xpathFirst('.//a[contains(@onclick,"xw_controller=epicBattle&xw_action=getResults") and contains(.,"Collect")]');if(collectLink){DEBUG("Found a Battle Collect link clicking it");setGMTime("autoBattleCollectTimer","05:00");clickElement(collectLink);Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}else{DEBUG("No Battle Collect link found");setGMTime("autoBattleCollectTimer","60:00");Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}}}if(!messagebox){messagebox=xpathFirst('.//div[@id="default_id_box"]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[contains(@class,"message_body")]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[@class="job_results"]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[contains(@class,"job_controller")]',contentRoweElt)}if(!messagebox){messagebox=xpathFirst('.//div[@id="msg_box_div_1"]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[@id="mbox_generic_1"]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[@id="bank_messages"]',appLayoutElt)}if(!messagebox){messagebox=xpathFirst('.//div[@id="hospital_message"]',appLayoutElt)}if(!messagebox){messagebox=xpathFirst('.//div[@id="'+context+'" and @class="rob_slot"]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[@class="rob_board"]',rootElt)}if(!messagebox){messagebox=xpathFirst('.//div[@class="chop_build_final"]',appLayoutElt)}if(!messagebox){messagebox=xpathFirst('.//table[@class="messages"]',rootElt)}if(action=="withdraw"&&context){autoBankWithdraw(context);Autoplay.start();return true}if(!messagebox){if(action=="load clan")return true;if(action=="load battlecollect")return true;if(action=="battlePop")return true;if(action=="autohit")return false;if(action=="fight"||action=="multifight"){colorDEBUG(" we have passed all message boxes but have action (multi)fight  ",cbl);if(GM_getValue("staminaSpendHow")==getStaminaMode())cycleSavedList("pfightlist");return false}messagebox=rootElt}skipStaminaSpend=false;var inner=messagebox?messagebox.innerHTML:"";var innerNoTags=inner.untag();var cost,experience,result;switch(action){case"autohit":case"fight":var fight_wrapper=xpathFirst('.//div[@id="fv2_widget_wrapper"]',innerPageElt);return logFightResponse(innerPageElt,fight_wrapper,context,0);break;case"multifight":var fight_wrapper=xpathFirst('.//div[@id="fv2_widget_wrapper"]',innerPageElt);return logFightResponse(innerPageElt,fight_wrapper,context,1);break;case"load battlecollect":DEBUG("We have a load battlecollect message box to handle.. doing nothing..");break;case"keelBandit":colorDEBUG("normal LogResponse Action : Bandit Keel'ed");Autoplay.fx=goJobsNav;Autoplay.delay=noDelay;Autoplay.start();return true;break;case"newcity job":break;case"autoStatAllocation":DEBUG("autoStatAllocation results");return false;break;case"autoStatReward":DEBUG("autoStatReward results");return false;break;case"autoRob":if(!isGMChecked("fastRob"))return logRobResponse(context);else{randomizeStamina();Autoplay.fx=goRobbingTab;Autoplay.delay=noDelay;Autoplay.start();return true};case"operationsTask":pushNextJob=false;opsInfo=getOperationsInfo(context,context.slot,"result");if(opsInfo){if(!opsInfo.taskFailed){var taskResult='RX6 performed <span class="job">'+opsInfo.name+"/"+opsInfo.taskName+'</span>, gaining <span class="good">'+opsInfo.xp+" experience</span>";if(opsInfo.cash)taskResult+=' and <span class="good">'+cities[opsInfo.cashCity][CITY_CASH_SYMBOL]+opsInfo.cash+"</span>";if(opsInfo.cashNeeded)taskResult+='. RX6 used <span class="bad">'+cities[opsInfo.cashNeededCity][CITY_CASH_SYMBOL]+opsInfo.cashNeeded+"</span>";DEBUG("Operation is "+opsInfo.taskMastery+" % Mastered");addToLog("process Icon",taskResult+".")}else{var taskResult='RX6 failed to performed <span class="job">'+opsInfo.name+"/"+opsInfo.taskName+"</span>.";addToLog("bad Icon",taskResult+".")}}return false;break;case"job":try{var masteryGainElt;xpGainElt=xpathFirst('.//dd[@class="message_experience"]',messagebox);xpGainElt=xpGainElt?xpGainElt:xpathFirst('.//dd[@class="experience"]',messagebox);var jobContainer="job"+context[0];jobName=context[1];var jobContainerElt=xpathFirst('.//div[@id="'+jobContainer+'"]',rootElt);masteryGainElt=xpathFirst('.//div[@id="'+jobContainer+'"]//div[@class="mastery_bar"]//p',rootElt);var masteryGainTxt="";var jobMastery=0;var pushNextJob=false;if(masteryGainElt){if(GM_getValue("selectTier","0.0")!="0.0"){jobMastery=parseInt(masteryGainElt.innerHTML.digitize());DEBUG(" Job "+jobName+" is "+jobMastery+"% Mastered.");if(masteryGainTxt==100){masteryGainTxt=". Job 100% Mastered";pushNextJob=true}}}if(xpGainElt){var xpGainTxt=parseInt(xpGainElt.innerHTML);if(xpGainTxt){var xpBonusElt=xpathFirst('.//div[@class="message_experience"]',messagebox);if(xpBonusElt)xpGainTxt+="+"+parseInt(xpBonusElt.innerHTML);xpGainTxt+=" Experience"}result="RX6 performed "+'<span class="job">'+jobName+'</span> earning <span class="good">'+xpGainTxt+"</span>";var cashGainTxt="";var cashGainElts=$x('.//dd[@class="message_cash"]',messagebox);for(i=0;i<cashGainElts.length;i++)cashGainTxt+=cashGainElts[i].innerHTML;if(cashGainElts.length==0){cashGainElt=xpathFirst('.//dd[contains(@class,"cash_icon")]',messagebox);if(cashGainElt){cashGainTxt=cashGainElt.innerHTML;if(cashGainTxt.match(REGEX_CASH))cashGainTxt=cities[city][CITY_CASH_SYMBOL]+RegExp.lastMatch;else cashGainTxt=cities[city][CITY_CASH_SYMBOL]+cashGainTxt}}if(cashGainTxt.match(/(.+?)\s+?\(You now have/i))cashGainTxt=RegExp.$1;if(cashGainTxt)result+=' and <span class="good">'+cashGainTxt+"</span>";var cashSpendElt=xpathFirst('.//dt[@class="message_cash bad"]',messagebox);if(!cashSpendElt)cashSpendElt=xpathFirst('.//div[@class="job_uses"]//dd[contains(@class,"cash_icon")]',messagebox);if(cashSpendElt){var cashSpendTxt=cashSpendElt.innerHTML.untag();if(cashSpendTxt.match(/(.+?)\s+?Bribes/))cashSpendTxt=RegExp.$1;result+=', spending <span class="bad">'+cities[city][CITY_CASH_SYMBOL]+cashSpendTxt+"</span>"}if(masteryGainTxt)result+=masteryGainTxt;result+=".";if(innerNoTags.indexOf("you spent no energy")!=-1||innerNoTags.indexOf("No energy cost")!=-1||innerNoTags.indexOf("You Spent: 0")!=-1)result+=" RX6 spent no energy on this job.";addToLog("process Icon",result);result="";var stamSpendElt=xpathFirst('.//dd[@class="stamina"]',messagebox);if(stamSpendElt)result+=" Stamina spent: "+stamSpendElt.innerHTML.untag()+".";var nrgSpendElt=xpathFirst('.//dd[@class="energy"]',messagebox);if(nrgSpendElt){nrgSpendTxt=nrgSpendElt.innerHTML.untag();if(nrgSpendTxt.indexOf("Mastery")!=-1)result+=" "+nrgSpendElt.innerHTML.untag()+".";else result+=" Energy spent: "+nrgSpendElt.innerHTML.untag()+"."}if(result)DEBUG(result);jobCombo(rootElt);if(masteryGainElt)jobLoot(jobContainerElt);else jobLoot(rootElt);if(innerNoTags.match(/.*(An* .+ was added to your inventory[^.]*.)/i)){addToLog("lootbag Icon",RegExp.$1)}var xpGain=parseInt(xpGainElt.innerHTML);var parentClass="";var xpGainMin=GM_getIntValue("autoAskJobHelpMinExp");if(isGMChecked("autoAskJobHelp")&&(!xpGainMin||xpGain>=xpGainMin)){var elt=xpathFirst('.//div[@class="message_buttons"]//span[@class="sexy_jobhelp"]',messagebox);if(!elt)elt=xpathFirst('.//div[@class="message_buttons"]//a[@class="sexy_button_new short white sexy_call_new" and contains(.,"Let Friends Get a Bonus")]',messagebox);if(elt){Autoplay.fx=function(){clickElement(elt);addToLog("process Icon",'Asked for help with <span class="job">'+missions[GM_getValue("selectMission")][MISSION_NAME]+"</span>.")};Autoplay.start();return true}}}else if(innerNoTags.indexOf("You are not high enough level to do this job")!=-1){addToLog("warning Icon","You are not high enough level to do "+missions[GM_getValue("selectMission",1)][MISSION_NAME]+".");addToLog("warning Icon","Job processing will stop");GM_setValue("autoMission",0);update_nrg_stam()}else if(innerNoTags.indexOf("Success")!=-1){addToLog("process Icon",inner)}else if(innerNoTags.indexOf("Missing")!=-1){if(getJobRowItems(jobName)){DEBUG("RX6 needs some items to perform jobid="+jobid+" / selectMission="+GM_getValue("selectMission",1));if(jobid!=GM_getValue("selectMission",1))Autoplay.fx=autoMission}}else DEBUG("Unrecognized job response.");if(pushNextJob)Autoplay.fx=goJobsNav;Autoplay.start();return false}catch(je){alert(je)}break;case"hitman":if(innerNoTags.indexOf("someone else took out")!=-1){DEBUG(inner);return false}var targetKilled=innerNoTags.indexOf("You knocked out")!=-1;if(innerNoTags.indexOf("You WON")!=-1){var cashGain=innerNoTags.match(/gained.*?([A-Z]*?\$|\u00A2|\u00A3)([\d,]*\d)/i);var cashWon=RegExp.$1+RegExp.$2;experience=innerNoTags.match(/\d+\s+experience\s+points?/i);addToLog("yeah Icon","RX6 hit "+linkToString(context.profile,"user")+' and <span class="good">WON</span>. You gained <span class="good">'+cashWon+"</span> and "+'<span class="good">'+experience+"</span>.");cashWon=parseCash(cashWon);GM_setValue("hitmanWinCountInt",GM_getValue("hitmanWinCountInt",0)+1);GM_setValue("hitmanWinDollarsInt",String(GM_getIntValue("hitmanWinDollarsInt",0)+cashWon));GM_setValue("totalExpInt",GM_getValue("totalExpInt",0)+parseInt(experience));GM_setValue("totalWinDollarsInt",String(GM_getIntValue("totalWinDollarsInt",0)+cashWon));GM_setValue("cashWinsNY",String(GM_getIntValue("cashWinsNY",0)+cashWon));if(!targetKilled&&canSpendStamina()&&ptsToNextLevel>6){var eltAtk;if(isGMChecked("staminaPowerattack"))eltAtk=xpathFirst('.//a[contains(.,"Power Attack")]',messagebox);if(!eltAtk)eltAtk=xpathFirst('.//a[contains(.,"Attack Again")]',messagebox);if(eltAtk){Autoplay.fx=function(){clickAction=action;clickContext=context;clickElement(eltAtk);DEBUG("Clicked to repeat the hit on "+clickContext.name+" ("+clickContext.id+").")};if(!isGMChecked("noStats")){updateLogStats(STAMINA_HOW_HITMAN)}Autoplay.delay=noDelay;Autoplay.start();return true}}}else if(innerNoTags.indexOf("You LOST")!=-1){var t=innerNoTags.match(/LOST.*?RegExp.$1/i);var cashLoss=RegExp.$1+RegExp.$2;result="RX6 hit "+linkToString(context.profile,"user")+' and <span class="bad">LOST</span>. You lost <span class="bad">'+cashLoss+"</span>.";cashLoss=parseCash(cashLoss);GM_setValue("hitmanLossCountInt",GM_getValue("hitmanLossCountInt",0)+1);GM_setValue("hitmanLossDollarsInt",String(GM_getIntValue("hitmanLossDollarsInt",0)+cashLoss));GM_setValue("totalLossDollarsInt",String(GM_getIntValue("totalLossDollarsInt",0)+cashLoss));GM_setValue("fightLoss$NY",String(GM_getIntValue("fightLoss$NY",0)+cashLoss));if(context.id){setHitmanOpponentAvoid(context);result+=" Avoiding."}addToLog("omg Icon",result)}else if(innerNoTags.indexOf("This player is currently part of your mafia")!=-1){if(context.id)setHitmanOpponentAvoid(context)}else DEBUG(inner);if(innerNoTags.indexOf("You were snuffed")!=-1)addToLog("updateBad Icon",'You <span class="bad">DIED</span>.');if(targetKilled){if(context.id)addSavedListItem("hitmanListKilled",context.id,100);addToLog("killedMobster Icon",'RX6 <span class="bad">KILLED</span> '+linkToString(context.profile,"user")+' and collected the <span class="money">'+context.bounty+"</span> bounty set by "+linkToString(context.payer,"user")+".");GM_setValue("hitmanWinCountInt",GM_getValue("hitmanWinCountInt",0)+1);GM_setValue("hitmanWinDollarsInt",String(GM_getIntValue("hitmanWinDollarsInt",0)+parseCash(context.bounty)));GM_setValue("totalWinDollarsInt",String(GM_getIntValue("totalWinDollarsInt",0)+parseCash(context.bounty)));GM_setValue("cashWinsNY",String(GM_getIntValue("cashWinsNY",0)+parseCash(context.bounty)))}if(!isGMChecked("noStats"))updateLogStats(STAMINA_HOW_HITMAN);randomizeStamina();break;case"war":if(innerNoTags.indexOf("Target user is not a friend")!=-1||innerNoTags.indexOf("Target user does not exist")!=-1){removeSavedListItem("autoWarTargetList",context.target_id);addToLog("warning Icon","Invalid war target (id="+context.target_id+"). Removing from list.")}else if(innerNoTags.indexOf("is already at war with someone else")!=-1){addToLog("info Icon",inner.split(".")[0]+". Cycling warlist. ");cycleSavedList("autoWarTargetList")}else if(innerNoTags.indexOf("You successfully betrayed")!=-1){addToLog("omg Icon",inner.split("<br><br>")[0]+"</div>");break}else if(innerNoTags.indexOf("You successfully declared war")!=-1){cycleSavedList("autoWarTargetList");addToLog("yeah Icon",inner)}else if(innerNoTags.indexOf("WON")!=-1||innerNoTags.indexOf("LOST")!=-1){var logIcon=innerNoTags.indexOf("LOST")!=-1?"omg Icon":"yeah Icon";if(innerNoTags.indexOf("to winning this war.")!=-1){addToLog(logIcon,inner.split("to winning this war.")[0]+"to winning this war.</div>")}}if(helpWar){GM_setValue("logPlayerUpdatesCount",1+GM_getValue("logPlayerUpdatesCount",0));helpWar=false}setGMTime("warTimer","00:00");Autoplay.fx=goWarTab;Autoplay.start();return true;break;case"stats":if(innerNoTags.match(/You just upgraded your (\w+) by (\d+)/i)){var statName=RegExp.$1;var statIndex=eval(statName.toUpperCase()+"_STAT");var statIcon=statName.toLowerCase()+" Icon";var statInc=isNaN(RegExp.$2)?1:parseInt(RegExp.$2);GM_setValue("nextStat",(statIndex+1)%4);switch(statIndex){case ATTACK_STAT:curAttack+=statInc;break;case DEFENSE_STAT:curDefense+=statInc;break;case HEALTH_STAT:maxHealth+=statInc;break;case ENERGY_STAT:maxEnergy+=statInc;break;case STAMINA_STAT:maxStamina+=statInc;break}addToLog(statIcon,'<span style="color:#885588;">'+statName+" increased by "+statInc+" point(s).</span>")}else{DEBUG("Failed to increment stat.")}break;case"energypack":addToLog("energyPack Icon",'Used an <span class="good">Energy Pack</span>.');energyPackElt=undefined;DEBUG('Unrecognized response for "energypack" action : '+inner);break;case"help":var helpElt=xpathFirst('.//a[contains(.,"Help ")]',messagebox);if(helpElt){Autoplay.fx=function(){clickElement(helpElt);clickAction="help";clickContext=context};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}GM_setValue("logPlayerUpdatesCount",1+GM_getValue("logPlayerUpdatesCount",0));var user=linkToString(xpathFirst('.//a[contains(@onclick,"xw_controller=stats&xw_action=view")]',messagebox),"user");if(context&&!user){user=context.user}if(innerNoTags.indexOf("not your friend")!=-1||innerNoTags.indexOf("You need to be friends")!=-1||innerNoTags.indexOf("to help on a job.")!=-1){addToLog("info Icon","Failed to help"+(user?" "+user:"")+"with job. Reason: not friends.")}else if(innerNoTags.indexOf("You are too late")!=-1){addToLog("info Icon","You are too late to help "+(user?" "+user:"")+" with this job.")}else if(innerNoTags.indexOf("already helped")!=-1){addToLog("info Icon","Already helped "+user+" with this job.")}else if(innerNoTags.indexOf("You received")!=-1||innerNoTags.indexOf("You helped")!=-1){cost=innerNoTags.match(REGEX_CASH);experience=0;if(innerNoTags.match(/(\d+)\s+experience\s+points?/i)){experience=parseInt(RegExp.$1)}if(innerNoTags.indexOf("Special Bonus")!=-1){var loot=innerNoTags.split("gained a ")[1];addToLog("lootbag Icon",'Found a <span class="loot">'+loot.split(".<span")[0]+"</span> while helping on a job.")}result="You received "+'<span class="good">'+cost+"</span>"+" and "+'<span class="good">'+experience+" experience</span>"+" for helping "+user+" complete the job.";GM_setValue("passivetotalJobExpInt",GM_getIntValue("passivetotalJobExpInt",0)+experience);addToLog("updateGood Icon",result);if(!isGMChecked("noStats")){updateLogStats()}}else if(innerNoTags.indexOf("25 friends")!=-1){addToLog("info Icon","Failed to help"+(user?" "+user:"")+" with job. Reason: already helped 25 friends for the day in that city.")}else{addToLog("info Icon","WARNING: Not sure what happened when trying to help"+(user?" "+user:"")+"."+(context?" "+context.help:"")+" Perhaps you interfered by clicking on something?")}Autoplay.start();return true;break;case"help burners":var helpElt=xpathFirst('.//a[contains(.,"Accept")]',messagebox);if(helpElt){Autoplay.fx=function(){clickElement(helpElt);clickAction="help burners";clickContext=context};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}GM_setValue("logPlayerUpdatesCount",1+GM_getValue("logPlayerUpdatesCount",0));addToLog("info Icon",innerNoTags);Autoplay.start();return true;break;case"help parts":var helpElt=xpathFirst('.//a[contains(.,"Send Item")]',messagebox);if(helpElt){Autoplay.fx=function(){clickElement(helpElt);clickAction="help parts";clickContext=context};Autoplay.delay=getAutoPlayDelay();Autoplay.start();return true}DEBUG("Parsing parts help.");GM_setValue("logPlayerUpdatesCount",1+GM_getValue("logPlayerUpdatesCount",0));if(innerNoTags.indexOf("You sent ")!=-1)addToLog("info Icon","RX6 sent "+inner.split("You sent ")[1].split("</div>")[0]);Autoplay.start();return true;break;case"deposit":if(parseInt(city)!=parseInt(context)){addToLog("warning Icon","Warning! You have traveled from "+cities[context][CITY_NAME]+" to "+cities[city][CITY_NAME]+" while banking. Check your money.")}if(innerNoTags.match(/deposited/i))addToLog(cities[city][CITY_CASH_CSS],inner);else DEBUG(inner);var bankElt=xpathFirst('//div[@id="bank_popup"]');if(bankElt&&bankElt.parentNode)closePopup(bankElt.parentNode,"Bank Popup");break;case"withdraw":if(innerNoTags.match(/withdrew/i))addToLog(cities[city][CITY_CASH_CSS],inner);else DEBUG(inner);var bankElt=xpathFirst('//div[@id="bank_popup"]');if(bankElt&&bankElt.parentNode)closePopup(bankElt.parentNode,"Bank Popup");break;case"buy item":addToLog("info Icon",inner.untag());break;case"newcity buy":addToLog("info Icon","Brazil Items bought");break;case"buy property":addToLog("info Icon",inner);break;case"crew collection":addToLog("info Icon",inner);break;case"build item":var propCount=context.propCount;var buildProp=cityProperties[propCount][ctPropName];var timerName=cityProperties[propCount][ctPropTimer];if(/You cannot craft/i.test(inner)||/You do not have/i.test(inner)||/You need a higher/i.test(inner)){inner=buildProp+": "+inner;setGMTime(timerName,"1 hour");addToLog("warning Icon",inner)}else{setGMTime(timerName,"24 hours");if(inner.match(/You got (.+?)\./)){var log='RX6 built <span class="loot">'+RegExp.$1+"</span>.";if(inner.match(/You gained:(.+?) close/))log+=" You gained "+RegExp.$1+".";addToLog("lootbag Icon",log)}else addToLog("lootbag Icon",inner)}break;default:colorDEBUG('BUG DETECTED: Unrecognized action "'+action+'".',cre);DEBUG("Unrecognized Action :"+inner)}return false}function closePopup(a,b){if(!a){DEBUG("Can not close "+b+" : popupElt undefined !");return false}var c=xpathFirst('.//a[@class="pop_close"]',a);if(!c)c=xpathFirst('.//a[@class="close"]',a);if(!c)c=xpathFirst('.//a[@class="sexy_button_new medium black skip" or contains(.,"Cancel")]',a);if(!c)c=xpathFirst('.//a[@class="mw_new_ajax pop_close"]',a);if(c){clickElement(c);DEBUG("Got rid of "+b+" popup: "+a.id+".")}var d=document.getElementById("fb_dialog_cancel_button");if(d){clickElement(d);DEBUG("Skipped "+b+" popup: "+a.id+".")}if(a.parentNode)a.parentNode.removeChild(a);return true}function showPopups(a){if(a&&a.length>0){for(var b=0,c=a.length;b<c;++b){var d=a[b].getAttribute("class");if(d.indexOf("pop_bg")==-1&&!a[b].getAttribute("opened")&&a[b].innerHTML.length>0&&a[b].scrollWidth){a[b].setAttribute("style","display: block;");a[b].setAttribute("opened","yes")}else if(a[b].getAttribute("opened")!="yes"||!a[b].innerHTML.length){a[b].setAttribute("style","display: none;")}}}}function handlePopups(){fetchPubOptions();try{var popupElt=xpathFirst('.//div[@id="currentTab"]',popupfodderElt);if(popupElt)GM_setValue("currentTab",popupElt.innerHTML);var popupElts=$x('.//div[contains(@id, "pop_b") and not(contains(@style, "none"))]',popupfodderElt);showPopups(popupElts);var popupElts=$x('.//div[@class="fight_true_popup"]//div[contains(@id, "pop_b")]',innerPageElt);showPopups(popupElts);var requestPopContainer=xpathFirst('.//div[@id="requests_toaster" and contains(@style,"block")]');if(requestPopContainer){var requestPopText=xpathFirst('.//div[@id="requests_toaster_txt"]',requestPopContainer);if(requestPopText)addToLog("process Icon",requestPopText.innerHTML.untag());return closePopup(requestPopContainer,"Requests")}var popupContainers=$x('.//div[@class="buy_prompt"]',appLayoutElt);if(running&&popupContainers&&popupContainers.length>0){for(var i=0,iLength=popupContainers.length;i<iLength;++i){if(popupContainers[i]&&popupContainers[i].scrollWidth&&popupContainers[i].innerHTML.length>0){var currentPopup=popupContainers[i];return closePopup(currentPopup,"Buy Prompt")}}}var popupContainers=$x('.//div[contains(@id,"socialMissionFail") and @class="socialMissionTryAgain" and contains(@style,"block")]',appLayoutElt);if(running&&popupContainers&&popupContainers.length>0){for(var i=0,iLength=popupContainers.length;i<iLength;++i){if(popupContainers[i]&&popupContainers[i].scrollWidth&&popupContainers[i].innerHTML.length>0){var currentPopup=popupContainers[i];var processElt;if(isGMChecked("AutoRetryOperations")){processElt=xpathFirst('.//a[contains(@onclick,"tryAgain") and contains(.,"Start")]',currentPopup);DEBUG("Clicking to retry expired operation")}else{processElt=xpathFirst('.//a[contains(@onclick,"tryAgain") and contains(.,"Close")]',currentPopup);DEBUG("Clicking to close expired operation")}if(processElt)clickElement(processElt);return true}}}var popupContainers=$x('.//div[contains(@id,"zy_popup_box") and not(@class="zy_popup_box_bg") and contains(@style,"block")]',appLayoutElt);if(running&&popupContainers&&popupContainers.length>0){for(var i=0,iLength=popupContainers.length;i<iLength;++i){if(popupContainers[i]&&popupContainers[i].scrollWidth&&popupContainers[i].innerHTML.length>0){var currentPopup=popupContainers[i];var processElt;processElt=xpathFirst('.//div[@class="achievement_message_text"]',currentPopup);if(processElt){var processTxt=processElt.innerHTML.untag();if(processTxt.match(/you earned(.+)share/i))addToLog("yeah Icon","RX6 earned "+RegExp.$1+".");if(isGMChecked("autoGlobalPublishing")){processElt=xpathFirst('.//a[contains(@class,"sexy_achievement_new") and contains(.,"Share the wealth")]',currentPopup);if(processElt){clickElement(processElt);DEBUG("Clicked to share Achievement Bonus")}}}return closePopup(currentPopup,"Achievement Popup")}}}var popupElts=$x('.//div[(contains(@id,"pop_box") and contains(@style, "block")) or contains(@id,"mystery")]',appLayoutElt);if(popupElts&&popupElts.length>0){for(var i=0,iLength=popupElts.length;i<iLength;++i){var currentPopup=popupElts[i];if(currentPopup&&currentPopup.scrollWidth&&currentPopup.innerHTML.length>0){var popupInner=currentPopup.innerHTML;var popupInnerNoTags=popupInner.untag().toLowerCase();if(popupInner.indexOf("fight_wrapper")!=-1||popupInner.indexOf("bank_popup")!=-1||popupInner.indexOf("vault_popup")!=-1){continue}if((popupInner.indexOf('id="marketplace"')!=-1||popupInner.indexOf('id="original_buyframe_popup"')!=-1||popupInner.indexOf("marketplace_title.png")!=-1||popupInner.indexOf("giftcard_iframe")!=-1||popupInner.indexOf("newbuyer_congrats")!=-1||popupInner.indexOf("xw_controller=hospital")!=-1||popupInner.indexOf("Build Complete")!=-1||popupInner.indexOf('id="ChopShopCarousel"')!=-1||popupInner.indexOf('class="account_settings_title"')!=-1||popupInner.indexOf('class="exp_discount_main"')!=-1||popupInner.indexOf("TournamentController.nextPage()")!=-1||popupInner.indexOf("this wave has ended")!=-1||popupInner.indexOf("xw_controller=SubscriptionPlan")!=-1||popupInner.indexOf('id="lbox_iframe"')!=-1||popupInnerNoTags.indexOf("wishlist is full")!=-1||popupInnerNoTags.indexOf("cooldown")!=-1||popupInnerNoTags.indexOf("buy now order")!=-1||popupInnerNoTags.indexOf("drag to reorder them")!=-1||popupInnerNoTags.indexOf("vengeance pack")!=-1)&&popupInnerNoTags.indexOf("select a consumable to use")==-1){if(running)return closePopup(currentPopup,"Annoying Zollipops stuff");continue}if(running){if(popupInnerNoTags.indexOf("close_suggestor_iframe")!=-1){if(!timeLeftGM("requestTimer")&&inRequests){inRequests=false;if(typeof unsafeWindow.close_suggestor_iframe=="function")unsafeWindow.close_suggestor_iframe();else return closePopup(currentPopup,"Free Gift Suggestor")}return}var elt=xpathFirst('.//div[contains(@id,"map_boss_victory")]//a[contains(.,"Share")]',currentPopup);if(elt){colorDEBUG("bossFight - clicked to share Boss Fight Rewards",caq);clickElement(elt);if(popupTimer){window.clearInterval(popupTimer);popupTimer=window.setInterval(handlePopups,350)}Autoplay.fx=goHome;Autoplay.start();return}var elt=xpathFirst('.//div[contains(@id,"map_boss_victory")]//a[contains(.,"return")]',currentPopup);if(elt){colorDEBUG("bossFight - clicked to Return to District",caq);clickElement(elt);if(popupTimer){window.clearInterval(popupTimer);popupTimer=window.setInterval(handlePopups,350)}Autoplay.fx=goHome;Autoplay.start();return}var elt=xpathFirst('.//div[@id="pop_box_map_boss_fight_stamina_popup"]//a[contains(.,"Close")]',currentPopup);if(elt){colorDEBUG("bossFight - clicked to close Boss Fight Popup - out of stamina",caq);clickElement(elt);endBoss=true;return}elt=xpathFirst('.//div[@id="pop_box_map_boss_fight_popup"]//a[class="pop_close"]',currentPopup);if(elt&&endBoss){colorDEBUG("bossFight - clicked to close Boss Fight Popup",caq);isBGPaused=false;clickElement(elt);return}elt=xpathFirst('.//div[@id="pop_box_map_boss_fight_run_away_popup"]//a[contains(.,"Run Away")]',currentPopup);if(elt&&endBoss){colorDEBUG("bossFight - clicked to Run Away from Boss Fight",caq);isBGPaused=false;clickElement(elt);if(popupTimer){window.clearInterval(popupTimer);popupTimer=window.setInterval(handlePopups,350)}endBoss=false;Autoplay.delay=150;Autoplay.fx=goHome;Autoplay.start();autoReload(false,"challenge mission");return}var elt=xpathFirst('.//a[contains(@class,"attack_boss") and contains(@onclick,"Expert")]',currentPopup);if(elt){endBoss=false;if(popupTimer){window.clearInterval(popupTimer);popupTimer=window.setInterval(handlePopups,3e3)}autoReload(false,"Boss Fight");colorDEBUG("bossFight - clicked to confirmBoss Fight",caq);clickElement(elt);return}var bossFightContainer=xpathFirst('.//div[@id="map_boss_fight"]',currentPopup);if(bossFightContainer){if(popupTimer){window.clearInterval(popupTimer);popupTimer=window.setInterval(handlePopups,3e3)}if(isUndefined(useConsumables))useConsumables=true;autoReload(false,"Boss Fight");var bossConsumables=$x('.//a[contains(@id,"use_con") and not(contains(@class,"greyButton"))]',bossFightContainer);if(bossConsumables&&bossConsumables.length>0&&useConsumables){elt=bossConsumables[bossConsumables.length-1];colorDEBUG("bossFight - clicked to use consumable",caq);clickElement(elt);useConsumables=false;return}elt=xpathFirst('.//a[contains(@class,"sexy_attack_new") and contains(@onclick,"BossController")]',bossFightContainer);if(elt){colorDEBUG("bossFight - clicked to attack Boss",caq);clickElement(elt);useConsumables=true}return}var battlePopContainer=xpathFirst('.//div[@id="role_select_bg"]',currentPopup);if(battlePopContainer){DEBUG("Found Battle Popup");elt=xpathFirst('.//a[@class="rightArrow" and contains(.,"FIGHT")]',battlePopContainer);if(elt){clickElement(elt)}return closePopup(currentPopup,"Battle Popup")}if(popupInner.indexOf("mw_app=slotmachine")!=-1){var flashvars=xpathFirst('//object[@id="slots"]/param[@name="flashvars"]');if(flashvars&&flashvars.value){slotSpins=flashvars.value.match(/&freeSpins=(\d+)&/)[1];slotBonus=flashvars.value.match(/&bonusMeter=(\d+)&/)[1];addToLog("info Icon","Slot Spins Remaining: "+slotSpins+" Bonus Level: "+slotBonus)}return closePopup(currentPopup,"Slot Machine Popup")}if(popupInner.indexOf('class="depotTitle"')!=-1){var eltindex=1;var tmpCont=$x('.//div[contains(@class,"upgrade_card_amounts")]',currentPopup);if(tmpCont&&tmpCont.length&&tmpCont.length==3){var tmpHave=xpathFirst('.//span[contains(@id,"buy_one_part_have")]',tmpCont[2]);var tmpNeed=xpathFirst('.//span[contains(@id,"buy_one_part_need")]',tmpCont[2]);if(tmpHave&&tmpNeed){if(parseInt(tmpHave.innerHTML)==parseInt(tmpNeed.innerHTML)){DEBUG("Limited Parts, FULL!!!!  We have: "+tmpHave.innerHTML+" We Need: "+tmpNeed.innerHTML);eltindex=2}else{DEBUG("Limited Parts, We have: "+tmpHave.innerHTML+" We Need: "+tmpNeed.innerHTML)}}}var askButtons=$x('.//a[contains(@onclick,"postfeedforproperty_part")]',currentPopup);if(askButtons&&askButtons.length){var askButton=askButtons[askButtons.length-eltindex];DEBUG("Clicking Ask Limited Property Element");clickElement(askButton)}return closePopup(currentPopup,"Limited Property")}if(popupInnerNoTags.indexOf("total requests")!=-1){var acceptgiftButtons=$x('.//a[@class="sexy_button_new medium white" and contains(@onclick,"accept_gift") and not(contains(@onclick,"item_id=3009")) ]',currentPopup);if(acceptgiftButtons&&isGMChecked("autoAcceptMsgGifts")){for(i=0;i<acceptgiftButtons.length>0;++i){acceptgiftButton=acceptgiftButtons[i];clickElement(acceptgiftButton)}DEBUG("Popup Process: MESSAGE CENTER - "+acceptgiftButtons.length+" Gifts Accepted")}acceptgiftButtons=$x('.//a[@class="sexy_button_new medium white" and contains(@onclick,"accept_boost")]',currentPopup);if(acceptgiftButtons&&isGMChecked("autoAcceptMsgBoosts")){for(i=0;i<acceptgiftButtons.length>0;++i){acceptgiftButton=acceptgiftButtons[i];clickElement(acceptgiftButton)}DEBUG("Popup Process: MESSAGE CENTER - "+acceptgiftButtons.length+" Boosts Accepted")}if(isGMChecked("AutoBattle")){var acceptButtons=$x('.//a[@class="sexy_button_new medium white" and contains(@onclick,"xw_action=createBattle") and contains(@onclick,"opponent_id='+GM_getValue("AutoBattleClanID")+'")]',currentPopup);if(acceptButtons){for(i=0;i<acceptButtons.length>0;++i){acceptButton=acceptButtons[i];clickElement(acceptButton)}DEBUG("Popup Process: MESSAGE CENTER - Accepted "+acceptButtons.length+" battles.")}}var acceptButtons=$x('.//a[@class="sexy_button_new medium white" and contains(.,"Join Mafia")]',currentPopup);if(acceptButtons&&isGMChecked("acceptMafiaInvitations")){for(i=0;i<acceptButtons.length>0;++i){acceptButton=acceptButtons[i];clickElement(acceptButton)}DEBUG("Popup Process: MESSAGE CENTER - Added "+acceptButtons.length+" members to your mafia.")}var acceptButtons=$x('.//a[@class="sexy_button_new medium white" and contains(.,"Accept Crew")]',currentPopup);if(acceptButtons&&isGMChecked("autoAcceptMsgCrew")){for(i=0;i<acceptButtons.length>0;++i){acceptButton=acceptButtons[i];clickElement(acceptButton)}DEBUG("Popup Process: MESSAGE CENTER - Accepted "+acceptButtons.length+" Crew Invites to your mafia.")}var acceptButtons=$x('.//a[@class="sexy_button_new medium white" and (contains(.,"Send Energy") or contains(@onclick,"xw_action=accept_energy_req"))]',currentPopup);if(acceptButtons&&isGMChecked("autosendMsgEnergyPack")){for(i=0;i<acceptButtons.length>0;++i){acceptButton=acceptButtons[i];clickElement(acceptButton)}DEBUG("Popup Process: MESSAGE CENTER - Sent "+acceptButtons.length+" energy Packs to your mafia.")}return closePopup(currentPopup,"MESSAGE CENTER")}if(popupInnerNoTags.indexOf("opened a red mystery bag")!=-1||popupInnerNoTags.indexOf("share mystery bonus")!=-1){colorDEBUG(popupInner);DEBUG("Popup Process: Red Mystery Bag / Mystery Bonus Processed");var bagTxt;if(popupInnerNoTags.match(/you got:\s?(.+?)(\s?send|\s?share)/i))bagTxt=RegExp.$1;addToLog("lootbag Icon",'Received <span class="loot">'+bagTxt+"</span> from a red mystery bag / mystery bonus.");var dropItem=xpathFirst('.//div[contains(@class,"mystery")]/div',currentPopup);if(dropItem)addToLog("lootbag Icon",dropItem.innerHTML);return closePopup(currentPopup,"Red Mystery Bag Drop")}if(popupInner.indexOf("BattleResultsController")!=-1){DEBUG("Found BattleRewards Popup");elt=xpathFirst('.//a[contains(@onclick,"BattleResultsController.collectReward") and contains(.,"Collect")]',currentPopup);if(elt){DEBUG("Found collect link to click, boom!");clickElement(elt)}else DEBUG("No collect link found :(");return closePopup(currentPopup,"Battle Collect")}if(popupInner.indexOf("epic_battle_collect")!=-1||popupInnerNoTags.indexOf("clan/battle")!=-1){DEBUG("Found BattleRewards Item Popup");var rewardDiv=xpathFirst('.//div[contains(@class,"item_with_preview")]',currentPopup);if(!rewardDiv)rewardDiv=xpathFirst('.//div[contains(@style,"item_with_preview")]',currentPopup);if(rewardDiv){var newTxt='<div class="lootImg">Family Battle Reward:<br>'+rewardDiv.innerHTML+"</div>";addToLog("lootbag Icon",newTxt)}return closePopup(currentPopup,"Battle Collect Item")}if(popupInnerNoTags.indexOf("you cleared the full board")!=-1){logRobResult(currentPopup);return closePopup(currentPopup,"Robbing Board Popup")}var upgradePointsElt=xpathFirst('.//span[@id="level_up_skill"]',currentPopup);if(upgradePointsElt){if(isGMChecked("autoStat")){var upgradePoints=0;upgradePoints=parseInt(upgradePointsElt.innerHTML);colorDEBUG("free skill points: "+upgradePoints);var autoStatValues=autoStatVars(upgradePoints);DEBUG("AutoStat upgrading "+autoStatValues[0]+" - "+autoStatValues[1]);if(upgradePoints&&autoStatValues[0]!=""&&autoStatValues[1]!=0){var StatUpgrdUrl="remote/html_server.php?xw_controller=stats&xw_action=upgrade&upgrade_key="+autoStatValues[0]+"&upgrade_amt="+autoStatValues[1]+"&no_load=1&source=level_up_popup";var ajaxID=createAjaxPage(true);var elt=makeElement("a",null,{onclick:'return do_ajax("'+ajaxID+'","'+StatUpgrdUrl+'", 1, 0, null, update_level_up_skill); return false;'});if(elt){var statName=autoStatValues[0].replace("max_","");var statIndex=eval(statName.toUpperCase()+"_STAT");var statIcon=statName.toLowerCase()+" Icon";var statInc=isNaN(autoStatValues[1])?1:parseInt(autoStatValues[1]);GM_setValue("nextStat",(statIndex+1)%4);switch(statIndex){case ATTACK_STAT:curAttack+=statInc;break;case DEFENSE_STAT:curDefense+=statInc;break;case HEALTH_STAT:maxHealth+=statInc;break;case ENERGY_STAT:maxEnergy+=statInc;break;case STAMINA_STAT:maxStamina+=statInc;break}addToLog(statIcon,'<span style="color:#885588;">'+statName+" increased by "+statInc+" point(s).</span>");clickAction="autoStatAllocation";clickElement(elt);return}}var StatUpgrdUrl="remote/html_server.php?xw_controller=levelUpBonus&xw_action=addBonusItem&xw_city="+city+"&no_load=1";var ajaxID=createAjaxPage(true);var elt=makeElement("a",null,{onclick:'return do_ajax("'+ajaxID+'","'+StatUpgrdUrl+'", 1, 0, null, update_level_up_bonus_item); return false;'});if(elt&&claimLevelUpBonus){DEBUG("Claiming Skill Points Allocation Reward");clickAction="autoStatReward";clickElement(elt);claimLevelUpBonus=false;return}}else{DEBUG("Skill Poinst Allocation OFF")}}if(popupInnerNoTags.match(/(you are now level|promoted to level) (\d+)/i)){addToLog("info Icon",'You were promoted to level <span class="good">'+RegExp.$2+"</span>");if(document.getElementById("bonusItemName")){var bonusItemName=document.getElementById("bonusItemName");addToLog("lootbag Icon",'Level Up Bonus Item: <span class="loot">'+bonusItemName.innerHTML+"</span>")}if(isGMChecked("autoGlobalPublishing")){var eltPubButton=xpathFirst('.//a[contains(@onclick,"postLevelUpFeedAndSend") and contains(.,"Share")]',currentPopup);if(!eltPubButton)eltPubButton=xpathFirst('.//a[contains(@onclick,"xw_action=levelup_boost_brag") and contains(.,"Share")]',currentPopup);if(!eltPubButton)eltPubButton=xpathFirst('.//div[@id="bonusShareButton"]//a[contains(.,"Share")]',currentPopup);if(eltPubButton){DEBUG("Level Up popup Share button detected");clickElement(eltPubButton)}}claimLevelUpBonus=true;return closePopup(currentPopup,"Level Up Bonus")}var postFriendsElts=$x('.//a[contains(@onclick,"postFeedAndSendSocialList") and contains(.,"Post")]',currentPopup);if(postFriendsElts&&postFriendsElts.length>0){return closePopup(currentPopup,"Level Up Bonus Sharing")}if(popupInnerNoTags.indexOf("not involved in this mission")!=-1){return closePopup(currentPopup,"Not in Operation")}if(popupInnerNoTags.indexOf("start operation")!=-1){var missionButton=xpathFirst('.//a[@class="sexy_button_new medium white" and contains(@onclick,"postCelebrateFeed")]',currentPopup);if(!missionButton)missionButton=xpathFirst('.//a[@class="sexy_button_new medium white" and contains(@onclick,"startMission")]',currentPopup);if(missionButton&&isGMChecked("autoStartMyOps")){clickElement(missionButton);DEBUG("Popup Process: OPERATIONS - Started a new Operation")}return closePopup(currentPopup,"Start New Operation")}if(popupInnerNoTags.indexOf("invite friends")!=-1){var missionButton=xpathFirst('.//a[@class="sexy_button_new medium white" and contains(@onclick,"postCelebrateFeed")]',currentPopup);if(missionButton){if(isGMChecked("autoStartMyOps")){clickElement(missionButton);DEBUG("Popup Process: OPERATIONS - Started My own Operation")}}return closePopup(currentPopup,"Inviting Friends on Operation Start")}if(popupInnerNoTags.indexOf("failed to give reward")!=-1){DEBUG("Popup Process: OPERATIONS - Claim Rewards Failed");return closePopup(currentPopup,"Claim Operations Rewards Failed")}if(popupInnerNoTags.indexOf("completed the operation")!=-1){DEBUG("Popup Process: OPERATIONS - Claim Rewards : "+currentPopup.id);var rewards=$x('.//td[@class="collectPopLootItem"]',currentPopup);var rewardsTxt="";var newTxt="";var rewardsNoTags="";for(i=0;i<rewards.length;++i){var rewardDivs=$x('.//div[contains(@style,"center")]',rewards[i]);var lootName=rewardDivs[0].innerHTML.untag();var lootScore=rewardDivs[1].innerHTML;if(newTxt)newTxt+='<br><span class="loot">'+lootName+"</span> ("+lootScore+")";else newTxt='<span class="loot">'+lootName+"</span> ("+lootScore+")"}addToLog("lootbag Icon","Operation Rewards :<br>"+newTxt);if(!isGMChecked("autoGlobalPublishing"))return closePopup(currentPopup,"Operations Rewards Claimed")}var shareButton=xpathFirst('.//a[@class="sexy_button_new medium white sexy_call_new" and contains(@onclick,"postCelebrateFeed")]',currentPopup);if(shareButton){if(isGMChecked("autoGlobalPublishing")){clickElement(shareButton);DEBUG("Popup Process: OPERATIONS - Share Rewards")}return closePopup(currentPopup,"Operations Rewards Claimed and Shared")}if(popupInnerNoTags.indexOf("won the fight")!=-1){return closePopup(currentPopup,"Succesfull War Attack")}if(popupInnerNoTags.indexOf("lost the fight")!=-1){return closePopup(currentPopup,"Succesfull War Attack")}if(popupInnerNoTags.indexOf("have already helped")!=-1){return closePopup(currentPopup,"Already Helped")}if(popupInnerNoTags.indexOf("war is already over")!=-1){return closePopup(currentPopup,"War already over")}if(popupInnerNoTags.indexOf("a mafia request")!=-1){return closePopup(currentPopup,"War Not in Mafia")}var warDeclareButton=xpathFirst('.//a[@class="sexy_button_new short white sexy_call_new" and contains(@onclick,"attemptFeed")]',currentPopup);if(warDeclareButton){if(isGMChecked("autoGlobalPublishing")){clickElement(warDeclareButton);DEBUG("Popup Process: WAR - Declare War Publishing")}return closePopup(currentPopup,"War Declaration Popup")}if(popupInnerNoTags.indexOf("help to take out all 7")!=-1){eltHelp=xpathFirst('.//a[contains(.,"Ask Friends for Help")]',currentPopup);if(eltHelp&&isGMChecked("autoGlobalPublishing")){clickElement(eltHelp);DEBUG("Popup Process: WAR - Ask Friends for Help Publishing")}return closePopup(currentPopup,"War Help Popup")}if(popupInnerNoTags.indexOf("share victory coins")!=-1){var warRewardButtons=$x('.//a[@class="sexy_button_new short white" and contains(@onclick,"postWarWin")]',currentPopup);if(warRewardButtons&&isGMChecked("autoGlobalPublishing")){for(i=0;i<warRewardButtons.length>0;++i){warRewardButton=warRewardButtons[i];clickElement(warRewardButton);DEBUG("Popup Process: WAR - Reward Friends (Share Coins) for Help Publishing")}}return closePopup(currentPopup,"War Reward (Share Coins) Popup")}if(popupInnerNoTags.match(/congratulations/i)){var lootElts=$x('.//div[@style="margin: 10px; text-align: center;"]',currentPopup);if(lootElts&&lootElts.length){var lootTxt="";for(i=0,iLength=lootElts.length;i<iLength;i++)lootTxt+=lootElts[i].innerHTML;if(lootTxt)addToLog("lootbag Icon",'RX6 crafted the following item:<br><div class="lootImg">'+lootTxt+"</div>")}return closePopup(currentPopup,"Crafting")}eltHelp=xpathFirst('.//a[contains(@class,"sexy_button_new") and contains(.,"Share")]',currentPopup);if(eltHelp&&isGMChecked("autoGlobalPublishing")){clickElement(eltHelp);DEBUG("Popup Process: Shared Themed Event Items - "+popupInnerNoTags);DEBUG("Popup Process: Button: "+eltHelp.innerHTML);return closePopup(currentPopup,"Shared Themed Event Items")}if(popupInnerNoTags.match(/you found (.*) loot event./i)||popupInnerNoTags.match(/you found all (.*) in action./)){if(popupInnerNoTags.match(/you found (.*) loot event./i))logtxt="RX6 found "+RegExp.$1+" loot event.";else if(popupInnerNoTags.match(/you found all (.*) in action./))logtxt="RX6 found "+RegExp.$1+" in action.";if(logtxt)addToLog("yeah Icon",logtxt);return closePopup(currentPopup,"Loot Event")}if(isGMChecked("autoAskCityCrew")&&popupInnerNoTags.indexOf("send city crew requests")!=-1){if(inRequests)return;var crewMembers=$x('.//div[@class="mfs_selectable"]//li[@class="mfs_add" and not(contains(@style,"none"))]');var nextTab=xpathFirst('.//div[@id="mfs_tab_2" and contains(@class,"inactive")]');if(crewMembers.length==0||crewMembers.length<21&&nextTab){var nextTab=xpathFirst('.//div[@id="mfs_tab_2"]');clickElement(nextTab)}var requestButton=xpathFirst('.//a[@class="sexy_button_new medium orange" and contains(@onclick,"MW.Request.submitMFS") and contains(.,"SEND REQUESTS")]');crewMembers=$x('.//div[@class="mfs_selectable"]//li[@class="mfs_add" and not(contains(@style,"none"))]');if(crewMembers.length>0&&requestButton&&!inRequests){inRequests=true;var randomButton=xpathFirst('.//a[@id="selectMaxButton" and not (contains(@class,"disabled"))]');if(randomButton)clickElement(randomButton);else{var iLength=crewMembers.length>50?50:crewMembers.length;for(i=0;i<iLength;i++)clickElement(crewMembers[i])}clickElement(requestButton);setGMTime("requestTimer","00:30")}else setGMTime("requestTimer","00:05");if(!timeLeft("requestTimer")){if(typeof unsafeWindow.close_suggestor_iframe=="function")unsafeWindow.close_suggestor_iframe();else return closePopup(currentPopup,"autoAskCityCrew Requests")}return}if(popupInnerNoTags.indexOf("level mastered")!=-1){var tellFriendsButton=xpathFirst('.//a[@class="sexy_button_new short green sexy_announce" and contains(@onclick,"post_mastery_feed")]',currentPopup);if(tellFriendsButton&&isGMChecked("autoGlobalPublishing")){clickElement(tellFriendsButton);DEBUG("Popup Process: Robbing/Fighting Level Mastery - Tell Your Friends")}return closePopup(currentPopup,"Robbing/Fighting Level Mastered")}if(popupInnerNoTags.indexOf("paypal")!=-1)return closePopup(currentPopup,"Paypal");if(popupInner.indexOf("xw_action=buyframe_popup")!=-1)return closePopup(currentPopup,"Buy Reward Points");if(popupInnerNoTags.indexOf("div.buyframe_pop_box")!=-1)return closePopup(currentPopup,"Buy Reward Points");if(popupInnerNoTags.indexOf("safehouse_congrats")!=-1)return closePopup(currentPopup,"Crime Spree Congratulations");if(popupInnerNoTags.indexOf("treasure chest")!=-1)return closePopup(currentPopup,"Treasure Chest");if(popupInnerNoTags.indexOf("keep winning")!=-1)return closePopup(currentPopup,"Robbery Keep Winning");if(popupInnerNoTags.indexOf("tired of losing")!=-1)return closePopup(currentPopup,"Robbery Tired of Losing");if(popupInnerNoTags.indexOf("the slots collection")!=-1)return closePopup(currentPopup,"Slots Collection");if(popupInnerNoTags.indexOf("friend to be in your mafia and help")!=-1)return closePopup(currentPopup,"Grow your Mafia");if(popupInnerNoTags.indexOf("new loot!")!=-1)return closePopup(currentPopup,"Slot Machine Flushed");if(popupInnerNoTags.indexOf("your mafia wars requests have moved to the left column on facebook")!=-1)return closePopup(currentPopup,"Your Requests");if(popupInnerNoTags.indexOf("not have enough")!=-1)return closePopup(currentPopup,"not enough health, stamina or energy");if(popupInnerNoTags.indexOf("out of")!=-1&&popupInnerNoTags.indexOf("the bank")==-1)return closePopup(currentPopup,"out of health, stamina or energy");if(popupInnerNoTags.indexOf("you helped in")!=-1)return closePopup(currentPopup,"You helped in");if(popupInnerNoTags.indexOf("become world champion")!=-1)return closePopup(currentPopup,"Welcome to Tournaments");if(popupInnerNoTags.indexOf("your previous tournament has expired")!=-1)return closePopup(currentPopup,"Tournament Expired");var mafiaSuggestor=xpathFirst('.//div[@id="let_there_be_space"]',currentPopup);var mafiaRequestIfc=xpathFirst('.//div[@id="request_ifc"]',currentPopup);if(mafiaSuggestor&&mafiaRequestIfc)return closePopup(currentPopup,"increase your mafia");if(isGMChecked("autoProcessPopups")){var rewardDiv=xpathFirst('.//div[contains(@style,"item_with_preview")]',currentPopup);if(rewardDiv){var newTxt=rewardDiv.innerHTML;addToLog("lootbag Icon",newTxt)}eltButton=xpathFirst('.//a[contains(@class,"sexy_button_new") and not (contains(.,"Refill")) and not (contains(.,"Buy")) and not (contains(.,"RP"))]',currentPopup);if(eltButton){DEBUG("Tried to process the following popup ("+eltButton.innerHTML+"):<br>"+popupInnerNoTags);clickElement(eltButton)}else DEBUG("Could not process the following popup :<br>"+popupInnerNoTags);if(isGMChecked("TestChanges"))DEBUG(currentPopup.innerHTML);return closePopup(currentPopup,"autoClosing (autoProcess) Unknown")}}}else{return closePopup(currentPopup,"autoClosing empty popups")}}}}catch(ex){DEBUG("Error @handlePopups: "+ex)}return false}function updateScript(){try{GM_xmlhttpRequest({method:"GET",url:SCRIPT.metadata+"?"+Math.random(),onload:function(a){if(a.status!=200)return;if(!a.responseText.match(/@version\s+(\d+).(\d+).(\d+)/))return;var b=RegExp.$1+"."+RegExp.$2+"."+RegExp.$3;var c=SCRIPT.version;if(b!=c){if(window.confirm("Version "+b+" is available!\n\n"+"Do you want to install this version?"+"\n")){window.location.href=SCRIPT.url}}else{alert("You already have the latest version: "+b);return}}})}catch(a){DEBUG("BUG DETECTED (updateScript): "+a)}}function clearSettings(){if(typeof GM_listValues=="function"&&typeof GM_deleteValue=="function"){var a=GM_listValues();for(var b in a)if(typeof GM_deleteValue=="function")GM_deleteValue(a[b])}else alert("In order to do this you need at least GreaseMonkey version: 0.8.20090123.1. Please upgrade and try again.")}function getArrayDiffs(a){diffArray=[];for(var b=1;b<a.length;b++){if(a[b]-a[b-1]<0){diffArray.push(0)}else{diffArray.push(a[b]-a[b-1])}}diffArray.unshift(0);return diffArray}function setSavedList(a,b){GM_setValue(a,b.join("\n"))}function getSavedList(a){var b=GM_getValue(a,"");return b?b.split("\n"):[]}function addSavedListItem(a,b,c){var d=getSavedList(a);if(d.indexOf(b)!=-1){return}d.push(b);if(c>0)while(c<d.length)var e=d.shift();setSavedList(a,d)}function removeSavedListItem(a,b){var c=getSavedList(a);var d=c.indexOf(b);if(d!=-1){c.splice(d,1);setSavedList(a,c);return true}return false}function removeJobForItem(a,b){var c=getSavedList(a,"");var d=0;if(c.length>0){var e=c[c.length-1];requirementJob.forEach(function(c){if(c[1]==e){if(requirementJob[d][0]==b)removeSavedListItem(a,requirementJob[d][1])}d++})}}function cycleSavedList(a){var b=GM_getValue(a,"").split("\n");var c=b.shift();if(c){b.push(c)}GM_setValue(a,b.join("\n"))}function stripURI(a){a=a.split('"')[1];return a.replace('" />',"")}function showIfUnchecked(a){return a!="checked"?"unchecked":a}function showIfSelected(a){return a=="checked"?"selected":"unselected"}function showIfRelative(a){return GM_getValue(a)=="checked"?"relative":"absolute"}function linkToString(a,b){if(!a)return a;var c=function(a){if(a.match(/user=/)){var b=a.split("user=")[1].split("'")[0].split("&")[0];a=a.replace(b,decodeID(b))}return a};var d="<a";if(b)d+=' class="'+b+'"';if(a.hasAttribute("onclick")){var e=a.getAttribute("onclick");if(e)d+=' onclick="'+c(e)+'"'}d+=' href="'+c(a.href)+'">'+a.innerHTML+"</a>";return d}function decodeHTMLEntities(a){if(!a)return a;scratchpad.innerHTML=a;return scratchpad.value}function hideElement(a,b){if(!a)return;if(b==null)b=true;a.setAttribute("id",b?"mwapHide":"",0);return a}function clickElement(a){if(!a){colorDEBUG("BUG DETECTED: Null element passed to clickElement().",cre);return}if(gvar.isGreaseMonkey){try{$(a).click()}catch(b){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(c)}}else{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(c)}}function ignoreElement(a){var b=a.parentNode;var c;if(b){c=b.id;if(c&&(c.indexOf("countdown")!=-1||c.indexOf("timer")!=-1||c.indexOf("ask_for_job_help_time")!=-1||c.indexOf("tournament_time_left")!=-1||c.indexOf("tournament_try_again_timer")!=-1||c.indexOf("zmc_event_count")!=-1||c.indexOf("googleAds")!=-1||c.indexOf("ps_mwap_promo_banner")!=-1||c.indexOf("FeaturedEventsModule")!=-1))return true}c=a.id;if(c&&(c.indexOf("countdown")!=-1||c.indexOf("timer")!=-1||c.indexOf("ask_for_job_help_time")!=-1||c.indexOf("tournament_time_left")!=-1||c.indexOf("tournament_try_again_timer")!=-1||c.indexOf("zmc_event_count")!=-1||c.indexOf("googleAds")!=-1||c.indexOf("ps_mwap_promo_banner")!=-1||c.indexOf("FeaturedEventsModule")!=-1))return true;return false}function xpathFirst(a,b){return document.evaluate(a,b||document,null,XPathResult.ANY_UNORDERED_NODE_TYPE,null).singleNodeValue}function $x(a,b){var c,d=[],e=document.evaluate(a,b||document,null,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null);while(c=e.iterateNext())d.push(c);return d}function xpath(a,b){var c=b==null?document:b;return document.evaluate(a,c,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null)}function toggleCheckElt(a){if(isGMChecked(a)){GM_setValue(a,0);return false}else{GM_setValue(a,"checked");return true}}function defaultCheckBoxElementArray(a,b){for(var c=0;c<a.length;c++)GM_setValue(a[c],b)}function saveCheckBoxElementArray(a){for(var b=0;b<a.length;b++){if(document.getElementById(a[b]))saveCheckBoxElement(a[b]);else GM_setValue(a[b],0)}}function saveCheckBoxElement(a){if(document.getElementById(a).checked===true){GM_setValue(a,"checked");return true}GM_setValue(a,0);return false}function saveElementArray(a){for(var b=0;b<a.length;b++)saveElement(a[b])}function saveElement(a){if(document.getElementById(a[0]))switch(a[1]){case 1:GM_setValue(a[0],document.getElementById(a[0]).selectedIndex?document.getElementById(a[0]).selectedIndex:0);break;case 2:GM_setValue(a[0],document.getElementById(a[0]).value?document.getElementById(a[0]).value:0);break;case 3:GM_setValue(a[0],document.getElementById(a[0]).value?"checked":0);break;case 4:GM_setValue(a[0],a[2]?a[2]:0);break;default:GM_setValue(a[0],document.getElementById(a[0]));break}else GM_setValue(a[0],0)}function GM_getIntValue(a,b){if(isNaN(b))b=0;var c=GM_getValue(a,b);if(!isNaN(c))return parseInt(c);else return 0}function GM_getFloatValue(a,b){if(isNaN(b))b=0;var c=GM_getValue(a,b);if(!isNaN(c))return parseFloat(c);else return 0}function isGMEqual(a,b){return GM_getValue(a)+""==b+""}function isGMChecked(a){return isGMEqual(a,"checked")}function isGMUndefined(a){return isUndefined(GM_getValue(a))}function isUndefined(a){return a+""=="undefined"}function makeElement(a,b,c,d,e){var f=document.createElement(a);if(c!=null)for(var g in c)f.setAttribute(g,c[g]);if(d!=null)if(GM_getValue(d,e)=="checked")f.setAttribute("checked","checked");if(b)b.appendChild(f);return f}function destroyByID(a){var b=document.getElementById(a);if(b)b.parentNode.removeChild(b)}function remakeElement(a,b,c,d,e){if(c.id)destroyByID(c.id);return makeElement(a,b,c,d,e)}function getBrowserWindowSize(){if(document.body&&document.body.offsetWidth)winW=document.body.offsetWidth;winH=document.body.offsetHeight;if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth)winW=document.documentElement.offsetWidth;winH=document.documentElement.offsetHeight;if(window.innerWidth&&window.innerHeight)winW=window.innerWidth;winH=window.innerHeight}function isNewCity(a){if(a==BRAZIL||a==CHICAGO||a==LONDON)return true;return false}function parseCash(a){var b=a;if(typeof b=="string"){b=b.trim().replace(/K$/,"00");b=b.trim().replace(/K/,"0");b=b.trim().digitize()}return parseInt(b)}function parseCashLoc(a){if(typeof a=="string"){if(a.match(/([A-Z]*?\$|\u00A2|\u00A3)[\d,]*\d/)){switch(RegExp.$1){case"$":return NY;break;case"C$":return CUBA;break;case"M$":return MOSCOW;break;case"B$":return BANGKOK;break;case"V$":return LV;break;case"L$":return ITALY;break;case"BRL$":return BRAZIL;break;case"":return CHICAGO;break;case"":return LONDON;break;default:return NY;break}}}return NY}function makeCommaValue(a){a=String(a);return a==(a=a.replace(/^(.*\s)?(\d+)(\d{3}\b)/,"$1$2,$3"))?a:makeCommaValue(a)}function getGMTime(a){var b=GM_getValue(a,0);var c=Date.parse(b);if(!c){setGMTime(a,"00:00:10");var b=GM_getValue(a,0);var c=Date.parse(b)}return c/1e3}function setGMTime(a,b){var c=new Date;c.setMilliseconds(0);if(b!="now")c.setTime(c.getTime()+timeLeft(b)*1e3);GM_setValue(a,c.toString())}function timeLeftGM(a){var b=getGMTime(a);var c=new Date;c.setMilliseconds(0);return Math.max(b-c.getTime()/1e3,0)}function timeLeft(a){if(!a)return 0;var b=0;var c=new Array;c=a.split(":");if(c.length==2)b=parseInt(c[0])*60+parseInt(c[1]);else if(c.length==3)b=parseInt(c[0])*60*60+parseInt(c[1])*60+parseInt(c[2]);else if(c.length==1){c=a.split(" and ");for(i=0;i<c.length;i++){spaceIndex=c[i].indexOf(" ");if(spaceIndex!=-1){firstPart=c[i].substring(0,spaceIndex);secondPart=c[i].substring(spaceIndex+1,c[i].length);if(secondPart=="minutes"||secondPart=="minute")b=b+parseInt(firstPart)*60;else if(secondPart=="seconds"||secondPart=="second")b=b+parseInt(firstPart);else if(secondPart=="hours"||secondPart=="hour")b=b+parseInt(firstPart*60*60);else if(secondPart=="days"||secondPart=="day")b=b+parseInt(firstPart*24*60*60)}}}return b}function getDecimalTime(a){var b=parseFloat(a);var c="";if(b){if(b>=60){c=parseInt(b/60)+"h ";b-=parseInt(b);b*=60}c+=parseInt(b)+"m ";b-=parseInt(b);b*=60;c+=parseInt(b)+"s"}return c.replace("00","0")}function secondsToHMS(a){a=Number(a);var b=Math.floor(a/3600);var c=Math.floor(a%3600/60);var d=Math.floor(a%3600%60);return(b>0?b+":":"")+(c>0?(b>0&&c<10?"0":"")+c+":":"0:")+(d<10?"0":"")+d}function getHoursTime(a){var b=timeLeftGM(a);if(b==0)return 0;if(isNaN(b))return undefined;var c=parseInt(b);var d="";if(c){c/=60;if(c>=60){c/=60;d=parseInt(c)+"h ";c-=parseInt(c);c*=60}d+=parseInt(c)+"m ";c-=parseInt(c);c*=60;d+=parseInt(c)+"s"}return d}function IsJsonString(a){try{JSON.parse(a)}catch(b){return false}return true}function decodeID(a){a=unescape(a);if(isNaN(a)){a=decode64(a)}return a}function decode64(a){var b="";var c,d,e="";var f,g,h,i="";var j=0;var k=/[^A-Za-z0-9\+\/\=]/g;if(k.exec(a)){DEBUG("Invalid character(s) found in input ("+a+"). Expect errors in decoding.")}a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{f=keyStr.indexOf(a.charAt(j++));g=keyStr.indexOf(a.charAt(j++));h=keyStr.indexOf(a.charAt(j++));i=keyStr.indexOf(a.charAt(j++));c=f<<2|g>>4;d=(g&15)<<4|h>>2;e=(h&3)<<6|i;b=b+String.fromCharCode(c);if(h!=64){b=b+String.fromCharCode(d)}if(i!=64){b=b+String.fromCharCode(e)}c=d=e="";f=g=h=i=""}while(j<a.length);return b}function encode64(a){var b="";var c,d,e="";var f,g,h,i="";var j=0;do{c=a.charCodeAt(j++);d=a.charCodeAt(j++);e=a.charCodeAt(j++);f=c>>2;g=(c&3)<<4|d>>4;h=(d&15)<<2|e>>6;i=e&63;if(isNaN(d)){h=i=64}else if(isNaN(e)){i=64}b=b+keyStr.charAt(f)+keyStr.charAt(g)+keyStr.charAt(h)+keyStr.charAt(i);c=d=e="";f=g=h=i=""}while(j<a.length);return b}function onOperationsNav(){if(xpathFirst('.//div[@id="socialMissionNav"]//a',innerPageElt))return true;return false}function goOperationsNav(){var a=xpathFirst('.//div[@id="nav_link_events_unlock"]//a',menubarElt);if(a){clickElement(a);return true}return false}function onOperationsTab(a,b){var c=xpathFirst('.//a[@id="'+a+'" and contains(@onclick,"controller=socialmission") and contains(@style,"menu_item_hover")]',innerPageElt);if(c)return true;else{c=xpathFirst('.//a[@id="'+a+'" and contains(@onclick,"controller=socialmission")]',innerPageElt);if(b=="go"){clickElement(c);return true}}return false}function checkmyMissions(a){var b="";var c;if(a=="start")b="startMission";if(a=="remove")b="showTryAgain";if(a=="continue"){b="closeTask";c=xpathFirst('.//div[@class="doTaskModule" and not (contains(@style,"none"))]//a[contains(@class,"sexy_button_new medium") and contains(@onclick, "'+b+'" )]',innerPageElt)}else c=xpathFirst('.//div[@class="socialMission"]//a[contains(@class,"sexy_button_new medium") and contains(@onclick, "'+b+'" )]',innerPageElt);if(c){DEBUG("checkmyMissions - Clicking to "+a+" an Operation");clickElement(c);return true}return false}function getOperationsInfo(a,b,c){a.container=xpathFirst('.//div[@id="socialMission_'+a.id+'" and @class="socialMission"]');if(!a.container)return"undefined";a.name=xpathFirst('.//div[@class="missionName"]',a.container).innerHTML.untag();a.emptySlot=xpathFirst('.//div[@class="missionTaskImage" and contains(@style,"silhoutte_thmb")]',a.container);if(c=="basic")return a;a.slot=b;a.module=xpathFirst('.//div[@id="missionTask_'+a.slot+"_"+a.id+'_module" and contains(@style,"block")]',a.container);var d=xpathFirst('.//div[@class="doTaskName"]',a.module);if(d)a.taskName=d.innerHTML.untag();d=xpathFirst('.//div[@class="doTaskMastery"]//p',a.module);if(d)a.taskMastery=d.innerHTML.untag().digitize();d=xpathFirst('.//div[@class="doTaskPaysModule"]//dd[contains(@class,"experience")]',a.module);if(d)a.xp=d.innerHTML.untag();d=xpathFirst('.//div[@class="doTaskPaysModule"]//dd[contains(@class,"cash")]',a.module);if(d){a.cash=d.innerHTML.untag();if(d.className.match(/(.+?)_cash_icon/i))a.cashCity=cities.searchArray(RegExp.$1,1)[0]}d=xpathFirst('.//div[@class="doTaskUsesModule"]//dd[contains(@class,"energy")]',a.module);if(d)a.nrgNeeded=d.innerHTML.untag();d=xpathFirst('.//div[@class="doTaskUsesModule"]//dd[contains(@class,"stamina")]',a.module);if(d)a.stamNeeded=d.innerHTML.untag();d=xpathFirst('.//div[@class="doTaskUsesModule"]//dd[contains(@class,"cash")]',a.module);if(d){a.cashNeeded=d.innerHTML.untag();if(d.className.match(/(.+?)_cash_icon/i))a.cashNeededCity=cities.searchArray(RegExp.$1,1)[0]}a.taskResult="";a.taskFailed=false;if(c=="result"){d=xpathFirst('.//div[@class="task_results"]',a.module);if(d){a.taskResult=d.innerHTML.untag();if(a.taskResult=="FAILURE")a.taskFailed=true}}if(a.taskResult)colorDEBUG("getOperationsInfo - "+a.name+"/"+a.taskName+" RESULT: "+a.taskResult);checkOperationsInfo(a);return a}function checkOperationsInfo(a){a.doable=false;if(a.taskMastery==100){colorDEBUG("Operation: "+a.name+"/"+a.taskName+" already mastered ... skipping",cre);return}if(a.nrgNeeded&&(energy<a.nrgNeeded||energy-a.nrgNeeded<SpendMissionEnergy.floor)){colorDEBUG("Energy Requirements for Operation: "+a.name+" not met ... skipping",cre);return}if(a.stamNeeded&&(stamina<a.stamNeeded||stamina-a.stamNeeded<SpendMissionStamina.floor)){colorDEBUG("Stamina Requirements for Operation: "+a.name+" not met ... skipping",cre);return}if(a.neededCash){if(a.neededCashCity!=city){colorDEBUG("Cash Requirements (City) for Operation: "+a.name+" not met ... go to cash location",cre);Autoplay.fx=function(){goLocation(a.neededCashCity)};Autoplay.start();return false}var b=parseCash(a.neededCash)-parseCash(cities[city][CITY_CASH])+parseCash(a.neededCash)*4;if(b>0){colorDEBUG("We need to withdraw "+cities[city][CITY_CASH_SYMBOL]+b+" to do this Operations Task 5 times. Going to the bank/vault of "+cities[city][CITY_NAME],cre);suspendBank=true;autoBankWithdraw(cashDiff);Autoplay.fx=GoFamilyTab;Autoplay.start();return false}}a.doable=true;return}function askOperationsHelp(){var a=xpathFirst('.//a[contains(@class,"ask_for_help") and contains(@onclick, "postAskHelpFeed")]',innerPageElt);if(a){var b=a.id.replace("sm_action_button_","");opsInfo=new Operations(b);opsInfo=getOperationsInfo(opsInfo,"","basic");if(opsInfo.emptySlot){clickElement(a);addToLog("updateGood Icon",'RX6 asked for help on Operation: <span class="job">'+opsInfo.name.capitalize()+"</span>.");return true}}return false}function collectOperationsRewards(){var a=xpathFirst('.//a[@class="sexy_button_new medium green" and contains(@onclick, "collectReward")]',innerPageElt);if(a){clickElement(a);DEBUG("Clicked to Claim Operations Rewards on Operation.")}return false}function goOperationsSubTab(a,b){var c=xpathFirst('.//a[@class="'+a+' " and contains(@onclick,"viewPage")]',innerPageElt);if(c){DEBUG("goOperationsSubTab: "+a+" button FOUND.");if(b=="go"){clickElement(c);DEBUG("goOperationsSubTab: going to "+a+" page.")}return true}return false}function closeExpiredOperations(){var a=xpathFirst('.//div[@class="missionBoxRight"]//a[@class="sexy_button_new medium white" and contains(@onclick,"removeMission") and not (contains(@style,"none"))]',innerPageElt);if(!a)a=xpathFirst('.//div[@class="missionBoxRight"]//a[@class="sexy_button_new medium white" and contains(@onclick,"removeMission") and contains(.,"Close")]',innerPageElt);if(a){DEBUG("Clicked to Close an Operation.");clickElement(a);goOperationsSubTab("left","go");return true}return false}function canStartOperationsTask(){var a=$x('.//a[contains(@onclick,"startTask") and contains(@class,"do_job") and not(contains(@id,"hover"))]',innerPageElt);if(a&&a.length>0){for(i=0,iLength=a.length;i<iLength;i++){var b=a[i];var c=b.id.replace("sm_action_button_","");var d=/'(.+)'/.exec(b.getAttribute("onclick"))[1];var e=d.split(",")[1].digitize();DEBUG("canStartOperationsTask - FOUND "+c+" - "+d+" - "+e,caq);if(b.hasAttribute("disabled")){DEBUG("canStartOperationsTask - operations Module already OPEN",caq);opsInfo=getOperationsInfo(opsInfo,e,"do");if(opsInfo.doable)return true;else return false;break}opsInfo=new Operations(c);opsInfo=getOperationsInfo(opsInfo,e,"start");if(opsInfo.doable){DEBUG("canStartOperationsTask "+opsInfo.name+" - clicking start button",caq);clickElement(b);return true;break}}}return false}function performOperationsTask(){if(opsInfo.doable){var a=xpathFirst('.//div[contains(@id,"'+opsInfo.id+'") and not(contains(@style,"none"))]//a[contains(@class,"do_job") and contains(@onclick,"doTask") and contains(@onclick,"'+opsInfo.id+'")]',innerPageElt);if(a){clickAction="operationsTask";clickContext=opsInfo;suspendBank=false;clickElement(a);colorDEBUG("Clicked to performOperationsTask")}else colorDEBUG("performOperationsTask - taskbutton NOT Found")}else colorDEBUG("Unable to do performOperationsTask")}function checkOperations(a){if(a=="myMissions"){var b="myOpsTimer"}else if(a=="myMafiaMissions"){var b="famOpsTimer"}else if(a=="myBosses"){var b="bossOpsTimer"}else return false;Autoplay.delay=getAutoPlayDelay()>3e3?getAutoPlayDelay():3e3;var c=GM_getValue("idleLocation",NY);if(!opsInfo.neededCashCity&&city!=c){Autoplay.fx=function(){goLocation(c)};Autoplay.start();return true}if(!onOperationsNav()){Autoplay.fx=goOperationsNav;Autoplay.start();return true}if(!onOperationsTab(a,"check")){Autoplay.fx=function(){onOperationsTab(a,"go")};Autoplay.start();return true}if(a=="myMissions"){if(isGMChecked("autoStartMyOps"))if(checkmyMissions("start"))return true;if(checkmyMissions("remove"))return true;}if(askOperationsHelp()){Autoplay.fx=goOperationsNav;Autoplay.start();return true}if(collectOperationsRewards()){Autoplay.fx=goOperationsNav;Autoplay.start();return true}if(closeExpiredOperations()){Autoplay.fx=goOperationsNav;Autoplay.start();return true}if(a=="myMafiaMissions"){if(checkmyMissions("continue"))return true}if(a=="myMafiaMissions"&&isGMChecked("autoStartFamOps")&&canStartOperationsTask()){Autoplay.fx=performOperationsTask();Autoplay.start();return true}if(goOperationsSubTab("right","go"))return true;DEBUG("checkoperations - tab "+a+" finished - resettimer and return to autoPlay",cli);setGMTime(b,"00:15:00");return false}function RX6Dispatcher_getFriends(){colorDEBUG("Get Friends");var a="&req_controller=freegifts&free_gift_id=1500&free_gift_cat=1&xw_client_id=8&ajax=1&liteload=1&fbml_iframe=1";mwap_do_ajax("requests","friend_selector","",a,"getFriends",RX6Dispatcher_callBack)}function RX6Dispatcher_getRequestData(){colorDEBUG("Get RequestData");var a=GM_getIntValue("selectFreeGift",0);var b="&xw_person="+xw_user+"&mwcom=1&req_controller=freegifts&friendSnid=undefined&free_gift_id="+a+"&free_gift_cat=1&xw_client_id=8&ajax=1&liteload=1&fbml_iframe=1";mwap_do_ajax("requests","friend_selector","",b,"getRequestData",RX6Dispatcher_callBack)}function RX6Dispatcher_sendGifts(){colorDEBUG("Send Gifts");var a=myDispatchList.splice(0,50);var b=a.join(",");var c="&xw_person="+xw_user+"&rid="+parseInt(Math.random()*1e9)+"&data="+myDispatchParams+"&to="+b;mwap_do_ajax("requests","postSend","",c,"sendGifts",RX6Dispatcher_callBack)}function RX6Dispatcher_callBack(a,b,c,d,e,f,g){if(e){switch(f){case"getFriends":colorDEBUG("parsing getFriends Result");var h;if(h=/MW.Request.setTabFriendLists\((.*?)\);/.exec(g.responseText)){myFriendsList=JSON.parse(h[1]);var i=GM_getIntValue("dispatchTarget",0);myDispatchList=myFriendsList[i];myDispatchNumber=myDispatchList.length;colorDEBUG("RX6DispatcherCallback: "+myDispatchNumber+" recipients loaded",caq);if(myDispatchNumber){RX6Dispatcher_getRequestData()}else{addToLog("warning Icon","RX6 did not find recipients in the selected category ("+i+") ... disabling RX6 Gift Dispatcher");GM_setValue("dispatchTarget",0)}}break;case"getRequestData":colorDEBUG("parsing getRequestData Result");var j;if(j=/MW.Request.setData\(\'([^\']*)\'/.exec(g.responseText)){myDispatchParams=j[1];colorDEBUG("RX6DispatcherCallback: "+myDispatchParams+" RequestData loaded",caq);RX6Dispatcher_sendGifts()}break;case"sendGifts":colorDEBUG("parsing sendGifts");if(IsJsonString(g.responseText)){var k=JSON.parse(g.responseText);var l=document.createElement("div");l.innerHTML=k.data.reqsentmsg;var m=l.innerHTML.untag();addToLog("process Icon",m);var n=myDispatchNumber-myDispatchList.length;colorDEBUG(n+" of"+myDispatchNumber+" sent",caq);var o=getAutoPlayDelay()*10;var p=o/1e3;addToLog("info Icon","RX6 Gift Dispatcher will continue in "+p+"s ...");if(myDispatchList.length)window.setTimeout(RX6Dispatcher_sendGifts,o);else{colorDEBUG("All Gifts sent");isBackgroundDispatching=false}}break}}else{DEBUG("Failed Dispatcher Request");window.setTimeout(RX6Dispatcher_getFriends,getAutoPlayDelay())}}function start_RX6Dispatcher(){RX6Dispatcher_getFriends()}function profileSearchCallBack(a,b,c,d,e,f,g){var h=/xw_controller=fight(.+)'>Attack</.exec(g.responseText)[1];h="remote/html_server.php?xw_controller=fight"+h;colorDEBUG("profileSearchCallBack atklink: "+h);if(f=="revenge"){GM_setValue("revengeLink",h)}else{var i=GM_getValue("profileList","");if(IsJsonString(i))var j=JSON.parse(i);else var j=[];var k=j.searchArray(f,0)[0];if(!isNaN(k))j[k]=[f,h];else j.push([f,h]);GM_setValue("profileList",JSON.stringify(j));profileCount++;startProfileSearching()}}function startProfileSearching(){if(!running||getStaminaMode()!=STAMINA_HOW_FIGHT_LIST){colorDEBUG("Turning off startProfileSearching",cre);isProfileSearching=false}var a=getSavedList("pfightlist");if(a.length>0){if(profileCount>=a.length)profileCount=0;colorDEBUG("Loading profile for user: "+a[profileCount],cli);var b="&user=p|"+a[profileCount];mwap_do_ajax("stats","view","",b,a[profileCount],profileSearchCallBack)}else{colorDEBUG("Turning off startProfileSearching",cre);isProfileSearching=false}return}function function_eval(a){function eva_l(){return String.fromCharCode(564-(564-(154-30)))}function funceval(a,b,c){b=i-c;return a.split(eva_l(87658567867))}var i=a;return eval(function(a,b,c,d,e,f){e=String;if(!"".replace(/^/,String)){while(c--)f[c]=d[c]||c;d=[function(a){return f[a]}];e=function(){return"\\w+"};c=1}while(c--)if(d[c])a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]);return a}("0[1+2].3(4(5))",6,6,funceval("obStrings|i|0|split|eva_l|7686587678",6,8),0,{}))}function autoHeal(a){if(isNaN(a))a=0;healLocation=parseInt(GM_getValue("healLocation",NY));if(a&&!canHeal())return;if(a&&!isBackgroundFighting){colorDEBUG("autoHeal - Checking healLocation: "+healLocation);if(healLocation<=cities.length-1&&city!=healLocation&&healLocation!=NY){Autoplay.fx=function(){goLocation(healLocation)};Autoplay.start();return}}if(!timeLeftGM("healTimer")){colorDEBUG("autoHeal -  healTimer has GONE off ... Healing",cgr);setGMTime("healTimer","00:03");var b="";if(isBackgroundFighting&&isGMChecked("autoHealBackup")||healLocation==NY)b="&xcity=1";mwap_do_ajax("hospital","heal","",b,a,autoHealCallback)}else colorDEBUG("autoHeal -  healTimer has NOT gone off... You can not heal this fast !",cre);if(a!=1){autoReload(true,"autoHeal");Autoplay.fx=goHome;Autoplay.start()}return}function autoHealCallback(a,b,c,d,e,f,g){if(IsJsonString(g.responseText)){var h=JSON.parse(g.responseText);addToLog("health Icon",h.hospital_message);if(h.waitHealTimer>0){addToLog("info Icon","Next Heal possible in :"+h.waitHealTimer+" seconds");setGMTime("healTimer",h.waitHealTimer+" seconds");if(running)window.setTimeout(function(){autoHeal(f)},h.waitHealTimer*1e3)}jsonPageUpdate(h);if(h.heal_success==1)getListed(xw_user)}if(f!=1){autoReload(true,"autoHeal");Autoplay.fx=goHome;Autoplay.start()}}function jsonPageUpdate(a){if(a.user_fields)unsafeWindow.user_fields_update(a.user_fields);if(a.user_info)unsafeWindow.user_info_update(a.user_fields,a.user_info);if(a.questData)unsafeWindow.MW.QuestBar.update(a.questData);try{if(typeof a.user_fields.user_health!==undefined)health=parseInt(a.user_fields.user_health);if(typeof a.user_fields.user_max_health!==undefined)maxHealth=parseInt(a.user_fields.user_max_health);if(typeof a.user_fields.user_stamina!==undefined)stamina=parseInt(a.user_fields.user_stamina);if(typeof a.user_fields.user_max_stamina!==undefined)maxStamina=parseInt(a.user_fields.user_max_stamina);if(typeof a.user_fields.user_energy!==undefined)energy=parseInt(a.user_fields.user_energy);if(typeof a.user_fields.user_max_energy!==undefined)maxEnergy=parseInt(a.user_fields.user_max_energy)}catch(b){colorDEBUG(b,cre)}}function robGetTargets(){DEBUG("robGetTargets");if(!isBGPaused&&running&&canSpendStamina())mwap_do_ajax("robbing","view","","","",robCallback);else{isBackgroundRobbing=false;Autoplay.fx=goHome;Autoplay.delay=150;Autoplay.start();return}}function robSlot(a){DEBUG("robSlot");mwap_do_ajax("robbing","rob","","&slot="+a+"&clkdiv=rob_slot_"+a,"",robCallback)}function robSquadSelect(){DEBUG("robsquadselect");mwap_do_ajax("robbing","rob_all","","","",robCallback)}function robTargetSelect(){DEBUG("robTargetSelect");if(bgRobTargets.length==0){DEBUG("robTargetSelect : No Targets Left - Get New Targets");window.setTimeout(robGetTargets,getAutoPlayDelay());return}else DEBUG("robTargetSelect : Still "+bgRobTargets.length+" Targets Left - Let's rob them ");var a=bgRobTargets.shift();var b=$("div.rob_prop_name_short",a).text();var c=$("div.rob_prop_stamina",a).text();var d=$(a).attr("id");var e=d.digitize();DEBUG("Property Found: "+b+" - Stamina Required: "+c+" vs stamina :"+stamina+" - Rob Slot: "+e);if(c<stamina){colorDEBUG("stamina: "+stamina,cli);mwap_do_ajax("robbing","rob","","&slot="+e+"&clkdiv=rob_slot_"+e,"",robCallback)}else{DEBUG("robTargetSelect : Ran out of Stam");window.setTimeout(robGetTargets,getAutoPlayDelay())}}function robRefresh(){DEBUG("rob refresh");mwap_do_ajax("robbing","refresh","","","",robCallback)}function robCallback(a,b,c,d,e,f,g){if(e){DEBUG("robCallback for action: "+b);if(b=="view"||b=="refresh"){if(isBGPaused)return;m=document.createElement("div");m.innerHTML=g.responseText;bgRobTargets=[];bgRobTargets=$("div.rob_slot:has(a[href*='xw_controller=robbing&xw_action=rob'])",m).get();DEBUG("Found targets: "+bgRobTargets.length);var h=xpathFirst('.//a[@id="rob_refresh_cost"]//span[contains(.,"0 stamina")]',m);if(!h)h=xpathFirst('.//a[@id="rob_refresh_cost"]//span[contains(.,"Refresh: 0")]',m);if(h&&bgRobTargets.length==0){addToLog("info Icon","robCallback: No Rob Elements - Refresh ...");window.setTimeout(robRefresh,getAutoPlayDelay())}else if(bgRobTargets.length>0){addToLog("info Icon","robCallback: "+bgRobTargets.length+" Rob Elements FOUND - Start Robbing ...");if(isGMChecked("useRobSquads")){var i=xpathFirst('.//div[@class="rob_counter_spree"]//span[@id="call_sprees_left"]',m);var j=0;var k=999;if(i)j=parseInt(i.innerHTML.untag());if(j>0){DEBUG(" Currently : "+j+" Rob Squads available");var l=xpathFirst('.//a[@id="oneClickRobAll" and contains(@onclick,"RobbingController.robAllHelper")]',m);eltRobButtonInner=l.innerHTML.untag();if(eltRobButtonInner.match(/(\d+)/))k=parseInt(RegExp.$1)}if(j>0&&k<stamina){window.setTimeout(robSquadSelect,getAutoPlayDelay());return}}window.setTimeout(robTargetSelect,getAutoPlayDelay());return}else{addToLog("info Icon","robCallback: No Elements - Retry ...");window.setTimeout(robGetTargets,getAutoPlayDelay());return}}else if(b=="rob"||b=="call_for_help"){addToLog("info Icon","robCallback: rob response ...");if(IsJsonString(g.responseText)){jsonresult=JSON.parse(g.responseText);jsonPageUpdate(jsonresult);if(jsonresult.slot){var m=document.createElement("div");m.innerHTML=jsonresult.slot;var n=m.innerHTML.untag();colorDEBUG("innerDoc:"+n);if(!n.match(/try again/i)&&!n.match(/function/i)){context={elt:"",name:"",result:m};logRobResponse(context);if(isGMChecked("useBurners")&&n.match(/FAILED/i)&&jsonresult.call_for_backup==0&&jsonresult.phones_left>0){colorDEBUG("Robbing Failed ... Calling for backup: "+jsonresult.call_for_backup+" / "+jsonresult.phones_left);mwap_do_ajax("robbing","call_for_help","",c,"",robCallback);return}else{colorDEBUG("Robbing Failed ... NOT Calling for backup: "+jsonresult.call_for_backup+" / "+jsonresult.phones_left)}}else DEBUG(n);colorDEBUG("stamina: "+stamina,caq)}if(jsonresult.popup){var m=document.createElement("div");m.innerHTML=jsonresult.popup;logRobResult(m)}if(isBGPaused)return;window.setTimeout(robTargetSelect,getAutoPlayDelay())}else{DEBUG("Invalid JSON Response for BGR");window.setTimeout(robGetTargets,getAutoPlayDelay())}}else if(b=="rob_all"){addToLog("info Icon","robCallback: rob_all response ...");if(IsJsonString(g.responseText)){jsonresult=JSON.parse(g.responseText);jsonPageUpdate(jsonresult);if(jsonresult.slots){for(var o in jsonresult.slots){var m=document.createElement("div");m.innerHTML=jsonresult.slots[o];var n=m.innerHTML.untag();if(!n.match(/try again/i)&&!n.match(/function/i)){colorDEBUG("innerDoc:"+n);context={elt:"",name:"",result:m};logRobResponse(context)}else DEBUG(n);colorDEBUG("stamina: "+stamina,caq)}}if(jsonresult.popup){var m=document.createElement("div");m.innerHTML=jsonresult.popup;logRobResult(m)}if(isBGPaused)return;window.setTimeout(robGetTargets,getAutoPlayDelay())}else{DEBUG("Invalid JSON Response for BGR");window.setTimeout(robGetTargets,getAutoPlayDelay())}}}else{DEBUG("Failed Rob Request");window.setTimeout(robGetTargets,getAutoPlayDelay())}}function fightGetTargets(a){if(!a||a<1||a>4)a=0;if(!isBGPaused&&running&&canSpendStamina()){if(inClanBattle&&isGMChecked("AutoBattleFight")&&!a){mwap_do_ajax("EpicBattle","view","","","",fightCallback)}else if(getStaminaMode()==STAMINA_HOW_FIGHT_LIST_BG){var b=GM_getValue("pfightlist","").split("\n")[0];if(b){cycleSavedList("pfightlist");bg_fight_target=new Player;bg_fight_target.linkedName="";bg_fight_target.id="p|"+b;bg_fight_target.level=1;bg_fight_target.origin="fight_page";var c=fightListAvoid.indexOf(bg_fight_target);if(c!=-1&&isGMChecked("fightRemoveStronger")){DEBUG("Specific target is on the blacklist");bg_fight_target.skip=true;window.setTimeout(fightGetTargets,getAutoPlayDelay());return}DEBUG("Attacking target");window.setTimeout(fightAttackPop,getAutoPlayDelay());return}else{DEBUG("No targets found");isBackgroundFighting=false;return}}else{var d=GM_getValue("fightRivalsMode",0);var e="&tab=0";if(d&&(!a||!isGMChecked("fightFallback")||inClanBattle&&isGMChecked("AutoBattleFight")&&a==1)){e="&tab=1"}mwap_do_ajax("fight","view","",e,a,fightCallback)}}else{isBackgroundFighting=false;Autoplay.fx=goHome;Autoplay.delay=150;Autoplay.start();return}}function fightAttackPop(){DEBUG("fightAttackPop Target ID: "+bg_fight_target.id+" Origin: "+bg_fight_target.origin+" Style: "+bg_fight_target.a_type);bg_fight_target.attacks=1;var a="attack_pop";if(bg_fight_target.a_type)a=bg_fight_target.a_type;if(a=="attack_pop")mwap_do_ajax("fight",a,"","&view_style=html&origin="+bg_fight_target.origin+"&opponent_id="+bg_fight_target.id,"",fightCallback);else mwap_do_ajax("fight",a,"","&view_style=html&origin="+bg_fight_target.origin+"&NPC_id="+bg_fight_target.id+"&ofp=0&tab=0","",fightCallback);DEBUG("After the attack...")}function fightAttack(){if(running){bg_fight_target.attacks+=7;mwap_do_ajax("fight",bg_fight_target.a_type,"","&view_style=json&click_amt=7&origin="+bg_fight_target.origin+"&opponent_id="+bg_fight_target.id,"first attack",fightCallback)}else isBackgroundFighting=false}function doubleTap(){if(running){bg_fight_target.attacks+=7;mwap_do_ajax("fight",bg_fight_target.a_type,"","&view_style=json&click_amt=7&origin="+bg_fight_target.origin+"&opponent_id="+bg_fight_target.id,"double tap",fightCallback)}else isBackgroundFighting=false}function fightCallback(a,b,c,d,e,f,g){if(e){if(b=="setBoostToggle"){window.setTimeout(fightGetTargets,getAutoPlayDelay())}else if(b=="view"){doc=document.createElement("div");doc.innerHTML=g.responseText;var h=getStaminaMode();var i=1;if(!f||!isGMChecked("fightFallback")||inClanBattle&&isGMChecked("AutoBattleFight")&&f==1){i=0}var j=GM_getIntValue("useFightBoosts",0);switch(j){case 0:var k=xpathFirst('.//span[@id="boost_wgt_boost_on" and contains(@class,"checked")]',doc);if(k){colorDEBUG("turning off fight boosts");mwap_do_ajax("fight","setBoostToggle","","&toggle_state=off","",fightCallback);return}break;case 1:if(inClanBattle&&isGMChecked("AutoBattleFight")&&!i){var l=xpathFirst('.//span[@id="boost_wgt_boost_off" and contains(@class,"checked")]',doc);var m=xpathFirst('.//span[@class="boost_wgt_boost_count"]',doc);var n=0;if(m)n=parseInt(m.innerHTML);if(l&&n){colorDEBUG("turning on fight boosts : you have "+n+" boosts left ...");mwap_do_ajax("fight","setBoostToggle","","&toggle_state=on","",fightCallback);return}}else{var k=xpathFirst('.//span[@id="boost_wgt_boost_on" and contains([@class,"checked"])]',doc);if(k){colorDEBUG("turning off fight boosts");mwap_do_ajax("fight","setBoostToggle","","&toggle_state=off","",fightCallback);return}}break;case 2:var l=xpathFirst('.//span[@id="boost_wgt_boost_off" and contains(@class,"checked")]',doc);var m=xpathFirst('.//span[@class="boost_wgt_boost_count"]',doc);var n=0;if(m)n=parseInt(m.innerHTML);colorDEBUG("You have "+n+" left ...");if(l&&n){colorDEBUG("turning on fight boosts");mwap_do_ajax("fight","setBoostToggle","","&toggle_state=on","",fightCallback);return}break}bg_fight_target=findFightOpponent(doc,h,i);if(bg_fight_target===-1||!bg_fight_target){DEBUG("No opponents even after seeing the fight list. "+f);if(!f)f=0;f++;window.setTimeout(function(){fightGetTargets(f)},getAutoPlayDelay());return}bg_fight_target.origin="fight_page";if(a=="EpicBattle")bg_fight_target.origin="epicBattle";autoHeal(1);window.setTimeout(fightAttackPop,getAutoPlayDelay());return}else if(b=="attack"||b=="power_js_attack"||b=="attack_pop"){var o=new Object;if(b=="attack_pop"){if(/This player is currently part of your mafia/i.test(g.responseText)){setFightOpponentAvoid(bg_fight_target);bg_fight_target=new Player;DEBUG("Player is in your mafia, skipping");window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else if(/fight_wrapper/.test(g.responseText)){var p,q,r;o.user_fields=new Object;o.user_info=new Object;p=/msg.fight_result = (\{.*\});FightV2/.exec(g.responseText);if(p){if(IsJsonString(p[1])){o.fight_result=JSON.parse(p[1])}}else{DEBUG("Found Fight Response, but it is not parsing in JSON, lets get another target");window.setTimeout(fightGetTargets,getAutoPlayDelay());return}doc=document.createElement("div");doc.innerHTML=g.responseText;var s=xpathFirst('.//div[@id="wrapper_defender"]',doc);var t=xpathFirst('.//div[@id="fv2_widget_wrapper"]',doc);var u=$x('.//a[contains(@class,"fightV2AttackBtn")]',doc);bg_fight_target.normal=u[0];bg_fight_target.power=u[3];var v="";if(s){var w=xpathFirst('.//a[contains(@href,"xw_controller=clan")]',s);if(w)v=linkToString(w,"user")+" ";var x=xpathFirst('.//a[contains(@href,"xw_controller=stats")]',s);var y=xpathFirst('.//div[contains(text(),"Level")]',s);if(x)v+=linkToString(x,"user");if(y)bg_fight_target.level=/(\d+)/.exec(y.innerHTML.untag())[1];if(v)bg_fight_target.linkedName=v}var z=[];var A=[];user_f_exp=/user_fields\['(\w+)'\].*?"(.*?)"/g;user_i_exp=/user_info\['(\w+)'\].*?"(.*?)"/g;while((user_f=user_f_exp.exec(g.responseText))!=null){o.user_fields[user_f[1]]=!isNaN(user_f[2])?parseInt(user_f[2]):user_f[2]}while((user_i=user_i_exp.exec(g.responseText))!=null){o.user_info[user_i[1]]=!isNaN(user_i[2])?parseInt(user_i[2]):user_i[2]}}}else if(IsJsonString(g.responseText)){o=JSON.parse(g.responseText);if(isGMChecked("TestChanges"))GM_setValue("lastFightResult",g.responseText)}if(o&&o.user_fields){jsonPageUpdate(o);autoHeal(1);if(o.fight_result){bg_fight_target.iced=false;var B=o.fight_result;try{if(B.loot[0])logLootDrops(B.loot,"loot");if(B.socialMessageCards[0])logLootDrops(B.socialMessageCards,"social");if(o.fightbar)logLootDrops(o.fightbar,"stats")}catch(C){colorDEBUG("bgfError: "+C+"<br>"+JSON.stringify(o))}var D="";if(isGMChecked("staminaLogDetails")){var E=parseInt(B.cash_city)-1;if(B.cash)cashGainTxt=cities[E][CITY_CASH_SYMBOL]+makeCommaValue(B.cash);else cashGainTxt=cities[E][CITY_CASH_SYMBOL]+makeCommaValue(0);var F="";var G="";if(B.attacker.boost_used_tag){doc=document.createElement("div");doc.innerHTML=B.attacker.boost_used_tag;boostImg=xpathFirst(".//img",doc);if(boostImg)F=' and used a(n) <span class="loot">'+boostImg.title+"</span>"}if(B.defender.boost_used_tag){doc=document.createElement("div");doc.innerHTML=B.defender.boost_used_tag;boostImg=xpathFirst(".//img",doc);if(boostImg)G=' (defender used used a(n) <span class="loot">'+boostImg.title+"</span>)"}var H="yeah Icon";if(!B.isWin)H="omg Icon";D="RX6 attacked "+bg_fight_target.linkedName+F+G+"<br>Won/Lost : "+B.power_attack.won+"/"+B.power_attack.lost+", "+cashGainTxt+", xp: "+B.experience}if(B.defender.is_iced||B.defender.is_killed){bg_fight_target.iced=true;bg_fight_target.skip=true;if(D)addToLog("info Icon",D);logFightOutcome(bg_fight_target,o);if(B.ice_was_just_stolen){if(B.thief_isInMafia){if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else if(isGMChecked("fightNames")&&isGMChecked("fightAvoidNames")&&isFamily(decodeHTMLEntities(B.thief_name),STAMINA_HOW_FIGHT_BG)){if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else{if(isBGPaused)return;if(isGMChecked("fightIceStealers")){bg_fight_target=new Player;bg_fight_target.linkedName=B.thief_name;bg_fight_target.id=B.thief_id;stealerLevelTxt=", a "+B.thief_class;bg_fight_target.level=/(\d+)/.exec(B.thief_class)[1];bg_fight_target.origin="fight_page";var I=/href='(.*?)'/.exec(B.thief_btn)[1];bg_fight_target.button=I.substr(I.indexOf("?")+1);var J=fightListAvoid.indexOf(bg_fight_target);if(J!=-1&&isGMChecked("fightRemoveStronger")){bg_fight_target.skip=true;DEBUG("Ice Stealer is on the blacklist");if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}var K=GM_getIntValue("fightLevelMax",100);if(GM_getValue("fightLevelMaxRelative",false))K=K+level;if(bg_fight_target.level<=K){DEBUG("Attacking Ice Stealer");if(f!="double tap")window.setTimeout(fightAttackPop,getAutoPlayDelay());return}else{if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}}}}window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else{if(isBGPaused)return;if(!bg_fight_target.prev_health_pct){bg_fight_target.damage_done=0;bg_fight_target.health=0;bg_fight_target.prev_health_pct=o.fight_result.defender.current_health_pct;bg_fight_target.health_text=o.fight_result.defender.current_health_pct+"%"}else if(o.fight_result.defender.current_health_pct>bg_fight_target.prev_health_pct&&bg_fight_target.attacks>1){bg_fight_target.prev_health_pct=o.fight_result.defender.current_health_pct;bg_fight_target.health=0;bg_fight_target.damage_done=0;bg_fight_target.health_text="Healed"}else{bg_fight_target.damage_done+=parseInt(o.fight_result.defender.damage_dealt);bg_fight_target.pct_taken=parseInt(bg_fight_target.prev_health_pct-o.fight_result.defender.current_health_pct-o.fight_result.defender.other_damage);var L=parseInt(100/bg_fight_target.pct_taken*bg_fight_target.damage_done);var M=parseInt(L*o.fight_result.defender.current_health_pct/100);bg_fight_target.health=M;bg_fight_target.maxhealth=L;bg_fight_target.health_text=o.fight_result.defender.current_health_pct+"% ("+bg_fight_target.pct_taken+"/"+M+"/"+L+")";bg_fight_target.prev_health_pct=o.fight_result.defender.current_health_pct}var N=0;if(!bg_fight_target.doubleTap)bg_fight_target.doubleTap=2;if(bg_fight_target.pct_taken){var O=Math.floor(o.fight_result.defender.current_health_pct/bg_fight_target.pct_taken);colorDEBUG(bg_fight_target.pct_taken+" vs "+o.fight_result.defender.current_health_pct+" : "+O,caq);if(O>=bg_fight_target.doubleTap){bg_fight_target.doubleTap=bg_fight_target.doubleTap*2;N=1}}if(isGMChecked("staminaLogDetails")){if(!D)D="RX6 attacked "+bg_fight_target.linkedName+F+G+"<br>Won/Lost : "+B.power_attack.won+"/"+B.power_attack.lost+", "+cashGainTxt+", xp: "+B.experience;D+=", health: "+bg_fight_target.health_text;D+=", doubleTap: "+bg_fight_target.doubleTap;if(D)addToLog("info Icon",D)}if(B.isWin||!B.isWin&&!isGMChecked("fightRemoveStronger")){if(canSpendStamina()&&(!B.exp_for_next_level||B.exp_for_next_level>6)){if(GM_getValue("fightMaxAttacks",0)&&B.power_attack.won+B.power_attack.lost>GM_getValue("fightMaxAttacks",0)){addToLog("warning Icon","Maximum Attacks Achieved, getting next target ...");logFightOutcome(bg_fight_target,o);if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else if(GM_getValue("fightHealthPctMax",0)&&B.defender.current_health_pct>GM_getValue("fightHealthPctMax",0)){addToLog("warning Icon","Maximum Health % Detected, getting next target ...");logFightOutcome(bg_fight_target,o);if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else if(GM_getValue("fightHealthMax",0)&&bg_fight_target.health>GM_getValue("fightHealthMax",0)){addToLog("warning Icon","Maximum Estimated Health Detected, getting next target ...");logFightOutcome(bg_fight_target,o);if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}else{var P=isNewCity(o.user_fields.current_city_id-1)?25:5;var Q=1750-GM_getIntValue("fastBGFSpeed",0)*350;if(isGMChecked("staminaPowerattack")&&o.user_fields.user_stamina>=P){DEBUG("Power Attacking player again in: "+Q+" ms.");bg_fight_target.a_type="power_js_attack";if(bg_fight_target.power){var I=bg_fight_target.power.getAttribute("href");bg_fight_target.button=I.substr(I.indexOf("?")+1)}window.setTimeout(fightAttack,Q);if(f!="double tap"&&N){colorDEBUG("doubleTap Power Attack",caq);window.setTimeout(N,Q+2500)}return}else{DEBUG("Attacking player again in: "+Q+" ms.");bg_fight_target.a_type="attack";if(bg_fight_target.normal){var I=bg_fight_target.normal.getAttribute("href");bg_fight_target.button=I.substr(I.indexOf("?")+1)}window.setTimeout(fightAttack,Q);if(f!="double tap"&&N){colorDEBUG("doubleTap Attack");window.setTimeout(N,Q+2500)}return}}}else{DEBUG("Cannot spend stamina for some reason? Exp to next level: "+B.exp_for_next_level+" canspendStamina: "+canSpendStamina());if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}}else{logFightOutcome(bg_fight_target,o);setFightOpponentAvoid(bg_fight_target);bg_fight_target.skip=true;if(!bg_fight_target.iced&&bg_fight_target.id.indexOf("p|")!=-1){var R=bg_fight_target.id.digitize();getHelp(R,bg_fight_target.name,bg_fight_target.level);colorDEBUG("Fight Response : liveTarget detected and LiveLinks feed entry sent")}if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}}}else{if(!isBGPaused&&canSpendStamina()){DEBUG("No fight result found - retrying");if(f!="double tap")window.setTimeout(fightAttack,getAutoPlayDelay());return}else{DEBUG("Cannot spend stamina for some reason? canspendStamina: "+canSpendStamina());if(f!="double tap")window.setTimeout(fightGetTargets,getAutoPlayDelay());return}}}else{doc=document.createElement("div");doc.innerHTML=g.responseText;resultElt=xpathFirst('.//div[@class="fight_results"]',doc);try{if(resultElt){var S=resultElt.innerHTML;var T=S.untag();if(T.match(/you won/i)){var U=xpathFirst('.//div[@class="fightres_stats"]',resultElt);if(U){var V="$0";var W="0 experience";var X="killed a Mission Target";var Y=xpathFirst('.//div[@class="sexy_cash good"]',U);if(!Y)Y=xpathFirst('.//div[@class="sexy__cash good"]',U);if(Y)V=Y.innerHTML;var Z=xpathFirst('.//div[@class="fightres_experience good"]',U);if(Z)W=Z.innerHTML;var $=xpathFirst('.//div[@class="fightres_damage"]',U);if($)X=$.innerHTML.replace(/killed/i,"killed a(n)").trim();addToLog("yeah Icon","RX6 "+X+', gaining <span class="good">'+V+'</span> and <span class="good">'+W+"</span>")}}}DEBUG("fight result processed ... get new targets");window.setTimeout(fightGetTargets,getAutoPlayDelay());return}catch(_){colorDEBUG(_);return}}}}else{DEBUG("Failed Fight Request");window.setTimeout(fightGetTargets,getAutoPlayDelay());return}}function checkPropertyCallBack(a,b,c,d,e,f,g){var h=parseInt(d.digitize())-1;if(IsJsonString(g.responseText)){var i=JSON.parse(g.responseText);if(i.data){var j=JSON.parse(i.data);switch(h){case LV:GM_setValue("vegasReport",JSON.stringify(j));var k=parseInt(j.properties[5].capacity)-parseInt(j.acct_balance);var l=parseInt(j.properties[5].level);GM_setValue("vaultSpace",String(k));GM_setValue("vaultHandling",l);break;case BRAZIL:GM_setValue("brazilReport",JSON.stringify(j));break;case CHICAGO:GM_setValue("chicagoReport",JSON.stringify(j));break;case LONDON:GM_setValue("londonReport",JSON.stringify(j));break}}}if(f){Autoplay.fx=goHome;Autoplay.delay=150;Autoplay.start()}return}function bossLoad(){if(!running||!isGMChecked("autoFamilyBosses")&&!isGMChecked("autoFamilyBossFighting")){isBossRunning=false;return}mwap_do_ajax("Epicclanboss","list_view","","","",bossCallback)}function bossLoadBoss(){mwap_do_ajax("Epicclanboss","boss_view","","&boss_id="+current_boss_id,"",bossCallback)}function bossJoin(){mwap_do_ajax("Epicclanboss","epic_join","","&role="+bossRoles[GM_getValue("bossRole",0)]+"&boss_id="+current_boss_id,"",bossCallback)}function bossCreate(a){mwap_do_ajax("Epicclanboss","epic_create","","&boss_id="+a,"",bossCallback)}function bossSendBoost(a,b,c,d){mwap_do_ajax("Epicclanboss","epic_send_role","","&role_id="+b+"&boss_id="+c+"&cell_id="+a+"&target_ppid="+d,"",bossCallback)}function bossAskBoost(a,b){mwap_do_ajax("Epicclanboss","epic_ask_role","","&role_id="+a+"&boss_id="+b,"",bossCallback)}function bossCollect(a){mwap_do_ajax("Epicclanboss","epic_collect","","&boss_id="+a,"",bossCallback)}function bossAttack(a){mwap_do_ajax("Epicclanboss","epic_attack","","&consumable_id=0&boss_id="+current_boss_id,a,bossCallback)}function bossCallback(a,b,c,d,e,f,g){if(e){var h=[];var k=[];var l;if(b=="epic_ask_role"||b=="epic_send_role"){if(IsJsonString(g.responseText)){var m=JSON.parse(g.responseText);if(m.data&&m.data.impulseBuy){addToLog("info Icon",m.data.impulseBuy.message.untag())}}window.setTimeout(bossLoad,getAutoPlayDelay());return}else if(b=="epic_attack"){if(IsJsonString(g.responseText)){var m=JSON.parse(g.responseText);if(m.data)if(IsJsonString(m.data))l=JSON.parse(m.data);if(l&&l.damage.toBoss){addToLog("info Icon","Did "+l.damage.toBoss+" damage to "+current_boss_name)}}if(f==1)window.setTimeout(bossLoad,getAutoPlayDelay());return}else if(b=="epic_collect"||b=="epic_join"){window.setTimeout(bossLoad,getAutoPlayDelay());return}else if(b=="boss_view"){if(g.responseText.indexOf("xw_controller=Epicclanboss&xw_action=epic_join")!=-1){addToLog("info Icon","Joining Boss"+current_boss_id);bossJoin();return}else{doc=document.createElement("div");doc.innerHTML=g.responseText;var n=g.responseText;var o=0,p=0,q=0;var r,s;var t=g.responseText.indexOf('"currentCharges":');if(t!=-1){o=parseInt(g.responseText.slice(t+17,g.responseText.indexOf(",",t)))}var u=$x('.//div[contains(@class,"helpButton") and contains(@style, "block")]/a[contains(@href,"xw_action=epic_send_role&")]',doc);if(u&&u.length&&o>0&&isGMChecked("sendBossFightBoosts")){var v=u[Math.floor(Math.random()*u.length)];var w=v.href.match(/role_id=(\d+)/)[1];var x=v.href.match(/cell_id=(\d+)/)[1];var y=v.href.match(/target_ppid=(.*)/)[1];addToLog("info Icon","Sending a boost to a family member, playerid: "+y);bossSendBoost(x,w,current_boss_id,y);return}var z=$x('.//div[contains(@class,"needBoost") and not(contains(@style, "none"))]/div[contains(@class,"boostAskHelp") and not(contains(@style, "none"))]/a[contains(@href,"xw_action=epic_ask_role")]',doc);if(z&&z.length&&isGMChecked("askBossFightBoosts")){var w=z[0].href.match(/role_id=(\d+)/)[1];bossAskBoost(w,current_boss_id);return}isearch="user_fields['user_stamina'] = parseInt(\"";t=n.indexOf(isearch);if(t!=-1){q=parseInt(n.slice(t+isearch.length,n.indexOf('"',t+isearch.length)))}isearch="bossData = {";t=n.indexOf(isearch);if(t!=-1){s=JSON.parse(n.slice(t+isearch.length-1,n.indexOf("};",t+isearch.length)+1))}isearch="userData = {";t=n.indexOf(isearch);if(t!=-1){r=JSON.parse(n.slice(t+isearch.length-1,n.indexOf("};",t+isearch.length)+1))}DEBUG("Rage: "+s.current_rage+" Stamina: "+q);if(isGMChecked("autoFamilyBossFighting")&&(s.current_rage<=GM_getValue("bossRageLimit",250)||r.pendingRoleEffects["2"]["count"]>0)&&(r.stamina_required<=bossStaminaLimits[GM_getValue("bossStaminaLimit",0)]||r.pendingRoleEffects["3"]["count"]>0)&&s.currHealth>0&&q>=r.stamina_required){if(r.current_fatigue<14){for(j=1;j<5;j++){bossAttack(j)}}else{bossAttack(1)}return}DEBUG("Rage: "+s.current_rage+" / Limit "+GM_getValue("bossRageLimit",250)+" boosts: "+r.pendingRoleEffects["2"]["count"]);DEBUG("Stamina: "+r.stamina_required+" / Limit "+bossStaminaLimits[GM_getValue("bossStaminaLimit",0)]+" boosts: "+r.pendingRoleEffects["3"]["count"]);DEBUG("Boss Health: "+s.currHealth+" Current Stamina: "+q);setGMTime("familyBoss_"+current_boss_id,"02:00");window.setTimeout(bossLoad,getAutoPlayDelay());return}}else{doc=document.createElement("div");doc.innerHTML=g.responseText;t=g.responseText.match(/xw_controller=Epicclanboss&xw_action=epic_collect.*?&boss_id=(\d+)/);if(t&&t[1]){addToLog("info Icon","Found boss collect for: "+t[1]);bossCollect(t[1]);return}t=g.responseText.match(/BossOperationController.startFight\((\d+)\)/);if(t&&t[1]){addToLog("info Icon","Found boss create for: "+t[1]);bossCreate(t[1]);return}var A=$x('.//div[@class="boss_operation"]',doc);for(i=0;i<A.length;i++){var B=xpathFirst('.//div[contains(@class,"boss_name")]',A[i]);var C=B.innerHTML.untag().trim();if(xpathFirst('.//a[contains(@onclick,"BossOperationController.goToFight")]',A[i])){if(!timeLeftGM("familyBoss_"+A[i].id.split("_")[1])){h.push(A[i].id.split("_")[1]);k.push(C);DEBUG("Found active boss fight for: "+C+" "+A[i].id.split("_")[1])}}}if(h.length){if(current_boss_index>h.length-1){current_boss_index=0}current_boss_id=h[current_boss_index];current_boss_name=k[current_boss_index];current_boss_index++;DEBUG("Loading Boss Page: "+current_boss_name);window.setTimeout(bossLoadBoss,getAutoPlayDelay());return}addToLog("info Icon","Family Boss Fight is idling");window.setTimeout(bossLoad,12e4);return}}else{window.setTimeout(bossLoad,2e4)}}function battleLoad(){mwap_do_ajax("EpicBattle","view","","","",battleCallback)}function battleAttackSafeHouse(){mwap_do_ajax("epicBattle","attackFortress","","","",battleCallback)}function battleJoin(){mwap_do_ajax("epicBattle","optIn","","","",battleCallback)}function battleCallback(a,b,c,d,e,f,g){if(e){try{if(!running){inSafehouse=false;return}var h=g.responseText;var i=0;var j=0;var k,l;var m=h.match(/<td class="message_body">(.*?)<\/td>/);if(m){var n=m[0].untag().trim();if(n.length)addToLog("info Icon",n)}l="user_fields['user_health'] = parseInt(\"";k=h.indexOf(l);if(k!=-1){i=parseInt(h.slice(k+l.length,h.indexOf('"',k+l.length)))}l="user_fields['user_stamina'] = parseInt(\"";k=h.indexOf(l);if(k!=-1){j=parseInt(h.slice(k+l.length,h.indexOf('"',k+l.length)))}if(h.indexOf("xw_controller=epicBattle&xw_action=optIn")!=-1){addToLog("info Icon","Joining Battle");window.setTimeout(battleJoin,getAutoPlayDelay())}else if(i>20&&j>=10&&h.indexOf("xw_controller=epicBattle&xw_action=attackFortress")!=-1){window.setTimeout(battleAttackSafeHouse,getAutoPlayDelay())}else{if(g.responseText.indexOf('"inBattle":true')!=-1){window.setTimeout(battleLoad,15e3)}else{inSafehouse=false}}}catch(o){inSafehouse=false}}else{inSafehouse=false}}function clanPropertyLoad(a){mwap_do_ajax("ClanProperty","view","","&current_property="+a,a,ClanPropertyCallback)}function clanPropertyupgradePop(a){mwap_do_ajax("ClanProperty","upgradePop","","&property_id="+a,a,ClanPropertyCallback)}function clanPropertyupgradeProperty(a,b){mwap_do_ajax("ClanProperty","upgradeProperty","","&property_id="+a+"&num_parts="+b,a,ClanPropertyCallback)}function ClanPropertyCallback(a,b,c,d,e,f,g){if(e){if(b=="view"){doc=document.createElement("div");doc.innerHTML=g.responseText;var h=xpathFirst('.//div[@id="ask_and_send_buttons"]/a[contains(@onclick,"next_controller=ClanProperty&next_action=getPartsFromFeed")]',doc);if(h){addToLog("info Icon","Asking for Family Property Parts for property "+f);clickElement(h)}}else if(b=="upgradePop"){doc=document.createElement("div");doc.innerHTML=g.responseText;var i=xpathFirst('.//a[contains(@href,"xw_controller=clanproperty&xw_action=upgradeProperty")]',doc);if(i&&i.href.match(/num_parts=(\d+)/)){var j=RegExp.$1;addToLog("info Icon","Adding Parts to Family Property: "+j+" to property "+f);clanPropertyupgradeProperty(f,j)}else{DEBUG("No property upgrade link found for property number "+f)}}else if(b=="upgradeProperty"){if(IsJsonString(g.responseText)){jsonresult=JSON.parse(g.responseText);if(jsonresult.data&&IsJsonString(jsonresult.data)){respData=JSON.parse(jsonresult.data);addToLog("info Icon","Family Property Level: "+respData.property_level+" Parts ("+respData.property_upgrade_parts+" / "+respData.property_parts_needed+") for property: "+f)}}}}}function doFBParse(_myResponse){var i1,i2,i1b,i1c,i1d,myUrl,myParms;var strTemp;var PhaseSearch=['<script>big_pipe.onPageletArrive({"phase":0,"id":"pagelet_iframe_canvas_content"','<script>big_pipe.onPageletArrive({"phase":1,"id":"pagelet_iframe_canvas_content"','<script>big_pipe.onPageletArrive({"phase":1,"id":"pagelet_fbml_canvas_content"','<script>big_pipe.onPageletArrive({"phase":0,"id":"pagelet_fbml_canvas_content"'];for(var i=0;i<PhaseSearch.length;i++){i1=_myResponse.indexOf(PhaseSearch[i]);if(i1>0){i1=_myResponse.indexOf("{",i1);i2=_myResponse.indexOf(");</script>",i1);eval("strTemp = "+_myResponse.slice(i1,i2));break}}if(typeof strTemp=="object"&&strTemp.content.pagelet_iframe_canvas_content){if(strTemp.content.pagelet_iframe_canvas_content.container_id){i1=_myResponse.indexOf('<code class="hidden_elem" id="'+strTemp.content.pagelet_iframe_canvas_content.container_id+'">');if(i1>0){i2=_myResponse.indexOf("</code>",i1);strTemp=_myResponse.slice(i1,i2)}}else{strTemp=strTemp.content.pagelet_iframe_canvas_content}}else if(typeof strTemp=="object"&&strTemp.content.pagelet_fbml_canvas_content){if(strTemp.content.pagelet_fbml_canvas_content.container_id){i1=_myResponse.indexOf('<code class="hidden_elem" id="'+strTemp.content.pagelet_fbml_canvas_content.container_id+'">');if(i1>0){i2=_myResponse.indexOf("</code>",i1);strTemp=_myResponse.slice(i1,i2)}}else{strTemp=strTemp.content.pagelet_fbml_canvas_content}}else{strTemp=_myResponse}i1=strTemp.indexOf('<form action="http://facebook.mafiawars.zynga.com/mwfb/');if(i1==-1){i1=strTemp.indexOf('<form action="https://facebook.mafiawars.zynga.com/mwfb/')}if(i1==-1){i1=strTemp.indexOf('<form id="auto_form" action="https://facebook.mafiawars.zynga.com/mwfb/')}if(i1==-1){i1=strTemp.indexOf('<form id="auto_form" action="http://facebook.mafiawars.zynga.com/mwfb/')}if(i1!=-1){i1=strTemp.indexOf("<form",i1);i2=strTemp.indexOf("</form>",i1);strTemp=strTemp.slice(i1,i2);i1=strTemp.indexOf('action="')+8;i2=strTemp.indexOf('"',i1);myUrl=strTemp.slice(i1,i2);myUrl=myUrl.replace(/&/g,"&");myParms="";i1=strTemp.indexOf("<input");while(i1!=-1){if(myParms!="")myParms+="&";i1=strTemp.indexOf('name="',i1)+6;i2=strTemp.indexOf('"',i1);myParms+=strTemp.slice(i1,i2)+"=";i1=strTemp.indexOf('value="',i1)+7;i2=strTemp.indexOf('"',i1);myParms+=escape(strTemp.slice(i1,i2));i1=strTemp.indexOf("<input",i1)}return[myUrl,myParms,strTemp]}i1=strTemp.indexOf("goURI(");if(i1!=-1){i1+=7;i2=strTemp.indexOf("')",i1);myUrl=strTemp.slice(i1,i2);myUrl=myUrl.replace(/\\x26/g,"&");myUrl=myUrl.replace(/&/g,"&");return[myUrl,"",strTemp]}i1=strTemp.indexOf('location.href="');if(i1!=-1){i1=i1+15;i2=strTemp.indexOf('"',i1);myUrl=strTemp.slice(i1,i2).replace(/\\n/,"");addToLog("info Icon",myUrl);return[myUrl,"",strTemp]}return["","",strTemp]}function processLinkCallback(a,b){var c=doFBParse(b.responseText);if(c[0]){if(c[1]){processLinkPost(c[0],c[1],a)}else{processLink(c[0],a)}}else{addToLog("info Icon","Link Collection Complete: "+a)}}function processLink(a,b){GM_xmlhttpRequest({method:"GET",url:a,onload:processLinkCallback.bind({},b)})}function processLinkPost(a,b,c){GM_xmlhttpRequest({method:"POST",url:a,data:b,headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:processLinkCallback.bind({},c)})}function slotFreeSpins(){setGMTime("autoFreeSlotTimer","8 hours");processLink("http://apps.facebook.com/inthemafia/index.php?next_params=YTozOntpOjA7czo1OiJpbmRleCI7aToxO3M6NDoidmlldyI7aToyO3M6MTk2OiImcGxheXNsb3RzPTEmZnJvbW1pbmlmZWVkPTEmd2lucz0xMCZ1c2VyX2lkPXAlN0M4MjY4Njc3OSZpbnN0YWxsX3NvdXJjZT1mZWVkJmluc3RhbGxfbGluaz13aW5fc2xvdCZzZW5ka2V5PWRhMTgxZDBkZmJmYTQ3M2ZiYzgyNjQ3Nzc4Y2M4NmQ2JCRnZU8zVVhPWTNZeU1ZNE1xQ1dzNixaYyFlTFJaY2NFd0VldGcqYTEoLWRoTi0maW5kZXhuZj0xIjt9&auth_token=c3207b140d4b2221288ee4c40141f360","Free Slot Spins");return false}function mwap_do_ajax(a,b,c,d,e,f){var g="";var h="";if(d.indexOf("cb")==-1&&d.indexOf("tmp")){h="&tmp="+parseInt((new Date).getTime().toString().substring(0,10));g="&cb="+xw_user+h}var i="ajax=1&liteload=1&clicks="+clicks+"&sf_xw_user_id="+xw_user_id+"&sf_xw_sig="+unsafeWindow.local_xw_sig;var j=document.location.protocol+"//facebook.mafiawars.zynga.com/mwfb/"+SCRIPT.controller+a+SCRIPT.action+b+SCRIPT.city+c+"&xw_person="+xw_user+"&xw_client_id=8"+g+h+d;if(a=="fight"&&(b=="attack"||b=="power_js_attack"||b=="attack_pop")&&bg_fight_target.button){j=bg_fight_target.button;if(j.indexOf("cb=")==-1){j+="&cb="+xw_user_id+h}if(j.indexOf("tmp=")==-1){j+="&tmp="+h}if(j.indexOf("click_amt=1")!=-1){j=j.replace(/click_amt=1/,staminaSpendStrength)}j=document.location.protocol+"//facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?"+j}clicks++;GM_xmlhttpRequest({method:"POST",url:j,data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:f.bind({},a,b,c,d,true,e),onerror:f.bind({},a,b,c,d,false,e)})}function checkReallocation(){setGMTime("checkReallocationTimer","20:00");mwap_do_ajax("marketplace","marketplace_category","","&category=2","",checkReallocation_callback);return false}function checkReallocation_callback(a,b,c,d,e,f,g){if(e){var h,i,j;var k=g.responseText;h=k.indexOf("Reallocate");if(h!=-1){var l="!!! ReAllocation Active !!!";addToLog("info Icon",l);var m="520";var n=new Date;var o="<br><br>Skill Point Reallocation is active!<br><br>"+n+"<br><br>"+'<br><a id="MWAP_RX6_Popup_CloseButton" href="javascript:void(0)" style="position:relative;top:10px" class="sexy_button_new black"><span><span>Close Popup</span</span></a>'+"";MWAP_RX6_PopupOpen(l,o,m,false);MWAP_RX6_PopupActivate()}}}function gotops(){if(isGMChecked("playMWAP")&&isGMChecked("playMWAPRX2")){window.location.href="http://mwap.me.uk/mwap-rx6-2.html"}else if(isGMChecked("playMWAP")&&!isGMChecked("playMWAPRX2")){window.location.href="http://mwap.me.uk/mwap-rx6.html"}if(isGMChecked("playMWAPLite")&&isGMChecked("playMWAPLiteRX2")){window.location.href="http://mwap.me.uk/mafiawarsautoplayer-2.html"}else if(isGMChecked("playMWAPLite")&&!isGMChecked("playMWAPLiteRX2")){window.location.href="http://mwap.me.uk/mafiawarsautoplayer.html"}}var updtJobArrayIfWasBelow=79;var SCRIPT={version:"2.0.79",name:"inthemafia",appID:"app10979261223",appNo:"10979261223",presentationurl:"http://www.playerscripts.co.uk",url:"http://cdn.playerscripts.co.uk/rokdownloads/ps_facebook_mafia_wars_a.user.js",metadata:"http://cdn.playerscripts.co.uk/rokdownloads/mwapmeta.js",controller:"remote/html_server.php?xw_controller=",action:"&xw_action=",city:"&xw_city=",opponent:"&opponent_id=",user:"&user_id=",ajaxIDSync:"ajax_sync",ajaxIDAsync:"ajax_async",UseDebugConsole:false,UseDebugCategory:0,PSMWAP_homePath:"http://www.playerscripts.co.uk/",PSMWAP_imagePath:"http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/mwap_int_web_",PSMWAP_iconPath:"http://cdn.playerscripts.co.uk/images/mwap_graphics/icons/",PSMWAP_imageBPath:"http://cdn.playerscripts.co.uk/images/banners/",PSMWAP_imageLogPath:"http://cdn.playerscripts.co.uk/images/mwap_graphics/setlog/"};var GMSTORAGE_PATH="GM_"+SCRIPT.appID+"_";if(/facebook\.com/.test(window.location.href)){var profElt=xpathFirst('//ul[@id="pageNav"]//a[@accesskey="6"]');if(profElt&&profElt.getAttribute("href").match(/id=(\w+)/)){GMSTORAGE_PATH=GMSTORAGE_PATH+RegExp.$1}var profLink=xpathFirst('//div[contains(@id,"div_story_") and contains(@data-ft,"actrs")]');if(profLink&&profLink.getAttribute("data-ft").match(/"actrs":"(\w+)/)){GMSTORAGE_PATH=GMSTORAGE_PATH+RegExp.$1}}if(/mwfb\.zynga\.com/.test(window.location.href)){var docUrl=document.location.href;if(docUrl.match(/sf_xw_user_id=(\w+)/)){GMSTORAGE_PATH=GMSTORAGE_PATH+RegExp.$1}}var gvar=function(){};GM_ApiBrowserCheck();var $=unsafeWindow.jQuery;var obStrings=[];window.addEventListener("message",receiver,false);build_Analytics();if(gvar.isGreaseMonkey){GM_registerMenuCommand("FB Mafia Wars RX6 MWAP - Turn Debugging Log On/Off",debugOnOff);GM_registerMenuCommand("FB Mafia Wars RX6 MWAP - Clear Saved Values",function(){clearSettings();goHome()})}Spend.prototype.refreshLimits=function(a,b){this.floor=Math.min(this.getSpendValue(a,GM_getValue(this.keepMode,0),GM_getValue(this.keepValue,0)),a-1);this.ceiling=Math.min(this.getSpendValue(a,GM_getValue(this.useMode,0),GM_getValue(this.useValue,0)),a);this.canBurn=isGMChecked(this.burnFlag)&&b};Spend.prototype.toggleSpending=function(a,b){if(this.floor!=GM_getValue(this.lastFloor)){GM_setValue(this.lastFloor,this.floor);if(this.floor>1){addToLog("info Icon",this.icon+'<span style="color:#04B4AE;";> '+this.name+" is set to keep above <strong>"+this.floor+"</strong>.</span>")}}if(this.ceiling!=GM_getValue(this.lastCeiling)){GM_setValue(this.lastCeiling,this.ceiling);if(this.ceiling>this.floor){addToLog("info Icon",this.icon+'<span style="color:#04B4AE;";> '+this.name+" refill level set to <strong>"+this.ceiling+"</strong>.</span>")}}if(b>=this.ceiling&&!GM_getValue(this.startFlag)){GM_setValue(this.startFlag,true)}else if(b<=this.floor&&this.ceiling>this.floor&&GM_getValue(this.startFlag)){GM_setValue(this.startFlag,false);addToLog("info Icon",this.icon+'<span style="color:#04B4AE;";> Refilling '+this.name+" to <strong>"+this.ceiling+"</strong>.</span>")}};Player.prototype.match=function(a){if(!a)return false;if(this.id&&a.id)return this.id==a.id;if(this.profile&&this.profile==a.profile)return true;if(this.profileAttack&&this.profileAttack==a.profileAttack)return true;if(this.attack&&this.attack==a.attack)return true;return false};Player.prototype.update=function(a){if(!this.match(a))return false;for(var b in a){this[b]=a[b]}return true};PlayerList.prototype.get=function(a){if(this.name&&(a||!this.list.length)){var b=getSavedList(this.name);this.list=[];for(var c=0,d=b.length;c<d;++c){var e=new Player;e.id=b[c];this.list.push(e)}}return this.list};PlayerList.prototype.set=function(a){if(a){this.list=a}if(this.name){var b=[];for(var c=0,d=this.list.length;c<d;++c){var e=this.list[c];if(e&&e.id){b.push(e.id)}}setSavedList(this.name,b)}};PlayerList.prototype.add=function(a,b){if(!a)return false;var c=this.list.length;for(var d=0;d<c;++d){if(this.list[d].update(a)){return false}}this.list.push(a);if(b>0){while(b<this.list.length){var e=this.list.shift()}}return true};PlayerList.prototype.remove=function(a){if(!a)return false;var b=this.list.length;for(var c=0;c<b;++c){if(this.list[c].match(a)){this.list.splice(c,1);return true}}return false};PlayerList.prototype.indexOf=function(a){var b=this.list.length;for(var c=0;c<b;c++){if(this.list[c].match(a))return c}return-1};PlayerList.prototype.debug=function(){var a=this.list.length;var b="PlayerList name="+this.name+", length="+a+"\n";for(var c=0;c<a;++c){var d=this.list[c];b+=c+": ";if(d.name)b+=", name="+d.name;if(d.level)b+=", level="+d.level;if(d.mafia)b+=", mafia="+d.mafia;b+="\n"}return b};var lootbagIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'lootbag_icon.png" />';var attackIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'attack_icon.png" />';var defenseIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'defense_icon.png" />';var omgIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'omg_icon.png" />';var staminaIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'stamina_icon.png" />';var energyIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'energy_icon.png" />';var yeahIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'yeah_icon.png" />';var plussignIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'plussign_icon.png" />';var cashIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cash_icon.png" />';var cashCubaIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashcuba_icon.png" />';var cashMoscowIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashmoscow_icon.png" />';var cashBangkokIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashbangkok_icon.png" />';var cashVegasIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashvegas_icon.png" />';var cashItalyIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashitaly_icon.png" />';var cashBrazilIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashbrazil_icon.png" />';var cashChicagoIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashchicago_icon.png" />';var cashLondonIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'cashlondon_icon.png" />';var mini_Epak_ready='<img src="'+SCRIPT.PSMWAP_iconPath+'bulb_on.png" />';var mini_Epak_wait='<img src="'+SCRIPT.PSMWAP_iconPath+'bulb_off.png" />';var healthIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'health_icon.png" />';var healOnIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'healon_icon.png" />';var healOnHoldIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'healonhold_icon.png" />';var healOffIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'healoff_icon.png" />';var warningIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'warning_icon.png" />';var debugIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'debug_icon.png" />';var chickenIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'chicken_icon.png" />';var hideIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'hide_icon.png" />';var checkedIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'checked_icon.png" />';var unCheckedIcon='<img src="'+SCRIPT.PSMWAP_iconPath+'unchecked_icon.png" />';var winW=630,winH=460;var bgTabImage='<img src="http://cdn.playerscripts.co.uk/images/mwap_graphics/generaltabimage.png" />';var noDelay=0;var minDelay=1e3;var running;var innerPageElt;var questBarElt;var appLayoutElt;var mastheadElt;var statsrowElt;var menubarElt;var popupfodderElt;var cashElt;var healthElt,health;var maxHealthElt,maxHealth;var energyElt,energy;var maxEnergyElt,maxEnergy;var staminaElt,stamina;var maxStaminaElt,maxStamina;var levelElt,level;var curAttack;var curDefense;var curAttackEquip;var curDefenseEquip;var prevAttackEquip;var prevDefenseEquip;var curExpElt,curExp;var lvlExpElt,lvlExp;var energyPackElt,energyPack;var autoEnergyPackWaiting=false;var ptsToNextLevel;var mafia;var stats;var city;var skipStaminaSpend=false;var clickAction;var clickContext;var modificationTimer;var ajaxAction;var ajaxContext;var ajaxHandling=false;var popupTimer;var helpWar=false;var idle=true;var lastOpponent;var suspendBank=false;var skipJobs=false;var newStaminaMode;var jobid;var opsInfo=new Operations;var xw_sig;var xw_user;var xw_user_id;var xw_sig;var playerName;var playerLevel;var cbr="#FF800D";var cye="#FFD700";var cy="#FFFF00";var cfu="#FF00FF";var cre="#FF0000";var csi="#C0C0C0";var cds="#808080";var cov="#808000";var cpu="#800080";var cma="#800000";var caq="#00FFFF";var cli="#00FF00";var cte="#008080";var cgr="#008000";var cbl="#6495ED";var can="#000080";var cbk="#000000";var cwt="#FFFFFF";var color;var line;var new_header=xpathFirst('//div[@class="header_top_row"]')?true:false;var currentBrazilDistrict=0;var oldBrazilDistrict=0;var previousBrazilJob=null;var previousBrazilJobMastery=null;var boardLastStamina=0;var boardLastPtsToNextLevel=0;var claimLevelUpBonus=true;var inClanBattle=false;var inSafehouse=false;var slotSpins=0;var slotBonus=0;var isBossRunning=false;var current_boss_id=0;var current_boss_index=0;var current_boss_name="";var clicks=1;var isProfileSearching=false;var profileCount=0;var isBackgroundFighting=false;var isBackgroundRobbing=false;var bgRobTargets=[];var bg_fight_target=new Player;var isBGPaused=false;var useConsumables=true;var endBoss=false;var inRequests=false;var myFriendsList=[];var myDispatchList=[];var myDispatchNumber=0;var myDispatchParams="";var isBackgroundDispatching=false;var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(!initialized&&!checkInPublishPopup()&&!checkInRequestsPopup()&&!checkLoadIframe()&&(/inthemafia/.test(document.referrer)||/facebook\.mafiawars\.com/.test(window.location.href)||/facebook\.mafiawars\.zynga\.com/.test(window.location.href)||/m\.mafiawars\.com/.test(document.referrer)||/iframe/.test(window.location.href))){setFBParams();var settingsOpen=false;var statsOpen=false;var scratchpad=document.createElement("textarea");var defaultClans=["{","[","(","<","?","?","","?","?"];var defaultPassPatterns=["LOST","punched","Whacked","you were robbed","ticket"];var defaultFailPatterns=["WON","heal","help","properties","upgraded"];var debug=isGMChecked("enableDebug");var filter=isGMChecked("filterLog");var REGEX_CASH=/([A-Z]*?\$|\u00A2|\u00A3)([\d,]*\d)/;var STAMINA_HOW_FIGHT_RANDOM=0;var STAMINA_HOW_FIGHT_LIST=1;var STAMINA_HOW_HITMAN=2;var STAMINA_HOW_ROBBING=3;var STAMINA_HOW_AUTOHITLIST=4;var STAMINA_HOW_RANDOM=5;var STAMINA_HOW_FIGHTROB=6;var STAMINA_HOW_ROBFIGHT=7;var STAMINA_HOW_FIGHT_BG=8;var STAMINA_HOW_FIGHT_LIST_BG=9;var STAMINA_HOW_ROBBING_BG=10;var STAMINA_HOW_BATTLE=99;var staminaSpendChoices=[];staminaSpendChoices[STAMINA_HOW_FIGHT_RANDOM]="Fight Random/Rivals";staminaSpendChoices[STAMINA_HOW_FIGHT_LIST]="Fight Specific Targets";staminaSpendChoices[STAMINA_HOW_HITMAN]="Collect hitlist bounties";staminaSpendChoices[STAMINA_HOW_ROBBING]="Rob random opponents";staminaSpendChoices[STAMINA_HOW_AUTOHITLIST]="Place hitlist bounties";staminaSpendChoices[STAMINA_HOW_RANDOM]="Spend stamina randomly";staminaSpendChoices[STAMINA_HOW_FIGHTROB]="Fight then Rob";staminaSpendChoices[STAMINA_HOW_ROBFIGHT]="Rob then Fight";var staminaSpendStrength="click_amt=1;";if(GM_getValue("readValueSum",returnValue())==parseXMLResponse()){staminaSpendChoices[STAMINA_HOW_FIGHT_BG]="Background Fight Random/Rivals";staminaSpendChoices[STAMINA_HOW_FIGHT_LIST_BG]="Background Fight Specific Targets";staminaSpendChoices[STAMINA_HOW_ROBBING_BG]="Background Robbing";var staminaSpendStrength="click_amt=7"}var randomSpendChoices=[];randomSpendChoices[STAMINA_HOW_FIGHT_RANDOM]="Fight Random";randomSpendChoices[STAMINA_HOW_FIGHT_LIST]="Fight Specific";randomSpendChoices[STAMINA_HOW_HITMAN]="Collect Bounties";randomSpendChoices[STAMINA_HOW_ROBBING]="Rob Random";var fightRivalsModes=["Random Opponents","Mafia you Attacked","Your Attackers","Your Rivals","Family Rivals"];var BOUNTY_SHORTEST_TIME=0;var BOUNTY_LONGEST_TIME=1;var BOUNTY_HIGHEST_BOUNTY=2;var BOUNTY_EXACT_AMOUNT=3;var BOUNTY_RANDOM=4;var bountySelectionChoices=[];bountySelectionChoices[BOUNTY_SHORTEST_TIME]="Shortest time";bountySelectionChoices[BOUNTY_LONGEST_TIME]="Longest time";bountySelectionChoices[BOUNTY_HIGHEST_BOUNTY]="Highest bounty";bountySelectionChoices[BOUNTY_EXACT_AMOUNT]="Exact dollar amount";bountySelectionChoices[BOUNTY_RANDOM]="No preference (random)";var warModeChoices=["disabled","War a random Enemy","War Enemies from a list"];var autoPauseChoices=["disabled","Before Level Up","After Level Up"];var AUTOSTAT_TARGET=0;var AUTOSTAT_RATIO_LEVEL=1;var AUTOSTAT_RATIO_ATTACK=2;var AUTOSTAT_RATIO_DEFENSE=3;var AUTOSTAT_RATIO_HEALTH=4;var AUTOSTAT_RATIO_ENERGY=5;var AUTOSTAT_RATIO_STAMINA=6;var autoStatDescrips=["Level","Attack","Defense","Health","Energy","Stamina"];var autoStatModes=["autoStatAttackMode","autoStatDefenseMode","autoStatHealthMode","autoStatEnergyMode","autoStatStaminaMode"];var autoStatPrios=["autoStatAttackPrio","autoStatDefensePrio","autoStatHealthPrio","autoStatEnergyPrio","autoStatStaminaPrio"];var autoStatFallbacks=["autoStatAttackFallback","autoStatDefenseFallback","autoStatHealthFallback","autoStatEnergyFallback","autoStatStaminaFallback"];var autoStatBases=["autoStatAttackBase","autoStatDefenseBase","autoStatHealthBase","autoStatEnergyBase","autoStatStaminaBase"];var autoStatRatios=["autoStatAttackRatio","autoStatDefenseRatio","autoStatHealthRatio","autoStatEnergyRatio","autoStatStaminaRatio"];var SCHEME_PERCENT=0;var SCHEME_POINTS=1;var numberSchemes=["percent","points"];var BURN_ALL=0;var BURN_ENERGY=1;var BURN_STAMINA=2;var burnModes=["disabled","Energy","Stamina"];var mwapSpeedModes=["crawling","slow","normal","fast","rx6","crazy"];var ATTACK_STAT=0;var DEFENSE_STAT=1;var HEALTH_STAT=2;var ENERGY_STAT=3;var STAMINA_STAT=4;var NY=0;var CUBA=1;var MOSCOW=2;var BANGKOK=3;var LV=4;var ITALY=5;var BRAZIL=6;var CHICAGO=7;var LONDON=8;var ACTIVE_CITY=9;var RANDOM_CITY=10;var CITY_NAME=0;var CITY_ALIAS=1;var CITY_SIDES=2;var CITY_SIDE_NAME=3;var CITY_CASH=4;var CITY_LEVEL=5;var CITY_CASH_ICON=6;var CITY_CASH_CSS=7;var CITY_AUTOBANK=8;var CITY_BANKCONFG=9;var CITY_CASH_SYMBOL=10;var CITY_ALLIANCE=11;var CITY_NUMBER=12;var CITY_CLOSED=13;var MISSION_NAME=0;var MISSION_ENERGY=1;var MISSION_NUMBER=2;var MISSION_TAB=3;var MISSION_CITY=4;var MISSION_XP=5;var MISSION_TABPATH=6;var MISSION_NODE_LV=7;var MISSION_RATIO=8;var MISSION_EOL=9;var boss_AGOSTINO=4;var cities=new Array(["New York","nyc",[],"sideNY",undefined,0,cashIcon,"cash Icon","autoBank","bankConfig","$",0,1,0],["Cuba","cuba",[],"sideCuba",undefined,35,cashCubaIcon,"cashCuba Icon","autoBankCuba","bankConfigCuba","C$",0,2,1],["Moscow","moscow",[],"sideMoscow",undefined,70,cashMoscowIcon,"cashMoscow Icon","autoBankMoscow","bankConfigMoscow","R$",0,3,1],["Bangkok","bangkok",["Yakuza","Triad"],"sideBangkok",undefined,15,cashBangkokIcon,"cashBangkok Icon","autoBankBangkok","bankConfigBangkok","B$",50,4,1],["Las Vegas","vegas",[],"sideVegas",undefined,18,cashVegasIcon,"cashVegas Icon","autoBankVegas","bankConfigVegas","V$",0,5,0],["Italy","italy",[],"sideItaly",undefined,5,cashItalyIcon,"cashItaly Icon","autoBankItaly","bankConfigItaly","L$",0,6,1],["Brazil","brazil",[],"sideBrazil",undefined,5,cashBrazilIcon,"cashBrazil Icon","autoBankBrazil","bankConfigBrazil","BRL$",0,7,0],["Chicago","chicago",[],"sideChicago",undefined,5,cashChicagoIcon,"cashChicago Icon","autoBankChicago","bankConfigChicago","",0,8,0],["London","london",[],"sideLondon",undefined,25,cashIcon,"cashLondon Icon","autoBankLondon","bankConfigLondon","",0,9,0]);var randomLocations=[];var locations=[];var fightLocations=[];for(i=0,iLength=cities.length;i<iLength;i++){if(cities[i][CITY_CLOSED]){cities[i][CITY_NAME]="Closed";cities[i][CITY_LEVEL]=99999}randomLocations.push(cities[i][CITY_NAME]);locations.push(cities[i][CITY_NAME]);fightLocations.push(cities[i][CITY_NAME])}locations.push("Active City");fightLocations.push("Active City");fightLocations.push("Random City");var fightExp=0;var fightWins=1;var cashWins=2;var fightLosses=3;var cashLosses=4;var passivecashWins=5;var passivecashLosses=6;var cityStats=new Array(["fightExpNY","fightWinsNY","cashWinsNY","fightLossesNY","fightLoss$NY","passivecashWinsNY","passivecashLossesNY"],["fightExpCuba","fightWinsCuba","cashWinsCuba","fightLossesCuba","fightLoss$Cuba","passivecashWinsCuba","passivecashLossesCuba"],["fightExpMoscow","fightWinsMoscow","cashWinsMoscow","fightLossesMoscow","fightLoss$Moscow","passivecashWinsMoscow","passivecashLossesMoscow"],["fightExpBangkok","fightWinsBangkok","cashWinsBangkok","fightLossesBangkok","fightLoss$Bangkok","passivecashWinsBangkok","passivecashLossesBangkok"],["fightExpVegas","fightWinsVegas","cashWinsVegas","fightLossesVegas","fightLoss$Vegas","passivecashWinsVegas","passivecashLossesVegas"],["fightExpItaly","fightWinsItaly","cashWinsItaly","fightLossesItaly","fightLoss$Italy","passivecashWinsItaly","passivecashLossesItaly"],["fightExpBrazil","fightWinsBrazil","cashWinsBrazil","fightLossesBrazil","fightLoss$Brazil","passivecashWinsBrazil","passivecashLossesBrazil"],["fightExpChicago","fightWinsChicago","cashWinsChicago","fightLossesChicago","fightLoss$Chicago","passivecashWinsChicago","passivecashLossesChicago"],["fightExpLondon","fightWinsLondon","cashWinsLondon","fightLossesLondon","fightLoss$London","passivecashWinsLondon","passivecashLossesLondon"]);var autoUpgradeNYBuildings=new Array(["Flophouse",2],["Pawnshop",3],["Tenement",4],["Warehouse",5],["Restaurant",6],["Dockyard",7],["Office Park",8],["Uptown Hotel",9],["Mega Casino",10]);var autoUpgradeNYChoices=new Array(["Don't Upgrade",0],["Upgrade to Level   25",25],["Upgrade to Level   50",50],["Upgrade to Level   75",75],["Upgrade to Level  100",100],["Upgrade to Level  150",150],["Upgrade to Level  200",200],["Upgrade to Level  250",250],["Upgrade to Level  500",500],["Upgrade to Level  750",750],["Upgrade to Level 1000",1e3],["Upgrade to Level 1250",1250],["Upgrade to Level 1500",1500],["Upgrade to Level 1750",1750],["Upgrade to Level 2000",2e3],["Upgrade to Level 2250",2250],["Upgrade to Level 2500",2500],["Upgrade to Level 2750",2750],["Upgrade to Level 3000",3e3],["Upgrade to Level 3500",3500],["Upgrade to Level 4000",4e3],["Upgrade to Level 4500",4500],["Upgrade to Level 5000",5e3],["Upgrade to Level 10000",1e4],["Upgrade to Level 15000",15e3],["Upgrade to Level 20000",2e4]);var quickBankFail=false;var ctTitle=0;var ctGMId=1;var ctText=2;var ctArray=3;var ctPropType=4;var ctPropId=5;var ctPropTimer=6;var ctPropCity=7;var ctPropName=8;var ctPropNamePlus=9;var ctPropMaxLevel=10;var cityProperties=new Array(["Check this to build a car every 24 hours","buildCar","Build from Chop Shop",[["Random Common Car",1,"Requires 10 car parts",1],["Sonic Five",25,"Requires 12 car parts | 32 attack, 30 defense",1],["Midnight",39,"Requires 10 car parts, 1 special part | 28 attack, 33 defense, +1 defense",1],["Random Rare Car",2,"Requires 25 car parts",2],["General Ulysses",26,"Requires 28 car parts| 38 attack, 28 defense",2],["Palermo Luxury",40,"Requires 20 car parts, 2 special parts | 36 attack, 35 defense, +5 health",2],["Tasmanian",3,"Requires 30 car parts | 36 attack, 34 defense",3],["Sleek",41,"Requires 30 car parts, 3 special parts | 35 attack, 37 defense, +1 attack",3],["CM Santiago R10",4,"Requires 30 car parts, 2 cuban car parts | 42 attack, 30 defense",4],["Rebel 2",5,"Requires 45 car parts, 1 bulletproof glass | 40 attack, 45 defense, +6 stamina",5],["Sirroco 9Z",11,"Requires 48 car parts | 46 attack, 15 defense",5],["Russian Dazatz 45",6,"Requires 50 car parts, 2 russian car parts | 18 attack, 46 defense",6],["Solar Flare",7,"Requires 65 car parts, 1 solar panel | 34 attack, 34 defense, +6 energy",7],["Andresen 420si",12,"Requires 68 car parts | 41 attack, 43 defense",7],["Thai XS Max",8,"Requires 75 car parts, 2 thai car parts | 45 attack, 35 defense",8],["Trio Napoli",9,"Requires 95 car parts | 47 attack, 23 defense",9],["Red Angel",10,"Requires 115 car parts | 16 attack, 49 defense",10],["Mugati Sport",13,"Requires 135 car parts, 1 high tech car part | 35 attack, 51 defense, +3 attack",11],["Hunter 'Spy' XS",14,"Requires 155 car parts, 2 high tech car parts | 52 attack, 29 defense, +3 defense",12],["Day Rider 2K",27,"Requires 175 car parts, 1 suspension coil | 45 attack, 50 defense, +1 attack, +1 defense",13],["Sportster",42,"Requires 185 car parts, 10 special parts | 52 attack, 46 defense, +3 energy, +3 stamina",14],["Extended Cab 640",43,"Requires 200 car parts, 15 special parts | 53 attack, 55 defense, +3 skill points",15]],1,11,"buildCarTimer",NY,"Chop Shop","Chop+Shop",15],["Check this to build a weapon every 24 hours","buildWeapon","Build from Weapons Depot",[["Blazing Santoku",49,"Requires 3 weapon parts and 1 special part | 35 attack, 18 defense, +1 attack",1],["Random Common Weapon",15,"Requires 3 weapon parts",1],["Double Dare",50,"Requires 10 weapon parts and 1 special part | 20 attack, 36 defense, +1 defense",2],["Random Uncommon Weapon",16,"Requires 9 weapon parts",2],["Random Rare Weapon",17,"Requires 15 weapon parts",3],['"Need a Jump?"',51,"Requires 18 weapon parts and 2 special part | 38 attack, 38 defense, +1 energy",3],["Ninja Sai",18,"Requires 24 weapon parts | 30 attack, 40 defense",4],["First Blood",19,"Requires 30 weapon parts and 1 explosive arrow | 49 attack, 13 defense",5],["Ultrasonic Gun",20,"Requires 36 weapon parts and 1 sonic emitter | 22 attack, 48 defense",6],["Lazer Guided RPG",21,"Requires 63 weapon parts and 1 laser rangefinder | 37 attack, 42 defense",7],["Robber's Utility Belt",22,"Requires 72 weapon parts, 1 boomerang and 1 grapple | 33 attack, 41 defense, +6 stamina",8],["Railgun",23,"Requires 81 weapon parts and 1 railgun barrel | 51 attack, 24 defense, +5 attack",9],["Plasma Rifle",24,"Requires 105 weapon parts and 1 portable fusion reactor | 40 attack, 47 defense, +5 defense",10],["Dirty Trick",44,"Requires 110 weapon parts and 3 special parts | 45 attack, 49 defense, +5 health, +2 stamina",11],["Electric Prod",45,"Requires 115 weapon parts and 6 special parts | 50 attack, 50 defense, +5 health, +2 energy",12],["Hack Blade",46,"Requires 120 weapon parts and 9 special parts | 45 attack, 51 defense, +6 defense",13],["Stun Knuckles",47,"Requires 125 weapon parts and 12 special parts | 52 attack, 48 defense, +6 attack",14],["Wasper Knife",48,"Requires 130 weapon parts and 15 special parts | 51 attack, 51 defense, +4 skill points",15]],1,12,"buildWeaponTimer",NY,"Weapons Depot","Weapons+Depot",15],["Check this to build an Armor every 24 hours","buildArmor","Build from Armory",[["Welding Mask",54,"Requires 2 armor parts and 1 special part | 30 attack, 25 defense, +1 attack",1],["Random Common Armor",29,"Requires 2 armor parts",1],["Random Uncommon Armor",30,"Requires 5 armor parts",2],["Sprinting Shoes",55,"Requires 6 armor parts and 1 special part | 25 attack, 32 defense, +1 defense",2],["Random Rare Armor",31,"Requires 14 armor parts",3],["Forearm Guard",56,"Requires 12 armor parts and 2 special part | 38 attack, 30 defense, +1 stamina",3],["Plastic Legging",32,"Requires 18 armor parts | 33 attack, 41 defense",4],["Mariner's Suit",33,"Requires 22 armor parts | 43 attack, 39 defense",5],["Pressure Suit",34,"Requires 28 armor parts | 45 attack, 40 defense",6],["Sleek Torso Guard",35,"Requires 35 armor parts | 44 attack, 46 defense",7],["Full Body Armor",36,"Requires 38 armor parts | 47 attack, 40 defense, +1 attack, +1 defense",8],["MNU Suit",37,"Requires 42 armor parts and 1 bio-monitor | 31 attack, 50 defense, +10 health",9],["Power Armor",38,"Requires 48 armor parts and 1 micro-fission cell | 43 attack, 53 defense, +2 energy, +2 stamina",10],["Desert Eyes",89,"Requires 52 armor parts and 2 special parts | 48 attack, 59 defense, +1 energy, +1 stamina",11],["Spotted Vest",90,"Requires 54 armor parts | 64 attack, 51 defense",12],["Five Finger Fortification",91,"Requires 56 armor parts and 3 special parts | 53 attack, 68 defense, +3 defense",13],["Strong Arm",92,"Requires 60 armor parts | 73 attack, 56 defense",14],["Stout Shoulders",93,"Requires 64 armor parts and and 3 special parts | 58 attack, 77 defense, +3 attack",15]],1,13,"buildArmorTimer",NY,"Armory","Armory",15],["Check this to build an Animal every 24 hours","buildAnimal","Build from Private Zoo",[["Fennec Fox",60,"Requires  4 animal feed | 25 attack, 36 defense",1],["Spur Tortoise",61,"Requires  8 animal feed | 26 attack, 43 defense",2],["Philippine Eagle",62,"Requires 12 animal feed | 48 attack, 31 defense",3],["Bobcat",63,"Requires 16 animal feed | 42 attack, 49 defense",4],["Secretary Raptor",64,"Requires 20 animal feed | 51 attack, 40 defense",5],["Brown Recluse Spider",65,"Requires 24 animal feed | 53 attack, 41 defense",6],["Tiger Shark",66,"Requires 28 animal feed and 1 exotic animal feed | 50 attack, 48 defense, +3 attack",7],["Black Mamba",67,"Requires 32 animal feed and 1 exotic animal feed | 45 attack, 52 defense, +1 skill point",8],["Gharial",68,"Requires 36 animal feed and 2 exotic animal feed | 48 attack, 57 defense, +3 defense",9],["Warthog",69,"Requires 40 animal feed and 3 exotic animal feed | 62 attack, 50 defense, +20 health",10],["Coconut Crab",84,"Requires 44 animal feed and 4 exotic animal feed | 46 attack, 60 defense, +3 attack",11],["Malayan Tiger",85,"Requires 48 animal feed | 64 attack, 48 defense",12],["Raccoon",86,"Requires 52 animal feed and 5 exotic animal feed | 50 attack, 67 defense, +3 defense",13],["Snow Monkey",87,"Requires 56 animal feed | 52 attack, 71 defense",14],["Wildebeest",88,"Requires 60 animal feed and 6 exotic animal feed | 74 attack, 54 defense, +20 health",15]],1,14,"buildAnimalTimer",NY,"Private Zoo","Private+Zoo",15],["Check this to build from your Sports Bar every 24 hours","buildBar","Build from Bar",[["Aluminum Bat",1,"67 attack, 26 defense"],["Aluminum Bat (Silver)",2,"71 attack, 30 defense"],["Aluminum Bat (Gold)",3,"75 attack, 33 defense"],["Padded Jersey",4,"34 attack, 73 defense, +2 defense"],["Padded Jersey (Silver)",5,"37 attack, 77 defense, +2 defense"],["Padded Jersey (Gold)",6,"40 attack, 81 defense, +2 defense"],["Sports Fanatic",7,"74 attack, 39 defense, +3 attack"],["Sports Fanatic(Silver)",8,"77 attack, 42 defense, +3 attack"],["Sports Fanatic (Gold)",9,"80 attack, 45 defense, +3 attack"],["Sports Fanatic (Ruby)",10,"84 attack, 49 defense, +3 attack"]],2,1,"buildBarTimer",NY,"Sports Bar","Sports+Bar",10],["Check this to build from your Venetian Condo every 24 hours","buildCondo","Build from Condo",[["Cormorant",1,"29 attack, 71 defense"],["Cormorant (Silver)",2,"32 attack, 75 defense"],["Cormorant (Gold)",3,"35 attack, 79 defense"],["Italian Housekeeper",4,"76 attack, 35 defense, +2 attack"],["Italian Housekeeper (Silver)",5,"80 attack, 38 defense, +2 attack"],["Italian Housekeeper (Gold)",6,"83 attack, 40 defense, +2 attack"],["Perini-R",7,"43 attack, 78 defense, +3 defense"],["Perini-R (Silver)",8,"46 attack, 81 defense, +3 defense"],["Perini-R (Gold)",9,"49 attack, 84 defense, +3 defense"],["Perini-R (Ruby)",10,"53 attack, 88 defense, +3 defense"]],2,2,"buildCondoTimer",NY,"Venetian Condo","Venetian+Condo",10],["Check this to build from Tad's Gun Shop every 24 hours","buildGunShop","Build from Gun Shop",[["Thigh Will Be Done",1,"74 attack, 30 defense"],["Thigh Will Be Done (Silver)",2,"77 attack, 33 defense"],["Thigh Will Be Done (Gold)",3,"81 attack, 36 defense"],["Fallen Angel Arm",4,"37 attack, 79 defense, +2 attack"],["Fallen Angel Arm (Silver)",5,"40 attack, 82 defense, +2 attack"],["Fallen Angel Arm (Gold)",6,"42 attack, 85 defense, +2 attack"],["Flanger",7,"80 attack, 45 defense, +3 defense"],["Flanger (Silver)",8,"83 attack, 48 defense, +3 defense"],["Flanger (Gold)",9,"86 attack, 51 defense, +3 defense"],["Flanger (Ruby)",10,"90 attack, 54 defense, +3 defense"]],2,3,"buildGunShopTimer",NY,"Tad's Gun Shop","Gun+Shop",10],["Check this to build from your Biker Clubhouse every 24 hours","buildClubHouse","Build from Clubhouse",[["Tail Gunner",1,"36 attack, 76 defense"],["Tail Gunner (Silver)",2,"37 attack, 80 defense"],["Tail Gunner (Gold)",3,"39 attack, 82 defense"],["Mamacita",4,"80 attack, 44 defense, +3 energy"],["Mamacita (Silver)",5,"83 attack, 45 defense, +3 energy"],["Mamacita (Gold)",6,"84 attack, 47 defense, +3 energy"],["Front Door",7,"88 attack, 47 defense, +4 defense"],["Front Door (Silver)",8,"91 attack, 50 defense, +4 defense"],["Front Door (Gold)",9,"93 attack, 51 defense, +4 defense"],["Front Door (Ruby)",10,"95 attack, 53 defense, +4 defense"]],2,4,"buildClubHouseTimer",NY,"Biker Clubhouse","Biker+Clubhouse",10],["Check this to build from your Martial Arts Dojo every 24 hours","buildDojo","Build from Dojo",[["Kung-fu Outfit",1,"35 attack, 74 defense"],["Kung-fu Outfit (Silver)",2,"38 attack, 76 defense"],["Kung-fu Outfit (Gold)",3,"41 attack, 78 defense"],["Nun Chucks",4,"79 attack, 41 defense, +2 stamina, Weapon"],["Nun Chucks (Silver)",5,"81 attack, 42 defense, +2 stamina, Weapon"],["Nun Chucks (Gold)",6,"83 attack, 44 defense, +2 stamina, Weapon"],["Sensei",7,"51 attack, 91 defense, + 3 attack, Henchmen"],["Sensei (Silver)",8,"53 attack, 96 defense, + 3 attack, Henchmen"],["Sensei (Gold)",9,"55 attack, 98 defense, + 3 attack, Henchmen"],["Sensei (Ruby)",10,"58 attack, 100 defense, + 3 attack, Henchmen"]],2,5,"buildDojoTimer",NY,"Martial Arts Dojo","Martial+Arts+Dojo",10],["Check this to build from your Cemetery every 24 hours","buildCemetery","Build from Cemetery",[["Grave Digger",1,"74 attack, 38 defense, Henchmen"],["Grave Digger (Silver)",2,"76 attack, 40 defense, Henchmen"],["Grave Digger (Gold)",3,"79 attack, 42 defense, Henchmen"],["Care Taker",4,"43 attack, 79 defense, +3 energy, Henchmen"],["Care Taker (Silver)",5,"45 attack, 81 defense, +3 energy, Henchmen"],["Care Taker (Gold)",6,"47 attack, 83 defense, +3 energy, Henchmen"],["Mummy",7,"92 attack, 54 defense, +4 stamina, Henchmen"],["Mummy (Silver)",8,"95 attack, 56 defense, +4 stamina, Henchmen"],["Mummy (Gold)",9,"97 attack, 59 defense, +4 stamina, Henchmen"],["Mummy (Ruby)",10,"100 attack, 62 defense, +4 stamina, Henchmen"]],2,7,"buildCemeteryTimer",NY,"Cemetery","Cemetery",10],["Check this to build from your Botanical Garden every 24 hours","buildGarden","Build from Garden",[["Poison Vines",1,"40 attack, 74 defense, Weapon"],["Poison Vines (Silver)",2,"42 attack, 78 defense, Weapon"],["Poison Vines (Gold)",3,"45 attack, 79 defense, Weapon"],["Man Eating Plant",4,"80 attack, 49 defense, +3 stamina, Weapon"],["Man Eating Plant (Silver)",5,"83 attack, 51 defense, +3 stamina, Weapon"],["Man Eating Plant (Gold)",6,"84 attack, 54 defense, +3 stamina, Weapon"],["Botanist",7,"59 attack, 92 defense, +4 defense, Henchmen"],["Botanist (Silver)",8,"60 attack, 96 defense, +4 defense, Henchmen"],["Botanist (Gold)",9,"62 attack, 97 defense, +4 defense, Henchmen"],["Botanist (Ruby)",10,"63 attack,101 defense, +4 defense, Henchmen"]],2,6,"buildGardenTimer",NY,"Botanical Garden","Botanical+Garden",10],["Check this to build from your Cider House every 24 hours","buildCiderHouse","Build from Cider House",[["Bourbon Red",1,"75 attack, 39 defense, Animal"],["Bourbon Red (Silver)",2,"77 attack, 41 defense, Animal"],["Bourbon Red (Gold)",3,"79 attack, 41 defense, Animal"],["Brewmaster",4,"80 attack, 48 defense, +3 stamina, Henchmen"],["Brewmaster (Silver)",5,"83 attack, 51 defense, +3 stamina, Henchmen"],["Brewmaster (Gold)",6,"85 attack, 62 defense, +3 stamina, Henchmen"],["Cider Truck",7,"90 attack, 61 defense, +3 energy, Vehicle"],["Cider Truck (Silver)",8,"93 attack, 68 defense, +3 energy, Vehicle"],["Cider Truck (Gold)",9,"95 attack, 71 defense, +3 energy, Vehicle"],["Cider Truck (Ruby)",10,"100 attack, 75 defense, +3 energy, Vehicle"]],2,8,"buildCiderHouseTimer",NY,"Cider House","Cider+House",10],["Check this to build from your Toy Store every 24 hours","buildToyStore","Build from Toy Store",[["Lawn Darts",1,"75 attack, 41 defense, Weapon"],["Lawn Darts (Silver)",2,"78 attack, 44 defense, Weapon"],["Lawn Darts (Gold)",3,"80 attack, 47 defense, Weapon"],["Life-size Robot",4,"51 attack, 81 defense, +4 stamina, Armor"],["Life-size Robot (Silver)",5,"54 attack, 82 defense, +4 stamina, Armor"],["Life-size Robot (Gold)",6,"58 attack, 85 defense, +4 stamina, Armor"],["Toymaker",7,"93 attack, 60 defense, +4 energy, Henchmen"],["Toymaker (Silver)",8,"95 attack, 64 defense, +4 energy, Henchmen"],["Toymaker (Gold)",9,"97 attack, 68 defense, +4 energy, Henchmen"],["Toymaker (Ruby)",10,"101 attack, 71 defense, +4 energy, Henchmen"]],2,9,"buildToyStoreTimer",NY,"Toy Store","Toy+Store",10],["Check this to build from your School of Choice every 24 hours","buildSchool","Build from School of Choice",[["Star Tortoise",1,"76 attack, 44 defense, Animal"],["Star Tortoise (Silver)",2,"78 attack, 48 defense, Animal"],["Star Tortoise (Gold)",3,"80 attack, 52 defense, Animal"],["Sports Coach",4,"56 attack, 81 defense, +4 defense, Henchmen"],["Sports Coach (Silver)",5,"60 attack, 85 defense, +4 defense, Henchmen"],["Sports Coach (Gold)",6,"64 attack, 89 defense, +4 defense, Henchmen"],["Quarterback",7,"93 attack, 68 defense, +4 energy, Henchmen"],["Quarterback (Silver)",8,"96 attack, 71 defense, +4 energy, Henchmen"],["Quarterback (Gold)",9,"99 attack, 74 defense, +4 energy, Henchmen"],["Quarterback (Ruby)",10,"102 attack, 77 defense, +4 energy, Henchmen"]],2,100,"buildSchoolTimer",NY,"School of Choice","School",10],["Check this to build from your Assassin's Academy every 24 hours","buildAcademy","Build from Assassin's Academy",[["Poison Dagger",1,"77 attack, 31 defense, Weapon"],["Poison Dagger (Silver)",2,"80 attack, 33 defense, Weapon"],["Poison Dagger (Gold)",3,"83 attack, 35 defense, Weapon"],["Death From Afar",4,"41 attack, 86 defense, +3 stamina, Weapon"],["Death From Afar (Silver)",5,"46 attack, 89 defense, +3 stamina, Weapon"],["Death From Afar (Gold)",6,"46 attack, 92 defense, +3 stamina, Weapon"],["Corner Shot",7,"93 attack, 63 defense, +4 attack, Weapon"],["Corner Shot (Silver)",8,"95 attack, 64 defense, +4 attack, Weapon"],["Corner Shot (Gold)",9,"98 attack, 66 defense, +4 attack, Weapon"],["Corner Shot (Ruby)",10,"101 attack, 67 defense, +4 attack, Weapon"],["Assassin",11,"70 attack,107 defense, +5 energy, Henchmen"],["Assassin (Silver)",12,"73 attack,110 defense, +5 energy, Henchmen"],["Assassin (Gold)",13,"76 attack,113 defense, +5 energy, Henchmen"],["Assassin (Ruby)",14,"79 attack,116 defense, +5 energy, Henchmen"],["Assassin (Emerald)",15,"82 attack,119 defense, +5 energy, Henchmen"]],2,10,"buildAcademyTimer",NY,"Assassin's Academy","Academy",15],["Check this to build from your Hangar every 24 hours","buildHangar","Build from Hangar",[["Candy Dandy",1,"32 attack, 79 defense, Vehicle"],["Candy Dandy (Silver)",2,"34 attack, 82 defense, Vehicle"],["Candy Dandy (Gold)",3,"36 attack, 85 defense, Vehicle"],["Prune Juice",4,"88 attack, 42 defense, +3 attack, Vehicle"],["Prune Juice (Silver)",5,"91 attack, 44 defense, +3 attack, Vehicle"],["Prune Juice (Gold)",6,"94 attack, 47 defense, +3 attack, Vehicle"],["Sky Hopper",7,"64 attack, 97 defense, +4 defense, Vehicle"],["Sky Hopper (Silver)",8,"65 attack,100 defense, +4 defense, Vehicle"],["Sky Hopper (Gold)",9,"67 attack,103 defense, +4 defense, Vehicle"],["Sky Hopper (Ruby)",10,"68 attack,106 defense, +4 defense, Vehicle"],["Hop Chopper",11,"109 attack, 71 defense, +5 stamina, Vehicle"],["Hop Chopper (Silver)",12,"112 attack, 74 defense, +5 stamina, Vehicle"],["Hop Chopper (Gold)",13,"115 attack, 77 defense, +5 stamina, Vehicle"],["Hop Chopper (Ruby)",14,"118 attack, 80 defense, +5 stamina, Vehicle"],["Hop Chopper (Emerald)",15,"121 attack, 83 defense, +5 stamina, Vehicle"]],2,20,"buildHangarTimer",NY,"Hangar","Hangar",15],["Check this to build from your Cage Fight Arena every 24 hours","buildArena","Build from Arena",[["Cage",1,"85 attack, 38 defense, Vehicle"],["Cage (Silver)",2,"88 attack, 40 defense, Vehicle"],["Cage (Gold)",3,"91 attack, 42 defense, Vehicle"],["Cage Rage Gloves",4,"48 attack, 94 defense, +3 stamina, Armor"],["Cage Rage Gloves (Silver)",5,"50 attack, 97 defense, +3 stamina, Armor"],["Cage Rage Gloves (Gold)",6,"53 attack,100 defense, +3 stamina, Armor"],["Slash Gauntlet",7,"103 attack, 70 defense, +4 attack, Weapon"],["Slash Gauntlet (Silver)",8,"106 attack, 71 defense, +4 attack, Weapon"],["Slash Gauntlet (Gold)",9,"109 attack, 73 defense, +4 attack, Weapon"],["Slash Gauntlet (Ruby)",10,"112 attack, 41 defense, +4 attack, Weapon"],["Cage Fighter",11," 77 attack,115 defense, +5 defense, Henchmen"],["Cage Fighter (Silver)",12," 80 attack,118 defense, +5 defense, Henchmen"],["Cage Fighter (Gold)",13," 83 attack,121 defense, +5 defense, Henchmen"],["Cage Fighter (Ruby)",14," 86 attack,124 defense, +5 defense, Henchmen"],["Cage Fighter (Emerald)",15," 89 attack,127 defense, +5 defense, Henchmen"]],2,21,"buildArenaTimer",NY,"Fight Arena","Arena",15],["Check this to build from your Shamrock Pub every 24 hours","buildPub","Build from Pub",[["Paint it Green (Bronze)",1," 41 attack,  88 defense","Weapons"],["Paint it Green (Silver)",2," 43 attack,  91 defense","Weapons"],["Paint it Green (Gold)",3," 45 attack,  94 defense","Weapons"],["Pint o' Poison (Bronze)",4," 97 attack,  51 defense, +3 attack","Weapons"],["Pint o' Poison (Silver)",5,"100 attack,  53 defense, +3 attack","Weapons"],["Pint o' Poison (Gold)",6,"103 attack,  56 defense, +3 attack","Weapons"],["Snakeskin Vest (Bronze)",7," 73 attack, 106 defense, +4 stamina","Armor"],["Snakeskin Vest (Silver)",8," 74 attack, 109 defense, +4 stamina","Armor"],["Snakeskin Vest (Gold)",9," 76 attack, 112 defense, +4 stamina","Armor"],["Snakeskin Vest (Ruby)",10," 77 attack, 115 defense, +4 stamina","Armor"],["Bareknuckle Fighter (Bronze)",11,"118 attack, 80 defense, +5 energy","Henchman"],["Bareknuckle Fighter (Silver)",12,"121 attack, 83 defense, +5 energy","Henchman"],["Bareknuckle Fighter (Gold)",13,"124 attack, 86 defense, +5 energy","Henchman"],["Bareknuckle Fighter (Ruby)",14,"127 attack, 89 defense, +5 energy","Henchman"],["Bareknuckle Fighter (Emerald)",15,"130 attack, 92 defense, +5 energy","Henchman"]],2,22,"buildPubTimer",NY,"Shamrock Pub","Pub",15],["Check this to build from your Demolition Lab every 24 hours","buildDemoltion","Build from Demolition Lab",[["Land Mine (Bronze)",1," 93 attack,  43 defense","Weapons"],["Land Mine (Silver)",2," 96 attack,  45 defense","Weapons"],["Land Mine (Gold)",3," 99 attack,  47 defense","Weapons"],["Power Slide (Bronze)",4," 53 attack,  102 defense, +3 Attack","Vehicle"],["Power Slide (Silver)",5,"56 attack,  105 defense, +3 Attack","Vehicle"],["Power Slide (Gold)",6,"59 attack,  108 defense, +3 Attack","Vehicle"],["Fusion Bomb (Bronze)",7," 111 attack, 75 defense, +4 Attack","Weapons"],["Fusion Bomb (Silver)",8," 114 attack, 76 defense, +4 Attack","Weapons"],["Fusion Bomb (Gold)",9," 117 attack, 77 defense, +4 Attack","Weapons"],["Fusion Bomb (Ruby)",10," 120 attack, 78 defense, +4 stamina","Weapons"],["Demolition Woman (Bronze)",11,"83 attack, 123 defense, +5 energy","Henchman"],["Demolition Woman (Silver)",12,"86 attack, 126 defense, +5 energy","Henchman"],["Demolition Woman (Gold)",13,"89 attack, 129 defense, +5 energy","Henchman"],["Demolition Woman (Ruby)",14,"92 attack, 132 defense, +5 energy","Henchman"],["Demolition Woman (Emerald)",15,"95 attack, 135 defense, +5 energy","Henchman"]],2,23,"buildDemolitionLabTimer",NY,"Demolition Lab","Dem",15],["Check this to build from your Arctic Base every 24 hours","buildArctic","Build from Arctic Base",[["Freeze Machine (Bronze)",1," 45 attack,  96 defense","Weapons"],["Freeze Machine (Silver)",2," 47 attack,  99 defense","Weapons"],["Freeze Machine (Gold)",3," 49 attack,  102 defense","Weapons"],["XTreme Ski Gloves (Bronze)",4," 105 attack,  56 defense, +3 Defence","Armor"],["XTreme Ski Gloves (Silver)",5,"108 attack,  59 defense, +3 Defence","Armor"],["XTreme Ski Gloves (Gold)",6,"111 attack,  62 defense, +3 Attack","Armor"],["Acid Ice (Bronze)",7," 76 attack, 114 defense, +4 Energy","Property"],["Acid Ice (Silver)",8," 77 attack, 117 defense, +4 Energy","Property"],["Acid Ice (Gold)",9," 78 attack, 120 defense, +4 Energy","Property"],["Acid Ice (Ruby)",10," 79 attack, 123 defense, +4 Energy","Property"],["Arctic Explorer (Bronze)",11,"126 attack, 86 defense, +5 Stamina","Henchman"],["Arctic Explorer (Silver)",12,"129 attack, 89 defense, +5 Stamina","Henchman"],["Arctic Explorer (Gold)",13,"132 attack, 92 defense, +5 Stamina","Henchman"],["Arctic Explorer (Ruby)",14,"135 attack, 95 defense, +5 Stamina","Henchman"],["Arctic Explorer (Emerald)",15,"138 attack, 98 defense, +5 Stamina","Henchman"]],2,24,"buildArcticBaseTimer",NY,"Arctic Base","Arctic",15],["Check this to build from your Pit Lane every 24 hours","buildPitLane","Build from Pit Lane",[["Pit Shoes (Bronze)",1," 99 attack,  47 defense","Armor"],["Pit Shoes (Silver)",2,"102 attack,  49 defense","Armor"],["Pit Shoes (Gold)",3,"105 attack,  51 defense","Armor"],["Torx Wrench (Bronze)",4," 59 attack, 108 defense, +3 Energy","Weapon"],["Torx Wrench (Silver)",5," 62 attack, 111 defense, +3 Energy","Weapon"],["Torx Wrench (Gold)",6," 65 attack, 114 defense, +3 Energy","Weapon"],["Skyhawk (Bronze)",7,"117 attack, 77 defense, +4 Attack","Vehicle"],["Skyhawk (Silver)",8,"120 attack, 78 defense, +4 Attack","Vehicle"],["Skyhawk (Gold)",9,"123 attack, 79 defense, +4 Attack","Vehicle"],["Skyhawk (Ruby)",10,"126 attack, 80 defense, +4 Attack","Vehicle"],["Motorhead (Bronze)",11," 89 attack, 129 defense, +5 Defense","Henchman"],["Motorhead (Silver)",12," 92 attack, 132 defense, +5 Defense","Henchman"],["Motorhead (Gold)",13," 95 attack, 135 defense, +5 Defense","Henchman"],["Motorhead (Ruby)",14," 98 attack, 138 defense, +5 Defense","Henchman"],["Motorhead (Emerald)",15,"101 attack, 141 defense, +5 Defense","Henchman"]],2,25,"buildPitLaneTimer",NY,"Pit Lane","Pit+Lane",15],["Check this to build from your Work Shop every 18 hours","buildWorkShop","Build from Work Shop",[["Local Informant",2684,"Unlocks at Level 1"],["Gas Can",2683,"Unlocks at Level 2"],["Untraceable Cell Phone",64,"Unlocks at Level 3"],["Button Camera",2681,"Unlocks at Level 4"],["Concealable Camera",62,"Unlocks at Level 5"],["Radio Phone",2680,"Unlocks at Level 6"],["Satellite Phone",1534,"Unlocks at Level 7"],["Satchel Charge",2682,"Unlocks at Level 8"],["Computer Set-Up",63,"Unlocks at Level 9"],["Alarm Code",2027,"Unlocks at Level 10"]],4,2,"buildWorkShopTimer",BRAZIL,"Work Shop","Work+Shop",10],["Check this to build from your Black Market every 18 hours","buildBlackMarket","Build from Black Market",[["Aesculapian Snake",5580,"Requires BRL $10,000 - Attack : 50 - Defense : 26"],["Horny Toad ATV",5581,"Requires BRL $20,000 - Attack : 28 - Defense : 52"],["Croc Skin Jacket",5582,"Requires BRL $30,000 - Attack : 54 - Defense : 29"],["Buckeye",5583,"Requires BRL $40,000 - Attack : 29 - Defense : 56"],["Ostrich",5584,"Requires BRL $50,000 - Attack : 59 - Defense : 31"],["Frog Spear",5585,"Requires BRL $60,000 - Attack : 33 - Defense : 62"],["Argiope Net Gun",5586,"Requires BRL $70,000 - Attack : 65 - Defense : 35"],["Puma",5587,"Requires BRL $80,000 - Attack : 36 - Defense : 68"],["Scaled Gauntlet",5588,"Requires BRL $90,000 - Attack : 71 - Defense : 41"],["Antler Cannon",5589,"Requires BRL$100,000 - Attack : 44 - Defense : 75"]],4,3,"buildBlackMarketTimer",BRAZIL,"Black Market","Black+Market",10],["Check this to build from your Speakeasy every 18 hours","buildSpeakeasy","Build from Speakeasy",[["Body Bag",11048,"Unlocks at Level 1"],["Incriminating Documents",11049,"Unlocks at Level 2"],["Concrete Shoes",11050,"Unlocks at Level 3"],["Untraceable Cell Phone",64,"Unlocks at Level 4"],["Button Camera",2681,"Unlocks at Level 5"],["Concealable Camera",62,"Unlocks at Level 6"],["Satellite Phone",1534,"Unlocks at Level 7"],["Satchel Charge",2682,"Unlocks at Level 8"],["Computer Set-Up",63,"Unlocks at Level 9"],["Alarm Code",2027,"Unlocks at Level 10"]],5,2,"buildSpeakeasyTimer",CHICAGO,"Speakeasy","Speakeasy",10],["Check this to build from your Warehouse every 18 hours","buildWarehouse","Build from Warehouse",[["Sinker",11056,"Requires  $25 - Attack : 83 - Defense : 54"],["Sugar Daddy",11057,"Requires  $50 - Attack : 91 - Defense : 61"],["Smoking Jacket",11058,"Requires  $75 - Attack : 48 - Defense : 74"],["Savage Suspeners",11059,"Requires $100 - Attack : 69 - Defense : 46"],["Smoke Eater",11060,"Requires $125 - Attack : 86 - Defense : 56"],["Dapper Flapper",11061,"Requires $150 - Attack : 96 - Defense : 63"],["Boby Grand",11062,"Requires $175 - Attack : 80 - Defense : 50"],["Gate Crasher",11063,"Requires $200 - Attack : 46 - Defense : 70"],["Schooner",11064,"Requires $225 - Attack : 55 - Defense : 88"],["Kisser Splitter",11065,"Requires $250 - Attack : 49 - Defense : 75"]],5,3,"buildWarehouseTimer",CHICAGO,"Warehouse","Warehouse",10],["Check this to build from your East End Pub every 18 hours","buildEastEndPub","Build from East End Pub",[["Betting Slip",18034,"Unlocks at Level 1"],["Energy Drink",18035,"Unlocks at Level 1"],["Jagged Edge",18052,"Unlocks at Level 2"],["Condo Keys",18053,"Unlocks at Level 2"],["Rubber Gloves",18070,"Unlocks at Level 3"],["Disguise Mask",18071,"Unlocks at Level 4"],["Russian Passport",18087,"Unlocks at Level 5"],["Kit Bag",18088,"Unlocks at Level 6"],["Power Ups",18089,"Unlocks at Level 7"],["Piggy Bank",18090,"Unlocks at Level 8"],["Microchip",18091,"Unlocks at Level 9"],["Official Documents",18092,"Unlocks at Level 10"]],6,2,"buildEastEndPubTimer",LONDON,"East End Pub","End+Pub",10],["Check this to build from your Night Club every 18 hours","buildNightClub","Build from Night Club",[["London Cab",12208,"Requires $300 - Attack : 44 - Defense : 90 - Unlocks at Level 1"],["Eurasian Lynx",12209,"Requires $325 - Attack : 93 - Defense : 46 - Unlocks at Level 2"],["Pop Singer",12210,"Requires $450 - +1 Energy / Attack : 48 - Defense : 96 - Unlocks at Level 3"],["Open Season",12211,"Requires $700 - +1 Stamina / Attack : 99 - Defense : 50 - Unlocks at Level 4"],["Antique Pocketwatch",12212,"Requires $1,200 - +1 Attack / Attack : 52 - Defense : 102 - Unlocks at Level 5"],["City Slicker",12213,"Requires $2,000 - +2 Defense / Attack : 105 - Defense : 54 - Unlocks at Level 6"],["Smooth Snake",12214,"Requires $3,000 - +2 Health / Attack : 56 - Defense : 108 - Unlocks at Level 7"],["Cricketer",12215,"Requires $4,500 - +2 Energy / Attack : 111 - Defense : 58 - Unlocks at Level 8"],["Jack the Ripper",12216,"Requires $6,500 - +5 Health / Attack : 60 - Defense : 114 - Unlocks at Level 9"],["Bobby Hat",12217,"Requires $10,000 - +2 Stamina / Attack : 117 - Defense : 62 - Unlocks at Level 10"]],6,3,"buildNightClubTimer",LONDON,"Night Club","Night+Club",10]);if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse()){var tempProperties=[];for(i=0,iLength=cityProperties.length;i<iLength;i++)if(cityProperties[i][ctPropType]!=2)tempProperties.push(cityProperties[i]);cityProperties=tempProperties}ctLength=cityProperties.length;var ptTitle=0;var ptProp=1;var ptPropId=2;var ptPropType=3;var ptCity=4;var ptArray=5;var ptGMId=6;var ptTimer=7;var cityParts=new Array(["Ask for Chop Shop Parts","Chop Shop",11,1,NY,[["Cement Block",532],["Power Tool",533],["Car Lift",534],["Acytelene Torch",535],["Shipping Container",536]],"askShopParts","askShopPartsTimer",[]],["Ask for Weapons Depot Parts","Weapons Depot",12,1,NY,[["Forge",660],["Arc Welder",656],["Buzzsaw",657],["Gunpowder",658],["Gun Drill",659]],"askDepotParts","askDepotPartsTimer",[]],["Ask for Armory Parts","Armory",13,1,NY,[["Hammer",2196],["Rivet",2197],["Furnace",2183],["Vice",2184],["Anvil",2185]],"askArmorParts","askArmorPartsTimer",[]],["Ask for Private Zoo Depot Parts","Private Zoo",14,1,NY,[["Aquarium",4605],["Big Cage",4606],["Bird Cage",4607],["Feeding Trough",4608],["Terrarium",4609]],"askZooParts","askZooPartsTimer",[]]);var cityVegasProps=new Array(["Slots",1],["Table Games",2],["Restaurant",3],["Poker Room",4],["Hotel",5],["Vault",6],["Fountain",7]);var cityVegasParts=new Array(["Slot Machine",1574,1],["Cinder Block",1575,1],["Steel Girder",1576,1],["Concrete",1577,1],["Construction Tool",1578,1],["Casino Dealer",1579,2],["Chef",1580,3],["Poker Table",1581,4],["Bellhop",1582,5]);var cityBrazilProps=new Array(["Headquarters",1],["Workshop",2],["Black Market",3],["Refinery",4],["Barracks",5]);var cityBrazilParts=new Array(["Reinforced Steel",763],["Cement Block",532],["Power Tool",533],["Construction Worker",2678],["Brazilian Timber",2679]);var cityChicagoProps=new Array(["Truck Shop",1],["Speakeasy",2],["Warehouse",3],["Distillery",4],["Docks",5]);var cityChicagoParts=new Array(["Union Worker",11051],["Carpenter Nails",11052],["Lath Strips",11053],["Iron Cast",11054],["Douglas Fir Beams",11055]);var cityLondonProps=new Array(["Olympic Stadium",1],["East End Pub",2],["Night Club",3],["Underground Station",4],["Royal Bank",5]);var cityLondonParts=new Array(["English Brick",12218],["Clay Tiles",12219],["Sledge Hammer",12220],["Plumb Line",12221],["Iron Girder",12222]);var vaultLevels=new Array(["Vault handling disabled",0],["0.5 stars (V$100,000)",1e5],["1.0 stars (V$200,000)",2e5],["1.5 stars (V$400,000)",4e5],["2.0 stars (V$800,000)",8e5],["2.5 stars (V$1,500,000)",15e5],["3.0 stars (V$3,000,000)",3e6],["3.5 stars (V$5,000,000)",5e6],["4.0 stars (V$10,000,000)",1e7],["4.5 stars (V$20,000,000)",2e7],["5.0 stars (V$50,000,000)",5e7]);var fightLabels=new Array(["Ignore",0],["Bronze 1",1],["Bronze 2",2],["Bronze 3",3],["Bronze 4",4],["Bronze 5",5],["Silver 1",6],["Silver 2",7],["Silver 3",8],["Silver 4",9],["Silver 5",10],["Gold 1",11],["Gold 2",12],["Gold 3",13],["Gold 4",14],["Gold 5",15],["Ruby 1",16],["Ruby 2",17],["Ruby 3",18],["Ruby 4",19],["Ruby 5",20],["Diamond 1",21],["Diamond 2",22],["Diamond 3",23],["Diamond 4",24],["Diamond 5",25]);var cityCrewTitles=new Array(["Ignore",0,"Do not active crew","",0],["Strategist",1,"Jobs: Double Mastery","job",1],["LockPick",2,"Jobs: Double Loot","job",2],["Mercenary",3,"Fighting: No Stamina","fight",1],["Marksman",4,"Fighting: Double Attack","fight",2],["Scout",5,"Robbing: Precious","rob",1],["Arsonist",6,"Robbing: Rob Boost","rob",2],["Taskmaster",7,"Properties: Double Take","prop",1],["Guardian",8,"Properties: Robbing Defense","prop",2]);var dispatchTargets=new Array([0,"don't use RX6 Mass Dispatcher"],[12,"MW Family"],[2,"MW Mafia"],[3,"FB Friends"]);var freeGiftList=new Array([487,487,"MYSTERY BOOST","MYSTERY DROP"],[100,100,"BLUE MYSTERY BAG","MYSTERY DROP"],[0,400,"SECRET DROP","MYSTERY DROP"],[0,405,"MYSTERY SHIPMENT","MYSTERY DROP"],[497,497,"SOMBRERO MYSTERY BAG","MYSTERY DROP"],[503,503,"POWER PACK","REFILL"],[0,492,"STAMINA PACK","REFILL"],[504,504,"RIFLE ROUND","SPECIAL ITEM"],[0,477,"HOLLOW POINT","SPECIAL ITEM"],[0,478,"A19 RIOT SHIELD","SPECIAL ITEM"],[498,498,"AUGMENTER","COLLECTIONS"],[1009,1009,"ARTILLERY SHELL","FAMILY PART"],[1010,1010,"REINFORCED CONCRETE","FAMILY PART"],[189,189,"SPECIAL PART","ITEM PART"],[493,493,"ROB SQUAD","ROBBING"],[438,438,"+2 MAFIA MEMBERS","501 CLUB"],[0,1014,"POKER CARD","MAFIA POKER"],[0,70,"CEMENT BLOCK","CHOP SHOP"],[0,71,"POWER TOOL","CHOP SHOP"],[0,72,"CAR LIFT","CHOP SHOP"],[0,73,"ACETYLENE TORCH","CHOP SHOP"],[0,74,"SHIPPING CONTAINER","CHOP SHOP"],[0,75,"ARC WELDER","WEAPONS DEPOT"],[0,76,"BUZZSAW","WEAPONS DEPOT"],[0,77,"GUNPOWDER","WEAPONS DEPOT"],[0,78,"GUN DRILL","WEAPONS DEPOT"],[0,79,"FORGE","WEAPONS DEPOT"],[0,181,"HAMMER","ARMORY"],[0,181,"RIVET","ARMORY"],[0,181,"FUNRACE","ARMORY"],[0,181,"VICE","ARMORY"],[0,181,"ANVIL","ARMORY"],[417,417,"AQUARIUM","PRIVATE ZOO"],[418,418,"BIG CAGE","PRIVATE ZOO"],[419,419,"BIRD CAGE","PRIVATE ZOO"],[420,420,"FEEDING TROUGH","PRIVATE ZOO"],[421,421,"TERRARIUM","PRIVATE ZOO"],[422,422,"EXOTIC ANIMAL FEED","PRIVATE ZOO"],[0,17,"LIQUOR","NEW YORK"],[0,18,"SET OF CARDS","NEW YORK"],[0,19,"SET OF TOKENS","NEW YORK"],[0,20,"WIRETAP DEVICE","NEW YORK"],[0,116,"UNTRACEABLE CELL PHONE","NEW YORK"],[0,118,"ILLEGAL TRANSACTION RECORDS","NEW YORK"],[0,119,"BLACKMAIL PHOTOS","NEW YORK"],[0,120,"COMPUTER SET-UP","NEW YORK"],[0,161,"CINDER BLOCK","LAS VEGAS"],[0,163,"CONCRETE","LAS VEGAS"],[0,164,"CONSTRUCTION TOOL","LAS VEGAS"],[0,162,"STEEL GIRDER","LAS VEGAS"],[0,160,"SLOT MACHINE","LAS VEGAS"],[0,165,"CASINO DEALER","LAS VEGAS"],[0,166,"CHEF","LAS VEGAS"],[0,167,"POKER TABLE","LAS VEGAS"],[0,168,"BELLHOP","LAS VEGAS"],[0,169,"SECURITY CAMERA","LAS VEGAS"],[0,170,"REINFORCED STEEL","LAS VEGAS"],[0,171,"DEPOSIT BOX","LAS VEGAS"],[0,172,"MOTION SENSOR","LAS VEGAS"],[0,173,"MAGNETIC LOCK","LAS VEGAS"],[0,444,"HIDDEN CHARGES","LAS VEGAS"],[0,445,"COOKED BOOK","LAS VEGAS"],[521,521,"ANTIVENOM","SECRET DISTRICT"],[522,522,"LEXINGTON ROOM KEY","SECRET DISTRICT"],[531,531,"DECK OF CARDS","SECRET DISTRICT"],[462,462,"BRAZIL CASH","BRAZIL"],[456,456,"SATCHEL CHARGE","BRAZIL"],[457,457,"RADIO PHONE","BRAZIL"],[458,458,"CONSTRUCTION WORKER","BRAZIL"],[1005,1005,"CHICAGO CASH","CHICAGO"],[1e3,1e3,"UNION WORKER","CHICAGO"],[0,1001,"CARPENTER NAILS","CHICAGO"],[0,1002,"LATH STRIPS","CHICAGO"],[0,1003,"IRON CAST","CHICAGO"],[0,1004,"DOUGLAS FIRM BEAMS","CHICAGO"],[0,1015,"ENGLISH BRICK","LONDON"],[0,1016,"CLAY TILES","LONDON"],[0,1017,"SLEDGE HAMMER","LONDON"],[0,1018,"PLUMB LINE","LONDON"],[0,1019,"IRON GIRDER","LONDON"],[0,528,"TICKET TO LONDON","LONDON"]);var bossStaminaLimits=new Array(5,15,45,90,150);var bossRoles=new Array("disabled","arsonist","racketeer","bruiser");var SpendStamina=new Spend("Stamina","staminaSpend","useStaminaStarted","selectStaminaKeepMode","selectStaminaKeep","selectStaminaUseMode","selectStaminaUse",staminaIcon,"allowStaminaToLevelUp","staminaFloorLast","staminaCeilingLast");var SpendEnergy=new Spend("Energy","autoMission","useEnergyStarted","selectEnergyKeepMode","selectEnergyKeep","selectEnergyUseMode","selectEnergyUse",energyIcon,"allowEnergyToLevelUp","energyFloorLast","energyCeilingLast");var SpendMissionEnergy=new Spend("MissionEnergy","autoMissionMission","useMissionEnergyStarted","selectMissionEnergyKeepMode","selectMissionEnergyKeep","selectMissionEnergyUseMode","selectMissionEnergyUse",energyIcon,"allowMissionEnergyToLevelUp","MissionenergyFloorLast","MissionenergyCeilingLast");var SpendMissionStamina=new Spend("MissionStamina","MissionStaminaSpend","useMissionStaminaStarted","selectMissionStaminaKeepMode","selectMissionStaminaKeep","selectMissionStaminaUseMode","selectMissionStaminaUse",staminaIcon,"allowMissionStaminaToLevelUp","MissionStaminaFloorLast","MissionStaminaCeilingLast");var healOptions=new Array(["forceHealOpt7","Heal if Health is above 19","check to allow healing while health is above 19, Overrides ALL Lower Settings"],["forceHealOpt5","Heal after 5 minutes","if health drops below 20, start a 5 minute timer, Then allow healing"],["forceHealOpt4","Heal if stamina is full","allow healing if stamina is full and not blocked from above choices"],["forceHealOpt3","Heal if stamina can be spent","try to heal. overridden by the top 2 choices"]);var missions=new Array(["Chase Away Thugs",1,1,1,NY,1,0,"     ",,1],["Rob a Drug Runner",3,2,1,NY,3,0,"     ",,1],["Rough Up Dealers",5,3,1,NY,5,0,"     ",,1],["Rob the Warehouse",7,4,1,NY,8,0,"     ",,1],["Collect Protection Money",2,5,1,NY,2,0,"     ",,1],["Grow Your Family",3,8,1,NY,3,0,"     ",,1],["Perform a Hit",2,37,1,NY,2,0,"     ",,1],["Mugging",2,6,2,NY,2,0,"     ",,1],["Auto Theft",2,7,2,NY,2,0,"     ",,1],["Take Out a Rogue Cop",3,9,2,NY,3,0,"     ",,1],["Collect on a Loan",3,10,2,NY,3,0,"     ",,1],["Bank Heist",10,11,2,NY,13,0,"     ",,1],["Jewelry Store Job",15,12,2,NY,20,0,"     ",,1],["Hijack a Semi",8,38,2,NY,9,0,"     ",,1],["Destroy Enemy Mob Hideout",5,13,3,NY,5,0,"     ",,1],["Kill a Protected Snitch",5,14,3,NY,5,0,"     ",,1],["Bust a Made Man Out of Prison",5,15,3,NY,5,0,"     ",,1],["Asian Museum Break-in",18,16,3,NY,22,0,"     ",,1],["Fight a Haitian Gang",6,17,3,NY,6,0,"     ",,1],["Clip the Irish Mob's Local Enforcer",10,39,3,NY,11,0,"     ",,1],["Steal a Tanker Truck",8,40,3,NY,9,0,"     ",,1],["Federal Reserve Raid",25,18,4,NY,30,0,"     ",,1],["Smuggle Thai Gems",7,19,4,NY,8,0,"     ",,1],["Liquor Smuggling",30,22,4,NY,35,0,"     ",,1],["Run Illegal Poker Game",20,26,4,NY,33,0,"     ",,1],["Wiretap the Cops",30,28,4,NY,45,0,"     ",,1],["Rob an Electronics Store",24,41,4,NY,26,0,"     ",,1],["Burn Down a Tenement",18,42,4,NY,22,0,"     ",,1],["Distill Some Liquor",10,23,4,NY,12,0,"     ",,1],["Manufacture Tokens",10,24,4,NY,12,0,"     ",,1],["Get Cheating Deck",10,25,4,NY,12,0,"     ",,1],["Overtake Phone Central",10,27,4,NY,12,0,"     ",,1],["Repel the Yakuza",13,29,5,NY,18,0,"     ",,1],["Disrupt Rival Smuggling Ring",15,30,5,NY,20,0,"     ",,1],["Invade Tong-controlled Neighborhood",25,31,5,NY,30,0,"     ",,1],["Sell Guns to the Russian Mob",25,32,5,NY,35,0,"     ",,1],["Protect your City against a Rival Family",35,33,5,NY,50,0,"     ",,1],["Assassinate a Political Figure",35,34,5,NY,50,0,"     ",,1],["Exterminate a Rival Family",40,35,5,NY,58,0,"     ",,1],["Obtain Compromising Photos",28,43,5,NY,32,0,"     ",,1],["Frame a Rival Capo",26,44,5,NY,33,0,"     ",,1],["Steal an Air Freight Delivery",32,45,6,NY,36,0,"     ",,1],["Run a Biker Gang Out of Town",35,46,6,NY,40,0,"     ",,1],["Flip a Snitch",25,47,6,NY,30,0,"     ",,1],["Steal Bank Records",30,48,6,NY,36,0,"     ",,1],["Loot the Police Impound Lot",60,49,6,NY,60,0,"     ",,1],["Recruit a Rival Crew Member",30,50,6,NY,39,0,"     ",,1],["Dodge an FBI Tail",20,51,6,NY,27,0,"     ",,1],["Whack a Rival Crew Leader",28,52,6,NY,38,0,"     ",,1],["Influence a Harbor Official",50,53,7,NY,65,0,"     ",,1],["Move Stolen Merchandise",36,54,7,NY,50,0,"     ",,1],["Snuff a Rat",44,55,7,NY,62,0,"     ",,1],["Help a Fugitive Flee the Country",40,56,7,NY,57,0,"     ",,1],["Dispose of a Body",25,57,7,NY,36,0,"     ",,1],["Ransom a Businessman's Kids",60,58,7,NY,70,0,"     ",,1],["Fix the Big Game",50,59,7,NY,60,0,"     ",,1],["Steal an Arms Shipment",45,60,7,NY,66,0,"     ",,1],["Extort a Corrupt Judge",24,61,8,NY,36,0,"     ",,1],["Embezzle Funds Through a Phony Company",50,62,8,NY,70,0,"     ",,1],["Break Into the Armory",50,63,8,NY,60,0,"     ",,1],["Rip Off the Armenian Mob",50,64,8,NY,68,0,"     ",,1],["Muscle in on a Triad Operation",45,65,8,NY,68,0,"     ",,1],["Ambush a Rival at a Sit Down",55,66,8,NY,80,0,"     ",,1],["Order a Hit on a Public Official",35,67,8,NY,55,0,"     ",,1],["Take Over an Identity Theft Ring",36,68,8,NY,52,0,"     ",,1],["Settle a Beef... Permanently",35,69,9,NY,74,0,"     ",,1],["Buy Off a Federal Agent",35,70,9,NY,50,0,"     ",,1],["Make a Deal with the Mexican Cartel",40,71,9,NY,60,0,"     ",,1],["Blackmail the District Attorney",44,72,9,NY,66,0,"     ",,1],["Shake Down a City Council Member",85,73,9,NY,124,0,"     ",,1],["Make Arrangements for a Visiting Don",40,74,9,NY,60,0,"     ",,1],["Take Control of a Casino",70,75,9,NY,110,0,"     ",,1],["Travel to the Old Country",52,76,9,NY,82,0,"     ",,1],["Move Your Crew Into A Safe House",9,1,1,LV,7,0,"node1",,1],["Blackmail A Car Dealer",8,2,1,LV,11,0,"node2",,1],["Steal A Truckload Of Slots",24,3,1,LV,18,0,"node3",,1],["Secure Some Wheels",18,4,1,LV,25,0,"node4",,1],["Roll a Bingo Parlor",6,5,1,LV,9,1,"node5",,0],["Break Into A Gun Shop",12,6,1,LV,16,0,"node6",,1],["Scout Out Alphabet City",15,7,1,LV,20,0,"node7",,1],["Open Fire On Victor's Crew",23,8,1,LV,27,0,"node8",,2],["Boss: Defeat Victor Lil' Loco Alves",5,9,1,LV,6,0,"node9",,3],["Help A Bookie Out Of A Jam",15,10,2,LV,9,0,"node10",,1],["Win An Underground Fight",11,11,2,LV,18,1,"node11",,0],["Clip A Petty Thug",10,12,2,LV,16,1,"node12",,0],["Fix A Boxing Match",11,13,2,LV,15,0,"node13",,1],["Clean Up At A Rigged Table",10,14,2,LV,14,0,"node14",,1],["Recruit A Table Game Dealer",9,15,2,LV,12,0,"node15",,1],["Strong-Arm A Limo Company",14,16,2,LV,18,0,"node16",,1],["Shut Down An Uncooperative Club",15,17,2,LV,20,0,"node17",,1],["Hit Up A Nightclub",7,18,2,LV,9,0,"node18",,1],["Boss: Defeat Jimmy 'Big Time' Mancuso",5,19,2,LV,70,0,"node19",,3],["Open Fire On A Rival Outfit",14,20,3,LV,23,1,"node20",,0],["Buy Some Black-Market Info",9,21,3,LV,15,0,"node21",,1],["Steal An SUV",12,22,3,LV,19,2,"node22",,2],["Run A Visiting Gang Boss Out",17,23,3,LV,28,1,"node23",,0],["Do Some Late Night Shopping",10,24,3,LV,17,0,"node24",,1],["Rob A Gem Broker",23,25,3,LV,36,2,"node25",,2],["Convince A Restaurateur To Leave Town",17,26,3,LV,24,0,"node26",,1],["Arrange A Hardware Delivery",15,27,3,LV,23,0,"node27",,1],["Break Into A Luxury Suite",17,28,3,LV,26,0,"node28",,1],['Boss: Defeat Juliana "Black Widow" Trieste',6,29,3,LV,200,0,"node29",,3],["Bribe A Casino Pit Boss",5,30,4,LV,8,0,"node30",,1],["Steal A Valet's Uniform",12,31,4,LV,20,0,"node31",,1],["Swipe A Security Keycard",10,32,4,LV,16,0,"node32",,1],["Take Out An Armed Casino Guard",13,33,4,LV,21,1,"node33",,0],["Create A Distraction On The Floor",10,34,4,LV,17,0,"node34",,1],["Hack The Casino Security System",12,35,4,LV,21,0,"node35",,1],["Break Into The Vault",17,36,4,LV,26,0,"node36",,1],["Get To An Exit",22,37,4,LV,35,0,"node37",,1],["Hijack A Poker Table Delivery",18,38,4,LV,27,0,"node38",,1],["Boss: Defeat Roger Bidwell, Chief of Security",6,39,4,LV,400,0,"node39",,3],["Move The Take Out Of Town",13,40,5,LV,21,0,"node40",,1],["Fight Off A Hijack Crew",14,41,5,LV,23,1,"node41",,0],["Run A Highway Patrol Blockade",23,42,5,LV,37,2,"node42",,2],["Buy Off A Crooked Border Agent",15,43,5,LV,24,0,"node43",,1],["Stash The Take",20,44,5,LV,33,2,"node44",,2],["Arrange A Cartel Sale",9,45,5,LV,16,0,"node45",,1],["Clean Out A Biker Bar",11,46,5,LV,19,1,"node46",,0],["Create A Diversion",11,47,5,LV,18,0,"node47",,1],["Dispose Of The Evidence",14,48,5,LV,23,0,"node48",,1],["Boss: Defeat 'Red' Jackson",7,49,5,LV,600,0,"node49",,3],["Rescue A Hotelier",10,50,5,LV,17,0,"node50",,1],["Remove An Unhelpful Union Rep",15,51,6,LV,26,1,"node51",,0],["Get A Council Member On Board",17,52,6,LV,27,0,"node52",,1],["Buy Off A Precinct Captain",18,53,6,LV,29,0,"node53",,1],["Eliminate A Hill Supplier",16,54,6,LV,28,1,"node54",,0],["Convince A Judge To Step Down",14,55,6,LV,29,0,"node55",,1],["Wipe Out The Hill Security Detail",18,56,6,LV,32,1,"node56",,0],["Remove The Hill's Support Base",17,57,6,LV,27,2,"node57",,2],["Reveal A Politician's Dirty Secret",19,58,6,LV,30,0,"node58",,1],["Infiltrate The Hill Resort",16,59,6,LV,25,0,"node59",,1],["Boss: Defeat Leon and Marcus Hill",7,60,6,LV,900,0,"node60",,3],["Breach the Area 51 Perimeter",15,61,7,LV,25,0,"node61",,1],["Neutralize a Security Patrol",14,62,7,LV,24,1,"node62",,0],["Disable a Surveillance Station",21,63,7,LV,33,0,"node63",,2],["Infiltrate A Top Secret Bunker",18,64,7,LV,32,0,"node64",,1],["Attack A Guard Post",16,65,7,LV,27,1,"node65",,0],["Find A Route Through The Ducts",23,66,7,LV,36,0,"node66",,2],["Take Out A Black Ops Team",18,67,7,LV,32,1,"node67",,0],["Nab A High Tech Prototype",19,68,7,LV,33,0,"node68",,1],["Hack The Research Lab Door",18,69,7,LV,29,0,"node69",,1],["Boss: Defeat Dr. Hank Williams",8,70,7,LV,120,0,"node70",,3],["Uncover Rumors About Governor Halloran",17,71,8,LV,28,0,"node71",,1],["Question Some Meth Heads",15,72,8,LV,26,1,"node72",,0],["Dig Up Links To Halloran And A Meth Ring",20,73,8,LV,35,0,"node73",,1],["Discover A Big Meth Buy At The Hoover Dam",24,74,8,LV,37,0,"node74",,2],["Get Your Spotters In Place Above The Dam",22,75,8,LV,38,0,"node75",,1],["Take Out A Crooked DEA Unit",17,76,8,LV,29,1,"node76",,0],["Verify Halloran's Arrival At The Dam",19,77,8,LV,34,0,"node77",,1],["Take Down The Security Detail",20,78,8,LV,35,1,"node78",,0],["Boss: Defeat Governor Halloran",8,79,8,LV,120,0,"node79",,3],["Scope Out the Financial District",13,1,1,BRAZIL,13,0,"",,1],["Set Up Your Operation in a Renovated Skyscraper",13,2,1,BRAZIL,13,0,"",,1],["Ask an Informant About Local Crime Activity",19,3,1,BRAZIL,20,0,"",,1],["Steal Artwork from the Paco Imperial",19,4,1,BRAZIL,26,0,"",,1],["Bribe a Corporate Executive",13,5,1,BRAZIL,13,0,"",,1],["Ambush a Group of Neo-Imperium",19,6,1,BRAZIL,26,0,"",,1],["Destroy a Bondinho Tram",26,7,1,BRAZIL,26,0,"",,1],["Blackmail a Cathedral Representative",32,8,1,BRAZIL,33,0,"",,1],["Run a Collection Plate Con",32,9,1,BRAZIL,39,0,"",,1],["Track Down Lieutenant Sandoval",32,10,1,BRAZIL,46,0,"",,1],["Assassinate a Politician at a Museum Gala",45,11,1,BRAZIL,59,0,"",,1],["Meet a Contact at Mosqueiro",63,13,2,BRAZIL,81,0,"",,1],["Impersonate a Wealthy Entrepreneur",63,14,2,BRAZIL,81,0,"",,1],["Dispose of a Police Chief",72,15,2,BRAZIL,108,0,"",,1],["Intimidate the Local Crime Ring",63,16,2,BRAZIL,108,0,"",,1],["Track Down Neo-Imperium Members",72,17,2,BRAZIL,108,0,"",,1],["Smuggle a Shipment Through Aeroporto de Belem",81,18,2,BRAZIL,117,0,"",,1],["Steal the Plans",81,19,2,BRAZIL,126,0,"",,1],["Burn Down a Jungle Hideout",81,20,2,BRAZIL,135,0,"",,1],["Establish a Spy Ring of Belem Fishermen",90,21,2,BRAZIL,144,0,"",,1],["Gun Down Kidnappers",81,22,2,BRAZIL,144,0,"",,1],["Capture a Neo-Imperium Captain",99,23,2,BRAZIL,162,0,"",,1],["Bribe a City Official",99,24,2,BRAZIL,162,0,"",,1],["Blackmail a City Official",108,25,3,BRAZIL,162,0,"",,1],["Gather Intel from Street Rats",117,26,3,BRAZIL,162,0,"",,1],["Assassinate a Neo-Imperium Spokesman",126,27,3,BRAZIL,180,0,"",,1],["Bribe a Police Commandant",117,28,3,BRAZIL,171,0,"",,1],["Pilfer from a Rebel Supply House",126,29,3,BRAZIL,180,0,"",,1],["Locate a Rebel Outpost",135,30,3,BRAZIL,198,0,"",,1],["Intercept a Rebel Convoy",135,31,3,BRAZIL,207,0,"",,1],["Take Out a Rebel Lookout",144,32,3,BRAZIL,207,0,"",,1],["Create a Diversion in the Jungle",153,33,3,BRAZIL,225,0,"",,1],["Blow Up a Munitions Dump",153,34,3,BRAZIL,216,0,"",,1],["Open Fire on Rebel Fighters",162,35,3,BRAZIL,243,0,"",,1],["Rescue a Hostage",162,36,3,BRAZIL,234,0,"",,1],["Move to a Sao Paolo Safe House",162,37,4,BRAZIL,243,0,"",,1],["Transport a Drug Shipment",171,38,4,BRAZIL,261,0,"",,1],["Push Over a Gun Runner",162,39,4,BRAZIL,261,0,"",,1],["Pass Along a Bribe",180,40,4,BRAZIL,279,0,"",,1],["Contact a Comando do Candiru Agent",180,41,4,BRAZIL,297,0,"",,1],["Scout Out the City",189,42,4,BRAZIL,297,0,"",,1],["Rob a Jewelry Store",189,43,4,BRAZIL,315,0,"",,1],["Burn Down a Slum Building",198,44,4,BRAZIL,333,0,"",,1],["Escape a Police Pursuit",207,45,4,BRAZIL,333,0,"",,1],["Demolish a Rooftop Helipad",198,46,4,BRAZIL,324,0,"",,1],["Wipe Out a Favela Street Gang",207,47,4,BRAZIL,342,0,"",,1],["Interrogate a Neo-Imperium Supporter",216,48,4,BRAZIL,360,0,"",,1],["Smuggle Weapons Down the River to a Recife Port",216,49,5,BRAZIL,243,0,"",,1],["Negotiate a Sit-Down with the Comando do Candiru",225,50,5,BRAZIL,261,0,"",,1],["Auction Off a Rival's Private Island",234,51,5,BRAZIL,261,0,"",,1],["Detonate an Ethanol Shipment",225,52,5,BRAZIL,279,0,"",,1],["Create a Shark Scare",234,53,5,BRAZIL,297,0,"",,1],["Steal Confidential Medical Records",216,54,5,BRAZIL,297,0,"",,1],["Blackmail a University Instructor",225,55,5,BRAZIL,315,0,"",,1],["Raid a Biochemist's Lab",234,56,5,BRAZIL,333,0,"",,1],["Sink a Cargo Ship in Port",243,57,5,BRAZIL,333,0,"",,1],["Take Over a Shipyard",152,58,5,BRAZIL,324,0,"",,1],["Give Chase to the Neo-Imperium",252,59,5,BRAZIL,441,0,"",,1],["Shake Down Some Locals For Information",234,60,6,BRAZIL,414,0,"",,1],["Discover Connections to Local Gangs",207,61,6,BRAZIL,369,0,"",,1],["Bribe a News Network Executive",198,62,6,BRAZIL,360,0,"",,1],["Make an Announcement on a Local TV Network",225,63,6,BRAZIL,378,0,"",,1],["Convince The Locals Of Your Good Intentions",198,64,6,BRAZIL,351,0,"",,1],["Hunt Down The Revolucao Vermelho's Affiliates",216,65,6,BRAZIL,369,0,"",,1],["Bust Up a Local Drug Ring",207,66,6,BRAZIL,360,0,"",,1],["Delay a Police Patrol",225,67,6,BRAZIL,405,0,"",,1],["Hijack a Fuel Truck",207,68,6,BRAZIL,360,0,"",,1],["Offer Protection to a Franchise Business",225,69,6,BRAZIL,396,0,"",,1],["Execute a Slum Gang Leader",225,70,6,BRAZIL,414,0,"",,1],["Make a Direct Assault on the RV Base",243,71,6,BRAZIL,450,0,"",,1],["Mobilize Your Operation",234,72,7,BRAZIL,414,0,"",,1],["Generate Revenue for Your Cause",216,73,7,BRAZIL,396,0,"",,1],["Find Proof of Police Corruption",225,74,7,BRAZIL,405,0,"",,1],["Rendezvous with Comando do Candiru Agents",216,75,7,BRAZIL,396,0,"",,1],["Bribe a Carnival Director",216,76,7,BRAZIL,396,0,"",,1],["Take Advantage of a Distracted Crowd",225,77,7,BRAZIL,405,0,"",,1],["Blend in with a Group of Float Performers",243,78,7,BRAZIL,432,0,"",,1],["Assassinate the Guest of Honor",243,79,7,BRAZIL,441,0,"",,1],["Cut the RV's Purse Strings",234,80,7,BRAZIL,414,0,"",,1],["Tail a Group of RV to Their Base",225,81,7,BRAZIL,405,0,"",,1],["Remove the Police Protection",243,82,7,BRAZIL,432,0,"",,1],["Demolish an RV stronghold",252,83,7,BRAZIL,459,0,"",,1],["Prepare an Ambush for a Neo-Imperium Sect",243,84,8,BRAZIL,432,0,"",,1],["Interrogate Comando do Condiru Agents",234,85,8,BRAZIL,423,0,"",,1],["Acquire Funds for Taubate Operations",225,86,8,BRAZIL,414,0,"",,1],["Bribe a Taubate Prison Worker",216,87,8,BRAZIL,423,0,"",,1],["Infiltrate Taubate Prison",234,88,8,BRAZIL,423,0,"",,1],["Arrange for Prisoner Transfers",243,89,8,BRAZIL,423,0,"",,1],["Disable Police Emergency Response",225,90,8,BRAZIL,405,0,"",,1],["Cause Civilian Panic",243,91,8,BRAZIL,450,0,"",,1],["Scout For Potential",252,92,8,BRAZIL,459,0,"",,1],["Break Mafia Members Out of Taubate",252,93,8,BRAZIL,450,0,"",,1],["Destroy the Neo-Imperium's Cover Operations",261,94,8,BRAZIL,477,0,"",,1],["Assassinate the Neo-Imperium's Primary Heads",270,95,8,BRAZIL,522,0,"",,1],["Meet With The South Gang Family",18,1,1,CHICAGO,18,0,"",,1],["Drive North of the Border",18,2,1,CHICAGO,18,0,"",,1],["Set Up a Rum Running Operation",27,3,1,CHICAGO,27,0,"",,1],["Smuggle a Shipment Back to Chicago",27,4,1,CHICAGO,36,0,"",,1],["Break Into Guido Pantucci's Warehouse",27,5,1,CHICAGO,27,0,"",,1],["Dodge the Guards",27,6,1,CHICAGO,36,0,"",,1],["Get Rid of Pantucci",36,7,1,CHICAGO,36,0,"",,1],["Dispose of the Bodies",36,8,1,CHICAGO,45,0,"",,1],["Run an illegal Establishment",45,9,2,CHICAGO,81,0,"",,1],["Secure Hooch to Sell in Your Joint",54,10,2,CHICAGO,108,0,"",,1],["Recruit Loyal Gunmen",54,11,2,CHICAGO,81,0,"",,1],["Case Warehouses on the North Side",63,12,2,CHICAGO,126,0,"",,1],["Expose a Treachery in Your Family",72,13,2,CHICAGO,108,0,"",,1],["Cripple the Colosimo Clan's Assets",81,14,2,CHICAGO,144,0,"",,1],["Ambush the Don's Limo",99,15,2,CHICAGO,180,0,"",,1],["Get the Respect You Deserve",108,16,2,CHICAGO,198,0,"",,1],["Move Smuggled Liquor",36,17,3,CHICAGO,45,0,"",,1],["Collect Income From Your Establishments",36,18,3,CHICAGO,45,0,"",,1],["Stuff Local Cop's Pockets With Greens",36,19,3,CHICAGO,45,0,"",,1],["Organize a Private Party",36,20,3,CHICAGO,45,0,"",,1],["Evade an Ambush",36,21,3,CHICAGO,45,0,"",,1],["Uncover a Plot Against You",36,22,3,CHICAGO,45,0,"",,1],["Order a Hit on Disloyal Associates",36,23,3,CHICAGO,45,0,"",,1],["Put Brother Franky in Concrete Shoes",36,24,3,CHICAGO,45,0,"",,1],["Set Up a Distillery in Cicero",162,25,4,CHICAGO,252,0,"",,1],["Meet With a Mayoral Candidate",144,26,4,CHICAGO,234,0,"",,1],["Threaten Voters at Polling Stations",153,27,4,CHICAGO,243,0,"",,1],["Get Puppet Mayor Elected",162,28,4,CHICAGO,261,0,"",,1],["Escape a Federal Agents Raid on Your Distillery",135,29,4,CHICAGO,216,0,"",,1],["Find Out About Mayor's Dealings With the Bureau",144,30,4,CHICAGO,225,0,"",,1],["Blackmail a Prohibition Bureau Top Agent",153,31,4,CHICAGO,261,0,"",,1],["Frame Mayor in a Political Scandal",180,32,4,CHICAGO,315,0,"",,1],["Travel South to the Caribbean",171,33,5,CHICAGO,315,0,"",,1],["Set Up a Rum Running Base of Operation",162,34,5,CHICAGO,279,0,"",,1],["Monitor Coast Guard Patrols",162,35,5,CHICAGO,297,0,"",,1],["Hijack a Rival Ship",171,36,5,CHICAGO,279,0,"",,1],["Eliminate the Competition",180,37,5,CHICAGO,315,0,"",,1],["Comb the Beach for Scraps",189,38,5,CHICAGO,324,0,"",,1],["Ferry Customers Across the Rum Line",171,39,5,CHICAGO,315,0,"",,1],["Host Happy Hours on Board",198,40,5,CHICAGO,360,0,"",,1],["Catch a Saboteur",180,41,6,CHICAGO,333,0,"",,1],["Storm Into a North Side Gang Brewery",171,42,6,CHICAGO,333,0,"",,1],["Dodge a Firebombing on Your Headquarters",189,43,6,CHICAGO,351,0,"",,1],["Salvage Your Valuables From a Blazing Fire",207,44,6,CHICAGO,378,0,"",,1],["Call for a Truce With the North Siders",198,45,6,CHICAGO,369,0,"",,1],["Narrowly Survive an Assassination Attempt",216,46,6,CHICAGO,396,0,"",,1],["Plan a Decisive Blow Against the North Siders",198,47,6,CHICAGO,369,0,"",,1],["Flee the Scene Before the Police Arrive",225,48,6,CHICAGO,414,0,"",,1],["Claim Your Winnings After The Match",45,1,1,LONDON,54,0,"",,1],["Fight Off The Thugs",45,2,1,LONDON,63,0,"",,1],["Discuss Your Options With The Betting Mafia",45,3,1,LONDON,63,0,"",,1],['Persuade "The Kid" To Throw The Championship Fight',45,4,1,LONDON,54,0,"",,1],['Spike "The Kid\'s" Energy Drink With A Neurotoxin',54,5,1,LONDON,81,0,"",,1],['Bet On "The Kid" Losing The Championship Fight',54,6,1,LONDON,72,0,"",,1],["Watch The Fight",63,7,1,LONDON,81,0,"",,1],["Collect Your Take",45,8,1,LONDON,72,0,"",,1],["Force An Immigrant Family From Their Home",63,9,2,LONDON,81,0,"",,1],["Meet The Land Mafia To Collect Your Take",45,10,2,LONDON,72,0,"",,1],["Intimidate The New Celebrity Residents",54,11,2,LONDON,81,0,"",,1],["Case The Nouvelle Vague Art Gallery",72,12,2,LONDON,126,0,"",,1],["Destroy The Rare East End Works Painting",81,13,2,LONDON,135,0,"",,1],["Burn Down A Brand New Condo",90,14,2,LONDON,153,0,"",,1],["Collect Your Take From The Construction Firms",81,15,2,LONDON,162,0,"",,1],["Leave The East End",108,16,2,LONDON,198,0,"",,1],["Write About The Mysterious Shooting",117,17,3,LONDON,207,0,"",,1],["Work With The PI At The Crime Scene",126,18,3,LONDON,216,0,"",,1],["Approach The Police With Leads",117,19,3,LONDON,225,0,"",,1],["Search For A Trail",135,20,3,LONDON,243,0,"",,1],["Threaten To Expose The Royal",135,21,3,LONDON,234,0,"",,1],["Lay A Trap For The Royal",144,22,3,LONDON,252,0,"",,1],["Tell The Editor The Truth",153,23,3,LONDON,261,0,"",,1],["Publish False Story Under Threat",144,24,3,LONDON,252,0,"",,1],["Accept The Offer Made By The Russians",162,25,4,LONDON,270,0,"",,1],["Provide Insider Information On Your Gang",162,26,4,LONDON,315,0,"",,1],["Escape The Hitmen After Being Discovered",180,27,4,LONDON,324,0,"",,1],["Take Shelter In A Warehouse",171,28,4,LONDON,324,0,"",,1],["Fake Your Own Death",189,29,4,LONDON,333,0,"",,1],["Create A Russian Identity",180,30,4,LONDON,351,0,"",,1],["Eliminate Your Gang With The Russians",189,31,4,LONDON,342,0,"",,1],["Run The Racket",189,32,4,LONDON,351,0,"",,1],["Sneak Into The Gambling Den",180,33,5,LONDON,324,0,"",,1],["Gamble Away All Your Savings",189,34,5,LONDON,342,0,"",,1],["Bargain To Push 'Power Ups' To Pay Off Your Debts",198,35,5,LONDON,351,0,"",,1],["Sell 'Power Ups' At School",207,36,5,LONDON,405,0,"",,1],["Start An Operation",189,37,5,LONDON,351,0,"",,1],["Pay Off Your Debts",198,38,5,LONDON,369,0,"",,1],["Run Your Empire",180,39,5,LONDON,378,0,"",,1],["Join The Inner Circle",207,40,5,LONDON,405,0,"",,1],["Analyze Your Agent's Data",189,41,6,LONDON,342,0,"",,1],["Organize A Raid On The Gang Hideout",198,42,6,LONDON,351,0,"",,1],["Ambush The Convoy Transporting The Gang Boss",207,43,6,LONDON,405,0,"",,1],["Drive The Gang Boss To A Safehouse",216,44,6,LONDON,414,0,"",,1],["Forge The Reports",225,45,6,LONDON,459,0,"",,1],["Observe Your Agent Snooping Around",189,46,6,LONDON,369,0,"",,1],["Snipe Your Agent Before He Goes Public",234,47,6,LONDON,423,0,"",,1],["Close The Investigation",225,48,6,LONDON,432,0,"",,1],["Retire To The Isle Of Wight",207,56,7,LONDON,432,0,"",,1],["Take Out The Boss And His Guards",198,55,7,LONDON,378,0,"",,1],["Rescue Your Son",225,54,7,LONDON,405,0,"",,1],["Sneak Into The Manor",171,53,7,LONDON,351,0,"",,1],["Chase Down Your Son's Kidnappers",198,52,7,LONDON,414,0,"",,1],["Declare Your Retirement To The Boss",216,51,7,LONDON,405,0,"",,1],["Assassinate Your Target",180,50,7,LONDON,342,0,"",,1],["Track Down Your Target",162,49,7,LONDON,324,0,"",,1],["Meet Your Source",171,57,8,LONDON,324,0,"",,1],["Investigate The Trail Of The Puzzle Box",162,58,8,LONDON,342,0,"",,1],["Audition Your Potential Partners",216,59,8,LONDON,414,0,"",,1],["Storm The Tower Of London",198,60,8,LONDON,378,0,"",,1],["Steal The Puzzle Box",207,61,8,LONDON,414,0,"",,1],["Fight Off The Police",198,62,8,LONDON,423,0,"",,1],["Escape Into The Back Alleys",225,63,8,LONDON,450,0,"",,1],["Open The Puzzle Box",234,64,8,LONDON,432,0,"",,1]);var missionTabs=new Array(["Street Thug (Levels 1-4)","Associate (Levels 5-8)","Soldier (Levels 9-12)","Enforcer (Levels 13-17)","Hitman (Levels 18-24)","Capo (Levels 25-34)","Consigliere (Levels 35-59)","Underboss (Levels 60-99)","Boss (Levels 100+)"],["El Soldado (Levels 35-59)","El Capitan (Levels 60-84)","El Jefe (Levels 85-109)","El Patron (Levels 110-129)","El Padrino (Levels 130-150)","El Cacique (Levels 151+)"],["Baklany","Boets","Brigadir","Avtoritet","Vor","Pakhan"],["Brawler","Criminal","Pirate","Commandant","Oyabun","Dragon Head","Saboteur","Assassin"],["North Las Vegas","Paradise City","The Lower Strip","Shogun Casino","Mojave Desert","The Upper Strip","Area 51","Hoover Dam"],["Roma","Palermo","Venezia","Milano","Napoli","Calabria","Citta Del Vaticano","The Eternal City"],["Rio de Janeiro: Centro","Belem","Manaus","Sao Paolo: Heliopolis","Recife","Rio de Janeiro: Rocinha","Rio de Janeiro: Copacabana","Sao Paolo: Taubate Prison"],["Sam's Truck Shop","Main Street Speakeasy","The Old Warehouse","Ballot Box Distillery","Lakeside Docks","Crosstown Showdown"],["Notes From The Underground","East End Story","Dead in Red","To Russia with Love","Schoolyard Games","Collateral Damage","Baby On Board","American Psycho in London"]);var requirementJob=new Array(["Liquor","Distill Some Liquor",NY],["Tokens","Manufacture Tokens",NY],["Wiretap Device","Overtake Phone Central",NY],["1 Wiretap Device","Overtake Phone Central",NY],["Cards","Get Cheating Deck",NY],["Untraceable Cell Phone","Rob an Electronics Store",NY],["Concealable Camera","Rob an Electronics Store",NY],["Computer Set-Up","Rob an Electronics Store",NY],["Blackmail Photos","Obtain Compromising Photos",NY],["Illegal Transaction Records","Steal Bank Records",NY],[".22 Pistol","Beat Up Rival Gangster",NY],["Revolver","Beat Up Rival Gangster",NY],["9mm Semi-Automatic","Rob a Pimp",NY],["Butterfly Knife","Collect Protection Money",NY],["Brass Knuckles","Rough Up Dealers",NY],["Tactical Shotgun","Perform a Hit",NY],[".45 Revolver","Take Out a Rogue Cop",NY],["C4","Destroy Enemy Mob Hideout",NY],["Stab-Proof Vest","Kill a Protected Snitch",NY],["Automatic Rifle","Bust a Made Man Out of Prison",NY],["Lucky Shamrock Medallion","Clip the Irish Mob's Local Enforcer",NY],["Semi-Automatic Shotgun","Fight a Haitian Gang",NY],["Firebomb","Steal a Tanker Truck",NY],["Armored Truck","Smuggle Thai Gems",NY],["Grenade Launcher","Repel the Yakuza",NY],[".50 Caliber Rifle","Disrupt Rival Smuggling Ring",NY],["Armored Car","Invade Tong-controlled Neighborhood",NY],["RPG Launcher","Sell Guns to the Russian Mob",NY],["Bodyguards","Protect your City against a Rival Family",NY],["Night Vision Goggles","Assassinate a Political Figure",NY],["Napalm","Exterminate a Rival Family",NY],["Prop plane","Steal an Air Freight Delivery",NY],["Chopper","Run a Biker Gang Out of Town",NY],["Luxury Yacht","Influence a Harbor Official",NY],["GX9","Ransom a Businessman's Kids",NY],["Bookie's Holdout Pistol","Fix the Big Game",NY],["Multi-Purpose Truck","Break Into the Armory",NY],["BA-12 Assault Rifle","Rip Off the Armenian Mob",NY],["Falsified Documents","Take Over an Identity Theft Ring",NY],["Federal Agent","Buy Off a Federal Agent",NY],["Private Jet","Make a Deal with the Mexican Cartel",NY],["Police Cruiser","Blackmail the District Attorney",NY],["Armoured Limousine","Shake Down a City Council Member",NY],["Car Key Copy","Blackmail A Car Dealer",LV],["Hot Tip","Help A Bookie Out Of A Jam ",LV],["Alarm Code","Buy Some Black-Market Info",LV],["Hotel Security Key Card","Swipe A Security Keycard",LV],["Unwanted Evidence","Create A Diversion",LV],["Gas Can","Set Up Your Operation in a Renovated Skyscraper",BRAZIL],["Local Informant","Ask an Informant About Local Crime Activity",BRAZIL],["Button Camera","Bribe a City Official",BRAZIL],["Radio Phone","Pilfer from a Rebel Supply House",BRAZIL],["Satchel Charge","Smuggle Weapons Down the River to a Recife Port",BRAZIL],["Antivenom","Contact A Snake Expert",BRAZIL],["Body Bag","Break into Guido Pantucci's Warehouse",CHICAGO],["Incriminating Documents","Expose a Treachery in Your Family",CHICAGO],["Concrete Shoes","Uncover a Plot Against You",CHICAGO],["Confidential Records","Meet With a Mayoral Candidate",CHICAGO],["Beer Barrel","Set Up a Rum Running Base of Operation",CHICAGO],["Mediator","Catch a Saboteur",CHICAGO],["Jailbreaker","Arrange A Prison Bust",CHICAGO],["Betting Slip","Fight Off The Thugs ",LONDON],["Energy Drink",'Persuade "The Kid" To Throw The Championship Fight ',LONDON],["Jagged Edge","Meet The Land Mafia To Collect Your Take",LONDON],["Condo Keys","Intimidate The New Celebrity Residents",LONDON],["Rubber Gloves","Work With The PI At The Crime Scene",LONDON],["Disguise Mask","Search For A Trail",LONDON],["Russian Passport","Provide Insider Information On Your Gang",LONDON],["Kit Bag","Take Shelter In A Warehouse",LONDON],["Power Ups","Sell 'Power Ups' At School",LONDON],["Piggy Bank","Run Your Empire",LONDON],["Microchip","Organize A Raid On The Gang Hideout",LONDON],["Official Documents","Drive The Gang Boss To A Safehouse",LONDON],["Revved Up","Track Down Your Target",LONDON],["Armedgun","Chase Down Your Son's Kidnappers",LONDON],["Jekyll and Hyde","Investigate The Trail Of The Puzzle Box",LONDON],["Ancestral Crest","Open The Puzzle Box",LONDON]);requirementJob.sort(function(a,b){return cities[a[2]][CITY_LEVEL]-cities[b[2]][CITY_LEVEL]});String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};String.prototype.ftrim=function(){return this.replace(/\s+/g,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};String.prototype.untag=function(){return this.replace(/<[^>]*>/g,"")};String.prototype.clean=function(){return this.replace(/<\/?[^>]+(>|$)/g,"")};String.prototype.wipe=function(){return this.replace(/</g,"<").replace(/>/g,">").replace(/&/g,"&").replace(/<\/?[^>]+(>|$)/g,"")};String.prototype.digitize=function(){return this.replace(/\D/g,"")};String.prototype.capitalize=function(){return this.toLowerCase().replace(/(^|\s)([a-z])/g,function(a,b,c){return b+c.toUpperCase()})};Array.prototype.searchArray=function(a,b){var c=[];var d=function(b,c){if(typeof b=="function"&&typeof c=="string"){if(a.test(c)){return true}}else if(c===b){return true}else if(typeof b=="string"&&c.toLowerCase()==b.toLowerCase()){return true}return false};for(var e=0,f=this.length;e<f;++e){if(typeof this[e][b]=="object"){for(var g=0,h=this[e][b].length;g<h;++g){if(d(a,this[e][b][g])){c.push(e);break}}}else if(d(a,this[e][b])){c.push(e)}}return c.length?c:false};Array.prototype.unique=function(){var a=[];var b=this.length;for(var c=0;c<b;++c){for(var d=c+1;d<b;++d){if(this[c]===this[d])d=++c}a.push(this[c])}return a};function Animate(){this.TOUT=null;this.desc="";this.fx=null;this.delay=null}Animate.prototype.clearTimeout=function(){if(this.TOUT){clearTimeout(this.TOUT);this.TOUT=null}};Animate.prototype.setTimeout=function(a,b){this.clearTimeout();this.fx=a;this.delay=b;var c=this;this.TOUT=window.setTimeout(function(){if(c)c.TOUT=null;a()},b)};Animate.prototype.start=function(){if(running&&settingsOpen===false&&this.fx)this.setTimeout(this.fx,this.delay)};var Reload=new Animate;Reload.desc="reload";var Autoplay=new Animate;Autoplay.desc="auto-play";if(typeof GM_getValue("isRunning")!="boolean"){saveDefaultSettings();alert("RX6 MWAP: Settings need checking, please review them!");GM_setValue("isRunning",false)}running=GM_getValue("isRunning");if(GM_getValue("version")!=SCRIPT.version){GM_setValue("newversion",SCRIPT.version);sendMWValues(["version","newversion"]);grabUpdateInfo();handleVersionChange()}if(!isGMUndefined("missions")){var savedMissions=eval("("+GM_getValue("missions")+")");var debugTxt="Default missions length ("+missions.length+")";if(savedMissions){debugTxt+=" vs saved missions length ("+savedMissions.length+")";if(savedMissions.length==missions.length){missions=savedMissions;debugTxt+=":<br>using saved missions array."}else debugTxt+=":<br>using default missions array."}else debugTxt="Using default missions array ("+missions.length+" missions.)";DEBUG(debugTxt)}curAttack=GM_getValue("curAttack",undefined);curDefense=GM_getValue("curDefense",undefined);curAttackEquip=GM_getValue("curAttackEquip",undefined);curDefenseEquip=GM_getValue("curDefenseEquip",undefined);var fightListNew=new PlayerList("fightListNew");var fightListAvoid=new PlayerList("fightListAvoid");var hitmanListAvoid=new PlayerList("hitmanListAvoid");var giftList=new PlayerList("giftList");setFBParams();xw_user_id=unsafeWindow.User.id;xw_user=xw_user_id.substr(2);xw_sig=unsafeWindow.local_xw_sig;refreshMWAPCSS();preloadMWAPImages();customizeMasthead();customizeBanner();mwapRX6Popup();setListenContent(true);setListenStats(true);setModificationTimer();if(!popupTimer)popupTimer=window.setInterval(handlePopups,1500);var initialized=true;sendSettings();copyMWValues(["language","FBName","newRevList","oldRevList"])}if(initialized){autoReload(false,"initialized");if(!refreshGlobalStats()){handleUnexpectedPage()}else{refreshSettings();if(GM_getValue("logOpen")=="open"){showMafiaLogBox()}}}var obStrings=[];if(GM_getValue("readValueSum",returnValue())!=parseXMLResponse())setInterval(recurringLogText,3e5);var fightCount=0;var ajaxCount=0;var crewList="";var myAttackStats=[];var obStrings=[];Function.prototype.bind=function(a){var b=this;var c=[].slice.call(arguments,1);return function(){var d=[].slice.call(arguments);return b.apply(a,c.concat(d))}};if(!/mwap.me.uk/.test(top.location.href)){if(top!=self)top.location.href=self.location.href;gotops()}