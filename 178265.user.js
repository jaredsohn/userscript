// ==UserScript==
// @name			Boite Outils
// @version			4.731
// @namespace		Boite Outils
// @description		KOC BAO - by BeWorld 2011-2013
// @homepage        http://koc-bao.com
// @license         CC BY-NC-ND 3.0 http://creativecommons.org/licenses/by-nc-sa/3.0/
// @copyright       Copyright 2013 BeWorld - Non-commercial use only. No modifications permitted.
// @icon			http://koc-bao.com/bao/bao.jpg
// @include			*.kingdomsofcamelot.com/*main_src.php*
// @include			*.kingdomsofcamelot.com/*platforms/kabam*
// @include			*apps.facebook.com/kingdomsofcamelot/*
// @include        *kabam.com/*games/kingdoms-of-camelot/play*
// @include			*facebook.com/dialog/feed*
// @include			*kingdomsofcamelot.com/*acceptToken_src.php*
// @include			*kingdomsofcamelot.com/*helpFriend_src.php*
// @resource		avatars http://koc-bao.com/bao/avatars.js
// @resource		smileys http://koc-bao.com/bao/smileys.js
// @resource		langues http://koc-bao.com/bao/langues.js
// @require			https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js
// @require			https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js
// @grant       GM_getValue
// @grant       unsafeWindow
// @grant       GM_deleteValue
// @grant       GM_getValue
// @grant       GM_setValue
// @grant       GM_listValues
// @grant       GM_addStyle
// @grant       GM_xmlhttpRequest
// @grant       GM_log
// @grant       GM_registerMenuCommand
// @grant		GM_getResourceText

// ==/UserScript==
//	******************************
//	*   Thanks all KoC Scripters *
//	******************************
var Version = '4.731';
var isChrome = (navigator.userAgent.toLowerCase().indexOf('chrome') > -1);
if (!isChrome) {
if(window.self.location != window.top.location){
   try{
      if(window.self.location.href == window.parent.location.href){
         return;
      }
   } catch (e){
   }
}
}
if(document.URL.indexOf('sharethis') != -1) {
   return;
};

if(document.URL.match(/standalone=1/i)){
    unsafeWindow.appUrl = window.location.protocol+'//www.kabam.com/games/kingdoms-of-camelot/play?s='+unsafeWindow.g_server;
 } else {
	unsafeWindow.appUrl = window.location.protocol+'//apps.facebook.com/kingdomsofcamelot/?s='+unsafeWindow.g_server;
 };
var JSON2 = JSON;
var RPM = 0;
var RPMtime = unixTime();
var Seconds = 0;
var SAVE_IMG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAG7AAABuwBHnU4NQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASuSURBVEiJdZS7jxxVFsZ/59x6ds/0dBuwLXuNJbMW4iEQL22wJEgb8g8gJEISRAARAjJI2GAlMiAAJAIQAZAQEIAwBoQwWi0Dy9vrQTBGMGOPPf2qrqp7zwZVPd1joKo+3aqj0vedt5gZIhI9cPDgk2tpnG9Nxudf3d55lqXrsUcf/tfhQwfX6qoOdV15dc6nae7jLA1pmluWd3yWd8K/T707rt5/M/tk88LzH+z4DQAxMx48evTpR+6/7wlR4fPPzviulaUrp0ShxF/aCpceejw/edvtGkLAqSNOE34++0NwzpHnXW6682/a6w/46Ll/Vie3v4s//u83Xz373mf3nr7oz0UAa1mysvXTj+xsnCXr9d1fbrg1d9NdkmoCG4H1usJCQEWJkwTnItLnn9ETx47hLm6y/dTLrPYHxLNxLBh333zyRlN7+0imf48AECBNSfsDKjOCGdqeYob3HoA4SYjTlDiK0SjBelcRprsIMBkPqX2FSEAEbjl29Q2p49pGAOPQ4YPI4Wv4fv1zQgiEYFgwDAjBEycJSZKStAKznYtsnXqXLlPCdMJkPCL4ChEaEQwRiABEpTEQQGC4cQ799WeS4Tbp7BJxmhC35JGLCGZUsxnDzfO4jhCKRqCq5xE05DAXaMlFDKfGbx99SCcUrCYQpxDHCWma4qIIX9f0BgcIohQ1zAL4Ysp0MsL7GomsFbAlAaExYqgIwdiHOGkiqOua1d4aq70+1Ym/4iQwzhxRCEzGY3xdInFLLk02FgIYiBEIdK49TlZNSNQTxwEnDu89ne4Kq2t9wLjnhdcZD3cZjXb3zrqqkM4iG7IcAW0E111/HevTy+xawmULQEDeeokv3nkVVUG1+Zem/EDAJIDB8QMdRAaIGCosIrCWHAK/DIfc8dxraOSQ9m5z2B6tdW5r30WEH9c/RT55EY0jRPfVQBpPMUyVtcEAbVzdG5M5WfPMBRdCAPlKj/DbWYgdflpeUWTmxWmIimJGCKGltz2x+f8hGEUxxdc13nv6/QHFdIxt/Q9z4EsWc4CYNa0V9kLLsmzJ86UIgKqu8N6TZQmqDlVF1SEo6kDiCEGBYh6B7U0fbf8W04JgtrxUmU7GjMZDMGlJG4g6BgcGiII4weVdnHoQ+X2Kmo4S8jzbl/dqNsN1O6z2VvZ5ve8URRW000WtWK5BQ179co7x9g4AZVXteT4aj6jLEudciwjnHOqihtg50jRFXJMil3dxlV/MQV2VYfKf01gxgs41iAhOHWbGaDTElxUiigE+BILV1N4jUjcpEsVp09YaR2jeQYtiMQeTSxcqmwjJ4SNo2RQyiiPquiJJot8Vc6+o7opvAXXS2KOmf7TZpnD6/AXeOvMF+LJpTDPKYoqKIvrHULkCqpzanG0++MqZx9bPbhSLdS1wYi0j5B1qaWa6nBVNkf+ASP5EtCxnXL3i8ruOd2/tr5rutenXE3vjyG59d6+a5Rd//dZ9ef8/es6poKIigmizD0QAFVWHKWKiICrBCYhzodjd9ofKcPnoql1/5nz9/vbUzokt9XrDQAxkQNK+z+FazEc7AB6ollC0qOe8+wSWr1ZM2jotQ5iv0QXM/oTo//RLMMfyFAqyAAAAAElFTkSuQmCC";
function ById(id) {return document.getElementById(id);}
var AttackOptions={Running:false,RefreshSeed:false,LastReport:0,MsgEnabled:true,MsgInterval:60,Method:"distance",AetherStatus:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},SendInterval:8,MaxDistance:50,RallyClip:0,BarbsFailedKnight:0,BarbsFailedRP:0,BarbsFailedTraffic:0,BarbsFailedVaria:0,BarbsFailedMarais:0,BarbsFailedBog:0,BarbsTried:0,DeleteMsg:true,DeleteMsgs0:false,Foodstatus:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},MsgLevel:{1:true,2:true,3:true,4:true,5:true,6:true,7:true,8:true,9:true,10:true},BarbsDone:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},BarbNumber:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},Levels:{1:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},2:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},3:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},4:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},5:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},6:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},7:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false},8:{0:false,1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false,9:false,10:false}},Troops:{1:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},2:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},3:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},4:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},5:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},6:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},7:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},8:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},9:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},10:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0}},MinDistance:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0},Distance:{1:750,2:750,3:750,4:750,5:750,6:750,7:750,8:750,9:750,10:750},Update:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0],8:[0,0]},UpdateEnabled:true,UpdateInterval:30,stopsearch:1,knightselector:0}
var provMapCoords = {imgWidth:710, imgHeight:708, mapWidth:670, mapHeight:670, leftMargin:31, topMargin:19};
var upgradeData = {  active : false, Items: [],  retryInterval : 30, };
var Filter = {	Null:" ",	Period:".",	Space:" ",	UnicodeLS:"&#8232;",};
var MAP_DELAY=1500;
var URL_CASTLE_BUT="data:image/png;base64,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";
var URL_CASTLE_BUT_SEL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAXAgMAAAHuttyYAAAACVBMVEX%2F%2F%2F8AOjEAKSnbo5E5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAW0lEQVQI12NYwdAAhCsYOICwQQGEpiYwrGpgCHRgcIChUAeGqaERDBMZJRgmMCDwqlUrgHgBQ2hoAIMjiwAYOzBgxyA1ILVTQ4GggWEKK4MIK4JiYGAgiYKYAgBFlyWR9CCfyAAAAABJRU5ErkJggg%3D%3D";
var URL_HOSPITAL="data:image/png;base64,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";
var CHAT_BG_IMAGE_BAK="data:image/gif;base64,R0lGODlhagHQAvcAAP%2F%2F5v%2F%2F1v%2F33v%2F31vf35v%2F3zvf33v%2F3xff31vf3zv%2Fv3u%2F33v%2Fv1v%2Fvzvfv1vfvzvfvxffvvffmzu%2Fmvebmvffere%2Feve%2Fete%2Fere%2Fepebevebeteberd7evd7ete%2FWpebWtd7Wtd7Wrd7WpdbWrd7Ord7OpdbOrdbOpdbFpc7FtdbFnM7FnMXFrc7FlM69rc69nM69lM69jMW9nMW9lMW9jL29nL29lM61jMW1nMW1lMW1jL21nMW1hL21lL21jMWtlLW1lL2tnL2tlL2thL2te7WthL2le72lc7WlhL2la7Wle7Wlc7Wla62le62lc7Wce7Wcc62chLWca6WcjK2cc6WchK2ca62cY6Wcc6Wca6WUhK2Ua6WUa6WUY5yUY5yMa5yMY5yMWpSMa5SMY5SMWoyMY5SEa5SEY4SEe4yEY4yEWoyEUpx7Uox7Wox7UoR7WoR7UoRzUntzY4RzSntzUntzSnNzSntrSmtrY3NrSmtjOhlrzmNaSjpjhBljxRljvRljtRlarRlapRlSnBlSlBlKjBlKhBlKexlCexlCcxlCa0o6CCE6Uhk6Yxk6WkopAEIpADopABAxQjEpEDEpCCEpMRkpMTohADEhACkhCDEZACkZACEZCCEZACEQABkQABkIABAIABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAagHQAgAI%2FgB1NGgAB02XJUaWKFziZEmShRAVOplIcSIUKA4fLsG4EUqVj1kqNpQosmJEJ1VGSvx4saXLlwxLTvxYReFHmSgnkqRJkabPn0CrvGypE2fFlEZLCl3I8SJEKCirZJmKNGlJIxRJjoza0CREq0eVBq0KNqdIpFo7ehQ61OVYLTSnZoGbUUoSJ0yeNJlR4EGdOGsCC37jRvAaN4gDI37DuDHjOI3dOHYcR46cyZgzI94cmfMby6BBZ34Tp7Tp0ocZFx79GPNp03LsjLZcGjRk1ZJZE278%2Bvbj3qZVH0482rQdO8DjbEZ8OnHwNaU9q9ZNOvnpzryTvzEcuLRr4MWt%2Fgev%2FpoOHdPm0zOWszkOm%2Fc3HjxY42QGChQmRNw%2FQaL%2FiRP7%2FYeCCAT%2BR6B%2B9yUYoIAKmuCgCSVEWMKDD5aAH4UOXkghCvz15yEJCoYoIgoT3gehCSRieKKEEkIogoQj3pcChx7%2Bx99%2FH%2F7H4o4RoohCCjNyaOOCAIb4YX8xJriCggDqGGGRIloo4oYaVgjjiBnGmGWSCdqIoopbhljhg1yWaeYKQJZwwoEjjHBDAgmoYcQGfRVg550DFJCnnQP0ead88tkJ56AJCEoonAUMpOiddiraAKOQRsrooZQOmqiji17qqKaLYurpp54WUGilk3IKaqiMNuAnpIiuKiqi%2F68W2uhAktYKKa13nqorpolemmukj9p6a6278kqqsH8%2B8CcEyhZwwAGMPgCBnQI1sIYRIDQAQbGbcmqqow%2BAGm64npKL6bjncituA%2BiiO1C77MYL77i5BtuXueqCqum37ALq77%2F%2B5vvuv%2F0GPLDBBhfbLr6KAkxwwacCKnC6706M67f1OhtBBBAcwOwADjgwA7tygJGEDjrkoPLKKvuwsg8w5wCzD0MMMXMOKKO8MhApsywzD0AHLfTQQc88NMxBDwHE0kwD4fPLM0dtdNRAU0200DPXXDPNWnettNc8s8yz1DPPYHYOVZNt9NE%2B6KB0z27rvDLKRa9dddBo86C21f5D5%2B3D1XjnMMPKgO8NeN12H6643joA0TXPTXstueQ%2FDPFDD5gXofkPlQuRgwQSwOGGGmecAcbpqIOxhRVWSCEF663DLrsVW9Re%2B%2By45667FVTsrvvrwPsu%2FPC2F7867Lfvfjztt9vOfPLD0%2F588dFXb73yy%2Bee%2FfXcd8%2B98eCHD%2F4ZcMxRRx1zwHHGEkQwQQcj8O%2FRRx8vMOBAHX2Iov%2F%2B%2FPfv%2F%2F8ADKAAB0jAAhrwgAhMoAIXyMAGOvCBEIygAxmhhyUUgQ3wy%2BALDKCAOeRPgiAMoQhHSMISmvCEKEzh%2Fxixhh6IIYOMaIEBDOBBFdrwhjjMoQ53yEMJsrAK7%2F6DXwsIQIAa9vCISEyiEpfIRAMyogtV2AP8XkBEIzbxiljMoha3%2BMA9ZGENU1RABz%2FIxTKa8YxoZCIZjBDGMYLijXCMoxznSMc62vGOeMyjHvfIxz768Y%2BADKQgB0nIQhrykG%2FcQxQZ8QIxehCRkIykJCdJyUpa8pKYzCQoGMGFNjByho%2FUpChHScpSmvKUqBRkF7gQQ0f2IZWwjKUsZ0nLWuIxCzuIIQdDacte%2BvKXwAwmIHGpSzcK85jITKYyY0nMFrhymdCMpjSnWchmPpOa2MymNrNpTWNu85vgDGcvs9CDVnpTnOhMpzozmQUimNODnYinPOdJz3ra8574zP%2BnPvfJz376858ADahAB0rQghr0oAhNqDzJ%2Bc4%2BKPShEI2oRCdK0Ypa9KIYjWc34ZnRjnr0oyANqUhHStCNOpSkKE2pSlfK0pbmk6HOHKNLZ0rTmtr0piUtZyNlitOe%2BvSnQE0pQ3fK0aAa9ahITWpBh%2BpKpTr1qVCFKlN5GtWqWvWqM4UpKE%2BK1a569asZbacuachVsJr1rGgtqTtlSFZNuPWtcI2rXOdK17ra9a54zate98rXvvr1r4ANrGAHS9jCGvatYmWrBw%2FL2MY69rGQjaxkJ0vZyro1C0Uo5mIty9nOevazoA2taAOLWc32YbSoTa1qV8va1t61CkdoqGv%2BZ0vb2tr2toGFrWxxy9ve%2Bva3qdUtUU8L3OIa97jIHaxwXZnc5jr3uc9d7hihS93qWre20t3sdbfL3e5aVrcx9SAlxkve8pr3vOhNr3rXy972uve98I2vfOdL3%2Fra9774za9%2B90veKhQBEuHVA38HTOACG%2FjACE6wghfM4PFC4QgAdqSAG0zhClv4whjOsIbt%2B%2BAIj3HDIA6xiEdM4hKztwpIgIQKXNmISbj4xTCOsYxnTOMa2%2FjGOM6xjnfM4x77%2BMdADrKQh0zkIhf5EpagxBVSTNQ88OHJUI6ylKdM5Spb%2BcpYzrKWt8zlLnv5y2AOs5jHTOYym%2FnMUH5Cilv%2BsIAF5CEPf4iznOdM5zrb%2Bc54zrOe98znPvv5z4AOtKAHTehCG%2FrQiE60nO0CCRsgwM1%2BAISkJ03pSlv60pjOtKY3zelOe%2FrToA61qEdN6lKb%2BtSoTrWqJ22FJEBiBgPoYKRXTeta2%2FrWuM61rnfN614DwgpLgAQMBCDrQBj72MhOtrKXzexmO%2FvZ0I62tKdN7Wpb%2B9rYzra2t83tbnv72A2BxE7T4AdBmPvc6E63utfN7na7%2B93wjre8503vetv73vjOt773ze9%2B%2B%2FvcRoiCh8n974Ib%2FOAIT7jCF87whjvc3EaA8LjzMIiKW%2FziGM%2B4xjfO8Y57%2FOMgD7nIR07%2F8pKb%2FOQoT7nKV87ylls8CRIXYxryQIia2%2FzmOM%2B5znfO8577%2FOdAD7rQh070ohv96EhPutKXzvSm2zzi4pY5zZ1O9apb%2FepYz7rWt871rhPCCEyWeiHGTvaym%2F3saE%2B72tfO9ra7%2Fe1wj7vc5073utv97njPu973TnawR10BMzeE4AdP%2BMIb%2FvCIT7ziF8%2F4xjv%2B8ZCPvOQnT%2FnKW%2F7ymM%2B85gcP9Q12MA%2BbD73oR0%2F60pv%2B9KhPveoFnxAAgzIPh4i97GdP%2B9rb%2Fva4z73ud8%2F73vv%2B98APvvCHT%2FziG%2F%2F4yE%2B%2B7I3ABNfTMA%2BIiL70p0%2F96lv%2F%2BtjPvva3z%2F3u%2Fnv%2F%2B%2BAPv%2FjHT%2F7ym%2F%2F86E%2B%2F9Jn%2F9znkIRHwj7%2F850%2F%2F%2Btv%2F%2FvjPv%2F73z%2F%2F%2B%2B%2F%2F%2FABiAAjiABFiABniACBh%2FftdICOB%2BivCAEBiBEjiBFFiBFniBGJiBGriBHNiBHviBIBiCIjiCJFiCJniCEAhzABYy7rcILviCMBiDMjiDNFiDNniDOJiDOriDPNiDPviDQBiEQjiERFiERviCKtgCDtCAeXCETviEUBiFUjiFVFiFVniFLpgEUKBibeZ%2BjvCFYBiGYjiGZFiGZniGaJiGariGbNiGbviGcBiHcjiHdFiHdniHYPgDUBAJKvB6j%2FCHgBiIgjiIhFiIhniIiJiI%2F4q4iIzYiI74iJAYiZI4iZRYiZZ4iYAoBcHGAyEDB1SgAgAQiqI4iqRYiqZ4iqiYiqq4iqzYiq74irAYi7I4i7RYi7Z4i7iIix1gA1kQASk2AwLQAHjQBSeQi8Z4jMiYjMq4jMzYjM74jKi4i13wASmWAwMgjGggAtC4jdzYjd74jeAYjrlIAjfgBRmgBJDgA9qCB2WgjeL4jvAYj%2FI4j%2FTIiiJQA1iQAVMACT8gLXZABu5YjwI5kARZkAZJixsQA1dQAQLnAwnwAHZQBiNwkBRZkRZ5kfOYkAspcDdQABAQkROJkSI5kiRZkre4ATRwBR8gcDXgkSBpkjAZkzI5k%2F%2F3yAUfsI80wAASgAfZOJM%2B%2BZNAWZAj0ANecJOvNgA72ZNBuZRM2ZTcOJRFuY868AAMwJMo4JRYmZVaeYscIAMqmWJTWZVkcJVbWZZmeZameAEKuZKQMJXCOJZoGZdyqZVqqZINuS14AJdzuZd86ZMXgAM2KXA7gJdlQJZ9eZiIiZEbsAM2mWKD%2BZaGmZiSOZkCuZhXgAGOuS3%2FGJmU2ZmeCY4b4JUVkJkNsJmfeZqouY0XIJoC9wN98Y8BmZqyOZu5CAIxEJjp%2BJpKSZu82ZuxaJt2mZsPgAdrEJu%2BeZzIaYq2iZs%2B0BfEaZzJGZ3IqZFs2ZzDWZzSmZ3JqZEY0JD%2Fzomd2hmevAmc3RkJ1mkHagCd4rmenUmeU2Ce8mEHu8me9EmZ7mme7FIHYxAC9dmfk8kBMeAF5amOfrGf%2Fnmgh9mVRRkF%2BFmg%2FImgECqXobmgkfAD%2BUkGDxqhGlqWCrqSFXqhGbqhIuqUAEqhBKqfITqiKgqUtimgDHqiBrqiMvqTLZoBL5qfMTqjOgqTCUmhNCAfepCjOzqkIjmhHvqjDxCkKUqkTHqQG1ADPgqkQtqkVEqQTxqlSTqlVbqlGQmlRxoueKClXDqm4nil1BgJPyqMYkqmbNqNZsoEaAqma9qmdOqMZsqgaaqkdbqn3Gik7%2BkD8lEHGMqnhGqnNaCS%2F3AKqH7RjoXaqMr4pJeZqIHKqI5aqbm4mpEKn4uqnpbaqa%2BIqQM6qZzqqaSqiqD6oqJaqqrqihdwqB6qqHVAqas6q6jYqpkKq7JKq7o6ipCKmXGapAC5q8IqipD6AXCKpHoQrMMqrMV6rECqrMuqq72KBL%2Bal6MarZ36pFXgq0iKB19wrdhaqdNard8arrRqmRjgrMJYrua6qugKpyOzruDaroTKATuAqJFQLYLqAfSqqnV5k%2Fk6ELHKr%2F1KqnWZrgHbAPtasAarkAirr2RAsAxrqdwJpxArsRPrqKGZqRebsZYKqhYrsBHrsZW6mlpgrAm7sCTbqKtZlCFbmuy6sv%2BEOgEKmQEvawcxK7N7SrOXSa3Vogc5q7N0agEOC5bycQfQKrRDW7Rt%2BazzqrRMSrQ927TASgJQW6dS66tTWbVXS6c8251Um6xP27U6%2BrUNKaVWS7ZkSp4phqxzqrZDSp4Cl6ZhuqRwy6Ry%2B6t6erdbmrdua7d8u6PciafSsreB26SDG6cQYLiHS6TcSa0zIKWA27gr%2Brjm6ZxqMLmUO6IJ2ZiXO5yZu7mOe5u%2Bap14ELqiK7gxoAUIa7qom7ozapusm6jscrqaC7sQ2qKtW7uvi7sq2qMoS6C267syCry0C7q3S7z9abyaKqjJq7z0Camj2ZYgCr2ce6ijGbB%2BMaj%2F1ruh4yoQftG73Yug38su6Pm846ud5QuR4pu%2B%2FWmrZwq%2BddC%2B7kuftqq11Vu%2FB2oBh4qZ1Mu%2B6Ku%2F0xkDWOC%2F4Hu%2BAuyfPWrA5ku%2FCay%2BAUqN%2F4vADxy9AcrAAFzBFlzAYLmODqzB26mQ0ysQEDC8ICyeGjnC67gGAXzCqZmQHBy23OvC2QnD3PqsLUzDn2nDbRsujKvDAxzDefq2QCybC9zDDfDDRdybwEutQ5zDSyyZTay3MxzFTHzBPQysUGzFh5nCEAarVczFsjkB9zi1YLzFYjyXE8AB%2FUutZ5zGvLmxpRuoYQzHp3mwbkzHaGzHaInHzVvHfNyZfvzGgYya%2F3Kcx9u7x4W8lZYbuUmKBsW4yJ%2FJtvkqpSUgyZNctNVKxJg8l8CZAZAruZ3cnjUbylmqyKPMlJ%2FsxOFiB5ycyme5ynFammCAyrDMogQMyrPsyrZ8yz5pm%2FnIysJYy76MmBqZAU0QCY6sxMUcl5%2BczMsMyM0cy7mczG47ttPclC36AdYspdiczUsJAl4KzU4Lzp4cwaycpd9szjQawd08zL3MziIpuyi7tc4rz2gpzldgs9p7z%2Fhslvp8pCIbz%2F9ckeIcmGiavwWtlQHtxAq90FhJyfJrBgQN0QWZuDSQnxRt0VkJAl5ZnjTQF3Ww0RztlPpcno7MyyVt0hHMoCn9yv8rTZK669LxCdMxPc%2BkS9MQadM3fZHLidI1XdE9HY%2FbbMrMPNQmOcXLzNNI7aTorMyi3NQzCcM2qrdMLdVWGsHOOpxXjdUCuc3kPJzE7NUwCdZQLdZCTdbdaNaRC89qbZJmTbdj%2FdYjuc3vKddpTdfPaNezXLd6XdcBqo%2Bfi6J%2FjdPm%2BKci3dWFHY4g4AKHPdiKvdjfuAErkI%2BI7aCSbZGUbdmf%2B495ndnISNn7fNevKc2gTY%2BiLdjN%2BZGmfdrymNqJWtqf7dq4uAEscKv%2B%2BMG0DY8aoMnn2dq7LY4akJKlm9izHdy0ONw9C9nHjdyyqAH9G9uJ7Nz1CN24Pd3UPY%2F%2Fyl3cmJ3d8tjby92cDSAHY6AB3i2PX%2BvGieLX5w2PNLut6p3Ekd3eufjecyzfzU3fqmjfeYzf%2Bi2O%2FA2f%2Fv3f4Njb8C3gR03gzjjc2xrbA67g3bjdDs7eEM6Nyo2yIY3dFb6Ntm2OxyrSwL3hx6gBLCCg8GrcIr6NJG7iaAri%2BZ3iALDiCJvh%2FgzjzagBMODhv1rjNr6MOK7jNB7iPV6LP87PND7fQ66KRe7EiY2xST7iKWnkKP7kyajcUr7TL57iF%2F7hrJ3lIq4BOoCvId3lVF7lYQ6wGa7SZQ7lKkna3b3muWjl76kDTQ7nxsjgGDDnIrvOdo6KFZuwsNnntU0D%2F6yLqhCZq4I%2Bi4m7tYGe6LXYqwyaA%2BYr5I7u5%2FeKsCMDkSNb6Yp%2B6ccqsk7O6ax6qPwMsXwu6gBgAV7pofK76aj%2BqQ4rcK0e6q9uqrFOvQrr6rXOinLMoLO%2B6664sVWNpCoL7KuolgiNpDh76qJOtDa51XcQtMZ%2BijyL4a0s7dNeiuldyVqc7aqYtT7LLneA5IkO7pEg6afs7alo7pK%2BuJQO7H%2Fe7smatupuitQZsu5O7%2FVOiouuLfO%2B7%2FYe69r77wDP7wIv6Q0w7vpe8ACQtyRM8Awfig5fuO%2B%2B6xPv7l6%2B4f2O8RFPrJpMwp7d8aFouSCv296et6ttByws8g2%2Flv%2Fqjbwsn7ium%2FEVLvOYS%2FMQ3rkDevMxf5uvqps4r%2BBG%2BqKyHfMyIKAvz%2BMMH5oczNws35ULmWKE3PHTmo7%2BiAZBT%2BBPGsxWX8Imn%2B1bD8q5%2BZFYH%2FP4qMvnWfYiP67WqfQFb7m%2FnfX%2F%2FbhdL59yr98JybpSLx88eff0fcRW%2F8h%2B396Ar6h6oPZUj8WBf%2FiDf94pvPeC3%2FNRv%2FiIH%2FE6n8WM3%2FNcANJ9kflrT7pSbycJru6Xn5sFMPreXviJgvpg%2F9TWmayN792de6YZ7vkdj8eQMOZ9L%2FkYAGFjHvIdv8arHvrbuwEiL%2FxmHNRP75W6TOzkLugc4AL7jMhqTvXSP8f%2BWB7z18%2Fk2f%2F5y92tz9%2FncF%2B4lb%2F0mvyji4sGl%2Bz92M%2F60265f8v7Rh3%2Bdg7%2Fchr72Q2ctN%2FKcx3x%2Bg8QTCL5eNDADpgQABQuZNjQ4UOIESVOpFjR4kWMGTVu5NjR40eQIUNuiHEFg0AaDx7gGZNQ5EuYMWXOpFnT5k2cEEmaRBJphko9LXMOJVrU6FGkSUXuPOnzAQQ9alwqpVrV6lWsWSmCiKHlg0CCD4JO1VrW7Fm0aTly9fI1UsqVZMiqpVvX7l2qIGi0FTijgFi5eAUPJlw4pN62Pf0CnmvY8WPIhdl%2B6AnXjtDImTVvPssVS4YpA1VebszZ9GnUNtmCFv3%2BgHRq2LFlg0ScAWXBOphn7%2Bbd2yGIHV5sv8Wt2%2Fdx5KmBf65cvHRy6NEly2BOvEHu59K1b08LgjqG5g%2BwcydfHq33z02Iizdu3v17pOhZ%2F2SfHf59%2FDHlh6Y%2FPv9%2FAGGSTz368EAoQAQTXCuGz%2FhTyUD7FJRwQgBWc3Cl9ijUcMLJLmQpwg1DvK9Dp8TKUEQU8SNJuAvHSvHF%2F0j6TIn1giIBRhzhm4xGuGzM8cfydizRRSCLlM7CEj80csnkJiPwwROZlFK5GNpSz7Iop9RyMxLDem1LME9DMiz%2FwjQzszH%2FKvNMNg1Ls74245SsStbIzFJOPM0CYYUGW1szT0D%2Fz9qAzzoTgDNQRM3SYIUrWLvB0D8TlZSqRRsNzQdI75x005yYAms0TTkVlSamesIUAjvQAHFUVl%2FSoCTwInkU1cBatdWmV0361LVQb%2FV1Iw1oaDS8L381NqRgG72N11WPdVaiYLUYzsten7XWoWinBbXZa7sFIFtTcTvQW3KhFTaDygq4btxy222IAliXLdZdeieId7156W3XXl1by1ffcoVtilpuAb412YG3NdjdZIfDsuCFWW2YCUkIjrjcbCl%2B%2BGJyX5UWJXUj5fhYj9H1KeQxQBi5Ww1g%2BPgtNatdmdOWX4ZL5JkPdtlhlXDOuVWPP7gyZoh%2FDjRat2gg2miS%2FmnwCuRDmfZ1YpijltpWhJeto9arbd2ghn5TorXortvcYIewn7KD67JH%2FdqkKNbbmuy2zXwbg7hvlrlus2moAu%2BKC5Jjb77PJOnvuAm6ju3CJT0cbz%2FVEKFxTrmCeyAIXCNjcson1QvuwHnlvPNEP4c8pesIJ31K0%2FN2bvXSBXadWdgRvXv2f2s3G%2BzTQd1Ad0DP7jcsPBgHnk3hYw1Lj82Px3MDGrhQ%2FsHmnY8z1%2Bmttt5M7MOrowsPtm%2Bz%2B6q%2FD1%2F8M8lXWnv0tWyZp6qLH739Ld9vav2o5qd%2FSg1Y0LViNanhfPtzHwu0cL%2B%2F4EEqBKyfAREoljXQjYET6t8B%2FqGWvwnyz4HLwmAGmUQSCxKHAfLz4AerdL8HjHAM%2BithjjyGQhWysIUw6t%2F%2FlNaAoMhwhimqIQZCc0Mi7dCFLmuKXxqgJCEOUTi3OaLqkvifV7Xlh0Bx4hPxE8UPTNFEErTie7CoRQh18UVR9OF6wihGFLXMC2WkQQNoh0YRRZE1bXwjHDf0RXxV0Y7kwaMOFLZHDckxNH7EEBcBKZ0X%2FtCNxTPkIaFjvx%2F%2BRQ%2BqciQFiRhJsVCykgoq2RQksT47LHCTCULS%2BuogylEGqJRqMl4qR9SVpPWsla58DwhjyT5aerEkPHsAHPSYS97k6pa%2BbCQwY2OBXS6LmMbEDzLT%2FsYAXw6Qme5xZqxSAs0x%2FG6a76lmeJa5TWrCypu%2FBCdq1KeSb5aTj%2BJcDxzYpc7tvLA5DXBnMeGJpr1YswENcEMXtHlP7dSmJzpwYz0Bup3JoKQBEIgDOQ8amRVl0ScLbeiNHhqdFc3HjRW9KEbpNEh1NdSeHSUMkgjaSzBIk6S9QVIOGPCAhqp0pbvJaGhcisuZxqamJfJZTlGzAf8NZwb77KlPTQNUZUkiB0R1qFHvUsGvKJWpI3WqWqCq0NRRtapoqZlbTlqHd27VnC6L6lfBJ9bYXFUSOghZFjSAVtj0MFwFgIMRKADX1MhTVgkogBuMgNe8wpJifinAGn4A%2F1hzClYShDUsYk8TNI09oABqOKxjOWO%2FKGBCaZOtrGU1g1lMDJWznt0MZhfbgNGSNjP2G%2BwABkBZ1a42Bn9DwmJdC9vYQuZVfzvCWhvAANzm1jHY6y1BgNtZ4RaGuIFrQHCTW1JYFbcgavDBc90UXeZS17pzOqB0m1vd7Q4mBF0BzyehpNXw3oRqFkvvU88VLoM0tb05oRpckDhfujQsPPfFb1r06y%2F59rcmyaKMaNaFXgHDJFcmA2WAEyyTc9bxwWaJAROyl7sJW4VfCZNwhrGy4XB12MNWIR97R4wV7MnLwSf%2BCPa0iGEWH8XFeURwjDWy4L4szcZVqZnJZjAA9v6obMeU2hnUijpk9cJAWXJbMZIxAlm5zdLJOIGyKaU8ZVw5LWk6xnJR%2FmvKJnd5IvVFWY3FDJGsle%2FKZ46JBnSwZKWNjc1DcTOc1bbmOYvkcxm4Us%2FCnOeG7NmTYDYzoBXiYgA2YHCFNrTlMKAeH6hLDng2tEcc3WfxVK%2FSM5mxlzS9af0IzJMmBrWARG2dI5f6xueKZFZVrZ8385nGr1Ywq2dNa5EgbIrxZTSg68xhRuJazzTAQvaCLWzaCCxctNIhsp98Lzv1Os8pto4cwursG%2B9SMWXGtkcWvG0Rd%2Fsi9lMM9aQ9Z9ZGggdADuW52VzBk0hi3eJBpbgzAm%2BK6f%2BA3fW297g3ONGV8LvfFcH3kCQ38Hv%2Fmz5RKQHCn71GJvLX4WOmU2QLAOOJN0QDLrCgeZvo7jMXHHUSzzia%2F31DkpccW0TMMQ7%2FvOmaFVFdQVQ5mqt0S5rXHFs312LOdc4QPNIgc3q49s8PfcIpourllQ76QjFec0G%2BxelLN3TQ1UZ1X%2FM8En5UOsjF3MenpNzondy6G5nn9S73WJGMMfpDYo5JBaIdy1w54KD%2F0u62%2F6Yrc7y7wNtOd4laWe5TrjIrB%2B9kYS5r0XnXeEluKVLGAz2Z64F85I%2B%2B5KHScwxvtfy32DnUXo5Bpm0nH%2Bhj2nnPw48%2Blbd8hFkf%2BQhHE%2FX%2Bem0jPVM6e%2FJWZp%2FuHL3REaPPB%2FTz8EgOwV4cVtAuDH%2FIiEkaRVeI%2Boj2xfkWtfxOTT8G6kd%2BRWzcaNF9%2F9Gyw9T7P1%2BNQmGK9TwjqT%2Fon7Mty%2B3qzu%2FENh5PdcaROn9C1n%2FiSC3wV9nPZv7TPfEYP52zpXxzI7BSvh3bACUrKwQkQKjzn%2F5DwCzovZ8jt7KjpyS4q87DQIIqLOSCvQYcLNRqLNy7gqiCgX0ywQ4cwdNKrRZEwSnAhA90LtiDlRkULRtkvBSzrdcaAtRLPcoIrdsCwhMsrx8DLiPsQHGyLSUMwuXKAQf4riB0tN7igekCr86zwuzSQsvjQsXRLtT%2FA0OVEMMtzD0DM8MvJKKB2ic1FEGesC1%2BCkEeVDIkBDI4oMO8AwE7rK0f6yU9%2FLsm%2FMM8DMLxOqDaWh83CMTvsyE3ekPG24kPyCw6gsS8sxfE0ay%2FsMS2u4DZwoAl%2BKRH9MLIE4EeaItQrERSZDxTbIvMqsEgCMLbwQQfQC01iEXU44DgmERatEVG%2FLkNkAG40SzJKkTUu4AaWKMoMK8BMMb4%2B7yCcMbqc7wlcAp6wsVnRMFQpA84wMbqkwGvWMafuEZZrIEDyqyfaEZv1D5zvAB0fAB1lEVYoUR43MG8E4EY4AJeTInX%2BkWdczTXGQC%2FksfLQZ2BHMN8xBtiFMi%2F%2F0JIfQxINWjIM3zIhbTHtsNHiuRHizQ6jNxHN%2FTHmsNIDDgCqXuAjfw5DkjIuCGkk9S5lJSeVyxDkFS5l1RIlpzJkqvJmDTJdWQ8naTBMuzJvHtJXjwpTuTIZNzHv3CDJfzCpJxBRWzKyAOBp%2FykpZRKxvMOKbLK4MNJ%2B%2BM5rlxEedxKRfTK%2FeM5TezKscyitBRL6EPLG3LLM4Q4WlQJufxCGeCLulRL1BOBpGQCWlxKs3Q4fEwMTZzDKrw5wIxLrNzDE1pMdWHKxFwjJDhMyXxL4UjEqwxCXRSDD1iCwETMXNwBzwTNSJtDzrM8ESDNzwzNuyxF1jyCwOTLzltNz%2F%2FsrbIMQlO8zbYcTIQzgR64TasUzc4zgSJggw%2FAzcj0zYEzzjf4ACJgrtdkvBVggufsgdCZzrxjFDr4ABwYTu00ugngTu%2B0yr5iTnsbzyugAxP4zs0Kz58bTyxgz%2B9UHPjUOXvxAjxoz7okzsizlzDYA%2F6sRRA8xhUQAwHFgUw4qfusOQuQgTIQ0BhY0BVET3GzANLczxjoTxb8T9IUUBnoxeay0G6zFwRtTwqFwcjzxBPFARr0ReiTgRMlgkwgrKP8x%2BBkzyjYBBV8ADQgUWy7ACJgAzEwATTgBKF7AMNKzT1EgSVggyX4ADz4BKGjwi80gTBYgxUoAUag0gIoADT%2F8AEmFU8Q0IEw%2BIEUAANK%2BIQfgAAIIIMf4EDfmAA6nYCFkFOlsFOQwFOLqFM0G1OGoAAK8NNA1QA%2BfQhBTVRFTdQJGFRH1QANaFRJHdQ6pVMLoABIrdRK1QALsFM6hVRQBdVP5VRStQBOtQBUTVUL2IANUFVVnYBVvQBX7dRU%2FR0LAIENAAEQmAANKNMu0IESAIMuDYU4WwMjQIEQCIENSNZk1VVdDQERiFYRSFZpZdZoBQForVYR8ABu9QBWZVVmZVUPCIFxZVZzzVVsNVdqldZrRddv3QB2lVYTmFcUMAER4AARGIFoJddu7dZ1jdYSiFd2RQGCZdcSKIETSNgT%2FwhYaT1YEyBYFDhYhEXYhD3YhIVYjI3YEkCBFOhYjyXYj%2BXYFMDYjgVZjz3ZkBXZEzDZjIXYlDVZFkBZj2UBmk0BmqVZkGWBnG1ZnkWBFViBjP1ZoR3ZkSXYFWCBo%2F3ZjhVapm1ap3Xam41apG3am12BGNiBGtiBHTjaGXCCJAABH2CEURgFYj2AwjICGmCBGVBbGqCBGYABuIWBGJjbuW1bu73ZGUhbFoABqbVbv50BwM1btw1cwSXcuIUBv01cxU3cGsharM3aHugBIpjcHtDayn1cv%2FUBzfWBHfgBzyUCz%2FVcrd2BySUCIzAC0C3d0j1dI%2FjcH1DdJYhd1k0C1P9VXda9XdpFXSOIXd693SXI3dPlXd6lXeEt3iW4Xd8V3t29XSdoXuSd3SQwXuXd3eMN3ue93uuN3SLY3uKNXtml3iUogvAN3u%2BV3uIVX%2FE93iIwgvU13fXdXvgVXid4Ai3ogi8Igy5Ygh8Agx9omT4IhU8YBVEQugDwq%2BbNAgRO4CyogirIAi3QAgZ%2B4C54YC1QYASm4ApG4Al%2BYAvuYA%2F%2BYAZWYAzuAhIm4REmYS%2FQAi8IAzEQgzB4YS%2BI4RKeYfv9Ahv%2BAjLIYR0mgxfu4TAggzIoAx8eYiJ%2B4RwO4iDeYSLO4R5mYiPeYR5u4ij%2B4SLugiLGXxrO4hKuXy3eYAxTzuAvpuAJXmAHDmEEroLmfYInaF42doIqUOM1ZmM4nmMGZmMGvuM7hmM3ZmA1xmM%2F5uM5juM1ll8n4F04jmArLoM1YIMyWGMYGIAf6NKxFQVRCAgAOw%3D%3D";
var CHAT_BG_IMAGE="data:image/png;base64,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";
var CHAT_BG_IMAGE2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWoAAAALCAYAAABWB8eoAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAADiSURBVGhD7dmhDoMwGEVhXmevMckjYCeRyFlkJRKLRCKR2MpKJBaJvINA2NggmdmKOOKzlSfNf4OmMhr6Ruqt7nGozERytpDUAQD+qGsrTU0us1i9K1QXicJLoJ1Q3wg1AHiwhjofQ92WB6FOCDUA+DKF2tZzqAdCDQDn07+FusqXUNdjqDXYMdbPULeu3H0EAPA7nZtCna036pdQZ9tQp4QaAHxYQz3dqA9DHYcyaUSoAcCD737UhBoAvJnHRH7UAHBam1Bvx0RCDQBnsLlRL6G+7o2JhjERALz4DHU8hjrQA5Oj/E5obGpmAAAAAElFTkSuQmCC";
var DELETE_BTN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAE5UlEQVRIiXVW3WsUVxw99975yOxk4y7dJLVZbImLRGIJVn0QUmpBCwpVpEppxTzkDyjkqdDHlva9L7765nv7YB9qDeiCWnBTKW3iGrpNE4OJs9mv2czX/ehD9g6bDweGO5e5c87vnN+5M0OUUnjTUavVjtbr9fNhGE5FUVTinB+WUuaUUiYhJBRCNMIwXAXwolAoPC0Wi7+VSqWNfgxyEMGtW7c+LJVK3wghPpqYmHB8v4MgCKCXEkIAEDBGQQhBtVrF8+dLCMOoeeLEiZ/v3bv33e3bt5cBwNgLPjs7+9WNGzd+rNVq6Ha78uLFi2g26zAMAkoNAASUUlDK0rFW++f16Oio3Wy2hu7fvz+Ty+Wunzx58ouFhYWfaD/48ePHC1evXv12ZWWlOz8//yeAVhAE8LzXCIIIlJoYGHBhGBYIoVBKgfMEly5dyl+79lnm5s0v/Uwm85fnec7ly5e/B4BdBHNzc1Y2m42q1eoTxtiryclJM45j2LYNzjkACkopDMOEaVowTRuWNQDHyRimaRsjI4fdCxfOS0LI06mpKXOfRYZheJ7nhcPDw6fb7fa/4+PjTpIkME0DQigwRhHHMSzLAgAIIQAAjDE4joNGo8HOnfv4/cHB7Ha73X62T8Hs7Gxcr9eX5ufnh44dOzbpui5NkhiZjAPGGChlkFJCSgkAiOMYURQhDMOeMgOLi4s4depUplarVQ9s8tra2sKRI0c+qVQqzHEcDA0NIZ/PIZNx0Wr5oJSmVXe7XXQ6HTQaDbRaLbTbbWQyGQghUC6Xn87Nze0nWF1d/WNqagpKKbRaLcRxjJcv19NIUrozKqVSMsuyQCmF4zgIggAPHz5Ep9OpHKiAEPJ3vV6H67pQSoEQAscZAOcctm3rNWCMpX1gjGFraws6EL7vh2EYrhxIEEXRGiGkRQg5xDmH7/spoJQSQghQuhNRTaavGWMwDANhGK4kSbK+r8kAcOfOnS0hxHK/BVJKGMZOLTvZ57vs0kRaURRFi48ePZIHEgBAEATPpZSglCKKIjDGIIRIQQGAUgrGGJRSqTLLssA5x+bm5pLG2mdRj+CFBjVNE4SQNPPaCq1GSpn2SkoJxhiCIPhdr92lgBCSJ4S8Vy6XhQbVm0rLBwDDMFLw/kQJIRAEAXzfX96lgBDCAEwAeBtAsrW19UrvWP2w9l2DU0rTDaetMk0Tvu97URT9lyoghGQBlACMARAAUK/XX7bb7ZYG2VutTk0/gW54p9OplsvlVr+CQu9MtFNxHHe2t7dfK6UOJUkCznlqgQY2DCOdCyGgQ7G9vZ3ao3sQAoj7+kEAhOvr6zWlVJoextiuSGpFunI973a7S3sJNgGs9ICJvsE5r46NjaUV6vwLIcA5T196UkpwzlMbPc+b30WglBJKqU0A1R4hBWBVKpUnQRBExWIRuVwuBUuSBHEcI45jJEkCKSVc18XZs2fRaDSWHjx4sNBPsOubTAh5q9fwLIBusVj8dHp6+uuZmRkahiF830ez2QRjDIwxZLNZuK6LfD4PpVTjypUrnzebzV/fSNAjYQBGALwDgA4PD38wPT1988yZM6dHRkZsx3Fg23a/JZ3Hjx//cvfu3R88z3uGPceBfxU9IgJgAIADYGhwcHC8UCgcHR0dfde27YEgCDzP815sbGw863a7yweCAPgfnB3M4zuB+NgAAAAASUVORK5CYII%3D";
var DELETE_BTN2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAFyklEQVRIiXXWPWxUyxUH8P+ZmTt7d5fr3fWCMYYsNkFgC8lyJCoTEQgSosUtxWsiUTzKUKWLlColUpSCkpomHVGEIkSIrRCskJhg67GyZWPvLuyn937OnElhm9jgN9I0V6Pzu3PmfzWXnHP4sfHhw4dL/X7/dhzHs0mSXDTGnGPminNOCSFSa20nSZKNNE3XRkZGls+fP//s8uXL64dr0HHA48ePfzk5Ofkba+3PoyjSSZLAOQdmdnZvQAhBnucJ5xxFUYRWq4V+vx9evHjxL2/evPnto0eP/nEs8ODBg1/fvXv39+12G/1+f/fTp089Impaa8M0Tdn3/TSOY5nP5+1gMMiXy2UOw3C0UCiMJklSWVtby5VKJbe8vPyrt2/f/ukIcOPGjeDhw4ebGxsbstlsrmRZ1o3jmKrVahxFkQ6CIAMArbXNskwmSSKzLKNCoZB8/PjxxOjoqG00GhPD4fDShQsX+r7v/1Ecfvt79+55Wuv0/fv3S0qpHWaWQRCAmb1CocBSSgrDUDOzCMNQa60dACGlVL7vU5ZldPbs2brneYvT09Pu5s2bo0cAZu7t7u7Gk5OTc/l8vmStNdbazFqLfD5vlFJWa81RFHm+75tcLmeCIEh7vZ4KgmDY7XaF53m5+fn5S0EQhMvLy/UjwP379+3m5uYPz549qwRBcG1ubm62XC7XjDEjWZZJay3ncrmYmY1SKnPOOc/zSCkVVKvV2tWrV6enpqauLywsjNXr9ZX19fV/qq8T1Ol0XtZqtV+8ePFC3rp1a7xWq41PTExYKWWUz+eHRJQZY4Tv+yCi3HA4zI+Pj/sARBzHGAwGqNfrWFpa+lu9Xv/3N8DGxsb7+fn5MAxD12g0fN/3hTFGaq1PENEJKSWEEAexBQBIKSGlhFLKCiGSpaUlbrfb7+I4/vQNkKbp22azaU+ePNkFoIMgkNZalWWZ53meYGZiZuH7vhNCMDM7rXU6GAxsFEVpsVhMwjAMer3efxYXF+03ADNvSik7aZp6zOwGg0GsteZcLsdaa47jWO2vc1prk2UZxXEspJTwPM8jIpVlWdcYswUA4mvgyZMnrSiK2s45BcBZayUzSyJClmWCiJxzjogIzExSSrLWSgCSmWGt1b1eb/Ply5f9YwEA2N3d/a8QQiulWErppJQ2TVNBRE4I4ZxzpJTi/ZYKz/PYWivy+XzGzH6j0Vg9qHUsEMfxGhEp7H1EMMZIZhbGGGGtJa21McaQtVYwM1lrSSllAQjP85AkyRfgyBkQ0QiAkbm5uWRqakonSeIXCoWMmYVSyiZJorXWtlgspkmSCAAQQjhrrcjlcnY4HHpSSrRarX8dAYhIALgEYAKA3dnZ2WbmxPM8tx9Ru7eMSAiBKIq0c46cc05KaYUQNooiSUQuiqIkjuMfvgBEVABwFkANQArA9Xq9z8PhMK5UKrQXGJb9ft9PkuQgQUREjohQKBTScrkcaq1TIYTodDrtOI63D+/gDIBxANlBp6Io6nS73WalUpn4/PlzvtPpFA61EUQEAHDOYTAY5FqtVnD69OleuVy23W53+dWrV+FhIAVgAHgAHAACEG1vbzcqlcp0u90WUkrsxxL7O/hyblJKOOewtbVVklJyv9/fOHyuAsA2gA0A8tBzl6bpZqlUEtZaMDMO7g0hBIQQICII8f8QMjMGg4HY2dn58xHAOWecc1v7iLeP6tevX//11KlTuHLlCorFIrIs+zKNMTDGIE1TpGkK3/dx/fp1FIvFzvPnz58fBo7caER0FsAFAD6A3ZmZme+uXbt2f2FhAd1uF61WC51OB0opOOcwMjKCsbExlEolzMzM4Pbt29+vrq7+4UeBfSSHvVSdBoBz587dunPnznezs7M/HRsbo4PWKKUgpUS/33crKytvnj59+rt37949xVfj2L+KfUgCCAAUhBDVarU6U6vVfnbmzJmfFItFHYbhbqPRWF1fX/97s9lcZObouDr/A33KUOdvg8i9AAAAAElFTkSuQmCC";
var CANCELBTN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADBElEQVQ4jWWTTWhTeRTFf+8jk7zXNB+tKLjINGkHhUawLuxKDKG6yaJBkBIorbMJDLgYSgvtqqmbBy0UC+JCBLN04aLBlWhXSmuxKS0MozKFjGjbKG2av8lQY97/vVlI40w9mwv3cs893HOvwjFYltUFpIHBY6UCsDg1NfX3f5PKseacz+eb7u3tJRaLYds2UkqklJRKJba2tmg2mzOTk5O5Hwgsy3oQiURupNNp3MNDKqurfNndRdo2SiiE59w5vqoqKysr7O/v5ycmJn5tEViWlYtEItNDQ0N8fPaMnXweWwhcKXGlBClRfD68166hXbxIsVhECDEzNjaWUyzL6vL5fKVsNkv1+XPe373LqVQKsb7OP2/e4EpJW3c3wb4+dh8+RMlksPv62NzcxHGcqA6k4/E47uEhO/k8p1IpurJZ7HqdP27eBMchfucOut+PU6uxff8+jVu3CIfDVCqVtA4MRqNRKqur2EIg1tex63V0v5/47dugKOh+P7YQVJ88wX33Dr1YJNjfjxBiUAWwbZsvu7s4jQYfHz9mJZHArlbRQyH0YBBbCP5Mp2m+fYvX68Ws1TAMA1VV0QGklHz99InKixcgJebp06B8d1gBfvJ4cH0+AFTTRBoGmqahHhG4hoFr2wTPn6f/6dPWZCkEWjDIL48eEb5wgTbTxB+NthSoQKFUKtGWTKK1t9N5+TKeUKgl+6/r15GfP6MFAnRcukT7yZO0X72KEAJN0wrawMBAWQjxe/fZsygdHZRnZ3FqNd7PztJ4/RqlWqX58iXa9jZKoYB3fBz3zBk2NjZwHOc3bWlpqZpMJpWDg4PEz4kEzokTVO7dQ+7soOs6Hl1HEwLlwwe84+N4UymWl5ep1WozIyMji61Nzc3NPejs7LzR09NDo1JBe/UKs17HNAz8sRj+K1fwhEKsra2xt7eXz2Qy30/5CPPz8zmPxzMdDocJBAKYpolhGBiGgRCCcrmMlHJmeHj4x2c6wsLCQpeiKGlN0wZVVf1m1bdYUFV1cXR09H/v/C/d00mWl+s9twAAAABJRU5ErkJggg%3D%3D";
var SEARCHBTN="data:image/png;base64,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%3D%3D";
var DOWN_BTN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAD+ElEQVR42pWV628UVRjGn112txS6F2i3ll7BRKXaqvFbbRWDjTFIQqIY+EDUrybGP8FPftAU6zV+UKOVgiCLojFq1MTEIDWSUFqvQDXW1t3Zlm27O/fLmTm+Z4Y1q3bbziQnM5vseX7v87zvmYmgztV7fIkbNsf2LdDkigPHccEND9xhcC0GRnfx7Flsq6tYKL8zEFlNJ1IP0PnGIn9ufwa3peP4eNmFwSPgjMNwaDGP7h4YA/J5E1Onf4Z6YigcoP31In/lYDPuSMXwpQxQ8bBdAQBMAmm0TNfDrOTg+7cuQjt1b3jA6MPN6CPA52UO3SVhAlhUuU4udIPDpt1zkoXp8UkC3BcS8JrERx9pQX86ho9WPB/ASFy1QQD6bZED2l2giH45Pg0ttyccYMerEn/h0Wb0J+PILVHlTCwPmhW4UEQfWARS3sLM6Unoub3hAG0vFfjoIYoomcCZUiBoU/6a7fkOVFv0ACiSg9ncJegf3B/SwYsFPkKAWwlwqhSI2lS9ch2g0wQZ5GrxTwPzn0zBODMc0sHLeT5ysAW7CXBy0fGzN21ROUVDz+Ku032lYKD46TQ5CAs4+hd//nAWNxPgxAKDqnv+GdBBI6qLJlM/aJKWiyaWvpiC+eED4QAtI3P86OFW9KYaMJZnKNMYmR4BKHshrprUF3IgSzqUr36AcbYO4KZnfuQN/R1IbI3D1hwkG2NQDAZnQcdTD2XR0xTDWYlBIUGbclcsl54JQi406oW8ZMKY+A0sEgEzTCAW/zeg7ckLPJltxN4DN2K4ZzMGMlG8V6LmUaUOVSqLefebSouERSwqudEIqF53otEph2EA0U0YuCuN7yZKaJuXUCzZQUS1kP3dcewkN+OSi5J4ubkiFgJVoxEAUwBcH6DTf2zd8qvtvT2NXy+tIPP7AsoyuXl/T+Sf3DqfvsgbMwkfsq9jE9KNCbz5h+3PvsM9VEjY9AGeX72ITDgxxMuJ/tR1SwrzV2SkZxZQUQPx/zU59fh5fkNPyocc2tWAb4o2JpUICQent1p94ID7vfI0E+27t6FwmSon8XKN+KpTVIVk7tmFZ+9MYOIaw2d5D64T9KRiBvmLZVYMJLuTUObkVcXrjmnqCYJ0B5B9HVF8veyhUKAPTDR4i/ouSjoa2rfAKuhovTKLRerxf8XXPAdViNfXhSN9CR/y04wFTv0oyxzRdBReUfPFrWgClbdDftFq46qFnJtYBpo2g7rui5uIQx67u67OmoBayPauFB4czCJX9LCNTtzVk1OwhPi7g2tqrAuohbR2pjA8lMWxsau4RvGoxwbX3b8hgLiaHvuW79iZ9iHT5+ahjg9taO+GAVUnYoc8tn7l1etvE5anZQqUjSMAAAAASUVORK5CYII%3D";
var UP_BTN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAENklEQVR42p2WTWxUVRTH//fNR9vhTttpSwkfEogulI0L485oEBNTQxNXLmrUkLBS4mfjZ0JABGpAExokJSYS17oBwWAUhbgxGuPGFijETChlOm1npjN905n37nvv+L8zVRfaMOMkkztv3n3nd87/f86dUWjjpceXBSHgvpZWrT7T8kb98Yrs2GqwfUscF65EcN9qDdLSJn3UlcyAwaWRXiQEeP5yBb/9zEre77nr83fdoA+5kkx78s2ejLrHUVgyEeZDhZe/K+PmFCGHMup/A/SBZVHar53f09u1o8vBVDnElCvQCcCJKRy9VEH2moI7tjZkzRt6f1mky8fZvX14SDuYrIT4qUiPlSAIBN1JB/GY4NjFCuazhBzrVy0D9NtlqSc8fLkvg8e647jK4D8WI96hAVx8vmu+oKvDgRBy+mwJ5Vwc7okBdVeAfndJauLhzIsZDK9P4DpluVyIEIg04ptI4IXNdcUHutc5qAYhvriwhOpigpD1ak2AfqcsrqlhYl8fntmQwDQz/34xgm8E4gAhIYbB6wzuB7y2EK69nTGU+cX5r8owtRjc8Q3qXwD9RkmqXh2nXu/Ds5uSyC6HODsfYsUAHdS9vpq1BfirAFqBgJ1VZyW6S6FQDXDlXIkbKNfERvU3QB8uS9L3sP+FHoxsTqJKfacqEX5YCBAyUJzZe6zCBjZWJhvcfubqMoMYDQdBujuBIkv65RwrMZTrk0Gl9AdLIjGDoYeTGHpgHW7OGxQ8QQfbMMXIK+x7L5RGttFqFRbUuOa+/M07rMBBgFQjk9TGJFxKO32pjM5+DaUPlyQW+thEzYvM2mP2QSnCwH0JjO7S2NYJfH0rQMn6YD1gB5nQSsWgJFZuzCE77UXVZAdHIw6nnkCyLw7PDRCY2NpzkDlYkCPP6UabnrzhYYbwuGoaXWf6oePA0Jjq7TkUFjWyBze3Pgf2NfBRUUafSuGRPgenr3uYrQAxZQeN+pumwX6dLbtwC8uzA8iObWwP0D9WkJd2r8NOngKnrhssLFMb26qm2UmBKAR+iFohj5U/Upg5sbU9QO+RRdk7lMLj/TGcvOqhYCvAPx74HIyQAHOnCI+dOXv83vYAmQMLMmIr6HcwMUlAuSnRX7MQRgqGAP92nqtG/sM2K+h5b16eHk5hFyv4dNJHgRIp25p2DihTGNFknhn12TxUoLFwvF3AaF6eZAWPbojhs9/rKC9xszWZ7gZ2HuiBEGBycxBWUBrf3h4g/WpOntjNNt3i4MyvPkpLUfMwtcdDGEFYgW8lyuWRNGmUTm1rD6BfycnO4TQGU4JvJw0CTq1we2Sn2rap4lFtTZ7J0fw03HYBg2/mpP/BFGps/Br1dzi1hlMeBZz2aoiIwUOeXz4d1xxC9/P726xgJCu1QpGyqEb/C7Nm40NFQeNXjYcP7F8YewTpjgG4F/8b8CftPHDwwRULGgAAAABJRU5ErkJggg%3D%3D";
var URL_ALERT="data:image/png;base64,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%3D%3D";
var TABLE_SCALE=0.50;
var butON='<img align=absmiddle src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAACB0RVh0U29mdHdhcmUATWFjcm9tZWRpYSBGaXJld29ya3MgTVi7kSokAAAAFnRFWHRDcmVhdGlvbiBUaW1lADExLzA1LzA33bqJ2wAAAq1JREFUeJxlk09oVFcUxn/3vskkqZoJGRMXTgQpCga0qZkUChEtFjFg6giuVDAgbaQroV2WGgUXXQiudJlVyDJpKRVKwYR0YXVqtNrUP1SSOMYRJpjJjJn3Zubc08Uzk4n94HDh8N1zzvcdjlFV6rHn75P7oqbhkqc26WET4oTAlTOBq6QDV774oufmX/V8U1+ge/bUuGdsaiHI8kYKCAKAh2UzzcS1hYqrTix8cvPEhgLfZq41TRXuPctVlxNz5cVawVZvCwDLUqjl4rKFZolmtr9t23X78zHfAvy2cmes/nOq9RAAM12jzOwZBbeeW/IKFE0p8W9TdgyA5OyZ3v2zp5V0j5Lu0ZHcT6qqyvTHugZ+3quqqiPZH2u8rVMHte3WgV7ru/KVhSBb6zwYHwhnXaqsO1UNfRrc9gWpyAEAilGfipErttk0dr15p/Fs/BgAFx7+AMBceZG51VDWhRdXQ07HAJQcQUQwFe0yyUdnNO3/A4D2pEPzfvmU/CafWCwGr8vkq0Vi29tY7p4Mnf/1I4g3sDkXISJOeB8GAx945KUIbQDRMLeGkgNA1GGrTl56WAAmC3+GY3YeXyfbMNbkTebuvts/iJOX3qavdh4VdR8GVJgrLzIYH+Dotj7y/gqPK/M02UbOt5/kWuc3oZEz3zEvWaz1UHF/mN3p48mqyt3n5hUAFzu+ZLhz6H+yAIYfX+fSkxvQ3kAkr4iTXqOq7LjTP76Kn1rywm0ctN0Mdw5xaGtvbezhJ9eZyqWhJYLFoL5MuP4HJ4yqcnj6XNPTSOZZ0ZQSyw2rYbvAwYqEL0CjhRYPG4CuSkbnS7v066f+hmNq//2zcZymilGfICKo0ZphxgdbEAQ34fofbDymesSm+/YiellFk1p1CVGHIBkxLu2Mfu+O3H9Yz/8PLFlkbIqvT3MAAAAASUVORK5CYII%3D" alt="ON">';
var butOFF='<img align=absmiddle src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAACB0RVh0U29mdHdhcmUATWFjcm9tZWRpYSBGaXJld29ya3MgTVi7kSokAAAAFnRFWHRDcmVhdGlvbiBUaW1lADExLzA1LzA33bqJ2wAAAsFJREFUeJxlk09oVFcUxn/3zR9HaoJKgphMFGtCrH9alUTqRgWhJtDFjBRsNybURVWwFCqUUmgyghTcaKlLQXeiopOVIEhtNaDjaNVYiNXYjHGeDmhokpcw89677x4XL5lM7AeXezn3O98957scJSLU4unBzz+2PliSUdF4h0RjSaN9ghmnqGem75mZqb5PLuaGavmqVuD50a+yKhpPTT/K4dqjiO+FpGiMSMNKrJa1GLc8sPXC7fQCgUrhaeL1mRPPKoV/ks79wapgpG4pAIEzUY1ZLa2Y+uXFYMO2tu2Z3yoWgH2673xt8rLdKQA2Zh+wMfuAQOZj5uUIMl5Kcvf6eQD+/enrzuc/7JfcOiS3Dnlz5ayIiFxrQ+ZwZnV4ti+frfIGP2uXm7tbOy3tTByffpSrvtyQ7gVgxJ03yp21qWlvL/7OsBJrvIS45eNWpH75etceBaAh3QPAYOa7MNEu4BQLAIz9Esaa0j1MBGCVHbRlrbeMMc1zbs/1+eTSOVri8Hd6MwPdm1mk4E32HABr9qR4q0EZQ6B1c9Ron/ehlKIhAoEzSasACQBVvZ8Iwt34Gst4rq2iMQCm7v4BQPsXPfNfqcLVONuefSfkiFIY7dmRb9oau0TrtWZ6Etcu0JjuZdWuLqYmJzGjT7AWJVjx5UFW/XgKgN+/74XXL6iLxwkCk1NDB7o6As/Ne/kboZGH+/jwSP//2gLIn+wnfypDewL8+GK0DjqViPDXvu1Z89/blHk5AoC3ZSdrvu2n+dNd1bLzJ/t5dedPmmJQn4jjBjLQPeyllYjw8NdMwrt19ZmMl5KqNAaAY+CVD86sYXURaIqBisUpB1Icq5i2Q6O6smCYbnd/lDVGUtZ4CavsoIypGuZZMWZUBNF6oHvYWzhMtRjc0bLJoI4FYjq0MUnja/DdItq/h/Z/3jPsP67lvwOjGG1S8vVScQAAAABJRU5ErkJggg%3D%3D" alt="OFF">';
var ResetAll=false,deleting=false;
var sitesupport="http://koc-bao.com";
var http = window.location.protocol+"\/\/";
var gameurl=http+"kabam1-a.akamaihd.net/silooneofcamelot/fb/e2/src/";
var URL_PROVINCE_MAP="data:image/gif;base64,R0lGODlhxgLEAvcAAP%2F%2F%2F%2Ff%2F%2F%2Fv%2F8%2Ff3%2F%2Ff39%2Ff37%2F%2F%2Fpe%2F39%2F%2F%2FnO%2F37%2F%2F%2FlPf%2FnPf%2FlPHv9%2B%2Fv7%2F%2F3lO%2Fv5ubv7%2Ff3lPf3jO%2Fm7%2B%2F3jO%2F0lPfvlObm7%2Bb3jObm5u%2FvjN7m5ubvlObvjN7e5t3whN7e3ubmjObmhNbe1tbb3t7mjN7mhNbmhNbW1t7ehM7W1tTfe9TchM7O1s7OztbWe8XOzsXOxc7We8XWesXFzsXFxc7Oe73FxcXOe8XOc73Oc7XFtb69xdHYAL29vbW9vb3Fc7bGa7XFc7W1vbW1tbXSALW9a6rCY629a6yurq3KALXFAJjCWq21Y6uza6W1Y7W9AJy1Y6Okpa29AJ%2BtY621CJytWq21AJq9AKWwG5ucnJylWpSlWo2oUoylWpytAJSUlHyrSoyUlI%2BcWoycUoyUc4SeUoStAIyMlIyMjIyUUoSMjI2gAYSUUoSUSoSEjHuUSoSEhICEe3OhAHuEhHuMSoSUAHKOQnOMSmKYNHuUAHl7fHOEQmuSAGuEQnOMAHJzc3OEAGt7Omh7Qnt8AGN7Ompralp7Omt7AGNzOlpzOltzMVJ3MmN3AF9rOmFiY2trAEp6AFJrMUpsMSx%2BG1JrGVlbWmdjACh%2FAkprCEpjMUprAEpjKUJjKUJdQkpjCFBRU0hjAEJbOkJjCEJaKUdSRTpaOkJaGTpaKUJSOjpaIUpKSjpSOkJKSjFfBUJKQgB3ADpSITFSMR9eGDFSIQhrCAhrAEBBQzFQGTFSCClSGQBrADFSADFKIRlbBAhjAClKISlKGTg8OQBjAAhdCClKCCBLGAhaAEI6AClCGQBaABtKCCFCIQhSCCFCGSlBBwhSACFCEBlCISFCCCFCAC8xMgBSABlCEAhKCCA5GSE6EANKABk6EAhCCCkxABE7CBA6ECcpKQBCCAFAAAg6CBIwEAA6CBAxCCEhKQgxCB4hIQAxCAIxAAgpCAgpABkZIQApCBkZGQApABAZGQAhCAAhABAQGRAQEAAZAAgQEAgIEAgICAAICAAACAAAACwAAAAAxgLEAgAI%2FgABCBxIsKDBgwBCHAqlhgDChxAhFglEkY8DACkWhnEYsSNBG6xeCCSwJdShFCNLnvTIUuAhOQOnUAw0x%2BELSKG2tOyoQU4oSD9GjjFZQijRnRGLXArF5iKALTPlOLSBcwrSg0qWWhVINdRWAF2%2FXjXIgU%2BoQBoEpph5SKQDn2jHQpwSqiiAH5cuKRmIV6%2FchxouqRH4YmYglA7M8onw16AaiofCCFR6KejkvJb%2FEngc6JBOAmwg6wSQtXLjggTC%2FBQJQEOgUHKcuobt9DRXnBsBEJADeStdSDZsC1RyyLBIhQw5Im%2FYmLhhlBMrXswYKrfwgQ6GyWPFj8%2F1iJf4%2Fq2DJ06DA2vwuMO8%2FsIaP8th%2BLlaVx5A%2FPn1hRMI5C%2FUQFfiyWONAxqIkw4u%2FEhmGwGs6BOKOPj0AIAc%2FLACzzAXUciKPBgKpwQ%2F1nAHiUDD7LMOhwSEQB%2BCYl314TAsYkQeLvvslcKM%2FOxlW3b0hHIPLg085Y88J%2B51iD6s3MMKR8LdiI9IL9BjzTD4BPXCPVNW%2BR0Ah%2FwzIgBsDHliUJfgwwo%2Bl1ynATz4nJjmD%2FgMYw0%2BwcEpJ52NaSBPm%2FSMqCefIxahj5z0sGYbJA6us44GDNLDyj6H6OaKo5BeZ4OUrvwzWAr40LMOPYEAMAU%2FuIizDkq28eHpOvi8R4B2%2F9x5l9123TUWyKqtBhfeeOWdlx4%2F631XRD%2BSsbJObVsSRIA1oTjQwEVK9KNTqcj%2BFQY9ewa17DCk9WPVlN2OdloIVKIpkAPpQNLAs0%2F1s9eUTP5VQjqh2tAdAeLg0m4R%2BOq7hbvCHSJOCACEIk8Eegay7kVquJpvYyURoAE9aVJogwPrsDIhPxdnLFwIXgEQCD8oHbJOCM9KLE%2BadXB8HYP6yCNSIPikoGeaNNu88ndK4KNPpABcUl7KnEZ6SM3C2aDPFgQ4cBEk9GhQNABQS40P0HL1sM8Uz16k9RRNX3SJPFLrE6ptL5gNViAh2AvT2A64HTTZwo2dVh1WFcFPEf4pA8BKOgTIvaDTL6wT6bDFrkMA4n6nU%2B1OYb8AT6jLNstutNOK83hjDQcViD6GJjtQCBxewjYAfLh8NKqnvURhUKSnuQI%2BaO38Au1Js1JEOv4BMDsul%2FCR1upzp7WjQ0TwM0YIV4PFjxrMRyr4aQ0wBkCpgZt5SWxB00OwsZvvpAEc9%2Bhk9%2FXiEHA%2Btd%2F1AONF80EC3F3AhnudGutA8mTjF1ljDYOOA4D%2F4vUXDaQrf7oZhjjkJ5JoSeZfOjrNFvYRikvkRk66yder%2FtevxoSBghYMgH0cZEHdgAtjGrPNFp6nhtxAcGMveKHFbNOAfCmBD8GZEJouoRMHPOxmW%2F4SWFrY8B6R1axzIgPdoTSXkNKdrmXBId53Uhec1ElIdASBE7Pi5IDPzYwfodOMfYo4tRJczYyR4tSXTuMQjPVOCfsYRijwgQsCQOIeRdEf62wTAmss6gX78A4g%2BfCCWsVAbd%2BRQz9gskJchIKCBAjFogpGt8bI4R%2FDSAv4%2FLYoY2kSHsbj4zqWBgAfruNBhWKc3gaDNnpMIQz7U6BDqCWnICkwSLa5xDBU5Kd18G48KZiCt0QlLeF8jhUICgS%2BuLWt8zBzgH85EjJrJU0E8aGDNeSWbdRgIlzQo44NKwIA1NCPH4yBH0AY595sUyApzWkvZQrFMJ7nAHj4RwMeY%2F8PPhTEh31UEYxURJ3LGqO00WhxjhjyYhLDeJqABhSL2LnYOP1RBD4oMRD7YKi1yIiPERWNeR7t6HcwcMpzSZQP%2FejB0fKID7vwcU7iVFqoYhBIQNYLkcJR5CXaaAOHHAKMlwAlJUMpFw38QBxL2iT4PMlJ6y1oLVUKwAsIprRDAEF5AFglDXGBi55U6VXpA4ACsyMOW4b1NFPAhxJCAI9LOIAAU6VfHaJlFWGKK0%2BsmU8fn4khcG2LgDsJgUgIgItjCVY3hQ3Bw3yozdOowR%2BhEqYS4iNOcv6AsuoU52kMeLIGgOuwnrWGijS2phQas5IOBSMUUefP1k2ylBJ97A3%2BL6rE74ShH%2BmUIkRLSbCs%2BmMKDQsO1HornPgEBYiArIMDbBfIkZaUtwKZgj9mKxJJErWA2kknANBIvzBooHk%2FeN79%2BLFGB3xAIGko59EIxj65HJZq%2BNAAJOiGwfmmRU6AvYoDYnCRQl5TA0G6WSFhIswWjaWQ9ICHPOhBjx9Isn%2Fc2iS4bBOKfpyIHmhKkUOiF17J3FazmzWeHrGHQvQ1LZ9FFbH3NGC8S9CjBBisZ%2B%2FQ6g%2FJFDIM0dpLP4MJsH5qFCnLsoZAHkQg4xmrj%2FoKwT3WyEZmDeScQVmvcbmEtL%2F4ME3n6m0R%2FLGF%2BEjojsRNGj%2FQAs3dPmUfYXDAT1%2F%2B0IPuFGgY%2BZXLlK%2BXjhCQU5y4qPOdnds7NehjCg4oUwiiBT0UNyaS%2FDiEDX6QgiBrIKD%2Be%2FRAT1MEfIijCD%2F4AQH4gI8iOGBDGvjXFlKws7%2B42AZ9TN9tpxClEa261WI%2BRE9%2BSzpIOGBUasBYV%2FXITjXIAQ5zPEQIKFQEG%2BCO2MY%2B22mUIAc58IFDSjD2IRxw2y3oKRQaMFiY%2FyLJqQ7wcz3QG0zALe7G%2FC0Fih1GA0KRDnSLA85Hs8GHWHmaEjhKA3dOgT4goQHs6Zvf7W2dPoqg2CXhQrQp8JiLeXzXxnCK3vYis5AjroEyyyVtCnqKPtK8ZnsJD15bsmPM8GH%2FYNH1Wx%2Bj9I76Rh5B4ajhH5Ypgjzk4SCHyJzmoYjzWK4tEHK1CR8wWXfM5JGZxoRXH%2Frgxz8ilVZ57AMSDmn603W%2BE1z0o1X9iFoKIMQqyTgAF51aRw7lYoN04GPBVuk3Pu6xDpGone0%2FBvIh9gEPCl4Eo6xixUVg6XRl368fKOkjPiwd%2BDkRfksO6JNuICEeB2UoZvoI1ml%2BMPOZi3PrgxctRiCED83%2F5ebygEdQQC%2F6zQ8%2Bk%2FeD%2FE6TuCcFfW5PDf9LCuYU%2BqBM4R4zFztYPkXH8F2lCP%2BIoMj3ZJXhk3zZwR%2FIyVOum0uwXHQEUIIaxm7mUgI3M9FXQwySVQIl%2FoTyBWMA9EDAL%2F7vLG7sGgDu2G89hrgjZdBKiL8SWBMDNSiBSfW%2F%2F3WAIH8l8Ks1W5AG6%2FdKe%2BReXcY6DnCA2KGAwmJ%2FTPIDalB%2BANADagBi35ECSiAbXUZcoRYG27YgRcAai%2BOAfFGBW5ICYRAGrPMBYWBto9OC1zUWKKiCAzGDrBMCMLglFKh%2Fk6EGRVcEPrglHcg6L9CCxIWCW%2BB7V6EB3qcs0jd22Ud97tWE2HF9AxGF1ZeFWriFXNiFXviFYBiGYjiGZFiGZniGaJiGariGbNiGbviGcBiHcjiHdIhFXQSGKSB5XKgG7rdbwvOFd%2FiFU9Bye9iHEPWHXvgC%2F%2FTWhfEHhnz4hY8GhoMGhjYghVsYCEoIUZiohRpgWl1oA1jmhUABhqwQg1nYiY6YcV04il%2FICh%2BYhUXAZHu4iFzIil0YAp7IhT8gi1uoBrSohQySiVhUigsyBZERPqj4hVQBhrbYhdgGiLnYi6rIhYdQdFwYCq9YfT%2BANV2YgmBYjV8IMmC4jWDojV4YjK1oikiROtagD6tnEMnohcv4hc14jepoZp%2BWit9ojVuIjV9Ijl9ojl4Ijl4ojv%2FIjVwokFyIjl5IjHkiDzk3MpbYGtGohfMoivyohc%2Fohfn4hS20j2Doj14IkF4YBmogAAIwkBlZfQY5kgi5hQq5hQzZhf8O%2BRfhBROYcxAdmYi8qIWKRor3uFs72Y3TuIWHcEVeuJFdSJJE%2BY1IyYXZBoYqVY5FqYWsgEs0GZQeoQQ1llX1UwJFEJZhOQXDIANmeZZomZZquZZsuZZb8AltGZdyOZcywEN0eZd4KQOPwAN52ZdtyQOt4JeCqZaBwAeDeZhmSQhbgJiHeQpFwJiCGQaXAJmCaQZmQJl%2BaUGYmZdKcAqbmZeS%2BZl4SRGieZetwJelKZewoJUdwZWSUW5FcAiyOZvdoA62eZu4mZu6uZu8uZvecAvu0JvCOZzD6Q7A4A3EmZzKiZtMYAzBuZzQ2ZvlwAvRWZ276Q7I4AzPaZ3cGQ%2F%2FYAAK8cCd4qkOvFAO48md2UAM23meyxkPgAAI4cme0Gmc2SCf0Tmd9gmd8UAKbRCf%2BUmc7uAM2vmfykmdBJqczSCMEXGT3VKVABAM6oAOEjqhFFqhFnqhGGqh3mALGdqhHvqh6AAM2QCiJEqiERoFxhChJbqiGVoOt8CiMIqhxeAMMVqjE%2BqdmuAONmqjt1AOO1qj2QAMPxqj7gmfQwqjInqkLOqiSrqi7qAJYBAPTVqixVAMU1qiPXqlH6oOCTouELlpk0YQCdAMKqqlHbqhZvqhSZqmHYqiZcqmFcqkcCqjNDqnFuoOYJCjdmqhWbqnFBqkfkqhRSqlgSqha1qo%2F3JaqE8KBjpaqOggoI4qoX0aqFyqoBExMu34jgUxpm%2Fqp2gaqYdaqG7qqIlaqDMaqXiqp446qYEKqI46qKA6oqT6oo66qI1aqJAaqay6p5W6IFsACbmGEJwaqZ%2FqqKEaqKOKqLTqqKdaq3l6q4G6q3vqqoUKq8Yqq8qKqlAKrX6aq6vqo4Xaq1k4rI5arIV6rH6arIFaqoHarIr6rLoKroVKrYFqreeKreu6rIFqq5HqrYUqrXMqrtVHroVqroGKrnuqrn7Krn7qrvsKr98aqfTqp%2FZ6sPi6sPrqp%2FzqqP4arfLqpwJrZgQbqAbrpwhrpwq7pwy7pw6rsRD7rx%2Frp%2F8Tu6cVa7IXq7IZu6cbi6t1GrHh2qXjSqbEyqGxGqnokLJ2urJ22rI6%2B7IeK7FC%2BqrvSaj3GqlKC6c7G6gd66cAC6chu1sj66lEe61Gi7RzerVwyrR2mqrcuqddC6cza6c1u6cnC6dom6ZZ2609C7OO%2BrUQFbZ7WrJ0e7MJm6KzarRqO6dsG69QG6lza6d1y6Z3a6Z5u6db67Yxa6d%2Bi0WAa6eCC7mEi7KGm62RmrhY67Rcm7l2Grdz%2BrhzGrlpOrlaWrl2erl2%2BrZpurmi07lz%2BrmvG7pzarZ2m7Msu7cuq6p866isC6euC6ewa6aye6W0O6e2O6e4a6a6myy8C6f%2Fvuu8wAunwiu5xLu0xtu0yPu0yhu11Tq1RXu4tbqt%2FVq%2BmNu3QDuwQluuY1u1kRq%2BsTu%2Bc2q6bLq4Pjuv6luv7Eu27quo8Mux8nu7quu19Suy91uw%2BWuxZTu6%2BYq4DXy655u6jSu1RorApKvAjBq%2FRnu9Wpq9W7K9bNq9bPq8Zsq%2F0Ou%2FabvBAYy685u%2BjnvA%2BjvC%2B7rAPHvCD8ymKvwdLJymLpymMKylMqyl0XulAIy3OOzAH7y%2BIdzDGfy%2BJczAQky%2FlnoaR2ymSWymS3ylTXylTzylUUy5U2y9Q8ymy8umzfvC39u%2F2rrFQcy44RoMCaCFYaylY6ylZTylZzyl%2F2ncpGs8u20MpyispXGcpnOsxHU8w3fctrVrw2zayFOqDnzsxxNMshVssxfcqUlLw2yayNK7yJn8xmn6yGYayWQ8yU5sypQLxFqLyWmqyU3KyV%2FcGH98pYF8pYPcpIXcpIespKg8pQKcvAS8w1dswQn8w3h8y138s738F788pcE8pcOspMWspMd8pMncpMuMvs0MwlQLzT6ssbast9VMqREMtp8stkbbzUf6zUcazkM6zkpazh6sw%2Bjcvuuss%2B1subhsprqspEV8HdncpNvcpPY8pPg8pPr8o%2Fx8pP6cw%2BdsxeksytHMztPsznoMz9csFw2tpA%2BtpBH9oxP9oxW9o%2F8XPaQZTcUAzdECncUkbMnUe9BamtBHutDCcdJHmtJHutI72tI7%2BtI2GtM%2FOtNuXMUG%2FMwePdBrW9CX%2FM4gG89%2FO8%2BBG8qDO8of3bA8rcyqnMusbKaurKWwLMiyjMa0PLtWvdNYzatazblc7bleDbpgTdXki6pljdBn7cgFTLE8rM44Lc06DafVy8iBvcnBUNJjIdRDStRDatQ2itQ2qtQ1ytQ76tSMDdWELdVfHdZVHdIGPdeaW9e7e9e9m9e%2Fu9eH3a5jTc5%2F3dONPaVpfaVrLcxtbchvLb1xrdiz3aQ%2BPaRAbRuS%2FaOU%2FaOWXaOYXaOaHaOcbaOevcqgTbOFPdX%2FsU3Qpn3VI53VkH0Vyb2jy72jzR2jzx2j0Q2j012j1W3W1y232T3afI21wc2mi23d1uzJpIzX9dzbhIzBGKvBft3BGt2qg43doq3XpK24952m%2BQ3f%2Bx20%2Fd3a%2Fw3bA166w43RtX2lxT2kuT2lu83NAA7Ov63MD26mEQ7YXszfQ3vh%2ByvgOEvgzmrgNL3RUd3R9L3dpZ3Y%2BL3hR%2FrhO8rJfUzhL37TyCrjpUzj72rjT13TOY7kM67FPg7hQD6kQm6jxw3GrM29ru29GD7lzHrlnd3hU5rlNhriTTriEF3i%2BXzi5JziWrritt3iRo6%2FMO6o6Q2j682i7R2j783iUB7a%2FzrO4PUdwHJ%2BpXTu4bet0J0MZAQQ6QTBKA8x3jZa3jZ63jC650sK54hM5tRt5sTd6Eqq5krK5irt5hTt6Rid6FO66GdO6sat2g8BY%2F4jDlYBMgJigWLa5S385XQc5kuu4QVe5YKO44Qu5cOe0yb83XR9zR%2FiSK4AT%2FjABtaQDqZo6TWK6TWq6SzK6Sva5yv65zAa6HU%2B6Ape6K%2Fd4Pbd3XLt7Kl9zXJAD40mEEAkWQdBAL6OxMAuycJ%2BtqwuzqDu3qKupGgOpAku3wu%2B7oeOt67epLA%2B6nbeEmUiDuJwTWnjHeE1GGHjNAQCoeUQ8iI%2F8iRf8iZ%2F8iSPDtnAoSjf8v8u7%2FLoYAsj%2BvI0X%2FMi35zqYPM67%2FI9uvM%2BX%2FLoUKXo8PNEH%2FLqkKc5X%2FREfwveoPQ%2Fr%2FIs7%2FQ7zw7vyQ5Sv%2FMxP%2FNXb%2FO%2FufU6rw5QmvRe%2F%2FJBb6VjX%2FM9f%2FYuv%2BW6IU9hAAnE4l%2FOMweiwgp2f%2Fe2wAu3sPd83%2Fd%2B%2F%2FeAH%2Fh%2FHwuxIPiGf%2FiIfwuEn%2FiMz%2Fh6bwSZoPeNP%2FmCzwuFT%2FmYD%2FiLn%2Fmcv%2Fe8kAWSIPmdn%2FmbP%2FqYX%2FqmP%2Fm8QAd0IPqp3%2Fio%2F%2FqJH%2Fuyf%2Fi8IAlZ4Pq1f%2Fi0v%2FuCHwu67%2FuAzwuVUOSQU0oZUwP6oPH1E%2BnOLzEQKrH9HstGi%2FPsnrb%2BVtq3SK%2Br3hDfc0r1gMAOyt67Af%2BjYA8GFY79kQoOBw%2BjvLwTDRBtGeSKikdXB6HtMcrtMertKwruJQoQ5W6hI1jQ4EGECRUmLOZs4UOIEd2B0eQu4kWMBW%2BVy9gRYjZgHkUmjAcIULyRKQsCy6ZSpUCXKd1pAmMxpkhnDm%2BK3Lizo7pmDgAMJVrUKAAH4tL9UMNPDQBc64qEkhfiKIAEzdT57OjNFteOLMFmjGJs61iIMNFGbLgW4sSKbh%2F2lKsQZF2FJU%2FiTSiW70G1fwvOrCnYYE7DBukaBir06mMARcThuwepAYAa1vTJC%2FM469nEXhOvbDkaXVnQggMnbjv%2BGq7NxIsN3x2tF%2BVov4lXCyYM2zBi07L%2FNoYM2YGNFEWPW%2FWs1bRo07kTox69W3DrxK%2BDcxxNO7Ht6KV1D3RN07dg4KOF8yVe3P17op%2Bffw1v%2BrTZ6uRHYzesXT33xLwzDDzcxDPMOr56My292AAUrD34ImwuNcGgK9A%2B6sazjz%2FeKDrvr%2FX4ElAwAhOTTjX9%2BjNvQZ3%2BGw1CCWOMz7nRLDTRQMMyPDBFwzj8y78GTRvxrxINO%2FEvBPFScDQGDQuxLhhljFG%2BGum70DQdUdywxf483E7IkGoz6bYbTUuyriUTa1KwJ%2BWKUsoIqQzNyjKxxE9D03xM0EsXuwvzuzH%2F68vPtDR%2F49JJB4cLCk4p5TTMRiNxFCxLl9RxJx5M4%2FmQoDPr0vOgS%2BM5K1QKMwISUTBNKxIjUlM6kq9O3SoUvUPZTJS9RRmdksY57XuVL0plEiaPKq64goxN1Ck1Vrc%2BLUgdO6qoohR3uumiWGFKvejUtTKFrc2EtF2oVYOGfNatVSPqpgxsxYXo17qYRWvWkdTJVFN3CVozIXJvEq7fsd7UtThHb1L2YIQRRscbYtzJN9yY4D1I4ZuCFckdQ0RAYGOOg1jlPHnRcpYgdWYwwIA%2F4nlGAgMQkOVhhbgdqxs3yCBjkbPANcjSbjJSxxCbJ0nNXHTcCSecbgP1uZsN%2Flr2BOa%2BJIWVxx9XVMnSWuKwmYw%2BglF2oX13ppmMM7CBOiLZfra5lLM9EnjgCblyp48cgrD77rtzICOcJGgIIluMlK0lYqkRcmeTHHK4YieLO3LnD44RkCDyE55JLeSxRkZHnRw2JkTlDRBQoJa2DZJZ7k02NkCEbrbSmWSagzCH1SNOLoNMdIZU1pAZAB8r3YfU6UZjBNgeyS%2Bo81X%2BLOu%2BXqh0fq2uFx03Jo%2Fcgi7CETfsZ6WxoOVUoFco7RxOTnmtt%2BE%2BqmCX4rmi5cgjNyCHcDzY2JNNEVInmCNmIHxbQ5xsBuJDSOMClwrriaBrmzgCx64AG3WwgxfuoGBq%2Fi7lMAo6zF6islQGSYYpCGIKNBS8hk4ueMFndQ4Bn3tG6EZHwNP5xB1ViNwiLPI6ddSiBQZogamcsDE34G5EwmugBHwHFuA9b3gbM97OPPisJwLDGyhpnahMV0EK9sxhOxNVFVNjL%2BF1g4KBuVQ4uhGOCnJReJYiYNGkNxIacsx6CDBAFfLHPZJhw34ICN9OyGc%2B3HElfeorCvtUEo8uiE4BCuCYAhjAyCCEo2kIwF9E1LGJ7%2FnPJRIbjCE2NsCK3UkmUNiYCGoxDzYGoWUt6FnRuoEIMTzBDZvQHkHCsYg%2FEEIYf4DCH7CxiT%2F48hmEgEIZNrG5ZwRzESTzRDCb%2FohLPdDCYZuwwxN6SYnNbU6FLHQh6UYSQ4O1MHJBcB2ALAVC0MxjEp%2Bk4BU1tUWCuOOHCAgiydxBjmWksWjC2JgFnmFFJCotcEssngUXkYQncAFpm%2FPEE56QPXQQgxZu0IEJgtAFWdhEHWdwaCkmkYQT5MANrSPZM8gQhBMEIQ7P0KgwTnqCExwhDtjgRTw3UYUZnKAFUEBELZFJ0Zi6wXLffGNH4pEHjt1gEbX4wwk4RgkIXvAa1wAVFjGlx42lQlP4mhgFuQpFDaqDF%2B2A58%2B60IWnQRGdlcoVIQnGq3DWQq6TsF4f5FoLYZgDEXowhOU26DAOAnQei%2Fgkpuxp%2F5OvHrZolloGOaK6FX1i7JNtNIgBLSlOes5jMKWYpTBItokWxG8GtXCYMBjQshmobhNJaBkZRAA%2FBNhRGAowgBGVpUoDkDOHdGQALcyRhPgh4Aja45znQCc6b16MT2iJRx82xkjJka4nypJFH6T1B09sTh2pSCQCTGCItG5lE8SapU%2FlCUSUqAMbk%2FBCE8qwiFw4LBh5YIDk%2BrAIswV0L0sjXhPj6QmOUQsd8ajCyZJAQT3sUY5u2ErJWqYC2nJMB0hzxyqcGjkTpMJhviAebFlQid0tgI6whUKDa6GC%2BKkguY4r6kAvPIRwiGoetbDAxrpgE3c8YxFkqEI0tyi8Rf4YYhPPsAOypLHHVKTCDV1YBElJFo5JxKELhhCGRmthCEPU4pZN%2BMIkfOqJRSzCd%2B4QBiKuZYhg5O8ig3QrVuBqMGXFIxjWmwQqlRWOOHihDFUWxlkJgY0%2BJEFvGf3ZEDbmgS64QXvhIAROZ8CFPEjjLOoIhyGgMIM9K6IJXRDa5roR6BlUgRC1lCwCQBkTy0JEHbmw3iZ808EGI5BjClYBn2tMOXTMs5S35qM7grAxQ6hsjx6QRjwIsbEdcKPAhw7dxmxY3BUe94XfXC5aUouAMlz7dhuhdBUmd7KNQSHGUICtAY7gsFoYOnIt0HDR5hnEHIaWjoc2xDz6ANusUv%2BWJAJdM0H9SzIdbOx2wrvwJOIhawRsIAgKDja0E34EeSPAhuFQoQeOAINPxjiOOciDa%2BmIhHhgQ2PY6wMp6TgJo11bBUe48Ax8aqoWb4uwTISNO%2FLQ2Qb%2FgXgbk0AXtFsLOopA3h4QhsYUcO2NtUDAOUR6wvuwFQKfLAgB59hwlVU%2BlN0mDwpGgAXi0EY2u9WQBquF9WwIu0l64uB0bAHWN7aBUsyDtRwzwAbMqELYtsCv3fi16jzwWgMMXBjyBncOLFfqU7sk1Q85XD%2BPqL%2B%2BV0AP3VhEjesYD2HcWgKE6EMe5M7zRYRDFnu0gz0gF1t7pI5jm%2Fg8AvRwDShYQAL%2BhjhaA2Mrqm1Ke8WOq7bcAIwABtSiDBs7QTd4UY7HtUwCiWOkAbpgD3LT%2FQjxkEbEeW1KS707Ht1AseQqYD27%2FwHffNQ3QpKoEOH1l0LGTjoa14mAFqARuKau8jPmH39oe0AW83iGCTZW%2BpkzJXtABxrYGJTru6%2Bzh1Q4gjNoBHdIBeILH3twgypwg1qIh5lTgWewh2e4NlfzCHq5iOYiPif7oC1yh2PjOV6rAsGZIzq6gm5QMAVoNvgzm26QNwagwTy4lDjqpzkiBIehupR5HI6xAF5DuXppqza7irGLiRwyO40iKLWDQI5pAaQLgnmoAhHjuR56H8mZgRloPjv%2FEJW5g7%2BmKwP%2BG7ocCJ06uhRPMrXyuw%2FKKjULeLydKbuNQQRiUId5SEEPwIZnuDU0xKD5mz57mScumIfMQ4ATQIfu2pg4QAeN2QBacIhuWAV0eIZN6LsqwD3jEqdpU664YK4r2JggcAdZMDtiQD6TKz17IAQLwLQcGj5GnAStKkXJibRJ2KMhOEQgUkARkAAVoAVbGD3JWYVkmpzNm4QS3InzCxd%2FoxB1EIZmKwV7iKMu4L9mWwSUcAdfsB5qUSEo0Cx3sL08uEZTrIVSkAVcPAN7sD1GTII%2F8IV22MNFTLoq6Ct7sJc4cgJZKIVaiCMyCCSJiDmJoEVyeh5q%2FKRU%2F3gGXEQAg8NDBFCBReACT4jBpEuFbiAE6zlHN9gYFdDIPmCk4iMwjiGDZ6gEFgg3URHC7SOeKhAGYWAtA9AkkQg7QmrCSpHIs%2FM04plCjjmDzemuHBAe54I%2FmVQHN5iBDViEebCH7kqCGbMeO7CUPtjCMrAHpGJEYZgHY5SAU3rDxFOJxXseifxAg0Ajh6HCDaCpzVnE0QlEYMOx%2BauneOACG%2FPEBUiFgPOAGjsC1TuCEnrALsgBXrs9aOMm5IKh3tsJ9SIeQrCHeOi7IDg%2BdzC5DTiCPEiFKrMIdWKnaiGeOEClz4yuedA%2BdMCGYPAFb6iERSCeRbAHYZgcfyLIm%2F94Rv2JRsMxuTJAB6eSAK2iwjo8C%2B7bmJRRoTEsGiHYmHPsu%2BBCgCCIB0yKHwnYARBTBzIIrg0gg24wyec0ACiwTcYzyLeYv1Mcl9MTAWHQFG7YgY1xgnjAQwlgPYfBKgSoN3t5go05N6qrJ3TwQHScyM0hhjNgSXUQQnv4PdahoGCogjw4piR0jCVkwjfziSd0tij8ybVLOEmLhzcUAWwYrMmCrBzrhlTog2tLAnughFIiLnSQt6ycvyt4hlqwv43pA3sQyzgsS%2FSbzRslE3eYhBbogk5Qh1U4NLdUB1Cs0VszBLpErwHDxS7QlI%2BMLfupAlI6gVacKjv4Nvjrvk7%2FTEzdY8xRBItSk4A8MISD4rlKQL6Z4xgGaAFFs5SZ6yElrbFpIzgDtAftU5ZJqIIWYBmOMbhv7Do7dEZ%2BsyTdBJX3m4H3K8oKY6Th9LTu%2BxwVclLlZE576DsPUAGYaoEWUIESc4da4IKd%2ByTtmoQhoEE6coMA3QBPPQEVUAETKAM1ixnyfIh4sAOQbMY4s5c42JgkuI1r0IPJwkN%2FajD7XAXIOsoJuzARmNUW2MYABSVi8AIDRdCtVIFaspd2itAJjRu0uFCJy9D72dA%2FVJZVUMb1nDmbRIdFQKl5E1Z7CFZGJLV3e4e%2BW6RFUh0uyNHJCiV9O9CNoQExOpjaWR3R%2F%2BO5Vagpd%2FAEdpVLBECEJ6UnlHCfvDTSydkARsIynpMcWbgGWqixBbBAdaDFMM29JSXTW00Jgn3OjWkCdigaQug%2B6RuwOkWmbmowdOg%2BSuBT9OqGBjqZ5bs1QqXNQ73NRFU1glqFecigNAqH0JIAjEOAPnAYgiIEVIoHT9hCDbtUi3CH5USAc8TFJKA0dEiFGkWaZxCGTsAGT4gDFSqeTFTHZ5iEMpC3GcBYBCixo5GrM7qYXF2IeDg92xqMMgiCPlhPez0wgijWY0VaZUUyyHrDZ4VZbAtQJ7CIa81W47SHAp3Ibn0nl1XCcJ2ROAwXnjRXSkJXs1k1pMVAVN0cWv9EAIujOhWt0hOopXjQT3pSB3mTgA0YXg%2Fwy6zUUYF1CRTsGGEIB2yo3U4kKCSwhWrpuwFaRLAclbq8WCm9DaQLvlqor4JFB8i13W6QTNtL2U%2FcWWorUwtFOJg9AbO5FGHgrByYI9bL2TvdGEpIr4VEgE0AWnrK0ZYRAT0AsWs7WkNN3YPAzYkhqAedBAmW4FIYMHt9O8Bxh%2Fk7gVLohlpQIRjQHrDNVLK1h5mzALXrhhmwABXoqxOYnEmwB3ugsY1hKtkzgQ20h6OcAXeYuQ3Yv2dQAQtogT9oWcMZXPSTSHgrmmewnzqq1xFFB24Qg43JAVKV3M2xzw%2BMhyqVne7%2Fi4NU8ARP2IRS4EzvHMiIwta%2BbcnPfT%2FWUZZnKANC6ISFchvTPV03Y%2BCJWV3Y0VAqTNcLrUPZhcMcqzEJ%2BIPz5VUEUNH32wCWqhb%2Fy9z5K4NweAZsqIVgeAYxQl5UEyWXNbmuawEFE4HDu2AWkFcDxDxDTi4NhlK%2BnVIL5hj%2FCYcLQ4A4iIdrqIQH2M9F8F3EVFn2FUUjBsHu8oAyOOZj7sEmg4IcEAFPyIcZIx5EMOGk%2B5priyRRwUUQjYd3C1AyaIdlCIY9ikhlVAZ1mB39Ek%2F0I6jnHCByFS6NQjgJ8ADrsQBXgzZMFVvmRIlrk4AgCF7Smj8LCAKQQlUaZkS7%2F2m2MQyHa1O47tuA3dsWJEY%2FeIyDnhEGdZO40ty8S1mFDBC4qYQ%2Fc5hcYeVDbIBRe5i%2FcbQHvhuCPcvCjUHjzl3jl%2F2DeVhXYJuHeRC%2FhGvGwLnj09XJq%2BFjnzzXP35dZF3PN2SlZygF2gyGfbS9Yf3fI3gG%2FuGYrKzSGTjfZ2gBEQiCVJgHTlY8T54eUI4cERCwzcFL1eG5r5vGCGPlhL2dASswA7iC9JIF1cHrGYIf0sqJ2lGduqMj%2F3GwrFuZlnmZ9h1m%2FrIxycwU4DXF%2F3ywNC0Ddh1kf04CdEhBU0sCpLMDCurm7jJgPYg4g7tHHdCBiI4JBxYbVpUfUFIHeP%2FsyaJBBK5DABEwuM0xGQMAwqLBrTHcLsIr4GfDhr4DN0YEsR7eI%2BROAuIKBsLrJyQEwYkOl2CIZNxmyqq7MxVSgCA4gj0i5StGgKLMIwUTqe5jgLB%2BUyjoA%2FdMuGeAaQSQaTUOz5pGib6zgCM4AuuxI3DF40KqUMck6vQzaiRtQUOVTo4xgRkIhluT07k9sHgoA%2FjZABdEw2BoNlGVN0f20IDt5DjcikUYgllVAUyrsmdRB0pIAhSY1SeoJHWQBiytgqHanJKDgrNDQSiAAkwVni7Y8WQ5nB3vTXRoiG6oAmklg1r4cRpXyh3Hn27gAiiISZY10wDaGLQkiHg4A7%2F%2FroUOm9cyUJZ7rDsxql3YqoJ4okkMp0Hla1VRKUCO6SOuaO20XARCwDI8xzJCmASCmAdafGODkKgbhwI3QHGCmARCIASv2ZxNSHRvMsodLyZDFx5DwNId%2F7OaYuI8iPQqWKZJS6ZIt0DGBpXq5pdaqOXIMbwGG7zgsgCU262anDTvkRwPwLeqXGu64zmUiwdycz6UIIYuOBn7xrqUmcaIk%2BUat2MJBfA8Rh%2Bgo6OeFJ60WzsDsABJg3UEqDKRU50N6IbQPRkeCrrWCQeTOxkd6LvbcQdE6ADB7jobwpiTaYEdLWuVcJijobBScRhbOBp4iidNmRgRepaAH4yB%2FyuC%2F2iIOwsHc8Cgfy%2Bagb%2BgNgKnbwq0JPC5iRGGJxCCJHBKYaiCExABkD%2BCTtucRfBqEbC6S3oCEwD5IMCZBsuDJNh4CvKEGQD5GciDj0oCBtuuZhaB3tHjAVtaiYBaorcI4bm2GzsIKQqVxCoafXL6fj%2BntVIrbwkMqQehrvKWiC91fnmGM%2FDqERABjitB4bGDmhcBFJAC0kImJ0iCMIedKqj4VUgCmzeESUOHPOj5k%2F9AdfiDmPdtXjCEmH86pYz5ZNknLlABkB%2FSZFd2Zkdd9CGyOIiDFTMHPBADO8iWZ5j8PkAa9bKDOMiD1tmuJ7CbLrCcPLCbI%2FiDZJr8Z0AHMf8arzgwBHSII98m1cQ1%2FbXPocmn%2FeQVJOdRiHLgheC%2FDp0ofjRpTCd8oq7iBXZosGrpBum3FNMxo1aKpzBqnVfTp63oBmagXlgjGdg%2FI6AP%2Bv2SoZOyWbUmDTOhmgTh%2BnAxGunXImm0COkvhmvwjaePpwoKIzQCCHQCBbpD1%2B2guoICE7pTJ%2FAWQ4foIg5MGO5guIYDN3LsWLGZAwAiR5IsafIkSgAJmkn06PKlx3gyWwokRyyeQ3UyFQqUGa9iw4QOg7pr6G7msxY5jniyZ69bCwQINikUqk5oxZ0wt26MYowm17Bcy90Sa1ZsMWdn1750B0YTT7ZyH5bbePWqx7v%2BHfWGVZcN2Eu8c2HGAwTo5%2BCO7oIYkIqgClh0wLIlnku2slx3msDETcw3MDpnatcKzlva5a26fT%2FPVQcyJezYJ1dGxszVmy3bLtV189B4gxs7M6RuEFZbt0uvx5F3vMwc7ejnW93Clc41tfWtf7MTNoxYtzs3M2bkyBMu8mTuL52rV7y5c3uBouN7xE7%2FY0jZ%2BmPTvr8Rt3ru9OGYAY1JhQd88Snnn0DsMZgWgwS9lWB79jG4XYSFHfZcSxp1lF6EDt6nGWcRhhYdgxbe51p%2B%2B7loUn8RAqieOps8cQKOJxyhhzcmorMggyLeB2GE1FGonor3Ycight%2F5B2KQZRX%2B%2BZ6J85mYZHwsvrglSTEyOGOA7hx0kDvEUGYikP4JSR%2BRDBp5pWoXApahdyZCqaaUblIZoZURYtmellxy6aV%2FYAKq153%2BpXnfmvG16d%2Bbfsbp35L%2BNWnnmVGaSOKR3PWZ4qT0BSroi4TeZ%2BiTmTK4KH2NtvfoiBPCaWKl910aYaKt5gnpngx%2B6t%2BfNL5GaqksmYjqfbnSx2p8rqoHK32RgkrrnEzWiauqjO46Yq%2F%2B%2FXpfsNyNSqx%2BptKHLH3KKvhViNsOiWKs1UlKrYm3Mqiues5mx2mV8IIbapbDkluusTLmhqmPzLanb3bQxictsADHVyt99qZqIsPS8cunv%2FT%2BhZvduCgVEUoIIhEQRih8aGAyyiqjZG586MaHr3oK5%2Bsumx23B%2FG%2F9NK5IbYY47xzt%2Fd967HEwraIkg3p4JOCSHXwg8s9rhAAAB9T48PK1TAW%2FOXBQaPJrqYmOryzrPNGSHF8Fiebra6bFk3f0fF9bF3IJalBDz3yQO3AOqwAoAY%2FPwAuuByFz%2FZ1oWHfC%2FeyZOPp49kBpj3t2tVaeu3jQstdIsc%2B3i1d3iSFIschTwPwwj6BAABEP2GksA8fABTBTxgnBdBMp9l5o%2FmTPY7du3QZS1e35aAQL93o0rHdntvpQr7w0AGCArqvOle4qcAnhcSH6j%2FwIwcANoxvPvn%2B4pP%2Fwhbttx8GLaLJPz%2F99dt%2F%2F%2F3FxII%2F%2F%2F3770ws0vK%2FARKQCb8gIAL9t78EMtB%2BtrBFAyMov2xkQRLZkKAEA4jBCOpvgw3MBh3ocEEPJlCDJERgB09IwGxIIgsjVOH%2FHghDAi5whv6jRQJkAz6oqQ8APeAHHNAHgB7%2BQA5GNCIfioGMYjCxiU58IhSjKEUoAiOAU7wiFrMYC2BksYtedKIRMvHFMWqRjGaU4i1uccY1NtEZFVwGG9loxTie0RZzpOMYnRFCZ%2BDRjLGwRR%2F9GMgxLqOFfBykF9OIyC%2FecZFTRAYOdai6F%2BjDdUXoxxZSUEnbYRIlvDsW8JIlvAj%2BeWV5z6meepDHHbcob1aZqxfngue5Il3PlMxRJXdQua%2FuoWSHAHCAOIbhgEDw4wUECOYw9%2FGCxS2HOzJrD824YzPuGO85lVvl5SLmM2sBrXPt%2BpwtkYPL7DSPOaUrSSD6ATUAhAEf69gHJEQSBn28M57MPJbjLja2Zlqnmsy55r6y2bNX%2FsxJb5ulnrDnLe0hKWni4uVJXjCFFv2gDlPo2hDncNGXMe5U%2BTzoPr9pNoYGVF6YkxMsu6nPsiU0nLoZp3XKiZxzDsxr%2FLTOM9UTzexMMzv%2BRA5ArcMzpG1zcyoFKUt5pVCjkZScDgUZRGt6T4P5aKfW6Wk%2Fddmwpmr%2FTKBEJSg3DSo9hCrVpbaBKfOeireoSrUkMGtPTrljVelgtXhatU5Qu2pSbYLVqGKd2fRuBs5%2BiU6tpGNrW0fyVvXENTtzfU5dn%2FNT3eT1OUO1m2GdF8q2xRKpk5vSUunG1bRGiKaJVUlHz%2FXRsYY0qf6pLHMuW6HMPud56okeYMnKrdDGB62npO1MEXvaxTpztblt7WcjBFvkyLahRbVVZ1nr2mjNrbej%2FW1phZtY4vrOuNAMbM0kpy3KXZe5XsXscysW3eNO92HVbY9vmSNT3Zh2u6mNmXd1Cl5pijduI93UeWebXs4eVbrJLSthXemf%2BraVuzjNr1z3y9P%2BNuuu%2FtJZLngC7Ny%2BQrfA7D3wbs2KmfgiZ762YbBUHSydxlrnscyJLHMmaxsM26a5uQQucmzLHdx%2BV7fU5S18y1tiHJ9Yuw2%2BL1wh7FgJX5XC1CMvgPc6UJQWFGEibWmC1bZgI6cYyYxVcouZTFcnC%2Fa%2FRdLwjQcMvfX2%2BMoIDp2CV8Tlmqr4OSyWjouRA2PkyBgzNMaMjZ2q5tuyWb8%2Bdi%2BQUylk3ZgYMyims5eLW1UxQ5bM1LSwNRcNaDQLmsPq9XCb20u0RHtK05hpdGUePbA6M%2BfOz8mzbvasmz5X5s%2BVCXRMiWwbHWeHx4Z2c4izfFI5L%2B20bo10dyedMEv7FNP%2F%2FjR1YnBNWk8T%2BK%2BhBvGPRVwZEjNa16me86qR%2FWBlI3e8ZnYTp3M96B0XOsKHHrW2E8Nt26DaM%2BAmF6uR42rmwNo2srYNrRNj62ine9pUDquVRR2g9yq6sNkttrEVK%2B4VgxnPlH4xs7MK5TNL%2BasH92vCsY3oeA9m3qf2tr0hHnHU3pTi5CZlxu26cXR3HL3UXjOof63wVTK81A5nkKrxPXE7V%2FzVF9dzzCXrbKBCezDSxu7NCZ1zdwM728Lm65ZVHvF862bfyOk3Zv6NmYAPZuBOLzjUP95ha%2Btc5PC%2B%2BpSJvXKb4vPlq0p6jJdO2abP5enyRXlieG0dX1N95%2Fvq%2Fnl2TF6Zeg8m6MTium28rhuwV0bslSH7XMzed7T%2Ffd29bveS371wUiee73NhfGvu%2Ffiht7ro%2FD56rPHOZ73P2PRs8fuQPT940IdZ9DwnvXUUnxjUy8XxpII8ZiRvG8onxvKJwbxcNJ8Zzuc%2B6uyeeuirPnK4e1zuc%2B8S6%2FXt%2Bq%2FD3t%2BynzXt%2FWz7teC%2B27qXDuGzb3ihIj74618L8dlifEEhvzLKxwzzDYbzDQb0sYX03R71uZ%2F1fR729Z72vR2caZn3fZ9I9F9i%2FF9lBOBcDKBlpF%2Bt3Z9ZtB%2B9Ad5gCB788Z7F%2Bd7hAd%2FxgKBZ5B9pqN7xhV%2FXjd%2FklV%2FYnR%2FA%2F3mgwLlgWIjgyb3fc8SfA86fxtRfC%2F5c1lGgxLUc0dmdoujg2PFg2fkgVwDh4pHgXJjgEKKg0akg%2FbHgcwjfYMDgWezfoNBg5Nng8uFg5Unh5VFh5lnhdCTgCAohcxBhCj7g6JHcXJDh6Wmh%2Fskg%2F6lh8rEhALph88Hh88lh9NEhTGDh8AkiW3BhHnrh64HhEYrhLUEiTJihWaDhlljgYGBgYmigXHCgXBTgWhwg%2B9lhEC7g7jXgHhqhZSHhGHriS4CiWIhisThh60HhfagiW7DiWbjiWUhiGVLiWlgicujhF%2FLh7%2FmhXACiXPBiXxgZAYQARhGANzZA12yj1rFc3f%2BFXBQCI%2FrNHKTAYhbi4TNiIvlp4i1yojjpImowYygaGR%2F4jUjYgDWIgziswxQAQArgAj2IgxJwFDrWoDBGzkJOoTrGCzWyBTaGhTPqBjRmojSu4ESuhTVSJD72onA5AB%2FoAz2s0xbwQyhAQij8AACEgjyEwTCsw8rQHVWZ4zAyIgE6ogHao2Kw4yS6I0bC4w3KY2zhYicq4QSeBExaw0mKxCGsQwg0gEiEwD3E0xT0Q0KaBAGwxF18JViGpViOJVl6AzGQJVqmpVqqAzF4w1q%2BJVyqg3LEJV2OZTnwQl3mZViKhl72pU6AASjghF%2FmJS%2BUw2DmZTac5WHSZZMsJl3%2FmoljxuVdRiZcxsP1CCZlqiVfZuZaFiZnqqVwqcEL%2BBIA4AI%2BpMM68AEBmE8dDBE%2FqAEAEIAGzOZshkAtUANu5qZu7iZv9qZv9uYvZMJvDidxFic1ZMIvGKdyLic1MIEuMCd0%2FiYzCGd0Vudu%2FkJyWqd2doMVOIJ2fmcmMMN3Wucv2MJ4Vmc33MEddMN5RqctZGd7Lud0xid0OoIVsCd9Kid25udyhid%2FGmctjONI%2BFIDsAIrTAEkYJIQic8cAMAUGCiEhoIVMAGFVqiFXiiGZqiGaqgRbKiHfiiIMkGHhiiJligT%2BICJpuiHjqiKtqiFGgGLumiLRoEP%2BEAUyKiM%2F8Yojqqoju4oidKojfoojwppi%2FYokXookN7okZIojC5piRqpk2poAUjSOo2EBshDKCwoP7CB9wSDj2QDIlaGLSjiYDCBMZgIOPBkKxaDiajDWzzkqYEDrYRp4xkGnIopmcpFmrbpZtypwLHplchphOij6jjAFtjAL8EDyeDDIThoPwykTX7JZn2YqPyITloGL%2FjIR55FPABmR55FYQqlbWRkPIZIpoIW2%2FmciYQq0BlZIOgD1GgAPIhDERDTFpSmQOKCPJRMpDZOQ66Ln3ZgREYLUC6jqGIGqRblRobhp5rFpp5FRW4Fg8nBOqxTEVgDPsiDaq7OMLgTpPaqR%2F1qe%2F8Q41oYo1kgYwgWayAea2UkaxsaJXMhZT0qpaho49I4QArUpMnka0qQ4lyY4mCgIluQ61mYK3REWbOKRbRqx6RKXarKn9v1IffZ3BIyITnepNjAXLCuopoeo09yhDKuqyyeIC1Goy0eJT2%2B1MdyxMIGBiGm4cbKBcDOhcCuBcGahcGGBbqKRcheY0iKxUWOKlG%2B67JuYsKGxbO%2B4M9yhS%2B6iL%2FKLJ0GbJ6m4qVy7LA%2BjLr6LLsmhrsmIryCh7yqLL0GjIDaV8yyxczKRc2exc2KRc5yxc7%2BYNaC5NYORtdm4NSWa8fybNie1cpuRMvuxsuOoiH6X9TSbN7abNUW497%2FHizHHe11LC1XBC2yDq3XFu08Qu5WJK3CSi5MNO1%2BPC3aHq7aJi7bLq7eXi3a1JyAjWwXlqxGnmy8pqzfji2gDO4vlmPG3t3ZFmzj6uzfSgjrbpjafdrDFmHETuPEtm7FMqHorkXassXamkXbhsXbbkXcXuHc4p%2FnwgTltqvl4u3X1ljfjljw0sXDWezFgo24hlfv4uzvwu359izduu4lwm6pyi7Y0q752q7SqO%2FznkX0rsX0ikX1jkX8Yu%2F8bi%2B0du9LfC%2FXhu8pmq7bJnBblO%2B2nS86BG5e4K7TFu4Fkq70UrABo67vqq7lDG%2Ba2e874q%2By6i%2F58m8G%2B%2B9Dle2R%2F72vWQzwWRRwWBzwVlwvTGRvHapwpxVvteFkhQ1WBA5bvdpwl%2BGwWOiwWfAwV%2FgwTADxSwhxJDKw0tbtXNztBI8voGGwvGkwB%2B%2BFB4cuCJeiCBMwCfewCcMvCmMTEasbCw%2BlCxMtDI%2BxDJcxDYNMMOSQxQZwDrfxDr9xFcdxBc9xSWnuJzqwS0Cw3Uqw1IrxrZFxyZkxJO9FMDgxpEFxWEixWFDxVljxelhwFi9wHRscpTTs9R1vLSYvRy4v8S7l9xFyFBvyFCNyKSuy9aKyS2hxW3Bx53qxXIBxJWMuyjryS3BuWJwxR4AuwYDybejyKPMyTJiyS2BxMKsyM9%2BjMf%2BzBTIjriVHGyb%2FoSan7yCv8b9ac1iQcjb7MgIzslAR8zNvckdI8hdTMjkr8%2Bx%2Bs0c4c%2BSqs%2FOyM9S2L39R8xUDs0cIs0vQL%2FeG81qMc%2BmWs9OdczWmc6t6crgpNEyI8jtj80tos0dwc0N7c5wpiSszICybrCwzKy2vcPNSIC6HsjtzBTyPtDz%2FMEN3hEN7BEQ3sERzKj9XtD%2FvL0B3hEBvBTTbRRpPs%2B56k8Ye9d4hbErThz4fc1GPsEX3HUazxVI%2Fcml1MgAb9Ogi9IR59Db3NEf89E%2Buctq1ckq1dOy%2BtNHGdBHb8tzVdDWjdZOpdUmz9Ua4Ncja80DfsdDm8eX%2F7vEl93Em%2F%2FFacbTQAbZHgDROi3Ry7PRC07NeJTXL4jNHZLU4b7Ubd3VmfLVHavRM37JZQ%2B9Nb0VOZzZlc4RJ%2BzRKS6BKzzUSPxloefZGhPUugjZ%2BlPVsc4RlwzZmewRJN4dgDwRhb0RQdzFiV65iiy9V87FvDwRwg%2FNGE3dUrxTvXrf6WTVuY%2FVKzyJd569dZy5e2%2FFq73VrC%2FBrw0RsK7dmnzJnW5ZhM7VwD4RoTzRpH7Jp3x5qn8V210d%2FT0QgezfGSnV4M%2FYHkjcTm7du7665YdkSY51erxxfb8Vx03dyd8Ry03ZzC8RzD0R0F%2FN0g291h7F4m7NjozNkH5Zk%2F69ecf%2FHfL9EfYv4fa91fsfWfov1ikdwiyczhF90jGf0jHPIgq%2FzjQ%2FEh%2Bt4iHPEiG9Ebbf1bU%2F4xJw3yab3C6%2F3Mrc3KzcxbGgAH7jCJbgkADSAHLjCIfAqm7s5r4Kravn1mD05Olz5YGe5hud2lVm4f2F49iy5OSEWAZhmKIgDPSBq1rCCPOACVRKTo%2BMCRoEfnqNDlLvEjlN5jwf2j5sXXHfekE9ykffzkXt1koO1am%2B4SKRAarqmHBzO4BQO4ITCrKv5sV16pnvEpndFpzP3p2dYqFefEeOcl%2BsxmP%2BzmMc1maeEA1yNEmDS7NTOD8TOtNsO7pxEV2a3QPxOVf%2BN0t1xu55r9wK3UnlveYU7%2BIVDSi0tu6hDipGlAEBqgBChj5aSjxJcgr7vuy3wwgP9O8AHvMAPPMEP%2FC38UcEnvMIvfCzcwsI%2FPMQDfBgBQ8RXvMIjvMVnvMDHAsZrvMcTQwURg8ePvB2R%2FMhzvMlrPDGEkMinvMU3vMtnfMfH%2FMITQwu1PM0%2FPMrnPMTPPM8TPDBUgiCnRAo4pUuKT2v%2BEBvcOwBowAs8%2FdPjwDF4A9VXvdVfPdZnvdZnvTPcwtZ%2FPdiHvTfcgjOIvdmfvTc4J9qv%2FdZnQyywPdxjPRPFPd17wzmAgSTUPd3HQjboPdw7gy34Pdufwx7swTkI%2Ftr%2BQxDio73bLz7aSwIYHL7ji%2F3cT77Y873lh%2F0uDP1JhIA1rIOaa5IlSfsmRfutcmV85zCXx%2FI5vrgfn5m5a3l7%2FDdRl7pRn%2Fppp3pqE3pwjSMBsAI%2FBEIPFEEJANMwaMCrGlMwacAh6MMy0Tl%2B2Xml4fm4mzifx52fIxygJ3Fvuzuxszq264M%2B8MM%2FuM4UZOs%2BNCoAbAH6qz%2F0J5n0Yxz1lzg6nLjwcvsGJzg60L5ZUDRXAwQ6gQMJFjR4EGHBcrcSNnT40J0mMO4eVrQ40Jmzixsf3irHEaRBdc0cADB58mQIJUVYKklh0oYaJQROxpyJEmWCZupC9hzozZZPocD%2Bsgn1GcUYT6McFy4NWUyj043uwGiiKPWiR6wXswHbajEeIEDxvlYkWvZhU7QNI05c2zDj24Za5YokiRNvXr17TepUWrcgUMAHzw4uiPSvYbWGB0JlPJCq1ccC6T7uOhld2LGYCz9ezLjt1cdxMVc2PLIkX9WrT%2FrFLJhzUcyIJ39m7HhyZNGMTRu%2BPFkz2cmdGdseHBoz6cm9AaNm%2FZyv68mwh8ueTNszQ8y4H%2Bsu%2FXHy78fBY2M2Dhj5ZOWPmdd1Dh0%2BTumPqT8mzhh7ce2TuYOuutuw9uoSjzHyqjNvP9AkAnCw9XgDj7H34ptwPsbqY%2Bw%2Bw%2FJTLMHbouruv%2B%2F%2FMCPQMAPts04%2FzNIb7UP2IDztrgkp3Om1oMqbLanaOjSsP8O8W%2B5F37wCTizhTkRQxQWTa%2FHBySSUEboKDbvQsAwH23Cw8wDr8bgQgRxxyPGKvDG7JN1Sj8kAg2wuRiijpHE6Gw%2FEMbGN1HEHT3fqbEhLoe7UU6A%2F%2F%2BISJEEt%2BtFFMDEzca0%2F8eTJyrrOM7SsFRlzUE0n23STNSkHo3KwSOvC8tBuPNkEVWEATWtHo9TBBtVS0FHnGVRrUYpQO4NJdc%2BDEH1LnWCFFVAuEgdj9Ks7a0XVE2ncIQZFDkVaNhW0LG1UWJ4w7SnbiohtdFNOVfP0InfiOTeebh2CTZ1z%2F3stS1S5SHUoWEJUQABfBDaoQph3CeqzJ3c2wfeEcOKJwwAEkrgq13KPwDcPI9nyslF3nikF41KE4WVNwIwFDFms1AnHDRHyRUCELmzxBsmC3PkD3xz89elatLpJBeNu0Nk2JFlynpmyjuV6Utzo4ASpG0P%2BWPqPVGqpJZhgGxJMnVSWpgRop%2BKll0GL5m1InS5OPlmEVLr%2Bt1WhBCbYYDcMMGBhgRq2SJ0gIJY4oV%2BT7aYMk%2FPdAIljsv7q47pCdkqdboYYO18UBNfRIHcIwVeHwTmq%2Bat48sg3Dnd45iicFvCd5GyCvkWL6KL1IvehqhlXAAELqujGX8HicduAI%2F5Kx2rrvEnuHKSvEXLHjXxTtiOHfGcI5y9BlVpI2EBXnfVRke6UWqC1ESg4HkNMMKELhp3JE%2FtApb5%2BoGD1rPvuivT%2B6mHGEVDhGculKlyuw5dSJ4l8W3DjDKLDVxUS4zyCRI965Ttg9Q5SDl5MDx2So5z9yqWkoenAf%2Bb43EZCN7rdBU1TqVGd0SiYvlTID18GEALzEGI73OkOML07iDo2MQMDXAFvFRGeSISxAXwF4RnuEhsCDEC6WalDGJNYRC3qp46FYEMYwpiVLyZxqzthYxKbwMZu3BGOVSyxG1fRXsES5wtfPGMg1%2FhFLRaxiWeEQzTPEEb9qCjFCIYjFf6TCGL8IuY%2Bin3FHYvI1w7skAe74St8C1zfAc8HqOihL32P%2Bstl1KfAtehPbQNDpMHi0Y1DIsAXPOEJGycRjC0OBIpSpNUkSkE7Rj6DEpMQBhxdho1KLEKKYpwcAipXKQuuxR2pgF2%2BJnGNqCAwfeVTHwQ7iAAjRhKCHkEgJFEXrhHihXX0OiG%2BoOAGN3TBbwgwxFXudC48CcYdhghCENwgSkeaq3nxgCD6KOUyYpADgtR75%2FTscYWEdcEeJdxhQeJhB3xZIBjk7MYM2CmLO9ViBxbAlwQ68IVulIMYVbCABf5wBAkgQAJOeIYdTIAvEYwze4uYwUcl0AJCUGSMBv6zw0ahQBF1xAEEH41dCxahp260wAItiINELUCJeCyiBR%2Fd1wzaB5E%2FbuV2MUMXOoLwNhVABh3CQNUbRdONZ9QPG55Ao1fHuolaZA8dy%2BKqQLJBDHdI41SrCGMJOYJJmkEBXy1gYQRX0QIkxKF%2B7pjESicqgj5krwsb%2FYMTJDo%2FrGVPGFDwwEFzMAml8MQOJ4CdBXLQ0wjuspeA%2FCVa4sGFsT3BmOggq84IIo2vmuOOWhVrBAXSzGfeSRpbxd4twvHVMIZDFp6YazVFeM28ZBNs20SAJ%2BwRj3nUwocIqAJMTZWHOExCFt4gxqyekYpU5GJkODMbNgyRh2pRpBR2wP%2FlVbqBsVvVghB%2FsGIkn9GIOBhCFrMK1MVKUb9aLG2%2BteifwpxGwYESxB1OmOABaZcuJJ6AcQbogjqIMWAinuxeCZvoKu5kCPnZAU%2Ba5J7bFIYnDzNOAqVwRzfCSUQPdIMSKERAH50qGdIaFGWbyMw8StGEL9ghUJPIQXQ30AJDiDIJHRBBHCC8gU2UoQMeyANTJWCHeVBiyPgq8h944o1KPGGyIDVBGVx5yTGVRYBdwJs57hksTzR2bC%2BNRxUOqmEt90sdtSgp44CnjiugmHQS5CVdITLaZD3DZAqowmYrcQ139MECG9ABZAzRgQ3MgHaEACq%2BPFBZntgWpqtIgt%2F%2BNjAEs6GDF5TYQAe6UMOPioDMhKaXNY3bmqPZSbmbuEo8MIiAmgbyXvlagBAq0a7iKSwe2PChCv6wZ1%2Bn4pMbWESwagG7HMRBpxJIQv1mZQ47hBkBC5hBJ8iiOXyVwQnZLsPIIHyyuF3kwJCJXxnw9hd3IMwAPJ3EE35IYQUjct%2FG%2B0MedPqHeTwjulWYxBAlIIx4iLht%2BEoCWWzo60kYot1x6GS7ERCEIVzBHUxFmSEWsYN80dgh75NKIE82AzdsIhzEaAdMO6HTsZGOfWOrxZ8RMExnpsLmJ9M1M1CQL5sfAbZm3sxWEhdszxbkLO5IQsKOsIhF9Brkc84XFBb%2Bni9DkKXXHjgDIUQugVQ8PF9emAReEbC8eIBW1mwx9FYELQJhtFsMjvaFTnU9q0MC9MRjk4AnuihAnKeixRMdZ6o5rQA7G6AMHwxJ6mrdl1tfxHX4Yq5zZeG3KjwXzvkyQE2jimxsTJYBKB7bBp7hjlqkPuhETIKwoGDnfFmgE%2BbaHEgZZ9kW507yBIn3rLrRbjfkMH3CWIQdVtHcSZgUG8T4t%2B7soUkELKK58auCPfrww3nYwx4D%2FkP12Vb6uKVCD2JQhz2kji%2BNFx9fuhtZLXSK%2FXkII8won5iN18J2DDdhFWzqCBJmBgzBXgZITz5JB3RAd%2BiMYJIA0waQlwz%2BUIA%2BT5NaQGP6APYcSumQz0%2Foz4MMojBqwRDiABuaa%2FdkRus6rl3UQeQIwR5KYaIoYR7iIRxEDgrswQGhYBmaK3kQoBPsAe586UxQ5wcBigzwBQQ0gn8GKF1AUAIcquKGQGnajd5sq5OCzQPKwA60UBiIIcYOKg80La%2FCoSwor%2FKQKyEyDwGOoAu4oAqi6%2FrsAccwsBaGaMQkLtnCTASqaHHwZQdkwRB0ahKeS6c2wBBWwf9KYR4ECV%2BEwBMmod30ytwGSBYWIbrIwB0Q4Qd14A8sayOGz%2B%2FwBeRcZlXcYR58gRCqgLD05RikD1%2BOTx2C4aMsoF%2FiIQmlyx5Mq%2B3%2FuuAKuuAHn4D8tifiSiwznKES7AAKVGCY3q%2FdPOuoCMaV3OGQ9C9vnorpuiGxGMcCjEgW%2FqALngH8cvEJEhBflidxVvAEgggb0OG%2FukAY7GEeyiD%2B5uH5UKYPoiaL7KgDD81vXsqeZIPz8mAZh0kFHZAMyEIdeg0Gj01mBCIeYGZ%2BwqHXdKAJuKALBCgPhHDBRKsIkwUEEaAUYnAB8KUR8OQeReAZ5uEM%2Bg0dSiEPuiAc5NEBr9Dw7OHEBq8GhcFvygAM8wX77MERPQAb4g4h0LDW1PAolSvCnGBWwoGNcmEewkEi89D0wswNwE8ibZEsgq0QQ3IR5kFPRK4Mwu%2BH%2F%2B4pHlahsSbBHnavBSJoHthOzexhiAAq%2BIQvR8Di3x6SIMawibABCj4qYQ7xFf9NFkHQFttliLZviIjobRImd4bRKhcmmETnbXgPAZxR82DKEWfgsqrRA10GG0UGFYPhD5bxZPQqguJBGAyBFXWqpnLODhRyBXFIv1CRBKsgqepxFVJvolqg1fSrH9GMFI0kcdxAD5iB2h7mMhvrIBFJIX8QBhdTOARLy2oh0RxTwySMIweNCO8SJOKBHrdHGKRBGIJt9kZGgI4MBvAFGl3vD66gFW1ydHQw%2FnZtiITgJxHAA5pom0SgzESG1tLw8uiGKfNFAWCNhdzMDbKs%2FI5t4v9OD190rRJPgHZsyxBjh9vEE1%2BcIB5ecBmKghpjsS1%2FiCLiYYhUkOfULHjysiIK6qASKnt8IfUsABHoMmE2oNU2AXY2oDBj8Qlr8RYXcxfP0Q3KoAy8yQ0WAe2I0fzi4Rn2bAbyYBWOTTMRoO9Ybnum8Q%2BtcXhG0ynCARtKwRMMZsU2QQjyxaiewaMuzDdj85D%2BQDhWkN4CpRbiJ2F8U3e8QQxir%2BMCNHPOjOnYTq%2BUIh7u0QQCsKrmxw2sJmbaxQFZVB2k0x4c0lC7b3ueIdh2QAyQVEkLcQg9EjztBP5AagNONdtu5WA6tBOkkdpygAEuU6fo05nsge2ODyKP7QT%2FGA8BVFMdZBBlABVxBjQpC7Qi2NANlGgRUsFZRMmTHBNlHlQPJRQBUqFddi8IggVDEXNDjw0KXBBfFCFEM8MwS5QFI%2BjEPDMeVjQ0E0IU80ynciCIbDB%2Blgsd2o0t7SEMfRQWEeAwhVQxB8gexvMIwA8n%2F0CsYsr85kGTiBL8%2Fm02S7Xv1GEVdIoGk63dvNRXwNRVnkGAmHRWoLSx%2FsAd0rRXyWAThghO8aUP5hQhhcMcek0FumASCNYdxmEZhAF55HDGRnUj7CpgHNHXOMljtQwbEDMe7SEOHnUFJZVSNckCGNEGfzAH%2F80LenAelqYUDCZU6W7unEJLZYzekMiH%2F0QgfhIycdqz7dzAE46NVtmS7aYLIsczCPZTBczwV01KWPeHWI1LKWdIuTxBLBcpe6qAAOXrHidzD%2FHFWisxW9VzdDK04XgCFzv0Q%2FGFEMYVHUTODsw1W9H1HNuFXVuUgojHf66gDEQOAZ4gcfyGDG5GgIiyX%2F81doZ0gDLUX4NhESTgbcYP4hYWaicBG%2F6gsY5PYkXjB09gWT9JYyOHY42imTBNnq6MEJ%2BBpWoB%2FMZzZRGgZSHyZWeFFmPHF%2BwhH5a2Dd2BEvQAZQ%2BOEkTu3coCaLnFwmagC7qA4%2BJgHlYhX%2F6gGyYhup4TAZwWcztJgFQgDwyhXtnyxCxAD3Q2X%2F9SYR66FiswZ39MtshUAINbILosFFJPJgqDBVhZD%2FzY7m3tQSJV8lwWCpHsFm%2BBFUCNcob69pr%2BViRyrWvA9fryQSil9SoZ91r7DXKdCXfdoAZLNSvZbgZsgRzs4R6Xy3N5Ip1Cd10RKaA4QhQDpTFPxgBmILAMt%2FGMbhcqjIjGttpAakjfpgrkaTx7Ll9yAI5%2Bl8QidM8UgGeDYMX8JveyZxNiT6eaVzT5L3OOrVfjYBG4YIO7QRhGNhw2Yc%2B2t3sz43vhlWXDoRPQcxcTRgVKAYoOCVdJS1Cz8ZPGBgm8gSd%2BMFr9x2AiNToxF08owU8zU2oWFTMRwAnaRSL50mv%2FP1IqJBkBuCwcflkdhLan3METTuZz8xakJqEbFiHMEhILg8E5Se6QJGAVWHhWXHhvXUWGR4iGC4IN%2B04kRC4IBDHY7vZJqbVxsVVbDQ93JeAKDMHkQKoWHq4kEYAFvECjfigz1Bl02y5gt6cL2ikUXZRu1KELT0Z2uC1xLMwCuuAIPKADDCGjOqADQGwWRcADTqBfiIeiE0kd3ADcJGAImsgTPMAD3M4OKHq6BMvZZuAPTuCk32gGTLoU7G0RnK2bIJpk%2FQiQmY4iZYwQ4sEcRE4BOK5XI%2BiQHnkFE7K2VNeodcAddgEE8sUDdMoCOGw4z1AbwQ1l1sAWigKJVFcE%2F9xgpstmHsiAos9AACHaswQmB2zOpcgpsuCsoWknnaLsCGDYV77WKFa1dpunG4LtcTfX62yqVCXgqUfGK%2FEEUxmnD9yBV%2B%2F2mjktm%2F1km1Wnmw%2FIhn2lDGzvZGShUt%2FmCJItutL5bR43HCCsiHD3wvIFxCIIx8ZGBVQ1D04big3hbTwzkLYThuCNoMvFVFBlE1SledDhVIa7i74KG26hG1yLtdABG6ShHQVitSBjWcwKe8JBGqSBtXqLu7OHFhoBVcKoud8IurfbDBGMWkbmGaQhvWvMZ%2B3kGaqAqxEABVBKHTxBgPgzDlTAAjzg7I5AscQosSzADcgpFZxtrIFKBP%2BCgRwq4QbGZgaeyZOXDnUsRrjd6FlkI3GEu%2FXK2wyb%2B7upG72xahWEO4wWaBfEG7uVQrtHXFTLIhxyYKNKkSBuZ6NEQFUhLajKjKXz5QQyywLoZ3M3KksNYb97FaVSbaOWZ1ZSYaNUoLJ9Ain91lhbpxZmQMutdYbCoQyqWgJUwBC4YAZYICz%2FQMsjz5O0%2FFY2UcsnTB3MAQJnwBPiAQQ3wA6SSgJMYKcDZROGwAIkQAJE4Aq4LZDeHIoHawa%2BNXGgINAlIJF8W9YcJZ%2Byp3qEBXoUCJmOqIDIx5uVqXyQwdEcCXs2HZouy35UjjSfYRJafRI8wRbYIX36t9VV5av%2FnkFnbv25Vcu31NvVW%2B%2BrZqmtzKEUXH1r4%2FtnP%2FnCPb0zHEWUSl3TLUmfKh0dHIiBkkmv91qXpULXD6IYaEGOuvvWXYbVW91Zgj3Xv%2Bq9uygSs4iW0IG3xr225D1ZLrtoMrtQLCYYgmGuvCFMPrAW3XvfTwnB3KESaCEYWo%2BCgkUYgmGWrPi3AQNg3mJugOl5dzlP8IRjFInUUb1O1AWaOh4dKMnTDUfZQyVasiRt5IKCXcXUBcIZHK2ApN3ZOd18Pj7j%2F0Kaoj3b7aK4Ks%2FWeh5sEMjfEQdpQb4giMEbqP1Ypf0hrtgpJn4tKt5aLh4tTgct8Oct4hdeUl7iV%2F4t%2Flr%2BLTboLbC%2B3n8e6AEA350CVAqljCfXIWSoLKB%2BKaQeLai%2BUqy%2BLMyecP69RE4%2BhrxeUsAemPhaLsh%2BLfheQNEe6Nd%2BKdqeI%2FLMAyxgBLitIeT%2BK%2BjeKOy%2BLPAekPT%2BKxQfK7Q%2BqzFE8OWC83MZ2Y0C8a9eaIDF3sXF8Y0C8jnCHOj98k9fXiJ%2B8DEDHTyf7kB%2FK0T%2Ffvz%2BWAC%2FLjAfK1J%2Fgg1%2F7NNkMIifbxmfQIX%2BImo%2F8p1eBHX%2FLTRfKJgfK4B%2FgoUfK6R%2FKUi%2Fwtt1LZRfKsAfbJ1%2FLVp%2F718fXKi%2FWK3fIrB%2F%2Fbl%2FLbzfJwCi3C10BAsaPIgwocKExZwt%2FnwIMaI7MJrcRbyIseCtchk7QswGzKPIhPEAAYo3MmVBYNlUqhToMqU7TWAsxhTpzOFNkRt3dlTXzAGAoUSLGj2KNCmABM3U%2BezozdbTjiynZoxizKlViDC3RmzoFeLEimEf9iyrECRahSVPrk1Y9e3BrnILzqxZ12DOvAbP5gUqVCmACC9KFNWAWAOBoQ5eaFDKVCvfqHxXtqyMDqvkunT5gq081iZfv3nVVm6LsnJcvp3r3hWddy9m0nIBC56SDt%2B9Q4ttrJMnD98UADas4YO3JWlkzJQxr%2BaruXLrup%2F5hp7NsbJpvqidX2Y9EDRN2HVlV6b91nbSEPesFTnU%2F294GH2H%2BASyQQDXOiWs5IVAulxlzan2HXRZSRdeZdXldd152fG1XV7dEYjZdG%2B9hpl5oz1Yl3pIhRBIEQC8wM8cAByyTgqPAVACPocAMEV8SBHQFHMheYdZZgeCl6OGroEBCnlyofdWhHVNyNdznCXI4HgZ6uRgZR4Kxgc%2FIuKiDzz4QEKADfzUAcAP%2FLABgAYpnHnmC8eU402bbr4JZ5xyzhmnMxvRiWeeeQrkjJ5%2B%2FvkmE7qwCWiheMZiaKJyllNMMYQqCuk5FD0KqaKxZFNppc7YQmmmgJ6zByDneJpoObb0Saqh2fCSqqHl0DRqq38y6qisgCJqq5%2Fl7JKAYP9DhcHPJQQQcAkkQPDRzxheyhFmiTCGAm20tvBiS7XWXottttpum20ssXALbrji2uLtuOaea4sRmVCLbrva3vKtu%2FJiW%2B689hKThSTs2itvLLfwO2%2B9ALdLDB10EDOwuwInbC68DKPLiyRZIPywuQtXHK6%2FGIvLSyW9CgZsKIER5QA8oXgJpphqzFijgDdSiFl0PD6J2URBYoeZkXIhmZeSclm4FoaV%2BVgXkWhNedQU%2B4SyWJlyiKiBPJewBwkAW%2FSjBIAtTyYVjjHvmBfQay34I1lRaveyhCallmSBS9bs5NBQbihlUEqFsM4%2BrlwSyhQOpIMcJPxkHYo8agyzzor%2BRgXIdY4%2ByyVz2EzmRbZcDdKNNmY81%2FX4WmKXJTRfRA%2FJYW12J6WEONasns7KNuAijzhjDJVCf%2B4pt3VeA7adY%2BRvY1b5hRQJ%2BZbRaOn81uZydY7W52GFHtvceRkfFtJFDYt900NpMPL22h%2FFuO5dw1yZ7z9PTp30lg%2BPc%2Banre31zNbFLbr6pNfdva%2F6CxZ%2BXbv37La6mO8tzgtL8ILGvrNBKG1Hgh%2F5JAc3vMgtR9TzivX2h8Gi9E8u%2F%2BNcACEHtt8pyH4INBvmFqg5B%2FIOQREk3lpGV7zSped0GayhBnPnv%2FGtsHwhPF%2BODoiWy01PhkVi4M5UCMAKoe9C9Iv%2FHgWJeDQa2tCGG3xLB5f3wbcM0HNLfAsQQZfAE5bGiMlDogeV2EKate8vUpxiBqu4liu%2BhXlo2WLzujg2EgYxjEPMGRnXorw5ZvGOaZzgGjvURjfuD45okeNa6FgWO5algF754vP4WDQoHu%2BPaAnkIwc5STyCronl0SNaKriVCyqSfzjkoA6T%2BLXN%2BBB4prykCfvoPu6YEYtoFI8E6%2FdE%2FK2yhowsiyPRAsmwSDIslNyKJb0ixEz6MYVueaAIm%2FRLJx7SdPkbJitl6UrHgTKSPSSgKMvyzK1E8365VFs1dwhBX7oQLTBcCyqtokpvgq%2BVVnzlGWPJQlrWDJPsROH7%2Ft4JS%2Flhc55lqecpNVm9ROpTa%2BDspzh7V04u%2FrCW0CRoDKd5ULYlNJ7zy2Ypg8mXfE6UKMUMyzHLkkyvLNMrzbRKOq2yzo%2B2s4EI%2FadCXUNKuTi0LPecikpXuhR%2BxtGfvAToT9M30FtKc6dH7GlTn8pEkwqVo14p6lOOutKWeuWlYYnpVma6lZpO5aZTyak9IRoW5AFyl4LsZUkZGpahhsWrPgHrRMW6FbJ6xaxWQatV1PoUtj7FrQ8FqS6tWteA3lWNCkRkN5F6w4ou9aJOJalnuIpTj77Vse4UqU89C1StvkWvXYVrKiWK2aEA1iqC3Qphp2LYqSDWJ4r1CWOJ%2Furarci1k3T9pF0XSlkxcjO2uNNsI5kaWR46l5nnNCBo2yraxlK1jJA1rmSRa8jKLpe5%2B5yuS6HrXel%2Bl3LXXWx2gUtanpr2qqi1XFBX296n8HUnftXnbKdSW6vc9im5fcpud9Lbnfx2r8G1ynDL4klkjpOm1VXnfV%2BYX5%2Fs9yb99eZ%2FnxLgqQzYJwX2yYFvkuCbLLi18a3qfKNb36zi1Sus3cqGY9LhYX7YJyF%2Byoh3UuKdnDgmKY7Jim3c4Kk8OCwRhumE01phnF6YnhneyY1dkuNV7ngnPfbJj28S5JsM2SVFdsmRrXJllyzZK00u65MPG%2BW2TrmhVb5JmlOS%2F2VFbvkmXd7Jl2MS5piMWSVlVsmZp3LnlKx5K20e7Jt1G%2BfFzjmvdY5JokWSZzfuOSZ9vsmfXRJolww6JYWWyXsZ3GLuvji9MQ7apGlcaZdc2iOZnuKmXdLpmHxaJaF%2BSaQTG2tTS7WgY6TmqiV83NTOeCs1RnOS%2Bwrb2N5aJbl2ya5T0uuUjHokpR7JofX7bJ8s2iqNtu2jDfxrBb%2Ba2cFOyax%2FEm3MTjsl1VbJtUeS7ZFsWyTdFsm3NRzunYx7KuUW8LlNnG4Vr9sqzUZ0wHEcb6TOeyT1Tsm9RZJvkezbI%2F32yL%2Bt%2FPCYDPwpBRfxwYWccCMvfCoNB7cwybs4pf4%2Bl7PqxaoX2%2B3vU7N4u3PtLrLXa1%2FVYhilbLwscycukoqP5OIeybhHNt6Rjnfk43YOuZo5CeHi%2FtzmQVz5U1oO8JfDnKUyNyZ6t24g80J5o1FdtrNT3fNjOznZQXc7y3HOE6vjOeJhLft5aZ52oMtF6hmhuqX1rmisM1nrcxe8q4VOZaJbduyZZc7ZG1%2FzVuex7duUy8h9UnIfn1zMKTez130CdpCLnfJI94jSRcL0jji9I1DPCOExYnhZI34kn99J6L08ekGX3tCn30nqq776o4TgEMO4RAoYw4fmPx8ADgiE9JtrecDnZfYZqT1Gbn%2BR3Kvk3R3p%2FU1%2B7%2Bfgi%2F56%2BDIp%2Fk2Of%2FjkXw8X94DEOqzxmEDs4xLrGIZQDrF%2F8OB%2FFJV98RN4XIcW4CcROodkcEdcPod5mjdKkEdnkjdeSIEBkDAcctAPL%2BAA6xAKABAG%2FfADJROCI0gEBCggl%2BdmGKV2cMZ2oMGAb8dzDyh3Leh4XUeBlGaBM2R0RfEDw4ALjbEPfNAsYeACRQgARcAPs3MUNOIO6iCFU0iFVWiFV4iFVegO3kAMUZiFXwiGX%2BgOxOANXhiGZ4iG6hAF1GCGaeiGWMgLbyiHV%2BgOOdGGcyiH8QAk8YCHfagOvFAOfjiHW9iFgpiHa2OIbziGZZiIblgOcdiIaRgPoAAGfP4YiWdYh85wh5eYhZDIiWDoDhGnAeLADysjJsyyLMvSLMwyBdECLZdgBVQgi7NIi7Voi7eIi7i4BLnIi73oi1Swi78ojMNIBT7ABMSIjLwYjMnIjLS4BMvYjMxoBT5gBNFojdVojc34jNnYjD7gA7HIjcgIjeE4jONIjr5oBN94juVojuuYi%2B3ojrdoBQWgPyEgB%2FugBCjTLGqgiqdYJmiSJqigCwNJkAVpkAeJkAmJkK%2BQCQrpkA8JkbqQCa8QkRVpkbrABKBwkRvpkA3JkR9pkJngkSAJksZABZjwDSmpkivJki3pki%2FpktAAkzNJkzVpkzeJkyt5B21gDCRJkv8T6ZMgyZBB%2BZHGkAhW0JNEuZEiqZQcOZJNWZGo8IMO8AOPEQL4EAhXGQhL2A9bUAL6sJVK0JUss4mfqIVcWJZmOYWLmJZqKYVr2JZu6YluaYWZGJdmqYfJ8A97yZd96Zd%2FCZiBKZiDSZiFaZiHiZiFGQknQZd0SIZ3%2BYmP2JhXOImVOJlaaIeXWYVzqZnuoA0%2FmAL6MDVy4A9hQACrUwKHgA8vcJrWEAKQgA8uoIKNY4Dbl1GEJFAyqJeJyZu96Zu%2FCZy%2FuZg36Gh0J2PJhUtFJxh1gA%2F0sDRCoQT0gA9gORRTIJ3UOZvio30CdJuhFIPWAQa7GZzjSZ7laZ6DOZz%2FtTlLkxVeyuWDvmIDW1AE2vMCW%2FADRVGf94l9K7idIPSCkPadDBKe50mgBWqgvZme1rSe4AVMnbcWtUZFfjdWLFicnXVN7DVQ4nmgG8qhHJqg8HShdYecU6WclCdbEhpYFGpuLpiDCYh3UzegHSqjM2qeHzpSIXqc7Zmck2eiSfWfAKaiBseiCIhOL1p4MUqjSaqkiWmjp4Wjj2d3X2ekGUF%2BGAGhxISitBWkJjekElikGbqkYSqmgtmk9PWkOhilqDelGFGlF3Glb5SlQNqfWtSd1BWgP6KhY6qnYVqmMHamE5imxremF9GmEfGmGNR6ULGlotelf%2Fqlurmnkcqn%2FxCIg0QKTe4XE%2FCne%2FJHXomaEa%2FnEbF3FXVKYXe6Pnkqqam6oX3Kao56qTsIaz34oHz3V3EKYosKfI26oBgKqarqq6tKqRVqqRYGq%2Bwmq1H0g%2FJmqzyGq%2Bmnq%2BZkqsKDqr9KrePJqmjnqsQaqO83qBFRqBBxqIu0rFzWrJ6mfqBGqmuXm%2BA5rdXqrggarCvaos%2BDqS6hqeO3e7RGq%2F41rnxWrrp2rryWrjC4rgLaru%2BKsIZ5rRGYrVJWrAzXrRDxrQ8RrvrjqRgBqlQRsNg2sABasHiasCHLmwtbqV76qtuaqRFrFvkKb8kqcf3Kaf9qbRuLbx2LbtGKQAcrsjvbl%2F8kK6wmq60jSmwXyHowi2sya280i3E2i3A4u0c6y7M867PyOqwOi7L2qrILMbELoQ7B8DEmerEXkbEZIaoYwX0Y4X0XoYBigaRR67Y9G69COq8nK7Q69RfB4LJ996O3OqdrcbYXkbZfkbUJMRFQ%2B7YJO7VyW7Vy9rB3d6xlUbG%2BErYRMbYYUbYX8bcREbgQsbYPUbiHC7r%2FkLhcOrdBq6MkyqNga7TUhrQWp7RNx7Qo57RgZLihW62jy6ila7V1O1opta8etrr01rpL97qyF7ukN7uXVLu2%2B6u4m6u6y7hXqxL36m4smxGR%2B00FqKD%2BCb1rNbgI8bnMG7XO66zd61v%2F9Tq934sQW6sQ2AsZwUtxwwt7xTuqeyu7H3uq4ju%2BcUu6iytpjSuljxtReVur9kuufVtHxyt8ydtRy6u%2Fkkq%2B5mqcUMq72lWiqmvA%2ForA5JTB68fA6tS2D4ywEQywE4ymFQxfKYW3Peqj2gui3NnBvvbBoeXAIqynJDyzJgyoKIxqvkvA%2FBrDrLvByqTAHoy%2F0mrDIYvDSavD9ArAairAFvS7Oga%2FSSe%2FoUq%2FZlvEMnzEOZvEiMu%2Fueu%2F5%2FvEghrFr%2FXDwBvEwjvEMrXF2sZ%2BpKa%2BBhG%2BX%2ByuS%2By6TUy3pzu079mjkwsRlXsRlxsRmcsVccxtc2wXIWzHvorHxKvH%2F6bboOLlxxjswjcKw%2BbLW4pMEHXcyM0bxs87xupWxtx6xvg0xVpWxa53xRr7rBrVxU%2F7ybcbyuU7ygpXyil7ykbltSwMyA8hyBFByBBhyA%2BxuQ%2FRuQvhybOcqo88v5G8u3xst6lbtGscv218Vm%2Bsb4jMb5yMDsvMzJHqzFgMzdHLwzt3wdV8yU6aybeMYt4MzuF8w7UswZqMy9KbEtQ7EuybEF37terMn%2BrJve5MZPDMyPI8puPsyvascrmMtbv8Vb0sGEUgB1PQNA6gBBk9Bf8RJhX9PZUX0NtLp9b8dNzMcQZdwwgNrMRJtUAbzZPsnrOarIHAD%2BsgmovBhPzAD%2F%2F%2FkBxboA95UzXZmUPYXFjarHEmHXUordIQTM8lzNCm59DpC9HQ9oMaYA2H4ACHwA8vAABycA9KEAM9wD3iMAwaoH9cXV7rbKbt7NI2pdRLvacKTbZZrLlIjXvom8%2FejA78jBAq5QAE4ACXAA%2F%2FwX9bsAWP8QLUWQRjiRTNgM8Up3hl5Q0Y9dgl3SNvDdcJ3dTWNtlPbWiUWNkeoc88UTMR5wDWwA9hAACnqQ%2FigA%2FiUAL9yA%2BoGAa1XdtqQAvIkBO7zdu97du%2FDdy%2FXQyxENzFbdzH7QyxAAzIzdzN7QxL8ArOLd3BPdwNMd3Xzdu3cAvYzd05kQUpndnnGQl00N3%2F3K3c5X3dw43e1y0x6z3d2u3ezl3d8d3ctPDPSOEAWxAK4sCaW%2BA3SrAP9zHbq0gctn3buU3fzK3eCY7c583gxw3dD27cCy7hwQ3fFR7c3x3eCU3eGA7cDu7hvU3hIc7b7U3ivX3hJ54T863iOWHfghEYKcAPW0kUDbAOrJDYRrjYqt3YoQ0VkT1Ync1DPo62do0Row2j4L3h5CnXlivkbb1YoH3ONlbaP%2FgC4gAHS8gPfKABw2CEL%2BAiH8gKAKAG%2FKCfMUfSrEzUuGXUlh3LtLvkk8rSigvlZEzkR67XfH0Q%2BeQArqAP%2FZEOKUAAocAPrCAO8MDVNI0L9OAKH32i%2F2muqGtOYG1Oe0autpgd5zTa5INM14dcSDC9o0R7FBEgB6FwCNPnAKV%2BCGhNAGkQCoGgOGiu1n7K1g3r1mCa6Um66cLc6cZs6WKB1yOB5B2h5wbhvvtJmyLtt5Tefb%2FOuZie6x266xAxzAtxzAoBPSfloMjqy6sc6QI90p5NaNAe7SsN7rjJnqCOuqIOc7%2B8EMFM7b3%2BEMVs7c6OzORe7gY67Q9R7Qpx7YQb7DiR59ZrpamsZ97%2Bqa0816%2BM7p%2BF6%2FnuoZvNxOLubQEv2gPPqUeH8Bir8JYr7wthyFZoEJIphSpBhQQxhff%2B8BB%2FoHJdhQsRUyePDim%2FzZ%2BuTZQs0%2F%2FdDukJL%2Bkkxux20Q21IPS18AxRSBCmIvTCoBLCIPTdoA7hMPThsBBkow7kUfXYpeQsf5jjbBFDXwvdYPQIkUzqgA1C%2FwxOEQxCL%2FVHbfN7LvNub8DDTrElv9cE76YGr2njWvXuwPcGDO8PQQzkcOeY%2B%2FNO0QctIAGJLwEeUAVnP%2FOVwAALcATbqg45sAALYAjx8AwbwAASUAuaVR3qEA%2B14AZOP%2FOj%2FwdYr%2FXmjmPqQAgzoPgS0AJxYPoHkUzucAWX7wbxEA4tsAASsAmB%2Bu%2Fge19RKAzHHwxnDxvhIAzJL%2FD9HPY%2BIQ3BEAzdUPcZL222WvXPMAndPwnCEP1i2%2FH%2F%2FSwZ3aAHjTAJa2%2BbO%2B8OXYAA7w%2F%2F738CwiCFlfD%2BQkD5M%2FD%2Bmf8MFoAAACGhljp0BQ0WLOasoLpubjZIkKaOoR0LMAgexJhR40F3YJL9AxlS5EiSJU2eRJlS5UqWLVVGAhRv40yN6sogwJkT5wxhFw0Cy0azoDsnOMvEC6cC5yR3QjWWu%2BVU6lSD7jSBaXpQ4qQgFiR83RBkUVZ3hr4e8TnVmUKM7sIRepaWas0gX8feKjdX70Z1zRwAABxY8GDChQ0DSNBMLk2CcUTotAClJ1VvtvbudSesSiqJtXBKiHtZNLooxhaPVlcqZwsybnTk7OJOXSWcQppK5CsxrboZ%2FjgNxXtmAYHA3bgTDk2F0wM2dfEWGUCQA%2Fdojh5dXseeXfv27TBlUncXJ%2BcGKFxM5Eyym5i36Rh1u4NiFGmLpbLbL7yvGyq66bjv4z9tLquw0iqcKnRCsAyC4ukDpyACnGmtjDbJAYGBqMOoNwTuygtDvfr66zARRyQsMQjdCycJBHMSYZWsnKrMQ6HU%2BWMDAzqRrRYGELAgNBmnKu1Evdz5AycVwpknHnWOgM6DbmarbR50aqkFnRetROeZUlLpBkv%2BNPwtuOEu5M8dbEqpxZxr2EpNAQQ8ECYcdQjZKZxwfuzoI%2B725LNPP1Pyjjp1hNkAJx2CiSeebo7IqRSC%2FyTqphJPugnnSome4dKe%2BBA4Khz6ENgkHmG4lM2gbk496NRuoAoH1SlraZVSjFTFcMAr3ekiJwl04GIGN%2Btj0MHiAlTHnTW1ElOCXOTSzan%2FNByLl%2F8%2BFNI9v0jElkQTp3LnitXi6KNCnHIwRyt37NPKG2LKfLS%2FUhc6d7Fi4zVInXA8wKkUJXXkMa5iT5uXWXenzSjIH9GJJw%2FlNmlunlSqqIIMOWlD4IhJZvhqBkIuUmcSHfBVQAQdKHkUTOCEI85KT5J4TIIWmqBFNi4eQyDkJLro4DMTdJDTwzz%2FBDpoobELdLTwcNpAGLJq8WCGLgZSpxaWaxahhT8ucqeUI%2F4KNaGMIOTz1KitETiBjCfVeaYFE1TwRaJSTDAhB2yI%2BQPuPJKQwIIWTjBhBuasrNuEIGq96kV1PMkpiIGUnEQ4A2ZAuEEEHhyKISrl9KnYcGqphBYv1QkG5SrrdaebWnxBOC07rRw0GC%2FRgXYeW1Y52yA777R99YJWR7vK2zNHR%2FeFrs22%2BMK2dVYWCXCCoptE1fEWJ4b529wQQ1Lp6aJndqkEHWGuD%2BcZX3y5s5bry3xmkUWUJv2ZTQzZRBj%2BgpeF5vWj3tECbMIpxRCo6x3UIiaRPYMIY3z8MV8punEljRgMT5vICQNyEAdPoMMe87gNxUQgAejkZCzu2MTyEP5EHN745mRjKtYihIOgGTwjHjnoIAIex6ScGEAEPauVdYa2Qx728B9FE407huAgBspPSWg7wYoQYIgcFQonMeTUfGpYwyPw5xnLU8BAQIgTEcwtDk3KiQ6cyBQrMQoBsQFP4QwSj1y9SRjfQcc83GCCI0gsWJN71CaCYAIFSEAFRyjFbbrRhRYsTwQ56EOlFsHHmp2gBbIoliyqoAIGWGAGZYiIlRahAhX8YRI5sIAFcmCIi2ioD2VAAQNEAIXQQI%2BTTLRXEDjpiXjUogUqqEIePCCBGbTAl5u4TTBmoIJHcox4xkMmYJAnFHeQgYuZtGIOnvCHuLjDExjLiQW6cP%2B2I%2BTNITjpAxm%2BYoduOqgWdqCZBeLwKGxwAV%2BfmUEq5hFCXW3gGfzagB0%2BJQEo9AxtT1ihBIaQi9vUxQKTeIIIW0BKmjjwR%2Bo4EIJYQ1D%2BUAwBIrBDHJyYBNnsADpB6AM6ceIGJZksWbXIjBNFEIcuiPAI7siDuCQQhDLYQUMbOEIVcJdDPfnQpz%2FlDhAvo46vIYCk7qlKF6DTAjHgQVxJUJIZJeCGmOakU59iQBX6oCKcLOKExLEmTk4wNztkMwge8MSmqiCbZxQqZUZT4%2B4%2BVYXv6MZe7pDJHR%2BUNRFCJhVuKSqCumCPP0DRAKWYRyneqROeNKewCFAKFD3RFA3%2BOW41EXHH1wxgByWFI4kIoEQtkSbCE%2FTGAHS1kuRO8KThhSiZyFwmTTKLk5cWCK%2BdcaJODHAUoq6oFG2UoU5ymxNguqMKUDRSNzaB3Hvu6Ik1jI06pKEhnaggezvAiQWgqCwIOVRG9urCCnXigbFAaTibsIc9FIaAGRCkE3GAgjTSG1G6lnCJX62FHMXqi3nMwyz5skct3OQkd8xjEeM6F550CFQGN3glQv0QNmjWBzhmJDV26EIqrtGOA1cMOO8kRH%2Bf8c6rMi9R6HgqfouFOLKRNSeGmIf8JsFFbMTDEOPyWVzR9k4mFqQbzwCyNIAcDr1KJAjQmUEcykCzMtj%2Fo8Mz2EQlmpBd9%2BXATQrIgeIkrJwyVEGEPItHkcTqhjI4kQsyoe4MxAAFEcbGHULASR46qxRQ1dK57O1ah1dbLDgjIA5wBNFrkxnbmajjNQjg7EyaaQADjGwTXH1pbw11hRygI6IIIEMnuMAiQhhihWWYRy20i4A8vE%2BE2Asv89xgOueeAH5DREALzBGPMkDHBITwmAyhIJvAVuG9CwAnAw%2FiXRkVuBZ3O09O9kwxJxXrxtFZUKgX0QVsIuAKJTXhSd0hLjdIyUpFjYM9UjFgzD5bOgf7mYPVve6RQHgu9oLBSCtspXe5wx7PmIQYduBEFaCDxfZcUFGiGDYEkPGO%2Fv0%2B6YrF6uI3nc1en5rEPMyY6DQSiD%2BqwclkrUSGDnjA4x7YgCfsITnKTYIMSXhGejeNacLuZBO0uEYfFjEpdyTrjfEo60XlGQ9CiHASLR9OKdIbvfbatwXdIMY8bkK2BfZZzvaic6j4hYD0ALkbNJvEh4cDyXodU9DZInRN2grOeWNEGJP4gzDsMScjVaqoLSCy8yIqnVCLMA%2FpbSNH%2BbcIQtgDOBrSFzo%2Bm4q1T90QFyzF8iQQp89OIh%2F2EIZwRLDAokonUUU96kaIjaHNpYLIpZsErDc0D4rB3dnj6kw5ofOra9s3TKLbNk4QkZV4CNwN4ib36aGN7gWz2%2FcN%2Fna3gIpa24PAD3PdgILjYniEebadIPABG8Sb4g5K4KQFWRKdwltMjJzrwCe0xkkVulEoC0ym4lkB3Qp7HI%2FjIgi9JF%2FQvScRByE4kQz2mHFOKqADN%2BRXIpFHIUkDtYKIB1hrMjGDHCt5NsixLzKIh1tQh1TYEQWQJ6ebM%2Bmxs646IuPCiSuwh2fzPq3wuq%2FTFsWYCg05iraoN3dIBTtIgs9CABOgPBPjD%2FbDiS5QkoSLBzfAiSdoinmQhkXgAjFqlNKhmcnCHx7JHjFhgGAQBixKAiiAgoTCiVSIh6LCQSvhqsxrINN4qG7QgeX5A5lojqsbKdKjrekzN4IQFxW4%2FoJF2JTWMynY0xBC%2BA53MKPbG7c3KTfU472e%2Br1A9Kngowpc4SLWshLPiLVNmAel4hEkQIRncwJ7gKCLYq142JQSK7jp6zCEy76w2r6cIz4EWh4VkBy0yDGLs5fPSkF3mCMVGAHiGjlh%2BadCYbSccEB1AC5d4QL%2BAEASOjQ7JMBMBDrKcYcn%2B5Kucge8MEMEQCwLhDoM5Je3codOEKsUwYkxFEHXIsESrBYrgbUguBJzKIO088UhukUnWq3ZIrXvsMEzUpJfXBweRAAfVIc8UL6vyBcjzLgcyR9%2F%2BcVguKInYrQYssKi0kZ32MKyM4jNQw1xObp4MLYV%2BgM0RADb%2F1BABFuFAXuGebCHNpLDbBMdTDSUYhGVd0IEhxkw5ymLcZFIBQNEQZTJoSFEbmExa0MYpIA1gcCGMVqGdlAEnEiCuluKeVAHc%2FgUTewCo7SHiLKNZAmGAsu%2FseK%2BNNSK15CAdyIjwrE4%2FuAqFWCt1UkO6ZnFyQEssaoCQ6DHXIyHTbiCQtIJO5RHiRAXbbSSJzCKYnw%2BZLSvo4DAsXPGeYDGpJDGHQG4g6jDx0ia3RjBbjyMsNMIV1SOZyALjDuoeXgCW3ODVJjKGWxHAowoHByU7NvBHpwHa6StRVAGMwqkZkRCfumR%2F0MZJ8SimooDO8iD3KRMhJQJhZS3mXBI0f9ImJyYATvYBDegs%2FJrB4rByJaMDhb8jElAh06gGdGcwzGJh%2FxDACighEXQkBHABhZ0kw0QIOcUgUkwhJ0Cj96byfb8k5qcCnXYlMnBTeq6gnkQEwTog2WghXiLNTkpKhXYhGe4NE2UAEIQBorIRuCwv25IBQ2hSlG8FTphkb%2FhyhehPvSYtURxB8kBlbIMgnhYhezKr4%2BUj1qYBDtAKVrQAzqrghhDGWFIkk2RDrx6Bpr5A73UpJ1IRjziBQNDGhfqsz4wymaUOsP0EYQRj4tyk12zFm50zMc0QWdZBecaghqLB2kQFwaohfEDsA8UK8%2BUM9C8wXgkTXp8AntYOub%2FkxI6%2B6tmJDx3gE2ARBlfaMZFeDxhoKpNeBLe1MLf1DwvfChzEALkygk3kA3mVEPUG7HP%2BBTmkY3rfACouTSdkIDyGlFlQ4ex5CIcWs%2BYdM9QDaqYwBCGED2Jyp4%2B4yXxmrwtyiad6BQ6y67LMrLx%2BJWLYrhRtCKaQYC1Kra4Wggzio44UMtDI0uSi4extABPSA06G6wkWCphcIZiMCMygNGa%2BYNFcJ%2BcqAJP8ISi8oCOFDNj5EvqKgNboASaSQ921IFnwAbgOlIEOMyFCB2dGIsnjVJv5JalizUouAI6MwAcBMwycB%2BaOQG3izN3DE0zRaHSrEc1tb5a0AwPUhSa%2F4ECO2iufpHNMWlE6BCBRVgFJrGh8PRT3zQqhiyI4BQNtKmC4bqodaqos1DDr%2FC%2BY1whA9iAMtglFWCOMJQARPiwvPkfndUJFJg96gms8kMHMzKAI%2FlGZmJPUZVaoiHVUu2GKxCv4WClR7GlJ5KASfoKZi2LxcoBcZoqpIABCRiBbxqXYHgUT4BBC0BOPyKrr%2BAojGCjnNC4VLQUYaAuJTqCjiQ5M4lFHvlbHYgHShChDUCBd7IAlCLMIqxUnfgDvBKzEDxGHrUvnMiAX5GAQJJMpBkuqRvPJC0jZUPEroPSfC2RKXUW6FEiAwiCs4GCDsraHrlCRhtThDmugI1HLP9anDNgtKHEuOEYNRnqFOoygAH6DIAE3syQVZ2ApdcwAAr7UwPgwoIR1IP5v0WwHkPQ1qwoB1s4nWcwlfGRH1%2BMREPoCQOCFe8ZnycJh2DwhWDYqZrzXvgphmuol27I31SgHvQ8n2KL2qk14Aer2lLNjPw1BEjKHGzwXj1wEfGpBWwYiu8BXzsZn0wyoJ4IBuuZBE%2BVLu%2B9nw4uB17ohvExXwBSOutTz%2FNzj4bg1c%2FQgUWQiDATlrK42Q3ogkIRgTdahE%2FpoBYgo9DdR3QoM504AUJoChzGox1lrx4lpPFgYv7ABmOlOjOSuuWZ16HoMEwru0BjXSl92vnJg0e9KLP%2FeZRFYZE8OAITOM95gAK4qWIrKQO4QVS0URsVcFuYgpvosoN3WgAomCMTeAJNopkFiB%2B%2BaQF%2FSZu16eNaqIucUIEeU4cngJse6xa46QNha8jtPZgyORd6KYgTbhYAyZxRbheOOeVTJp1RRga2gBdSnpd38ZkCPuBcNgn4%2FJBRtuVXXgZv4A9XrmW7YuVHUWX3SGb9gEBX9h58%2BzSUxQxgrRfgWIQ%2FwGb%2F%2BZx7ktih8AVs%2FgNfkNNakIUnAb0%2FwAM8WIQFqhdKwOZFuJNi%2BZ53Zmf%2BkAYqSV%2FLOZ2C8AVyDgds0ANsjsp6CYdr%2FgNmfQZZ6FJ7oZL3xY94KN693cYx%2FybjIXHQUsBoabBlgkgFjKbMWLmTcGAGWygX2zmVnaKV3TnpC8ZoqElptGnpgrAFZugSU3GVYa4FjCYVk5YVle7pQC3jH9mPUJ6K4yBqp0g3XVbqk%2BDlo0YHoHBqoRhq9wiC3OriC%2BULvOJQgWmP5nieYU5lY7mGX7YSDjWXrdYKYm5lu%2BKFdlCSjNDqVQagtMCGZxCGQ6u0mmhMilYm16UKYwaYtTYIdbGwYUnrtO6Prj5lYsgGw0bs%2F4BsIVHZqJ7qqN4Io7bsyMTlpV7qpj5qqM7sp4iKjGC%2FDpKAHsMTag5tg5CQ1c4IvCg2XcqtOsZXvm7doP6RGHFtjADt3f%2F%2BZNz2kMr2bcz27aTm7OMGCc8m6t72beFeiGnrgs0EbtlSbddubd8uCNj2mUmIIScotL3ma8gMbd3G7qcOivImDVB2bed2beLebeNGbs5W7lBm7t1m7xr86lC2FfS%2BbuzW7lKtBYhJS0%2BtbdsWDPHObPLG7vre7cl26vsObfd2bfiOb6We74Nh8NWGcMve7%2FLub9%2F%2B71JNlJf87tW1bQS3bAX37QxfbQc%2F6g23bAlfbQqv8Fy%2B8B9h8cyGcafucOz%2B8N0OcdcWYwMPDBSPahXf7RzPbBcn6h13ahkPbRqvcQO%2BcRlRcsoebezucd%2F%2BcdcO8tUeciJHDL%2FebSR37Sv%2Fj2omD2UnP2ooz2wpn3KprXIPQfMXz%2FLiru7V7vLV%2FvLQDnMiN3KnNvPVrvOjVvODYXOidnMO3%2Bw4D9U5x5BCX%2FM7f%2B88D%2B09D%2B0%2Bz%2Bw%2FN%2FBAP%2BpBD21JD%2BVDF2pK3%2B1Fj2o4d3T3hHTqEPVSR%2B8t321Mz2xNt2xOP3Eyd21Qz%2BxX%2FxFSl5FED2VU5%2FFGX%2FWZbPXR8PXgNvUZt%2FTMpnXLtvWoxnXCSIEUCAwHeAENEAxt53bD8HSi5nXLXnYPAXZmR290IPajVvVjl8lkF41ypw5hT%2B2u5HJZ9u8O8e1qF4wXkAdWAAwbsAZ8gIctCPiBL3hw1%2FXVHveolnfqOHcM%2F6H3H1l3om53dw9EeL%2BMhxeNiedb%2FsZ3ENf33eZ3wCAAVugHgAcAXFgHJWAFeQiBlW%2F5l4%2F520bvhndqjheNiJ%2F3Zl%2FtitdvY8f439P4vdD5vfB4rPbwkAfykRdy8A4MNZAHeAD4EMAHSAAAJeiHKdAAfDgEAJiCrT%2BehR9vy0Dvo98Lnh%2BNpMcQoP%2FDoZ%2FaotcLtJ8Ltocre591pvdypwdzqAeAF6CHMBgGgLcBfuADAPgBflCDF%2BCHOkB8fmCDwnAAt715sy9vup8Lte94n49wvY9yoYf7dZP7ucD8qbD7lX32GC%2BGdJ92pwYdEwcMB8CFSwCAwX98OQCAwpcD3f5%2F%2FDkAe1YA%2FuC3BV64heI3%2FuNH%2FuRX%2FuVP%2FliIBeaH%2FuiX%2Fltw%2Fum3%2Fuu%2FBSPIBOLH%2Fu5f%2Fuf3%2FvBH%2FuoX%2F%2FLnhSwA1dAXxEigA%2B4v%2F%2FAn%2F%2Ff3%2FviXf%2BznBUnIAvev%2F%2Bun%2F%2F23foCIdWsgwYIGDyJMeJBXpQQAHkKEGIZfoDDprE2xwY8PgB%2F81LzgV6fjRwAENKBEGSJYuZYuX8KMKXOmzGy2aOLMqbOcrWw7fwItx8RY0KI0vd0yqhQmuGLFwC2Nqg5Msn9Wr2LNqnUr165ev4INK3Ys2EiA2EVdCq5n2qVI2ypVpwmMOrhFmz61W%2FSWN71BjzmIKJjPPXn06P7hG5ZCHiQAU%2Fop0YCv8RbIgh8SaKYOHefOnj%2BDDi0atDdbo0%2BjTo0OWDbVrl%2Bji2JsM%2Bzaocvdsq0bdDFnu3%2Bjc0eVLPHixo8jR242HvDdrJvrxg3dtru57qbXduYbO%2Byk3F2raxb48kMHIc6LG6YBQCh6aoatW9%2F%2Bfbr1lxNo%2Fu66tH7Xz%2FunJhttAIomHYGn9XbgaMJVlZyDD0IY4VfLKSjafxV%2BZiCGnlUHxnUbeqYdiJ95NyI64Y1HXkShNAZACKzIY00RD5UAo4wq4jfgiPyZyNmFJgrYo4YmJtgjgxIimaSSxVHY448gDglihx%2BaKGKP6JQ4IooqCkYAAf8RafAlmGKSl%2BOVPDrZ2pVBmhgliEWaeOSSc9JZ5z9Nmvjkhm5iOOWVVvaYJYhbclmooffl1yOaearZI5sj8okhnCPKaaellyaH54h6Yhipgn72CKiJgm5I6KGnFmqmoqZdySmGj0KZ25WTSjkcprfiKpamILqqoKcHglrldoGW06OpqCIrmKomLrppo0DOJqSsPdK6YaW5YpvtVbtu2OuBvxIY7Iiijkgqhscmm%2B6yO7Ka5pWxRdvmtEQOS6mt2uKbK7cYeksguACKCyK5IJpbIbrpIrsuiM3y%2BuyIsO4574jV9nlvvhdbum%2BF%2FQL4b38BbzjwhgUreDDCpyq8IcP%2F3ToMIsSdSvxmvbU2iLHNdGqsIMf9eawfyBiKjCHJB5p8sqEpY7gyvy1v%2BHKFPetHcYXX3ly1hDkfuLN%2BUHP3c4VBVzg0gUUbzSXSFSq9MdOvxgtpzBtK%2FanFVtPtINYEav0d19h5rSDYCooNINlll5kos%2B0y%2Bq7Tvr4t6czWzl235EwCwpy70l7Z94F%2FHxh4f4MTrqzh7L6b93eLf9t4hXEDG%2Fnkr4d1N4CmY7f3dJoTyDmBnusHeugQna1g2jqvXSHq%2FqquIOvhug6781zJ3h%2Ft09kOHe4A6g4g79%2F5%2FjsAwR84fNbFK3h8x8kfuDzAzT%2Ff%2FraVt0o%2B8plb9%2Bfj%2FiMXa2L3v4NPoPh4y49A5uMZ%2Bgikvo%2Bxz33ti55%2Bpged6jXnev3JXn%2B2x539ha5%2FAPrf7AIIoAFurYAAOqDPEqhA5zHwOw5sDgSBI0H9UFA%2FFsQOBgmnwf5wUHoe7A8I9SbC%2FpDwO1Q7oQJTyJ0VAqeFv3nhd2L4nRlOp4Zlu6F%2BctjAHeqnh9xR4m%2BC2DUTEnFyRsQOEn%2FDRd0wkTtO5A4UoSNFo1HxO1ZUIRZP17ZYvcuLfANjGOs2xumUcTdnpE79QnU%2FoeVPS%2BLx3qHiyJ05HrGO3NFi7X4YtUPKrWZ9dN8foRPI6Fiya4UU1rva2Jw3nsyR2IEkGSWJHUpS%2Fy%2BU3NHj7fi4yap1sjmftM0ga5NG7KwRO6YEDioRpsrpsBKQrpwOLB8oS%2BzQ0nq2vKXNcgmcXdaml7D55XSCOZ1h%2FqaY6hrdwhDnLMXdMWJ5xGTrNElN2FnzN9iEjTZfw03oeBM64NyNOJN1TOgk05PLhE4zWfjM6UQzgtN8Z77i6ZyBJvGgERzluNjZuUQOapGMTBU5VWbOhqFTR%2BqclUXX506GSs6hupnna%2Brpmns2J5%2FN2adu%2BpmwjibtoywLKeZImrmFojRbKrUNS13jUtXAFDgyBQ5NbWNTVP2zOQHVJUSBU9CIrvOnJw2q1YZam6Kq5qipSepvlvqbptbmqf4owynadLo0nsorq0YCKldx5VXYgDU1YkUNWXdj1t2gFTZqbSRbhedWtcHVbXKNE13riqm7viavqNnrafqqm7%2FqJrCvGezRChu%2BwxIvsXj06Vy36liMQdY%2FVRWkRF1IUYGVVHsYLZVGN4ojz%2FoPtOMT7UipFdsSmva0DYXf5eJqpNeG7LcynO25amtbRInUo6Vb7W6uasbWAiehLmyscOuUWtVI9jSUXRBygabcJzLXYM59bkSiCpypXpO6urEuaxdrr%2BB2V6jETVxP41Ter52Xjekt2XrZ%2BxD3%2Fga%2B8pSvbegLSvvSLL%2B43O85%2B0up%2F%2FotwMIcMNEKbGAE70bBD%2F7lLcwgDDn8StiuFAaphaWE4c1p%2BJscHpuH2Qti3Yh4pQyujYN5id0uxlihKE7xY1e80xZb68W5C%2FJMZyy4Gj%2F3xrbJMVF3DJseZ%2FPHu9HuErlLZCR9NzXhHc14RWNZ22DWNpoFD5Qh4oBQHIJGkLgEnX8AAAcEYhiXSMFto5vT6ZL4aVrWDZd3M8Qv68vIb0Vyn5SMPSYz1cmfa%2FND%2BPAPVjzkMesQxzqmAIBD6OMS8BhGitqL2w3qFoCBZpyJKzZkRHtX0Yhl9NQcPUFIn1XSvaP0D%2B6BD0wDgA%2FyCIGXAKABeYQCAGHoBxEK5%2Be2AnpN6SwxaRn7aljPKcyoGf9zgQbtS1vDENeA1TX32uwAa1zCGsAOBbJDoQQA2GAfHCkCP8ZAngBMIx763je%2F%2B%2B3vfwP83%2BcgRsALbvCDx4MY40A4wxsejyhQw%2BESDzg7eDHxi%2FfbHde4hjsw7vF6eBnbdhNEPTyOcXcsY%2BEmvzg7CL7yidcDFGAo%2BcsdrnGO11zivGBHzh0%2BjVJfJhDi0MAwME0Aa6wDEtbQRxE0IgeSPP0Hcpj61Odwh6tjPeta3zrXu971NqDB62IfO9nvgIY2lD3tar%2BDD9C%2B9rd7Pexwn7vW0SB3utN9D20vBN%2F77ve%2FAz7wgh884Qtv%2BMMjPvGGxwIT9oB3vJ%2F98ZCX%2FNz%2F9wAGHzie8m%2B3u%2BbhfvfOp70NBeASEfAxhhBYAxfrCcF6UnCPSzgd6gB4wRZqb3tBJCL3ut8973vv%2B9%2F73g90AD7xi2%2F8RPjBD8dfPvMTgfnmQ5%2F4w48%2B9Xmf%2FOpjPxGOYEIbHOH974M%2F%2FOIfP%2FnH74fyoz%2F96vf%2B%2Bdfv%2FvdjwQqOyH71r09%2F6k%2F%2F%2Fs13RBuYMH%2F9N5%2F9ASDz5d8AHp8gjJ6KBMI%2FGAZikFoKrIcDrEMopAA%2BBAIAKEE%2FbAF5ZEY8uMMHgmAIiuAIkmAJjuDAmWAKquAKuoPCseALvqAHQpwHwmANmmDF2WAOluDG6WAPgiDIkUI9%2BKAP7twQ9uA4%2FxCDEepgPQACySlhDqbcE9ogDkohDMbczFUhDPJgFrKgOhQhF6pgPGgD0EWEDYTBGV6EEpSAPLCCBkwBP8jB0VlDCUACPriAs51JqnXQqqVOq00NGGgClZQLuX1HNgDDlcQDIMhaaNHap4BbE4lbZhEiDVHaQ6TeQ7ABPsjDrwXGFCCGPlwgHq5KtDnKtAmaH8pNIF7JmrmGISKiIloOfxmXf3mI%2FZTSJEZRJcLbC0AE7RUBmdCenfVZHpIitDxbH1abvagisVyJK%2FZIIi7ibjUisDyiGkWimuGiG%2Bki%2F5waDumhDvHh%2FCRjrSzjqGQjdDijiUBjLFbYLF5YLRrSLf8ayzZmUDdW0TdeUTieDyq2TjkOYjMe4jPCYvxcSZmFxpllxzXWBiumBmdx1DF%2BVjE%2BjCmy2jhCjj8SzDk2RzqOyDoS5DSGSzUCk0J2h0aGEz3akD3KET7SkT4SED8yD0biD0C%2BYjSqGkgCjEh2E0m%2BBkOihkOajUo%2BEktGkkuGEEyuj0wiEk0KpE3uIU5%2BjE7iE0%2B6hk%2BeBlAO4yh%2BZClC5D5aZMUoZdiY5G9wJIh4ZHEp1nHBIymt4ljWFEpOkVCuElG2klH6EFIiUFgCjlvqRlluyFnKYlrSoiDCljzqD1zCkVwiE10qk11ukbfVRqGhESAS5kz2iF9iCGC2o2D%2FvmNlmpdhKhIZfphiAhRjCpRjVhJelpBeXhRTquNAouVoDaYttuU8iqaNkaZUmSZVoWYsqaYQUWZtXmZAvqZTgiNU%2BoxUxhRVqoZVjgZWiuLhSKTLUCQy%2BtZPsebu8KVtYGaFaCaLuaOLrWVFgWZG3WaU5eZ77WZ89aYz%2FeYXZadsuWZHwmZgymZn0iYzHuZ52paU1QaVfZWVvQaW0RNkwoZkUkdw6qeJdKeCfOeRhWeSjWdhCmdoGhh0EeNWGiNyXhJ2eqZYzqdZ1udm3qd4fmiGlWepBINDXKipdSWqTWfTVKc4XudcxWcFbWdtNOiBPOiiRWijTWhypei5rGiL%2F7pohsYmdb7oUX7lH97ocoXoX44oeHKmieanOdqmkQJPeibYei5YexrUe%2B7Rk6JXlGbmlEJolUroicLYkKoXf26Uf8IGgOKVgLoGgbaUgb4GgvqSgmLpcNYkO1Jpia7plf7jfmrpgXFpiHnpiEnbkt5lk6Yim2qnmXonmvqomgIppT6amxIYnDKSnL4GnUaWnaoGnhqVnroGn26Tnx4qgxInfRpnPnKoKAXpZ1aoeSbq9ywqjjWqjoEpVklqP3Iqjlqqg2LqrP1ord0qgHlqh4Gq94jqfvxqlQXrdYlpLZGpgB0rjyYrIy6rIzYriuYqbUUrN0LqSsYo26Rrag5rTP8WK5QCalMKapoS6qYaakZmaaJOq2qQqmpda329a1LGa5nOa3HWa6beK7MWrDU%2BK42daz2261yuq%2FHMqFfWKGNt64Z1K4H0qLJqKsPmq2VaKL%2F26pRVa4AG7IMNbF42LMcerKwmLMgurLi%2B7E4%2B7JNFbEpO7GJWbPlc7Eu27GrerD7lKGzsqMd%2BqzSGKzWOa5uWa3PtbFz2bGn%2B7IGgalipqmqwqj25qr7GrIjOakvWKt8op1IxZ2o4p2hAJ4ZqZZLKaNUKa8YqY9E2WccCyMeCa8ja7MguJaKarNyq59UKUNAyKd2So91GGt72h94yLd86reKWVdqixtqGhjoUaeD%2FIql9KmnZQhPlLsjXkuyIJG3eLu1NNm1IPu2S5eyksaiW9mtq%2FCt4mWqAGG6kIu5FSu64Ma5%2BOC7qQq7q7u5lge5oWC5otK3oCG6XEu4H3e5jZqs0bayM9e53%2FO5Tpm5Orm6nRu2b7mrsosbsilntokbW6tXWpkbXvpTo%2Fi2sBqqG1mzk%2Bi2I6k%2FmqogDKMEU5G8IPITUTQGZ%2BC%2BZKO%2FmkmjnZu8IFe9Bsi%2F9ui%2B9wm9v4Wc8du%2BnFgq98QM%2F%2FMMGboE%2BrMM%2BtMgGd3CLuK10PnDcei5CJTBoCMf0Gm31csf1HucBJ%2Bf23lrr7hp%2FqgE%2BKMEL2IAGNIA1qEcg8MML%2FxBAemhAIOwDL44w6ZQwu54wdKgvUi3wXrowdsAwrcqwEJ3t5NpwufEnJKxD7bWeBQJAEWhgCYBiGWsgB57sf8ZqAZtwFkPiT4HC8GJjFU%2FHFZOtHJstDYdbF18QlB2dPogDPohDCmjESPQAP7BB7HnE02nAC0iyJOPAMXjDJWNyJmvyJnNyJ3OyM%2FCFJ4vyKJPyLTgDKaNyKmcyE%2BiCKrvyKGdDLLzyLHcyMBQDLeMyJp8DGEhCLvtyLGSDL%2BOyM9iCMNPyOezBHpyDMc%2ByLZwyM7tyLEPzK0sCGCzzNKeyU2CzKgPzNqMyYHAJAWzBFDhAEezDIcSe0zkyHGIgnf%2B58yXYAi%2FYwjzTcz3b8z3jcz7f8y3Egj778z8DtC0IREATdEHbghFkAjAY9ELrcz8z9EPbcyw4NERDNDFkgSQQA0VT9ERrNEPzAkd3dEETAx3QQUaH9EIP9EmjtEobNDFIQhaYNEsHtETLdEGDdE3nMzA0xKk4QDqwwgvoA0cQQT%2BEQQrImxqHARvbsRuXjjeg01Ln6bukWavW8QQrSOk27ulib%2FACjMxB9WtMdXdkDpSFwDBwxAvgwyFIIKapAT%2F8wFoDABu4dXQyMdw6MR9%2Froda9YFgte9qdQxzdVT68Rzvtc6GcyjwAyuIAzzwIh%2FwAy7QAy58iWPjwj24ggD%2Fb%2BnyMmrz8tDzumvuguVXV%2BXRvkZfW%2B9fY3Fgz7Boq0ZY9yRpq8bgOAAbwJkSE0AYhEIg2AcBjEFu28cSlxNnZ5Fn%2B%2BbQAicL323YSunYFuUTu9ZgO2xhT9rUJqZm%2B6pw25F1Z1n0KhRyL65ynylz16VzL9EW%2B1UKg8bxfkbyHunbcm4cq3aH2ihrqy1sq4ZpvzBq73F82yp9o4Zrj%2Fa%2Bwm4bz2nK1unK%2Bhh3b5d35xoeQ4ceNzdeW495Ey8gUyJ1pxKBj6qBlyqCb7dxw6d%2Fn4Z6fwZ%2BW7F%2BRzh%2F97GIjwaAN6d9%2FyRiZrh2%2FyeHA%2ByjkjeQ6fWCku4bL%2FfM7m38%2Fwrv%2FFIx4A44jRc4dk8ScbsniI8pi4sGiXuGiecxio%2B3hE8UdI%2BkhecihhuThlOrkr8Sk4epk2srlIeGlHcGlT%2B4lTdmjqMRhaMZepMIjF%2BljH85km%2B4mDMTmc8tvez4nzYwwjZxRc6mBPO4uX4vmPurjdOuh7MtCf6LOnwgkkfxWE1xa4L3pYo3eFR6aHDbbaBvZcl5QnK5Nnr5OOl5mBc60K56Z6hDOCzCEwyBEAzBEfwBNvDCT5ZBEARBKdD4pfNVphPIF36gvrnDq0%2B5j4c3kAPHFfg6sINGqIOGQaqwnI8gRP4VpSf7awu4kYpqsofDuKNDPEQXgI57ODw6jv9%2FzDPkAALAe7wjwAnoQVeqAAIYwCIstbBXFrH3DjYgQRIIfBJAQR78wSJgg4izeXNA%2BGvce75XJrVnyKiTl5YjrzpsQhcMfBcA%2B7OZlTtMgsDHAaSq%2BYnguarTEDoQQhCoQMvngB0k%2FGfkmDssQstDwYtK%2FGeYrzo8wwzIuwdIgLwvgrO3ALxPwr7TeWesMJp7hjoIQ9DLe7ybwCY4O3AsPHA0vGsUPQIc%2FbQ%2FizpAJNg35MV3xpCAvbJzyBbHOhREPbxXwTP4mVnFgx0YgAEEQbyWPHtndhR1wxG0PQK0wCYI4swTArznAM6T72nsvBDEexKkwjPUQhx4ALyLgDD%2BbEbHJXuyM8fWd33H6RtnIHtwaL5IqYO5U%2Fo1bIfn64jqHzfTw%2FozWMDfw7sFCD6AXP1vZL1qcH7Etwalo4MwwH23w%2Fp1CEM4JPvZc8bZg%2F0zhMNmUDrPBz86SMfzP4MwdIPvDzk%2FhUMS%2FLy8B4FoyL0dwPsR4L2dP%2BfJ%2B1OvqkM3BEG8W4AOTD68e4Dld4Y3AIPYXyXyckjhI8DhrzdAoBM4EFi2gQLVHVQ4MOFChw8FRjHWEGLFh%2Bo8IdBYxZ07dermTZKgsUy8bnHI5AnGJYcbYTM0TvJIiEyZMsK6uSHTB92iKjrIlKLorlacJDnIVLr28Q8ZMpMaqqP5lKL%2BRavo3IHR5O5q16vqnlkgWcqToSojEajoRlFdvI%2FxuDKM51Zdx7h1PcJFlw2YV78W4wECFO9v1xYx4x4s6C5YmRkWRATpEy5qODs5LLQgUytIjip1L%2BcwBGVDi0Um4%2BTw4CHIInTlbqmzrNrCiSCGPha%2B6k4TmMSF49nRiGCIJ2ybcgwndBeuu2vXfqPD27aqu7l1684TjuBIYuvTFcam6%2FZgW712yetG2MwBAPfv4ceXP58%2BgATNqqp3tx1BFWFgy9DIgCvicoccW7oJp6OoFqwrHAU%2F4mqtAgnRKIeoCEtwQYGAIWdBjyZkqMEMO1IvoolMfCieODSyIJjqjrD%2BUB1pLDAgs%2BFKgQmBSezpQ8Au1BEGAQNOiNEAjRbIgyt3FhFrOAagCCceKAwwYIaEwNpgSEOiSzGrrVIsDCwnDbGno3kMGW6RAmux44gj3JhEOumEcSPOVKo4whDKwvEpiDJc4ytM3QIbbFCHDtuxyw47EWG44Y6gTLYYBbRSASvbquJIJw34A50gHtUoiXJ4QYfSUMnI71CseuuyK3W6OUFU7OKRxlEJuljSlz6SCKIJMUrxTpg%2FnjjCDlkS%2B8POVf7485k8NOpOOnUmcSOILgjpJjF1eClqCDg9yU2dWuzc06wk8nhGVa%2FUYa%2B%2Bd%2BGd7751%2FYJVBVE9ks4dIRD%2BMOEzrDyRggURWjBWUlne7KOWKlqYgYwE%2B8ghskUScqdCBC7EqpYuJIYhiTKw%2BYgWJI5wQhg7dIjMU%2BlqeTOPbsiY4YQnoDJRInpNdCcJGRWKxw2NTggHGw9CncGcRDfxxMlI3RHGSQREmAGtE9ZyWiMRYFBAozjmKUUjCWqpaxGg11oVK61cNXuhMTVaDiF0EuVIujKejlZddyapcgZHEbAAG2l0CPUIZohRu6tCCTMcbsQWIoYWWfvOczgo2vpjuB04Hu7CeK4YboMTPOjGx8ihcBIPYrxGwIM%2BfBouFZxzblW%2FSXD0jhBCagkHq0m0fFSCP5Y0hOjhJHCjoRb%2BjkzUAEIs5y5fKIr2hKuEvKgbgSsmXOTIDUAdTgSh1Gu3vXjJh3feMDEaTiaGgimlbLzRejQIBTfRyIMNjtQoiCCqHI5Li2WkjlXw7VE5wIY7KqG1tAxpOGXoSP0Q0ALk5Q8BwFPPzQynjsAhAAqJGwiTvlaLbgxPBZ2YBMUSVYbeReojVsPYM9yRJgQoIBXzIINGhqAtkUAtZBuMA1yeoJEuePBQX0qb4hASlrZ5B3oImAFWRtc3AuagG%2FGA4HAMwJHuSaAFThJCX5BYEcQhMVHrU8gyxGA%2FT8zDHSzSSCfckRzuoGMe6JDj5jqHgA2kohulCMe9EFAme9DOicD%2BuJgKPEFHO8RhEt1AIm98ox8ZUq06%2BQLL8Ag2PKoRxUkiUIEC14QOHRHvWdHqSIA0ogJM3g2VeuSbASgHwuGcAHIISALsKiK%2B8u2SPufzEgQ3oK7yiGtoGqGBE7qHgFpYkXi9UiACTpCE3umgLRe7kDlmkDwnCAEtp6kEA4bTAifwzQLCYOZwgpAEJz3xgihSmwY10kGFAFCPOBleHMzElcMoAC0woAydnHQadRRTAatQh47iIA1hPENHpbDHdi7UjVsFS21GDONFlIgAtwmEcxq50jOGlwSc%2FAEtebDHFWeQijysghL2E4on%2BFaJI4ZxjIorY5eIwQKS1PEjPkT%2FB9%2FgiI54NA%2BPGnGCW%2BKRipEoIA%2BLWIQhtJQBW6TiUTMjxDPmgUv9yI5QqMzYRTbRAg%2FMQFu0qIAeYbgzBARBGuoYHTtHaYdN%2FHA7R4jHM3pHiIF2Lw%2FzqAVauvAMbPwsJvMYWzwdWQWyadUhuuTlY9%2Fjy5xtJ2j0AssVgrADYNgjHnKcxDyuWKZwQK4Fz7AHtHgYD2sOtAudMa09KPWHeHxTf%2BEYJFpScU4EkMEdPdJIMBm7EAy%2Bs3tfHYjPgCa04ZlxcY%2FaQNgAigCwfQSkM5QFNnonAe1KQIGEiIcwtCQBX2TEiYqz6EXXltGNClWxTsSb%2FWAIkvbewB1X%2FKx1%2FtoLhW48IxztjcNMkVhTw920cTTQCJcE4g4nbO2nGgFfDGXUUQQMESstxSIFESDTLoSqb10IIyQBDJF4tNe4DDHxfvsYhwxoJJGQW8R%2BhXGrF%2BnIrh0JTrRCArRnPKMbzQvCPNzYgmm5g1JQsMdhxduRTixWN46F7GMlqx%2FKlo0hbJnLMSpBiCr0rg8nTW5dKFUSdchCa8FUbQDjMY9u1GIRXTCBRrhgD9oG0i0EXcU5FVALj9SizMIszHDNhty%2B%2Fac83btSMRHwuoEk6lFCwJLVJPCiS1oXuzO0wKUtsIEKWOCHRNZIHlDpBiIWEW3oTa%2BT1ivhGQj6q%2B%2BFJjog%2FijeigVRuhuwNVquMGpTC1Uwuj4UgRWS0wMnTmcM5htF4yHDok6YMPX9mg50kAMd7C8HlYDLJKBAwAOHuDAg1k%2FzRNDWgzyIPGCJQxC0RMFJBAMtmbY1KN2hIy4k7sbcsYcbJWDrDayz2NejtxthIEu11AWClGyyu54MZfyEydnWZQs2aoEVOlXhzf3TyB%2B8DE3KeBoBdnALn9F6ZoxRtwuftPiE5QxOBGzCI3id4Z0hKIK1CLDPwVUIoFflDvIiwAkjat5u5yGN4SlaIIkyTe%2FWFCSxRJq6RCsoOgC5CGwIQxmVoAWPsXLYGdzLAtCtaKl3zRD1bmuDRvZqQ9yx%2F%2BRXQ1AF%2F3QHrRmw3e1SOOzH7TUZY8LZuczFHcTgFwez6g6Jtg0dkOuCmeJBqWVTWB3BEEs54fKMSdQCG7wQRioWIUJPxAFyR7C5V7ytG1lKYBWJiUcXWtAFoTyD0SpAwooR4IlaEE%2Fu2l0TQuld13trJO61D51az5B7jbRAHVpPcMGp%2FBcnJ7x8UW7yKtBiCA%2FGgwwLyEEewAJICwzBDjrCeME3TimPj6vPIs%2BYDo4kAR24YQhCTLl0%2F5Oll5%2BzsjRH6%2BcHgnOzJfMJ7jsZWjxAGNxB6DSC6JprEezhhiKIMiBN0qqLhuahiW7JHmTBA4okbOxFfvBvN8Cu7tgmkP%2ByCiQ8AS0IwR5kqO0SYh4I60rYzu1o7QqeIReEQRZqgRZsoe4OQsDUJlGw5Q980AcXgRj0AEnKoBZSof1CLo8koAxKob1GTsLoTpREZS0UkAZsIY8MqCOaKFfMi6vExOX87S2EgWgMIAnsgbBaYBPM4RpQQI%2BkAdEM4RmCoRZKoRawTkdCSah072JmQBiCQRhWQRaCQV3OLiHiYcE46Mg0AgaOj8nEBOGYr%2FkWblB0pLSQKhjIcAfeoXlYQKbsYYO%2B78s4bvxAzsysKR4I6XvUwR64wP1oSwLiz%2BUKiv5mbhVqTjf071Aab3iuJn7obEaGjiLK6Lv4hmsasOlmKLf%2FrmgHuACQVCBkhKqVAonb%2FuK8PDCj7EAOg4EQIEcEYOivhOgjBmhrMg4FoSiVTCscdKAFdgARqDHQ7s6mOExARMAWsuFUVO7TPGIM5%2FEJ84juZAmaWkCB4oAYlMZ%2BcgCQFKULI0k%2FWlGIcCIVYOBrKGEekJAM7MEeKAGcJCBY5KgL5sEeSuEEZqAKQgYP46Le7KoWOHITMpIMVCAH%2BkC39EodDCH6FBEBGBErkG8DpQMSIzFenE%2F0ZMiJFgHzGA0BNwwBdoAY6mGHKijjKmsUP678rGkemqft%2FIpvDu8VY1FLZrEn7Q%2B4cNGdMkgWRulRREAPsIRGjsQAT6BK1iQe%2F%2Fog%2FYRBSDTCF6irRhKtLgiLgfpFFqJCqexH3AzHGsPuA%2BWOeNxROpywYZzkGc%2FJHMGCbzQjmWQKBzkqHgesH9PCFryhG6DAFz1ASTgqFeQIY5Zyc9orCtXBDsSif5aQVPBmePrHAoznkbxQTLohNSXgBPIRCqxDATfADeKAgHikKIWADGTFAHLAHKQQAfJQJT2CUjagC5JgJJaHK7pHAWZAajTiBqrosHay4QzuEccnKIVyEtFHGn3xMyBMI3bACZ6my8APzDSCFK3SQuIhdZyoCnixKznyK%2BdPLG3x%2FsrSJ3ejGwgBCqBt2vLgGEpFILrBDuzEz9ChD%2BwEA0%2FCTv88oUPdABor9EIrhhKe4EG9gBZ%2B46CM6h39AjF3LUh8US0RIXHAIpmGwwRYDm%2BqRAT%2BqcI4ZTjwYBk0czMNRXFSYROUdEmXtBTs8SNSwULd4A9gCCFk4RmEwRM8YRN6wqM%2BohaU1OsSrE3sxA2CBTawYljK9A8E8MN28ws3SHBmrhZs0wAUYMUMwOPQoYkAUwT0DG7kMiXjoEqCYB%2BVJ3%2BAhE50KlRy4G60xwBUoBENIHR8cvnUsz6GssnUwQ2sRwKqQFLCoYmqRAJgwgCC4Jx8tC6EoEp%2BaMy%2B5hmGSm8%2BYimrRAECx0rQIYE0wgGdRBmvZuaoqm8w1C9y0Wym4yP%2F6gJNP%2Bg6DsI60sM8yGPvmpVZE8wj6uIanAEh3AG00IISXBT0OjAxu0EMvsApzJUMrmpFzWERguA7W6JKx8Up4kB3PghPvnMGaGYcwEgzddBY7eJf7aIgEGLv8iXBhMACPOAIpMEe1KG95AY8FAJayUNZ64JgFXQ33lRMwoEQhuBej8A1ogJhvvMIGqESnKIme6Jdv7MM%2FMwOnEIwEWITThZLnqEMcuA7dQBlpcMW8EBlc8AOyiZeycAOECIY5JVe0fNS1%2FNiF4Io4qAKrqAKyuB1KiMPpKAJphYbnEpOnmFrEcITnIpDnWoRGNCpuPQjzKIKuqAT%2BsSpusEWEMFt%2FwWibaUOLLYWOgdqbJH2L4oVvZS1SIshW8clCbZs%2BH70MMO17niBHfbOYh3CWiPEyvQiYiG3IwSlSPs17AS2ItzBDfLnBJxglPLQL%2F4WB0MvRbADWesiYpHVOaAjPbBCdQsWK6h1YCdXX2RXIRZXdiV3W%2FjORCxVaeUjU4HXWWtXW8mBGOjCLvSlRLR1dpm3eb2DYLGiRDrEeavVkqJXem3GLOuudHEwcKUjGC5FTb4VXMGkSG%2BhHIp0L%2FYVBzN31zYXIgYqNSnICdQDfMPudHHQGbK1fde3SINXeOGDeNHLG26wfedXM%2Fv2ovQ37MQXVvYmanDjomA07AK4SC%2BXX%2F85EwcX%2BCL6BAre5AiqgBLmpDAe2NT4t%2B78t33RIYNxcIAJ2D0M%2BKIQ2IU%2FuO4aOIxS2NTEl0K7wZHO90UTF4PZV4Pft%2B7i19RyuLEAFntR%2BBbad4XDroUB%2BIhjGChnuIDZEwdvWIENon13GIl6GL1%2BeFqYtisueNdgGAc3GH47uO6a2NTK2E0bUjOtWH2x2AO1eItpuIvr7ouLdI5NbYwVp47D6IxNt4jZeI%2Fr7o2VOI41N4w1E5EZcojDJI81s40Ts4%2F9uIbDSJA1k5DRy5ANx5IVR5Hrbo1NjZPDDpLDbonRi5R5WIqLlIp3TZNx0JVNTYZnGJSRSJQ9mJIZ2Hv%2Fww6VDUeV95eRW9mRXzmJY1mS5ZeYv9eWNROXTU2X646X0cuXH6sB3gWYFUeY5ZiaddiYdw2Z1UaZd42V0Yub0QuWd02WL4qWydiaTTdjc%2Fl%2F9ViAPfk9UoAVXAEXcKEIACCgCbqgAUADIEEcXMEGegmQw46cJ9mFTVlt1Nls2FmFmfmdnXnX5NnU6DmM7PmQ8XmV9Tmb%2BXmTP7qb%2F9k9poAfrGEYrEEJAGALZJqmbRoS8CEQxMEa0pOL01g3KHqaLRqd6fik626j0cudLwqeLyqk0WukkaikT1mp2zml0Uubjdifg1o%2BAkEeQgA%2BAmEdNOA9NEAeLuGm%2B8Ggh1ei%2F3etqJnYnMPuos0mo1eFqS24o5%2B6peMZmudZmue6ffF6ULB5q1d6l%2F06jLyZFehhGIYhDNzDsSFbsm2AH%2FgAAICAH9SAPpoBk1PEGwBbfr3hqEE7f7F6n6cYDEDhtNUDqsNIqi%2BKqhUHGEq7SAub4UDhjvs3sbd5il%2BaAHDBGviAFfhhCgiApvnAFfhBCS5bDgDgB%2FhhDgCgCA7hurHbFoBhu7m7u737u8E7vMHbFmJBvM37vNEbGGLhFtK7vd0bGIwgE4rhvelbvMu7vvHbu2PhvvM7v5chCyRhvvs7v2NBuwccv2%2BBvw%2F8vZeBDuhgGRa8vtc7wumbvCn8vYtBEv%2ByAMIvvL33u8PdW8FB3LxpIQHexQHaI61DAQBQHAA%2BQK2fO7r5AbpLoAhs3MaVgBayYcd5vMd9%2FMeBPMiB3BluQciN%2FMiRPBtuoRiSvMmdPBuY4BWefMqF3Bligcqx%2FMe3O8u5PBvGAcC9ocuzPBacQcyxvBjs0cynfBz2YA%2FGQc2n3BaYHM6d3Mrp3Mm9QcPf%2FM6TfMv5PMnJ%2FM%2BRvMTrowF%2BoARYfB1YgQAOPdFDIQXw4RAAQAn6YQrmgwA%2Bu31FG4dvu0glwrWj2IW5mqNb%2B4rbV7ZpSrBnma6Teop3G9QLY9Sb%2BZZfmgPkYRheIAw4O61xfQw4O7nFwQYuAR%2F%2FUkBe4NrU5HrVj3qo%2FyK3w0SvP4yvwwi2kQjVA0zV65nV%2FTa1m1qrL0rWPdqr32UL5AEf8OES2oPczR3dq3sd9AEfOtvYmf0vkj3blx23ud2MfbudpR2JqF1xrF1xaNtwrBqj892OYf0vwL2vxf1dQqAIIPo9Hj4G4EMDiuAFMPXYDziBB1nbSxmpt92Fof2R%2Bl1x%2Ft1wAt5wBl5tCv6uD143eZuF972RG96PhVrTOX6UPf6i7HpVnD1FRt68St5wTl5tUl5tVt5sWt7nX%2F6S23fhp32xkcibhVecDafeSXrnw6jnD%2BXnTSToETd9WfrUR3uqsT3rCbvpD9Pbwwjq%2Fv1d6hWH6pXW6tUG66ta65GI6wfF69UD7L9O7BWb7Ns36Vdl6bte7SuK7ZHI7U0e7jPopQmY7s3G7msb7xVH78OE73XD783GqaNe8DH37O8%2B7adY8RWH8Yne8d8J8qte420454f53isZ8dd55pt66NWm6M3m6OHxSHWe9G%2FZ9A0H9XNf9Y2V9efe9UMZ9stZ9nFQ8wuD83MO981G91eF91eF8A%2FF8Pee9nNO%2BNWG%2BKvf%2BFdF7i9V8leF8gne8g0H81ME%2Bv9C%2BkkN8LeZ%2FK%2B%2F7Gdb9Csf%2BK8Z%2FM0GIJw5Q0ewoMGDCBMqTHir3MKHECGqa%2BYAgMWLGDNq3MgRQIJm%2FuoiihxZ0JstkigjAsuWsqXCKMZCupyJrtwtmjiLDcTp0h0YTe54umwotGU2YEVTxgMEKF5SlCufkrQpdaQ7TWCCVo0ocKtIol4XTqzYsaxZjR9lhlVocu3DqG5fxoyLkCpdhDrvHvQJVK9BsH7RHQ1McGlTwujgBrYb%2BGpWxF0RA9Y79qzls2kRt0WsODBMtXoZB85LmK%2FWwJP1DiZs2CnhzqFvlsZ62m9kwqnpVr7Me2Nmwptfs0T8mbBov6Qb%2F6ytNzfd1YFbcx6%2BWHZj2pB34nYYeHfv7xZ%2FBw4eGLbe4tURo0vu17Rk7oGh%2B5UuHPHxu46Z372NGj5liuAF%2FiieX%2BT5Zd5d6Pl1313s6eXedojJpxd95VGnoHXtYUcYf34555Z3AfI2oF4F6nUgXQnGpl6D%2BC33XoRIscaUaxXah6GDGgbGYXP%2B3QViiJaNeFeJd50YV4p3LUgXi3Q92B%2BMiFFooIUqzvbYhto92R2AQIoIkmYnTaceknQpGReTcTnZYY93SXiXlCZSmeSN%2BOVoW5ZrEvZjl2UJSReRdBnpFplxmekWmm6pySOUMh5Wn3F0NmmnXjve5eFae%2FLJkZ9xARqXoGsR6pahayG6lqKWsvlcjNHNKCakiOWXnXqXhpWppmh9CVyYjxIm6lqkhmVqWKjSVWtYbtIFZ5Fy%2FpYZaZqT7ofnoluShWufuo7Ha43EzZUeYsN6VWxcx3qVbFzLBtpsoc8mGi1dlRqr6odcXtsRp2556haoYf0aVrBehbvVuG6Vu9W5bqX76bqjtnvqu3HFS%2B68mNZrr2%2FZErjtlGN6e%2BGK0zbpIoSEIbyWwvsyDKzDxELslsQFU2yrxRdnhO9a%2Bq7Fr1f%2BegXwVgJXRfBaBldlclgo66zyvyyL6%2FJaMBMts1e31nxzWDmHtfNWPW%2F1c1VBSzV0WEVLdbRXSWu9tM9ND%2Fx0WFGTPfVWVV98tVdZe7V1VV1X9bVUYT81tldlP3X2VmnrvbbXbQv9tldxEz53VXXbe%2FdW%2F3lvtbdUfUv191OBJzX4VoUndXhViWu%2BuN%2BNi%2F34VpGTPrlUlV97eVWZV7X5U50%2F9XlSoRc1elWlF3W6VKnrvrrnrQv%2BelWxEz%2F7U7XjertUuUu1e1K9J%2FV7UcELNbxUxQt1%2FFPJa7%2B8782L%2FrxU0ZM%2FfVLVa3r9U9k%2FtX1R3Rf1vVDh48n4nlI%2BnpwvKenT3%2Fq81z7hve8p8SPg%2FIpSPz7dLyn5S8r%2BhNI%2FofyPJwHEyQCTUkCcHLAoCdTgAv3XQPE9MCkRJOEEhVLBLl2wKBksygZ50kGefDAnIUvTyLQUH1bNx1W9%2BpiV9AOvIE5MTzSr2UVuKJQcCmWHOOkhTv5%2BSJMQ0mSERSkhTU4olBTqcIUebKEAX1iUGIZxhjypIZCoyBMr8gSLNNEiTbg4Ey%2FOBIxCEeNMyMgTM14RjT5UowjZKBQ3BhKOOJFjiOiIEzviBI8z0eNM%2BOgSP%2FZkiHkqmREnhERufes6V9KRE2MGRWtJESOUpIklaYJJl2jSJZxsiSdbAkieCNIlhMSJIe%2BIyC0q8ouM5IkjfQlJmlTuBXXgwwouooRAhMFa1dyCK2GZMRJtLE4dA82cQBYrUFKriFEqJcdgtcRZvahaZSkCPdYhD3m8AABh2Ic49HEJAuBTn%2Fz0Z67EOaRvMiuc7CTMLlPSS5z80iijfJM6wf6Z0Ayl8k60auZMqkaAYVjDAS%2FAhRIIIA5cOIAP%2FLABSU2KUhtgjKB%2FMqi6EHrK0aySWOZMFaNa5ShTKhGVTIzYTeXWyo6kAB%2BHsEERKvICfQQCAEXoxxZS4FSo9iMMGyFAM%2BKhjq569atgDatYxwpWd4yDGO4gq1rXulZ3EGMcaWWrXOfa1ShQg6t0zetY08oLvfpVrO64xjXi%2BtfC1gMMoMBrYQvLi3IQdrF5NStaIfvXegBCEPWgrF%2FdClfNRrYcvHisZ9kaD1CAIbOjnWtgB5tauvZVtK0VazymsU2M2AAf4hDHPYahARvwQw4A6AE%2F4OBb4P7gtwAIwQ%2BWu%2F%2FcIlgCFNCNrnSnS93qWre6mpDEdbfL3e6CQhLa9a54x%2BsDR4z3vNzNribQy97qgre98I0uKZgACFLEN76SWO992%2Fve%2FbKXFGAAg339i97%2BEni82T3weUmxhygMWMHeNTCE05vfCXvXEgXoiA30YY0QAGEfciguAIor4uMCVwmQSHGKDxHgFrv4xTCOsYxnDIYs0PjGOKaxjXPM4x6DwQdW8LGQdTzkIsM4Czs2spJ9wAQlOznJTh4ykqNsZB%2F4gMpFnjKWhQzlLeeYCVf2co%2B1LOYcd7nMM9ZChjnyAnxAAgAkvQRVnxrVMKRgH3ywKlY1EoCtuuPPgA60oAdN6EL%2BD%2FocaDW0ohfN6Lcy%2BtGQ%2FnM83GHXSUf60oZmR2gxzWlCC7bToAb0YUlRj1CHmhfsMDWox7EMVXfasph1NaeXAVdZX5odibY1pOth2lLrGtKf%2FjWkUS1sRsdDG7W9iAOs8dGjHsIB63AFAeSQUmizYtopfSmY1FPLltyyJblMyUJR0lCaPDQlwaTJMC9ZzD0e84%2FJxMkyHapRl9RtC%2FpMBzzuSe1h4OPaAKgDP%2FwdCoHarJsF5Xa78%2BixKil0qAPLqbx2esSerrOmOLoopSAuu6LGExKBuCectwAJOWjAIgQguck3hfCYKpymP7VpOftCMnQ2ikYXj3nGg%2Foyjkv%2Fz%2BOv5CZMOyXThcHc4TIvjcSfKMp0WpyiGK%2BTxqWVUaAHPTwtJ%2FrLuzX0lZFT6TQnol%2FSPZN103LhuHx3T%2BJNk3mbu94tkaSAsp6voqfs6OMEl88Ft3RWNv3mr4q6pKbexKrD8%2BpTpDvO7K40vDvr68oJeyhtzlOcQ13nUuc51PYuQatfPZYzmeVMup2Sb6ck3CgZN0nKPZNzo4TsLjH76NEObrXzku0zcXvr4Z4SuYMH9C4RvUtIjxLTowT1JFG9VfouNYqT8ukHrejO3Vnz%2FyRbisBvifBbQnySGH8qttcl54XHfKL%2BvfKBx%2FzgNQ%2B38b%2FR80HPfkq2n5Luj%2BT7%2FiNB%2FkiULxLWD4X36BZRyjJR0Sd40EJ4QmV4fuF73yF%2FKEF%2FUEF73tZwefdwM8d%2BkuN8EgV9MyV9mUd9YucjUfRKDkgSEEgS9icS%2BCcS%2BicS%2FBcR%2FtcSrkcSsNcSsjd8Enh84UduuOcSuvd%2F8EeCioc1jKc2jscukNce5ZeB51dxlleA6neAGAg77vdIQYh9Q4g3Rag4R9gwSeggS9hxTfh8T9iBBuguCNhzCmh9iJd4Xbd4W%2BcrFPh4eneB70R5Tph%2BSDd9WLKGInh9VpOFmLOFqtOFXleHYDeFPzeGG1iGRueB6weCk0cZwZAAbYh1b0iEcegZc4iEiBh5iig%2F%2Fxo4gBz4iGf4MGm4eX6oG5V4iR4hiLhDiMpjiEzzhS0ieec0dgKILgRohlGIhqEIQVXITHoSDIBoN7CIPbKoPrTINrYoMrioU4xIio54d5AohZKYi3%2FoiiU4Eic4EikYESsYES0YES8IETGYEjM4EjWoFL1oir%2BIisEIQ8NIb1cYiJmohZvoF%2BMIEeUIEef4EOmIEusoEu2IEjfIfTkIfrHSgy3xgzIIgCTBgL3RjSLxjSIRjhDRjw%2Fxjw8RkAsxkCRRkBFxkCSRkPW3kPm3g6vnkCkBkeookSNBkV6Sj4O4j%2BfRiV74iUoYjRM3jbxYitZ4ii2Tiu23inFBk5dhkf8RgZEqoZL3p5OHaIGJeIe66HTV2HjXCIzZKI0LOIJYaJOxiJMIIpW1yJNg6JNMh4dkqIcVaFHz2Eb1%2BHb3iIxiqYxkiSJm6YxoeYtxaYVAmTDvOJTxWJR%2FqUxzuXvFeIyWk4z4s4wK1IyM84xCpJZ%2Bx5aN6JZ0CFRd%2BZNfyZi245gYBJkqJJmsQ5mJEoaLiJnUqJmeyJl9aJXbeIlMCRFOCREa%2BRAcuRAeuRAgqRAiORIkCREmORIoGYE20pBGCTmJCYSH14a1%2BRC3%2BRZQqYJ7OZl9CY2HaY%2BBeTKDqZVE6TTLSYVISS%2BgaT2iiUOkeUamyTyoeSqqKYrdiTTfaYT%2FWymPnbmWbEib6VlF63lI7ck%2B74lTltl884k29cmF92mY%2BXmZ%2Bwmd%2FVlH%2F0lMAcpAAyou8dl5B4o4CVqICyqe29l2zRmRxWiJ%2FHmXj5mXR3Kdp5mdlRmiirmhqNOhs%2FihbjOe0DOiMVmXjYmio6mig8Ki7umiqVmg5seaQZmV9hmeNwqjPqijBCmTIqGUQRKhlTSh7FahLHShEWekTIikgimU4FmYINqgBrqArVgWBGADKoVyIfCmJUAWGvADKXAvVipLWHp2WppGXCo0GSpDo5ikrrmTsKlK5VkxxxgCuIAP%2BsAKFfED8oAP%2BMAPWwAAP5AO%2BkAPezZQ2zaoQeqj%2F3xKpPDppWIIpt4ppktKpk1qpkf6oBtxCfRQBGGAD5U6q3ygBnLwAh0lDj8QCvRQAtq2K0AaKkI6k2J1EB%2FUVX00EMqalk5KojKKPDTKjDbqODgKP1A6klIaEVXDAfLwZhoQAhUBCevwAsAKAM4GAErQD1MQrNoyrP1SrCLRDfRar%2FSKDpNGEP8TDvQaDj5YDP3ak8%2B6o9GKPtMamdXqOtcqjIc6M4B4W7gwDOvAB%2F40DPsQqaHgACWGXATQsR6rAcEAquaTp7OnHkwgrxABDkEgAifQsi1rAjRQBZ0QEt%2BjDlAgAiJgCKB6DXqAs0cgsvb2E0DrUN4QqG7BDkzBDv%2BeijUsOZNYMbRdVAyIAQ7DKRZgGVz4sA5TMAeUSgCHkFRy0A9ssLFzAABTwApom7a2wAu30LZu%2B7ZwG7dyO7dxGwuxQLd4m7d6ewt2u7d%2B67dsawSZwLZ%2Fi7e8YAsogACKu7iMqwe80LeF27a8sAMIYABiQLiFGwt6YAAGwAK8gLmRG7m8kAWSALqhe7p8e7eou7qQu7qnywt0QAem67p%2F27q0m7mqe7uFywuSkAWzq7t5a7vAu7ex8LvDK7e8UAkmuhFNdQkAAG2hgBHQ61t5BgT8oAZw5gDaq70gqw7l8L3gG77iO77kW77iKxgnYb7qu77riw62wBLsG7%2FyC77%2FJ%2Bu986u%2B6gAOLaC4FoCzOKsAiusBz2AT4etV5vtVQaC4eMAO49tVBezADsGzPmu%2FD0zB94u%2FQnvBGky%2Bt1C0G%2FzBDpEN6QvCG4y0gMDAJKzB7gu%2FKXy%2F6OANN9HCF6wOTyvDLlwMUmvD90sUOhy%2F6mCMHaEB0fa88AAJGhAI7aoB8nAJGkAPb7YF%2FaAEWXWnoUeyOLinD7G%2FCHAF5tCvhiABijsJ6iAbaSUNz4ANf3YQ6uAO2PAM4TAPCYwAfeAUf7bG6PAMz%2BBV7tANz9ANWuEMxWAO4eCv6LDGaRUUeGzHovOn71ewCHSwpZmwzrOw9NiwVHO1AHAI%2FHAIl8AP%2F0rQAOIgD2oQCvtQBAAQCvjAB9YgDifHqcK6tPEKtQihxV0wD12VVicQxmPcVYuQBB6wASLwBKVwGu5QC0kgAhswA4sQx30wD6sQBEEQB6kQBBvgAUkgDOFQBiewASqQBwRxDY0AzV2wxnkAzaUwCTlQzUcwzItMqqt5lYCXRHv4gbFZfbPJEQ5wCOkgDmNgES%2FACutgDZWaXJewDsPwAywny8FnxQqJxQtBy%2BowyN1ACGAsAb6gDn1VBYyruBLQByGhDqkgAotrAAgAxnJsD5uguBsgASStuC2QA5y7uHkQWJtrADOgDvFQBSSdA5W7uBsgDAqNDsH5FdtakrsYpv9KqqBMaq0DixIwGaU8%2BrwGZxEOMNXPGwB2GtTzx9Ap6dAKocXcrAIqINIl%2FQfuAFp%2FsLgtUAW5rLibEBQzwL9VUAUbsLh9gNKLawFQcAQA7NJVoMUtYA48q7g5gNNX4NNVIASLGwfPOtQRUbULUZwicZwoWJ3%2B2LT955JOna3CWdQPQaWYQcULDa88g7IQocUbrbgiMAlnbQttDQVv%2FAxxjQA54A6pYNKLMA%2FzsAkLoLh3ndKKawj24A48jQAm8Ax4jQAW8AzcoAeEbdj86wnz4A5xDAWNzciAaar0iapKrapMzapf6qqfJ9rax9XIyXVSocUncAQ74AEeYNIIkNv%2FlcC%2FtRAU8QDcy70ILl3IBDHbv63SeewOSaC4UMBVtQDGG8Dczk3b0I0AQWDfbkDg1%2B3O8qndCMrdHrrUCtvUJPHU2hrV6KnVD2jele3VCUHL9qAO0oANtTDbMFAO840AItANHy0MFlDSwqDfCHDTBEHdvp3cJxAOazzgCBAHBo7gCv7c8XDYCNAFThEPZSDh5Efh9vZVBVEuVl7IXhV3koWVsIydhYpRsqkbmNyjnSrPOSni6EDLTtFV89AHKo0NMe4B2FDjNy4BOa64PF7IzAzkNC7gimvk6nDgCJDgza3kTO7k%2BBrlCGDdU87hBuEO4bAKqVDpz5BW6HAs6vAM%2F5UO1OogDJ2Oop%2BeCp5QCV5OP1tOnTaS6vRsqGOelGUemmrujSQOjpa9kaadxYr7BcP9Z%2FPA6Bsg5329CbY8D2ld6N0wCQF86eqADR7w48B9An9O5IJO6Ia%2B4IW95Iqr6FAu5eKD3dy6CDPAAIvrAV1w6cfiDoaguGUQD9re5EltEPHQBdse79KK4QQxyISMEJteC7UgDLg5HGs86wpRDrbg77Ww79hIGWu8I6me5QkB8Y%2Ft2VZ7nvZjpYYMaBKfENO5EEZiyASPf1osBItgCIawCFxg0jkADrYw2y2wCcIwCWRd4M9Q1whQBd2ADfQO7Yor7UMe6Ede6EnO4O%2FO7f%2BM7ujfTuUzGeGpbdyp0FjouO4I0O5Fb%2B%2BFcQWcywVW%2F8gY%2Fukz0AIzkMcI0e03r3lRIel%2FUAsEXxe2INIMkAprjxCyohfCEAzB0CDdYPcAf8d2%2FwwL8Qx23w0f%2FpyIR0cqPgmIPwmUIAx47MfSWesZuS6fPgmLAPd8k%2BsP3fSMuwiaRgnwDd8iANTusPMyTtY8jwA%2BD%2BhFHvTXjuj1vujeLkDgHpJwrtJV4AazveO2AB%2B3DBrqzu7unuiKVRAQr8dlIAIecAa1MfAE0az3Hu%2BDDsB4TlBQzrlIrxAroQ6bENelEPcGYfA2b%2FmR2CSTIAHmLwbXEOmLYP45sOjmr%2FX%2BCSHg5p8H9g7ZER%2FrIV52hNDS%2FLsBFgAQKv64Q1fQoEFvtg4uZNjQ4cODwLI5dIfIAIIZEDU%2BjGJM3UaQBlUgIFmypAdC6srdUrdopMkcqT4WvFLSwIkjCAzksbeJpIhu6twdMWDATTx1tUhKeMZNz8UZ6uJVKdolHrp4ZYo6IRgSojswmrp61ajumQiSOYLFu9qFpAE97NAJ7VbKkzR1M90ZIlmGbU0EXdxJe9bNYLdnhQ8%2Fk4buWTBaCgsSrLUJm7twicORBRkPEKCrG5NKQGBB2MyD7txYsMBlbF7YBSV280Ay1diCsRfmNci7oe6C5Wy12LBhFWrYqHcD9%2Br%2BThMY3JzJuoNSEsQv1O4WkYSB1S2CKqEXugtC0o54jbfKSWd%2FUF0zBwDkz6df3%2F59%2FAASNFNONt4fkwJEwI7%2BEJKsPQQloggRklpAkCOPHmSok0kqtLDCTZ4haCV03OnGEDJCXCSc19SZJMQ4nhGmwtOewTC3VCr05aNuLDTHGVoq9GQuWSqs5aOkKjxOwsnCik5CdwBEQAJZQlMHGxVyIKOScj5y4wSSPEjCF4L26usvksgQRgQPZgjKHS466EAwdaRpwQMRnnGjAw%2FKIEgdT3IgTQQyzlCTkCMf9Aw0kEYr7bSGpAkmmGdy8zCVUmQh0R2JlEELgU3CMWeycIL%2BKQUv1MLpphsS0alFUtzykqaUYEpFRzhhFt1sLnWEKaWURlP1sJRaSCzwq%2BcCJXI3YSwwCZGxtCMpo3i%2BC485d5JgrQ%2F0aC2Ql%2FVy821Yh96LLz9ww7Vvv187I2QpKK64IgjSlsxlprzckTeh3ngTCkjf7u1N3gLj3XYyYryZi1%2BD3KFkhhmuUE4od8oFqSOH2ZN3YoobDu4WR9mKx%2BLxNI7XYoZfI3gyedEpxpmRGUZuZCLBEovbgqZalqFnpMIWneoCPOFHLxHwKx7AulCnBZI8weylFkjcDoEW1OGCJC423qTdktqlFmasPqu221pIM61Ad%2BwwwQQyGu6GCxX%2BFFiyhS6eWaYREdRGAM5NGv6jBWNFSGJI7UQQwQ5CZpBAghYM6codYaBAy4IW8phLuBlM2FmoTXTYgKQNZjAE3me4WFwFN8KJeLxgsXYoHjsCDCK7pZn97gp7upEFm22fqaUWbPY1VZaglLNF07xs99V09%2BAT93hxyW0vnnMR2KCbedhqHoE%2FrvKwFkMMqeUYYgyyvRZ0hFmkV2FqmRGdUrSnVXxKNEztmVIISaUb8cLxpRJaPPTEkBln6uZ2YRQsHKsghCc0NDqHQIx4GuHQAjVyMgd%2BxUhYc4cTSCKY3RTkFuzgy5LKYIjyIOAIUungz4JmjzKQxA32KAUDllL%2Fi3kA5gz2%2BI5V0BFCD%2FThDzkoydVgNqit%2FaZrhypQVooChaskQUAGOEIxGnERmywChQKygEx6hhYoImABk2hYMIgWIMEI53IISEU8PGEsARnOLDMQ0BNEFxLnQCeCuQkHG0VIGgn8aDKt8w5JqhCHtIkACrW40xVa0AJAzSUccZiBBRRggiPcZi7CYIEKoCCMJIiAASooQ1Ac6C3khRI%2FymMP8zBXs7nQhiR5QIohVNAuCXhADJNJggQs0IXaLMAQOojlJEIogScIowtoFMHmDOKG2jSIEDCSwAKS0IdLSaAKotPO4HIwmU7kQG4b6MIbOaPAOTKkgeFkCATJOZ4J%2FsIsHC%2Fxi0PUkxOf5cMe5sBSHudRQjAFxh6eIIkOwmaSzRGNAamg4QXnMUQESHEe0jABSXzILSAWaohfY0hWSAKFeZSiQZ6ohR3kVolVDKFdOjiCLFLRLij8AZ46wEoHEaACO7hhjM8KYQv6UIZ2TaIdtkhmKuaRszLUohQhXJ07AHOCPKyGJAOBY%2Bnm6A6fLEkWX2xnh%2FjYLJIYK4si4Fl5DHCeJ%2B1AQBLoQ8NqobYNeCCLBqiCsIgESlHGdT6klI4pnQe9eMxjakvtiYCWKi94mqQUbFSABLLovADlUSgpFJAdGpaKrArIDfLiozvOKKAkmAOBCwHnOS%2Fm2YWY%2FxO0HUont9QRwraOp2G8wAaWEACFMsT2JZOwBz6BZtBuLO4ZSpRbFYbougvaY2kn8ORQHBpEBEVUNBNF1EIs%2Blp7TIIkAglGSyaRClt4wxyXWkX0qnBRe9hjaLa5Z5aCMQ97AKYK8zip84SRj3ykDjw77Wk8dHBRSiDmD6wyy%2BUkkAr4ShcBq2uqHJ%2BaMyHMgwwkIe5HlIWRPi4rDl1o1wiNOyCkKHFJSSiDay2winggFAFXsIMdN4BK4sFVrnGlK2fsKoEyxGHCY1RALeLhhIsEYROb4CECkgDYkhwBCkdAhx0lEIdOaBgBIliEIZLZh4OikQydwOmh4gHZBi1iEv4vyYFQ%2BFhkkhxhE4QY4yLcmsAIjXacoxUtaF125rp%2BFyMLM8QipMHaSxWlKG8hRG2%2FdNvAbEzOeRhJEHg4AzeQ5AxsqaE9GISAG8wkHolGwEOHpdyyMLeIjMWoL6hGuC4YjRjZyC1JSkGQHg8hpiVepZ8R0GWsMDYH7hCwCGQcB8C0ABw8JS8ZsriBIOThGRvjp%2FPcIGMyoBXFGokjnCVklmRKEaFmturMsLrkZ8xjHvK1wFrgaYeDyo2V8XjGF50Q4naRIR72aG%2BNNysdFa84lC32z%2FT8SoaPrMgOz7CHOxh7BCC%2FOi%2BGsWMS0EuJkig0hDyJA0mCEF57yPkP7P5dik%2Ft0TwaeHlZliWJCcIR3g5CwdmcTTNo1wzaNnv2zRTMQ1aD0RWz7EkP4LhUErrAhS6EqAuLKK%2FP8mkVWi%2BLNHZIoQWwtACZXLsLws0S7ToET0sTCdMQMRRFnctppOQBjSYJQnZLjYBTf10ne9YJ7DoI6werQB1KGvueDbABbPCajO54RghN0gEoF7vtUGTKZps9x%2F9gThjmqCNJhODgqzrrKv0t2jy%2BbQ8lqeCN8ehDg9Dh6SWdmvGKXWC85X08envFrgLygBt481g7DOEEcgP4hY8yFzBTb2MClkB1T%2BtQewiBwVDgvR27QPG5nensGsdIzzzAeyiEUPLfLP%2B5Z9XBC4%2B5R2NIMV3Kz7lymKkD8yKkXxJLogd19NgO8nRHHhaBKtsGDSliJ6PeEdBgpR%2B0XRM%2F6BijLqGpP6TqzT3Ic0WuDnuQkxwYI50QA3L4ulNbp2WpAt5TlyowhJ5DOwFrmg7aAOSrgiuoAjLYtZ6SClqDgrQpiRPTqNKAAgbEwCroAk%2FaiL%2Bbox6TgBM4ARVAI8V6MOAascVDQMczD3toOB87nKWRAGEQBq%2Bpmc3ToxQzns%2BbN%2F5YnuY5sj%2Fogz4wIJgTBh7aMzRqvW8TDzsys6BjGtG5vUqbh%2Ft6Cz3TiRy4sizBi57pMhvsmb3TiROYFa%2ForOubhCZwQC7%2FmoxJwMAMnIR3CwnrIyfsgxnVKIkZIIM4KMMBs4V2oDQLWIRn8EF7Sr8Lsh45e7%2FMIMDUUrqrKEMYswPXqjTkWh6tkagijJ7pcwf%2FC7FFsAOee4ZNCKEdOEDuih54IoN8iB5DmARfIJHh65AJNBEGA0B7qIVF%2BBTh6MBJQIROMhWtKxrMM43wEh8D2hSQaMHOKwWq8Su%2FsMEIu4IcvBRP2MEB6UGHk7Th6hSvOY0jDESy8LwlBJfQCwm7eh5V5JiCCKEcyANZoDQtNA8uJAkvnMAwDCEoC6EjyAM7sIM86APzcwcs8wA2HL437KATaEiHhEhDkA47JCcjeguuoCUo%2FzKAOChF9hjEcCpE01IHwBAQFRAGbCm3qimJsomHDlI3mQm0aiOJH1MHsSKJPYyHp0GAqFGHVNg6knAhUsSa%2FOMaPLqCEJlKMoBATqOhixCB%2BemGnGkCW1QhRBCG5tmARfiQpfAEV5NAy5OGZOIC2%2FmiJzgHuUuFcBCBouACbKgLY1GA2yjDIxCGZxCCi8gBOmQ2p1ogNFkKD1jMxUSjE5CGeEi8BukGVtyrPIqHx6M9GJKXnAkCd9C0d%2Bw8JZzH5GnCUhrLZeuNZ9hLXwivfwu48zCILpQXg8wLhLQHSksCiJMxSZTINRQKi2wdqFrD8JoENzAEWfDI5gNJSvuJ3v95hmQSSKxRyacqrexDhzi4lKXYEndQD3cIhh7LKnzrEERgjclyh2GyADuZJBGYFnmJA9ZogeIiA9b4AoLYJ8uxgL8pw%2FsTlFNcrm40CSaaoteaB2FIJgnYABqsBG9whyGwiUlAhy9yHrUxgCRoqWVxMAGTvCQpCQuApVJgh7mcBx90ng1olyQQCkqApa3bw2w8TNOBtjDpBmmQhm0oBj0oiT6TzIsqHzu6pgs7D2y4lBmYhFJYMJKAQNB8Bv9CwhgdTdKkR9OsK9Tsl9VUoWdYhEsJSAyTTYKkzQY5SIeaB1lol6BqHgMgBOCjSOBMC%2BKLinCAgTArBUowgSOCR3T%2F%2BMhwmrQAMZrhNInYdBSK%2BQ2KWRh3uIZrGNTrs04KwoYL%2BZGPUA%2FYKwUL4T%2FEUAx0uFTD8J7E2NRLdbqCQIzIaBPkTAVG6YbcWyWUrKv%2FzLQTHRxYhVUowM3BaSt3KIXw%2FIlFWIZsqKaSmLhaeNCqqQLa2YvB0QENHZwZ2Iwkic6X4iLhOIHBkSRkCpAhQKW%2BMQkPYKoCGzmJcanbgI1rKIYfBcdry6p22SJ5EdbzgMMAgYK8WNK9dFKskccoHZcpdbE%2FuIi%2BcwhGJMAlox%2FdM0nx%2BKKCnC4x3YmN6YLD8skOwbINqMgMfbDuoLUARQATSM2HWc49bU6B5FNADQ3E%2F7GDJLA5T9iWvEiFMyjZMlgFkEmFP8ADSpiEJ6gCQFzUl%2FmkQjUISRVUfdQWeGEO4EgO91CHbCAGuhujJzAMT7gUSvBWe2xVjQiHWFkUq7XamlEURpkM9MmeXtQQBUHK7JmERsmLTvBamfCfRQmgUF3bgsnSsb2MV7GFqp0Vumuy7EkF2JsMF8me3pwOGK1X3RuwhXCGa0idwooRa0NSMpjQDTCcp1NVq5rQ0uimeCWNDXBH6FwSes0%2BKL3X%2B6jHbFwEyYEBjc0NX7A7gcgBGSyFqRgbbkUHIRgbLoKqsQmCMISCsVGjRWqorFLBeI1BM%2FGysUlRWhsbIhPGFpAbCf%2FQAZdVTjzFP0qTVhGyzSVxrUCVqQB5AlRSh27IxKUog7kISQ8gDQOANUJk1HPq2dHKBmCYCyUTgRBcMrxwSqkti%2BTIX3z5l5CxGAUZGJbZ2XrhX%2F4V4JUQWgF2jwTu1gi6nVpITWdwhv%2B5HWmY4GCYi%2B8RFUP4gz8QhrEonwfWixrhYEPw4JkIh0q4nVkJBwcuzHr9XNCtD9EFCVEZFapDh1VIhflxh2ywBVJBhxouzBrGxkz94YII4twgNx02VX3sBltgBoMwh1GZFSk24g4JhyUGn%2BjNU44FPEobAqI5MWyojRYIoXaVryWJTtzNiyuAIgsgQMEAWZtgJZyFWpj%2FYV%2FQct%2B5wAa7g6IW2IQthoinJKf%2FVTOMGa0OCdx6ZQ50iGBr2V%2BgjZeNWRgEZoufRQdeIOBALhQYjuG5yld4%2B5duiQ1vIAbk6BdKpuTlYGR1GLWifeWiZWSy0FMvvqic2QQBqwILGhADRaMkqIVuYCwEyIN50LsuAMyc%2Ba95aM4g8AQ7qK46RmR0wGPP0mNF8oQ4cANtngTKJJ5BDqdCNrlDHi1tBC1HlmZqJid79WT9AOVzohdpDmfQouUIAtkqUJJsJglC2GU7gLyfuAypeIJ%2BUjA35Q07KgPcFLxJVjn1Jad0JidrHphV3GRBvt9zkudzOrnrU2RyOmdEfug5%2F1pnT57hCIJnRMboc6JnBwJZKJCFBUAAHeChPNKwfpYvgIuZDpqBCvqSmMnNhH4pb2LonB0tkJ6jiAatb54jlA4njSZEjg4njybqbAEtkY5hknYgkx6tpQ4nlV4gkHUCdMASBVAbFUAHmrYHmwbCjQOq0ABZ3ZzeFRRqO%2BaWoo6go%2FaspI6grY6gpl7Jp56jqAatuhbNb2FnGXZncspq0NrrCOpqb%2FZpJUMAJzDHfm45CPuIZV6WnTwCkRXWWaW0jEBklvSswV6guz6nvHYgxl6gvn6qv46gwCbtqXa%2BTmbnq14gxfas1V4gxzYdt7YHy%2Barb5uHVRA3oViFZEJoJf%2BJRNpsF0P4aSQS7YYOp9ImntMGSYsm5IlA5NaOoHL2rNhe39k%2Bp6oG3dsmnty%2B6O1G5N52ytzMqJIYKMyUzsHFiCAYoxPI2i9iAB3gpbQIB5ae65aZ7jmqbtO57j3NbnBeb3GW5u8%2Bp%2FB26PFW59oeacQOp%2FTWbmnmYoquK61gonj4ujmMhyAoipP0XrsTwbrpkFWg3GX5ESOyUAFHEgKPIAPHGgQHPAVXagb3rO52oAfvaGfY8Bs3rQq36gufowxf8A1vb0NsBCSAgj7ICzvgvTzIizzgvT1Uh3D4gyBQARVIxFx4DWywgxwAc0QrrkWoAiTAgxl%2FkNEWb2nO8Xr%2F3nG97vGMHmc3e20HinDqnvBwKu97PW%2FTWXIeb%2FIuDmno0wtLngy2WBkuZ9b%2BEAog3gzqcxREdfAad6Ai5xY6X2k7V208J6cfR0w%2BXyA%2FL3BAD%2BkjN%2B8kL%2BkD0epRJycnh5lSXyDq9O5NX6BOH5ZP9%2BpQX6DdNp1bN50gh%2BohR%2BdVjyCRdoAfePZnTwH5eIEt%2BAH6oHZrH6VXx%2BpYX%2BxZ5%2BpE52s9R7lkJ%2BddJ55eJ5Jf9%2BZgJ55hx5pip6BTJ55Ut%2FFl%2F6QK%2FwF%2F4Ad%2BwId%2BOAQAUIJ7uAd9CAT5mIKBL3ht73D2MPQ7R3SG54x4n85yd7NzN510l5B19%2B12N513%2F7f1cd9oAxuteuf0eyfs%2FNAAJVCCIggFerABArAGawiBQ9CHF4j5mYcEfHiB0N123O523f72Oap1bpl4mMl1IL94rMn4B9l4%2ByWUkxZ6BzL6YTl2wK54wT75JCzs%2FAgBeJADAEgBfAD4IuiHLQgBfDB4JTD7%2ByCAZnjzB%2FGG941ngZHmjoD79qD6YSl54gELUMD79mB6BHH6H%2Bp4rPn4og95QgSFkTdnrCdtB291ALgEcYiPHuCHOQCAy1cDG%2BAHsP8BzweAF5gC0if9LaCFCE591V991m9913f9YoiF15992q99Z4iFk7F93d99JniFbNh94Kd92Q9%2B4m99W7CF4v9P%2FtTPhiyQhN9X%2FuQffugv%2FmLghekv%2FmygAzp4%2FusHfl7I%2Fe4HfukPf9vPBknIAu4n%2F9o%2FfvXf%2FfFv%2F9fPBlpIgHARezWQD9AH%2B86Xg%2F0HgPwHCAA%2F%2BBAkGKgYsmIKFzJs6PAhRIfAYkWsaPFisVi2MHLsWMxIJo8iK1IcabIhr1snVxZblkXSMpYnYwGTadJWSZsel9GhE1OnR41APU4c2nGZpCw%2FjV7kxYspx5xQIyKjlQAA1qxaAajBlwJrDH58BPIL80IsgCL8xmzN2swdurhy59Kta%2FduXW%2FA8PLt6xcdMG9%2FBxNGF8UY3MKK795a7LiuM2ePJ6NzBwZUYsr%2Bi2%2BV0%2Bw4217PiuMBAhRPtOLAqAuXa7x6sDtQYDK%2F7hu59mDXuPm6a%2Bag7VZW1ghg1QAvFIAw%2FX44kIdcORDgCZqp293Xmy3rfYFl0873cHXvdVuLv1tMcnm6ljXRTo%2BOs%2Fu5oOPLJW2aflzu%2BNGRx%2B9O02z73bYffPSp4xtwWTmwDnJZHbLPJesM89sh%2BlwCz4TSUbcfdvsB1t1%2B4OHXH37n7bdee%2BkVSN98%2BNl3Gn76jahbfP8FiN%2BA%2BK3o3oG%2FJQiAA5BsoZUDfAxzyVdAGolkgtOFR1%2BH%2B8mIn4j0kUifif6BwR6BneHXIn0vSgmilTS6Z2OK5eVI347p9fj%2BI5xxavhkfFHGSCZ9VcZ3ZXxZ0odil%2FuBGZ%2BYd%2B7HZ3poCoiejl7G96ackcbpJIfZjemhnu4hmp6fNW6Zpnhtpjeoe4XSN%2BWeZiYKIKjerRmfqOJBKimtbVGKn52n4hlfpultWl6nZ34a6JehhVkajLoeqmp5iuLIKJuO8ohgrdVmdSuUlhoaojF0%2BsossNAKy2WjghpLKLKXzngiq4t6GKt3s1pbK7Z1aqsst96W96t4wSY6bLnF7mdqfKhqCq53ztL3qnvwaifvvJLW616uBe%2FqXq%2F7Iuydv80CHK25A6e7bZns3riwuA1L6ya1EdM6cXoVu2cwxt2uu1%2FH4gH%2FGjCL55Y6Mr4l%2B9fus%2B%2BuXB7ELk%2B6Ia73WoypzUKXmLLH5IIssItAP33zn0SjbDR%2BSSv9I8zlyZwezellLB6%2FHFOt88ewHl0eqekRPPPFGpvcqnYMqzh3vC2PvbS%2BZjuNN9SFe9e2djknHLfKIWd9H8mp7u0usY8KPjjZTGfrYdrlrb34xo2%2F%2FbjVckt%2BLOVBWz70yfH5XZ7D1onN%2BVZli3d2eaGLN7p2jFvnuHY7X92zyK1vLXWNXst%2Bune173Y77td6bi%2FoeYse9etTnwj536ujqzziXDcfu3uzhwr4w5tXn%2Fv1FB%2BOtva%2Fc3%2Bwh8RbZ7zqWLOe7PK6dz6%2BWUd9%2FtFjn%2B3c9z7rKc47vBOP77wDPOsIbzf62w3%2FIue%2F8QGwfMw7k%2FPSBz3tSA831Huf7hw4v97VT4L3%2B1b%2BRohB8NEOgdapW3nuRr9lXa5omZuWjxZoq%2FjFbIUQbKF2JribCuLmgrjJYPg2%2BDPy7dB8IERfegxIQhuaUIFCTKF2HuidCCbxhXrDmQyfSMP1iW%2BKHaziB1eFRTWlETclrM0JqwdG64hRO2S0jhJxw8TaOLE2UKxhG%2B2mNQ8K8IoE3I0WrXPH1%2BQRd3vcTR%2Bt88fdBLI2g3xNIV9zSDZKUZFUZCEPYfdI3ERyN5NcTSU5d0ncZHI3m8RNJ1%2FzydWEcjWj%2FjxgInO4SDg2Uo6rrE0r7chFPHpxgbOsTS1xc8va5HI1u0RNL1Hzyy0GUzw6RKUVjYk5ngFRiHOqVPYSF05O1VGUawRmKYV5yiOmsmtzFE8ya%2FNK1MRycM98TTRrM83XVBM11xRNNkWzTUkuszY49OYwwRnHZoUwi%2B18zT5F08%2Bx%2FXM1AX3NQFdTUNEc1DMJ9cxCXdnQ1zzUO9%2Bk5zp1VlE6gs1AzUQhEQ2XznzFtF8X1eY7uRlPiM5zjEhcYukwOFN8%2FhQ1GfXMRpXWUdR8dDUhRc1IPVNSzZxUMylVZjddGlGYTlSm93RVU0XzVM1E1WVTFU1VUXNV0WRVM1ul%2F0xXKfNVfa50NS3VzkuNWs8BjvN45TQn%2FBoYRiMKlqdl9en3UqdB5E3ujRItJkXP2re0ematlGlrxN7qmbiKZq6eqStl7jqZvE5mrxjtK2r%2Bap3A%2BvGogkzqE5eK1ppqLoiIxYpoNUNaz5hWM6idjGofw9rHuHY1nqWMbHdDW03a1pO4NaRuN8vbw%2F4WuDndHWNrq87Hui2yx3xtWAE71saSd3%2FZLSBnNfPcx4B2XsGlzHA1U1zKHPcxyXXMch3TXKfCVjTRxc10bVldXV5XlO%2BFZHwpM1%2FH1Nda951Mfimz38n01zH%2FXUyAFzNgtRbYMweuTYKluWBrNtiXD2ZlhP4nM%2BHFVLhaF35Mhiez4cd0eDEfVkyIFTPizpZYMyd%2BTYoFumKDtlibL0ZmjB8zY8VQLwWXuPKVh5QCSFw5FD8AUiCOlKQhKpaP4aXueDEbLvP%2B0D1HXk2SQbpkkjZZoU9%2BTT7Ra1PfbsUG4vjzOv4xlin0Ix3iWIcSAFChCGWIzOhUF5XMyLY6IzTKIg4qQ9M72%2FWKt6fFu%2FNq8uzcIk%2FmhAQggANYkSE%2ByCMExAGABpyTnH4UATgE%2BK4KdxrpMt82hmwmp5t9ZkrLklXNCQM1akRN4LDdFCtT0MeXARAK57Ai0TZAi1rSACQNcJvbJWjGPNwh7nGTu9zmPje6zf7tDV6ku93ufrc7iOENeNO73u5gAjXiYe99o1sdvFAHvwNe7mVEQ%2BAGd0c9wCAKfR884LwoR8MDzg1iRJzf9ShNPSq%2Bb2JwQ%2BP2Lge7yw1wj587HqIAQ8ZJDu9rXMPjI3%2B3v1%2B%2Bb5nbex7NJoA1GoTzdEBiGPoowrXlQBahT4EVRj%2B6OVrxiVGM4hNOf%2FonVHGKpbei6U5XRSumDnWot0IVXof6Kbw%2BC1pInelWP8UpRuF1prci62k3%2Byfargq1Nx3rbm97062uClrM4utPP4Xcrb71q6tdFVdvO%2BLRXnWnmz3sWtjE1AUP9a%2BPAu1PH0XXB%2F90rPud8VI%2FBS3ezv50xqfd61NPvNnr3vXCO73tis%2F60q9OC7Ib%2FvKAX7zmo856qiP%2B7mlfutlb0QZGKF3ym5%2F7JyzP%2BMznnvOdVzvaQz%2F30S%2B99Gu3u%2BibDvi5h731d8%2B83sfe%2Berjnfpb97rfMd97xf8%2B9a0YxCCKr%2Fm1Jx%2F5S8e68Tff9eejfe99F331Md31uV7qJR%2FedV%2FUud3tUV%2Fl0R7UVR4BNh%2F6ed76bV%2FeBd8gaIH8DR7dUZ3VqR3uceD%2B1V71hR0lUELZUd%2FbDaDbwZ36CeDhfR%2FcJZ%2F0bd3t%2FZ7mFR7ygWDvQeAHsl2zqUWiYUUIaAAAlAA9XELQDR1waAArdNeP2AAkQP5hghxCtFHhVoSCEWIhkTwhF2qFGoTBF2qFFY5hVmihGQrEIaRhcohhGpahGYZAg5ihDYxFGm7BkKQhK%2FAZFrLCFv7IIcDDFhJAChjhgoRCCuBDIACAEvRDHm5FqrGhFLIhJFzhGKKhGUZiGoYhG8KhGWLiGP7AGqZhGLihGXriF8ohG4oiG4aBGrDhHurhH9raMOBCVoSAPLBCCEwBP8gBzlnDlnlFE3ohHU5hGlYiG4LiF2qiGXLiG1riF4ZCCKQhK5KiKY4hKnKhKlLjKJphKaYhAcSiGfohnDSHMWJFV8gDPsSiEtADPuiDHbaFE0riOY4hMqahMnIhM46hM%2F%2BeIjRyoTRyYyte4xdmIxZuoxlWozcSJBaGIx9SITn%2BCAHYwJhhxQtsQRG8GgCkwBb8Y1bMYxpO4jF6JBXmIxbu4xf2IzaSJBQGZEJ24xh%2B4zOmIUKGIkx%2BoUyOoUPKIhZqACxI4iVQIkt2V0SOoQbY4ia%2B4kjC4jSaYRHUY0oqpRne4xiGADGGIlRyoRpI5RcSAC48JBTCwix2lw2woQOUZRq%2BwFhyoQ1o5BiiZRw2JR2uJRa2ZRo6wAuwYQjI5Ri%2BAFh210Tq5RSs4lD%2BFly%2BpVv%2BlgbYAF8C5l7u5atpwA80JucwZlZM5GFiZmIOTgj0wKsRwF5qgKsR4Q98wPv%2FnKUNBNFEroBWTGRevk8K%2FEAJKMhjjiYAhMAP0KW1pEAPzGIJ5KZW%2FKZuRsxZviYRhqaPFKcQEcBkZkUKpKZW8OZfusxz3uJjJidFnmZtOid0cud0SooDbCeQPOYfvkB34o5mfmQPzKZ6ViTn4KZcimZoZoV5bmbEgGZt%2Bshi8qVkUma1NEBthsBv4GcRRmZzCtEPpIM%2ByANDmpMS3AM%2BvGOiFcE6LOgjco4S9CJWOEAovGMo%2FAaHeuh31ooD4MI6%2BMgWRGiEftkUyIM%2BIBruvIA1RKg15KUT6gM%2BXMJv3GiONgDnEEAgRCg9CB1XqOg95OUWuOg6RIfLAGmEikOt%2FyUHPeiDOERbGExpleLOD4hDhB4CcWgAl%2BIDPyxiCPgcPnjp%2B8iBP7ihHNwDlaKlHLyjONTA%2B4TAOgzHRq5DhGpoClgDjsbj4ByCiqbDb%2FDBOwIjVhiqPiCq0kCCiorDbzjqk%2F5GkOrDMLiny4QALkQoOfqZPtCDUnoqqFaPGqijPAymtEWopZ6ao%2BoDLpjm4BTBPkSoOo7FD1SoPOThrVqo0mQoreLDHDCiO0poWuDqhf7oMFQpK7QaFRoqH6iBHKTAL%2F6AiQ4niY4BPWhocpTFFvDDK4ZBWYArVyrNC%2BACP0AqVhyCPMgBtApoOgzDDyTriEbKpirBFOADcsgBP%2F9sgRo4IgDoK7%2F6a6z%2BAyTYQCjoQ15GiBywgRxwWy5u6TDYp6T8QD%2FwgZ8Nw206B8RmrJeJQ8RyDi6kQw8EQj8k2g%2FoAyRAa60JqhLwAT9EaWVmqxi%2BQI7e6hPS7CXY7PtcQj%2FgqRLowyGoQR182SXQQxEcAj8cZpMOgzVAqxpMJD8cQhEkIQBcm9RSbZNawzBA6xicmtZyLXOOaRHgQ1ZGzCXggxKk6JCY6A%2Bc7VewrdtyTg%2FsQ8EOQ8Q6gDjgArSKYYbOwbMt4uCkgByw66ZmZLL%2BwLJqAAEc7rL6p6QILuHiw5fVAT48a7ROa7XCpiICAKENYXeFAjA2ZViMxRb%2F0BrnbIGF4AORhsKJEoA4PCHrOgABpMNVugze2i26AgAuXGpT%2FgA%2FaBsbJO3gEEAY5KHW6q44AIk8BCUuiAOqLS%2FnvAAfTGPp1towsEIJbGEjDmYgIKzLSCZxMC3n9sNgCmoIbK%2BiCePgvEBeToE%2FJFoY4EMRJAnOYWwiAu7gNECy4oMYKketXYI8OEDpRgcAw%2BrgJKk44Gmc%2FkCSLMgThgWRjk2sHUIKQABW6GtZssI6EAAGA4AGz2uC4GIgpICPiDAJJ%2Bo%2B5KUr5K7SxFpQimZ43sMUFoEjaoAMp4XAjk2QknARbqTqnnD6TiPTSuy8aMA6jEUK6MMidm4JKPH4%2F3pupq7D6oauRe4D6Zpu9fguG6SFt0Kh6%2BKDOkICAdAw3%2FZDg1qLDdjAC%2BiD0C0unlqDNTjAELsxEdMKASiBA0TIb2CAnqqjlxLaYG6BP6Aq7qgFH9QvADRA3jrA8eItUqInLghirIFx5c5arfUrzEZMCgyDPNRa8H4ZBqcBP4DyKFcPHyQhcUACP6jjpRoHcsTaHI4NH4jDvYqhy8YAAHRvCvDBPpRlIKQw56SAPKgB6BJHKKwyPrxqCNxwIpattfiuPNwDgwKAo36Fo4aAoFozPrDnvAABMsPDkHizOoIzNd%2FDNBat49YKze7uEQNADVhx1fbiC8DztQGqy0wb6%2F%2FiQvsiM4yGgiB68DpYa7VAAqECgDe%2FolqEwbUhdBePzSWgK85RshgnNCPmMOfQ8Cv6bgQjVpAEgg2QLEaacUWf8bzMcxvDcfjG8RADANOCcKTELqxdgsUeQskCMgAIMiEPzg%2FIgzVogCLbousOQwTkbSJrbR3XCgFcQlncZijIgRSOMrjWWhpgscsYbDvr65cFbw%2BoQSmzwXKYst3mpRzk7L1eAizD2nFwzg8YbQrsw5AEAj%2FkJS9Lr%2FfCtdLOSzjCrjUkasFuwT4cQgmQ7UbSgzNXi8FugQ1sagg46mwKaglAwj1oM6bSCuIiNid3ZihYdqsB8DRe8%2BDYAD6swxT%2FAOzoxjMfnMVY2AA8D84xQ4ISJPAYh8IU%2FIA1BLQGG%2BG0CTStJCKRqkVG%2Fy7FMvQWK80K4INSdnQdOiIZczFJz4tG43BzL5AGEDbFlvGxkus%2BEOkcGzUuDEf9HnWtwHR0KiL6li4UK81Oi8NXIDLeukIDNDJR%2FyjPbjRWBF31AsAnc44c9IMNgGt06OsLKAcRAEAdCG%2F1nLVWNG8KMEjGBuXYeCU8yIGgssIPdHD3loCF44NxukyGXoIc1PbTagXTCvMUJuJNHvD77nA5a0A2UzM9pHOtmLdWhIE%2FHC0%2BnLM86LacrHFQzu4lrPEiXhsbJPEi9oC2OrT3Bu%2BG77cN%2F1yIEbrCieIOG6iv78IBFyM2P2zxcisN5XLzR1L371b0dStNYE%2Bh%2F0JhCARCrZl4YC8iVxemOmc3VgCwBjhAWtO5nccya0d5CpThtdXBWQgdH3jv%2Bt7pmGkwAdjwFCK6Bgg25yCtVL7AIeQlEJhxdaevl1dLEVzCbIbBPxQBDQ8JJNCDBoS6i8M4eAYtkKwDLnCwUra0%2BKL28JooPMiDO8JB50rbibpvorGujsfJFsDDOtQ6PlhDCdSBGAa1IwtEP4xrxBytEY7BcoDrlzUvAfRrtbOwtShBIBghthdBt%2BM3f3N1Wa60BLP6qps19HZucwSlTQ%2BOy4LyPqQAtxcqP%2F%2BswKB%2FhTU88uC4wsf68Boqx2SeqSWPze7eopoDfJtzBT%2F0wAKFAj3UQQK7dMQYxzqoASvgg8O7wrpOfPXEQD8QaYer8mCOPD%2Fk9J7%2FRgrcgzikAS7QwwssrhSzOnjLSTj2gziEgiusYbdy2cveND%2F4fCZzOD%2BsIyvggg2swKKOgTXAg4D%2BmRzImsv4Li7IwTqIQ50ncB3cwwtrPdf%2FKC7Ao1KL4THzAdIKnb4GQsZvuO3WuVr4op0Og6FOYQhgyNz%2FaLc1r%2BLiQnarshjCNR%2FggjxM9rb%2FAyuowZ02QArQAy647CIufuOPqdJMwT%2BEAuJHLOVbvoQQwDoDPu7A9SH%2BkDwAnC0f1LYRkr7pRy89WIPVt7qnX0KpPqEN6EMoQDru2LmDA0AAsMKQejzvy4HHf688nKMRX3zGfxnHA38cL1AIPDTS1yUr5O0QpkAovC7bj00K4MIjMr01sMEAYEUawDEb1DytBMKHYsUPrDAuROkLVD8ico4T4oL8D8MUcjAcu6H9W0N004oa4IIrAAQuXMN%2BACiCSxyrHgAA2GAl7lIIhhMpVrQ4ccowcaFeMLThCqLEhiAjXjR5kmEISOKsqSEAQMMhlnJeNggkbtgUlDtNpsClhOEPhJA0MAQytChPpRMDXUq5suUAAA5kDgO6lOcWjZdSMFSi8ZADr2CtxWK9GGZrVwBoIZYYKy5QWbMmHQSyZm0MQw0rcRWEydfvXJMHIXYloMaaOEgitYrj81LwRQ2swlAMcUmcKxspMWuOTJEDri0UHYr7ybBEqIQdP%2B%2FUALn13NcVZ8dW6iDpRNy2lQbgAFsvb6Ua5OotLvwigdwMlSNvTvH5xOjIYR4nTvs4dejLAUzXjh289t3bK3pvPV43d%2FTUr1OsPfG9c%2FXzv5uMDxP49%2Fu1AwIAOw%3D%3D";
var provMapCoords={	imgWidth:710,imgHeight:708,mapWidth:670,mapHeight:670,leftMargin:31,topMargin:19};
var DEFAULT_ALERT_SOUND_URL='data:audio/ogg;base64,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';
var SWF_PLAYER_URL=http+'koc-bao.googlecode.com/svn/trunk/miniplayer.swf';
var TESTBAO=-1;
try
	{
	TESTBAO=GM_info.script.description;
	TESTBAO=TESTBAO.toString().indexOf("KOC BAO");
	if(TESTBAO>-1)
		{
		TESTBAO=GM_info.script.name;
		TESTBAO=TESTBAO.toString().indexOf("Boite Outils")
	}
}
catch(e){}
try
	{
	TESTBAO=GM_getMetadata("description");
	TESTBAO=TESTBAO.toString().indexOf("KOC BAO");
	if(TESTBAO>-1)
		{
		TESTBAO=GM_getMetadata("name");
		TESTBAO=TESTBAO.toString().indexOf("Boite Outils")
	}
}
catch(e)
	{
}
if(TESTBAO>-1)
	{
	TESTBAO=sitesupport;
	TESTBAO=TESTBAO.toString().indexOf("koc-bao.com")
}

var DashboardOptions = {
	showDashboard:false,	showDashboardAttack:false,    showRP:true,    showStatus:true,    showTower:true,    TowerMin:1,    showSacrifice:true,    ShowThrone:true,	showTournoi:false,
}
var TrainOptions={Running:false,list:{},Item:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},listDis:{},DisX:{},listactif:{},listlabour:{},ascension:{},timelauch:15,unitemin:{},unitemax:{},listboost:{},UnitMixValue:75,Workers:{1:25,2:25,3:25,4:25,5:25,6:25,7:25,8:25},Keep:{1:{Food:0,Wood:0,Stone:0,Ore:0},2:{Food:0,Wood:0,Stone:0,Ore:0},3:{Food:0,Wood:0,Stone:0,Ore:0},4:{Food:0,Wood:0,Stone:0,Ore:0},5:{Food:0,Wood:0,Stone:0,Ore:0},6:{Food:0,Wood:0,Stone:0,Ore:0},7:{Food:0,Wood:0,Stone:0,Ore:0},8:{Food:0,Wood:0,Stone:0,Ore:0}},Resource:{1:true,2:true,3:true,4:true,5:true,6:true,7:true,8:true},CraftingRunning:false,CraftIntervallMin:3,CraftingActif:{221:false,3e3:false,3001:false,3002:false,3003:false,3004:false,3005:false,3006:false,3007:false,3008:false,3009:false,3010:false,3011:false,},
CraftingNb:{},CraftingNbC:{},TrainthroneCheck:false,TrainthroneSet:1,throneCheck:false,throneSet:1,doTraps:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},doCalrops:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},doSpikes:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},doXbows:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},doTrebu:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},troopType:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},keepFood:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},keepWood:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},keepStone:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},keepOre:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},AsTroops:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},AsMaxTroops:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},AsEnabled:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},AsSelectMax:{1:false,2:false,3:false,4:false,5:false,6:false,7:false,8:false},AsMax:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},}
var ThroneOptions={Active:false,AutoOff:false,Use20006:false,Use20005:false,Use20001:false,Use20002:false,nexttries:100,IntervalMin:3,RepairTime:0,Tries:0,Good:0,Bad:0,Items:[],Salvage:{},SalvageQuality:0,SalvageTriple:false,presetname:{1:'Defense',2:'',3:'',4:'',5:'',6:'',7:'',8:'',9:'',10:'',11:'',12:'',13:'',14:'',15:'',16:''},BOPresetName: {1: "Preset 1",2: "Preset 2",3: "Preset 3",4: "Preset 4",5: "Preset 5",6: "Preset 6",7: "Preset 7",8: "Preset 8"},Presets:{1:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},2:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},3:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},4:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},5:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},6:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},7:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0},8:{advisor:0,banner:0,chair:0,candelabrum:0,table:0,trophy:0,windows:0,hero:0}},}
var ApothecaryOptions = {Active:false,goldkeep:0,city:{0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[]},};
var Options={Langue:'fr',CraftUseSpeedups:false,speed1:true, speed2:true, speed3:false, speed4:false, speed5:false, speed6:false, speed7:false, speed8:false, speed10:false,MultiBrowser:true,UIDEx:'',AutoJump:false,SearchMightMin:0,SearchMightMax:9000,AutoJumpGo:false,Research:false,advThrone:true,HideMerlin:false,FoodAlertChecked:0,fchar:"Null",S2DisableLogs:true,mapInfo:true,KDODef:0,arReinforce:true,arScout:true,arAttack:true,arTransport:true,TresureChestFB:true,disableAnim:false,mailtrone:true,KDOUser:{},NewButton:false,NewButtonSelect:'',NewButtonSelect2:'',NewButtonSelect3:'',TourUnit:2,curMarchTab:"EU",AttackRunning:false,RangeSaveModeSetting:0,ThroneDeleteItems:false,enableGuardians:true,NewTab:true,NewTabURL:sitesupport,NewTabName:"Site BAO",NewTab2:true,NewTabURL2:"http://forum.koc-bao.com",NewTabName2:"Forum BAO",currentTab:null,currentTab2:"Overview1",reapprointerval:0,TSSrchFilter:0,BOTransparence:false,includeAscension:true,includeMarching:false,EnableFormation:false,showTroops:true,showEntrepot:true,showPop:false,Smiley:true,showRes:true,checktournoi:false,SelQG:null,showProduction:true,showDefense:false,encRemaining:true,pbEveryEnable:true,pbEveryMins:60,pbChatOnRight:true,pbChatOnLeft:false,pbWideMap:false,pbKillFairie:true,maxIdlePop:true,ChatLearder:true,voirRaid:false,WhisperOn:true,gmtClock:false,AttaqueOn:true,EclaireurOn:true,srcSortBy:"level",EnableRefrechRapport:false,srcMinLevel:1,srcMaxLevel:10,srcTypeSelect:1,srcaDist:0,srcDist:20,Xrenfort:0,srcScoutAmt:1,PageReport:1,Yrenfort:0,icon_chat:false,URLicon:"http://www.france-lol.fr/francelol.tools/images/ip_points.png",filAll0:'',filAll1:'',filPuissance:0,filPuissanceMax:1e6,wildType:1,citySrchFilter:0,fixPageNav:true,mistedOnly:false,hostileOnly:false,fixTower:true,enhanceARpts:true,allowAlterAR:true,enableCheckTournoi:false,HauteurBoite:700,pbWinIsOpen:false,boTrackOpen:true,ptWin2IsOpen:false,ptWinDrag:true,ptWinPos:{},ptWin2Pos:{},enableFoodWarn:false,enableFoodWarnTchat:false,EnableReduireUnit:true,foodWarnHours:8,chatEnhance:true,attackCityPicker:true,mapCoordsTop:true,dispBattleRounds:false,reportDeleteButton:true,arPageFrom:1,arPageTo:2,rptType:"alliance",rptAuto:false,
alertSound:{enabled:true,soundUrl:DEFAULT_ALERT_SOUND_URL,mklag:false,repeat:true,playLength:20,repeatDelay:.5,volume:100,alarmActive:false,expireTime:0},alertConfig:{aChat:true,raid:false,aPrefix:"**** Je suis attaque !!! **",scouting:true,wilds:true,defence:true,minTroops:1,minTroops2:2,embassy:false,Atkpreset:false,AtkReturnpreset:false,HDefpreset:false,empennage:true,marechal:true,defBoost:true,TroneRangeDebuff:true,TroneLoadDebuff:false,TroneRange:true,TroneLife:true,TroneCombatSpeed:true,mytroops:false,food:false,defense:false,MonQG:false,hq:"",sendEmail:false,emailAddress:"",token:"",sendasWhisper:false,sendtoAlly:true,showAttack:false,},URLson5:"http://koc-bao.com/sounds/chucho.ogg",URLson6:"http://koc-bao.com/sounds/allianceattack.ogg",URLson7:"http://koc-bao.com/sounds/alliancescout.ogg",AttackHorloge:"21:00:00",AttackGoHorloge:null,AttackOnOff:false,AttackUnits:{},AttackFav:{0:{0:"200K miliciens",1:0,2:2e5,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},1:{0:"200K dada",1:0,2:0,3:0,4:0,5:0,6:0,7:2e5,8:0,9:0,10:0,11:0,12:0,13:0}},AttackFromCity:0,AttackCibleX:0,AttackCibleY:0,AttackKnight:0,TournoiLigne:5,AttackFSUnits:{1:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},2:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},3:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},4:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},5:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},6:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},7:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},8:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},9:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},10:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0}},DeleteMsg:false,DeleteMsgs6:false,DeleteMsgs0:false,DeleteMsgs1:false,DeleteMsgs2:false,DeleteMsgs3:false,DeleteMsgs7:false,DeleteMsgs8:false,DeleteMsgs7X:0,DeleteMsgs7Y:0,DeleteTimerMinute:10,giftDomains:{valid:false,list:{}},giftDelete:"e",HelpRequest:true,ChatRules:true,DeleteRequest:true,ChatVIP:false,MapShowExtra:true,transportinterval:60,minwagons:1000,lasttransport:0,reassigninterval:60,lastreassign:0,RaidRunning:true,RaidReset:0,MsgInterval:1,foodreport:false,Foodstatus:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},
buildStates:{running:false,	help:true,},crestRunning:false,Crestinterval:10,CrestSlot:2,crestMarchError:0,CrestMsgInterval:24,Crest1Count:0,Crest2Count:0,crestreport:false,enhancedinbox:true,CrestLevel:0,CrestType:0,Creststatus:{34001:0,30347:0,1101:0,1102:0,1103:0,1104:0,1105:0,1106:0,1107:0,1108:0,1109:0,1110:0,1111:0,1112:0,1113:0,1114:0,1115:0,9:0,36:0,37:0,38:0,55:0,57:0,261:0,262:0,271:0,272:0,351:0,361:0,362:0,911:0,3000:0,3001:0,3002:0,3003:0,3007:0,3008:0,3009:0,3011:0,931:0,932:0},LastCrestReport:0,LastReport:0,spamconfig:{aspam:false,spamvert:"Nous recrutons, rejoignez-nous",spammins:"10",atime:2,spamstate:"a"}
,EffetRouge:[],CraftCity:{},BORac_Trp:true,BORac_Apo:true,BORac_App:true,BORac_Rea:true,BORac_Ts:true,BORac_Tra:true,BORac_Cra:true,BORac_Bui:false,BORac_Far:false,BORac_Reset:true,BORac_AutoPreset:true,BORac_Dar:false,BORac_Salvage:false,BORac_Salvage2:true,BORac_DashBoard:false,BORac_Upg:true,AllEffet:true,salvageconfig:{running:false,CityCity:0,RepairCity:0,Repairrunning:false,},TroneInverse:true,pbGoldHappy:95,pbGoldEnable:false,enhanceViewMembers:false,loginReward: false,};
var GlobalOptions={pbWatchdog:true,pbWideScreen:true,pbWideScreenStyle:"normal",autoPublishGamePopups:false,LogsAutoTs:false,LogsSalvage:false,LogsTransportAuto:false,LogsAppro:false,}
var CrestOptions={Running:false,CrestCity:0,RoundOne:false,RoundTwo:true,lastRoundTwo:0,X:0,Y:0,R1ST:0,R1MM:0,R1Scout:0,R1Pike:0,R1Sword:0,R1Arch:0,R1LC:0,R1HC:0,R1SW:0,R1Ball:0,R1Ram:0,R1Cat:0,R2ST:0,R2MM:0,R2Scout:0,R2Pike:0,R2Sword:0,R2Arch:0,R2LC:0,R2HC:0,R2SW:0,R2Ball:0,R2Ram:0,R2Cat:0}
var Colors ={ChatLeaders:'#C8C8C8',ChatVC:'#81EE81',ChatChancy:'#F8A151',ChatAtt:'#FF7D7D',ChatEcl:'#FFDD7D',ChatGlo:'#F9AAAA',};
var CrestData = new Array();if (TESTBAO==-1) return false;
function CrestFunc(a){if(a==undefined)a=CrestOptions;this.Running=true;this.active=a.active;this.CrestCity=a.CrestCity;this.RoundOne=a.RoundOne;this.RoundTwo=true;this.lastRoundTwo=0;this.X=a.X;this.Y=a.Y;this.R1ST=a.R1ST;this.R1MM=a.R1MM;this.R1Scout=a.R1Scout;this.R1Pike=a.R1Pike;this.R1Sword=a.R1Sword;this.R1Arch=a.R1Arch;this.R1LC=a.R1LC;this.R1HC=a.R1HC;this.R1SW=a.R1SW;this.R1Ball=a.R1Ball;this.R1Ram=a.R1Ram;this.R1Cat=a.R1Cat;this.R2ST=a.R2ST;this.R2MM=a.R2MM;this.R2Scout=a.R2Scout;this.R2Pike=a.R2Pike;this.R2Sword=a.R2Sword;this.R2Arch=a.R2Arch;this.R2LC=a.R2LC;this.R2HC=a.R2HC;this.R2SW=a.R2SW;this.R2Ball=a.R2Ball;this.R2Ram=a.R2Ram;this.R2Cat=a.R2Cat}
var FarmOptions={RallyClip:0,Running:false,Asc:true,MinMight:0,MaxMight:999999999,Interval:0,SendInterval:10,MaxDistance:0,Inactive:30,InactiveMax:999,DeleteReports:false,Troops:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},FarmNumber:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0},CityEnable:{1:true,2:true,3:true,4:true,5:true,6:true,7:true,8:true},CityLevel:{0:true,1:true,2:true,3:true,4:true,5:true,6:true,7:true,8:true,9:true,10:true,11:true,12:true},Diplomacy:{friendly:true,hostile:true,friendlyToThem:true,friendlyToYou:true,neutral:true,unallied:true},FarmMarches:[],farmMarches:{},Attacks:0,Checks:0,};var salvageData={salvageActive:false,UpgradeP1:false,throneSaveNum:10,ruleSet:[{"type":"any","faction":"any","conditions":[{"mustHave":"true","number":"2","effect":"Range","buffType":"e","slots":[true,true,true,true,true]}]},{"type":"any","faction":"any","conditions":[{"mustHave":"true","number":"2","effect":"Troop Training Speed","buffType":"e","slots":[true,true,true,true,true]}]},{"type":"banner","faction":"any","conditions":[{"mustHave":"true","number":"2","effect":"Siege Range","buffType":"e","slots":[true,true,true,true,true]}]}],numSalvagedItems:0,maxStones:100000,anyCity:true,overflow:"lowest",};
readOptions();
var culang = {},Smileys = {},SmileysVIP ={},avatars = {},avatars2 = {};
eval(GM_getResourceText("langues"));
var lang=culang[Options.Langue];
eval(GM_getResourceText("avatars"));
eval(GM_getResourceText("smileys"));
var nHtml={FindByXPath:function(a,b,c){if(!c){c=XPathResult.FIRST_ORDERED_NODE_TYPE}try{var d=document.evaluate(b,a,null,c,null)}catch(e){GM_log("bad xpath:"+b)}if(c==XPathResult.FIRST_ORDERED_NODE_TYPE){if(d&&d.singleNodeValue){return d.singleNodeValue}}else{if(d){return d}}return null},ClickWin:function(a,b,c){var d=a.document.createEvent("MouseEvents");d.initMouseEvent(c,true,true,a,0,0,0,0,0,false,false,false,false,0,null);return!b.dispatchEvent(d)},Click:function(a){return this.ClickWin(window,a,"click")},ClickTimeout:function(a,b){window.setTimeout(function(){return nHtml.ClickWin(window,a,"click")},b+Math.floor(Math.random()*500))},SetSelect:function(a,b){for(var c=0;c<a.options.length;c++){if(b==a.options[c].value){a.options[c].selected=true;return true}}return false}}
if (document.URL.search(/kingdomsofcamelot.com\/fb\/e2\/src\/helpFriend_src.php/i) >= 0){ helpFriends (); return true;}
function helpFriends(){
	function a(){var b=ById("claimhelpform");if(!b){setTimeout(a,1e3)}b.submit()}a()
}
unsafeWindow.arthurCheck=function(a){return;};
readGlobalOptions ();
var pubdusite="<center><font size=1>"+lang.pubbao+"</font></center><br><div style='width:320px;height:33px'><center><font size=2><i><b>Site : <a href=http://www.koc-bao.com target=_blank>koc-bao.com</a></font><br><font size=3><i><b><a href=http://forum.koc-bao.com target=_blank>Forum - Aide</a></font></center></div>";
if (document.URL.search(/apps.facebook.com\/kingdomsofcamelot/i) >= 0){
  setTimeout(function() {
    var test=document.URL;
    var testt = /s=([0-9]+)/i.exec(test);
    if (testt) {
     unsafeWindow.window.document.title="KOC "+testt[1];
    }
    }, 10000)
  facebookInstance ();
  return;
}
if (document.URL.search(/kingdoms-of-camelot\/play/i) >= 0){

	setTimeout(function() {
	    var test=document.URL;
	    var testt = /&s=([0-9]+)/i.exec(test);
		if ( ById("promo-sidebar")) ById("promo-sidebar").parentNode.removeChild(ById("promo-sidebar"));
		if ( ById("sidebar_container")) ById("sidebar_container").parentNode.removeChild(ById("sidebar_container"));
	    if (testt) {
	     unsafeWindow.window.document.title="KOC "+testt[1];
	    } else {
			  var testt2 = /s=([0-9]+)/i.exec(test);
			if (testt2)
	         unsafeWindow.window.document.title="KOC "+testt2[1];
		}
    }, 10000)
  kabamStandAlone ();
  return;
}

if (document.URL.search(/facebook.com/i) >= 0){
	if(document.URL.search(/dialog\/feed/i) >= 0)
		HandlePublishPopup ();
  return;
}
if (document.URL.search(/kingdomsofcamelot.com/i) >= 0)  kocWideScreen ();

function readGlobalOptions (){ GlobalOptions = JSON2.parse (GM_getValue ('Options_??', '{}'));}
function kocWideScreen(){
	  var fois=0;
	  function setWideFb(){var kocFrame=parent.document.getElementById('kocIframes1');
      if(!kocFrame){setTimeout(setWideFb,1000);return;}kocFrame.style.width='100%';
      if (ById("promo-sidebar")) ById("promo-sidebar").parentNode.removeChild(ById("promo-sidebar"));
      if (ById("sidebar_container")) ById("sidebar_container").parentNode.removeChild(ById("sidebar_container"));

      var style=document.createElement('style');style.innerHTML='body {margin:0; width:100%; !important;}';kocFrame.parentNode.appendChild(style);}
function test(){var alla=ById('kocinitloading');if(alla){if(alla.style.display!="none"){fois++;if(fois>23)reloadKOC();setTimeout(test,2500);return}}}if(document.URL.match(/standalone=0/i)){test()}kocWatchdog();setWideFb();}
function kabamStandAlone  (){
  if (ById("game_container")) ById("game_container").style.width="100%";
  if (ById("content")) ById("content").style.top="0px";
  if (ById("sitemap")) ById("sitemap").parentNode.removeChild(ById("sitemap"));
  if (ById("main-footer")) ById("main-footer").parentNode.removeChild(ById("main-footer"));
  function setWide (){
	var iFrames = ById('game_frame');
	if (!iFrames){
	  setTimeout (setWide, 1000);
	  return;
	}
	iFrames.style.width = '100%';
	while ( (iFrames=iFrames.parentNode) != null)
	if (iFrames.tagName=='DIV')
		iFrames.style.width = '100%';
	ById("main-nav").parentNode.removeChild(ById("main-nav"));
    ById("main-header").parentNode.removeChild(ById("main-header"));
    setTimeout(function() {if(ById("eu_privacy"))ById("eu_privacy").parentNode.removeChild(ById("eu_privacy"));},2000);
  }
  setWide();
}
function facebookInstance(){function a(){var b=ById("iframe_canvas");if(!b){setTimeout(a,1e3);return}b.style.width="100%";while((b=b.parentNode)!=null)if(b.tagName=="DIV")b.style.width="100%";ById("globalContainer").style.left="0px";try{ById("rightCol").parentNode.removeChild(ById("rightCol"));ById("leftColContainer").parentNode.removeChild(ById("leftColContainer"));}catch(c){}
var c=ById("mainContainer");
if(c){if(GlobalOptions.pbWideScreenStyle=="normal")
c.parentNode.style.minWidth="100%";
	var pied = ById('pagelet_canvas_footer_content');
	if(pied) { pied.parentNode.removeChild(pied); }
	    if (ById("hudBottomContainer"))      ById("hudBottomContainer").parentNode.removeChild(ById("hudBottomContainer"));

if(GlobalOptions.pbWideScreenStyle=="wide")c.parentNode.style.width="1520px";if(GlobalOptions.pbWideScreenStyle=="ultra")c.parentNode.style.width="2000px";for(i=0;i<c.childNodes.length;i++){if(c.childNodes[i].id=="contentCol"){c.childNodes[i].style.margin="0px";c.childNodes[i].style.paddingTop="0px";break}}}var c=ById("pageHead");if(c){c.style.width="80%";c.style.margin="0 10%"}var c=ById("bottomContent");if(c){c.style.padding="0px 0px 12px 0px"}}facebookWatchdog();a()}
function HandlePublishPopup() {
 if(GlobalOptions.autoPublishGamePopups){
		var FBInputForm = ById('uiserver_form');
		if(FBInputForm){
			var channel_input = nHtml.FindByXPath(FBInputForm,".//input[contains(@name,'channel')]");
			if(channel_input){
				var current_channel_url = channel_input.value;
					var publish_button = nHtml.FindByXPath(FBInputForm,".//input[@type='submit' and contains(@name,'publish')]");
					var test=ById("feedform_user_message");
					if(publish_button && test){
						setTimeout(function() {
						 nHtml.Click(publish_button);
						},2500);
					}
			}
		}
    setTimeout(HandlePublishPopup, 5000);
   }
}

function facebookWatchdog(){function b(){try{if(ById("app_content_130402594779")==null){logit("KOC NOT FOUND!");KOCnotFound(5*60)}}catch(a){logit("KOC NOT FOUND!");KOCnotFound(4*60)}}var a=5e4;if(!GlobalOptions.pbWatchdog)return;setTimeout(b,a)}
function kocWatchdog(){function b(){if(ById("mod_maparea")==null){logit("KOC not loaded");KOCnotFound(20);return}if(ById("kocmain")){if(ById("kocmain").style.display=="none"){logit("New KOC not loaded");KOCnotFound(20);return}else{}}}var a=20000;if(!GlobalOptions.pbWatchdog)return;setTimeout(b,a)}
var Cities = {};
var Seed = unsafeWindow.seed;
var uW = unsafeWindow;
var Tabs = {};
var my = {};
var myBO = {};
var researchLevels = [],research2Levels = [];
var crestname = {};
var CPopUpTopClass = 'pbPopTop';
var mainPop, mainPop2;
var ResetColors = false;
var Tabs2=[["Attaque",lang.StatLabelAttaque],["Trone",lang.StatLabelTrone],["Tournoi",lang.StatLabelTournoi],["Resources",lang.StatLabelResources],["Spam",lang.StatLabelSpam],["Stock",lang.StatLabelInventaire],["Info",lang.StatLabelInfo],["Alliance",lang.StatLabelAlliance],["Gift",lang.StatLabelGift],["Test",lang.StatLabelTest],["ActionLog",lang.StatLabelLogs]]
var BOStartupTimer = null;
var currentName2 = 'Attaque';
var myServerId = null;
function getServerId(){if(myServerId==null){var a=/^[a-zA-Z]+([0-9]+)\./.exec(document.location.hostname);if(a)myServerId=a[1];else myServerId="??"}return myServerId}
var tileNames = [];
function BAOStartup (){
  clearTimeout (BOStartupTimer);
  if (uW.BOLoaded)   return;
  var metc = getClientCoords(ById('main_engagement_tabs'));
  if (metc.width==null || metc.width==0){
    BOStartupTimer = setTimeout (BAOStartup, 1000);
    return;
  }
  uW.BOLoaded = Version;
  readOptions(); readColors();
  Seed = uW.seed;
  tileNames = [uW.g_js_strings.commonstr.barbarians, uW.g_js_strings.commonstr.grassland, uW.g_js_strings.commonstr.lake, uW.g_js_strings.commonstr.woods, uW.g_js_strings.commonstr.hills, uW.g_js_strings.commonstr.mountain, uW.g_js_strings.commonstr.plain, uW.g_js_strings.commonstr.city, uW.g_js_strings.commonstr.bog, uW.g_js_strings.commonstr.darkForest, uW.g_js_strings.commonstr.mercenaryHideout];
  var aj2=function(c,d,b,a){if(d.ctrl&&d.ctrl=="Tracking"){return false;}else{unsafeWindow.AjaxCall.gAjaxRequest(c,d,b,a,"post");}}
  unsafeWindow.AjaxCall.gPostRequest=aj2;if (TESTBAO==-1) { return false; }
GM_addStyle ('.xtab {padding-right: 5px; border:none; background:none; white-space:nowrap;}\
.tourny_list_table { padding: 10px; border-radius:5px; border:2px solid #000000; }\
    .hostile td { background:crimson; }.amicale td{background:lightblue; }.allie td{background:#9999FF; }\
    .neutre td { background:lightgreen; }.unaligned td { background:gold; }\
    .xtabBR {padding-right: 5px; border:none; background:none;}\
    .boAide {height:20px;font-size:9px;font-weight:bold;}\
    div.ptDiv {background-color:none;}\
    table.ptTab tr td {border:none; background:none; white-space:nowrap;}\
    table.ptTabPad tr td {border:none; background:none; white-space:nowrap; padding: 2px 4px 2px 8px;}\
    table.ptTabBR tr td {border:none; background:none;}\
    table.pbTabLined tr td {border:1px none none solid none; padding: 2px 5px; white-space:nowrap;}\
    table.ptTabPad tr td.ptentry {background-color:#ffeecc; padding-left: 8px;}\
    table.ptTabOverview tr td {border-left:1px solid #ccc; white-space:nowrap; padding: 1px;   font-size:11px;}\
    table.ptNoPad tr td {border:none; background:none; white-space:nowrap; padding:0px}\
    .pbStat {border:1px solid; border-color:#000000; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#ffffff ; background-color:#357;  border-radius:5px;}\
    .pbStatOrange {border:1px solid; border-color:#000000; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#ffffff ; background-color:orange;  border-radius:5px;}\
    .boStatRed { border: 0.5px inset #ffffff; border-radius:10px 10px 5px 5px; box-shadow: 2px 2px 2px 2px #EEEEEE; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#ffffff ; background-color:red;  border-radius:5px;}\
    .ptOddrow {background-color:#eee}\
    .boStat2 {border: 0.5px solid #ffffff; border-radius:2px; box-shadow: inset 0px 0px 3px #ffffff; font-weight:bold; padding-left:10px;padding-top:2px; padding-bottom:2px; text-align:left; color:#ffffff;	background-color:#262}\
    .boStat2 a { font-weight:bold; font-size:14px; color:#fff;  font-variant:small-caps;  text-shadow: -1px -1px 0px #141516, 1px 1px 0px #600000;  text-decoration: none; -webkit-transition: all 1sease;-moz-transition: all 1sease;-o-transition: all 1sease;transition: all 1sease;}\
    .boStat2 a:hover { font-size:15px; color:red; text-shadow: -1px -1px 0px #141516, 1px 1px 0px #600000; }\
    .boStat {border: 0.5px inset #ffffff; border-radius:10px 10px 5px 5px; box-shadow: 2px 2px 2px 2px #EEEEEE; font-weight:bold; font-size:13px; font-variant:small-caps;  padding:0px 10px; text-align:center; color:#ffffff;	background-color:#262; -webkit-transition: all 1sease;-moz-transition: all 1sease;-o-transition: all 1sease;transition: all 1sease;}\
	.ptStatLight {color:#ddd}\
    .ptentry {padding: 7px; border:1px solid; border-color:#000000; background-color:#ffeecc; white-space:nowrap;}\
    .ptErrText {font-weight:bold; color:#600000}\
    .castleBut {outline:0px; margin-left:0px; margin-right:0px; width:24px; height:26px; font-size:12px; font-weight:bold;}\
    .castleBut:hover {border-size:3px; border-color:#000;}\
    	button::focus-inner, input[type="submit"]::focus-inner { color:#FFFFFF; border: none; border-radius:5px; }\
    	input[type="text"] { padding: 1px; border: 0.5px inset #141516;  border-radius:5px; }\
    	input[type="button"],input[type="submit"] { border: 1px outset #141516; border-radius:3px; }\
	input[type="submit"]:hover,input[type="button"]:hover  { color: #600000; background-color:#FFFFFF; }\
    .ptChatWhisper {}\
    .ptChatAttack {color: #000; font-weight:bold; background-color: '+Colors.ChatAtt+'; }\
    .ptChatScout {color: #000; font-weight:bold; background-color: '+Colors.ChatEcl+'; }\
    .ptChatAlliance {}\
    .ptChatGlobal {background-color: #fdd}\
    .ptChatIcon {border: 0px inset black}\
    .ptChatScripter {font-weight:bold;font-style:italic;color:#500;}\
    .ptChatScripterVIP {color:#611;}\
    .ptChatCHAN {color:#000; background-color:'+Colors.ChatChancy+';}\
    .ptChatVICE {color:#000; background-color:'+Colors.ChatVC+';}\
    .ptChatOFFI {color:#000; background-color:'+Colors.ChatLeaders+';}\
    input.BODefButOff {cursor:pointer; border:1px solid #45d183; box-shadow:inset 0px 1px 5px #3aef8b; border-radius:5px;}\
    input.BODefButOn {cursor:pointer; border:1px solid #f61646; box-shadow:inset 0px 1px 5px #f6375f; border-radius:5px;}\
    span.whiteOnRed {padding-left:3px; padding-right:3px; background-color:#700; color:white; font-weight:bold}\
    span.boldRed {color:#800; font-weight:bold}\
    span.oohfancy {color:#0000; font-weight:bold;text-shadow: 1px 1px 1px #AAA; font-variant:small-caps; text-align:center}\
    span.oohfancyi {color:#0000; font-style:italic;text-shadow: 1px 1px 1px #AAA; font-variant:small-caps; text-align:center}\
    .emoicon {width:19px !important;height:19px !important;float:none !important;}\
    .castleButNon {background-image:url("'+ URL_CASTLE_BUT +'")}\
    .castleButSel {background-image:url("'+ URL_CASTLE_BUT_SEL +'")}\
    span.boldDarkRed {color:#600; font-weight:bold}\
    a.ptButton20 {color:#ffff80}\
    input.bopbSubtab {cursor:pointer; width:10em; margin-right:15px;}\
    input.bopbSubtabSel {background-color:#444444; color:white; font-weight:bold; cursor:none !important}\
    matTab {}\
   .matTabNotSel { padding:0 0 0 20px;  color : #2F230E; font: bold 11px Georgia; white-space: nowrap; cursur:pointer; padding:0px;height: 17px; }\
   .matTabNotSel span { color : #2F230E; background: url("'+gameurl+'img/nav/tab_unselected.png") no-repeat scroll left 0 transparent; display: inline-block;  height: 16px;    padding: 1px 2px 0 7px;    text-decoration: none;   }\
   .BOTabSel { color : #2F230E; font: bold 11px Georgia; white-space: nowrap; cursur:pointer; padding:0 0px 0 0;height: 17px;   }\
   .BOTabSel span { color : #2F230E; background: url("'+gameurl+'img/nav/tab_selected.png") no-repeat scroll left top transparent; display: inline-block; width:74px;    height: 16px;    padding: 1px 2px 0 7px;    text-decoration: none;   }\
   .BOTabNotSel { padding:0 0 0 20px;  color : #2F230E; font: bold 11px Georgia; white-space: nowrap; cursur:pointer; padding:0px;height: 17px; }\
   .BOTabNotSel span { color : #2F230E; background: url("'+gameurl+'img/nav/tab_unselected.png") no-repeat scroll left 0 transparent; display: inline-block; width:74px;   height: 16px;    padding: 1px 2px 0 7px;    text-decoration: none;   }\
   .matTabSel { color : #2F230E; font: bold 11px Georgia; white-space: nowrap; cursur:pointer; padding:0 0px 0 0;height: 17px;   }\
   .matTabSel span { color : #2F230E; background: url("'+gameurl+'img/nav/tab_selected.png") no-repeat scroll left top transparent; display: inline-block;  height: 16px;    padding: 1px 2px 0 7px;    text-decoration: none;   }\
   tr.BOCPopupTop td { border:none; height: 15px;  padding:0px; }\
   .BOptretry_top { background-color:#a00; color:#fff; border:none; height: 21px; padding:0px; }\
   input.ptButCancel {background-color:#a00; font-weight:bold; color:#fff}\
   .BOCPopup .BOCPopMain {  opacity:0.9;box-shadow:inset 0px 0px 20px #006000; border-radius:0px; border:1px solid #141516; padding:3px; }\
   .idp_CPopup .idp2_CPopup { opacity:0.9; }\
   .trStat {border:1px solid; border-color:#000000; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#ffffff ; background-color:#357; border-radius:5px;}\
   table.trTabPad tr td { padding-left: 8px;}\
   table.trTabPad2 tr td { padding-left: 20px;}\
   table.trTab tr td {border:none; background:none; white-space:nowrap; padding:0px}\
   div.boremove { display=inline;  background-image: url('+ DELETE_BTN +'); background-repeat: no-repeat; background-color: transparent;  width: 24px; height: 24px; }\
   div.boremove:hover  { display=inline;  background-image: url('+ DELETE_BTN2 +'); background-repeat: no-repeat; background-color: transparent;  width: 24px; height: 24px; }\
   div.bodown { display=inline;  background-image: url('+ DOWN_BTN +'); background-repeat: no-repeat; background-color: transparent;  width: 24px; height: 24px; }\
   div.boup { display=inline;  background-image: url('+ UP_BTN +'); background-repeat: no-repeat; background-color: transparent;  width: 24px; height: 24px; }\
   table.trTab#BODisplayTable tr th { border: 3px solid grey; font-size:1.2em;}\
   table.trTab tr td,th {border: 1px solid brown;border:none; background:none; padding: 0px}\
        div.trCard {width: 200px;}\
        div.trCard div.description>div{width:70px;height:70px; }\
        div.trCard div.description div.briton.advisor{background:transparent url("'+gameurl+'img/throne/icons/70/briton_advisor_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.briton.banner{background:transparent url("'+gameurl+'img/throne/icons/70/briton_banner_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.briton.chair{background:transparent url("'+gameurl+'img/throne/icons/70/briton_chair_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.briton.table{background:transparent url("'+gameurl+'img/throne/icons/70/briton_table_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.briton.window{background:transparent url("'+gameurl+'img/throne/icons/70/briton_window_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.briton.trophy{background:transparent url("'+gameurl+'img/throne/icons/70/briton_trophy_normal_1_5.png") top left no-repeat;}\
        div.trCard div.description div.briton.candelabrum{background:transparent url("'+gameurl+'img/throne/icons/70/briton_candelabrum_normal_1_5.png") top left no-repeat;}\
        div.trCard div.description div.druid.advisor{background:transparent url("'+gameurl+'img/throne/icons/70/druid_advisor_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.druid.banner{background:transparent url("'+gameurl+'img/throne/icons/70/druid_banner_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.druid.chair{background:transparent url("'+gameurl+'img/throne/icons/70/druid_chair_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.druid.table{background:transparent url("'+gameurl+'img/throne/icons/70/druid_table_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.druid.window{background:transparent url("'+gameurl+'img/throne/icons/70/druid_window_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.druid.trophy{background:transparent url("'+gameurl+'img/throne/icons/70/druid_trophy_normal_1_5.png") top left no-repeat;}\
        div.trCard div.description div.druid.candelabrum{background:transparent url("'+gameurl+'img/throne/icons/70/druid_candelabrum_normal_1_5.png") top left no-repeat;}\
        div.trCard div.description div.fey.advisor{background:transparent url("'+gameurl+'img/throne/icons/70/fey_advisor_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.fey.banner{background:transparent url("'+gameurl+'img/throne/icons/70/fey_banner_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.fey.chair{background:transparent url("'+gameurl+'img/throne/icons/70/fey_chair_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.fey.table{background:transparent url("'+gameurl+'img/throne/icons/70/fey_table_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.fey.window{background:transparent url("'+gameurl+'img/throne/icons/70/fey_window_normal_1.png") top left no-repeat;}\
        div.trCard div.description div.fey.trophy{background:transparent url("'+gameurl+'img/throne/icons/70/fey_trophy_normal_1_5.png") top left no-repeat;}\
        div.trCard div.description div.fey.candelabrum{background:transparent url("'+gameurl+'img/throne/icons/70/fey_candelabrum_normal_1_5.png") top left no-repeat;}\
        div.trCard{font:bold 16px Georiga; overflow: hidden;}\
        div.trCard>div{float:left;border:1px solid #a56631;margin:0px;padding:0px;width:200px; height: 300px;background:transparent url("'+gameurl+'img/modal/modal_med_bg_4.png") -200px 0 no-repeat;}\
        div.trCard div.title{font:bold 16px Georgia;border-bottom:1px solid #703200;padding:4px 3px 5px 8px;background:transparent url("'+gameurl+'img/throne/panel/modal/item_bg.png") -20px -100px no-repeat;}\
        div.trCard div.title span.icon{background:transparent url("'+gameurl+'img/throne/modal/equip.png") top right no-repeat;display:block;height:20px;width:20px;top:12px;right:12px;position:absolute;}\
        div.trCard .disabled{opacity:.5;}\   div.trCard ul{margin:0px;padding:0;list-style:none;}\
        div.trCard li{padding:0px 0 0 0px;color:#3f2300;font-weight:bold;font-size:16px;}\
        div.trCard div.description{overflow:hidden;border-bottom:1px solid #703200;padding:5px 0;}\
        div.trCard div.description{overflow:hidden;border-bottom:1px solid #703200;}\
        div.trCard div.description div.portrait{float:left;}\
        div.trCard div.description div.portrait{border:3px solid #deaf69;margin-right:10px;}\
        div.trCard div.description>ul{float:left;margin:3px 0 0 0;padding:0;}\
        div.trCard div.description>ul li{padding:0;font-weight:bold;font-size:13px;text-transform:capitalize;}\
     div.BORule {border:2px inset #c0c0c0; margin-right:10px; margin-left:10px; margin-bottom:2px; padding-left:5px; padding-bottom:5px} \
    div.BORuleCreate {margin-right:10px; padding-right: 5px; margin-bottom:2px; padding-bottom:5px} \
    ul#bo_throneStatList li { float: left; width: 22px; height: 22px; text-align: center; color: white; }\
	ul#bo_throneStatList li.active { background: transparent url("'+gameurl+'img/throne/modal/set_active.png") top left no-repeat; } \
	ul#bo_throneStatList li.selected { background: transparent url("'+gameurl+'img/throne/modal/set_selected.png") top left no-repeat; }\
	ul#bo_throneStatList li.locked { background: transparent url("'+gameurl+'img/throne/modal/set_locked.png") top left no-repeat; text-indent: -999px; }\
	ul#bo_throneStatList li.buy { background: transparent url("'+gameurl+'img/throne/modal/set_buy.png") top left no-repeat; text-indent: -999px; }\
	.buttonDash_ON {margin:2px;-moz-box-shadow:inset 0px 0px 14px -3px #f2fadc;-webkit-box-shadow:inset 0px 0px 14px -3px #f2fadc;box-shadow:inset 0px 0px 14px -3px #f2fadc;background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #dbe6c4), color-stop(1, #9ba892));background:-moz-linear-gradient(top, #dbe6c4 5%, #9ba892 100%);background:-webkit-linear-gradient(top, #dbe6c4 5%, #9ba892 100%);background:-o-linear-gradient(top, #dbe6c4 5%, #9ba892 100%);background:-ms-linear-gradient(top, #dbe6c4 5%, #9ba892 100%);background:linear-gradient(to bottom, #dbe6c4 5%, #9ba892 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#dbe6c4", endColorstr="#9ba892",GradientType=0);background-color:#dbe6c4;-moz-border-radius:40px;-webkit-border-radius:40px;border-radius:40px;border:1px solid #b2b8ad;display:inline-block;color:black;font-family:verdana;font-size:12px;padding:1px 2px;text-decoration:none;}\
	.buttonDash_ON:hover {background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #9ba892), color-stop(1, #dbe6c4));background:-moz-linear-gradient(top, #9ba892 5%, #dbe6c4 100%);background:-webkit-linear-gradient(top, #9ba892 5%, #dbe6c4 100%);background:-o-linear-gradient(top, #9ba892 5%, #dbe6c4 100%);background:-ms-linear-gradient(top, #9ba892 5%, #dbe6c4 100%);background:linear-gradient(to bottom, #9ba892 5%, #dbe6c4 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#9ba892", endColorstr="#dbe6c4",GradientType=0);background-color:#9ba892;}\
	.buttonDash_OFF {margin:2px;-moz-box-shadow:inset 0px 0px 14px -3px #f7c5c0;-webkit-box-shadow:inset 0px 0px 14px -3px #f7c5c0;box-shadow:inset 0px 0px 14px -3px #f7c5c0;background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #fc8d83), color-stop(1, #e4685d));background:-moz-linear-gradient(top, #fc8d83 5%, #e4685d 100%);background:-webkit-linear-gradient(top, #fc8d83 5%, #e4685d 100%);background:-o-linear-gradient(top, #fc8d83 5%, #e4685d 100%);background:-ms-linear-gradient(top, #fc8d83 5%, #e4685d 100%);background:linear-gradient(to bottom, #fc8d83 5%, #e4685d 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#fc8d83", endColorstr="#e4685d",GradientType=0);background-color:#fc8d83;-moz-border-radius:40px;-webkit-border-radius:40px;border-radius:40px;border:1px solid #d83526;display:inline-block;color:black;font-family:verdana;font-size:12px;padding:1px 2px;text-decoration:none;}\
	.buttonDash_OFF:hover {background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #e4685d), color-stop(1, #fc8d83));background:-moz-linear-gradient(top, #e4685d 5%, #fc8d83 100%);background:-webkit-linear-gradient(top, #e4685d 5%, #fc8d83 100%);background:-o-linear-gradient(top, #e4685d 5%, #fc8d83 100%);background:-ms-linear-gradient(top, #e4685d 5%, #fc8d83 100%);background:linear-gradient(to bottom, #e4685d 5%, #fc8d83 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#e4685d", endColorstr="#fc8d83",GradientType=0);background-color:#e4685d;}\
	.pbButton {background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #e6e6e6), color-stop(1, #878487));background:-moz-linear-gradient(top, #e6e6e6 5%, #878487 100%);background:-webkit-linear-gradient(top, #e6e6e6 5%, #878487 100%);background:-o-linear-gradient(top, #e6e6e6 5%, #878487 100%);background:-ms-linear-gradient(top, #e6e6e6 5%, #878487 100%);background:linear-gradient(to bottom, #e6e6e6 5%, #878487 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#e6e6e6", endColorstr="#878487",GradientType=0);background-color:#e6e6e6;-moz-border-radius:7px;-webkit-border-radius:7px;border-radius:7px;border:1px solid #4f454f;display:inline-block;color:#000000;font-family:verdana;font-size:12px;font-weight:bold;padding:1px 2px;text-decoration:none;text-shadow:0px 1px 0px #e1e2ed;}\
    .pbButton:hover {background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #878487), color-stop(1, #e6e6e6));background:-moz-linear-gradient(top, #878487 5%, #e6e6e6 100%);background:-webkit-linear-gradient(top, #878487 5%, #e6e6e6 100%);background:-o-linear-gradient(top, #878487 5%, #e6e6e6 100%);background:-ms-linear-gradient(top, #878487 5%, #e6e6e6 100%);background:linear-gradient(to bottom, #878487 5%, #e6e6e6 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#878487", endColorstr="#e6e6e6",GradientType=0);background-color:#878487;}\
    .pbButton:active {position:relative;top:1px;}\
    .pbButton_selected {-moz-box-shadow:inset 0px 1px 3px 0px #1b1f26;-webkit-box-shadow:inset 0px 1px 3px 0px #1b1f26;box-shadow:inset 0px 1px 3px 0px #1b1f26;background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #5c6069), color-stop(1, #000000));background:-moz-linear-gradient(top, #5c6069 5%, #000000 100%);background:-webkit-linear-gradient(top, #5c6069 5%, #000000 100%);background:-o-linear-gradient(top, #5c6069 5%, #000000 100%);background:-ms-linear-gradient(top, #5c6069 5%, #000000 100%);background:linear-gradient(to bottom, #5c6069 5%, #000000 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#5c6069", endColorstr="#000000",GradientType=0);background-color:#5c6069;-moz-border-radius:7px;-webkit-border-radius:7px;border-radius:7px;border:1px solid #000000;display:inline-block;color:#ffffff;font-family:verdana;font-size:12px;font-weight:normal;padding:1px 2px;text-decoration:none;text-shadow:0px -1px 0px #000000;}\
 	.hasTooltip {display: inline;position: relative;}\
	.hasTooltip span {display:none;}\
	.hasTooltip:hover span {display:inline-block;z-index:99999;width:150px;background-color:#FFFFE6;border-radius:5px;color:black;box-shadow:1px 1px 3px gray;position:absolute;padding:5px;top:25px;left:25px;}\
 	div.indent25 {padding-left:25px}');

  setCities();  readCrestData();  readAttackOptions();
 readTrainingOptions();  readDashboardOptions(); readFarmOptions();
  readApothecaryOptions();
  readThroneOptions();  readUpgradeData();  readSalvageData();
  if (Options.loginReward && Seed.loginReward.show_hud && ById('dailyRewardHudInside')) uW.cm.DailyRewardsView.hudClick();
  if (Options.ptWinPos==null || Options.ptWinPos.x==null|| Options.ptWinPos.x=='' || isNaN(Options.ptWinPos.x)){
    var c = getClientCoords (ById('main_engagement_tabs'));
    Options.ptWinPos.x = c.x+4;
    Options.ptWinPos.y = c.y+c.height;
    saveOptions ();
  }
  if (Options.ptWin2Pos==null || Options.ptWin2Pos.x==null|| Options.ptWin2Pos.x=='' || isNaN(Options.ptWin2Pos.x)){
      var c = getClientCoords (ById('main_engagement_tabs'));
      Options.ptWin2Pos.x = c.x+4;
      Options.ptWin2Pos.y = c.y+c.height;
      saveOptions ();
  }
  var hauteur=parseIntNan(Options.HauteurBoite) + 30;
  mainPop = new CPopup ('idp1', Options.ptWinPos.x, Options.ptWinPos.y, 800, hauteur, Options.ptWinDrag,
     function (){
        tabManager.hideTab();
        Options.pbWinIsOpen=false;
        saveOptions()
  });
  var mainDiv = mainPop.getMainDiv();
  mainPop.getTopDiv().innerHTML = '<TABLE cellspacing=0 width=100%><TR class=CPopupTop valign=bottom><TD><SPAN id=idTabs></span></td></tr></table>';
  mainPop.autoWidth(true);

  AddMainTabLink("KOC BAO", eventHideShow, mouseMainTab);
  if (Options.RefreshSeed)  AddSubTabLink('Refresh Seed', RefreshSeed, 'BOSeedRefresh');
  tabManager.init (mainPop.getMainDiv());
 // Options.alertConfig.raidautoswitch=[];
  DispReport.init();
  AllianceReports.init ();
  messageNav.init();
  RefreshEvery.init();
  ChatStuff.init ();
  battleReports.init();
  AttackDialog.init();
	bypassMulti.init();
  CoordBox.init();
  mapinfoFix.init();
  Dashboard.init();
   if (!ThroneOptions.Active) {
     setTimeout(function() { RepairAuto.init ();    },10000);
   }else {
    Options.salvageconfig.Repairrunning=false;
   }
  setTimeout(function() {
     DeleteReports.init();
     SpamEvery.init ();
     CollectGold.init();
     FairieKiller.init (Options.pbKillFairie);
     FoodAlerts.init();
  },15000);
  if (Options.pbWinIsOpen){
    mainPop.show (true);
    tabManager.showTab();
  }
  if (window.attachEvent)
      window.attachEvent('onunload', onUnload);
  else if (window.addEventListener)
      window.addEventListener('unload', onUnload, false);


  AddMainTabLink2("Stats", eventHideShow2, mouseMainTab2);
  WideScreen.init ();
  if (Options.pbChatOnRight) WideScreen.setChatOnRight (Options.pbChatOnRight);
  if (Options.pbChatOnLeft) WideScreen.setChatOnLeft (Options.pbChatOnLeft);
  WideScreen.useWideMap (Options.pbWideMap);
  gmtClock.init();
  var params=uW.Object.clone(uW.g_ajaxparams);params.format=2;params.tournyPos=0;new AjaxRequest(uW.g_ajaxpath+"ajax/getLeaderboard.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,onSuccess:function(transport){var rslt=eval("("+transport.responseText+")");if(rslt.ok){if(rslt.data || rslt.name){ById("ptBoite2").innerHTML='<span style="color: #f66"> <blink>'+uW.g_js_strings.commonstr.tournament+'</blink> </span>';}}}})
  if (Options.currentTab2) {
      currentName2 = Options.currentTab2;
      if (currentName2=='Overview1')  currentName2 = 'Attaque';
      if (currentName2=='map')  currentName2 = 'Attaque';
      if (currentName2=='build')  currentName2 = 'Attaque';
      if (currentName2=='autoFormation') currentName2 = 'Attaque';
     } else {
      currentName2 = 'Attaque';
     }
     mainPop2 = new CPopup ('idp2', Options.ptWin2Pos.x, Options.ptWin2Pos.y, 779,350, true,
           function (){
              if (myBO[currentName2]==undefined) {
	          currentName2 = 'Attaque';
    }
             myBO[currentName2].hide();
             Options.ptWin2IsOpen=false;
             saveOptions();
         });
     var mainDiv2 = mainPop2.getMainDiv();
     mainPop2.getTopDiv().innerHTML = '<TABLE cellspacing=0 width=100%><TR class=CPopupTop valign=bottom><TD><SPAN id=idTabs2></span></td></tr><tr><td><span id=idTabs3></span></tr></table>';
     mainPop2.autoHeight (true);
     mainPop2.autoWidth(true);

     var eTabs2 = ById('idTabs2');
    for (k=0; k<Tabs2.length; k++){
        var a=document.createElement('a');

        a.id = 'ab'+ Tabs2[k][0];
        a.innerHTML='<span id="spp'+ Tabs2[k][0] +'" class="matTab">'+ Tabs2[k][1] +'</span>';
        if (k==9) {
         var eTabs2 = ById('idTabs3');
         eTabs2.innerHTML+="</tr><tr><td>";
        }
        eTabs2.appendChild(a);
        a.addEventListener('click', clickedTab2, false);
        myBO[Tabs2[k][0]].init();
        cont = myBO[Tabs2[k][0]].getContent();
        if (Tabs2[k][0]==currentName2) {
         cont.style.display = 'block';
         a.className='matTabSel';
        }else {
         cont.style.display = 'none';
         a.className='matTabNotSel';
        }
        mainDiv2.appendChild(cont);
 }
   if (Options.ptWin2IsOpen){
    mainPop2.show (true);
    if (myBO[currentName2]==undefined) {
     currentName2 = 'Attaque';
    }
    myBO[currentName2].show();
  }

  if (Options.SelQG) {
    if (parseIntNan(Options.alertConfig.hq)>0) {
     setTimeout(function() {
        var idx=Cities.byID[Options.alertConfig.hq].idx;
        try {
			uW.citysel_click(ById('citysel_'+ (idx+1)));
        } catch (ex) {}
     },1000);
    }
  }
   setTimeout(function() {
     if (ById("t_throneStatList"))  {
     } else {
       buildPresetWidget();
     }
   }, 1000);
  actionLog("Boite","Welcome ! KOC-BAO V"+Version);

  NewsUpgradeThrone();
  if (uW.cm.cheatDetector) uW.cm.cheatDetector.detect = eval ('function a (){}');
  setInterval(eachSecond,1000);
  if (Options.TresureChestFB)
   uW.pop_treasure_chest_modal = treasure_chest_post;
}

function treasure_chest_post(tid) {
	var mid = tid;
	var params = uW.Object.clone(uW.g_ajaxparams);
	params.tid = tid;
	new AjaxRequest(uW.g_ajaxpath + "ajax/postFriendVictoryTokenShare.php" + uW.g_ajaxsuffix, {
		method: "post",
		parameters: params,
		onSuccess: function (transport) {
			var rslt = eval("(" + transport.responseText + ")");
			if (rslt.updateSeed) { try {uW.update_seed(rslt.updateSeed);} catch (e) {} }
			if (rslt.ok) {
				var reparr = new Array();
				var city = '';
				for (c in Seed.queue_atkp) {
					if (Seed.queue_atkp[c]['m'+mid]) city = c;
				}
				var tileName = (Seed.queue_atkp[city]["m" + mid].toTileType == 51) ? "Barbarian Camp" : uW.g_mapObject.types[parseInt(Seed.queue_atkp[city]["m" + mid].toTileType)].capitalize();
				reparr.push(["REPLACE_CiTyId", city.substr(4)]);
				reparr.push(["REPLACE_CiTyNaMe", Cities.byID[city.substr(4)].name]);
				reparr.push(["REPLACE_TiLeNaMe", tileName]);
				reparr.push(["REPLACE_fEeDiD", rslt.feedId]);
				reparr.push(["REPLACE_tOkEnId", rslt.tokenId]);
				try {
				uW.common_postToProfile("118", reparr);
				} catch (ex) {				}
			}
		},
		onFailure: function () {
		},
	});
}


var withAnim = null;
if (uW.cm && uW.cm.ThronePaneView) withAnim = uW.cm.ThronePanelView.statusAnim;
function noAnim(result) {
     if (result == "success")
    {
        withAnim(result);
    }
    $("div.thronePanelItemContainer").append("<div>" + result + "</div>");
}
function disableAnimation(disable) {
       if (disable) {
           uW.cm.ThronePanelView.statusAnim = noAnim;
       } else {
           if (withAnim)
             uW.cm.ThronePanelView.statusAnim = withAnim;
       }
  }

function NewsUpgradeThrone() {
	function addPanelCb() {
	      $("ul.tabsv2 > li:contains('enhance')").click( function() {Tabs.Throne.panelType = "enhance"; Tabs.Throne.panelNextLevel = 2; addPanelCb();});
	      $("ul.tabsv2 > li:contains('upgrade')").click( function() {Tabs.Throne.panelType = "upgrade"; Tabs.Throne.panelNextLevel = 2; addPanelCb();});
	  }
	  var F2 = uW.cm.ThronePanelView.renderPanel;
	  var renderPanel2 = function(v1, v2) {
	          F2(v1,v2);
	          Tabs.Throne.panelId = v2.id;
	          Tabs.Throne.panelType = v1;
	          Tabs.Throne.panelNextLevel = 2;
	          addPanelCb();
	  };

    uW.cm.ThronePanelView.renderPanel = renderPanel2;

    var oldF = uW.cm.ContextualMenuThrone.renderMenu;
    var renderMenu2 = function (l, j) {
        oldF(l,j);
        if (j != null)
        {
            var btn2 = document.createElement('a');
            $(btn2).addClass("buttonv2 h20 green").html("BAO - Auto Enhance").css('color', 'yellow')
            .bind("click", function () {
                Tabs.Throne.addToQueue(j.id,"Enhance");
                $("#contextMenu").remove();});
            $("#contextMenu div.title").after(btn2);

            var btn = document.createElement('a');
            $(btn).addClass("buttonv2 h20 green").html("BAO - Auto Upgrade").css('color', 'yellow')
            .bind("click", function () {
                 Tabs.Throne.addToQueue(j.id,"Upgrade");
                $("#contextMenu").remove();});
            $("#contextMenu div.title").after(btn);
	   }

    };
    uW.cm.ContextualMenuThrone.renderMenu = renderMenu2;
}
function onUnload(){Options.ptWinPos=mainPop.getLocation();Options.ptWin2Pos=mainPop2.getLocation();saveOptions();if(!ResetColors)saveColors()}
function getAlliance (aid){
  if (Seed.allianceDiplomacies==null || Seed.allianceDiplomacies.allianceName==null)
    return ['neutre', 0, 'None'];
  else if (Seed.allianceDiplomacies.friendly && Seed.allianceDiplomacies.friendly['a'+aid] != null)
      return ['amicale',Seed.allianceDiplomacies.allianceId, Seed.allianceDiplomacies.allianceName];
  else if (Seed.allianceDiplomacies.hostile && Seed.allianceDiplomacies.hostile['a'+aid] != null)
      return ['hostile',Seed.allianceDiplomacies.hostile['a'+aid].allianceId, Seed.allianceDiplomacies.hostile['a'+aid].allianceName];
}
var CoordBox={init:function(){var a=CoordBox;a.boxDiv=searchDOM(ById("maparea_map"),'node.className=="mod_coord"',3,false);a.setEnable(Options.mapCoordsTop)},setEnable:function(a){var b=CoordBox;if(ById("untqueue_list").style.display!="none")uW.cm.MarchProgressBar.toggle();
if(ById("sharethis_icon"))ById("sharethis_icon").style.display="none";
if(b.boxDiv==null)return;if(a){b.boxDiv.style.zIndex="100000";b.boxDiv.style.left="5px";if(Options.pbChatOnRight || Options.pbChatOnLeft){b.boxDiv.style.top="470px"}}else{b.boxDiv.style.zIndex="10011";b.boxDiv.style.left="20px";b.boxDiv.style.top="57px"}},isAvailable:function(){var a=CoordBox;return!(a.boxDiv==null)}}
var mapinfoFix={
  		init : function(){
  			var t = mapinfoFix;
  			t.calcButtonInfo = new CalterUwFunc ('cm.ContextMenuMapController.prototype.calcButtonInfo', [['case "reassign":b.text = g_js_strings.commonstr.reassign;b.color = "blue";b.action = function () {modal_attack(2, e.tile.x, e.tile.y);};d.push(b);break;', 'case "reassign":b.text = g_js_strings.commonstr.reassign;b.color = "blue";b.action = function () {modal_attack(5, e.tile.x, e.tile.y);};d.push(b);break;']]);
  			t.calcButtonInfo.setEnable(Options.mapInfo);
 		},
  		setEnable : function(tf){
 			var t = mapinfoFix;
  			t.calcButtonInfo.setEnable(tf);
 		},
  		isAvailable : function(){
  			var t = mapinfoFix;
 			return t.calcButtonInfo.isAvailable;
 	},
}
function processPresetClick(btn){
    if (btn == Seed.throne.activeSlot) return;
    uW.AjaxCall.gPostRequest("ajax/_dispatch53.php",{ctrl: "throneRoom\\ThroneRoomServiceAjax",action: "setPreset",presetId: btn},
            function (v) {
                if (v.ok === true)
                {
                    var H = Seed.throne.slotEquip[btn];
                    Seed.throne.activeSlot = btn;
                    $.each(uW.kocThroneItems, function (I, J) {
                        C = $.inArray(J.id, H) > -1;
                        if (C) {
                            J.isEquipped = true;
                        } else {
                            J.isEquipped = false;
                        }
                    });
                    setPresetWidget(btn);
                    uW.cm.ThroneView.renderThrone();
                    uW.cm.ThroneView.renderStats();
                }
            }
    );
}
function setPresetWidget(slot)
{
    var x = ($("#bo_throneStatList .selected, #throneStatList .selected"));
    x.removeClass('selected');
    x.addClass('active');
    x.bind("mouseenter", function (I) {
        uW.cm.ThroneView.boostsTooltip(this, I, I.target.id)
    });
    x.bind("mouseleave", function (I) {
        uW.removeTooltip()
    });
    var s = $("#bo_throneInventoryPreset" + slot + ", #throneInventoryPreset" + slot);
    s.removeClass('active');
    s.addClass('selected')
    s.unbind("mouseenter").unbind("mouseleave");
    if (ById('ShowTrPresets')) Dashboard.ShowTrPresets();
	if (ById("BOTroneAether")) myBO.Trone.show();
	 for (i=1;i<=Seed.throne.slotNum;i++) {
								if (i==Seed.throne.activeSlot) {
									if (ById('KabamPreset_'+i))ById('KabamPreset_'+i).setAttribute("class", "pbButton_selected");
									if (ById("BOMarchTrone_"+i))ById("BOMarchTrone_"+i).setAttribute("class", "pbButton_selected");
									if (ById("BOAttackTrone_"+i))ById("BOAttackTrone_"+i).setAttribute("class", "pbButton_selected");
								}else{
									if (ById('KabamPreset_'+i))ById('KabamPreset_'+i).setAttribute("class", "pbButton");
									if (ById("BOMarchTrone_"+i))ById("BOMarchTrone_"+i).setAttribute("class", "pbButton");
									if (ById("BOAttackTrone_"+i))ById("BOAttackTrone_"+i).setAttribute("class", "pbButton");
								}
	}


}
function buildPresetWidget()
{
    var E = [];
    var J = Seed.throne.activeSlot;
    var F = Seed.throne.slotNum;
    for (var G = 0; G < 16; ++G) {
        var H = G + 1;
        var I = $("<li/>");
        if (H === J) {
            I.attr("id", "bo_throneInventoryPreset" + H);
            I.addClass("selected");
            I.html(H);
            I.bind("click", {
                idx: G
            }, function (K) {
                var L = K.data.idx + 1;
                processPresetClick(L);
            });

        } else {
            if (H === (F + 1)) {
                I.attr("id", "bo_throneInventoryPreset" + H);
                I.addClass("buy");
                I.html(H);
                I.bind("click", function () {
                    uW.cm.ContextualMenuThrone.renderMenu(this, null);
                })
            } else {
                if (H <= F) {
                    I.attr("id", "bo_throneInventoryPreset" + H);
                    I.addClass("active");
                    I.html(H);
                    I.bind("click", {
                        idx: G
                    }, function (K) {
                        var L = K.data.idx + 1;
                        processPresetClick(L);
                    });
                    I.bind("mouseenter", function (K) {
                        uW.cm.ThroneView.boostsTooltip(this, K, K.target.id)
                    });
                    I.bind("mouseleave", function (K) {
                        uW.removeTooltip()
                    })
                } else {
                    I.attr("id", "bo_throneInventoryPreset" + H);
                    I.addClass("locked");
                    I.html(H)
                }
            }
        }
        E.push(I)
    }
    var C = $("<ul/>", {
        id: "bo_throneStatList",
        addClass: "presetList",
        style: "width: 177px; padding: 0; margin: 0px; list-style: none; overflow: hidden; float: left; border: 1px outset Peru;",
        //style: "width: 178px; padding: 0px; margin: 0px; list-style: none; overflow: hiddden; float: left; border: 1px outset Peru; position: absolute; background: white;"
    });
    $.each(E, function (K, L) {
        C.append(L)
    })
    //var aa = $("<div/>", {height: '60px'});
    var aa = $("<div id='bo_presetBox'/>");
    $(aa).append(C);
     aa.css({
		"height": "48px",
	"width": "164px",
	"position": "absolute",
	"overflow": "visible","z-index": "100000"
	    })
    //$("#kocContainer").append(aa);
    $("div.mod_comm").prepend(aa);
    //$("div.comm_body").css('top', '60px');
    //$("a.mod_comm_mmb").css('top','25px').css('right','0px');
}
 // class definition for rules and conditions
function Rule(type, faction, conditions)
{
    this.type = type;
    this.faction = faction;
    if (conditions)
        this.conditions = conditions;
    else
        this.conditions = [];

    this.addCondition = addCondition;
    this.applyRule    = applyRule;
}

function cloneRule( rule)
{
    this.type = rule.type;
    this.faction = rule.faction;
    this.conditions = [];
    if (rule.conditions) this.conditions = rule.conditions;

    this.addCondition = addCondition;
    this.applyRule    = applyRule;
}

function addCondition(c)
{
    this.conditions.push(c);
}

function applyRule(id)
{
    var throne_item = uW.kocThroneItems[id];
    if (this.type != "any" && (this.type != throne_item.type)) return false;
    if (this.faction != "any" && (this.faction != throne_item.faction)) return false;
    for (r in this.conditions)
    {
        if (!this.conditions[r].checkCondition(id)) return false;
    }
    return true;
}

function Condition(mustHave, number, effect, buffType, slots )
{
    this.mustHave = mustHave;
    this.number   = number;
    this.effect   = effect;
    this.buffType = buffType;
    this.slots    = slots;
    this.checkCondition = checkCondition;
}
function checkCondition(id)
{
    var numberFound  = 0;
    var effectsFound = false;
    var throne_item = uW.kocThroneItems[id];
    if (!throne_item) return false;
    for (i in throne_item.effects)
    {
        var card_effect = uW.cm.thronestats.effects[throne_item.effects[i].id][1];
        var slotid = i.split("slot")[1];
 	    if (this.effect===undefined)
	    {
	            continue;
        }
        if (!this.slots[slotid-1])
        {
            continue;
        }

        if (card_effect == this.effect)
        {
            numberFound++;
        }
    }
    if (ThroneOptions.SalvageTriple && throne_item.effects["slot3"].id==throne_item.effects["slot4"].id && throne_item.effects["slot4"].id==throne_item.effects["slot5"].id) {
		return true;
	}
    if ( numberFound >= this.number)
    {
        effectsFound = true;
    }
    if (this.mustHave)
        return (effectsFound);
    else
        return !effectsFound;

}

var CalterUwFunc = function (funcName, findReplace) {
  var t = this;
  this.isEnabled = false;
  this.isAvailable = isAvailable;
  this.setEnable = setEnable;
  this.funcOld = null;
  this.funcNew = null;
  try {
    var x = funcName.split('.');
    var f = uW;
    for (var i=0; i<x.length; i++)
      f = f[x[i]];
    ft = f.toString();
    this.funcOld = f;
    var rt = ft.replace ('function '+ funcName, 'function');
    for (var i=0; i<findReplace.length; i++){
      x = rt.replace(findReplace[i][0], findReplace[i][1]);
      if (x == rt)
        return false;
      rt = x;
    }
    this.funcNew = rt;
  } catch (err) {
  }

  function setEnable (tf){
    if (t.funcNew == null)
      return;
    if (t.isEnabled != tf){
      if (tf){
	uW.uwuwuwFunc(funcName +' = '+ t.funcNew);
      	t.isEnabled = true;
      } else {
      var x = funcName.split('.');
      var f = unsafeWindow;
      for (var i=0; i<x.length-1; i++)
        f = f[x[i]];
      f[x[x.length-1]] = this.funcOld;
        t.isEnabled = false;
      }
    }
  }
  function isAvailable (){
    if (t.funcNew == null)
      return false;
    return true;
  }
};

var battleReports = {
  init : function (){
    var t = battleReports;
   t.getReportDisplayFunc = new CalterUwFunc ('getReportDisplay', [['return K.join("")', 'var themsg=K.join(""); themsg=getReportDisplay_hook(themsg, arguments[1]); themsg=getReportDisplay_hookz(themsg, arguments[1]); return themsg']]); //Alliance report battle rounds function
    uW.getReportDisplay_hook = t.hook;
    uW.getReportDisplay_hookz = t.hookz;
    t.getReportDisplayFunc.setEnable (true);
    t.renderBattleReportFunc = new CalterUwFunc ('Messages.viewMarchReport', [['$("modal_msg_list").innerHTML = cm.MarchReportController.getMarchReport(m, r);','var msg = cm.MarchReportController.getMarchReport(m, r); $("modal_msg_list").innerHTML = renderBattleReport_hook(msg,m,r);']]); //March reports battle rounds function
    uW.renderBattleReport_hook = t.hook2;
    t.renderBattleReportFunc.setEnable (true);
    uW.deleteAreport = t.e_deleteReport;
    uW.MoreReport = t.e_MoreReport;
    uW.PostReport = t.e_PostReport;
  },

  isRoundsAvailable : function (){
    var t = battleReports;
    return t.getReportDisplayFunc.isAvailable() || t.renderBattleReportFunc.isAvailable();
  },

  e_deleteReport : function (rptid){
    var t = battleReports;
    t.ajaxDeleteMyReport (rptid);
  },

  e_MoreReport : function (rptid,side){
    var t = battleReports;
    alert('WIP ;)');
  },

  e_PostReport : function (rptid){
      var msg = 'Rpt: ' + rptid;
      sendChat ("/a "+  msg);
  },

  SendChat:function(name,mess) {
    	var inp=ById('mod_comm_input');
    	inp.value="@"+name+' '+mess;
    	uW.Chat.sendChat();
  },

  ajaxDeleteMyReport : function (rptid, isUnread, side, isCityReport, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.s0rids = rptid;
    params.s1rids = '';
    params.cityrids = '';
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/deleteCheckedReports.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (rslt.ok && isUnread){
          Seed.newReportCount = parseInt(seed.newReportCount) - 1;
          uW.messages_notify_bug()
        }
        if (notify)
          notify (rslt.errorMsg);
      },
      onFailure: function () {
        if (notify)
          notify ('AJAX ERROR');
      },
    });
  },

  hookz : function (msg, rslt) {
    msg = msg.replace (/(\bReport\sNo\:\s([0-9]+))/g, '<a onclick=\'ptChatReportClicked($2,0)\'>$1</a>');
  return msg;
  },

  hook2 : function (msg, args, rslt){
	//alert('hook2 '+rslt);
    if (rslt.rnds && Options.dispBattleRounds){
      msg = msg.replace (/<\/ul>.*\s*<\/div>.*\s*<div class="unitsContainer">/im, '<li><span class=\'label\'>Rounds: </span><span class=\'value\'>'+ rslt.rnds +'</span></li></ul></div><div class="unitsContainer">');
    }
	if (Options.reportDeleteButton){
		msg = msg.replace(/Reports<\/span><\/a>/im, 'Reports</span></a><a class=\'button20\' onclick=\'PostReport('+args[0]+',false)\'><span>Post To Chat</span></a>'); //Post to Chat button
		msg = msg.replace(/Reports<\/span><\/a>/im, 'Reports</span></a><a class=\'button20\' onclick=\'MoreReport('+args[0]+','+args[1]+',false)\'><span>More</span></a>'); //More button
		msg = msg.replace(/Reports<\/span><\/a>/im, 'Reports</span></a><a class=\'button20\' onclick=\'deleteAreport('+args[0]+',false)\'><span>'+uW.g_js_strings.commonstr.deletetx+'</span></a>'); //Delete button
	}
    return msg;
  },
  hook : function (msg, rslt){
	//alert('hook '+rslt);
    if (rslt.rnds && Options.dispBattleRounds){
      msg = msg.replace (/(Attackers <span.*?)<\/div>/im, '$1<BR>Rounds: '+ rslt.rnds +'</div>');
    }
    return msg;
  },
}
var ChatStuff = {
  chatDivContentFunc : null,
  getChatFunc : null,
  leaders : {},
  init : function (){
   var t = ChatStuff;
   if(getMyAlliance()[0] > 0) t.getAllianceLeaders();
   t.chatDivContentFunc = new CalterUwFunc ('Chat.chatDivContent', [['return f.join("")', 'var msg = f.join("");\n msg=chatDivContent_hook(msg,d);\n return msg;']]);
   if (avatars2[uW.tvuid]) {
	 setTimeout(function() {
     ById("hudAvatarPic").style.backgroundImage = "url("+avatars2[uW.tvuid][1]+")";
     ById("hudAvatarPic").style.backgroundSize="50px 50px";
     },500);
   }
   uW.chatDivContent_hook = t.chatDivContentHook;
   uW.ptChatIconClicked = t.e_iconClicked;
   uW.chatDivContent_hook2 = t.chatDivContentHook2;
   uW.ptChatReportClicked = Tabs.Rpt.FindReport;
   uW.BOAttackDetect = t.attaque;
   uW.BOTransportDetect = t.transport;
   t.setEnable (Options.chatEnhance);
  },
  isAvailable : function (){
    var t = ChatStuff;
    t.chatDivContentFunc.isAvailable ();
  },
  chatDivContentHook2 : function (msg){
  	 	var div = document.createElement('div');
  	 	div.innerHTML = msg;
  	 	div.innerText = div.innerHTML;
  	 	msg = div.innerHTML.toString();
  	 	return msg.htmlSpecialCharsDecode();
  },
  transport: function(x,y) {
     var t = ChatStuff;
     if (!Options.pbWinIsOpen)
      nHtml.Click(ById("ptBoite"));
      setTimeout(function(){
        nHtml.Click(ById("pbtcTranspAuto").firstChild.firstChild);
          setTimeout(function() {
	      Tabs.TranspAuto.destinationCityx.value = x;
	      Tabs.TranspAuto.destinationCityy.value = y;
	      Tabs.TranspAuto.estimerRes();
      }, 100);
    }, 100);
  },
  attaque: function(x,y) {
   var t = ChatStuff;
   if (Options.ptWin2IsOpen){
     nHtml.Click(ById("sppAttaque"));
   } else {
     nHtml.Click(ById("ptBoite2"));
     nHtml.Click(ById("sppAttaque"));
   }
   setTimeout(function() {   ById("RAAtypetrpx").value=x;ById("RAAtypetrpy").value=y;myBO.Attaque.estimerRes();  }, 100);
  },
  setEnable : function (tf){
    var t = ChatStuff;
    t.chatDivContentFunc.setEnable (tf);
    if(ById("mod_comm_list1"))
      ById("mod_comm_list1").style.backgroundColor = Colors.ChatGlo;
  },
  e_iconClicked : function (name){
    ById('mod_comm_input').value='';
    var e = ById('mod_comm_input');
    name = name.replace(//g,"'");
    e.value = '@'+ name +' ';
    e.focus();
  },

  chatDivContentHook : function (msg,type){
   var t = ChatStuff;
   var classs = '',classsinfo='';
   var m = /div class='info'>.*<\/div>/im.exec(msg);
   if (m == null)  return msg;
   var whisp = m[0];

   if(type != null){
	if (type.indexOf('chuchote') >= 0 || type.indexOf('whispers to you') || type.indexOf('bisbiglia rivolto a') >= 0)  {
      classs = 'ptChatWhisper';
    } else if (type.indexOf('to the alliance')>= 0 || type.indexOf("alliance:") || type.indexOf("alleanza:") >= 0)  {
      classs = 'ptChatAlliance';
    } else
      classs = 'ptChatGlobal';



   for (var lag in culang) {

    if (m[0].indexOf(culang[lag].TowerAlerts.Type+' '+culang[lag].TowerAlerts.atkType) >= 0) {
      classs = 'ptChatScout';
      break;
    } else if (m[0].indexOf(culang[lag].TowerAlerts.Type+' '+culang[lag].TowerAlerts.atkType1) >= 0 || m[0].indexOf('ANGRIFF') >=0 || m[0].indexOf('Incoming Troops') >= 0) {
      classs = 'ptChatAttack';
      break;
    }
   }


   }

   var suid = /viewProfile\(this,([0-9]+),false/i.exec(m[0]);
    if(!suid)
    		suid = uW.tvuid;
    	else
		suid = suid[1];
	if (t.leaders[suid] && Options.ChatLearder) classsinfo = 'ptChat'+t.leaders[suid];
	if (avatars[suid]) {
	      msg = msg.replace (/\bhttps\:\/\/[-a-z].*png'/i, avatars[suid] + "'");
	}
	if (avatars2[suid]) {
		      msg = msg.replace (/\bhttps\:\/\/[-a-z].*png'/i, avatars2[suid][0] + "'");
	}
	if (scripters.indexOf(suid) >= 0) {
	  classs += ' ptChatScripter';
	}
	if (membersVIP.indexOf(suid) >= 0) {
	  classs += ' ptChatScripterVIP';
	}
    msg = msg.replace("class='chatIcon'", " class='chatIcon' onclick='getMessageWindow("+suid+",\"UID:"+suid+"\");return false;' ");
    if (suid==uW.tvuid && Options.icon_chat)
	msg = msg.replace (/\bhttps\:\/\/[-a-z].*png'/i, Options.URLicon+"'");
    msg = msg.replace ("class='content'", "class='content "+ classs +"'");
    msg = msg.replace ("class='nm'", "class='nm "+ classsinfo +"'");
    msg = msg.replace (/(Rpt:([0-9]+))/g, '<a onclick=\'ptChatReportClicked($2,0)\'>$1</a>');
    if (msg.indexOf('claimAllianceChat')<0)
      msg = msg.replace (/([0-9]{1,3})\s*(,|-)\s*([0-9]{1,3})/img, '$1,$3');
    msg = msg.replace (/(\bReport\sNo\:\s([0-9]+))/g, '<a onclick=\'ptChatReportClicked($2,0)\'>$1</a>');
	msg = msg.replace (/(\bRpt\s#([0-9]+))/g, '<a onclick=\'ptChatReportClicked($2,0,999)\'>$1</a>');
	msg = msg.replace (/(\W)(bao)(\W)/gi,'$1<a onclick=window.open("http://www.koc-bao.com")>$2</a>$3');
	msg = msg.replace (/(#([0-9]+))#/g, '<a onclick=\'ptChatReportClicked($2,0,999)\'>$1</a>');
    if (classs.indexOf('ptChatWhisper')>=0 && Options.WhisperOn && (m[0].indexOf('te chuchote:')>=0  || m[0].indexOf('whispers to')>=0  || m[0].indexOf('bisbiglia rivolto a')>=0 )) {
      msg = msg.replace ('whispers to you','<font size=1px color=red>you whispers</font>');
      msg = msg.replace ('te chuchote:','<font size=1px color=red> te murmure</font>');
      msg = msg.replace ('bisbiglia rivolto a','<font size=1px color=red>bisbiglia</font>');
   	  var s = Options.URLson5, nom="";

	  //var m = /(Lord|Lady) (.*?)</im.exec(msg);
   	  //if (m != null) { nom=m[2]; };

   	  //var th=/div class='tx'>(.*?)<\/div>/im.exec(msg);
	  //var h=th[0].replace("div class='tx'>","").replace("<\/div>","");
	  //if (nom!=""&&h!=null)chuchoLog(h,nom);

   	  var faudio = new Sound(s, function() {
   	  faudio.set('volume', 1);
	  faudio.play();
	  });

   }
   if (scripters.indexOf(suid) >= 0 || membersVIP.indexOf(suid) >= 0) {
   var activerson=1;
   if (Options.ChatVIP) activerson=0;
     for (k in SmileysVIP) {
      msg=msg.replace(k, '<img style="width:'+SmileysVIP[k][2]+'px !important;height:'+SmileysVIP[k][3]+'px !important" src=\"'+SmileysVIP[k][0]+'\"><span><object type="application/x-shockwave-flash" data="'+SWF_PLAYER_URL+'" height=25 width=200 id="dewplayer2" name="dewplayer2"><param name="wmode" value="transparent" /><param name="movie" value="'+SWF_PLAYER_URL+'" /><param name="flashvars" value="mp3='+SmileysVIP[k][1]+'&amp;autostart='+activerson+'&amp;;showtime=1&amp;volume=50" /></object></span>');
     }
	var myregexp1 = /(yt:(.*?))/i;
    if (msg.match(myregexp1)) {
        msg = msg.replace(/\(yt:(.*?)\)/, '<div style="text-align:left;width:250px;"><object width="240" height="180"><param name="movie" value="http://www.youtube.com/v/$1&amp;hl=en_US&amp;fs=1&autoplay='+activerson+'"></param><param name="allowFullScreen" value="true"></param><param name="autoPlay" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/$1&amp;hl=en_US&amp;fs=1&autoplay='+activerson+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="240" height="180"></embed></object></div>');
    }
 }
 for (var lag in culang) {
    if (Options.EclaireurOn && classs.indexOf('ptChatScout')>=0 && m[0].indexOf(' ** '+culang[lag].TowerAlerts.arrival+' ** ')) {
     msg = msg.replace (' ** '+culang[lag].TowerAlerts.arrival+' ** ',' *** '+culang[lag].TowerAlerts.arrival+' *** ');
      	  var s = Options.URLson7;
      	  var faudio = new Sound(s, function() {
      	  faudio.set('volume', 1);
   	  faudio.play();
	  });
   }
    if (Options.AttaqueOn && classs.indexOf('ptChatAttack')>=0 && (m[0].indexOf(' ** '+culang[lag].TowerAlerts.arrival+' ** ') || m[0].indexOf('ANGRIFF'))) {
         msg = msg.replace (' ** '+culang[lag].TowerAlerts.arrival+' ** ',' *** '+culang[lag].TowerAlerts.arrival+' *** ');
       	  var s = Options.URLson6;
	   	  var faudio = new Sound(s, function() {
	   	  faudio.set('volume', 1);
		  faudio.play();
	  });

    }
    if (m[0].indexOf(culang[lag].FoodAlerts.msg1) >= 0 && m[0].indexOf(culang[lag].FoodAlerts.msg2) >= 0) {
      try {
             var testt = /;'> ([0-9]+),<span><\/span>([0-9]+) <\/a>#/i.exec(m[0]);
             if (testt) {
                msg +='<div onclick="BOTransportDetect('+parseIntNan(testt[1])+','+parseIntNan(testt[2])+')" style="position: absolute; background-image: url(\'data:image/png;base64,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\');   background-repeat: no-repeat; border-radius: 3px 3px 3px 3px; height: 18px; width: 18px; border: 2px inset rgb(96, 0, 0); box-shadow: 0px 0px 2px rgb(255, 255, 255); left: 3px; top: 30px; "></div>';
             }
            } catch(e) {}

    }
    if (classs.indexOf('ptChatAttack')>=0 && m[0].indexOf(culang[lag].TowerAlerts.Type+' '+culang[lag].TowerAlerts.atkType1) >= 0 && m[0].indexOf(culang[lag].TowerAlerts.target) >= 0) {
           try {
            var testt = /;'> ([0-9]+),<span><\/span>([0-9]+) <\/a>#/i.exec(m[0]);
            if (testt) {
               msg +='<div onclick="BOAttackDetect('+parseIntNan(testt[1])+','+parseIntNan(testt[2])+')" style="position: absolute; background-image: url(\'data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAZAAA/+4ADkFkb2JlAGTAAAAAAf/bAIQAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAwMDAwMDAwMDAwEBAQEBAQECAQECAgIBAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMD/8AAEQgAEgASAwERAAIRAQMRAf/EAJgAAAIDAAAAAAAAAAAAAAAAAAYHAAgJAQABBQEAAAAAAAAAAAAAAAAFAQYHCAkKEAAABQIDBQQLAAAAAAAAAAABAgQFBwMGABI2ETFWNwghIzRlQYETM2QVNRYXZxgRAAIAAgcDCAUNAAAAAAAAAAECAwQAETESBQYHQSIyIWFiEzM0NQhRcVRkNkJScqIjUxQVZRZWFxj/2gAMAwEAAhEDEQA/AMPs5ANkE5APlE+QTlA2QogBqmUR25CiPabcGMu6mqvVGquqzb6PXzU6ny6BrhYB6iaqxXULTV6BtNgpo/C0Wxl0yRzb/Vd1TW033jcd1ovmvSz0xPqelWGQ6wlE7dM0ssyoO4ihtq7K7M2qSAW4KhSqq5Rbi0SLrEZIybg+SsHGoWoAA5K5WWYAszEbrFDa7fJU8ijebZTPHW/WPOetGcX8vHl7djGvXcWxVCRCloYNUSGsVeEKQREZTfdh1UPevMlSPz1e3DMTc9v6D5b2zqfhD6Vy98t8F8LgN/c/6TJ+JfiLB2X3XDxdKzmo/P8AH0T+XY38L/lfaP3j2zj+pxdKiJ+9LviyTI5eG+OW+/VjE+2pIiyJZUTOyGOr3t2ijWKWh5u5nqCiVqraXtTtVBurkA1B4OoKQSKkJVJcNnIT4DhEX9yZhErFlIERoaC6Ir9arIWhbjDlDojRIbn7O7eYBiqsH1vm8R1ezmuVNCIsVs8SklHlsQxSDMNDlZSTik9ZKsQGR5h3XcKjrYZG6ygllYUhS/IM93o/SzKT+vuW9rqVnruTitpLUlBPQpiAJmhjbF6Fsrs9vNRO4SpgTUSlJT2gBgynMJz3mzF824285icQGEvJChqylISGxRcd0LEVFmDMTtqNaicPLhpvlrTnTSUksDwibwrEZgFpsTghmdjRlYq0SO8MkFWILQgCAqEVKtlA3DLpPlBVl1FdurPc2XrvU+kGzwn6+4Z8p9ngxP8Ahsl3Pimu6dh3l+L3z273i9StPlu7HNPgHxHG8M+iveen8zmroVDv9Pr34DUsubdtJhaJT//Z\');   background-repeat: no-repeat; border-radius: 3px 3px 3px 3px; height: 18px; width: 18px; border: 2px inset rgb(96, 0, 0); box-shadow: 0px 0px 2px rgb(255, 255, 255); left: 4px; top: 55px; "></div>';
            }
           } catch(e) {}
    }
     if (classs.indexOf('ptChatScout')>=0 && m[0].indexOf(culang[lag].TowerAlerts.Type+' '+culang[lag].TowerAlerts.atkType) >= 0 && m[0].indexOf(culang[lag].TowerAlerts.target) >= 0) {
      try {
             var testt = /;'> ([0-9]+),<span><\/span>([0-9]+) <\/a>#/i.exec(m[0]);
             if (testt) {
                msg +='<div onclick="BOAttackDetect('+parseIntNan(testt[1])+','+parseIntNan(testt[2])+')" style="position: absolute; background-image: url(\'data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAUAAA/+4ADkFkb2JlAGTAAAAAAf/bAIQAAgICAgICAgICAgMCAgIDBAMCAgMEBQQEBAQEBQYFBQUFBQUGBgcHCAcHBgkJCgoJCQwMDAwMDAwMDAwMDAwMDAEDAwMFBAUJBgYJDQsJCw0PDg4ODg8PDAwMDAwPDwwMDAwMDA8MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAEgASAwERAAIRAQMRAf/EAJMAAAMBAQAAAAAAAAAAAAAAAAQFCAcJAQACAgMAAAAAAAAAAAAAAAACBQQGAAEHEAABAgMEBQURAAAAAAAAAAABAgMEBQYAETQHITESMjPwYUIUCEHBUmKCohNTY3ODVBVVFlaWEQABAgMFBgQHAAAAAAAAAAABAgMAEQQhMVESBfBBYXGBBpGhseHBIjJCghMU/9oADAMBAAIRAxEAPwCooGW52mUNVJmF2gZPR6n2y+7KKdpyDMvhB4CouauOOuhOgFRCL+a3L0u0hIQ2yVHiozPRMh6x0lymqkZlLcSkDgJDqZn0hrIJ5mBHoKqcz5pSr1BG22o0+wta03Ai4wc1Sm8gjo3aRotj7IYkpTKkg4mzzEFTFNQcgdQoi+VpE8bYG/L8xv2leK6vhobGes3OH7PzrRv2DDjDL+YeUoUV9kBGVfBVy1PYlqtzU0CiDp9Ma85BGSN+jcYdbgw2HWwHEulRWUbYUEnaIGzZ3oOusaefnanfMi+3nFQ7s7df1tkobfyKCkqSCDlCkkKE5XiYtnCPIrs/qyGy1rajIp6IrlU+gQiUxr8WtcRAOpCdhbbiYdsNlgNoS0EK7h0hNybO63uqidbDQbUU780t8JNE7N1JiqXUvvNhZCUgIBAATM/cZkme/dZGAfUc4/v0FiuocNWP+b3t7xNXPasSpsDj+OHvF+zVGI98Y6oMb3R8rvWTN3wa4FmuEiPdK4evVbTkHT/UOcR9/O47l8W0jx2+ETvC/brH/9k%3D\');   background-repeat: no-repeat; border-radius: 3px 3px 3px 3px; height: 18px; width: 18px; border: 2px inset rgb(96, 0, 0); box-shadow: 0px 0px 2px rgb(255, 255, 255); left: 4px; top: 55px; "></div>';
             }
      } catch(e) {}
     }
   }
   var m = /(Lord|Lady) (.*?)</im.exec(msg);
   if (m != null) {

      msg = msg.replace (/<img (.*?>)/img, '<A onclick=ptChatIconClicked(\"'+ m[2] +'\")><img class=\"ptChatIcon\" $1</a>');


  }
   if (Options.Smiley) {
	  var th=/div class='tx'.*<\/div>/im.exec(msg);
	  var h=th[0], m=th[0];

	  if (m != null)
      for (k in Smileys) {
        if (k=="(massage)")
          m=m.replace(k, '<img style="width:32px !important;height:24px !important" class=emoicon src=\"'+Smileys[k]+'\">');
          else if (k=="(pendue)")
              m=m.replace(k, '<img style="width:50px !important;height:65px !important" class=emoicon src=\"'+Smileys[k]+'\">');
              else if (k=="(tarzan)")
              m=m.replace(k, '<img style="width:158px !important;height:106px !important" class=emoicon src=\"'+Smileys[k]+'\">');
    else if (k=="(GoHabsGo)")
          m=m.replace(k, '<img style="width:60px !important;height:43px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="*kissing*")
          m=m.replace(k, '<img style="width:47px !important;height:30px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else  if (k=="(fouet)")
          m=m.replace(k, '<img style="width:60px !important;height:30px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(sonic)")
          m=m.replace(k, '<img style="width:64px !important;height:64px !important" class=emoicon src=\"'+Smileys[k]+'\">');
    else if ( k=="(renne)" || k=="(tigre)" || k=="(girafe)" || k=="(elephant)" || k=="(rat)" || k=="(abricot)")
          m=m.replace(k, '<img style="width:60px !important;height:60px !important" class=emoicon src=\"'+Smileys[k]+'\">');
    else if (k=="(spider)")
          m=m.replace(k, '<img style="width:95px !important;height:57px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(hamta)" || k=="(cat)")
          m=m.replace(k, '<img style="width:31px !important;height:40px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(shark2)")
          m=m.replace(k, '<img style="width:117px !important;height:50px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(concombre)")
          m=m.replace(k, '<img style="width:100px !important;height:50px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(baby)")
          m=m.replace(k, '<img style="width:56px !important;height:40px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="]:->" || k=="(pingouin)" || k=="(shark)")
          m=m.replace(k, '<img style="width:35px !important;height:35px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(bath)" || k=="(emotlove2)" || k=="(smyno)")
          m=m.replace(k, '<img style="width:40px !important;height:40px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(miroir)")
          m=m.replace(k, '<img style="width:45px !important;height:45px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(caribou)")
          m=m.replace(k, '<img style="width:65px !important;height:33px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(magebarbe)")
	      m=m.replace(k, '<img style="width:45px !important;height:45px !important" class=emoicon src=\"'+Smileys[k]+'\">');
else if (k=="(ghost)")
          m=m.replace(k, '<img style="width:90px !important;height:97px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(couette)" || k=="(ver)")
          m=m.replace(k, '<img style="width:60px !important;height:45px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(fox)" || k=="(heidy)")
          m=m.replace(k, '<img style="width:30px !important;height:30px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(autruche)")
          m=m.replace(k, '<img style="width:93px !important;height:84px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(panda)" || k=="(crabe)" || k=="(tortue)"|| k=="(vache)" || k=="(singe)" || k=="(bravo2)" || k=="(bubulle)" || k=="(chien)" || k=="(cuicui)" || k=="(bubulle)" || k=="(cochon)" || k=="(lapin)" || k=="(grenouille)")
	  m=m.replace(k, '<img style="width:66px !important;height:66px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(herisson)" || k=="(lion)" || k=="(chat)" || k=="(papillon)"  || k=="(serpent)" || k=="(dragon)" || k=="(camelot)")
          m=m.replace(k, '<img style="width:77px !important;height:77px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(ours)" || k=="(taupe)" || k=="(cali)" || k=="(teresa)" || k=="(banane)" || k=="(vaseline)")
          m=m.replace(k, '<img style="width:88px !important;height:88px !important" class=emoicon src=\"'+Smileys[k]+'\">')
          else if (k=="(fraise)")
          m=m.replace(k, '<img style="width:150px !important;height:100px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(bienmal)")
          m=m.replace(k, '<img style="width:109px !important;height:60px !important" class=emoicon src=\"'+Smileys[k]+'\">')
        else if (k=="(aigle)")
          m=m.replace(k, '<img style="width:65px !important;height:100px !important" class=emoicon src=\"'+Smileys[k]+'\">');
                  else if (k=="(pistolet)")
          m=m.replace(k, '<img style="width:120px !important;height:76px !important" class=emoicon src=\"'+Smileys[k]+'\">');
        else if (k=="(hippo)")
          m=m.replace(k, '<img style="width:73px !important;height:115px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	 else if (k=="(lapin1)" || k=="(lapin2)" || k=="(lapin3)")
          m=m.replace(k, '<img style="width:96px !important;height:96px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else if (k=="(Foot)" || k=="(pique)")
          m=m.replace(k, '<img style="width:110px !important;height:110px !important" class=emoicon src=\"'+Smileys[k]+'\">');
      else if (k=="(gemini)")
		            m=m.replace(k, '<img style="width:50px !important;height:55px !important" class=emoicon src=\"'+Smileys[k]+'\">');
		   else if (k=="(sniper)")
		            m=m.replace(k, '<img style="width:79px !important;height:19px !important" class=emoicon src=\"'+Smileys[k]+'\">');
		   else if (k=="(ent)")
          m=m.replace(k, '<img style="width:50px !important;height:56px !important" class=emoicon src=\"'+Smileys[k]+'\">');
         else if (k=="(soviet)")
		            m=m.replace(k, '<img style="width:187px !important;height:270px !important" class=emoicon src=\"'+Smileys[k]+'\">');
		      else if (k=="(tank)")
          m=m.replace(k, '<img style="width:200px !important;height:150px !important" class=emoicon src=\"'+Smileys[k]+'\">');
          else if (k=="(PDJ)")
          m=m.replace(k, '<img style="width:200px !important;height:135px !important" class=emoicon src=\"'+Smileys[k]+'\">');
          		      else if (k=="(viking)")
          m=m.replace(k, '<img style="width:176px !important;height:184px !important" class=emoicon src=\"'+Smileys[k]+'\">');
	else
	  m=m.replace(k, '<img class=emoicon src=\"'+Smileys[k]+'\">');
    }
    msg=msg.replace(h,m);
   }
   return msg;
  },
  getAllianceLeaders : function (){
   var t = ChatStuff;
    var params = uW.Object.clone(uW.g_ajaxparams);
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/allianceGetLeaders.php" + uW.g_ajaxsuffix, {
		 method: "post",
		 parameters: params,
		 loading: true,
		 onSuccess: function (rslt) {
			 if (rslt.officers) {
				for (uid in rslt.officers) {
					var user = rslt.officers[uid];
					t.leaders[user.userId] = user.type.substr(0,4);
				}
			 }
		},
		onFailure: function () {}
  		});
	},
}

var knightRoles = [[uW.g_js_strings.commonstr.politics, 'politics', 'Pol'],[uW.g_js_strings.commonstr.marshal, 'combat', 'Com'],[uW.g_js_strings.commonstr.alchemystic, 'intelligence', 'Int'],[uW.g_js_strings.commonstr.steward, 'resourcefulness', 'Res']];
function formatUnixTime(a,b){var c=uW.formatDateByUnixTime(a);return c}
function readTrainingOptions(){var a=getServerId();s=GM_getValue("TrainingOptions_"+a);if(s!=null){opts=JSON2.parse(s);for(k in opts){TrainOptions[k]=opts[k]}}}
function saveTrainingOptions(){var a=getServerId();setTimeout(function(){GM_setValue("TrainingOptions_"+a,JSON2.stringify(TrainOptions))},0)}
myBO.Gift = {
 cont : null,
 kdodisp:{},
 amis:[],
 init : function (){
    var t = myBO.Gift;
    setTimeout(function() {
		 if (Options.HideMerlin)
		  uW.Modal.hideModal();
	 },3000);
    t.cont = document.createElement('div');
    return t.cont;
  },
   getContent : function (){
     var t = myBO.Gift;
     return t.cont;
   },
   hide : function (){
     var t = myBO.Gift;
   },
   show : function (){
    var t = myBO.Gift;
    var  m = "<DIV class=boStat><b>"+lang.Gift.title+"</b></div>";
    m+="<br>"+lang.Gift.gift+"<select id=BOKdoSel>";
    var params = uW.Object.clone(uW.g_ajaxparams);
          params.ctrl = "GiftItems";
          params.action = "getGiftItems";
        new MyAjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
         method: "post",
            	        parameters: params,
            	        onSuccess: function (rslt) {
       	          if (rslt.ok){

       	             t.kdodisp = rslt.giftItems;

    for (k in t.kdodisp) {
     if (t.kdodisp[k].itemId) {
      m+="<option value='"+t.kdodisp[k].itemId+"' "+ (Options.KDODef==t.kdodisp[k].itemId?'SELECTED ':'') +">"+uW.ksoItems[t.kdodisp[k].itemId].name+"</option>";
     }

    }
    m+="</select>";
    m+="<input type='button' value='"+lang.General.send+"' id=BOKdoVal>&nbsp;<input type='button' value='Reset' id=BOKdoRst>&nbsp;<span id=BOKdoResul></span><hr><div id=BOKdoContenu style='max-height:400px;overflow-y:auto'></div>";
    m+="<br><hr>"+pubdusite;
        t.cont.innerHTML = m;
        ById("BOKdoSel").addEventListener('change', function(e){ Options.KDODef=ById("BOKdoSel").value;saveOptions(); },false);
        ById("BOKdoVal").addEventListener('click', function(e){ t.sendGift(); },false);
        ById("BOKdoRst").addEventListener('click', function(e){ Options.KDOUser={}; saveOptions(); },false);

        t.findFriends();
       } // fin rsl.ok
      }
    });// fin de la requete de la liste des kdo dispo
   },
   saveUser: function(userId) {
    var t = myBO.Gift;
    if (Options.KDOUser===undefined)
     Options.KDOUser={};
     if (Options.KDOUser[userId]===undefined)
        Options.KDOUser[userId]="OK";
   },
   findFriends:function() {
    var t = myBO.Gift;
    uW.BOSaveUserGift = t.saveUser;
    var m="<table width=100%><tr><td width=30>&nbsp;</td><td></td><td></td></tr>";
        var params = uW.Object.clone(uW.g_ajaxparams);
                params.ctrl = "allianceGifting\\AllianceGiftingServiceAjax";
                params.action = "getRecipients";
              new MyAjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
               method: "post",
                  	        parameters: params,
                  	        onSuccess: function (rslt) {
          	          if (parseInt(rslt.freeSlot)>0) {
          	          var rsp=rslt.recipients;
          	          var amis = "";
          	          for (k in rsp) {
          	           if (rsp[k].userId) {

          	             m+="<tr><td><input type=checkbox id='KDO"+rsp[k].userId+"' "+(Options.KDOUser[rsp[k].userId]?'CHECKED ':'')+" onchange='BOSaveUserGift("+rsp[k].userId+");'></td><td>"+rsp[k].displayName+"</td><td>"+rsp[k].userId+"</tr>";
          	           }
          	           ById("BOKdoContenu").innerHTML=m+"</table>";
       	          }


       	        }else {

       	         ById("BOKdoContenu").innerHTML=m+"<tr><td colspan=3>"+lang.Gift.nobody+"</table>";
       	         ById("BOKdoVal").disabled=true;

       	       }  }
       	    });// fin de la requete de la liste des kdo dispo
   },
   sendGift:function() {
    var t = myBO.Gift;
    var amis="";
     for (k in Options.KDOUser)
     {
       	    if (ById("KDO"+k))
       	        amis += k +"|";
     }
     amis = amis.substring(0,amis.length-1);
     if (Options.KDODef==0) Options.KDODef=931;
     if (amis!="") {
     var params = uW.Object.clone(uW.g_ajaxparams);
		                params.ctrl = "allianceGifting\\AllianceGiftingServiceAjax";
		                params.action = "sendGift";
		                params.itemId=Options.KDODef;
		                params.recipients = amis;
		              new MyAjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
		               method: "post",  parameters: params,
               	        onSuccess: function (rslt) {
               	           ById("BOKdoContenu").innerHTML=lang.Gift.oksend;
               	        }
        });
    } else {
      ById("BOKdoResul").innerHTML=lang.Gift.nomembers;
    }
  },
}
myBO.Attaque = {
 cont : null,
 displayTimer : null,
 state : null,
 curTabBut : null,
 curTabName : null,
 BOAttackTimer: null,
 sourceCity : {},
 destinationCity : {},
 rows : [],
 iused : new Array(),
 init : function (){
   var t = myBO.Attaque;
   t.cont = document.createElement('div');
   t.state = null;
   clearTimeout (t.displayTimer);
   return t.cont;
 },
  getContent : function (){
    var t = myBO.Attaque;
    return t.cont;
  },
  hide : function (){
    var t = myBO.Attaque;
    t.state = null;
    clearTimeout (t.displayTimer);
  },
  addsacrifice:function(cityId,unitId,qte) {
  	 var t = myBO.Attaque;
      var params=uW.Object.clone(uW.g_ajaxparams);
      params.cid=cityId;params.type=unitId;params.quant=qte;
      var profiler=new uW.cm.Profiler("ResponseTime","train.php");
      new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/sacrifice.php" + unsafeWindow.g_ajaxsuffix, {
  	       			method: "post",
  	       			parameters: params,
  	    			onSuccess: function (rslt) {
						 profiler.stop();
  						 var rslt=eval("("+rslt.responseText+")");

  						 if(rslt.ok) {
  						   Seed.queue_sacr["city"+cityId].push(rslt.queue_sacr);
  						   Seed.units["city"+cityId]=rslt.units;
						   Seed.cityData.city[cityId].population=rslt.cityData_city.population;
	 				       Seed.cityData.city[cityId].populationCap=rslt.cityData_city.populationCap;
  						   t.updateFey(t.sourceCity);
  						 }
  				    }
  	});
    },
    CancelSacrifice:function(cityId,queueNumber) {
     var t = myBO.Attaque;
     var queue=Seed.queue_sacr["city"+cityId][queueNumber];
     var profiler=new uW.cm.Profiler("ResponseTime","train.php");
     var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
     params.cid = cityId;
     params.type=queue.unitType;params.quant=queue.quantity;params.start=queue.start;params.eta=queue.eta;
     new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/cancelSacrificing.php" + unsafeWindow.g_ajaxsuffix, {
         			method: "post",
         			parameters: params,
      			onSuccess: function (rslt) {
					profiler.stop();
  					var rslt=eval("("+rslt.responseText+")");
  					 if(rslt.ok)
  					   Seed.queue_sacr["city"+cityId].splice(queueNumber,1);
  			    }
  		});
  },


  timerritual:null,
  updateFey:function(city) {
  	 var t = myBO.Attaque;
  	 clearTimeout(t.timerritual);



       var O = Seed.queue_sacr["city"+Seed.cities[city.idx][0]],L=uW.cm.BlessingSystemController.getSelectedBlessings(),J=uW.cm.BlessingSystemModel.getActiveBlessingNames(),M=uW.cm.BlessingSystemModel.getActiveBlessingDescriptions();
       var H=uW.unixtime();
       var G="";
       G+='<div class="effect"><b>'+uW.g_js_strings.sacrifice_tooltip.active_rituals+'</b></div><table width=95%>';
       if(O.length>0){
       var x=0;
       $.each(O,function(P,R){

  	  var Q=parseInt(R.eta,10)-H,S=Math.round((R.multiplier[0]-1)*100),T=R.buffedUnitType[0];
  	  G+="<tr><td><b>"+uW.g_js_strings.sacrifice_tooltip["unitdesc"+T].replace("%1$s",S)+"</b></td><td>"+uW.g_js_strings.sacrifice_tooltip.duration_left.replace("%1$s",timestr(Q))+"";
  	  G+="<td><a id=button_training_cancel class=button20 onclick='BOCancelSac("+Seed.cities[city.idx][0]+","+(x)+");return false;' href=#><span>"+uW.g_js_strings.commonstr.cancel+"</span></a></td></tr>";
  	  x++;
  	 })

  	}else {
  		G+="<tr><tr><b>"+uW.g_js_strings.commonstr.none+"</tr>";
      }
      G+="</table>";
      ById('boSacContenu').innerHTML=G;
      t.timerritual=setTimeout(function() {
  		 t.updateFey(city);
  	 },2000);
  },
  show : function (){
    var t = myBO.Attaque;
    uW.BOCancelSac = t.CancelSacrifice;
    var rownum = 0;
    var ModelCity = {};
    if (t.state == null) {
         m = "<DIV class=boStat><b>"+lang.Attaque.title+"</b> - <input type=button value='?' id=boaideattaquer class=boAide></div>";
         m +="<div id='statpourRAA'></div>";
         var itemlist=[55,57,931,932],BOitems="<table><tr>";
		 for(var i=0;i<itemlist.length;i++){
		 	BOitems += "<td><img src='"+gameurl+"img/items/30/"+itemlist[i]+".jpg' /></td><td><input type=checkbox id='BOitem_"+itemlist[i]+"'><font size=1><br><span id='BOitemSpan_"+itemlist[i]+"'>" + uW.ksoItems[itemlist[i]].count + "</span></font></td>";
         }
         BOitems+="</table>";
         m += "<TABLE width=600 class=ptTab border=0 align=center>\
           <tr align=center><td colspan=1 width=130><b><u>"+lang.General.source+"</b></u><br><span id=RAAsrcRptspeedcity></span</td>\
           <td colspan=1><b><u>"+lang.General.dest+"</b></u><br><span id='BOrefreshCo'>X:</span><input type=text id=RAAtypetrpx size=3>&nbsp;Y:<input type=text id=RAAtypetrpy size=3></td>\
           <td><b><u>Distance :</u></b> <span id='BOEstimationD'>&nbsp;</span><br>PR : <span id='BOEstimationPR'>&nbsp;</span></tr><tr align=center valign=top>\
           <td colspan=4 align=left valign=top><table border=0 bordercolor=black cellspacing=0 cellpadding=0 width=100% style='text-align:center'><tr><td rowspan=20 width=110><div id=RAAstatsource></div></td><td width=50><a href='javascript:void(0)' id=BO_RAZ_Units>"+uW.g_js_strings.commonstr.troops+"</a></td><td width=50>"+lang.Attaque.TimeAttack+"</td><td width=50>"+lang.Attaque.Timerenforce+"</td>\
           <td rowspan=15 valign=top><table borde=0 width=100%><tr><td><a href='javascript:void(0);' id='BOchargelistelieux'><b><u>"+lang.General.members+"</b></u></a><br><select id='listeFavori'></select><br>\
           <b><u>"+lang.Attaque.BOVilleProche+"</u></b>&nbsp;<span id=BOVilleProche></span><br><br><b><u>"+uW.g_js_strings.commonstr.knight+"</b></u><br><SELECT id='RAApiKnight' type=list></select></td></tr>\
		   <tr><td><br><div id=BOinfodest></div><center><input type=button  class=pbButton value='"+lang.General.now+"' id=BOrechdest><br><br>"+BOitems+"</tr>\
		   <tr><td><input type=checkbox name='' class='spellcb' id='modal_attack_spell21' disabled/><img title='"+uW.g_js_strings.spells["name_21"]+"' class='icon' src='"+uW.stimgUrl+"img/spell_lifesteal_70x70.jpg' style='width:30px;height:30px'/><span id=spelltime21></span>\
		   &nbsp;<input type=checkbox name='' class='spellcb' id='modal_attack_spell11' disabled/><img title='"+uW.g_js_strings.spells["name_11"]+"' class='icon' src='"+uW.stimgUrl+"img/spell_hidden_path_70x70.jpg' style='width:30px;height:30px'/><span id=spelltime11></span>\
		   &nbsp;</table>";
         var r=0;
         for (y in uW.unitcost) {
		  r++;
   	       m += '<tr><td align=right><input style="border:1px solid black;height:16px;font-size:11px;" id="RAAnbunit'+r+'" type=text size=7 value="0" ></td><td><span id="BOEstimationTT'+r+'">&nbsp;</span></td><td><span id="BOEstimationTZ'+r+'"></tr>';
      	}

        m += "</table></td></tr>\
              <tr><td colspan=4><center><input type=button class=pbButton id=REEaction value='"+lang.Attaque.scout+"'>&nbsp;<input type=button class=pbButton id=RAAaction value='"+lang.Attaque.attack+"'><input class=pbButton type=hidden id=RAAactionB value='B'>&nbsp;<input type=button class=pbButton id=RENaction value='"+lang.Attaque.renforce+"'><input type=hidden class=pbButton id=RAAactionRB value='B'>&nbsp;<input type=button class=pbButton id=RENBaction value='"+lang.Attaque.renforcefood+"'>&nbsp;&nbsp;<input type=button class=pbButton id=RAIDaction value='RAID'><br><div id=ptRAAStatus style='overflow-y:auto; max-height:30px; height:30px;max-width:590px;'></center></td></tr>\
              <tr><td colspan=4><b><div class=boStat onclick=document.getElementById('BOAhiddee00').style.display=(document.getElementById('BOAhiddee00').style.display=='none')?'block':'none';>"+uW.g_js_strings.commonstr.throneroom+"</div></tr></table>\
              <div id=BOAhiddee00 style='display:block;'><TABLE width=600 class=ptTab border=0 align=center><tr><td colspan=3>";
              m += '<TABLE border=0 cellspacing=0 width=80% cellpadding=2 class=ptTab><tr>';
              var ee=1;
			         for (k= 1; k <= Seed.throne.slotNum; k++)
			  	    	{
							if (ThroneOptions.presetname[k]==undefined) ThroneOptions.presetname[k]="";
			  	             m += '<td width=25%><center><button class="pbButton'+(Seed.throne.activeSlot==k?"_selected":"")+'" id="BOAttackTrone_'+k+'">'+ k +' - '+ThroneOptions.presetname[k]+'</button>';
			  	             if (++ee%4==1) m+="</td><tr>";
			  	    }
				 m+="</tr></table></td><td><center><a id=BOPresetNam href=javascript:void(0);>"+lang.AUTOTRONE.equip.preset2+"</a></td></tr></table></div>\
              <TABLE width=600 class=ptTab border=0 align=center><tr><td colspan=4><div class=boStat onclick=document.getElementById('BOAhiddee0').style.display=(document.getElementById('BOAhiddee0').style.display=='none')?'block':'none';>"+uW.g_js_strings.sacrifice.trainttl+"</div></tr></table>\
               <div id=BOAhiddee0 style='display:block;'><TABLE width=600 class=ptTab border=0 align=center><tr><td colspan=4><center>QTE: <input type=text size=5 value=2000 id=BOQteSac>&nbsp;<span id=BOTimeSac></span>&nbsp;";
               var r=0;
			   for (y in uW.unitcost) {
			   	 r++;
			   	 m+= '<img id="BOUnitSac_'+r+'" height=20 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg>&nbsp;';
       			}
        m += "</center></tr><tr><td colspan=4><span id=boSacContenu></span></td></tr></table></div><tr><td colspan=4><b><div class=boStat onclick=document.getElementById('BOAhiddee1').style.display=(document.getElementById('BOAhiddee1').style.display=='none')?'block':'none';>"+lang.Attaque.BO_AT_Fav+"</div></tr></table>\
              <div id=BOAhiddee1 style='display:none;'><TABLE width=600 class=ptTab border=0 align=center><tr><td colspan=2><select id=BO_AT_Fav></select><input type=button class=pbButton  value='"+lang.Attaque.BO_AT_Fav_Sup+"' id=BO_AT_Fav_Sup><input class=pbButton type=button value='"+lang.Attaque.BO_AT_Fav_RESET+"' id=BO_AT_Fav_RESET></td><td colspan=2>"+lang.Attaque.BO_AT_Fav_Nom+" : <input type=type id=BO_AT_Fav_Nom size=10 maxlength=12>&nbsp;<input type=checkbox id=BO_AT_Fav_Coo> coords&nbsp;<input type=image src='"+SAVE_IMG+"' title='"+lang.General.save+"' id=BO_AT_Fav_ajou>\
              </table></div>\
              <TABLE width=600 class=ptTab border=0 align=center><tr><td colspan=4><b><div class=boStat onclick=document.getElementById('BOAhiddee2').style.display=(document.getElementById('BOAhiddee2').style.display=='none')?'block':'none';>"+lang.Attaque.titleprog+"</div></tr></table>\
              <div id=BOAhiddee2 style='display:none;'><TABLE width=600 class=ptTab border=0 align=center><tr><td><input class=pbButton type=button id='BOActiveAttack' value='"+lang.Attaque.buttonactiv+" : OFF' ></td><td colspan=3><span id='BOCompAttack'></span></tr>\
              <tr><td><b>"+lang.Attaque.timeAr+"</b><input type=text size=7 id='BOHorloge' value='" + Options.AttackHorloge + "'></td><td><input type=image src='"+SAVE_IMG+"' title='"+lang.General.save+"' id='BOSaveAttack'></td><td><input class=pbButton type=button value='"+lang.General.edit+"' id='BOEditAttack' disabled></td></tr>\
              <tr><td colspan=4><span id='BOAttackProg'></span></td></tr></table></div>";
        t.cont.innerHTML = m;
	   var r=0;
	   for (y in uW.unitcost) {
			  r++;
		  	  ById("BOUnitSac_"+r).addEventListener ('click', function() {
				  var uni=this.id.replace("BOUnitSac_","");
				  var a=confirm("Voulez vous sacrifier "+ById("BOQteSac").value+" "+uW.unitcost['unt'+uni][0]+" ?");
				  if (a) t.addsacrifice(t.sourceCity.id,uni,ById("BOQteSac").value);
			   }, false);

		}
		ById("BOTimeSac").innerHTML=uW.timestr((uW.cm.AltarModel.getBuffDuration(null, ById("BOQteSac").value, uW.cm.TIME.SECONDS)).toFixed(0));
		ById("BOQteSac").addEventListener ('change', function() {
			ById("BOTimeSac").innerHTML=uW.timestr((uW.cm.AltarModel.getBuffDuration(null, ById("BOQteSac").value, uW.cm.TIME.SECONDS)).toFixed(0));
		}, false);
		 ById("BOPresetNam").addEventListener ('click', function( ) {
				    Tabs.Options.namePreset();
	   }, false);
		for (k= 1; k <= Seed.throne.slotNum; k++)
			    	{
						ById("BOAttackTrone_"+k).addEventListener ('click', function( ) {
							var p = this.id.replace("BOAttackTrone_","");
							Tabs.Throne.doPreset(p);
						}, false);
			}
        t.statpourRAA = ById ('statpourRAA');
        t.Favoris = ById('BO_AT_Fav');
        t.BOinfodest = ById('BOinfodest');
        t.BOrechdest = ById("BOrechdest");
        ById('boaideattaquer').addEventListener('click', function(){window.open(sitesupport+"?page=aide_attaquer");} , false);
		var r=0;
		for (y in uW.unitcost) {
			r++
	          ById("RAAnbunit"+r).addEventListener ('change', function() {
	  					if (parseIntNan(this.value)<0) this.value=0;
	  					var nomcha2=this.id.replace("RAAnbunit","RAAdestunit");
	  					if (parseIntNan(this.value)>parseIntNan(ById(nomcha2).value)) this.value=parseIntNan(ById(nomcha2).value);
	  					t.estimerRes();
	  			},false);
	    }

        t.BOrechdest.addEventListener ('click', function() {t.rechercheDEST();}, false);
	   function metajourfavori() {
	       t.Favoris.innerHTML="<option value=''>...</option>";
	       var lisf = Options.AttackFav;
	       for (var m in lisf) {
	         var lis = lisf[m];
	         if (lis!=null)
	          t.Favoris.innerHTML+="<option value='"+m+"'>"+lis[0]+"</option>";
      	       }
	  }
     ById("BO_AT_Fav_RESET").addEventListener ('click', function() {	 Options.AttackFav={};	 saveOptions();         metajourfavori();       }, false);
      ById("BO_AT_Fav_Sup").addEventListener ('click', function() {
       numfav=ById("BO_AT_Fav").value;
       if (numfav!="") {
        Options.AttackFav[numfav]={};
        delete Options.AttackFav[numfav];
        saveOptions();
        metajourfavori();
       }
       }, false);
 	  ById("BO_RAZ_Units").addEventListener ('click', function() {var r=0;  for (y in uW.unitcost) {r++;ById("RAAnbunit"+r).value=0;} 	}, false);

      ById("BO_AT_Fav_ajou").addEventListener ('click', function() {
        if (ById("BO_AT_Fav_Nom").value=="") {
         alert(lang.Attaque.error1);
         return;
        }
        var a=ById("BO_AT_Fav_Nom").value;
        Options.AttackFav[a]={};
        var lisf = Options.AttackFav[a];
        lisf[0]=ById("BO_AT_Fav_Nom").value;
        var r=0;
		for (y in uW.unitcost) {
			r++;
			lisf[r]=ById("RAAnbunit"+r).value;

		}
        if (ById("BO_AT_Fav_Coo").checked) {
         lisf[20]=t.destinationCityx.value;
         lisf[21]=t.destinationCityy.value;

        }
        ById("BO_AT_Fav_Coo").checked=false;
        ById("BO_AT_Fav_Nom").value="";
           saveOptions();
	    metajourfavori();
       }, false);
       ById("BO_AT_Fav").addEventListener ('change', function() {
         numfav=ById("BO_AT_Fav").value;
         if (numfav=="") {
           var r=0;
		   for (y in uW.unitcost) {
			   r++;
			  ById("RAAnbunit"+r).value=0;

			  }

         }else {
          var lisf = Options.AttackFav[numfav];
          for (var m in lisf) {
           if(m>0 && m<20)
	         if (ById("RAAnbunit"+m))
	           ById("RAAnbunit"+m).value=lisf[m];
	       if (m==20)
	        if (lisf[m]>0)
	         t.destinationCityx.value=lisf[m];
	       if (m==21)
	        if (lisf[m]>0)
	         t.destinationCityy.value=lisf[m];
	  }
         }
       }, false);
       ById("BOitem_55").addEventListener ('click', function() {
        ById("BOitem_57").checked=false;
        t.estimerRes();
       }, false);
       ById("BOitem_57").addEventListener ('click', function() {
              ById("BOitem_55").checked=false;
              t.estimerRes();
       }, false);
        t.statutRAA = ById ('ptRAAStatus');
        t.destinationCityx = ById ('RAAtypetrpx');
        t.destinationCityy = ById ('RAAtypetrpy');
        t.destinationCityx.value = Options.Xrenfort;
        t.destinationCityy.value = Options.Yrenfort;
        if (ById ('maparea_map').style.display!="none") {
         t.destinationCityx.value = ById ('mapXCoor').value;
         t.destinationCityy.value = ById ('mapYCoor').value;
         t.rechercheDEST();
        }
        ById("BOrefreshCo").addEventListener ('click', function () {
         t.destinationCityx.value = ById ('mapXCoor').value;
         t.destinationCityy.value = ById ('mapYCoor').value;
         t.rechercheDEST();
           t.estimerRes();
        }, false);
        t.listeFavoris = ById ('listeFavori');
        t.listeFavoris.addEventListener ('change', t.SelectFavoris, false);
        t.chargelistelieux = ById ('BOchargelistelieux');
        t.chargelistelieux.addEventListener ('click', t.chercherFavoris, false);
        t.actionREN = ById ('RENaction');
        t.actionRENB = ById ('RENBaction');
        t.actionREE = ById ('REEaction');
        t.actionRAA = ById ('RAAaction');
  	    t.actionREN.addEventListener ('click', function () { t.clickATTAQUEDo(2,0,false,0); }, false);
        t.actionRAA.addEventListener ('click',  function () { t.clickATTAQUEDo(4,0,false,0); }, false);
        ById ('RAIDaction').addEventListener ('click', function () { t.saveRAID(); }, false);
        ById('RAAactionB').addEventListener ('click',  function () { t.clickATTAQUEDo(4,0,true,0); }, false);
        ById('RAAactionRB').addEventListener ('click',  function () { t.clickATTAQUEDo(2,0,true,0); }, false);
        t.actionRENB.addEventListener ('click',  function () { t.clickATTAQUEDo(2,1,false,0); }, false);
        t.actionREE.addEventListener ('click',  function () { t.clickATTAQUEDo(3,0,false,0); }, false);
        t.destinationCityx.addEventListener ('keyup', function () { t.estimerRes(); }, false);
        t.destinationCityy.addEventListener ('keyup', function () { t.estimerRes(); }, false);
        var dcp0 = new CdispCityPicker ('ptRAA0', ById('RAAsrcRptspeedcity'), false, t.clickRAACitySourceSelect, Cities.byID[uW.currentcityid].idx);
        t.state = 1;
        t.estimerRes();
        t.BOAttackProg = ById ('BOAttackProg');
        t.BOHorloge = ById ('BOHorloge');
        t.BOSaveAttack = ById ('BOSaveAttack');
        t.BOEditAttack = ById ('BOEditAttack');
        t.BOCompAttack = ById ('BOCompAttack');
        t.BOActiveAttack  = ById ('BOActiveAttack');
        t.BOActiveAttack.addEventListener ('click', t.AutoattackOnOff, false);
        t.BOSaveAttack.addEventListener ('click', function () {
        var itemlist=[55,57,931,932];
	  for(var i=0;i<itemlist.length;i++){
	        ById('BOitemSpan_'+itemlist[i]).checked=false;
          }
         t.enregistreAttack();
        }, false);
        if (Options.AttackCibleX!=0 && Options.AttackCibleY!=0) {
         t.BOEditAttack.disabled=false;
        }
        t.BOEditAttack.addEventListener ('click', function () {
          t.destinationCityx.value = Options.AttackCibleX;
          t.destinationCityy.value = Options.AttackCibleY;
          ById("RAApiKnight").value=Options.AttackKnight;
          nHtml.Click(ById("ptRAA0_"+Cities.byID[Options.AttackFromCity].idx));
           var r=0;
		  		  		   	       for (y in uW.unitcost) {
			   r++;
	      ById("RAAnbunit"+r).value=Options.AttackUnits[r-1];
          }
        }, false);
        metajourfavori();
        if (Options.AttackOnOff) {
          t.BOActiveAttack.value=lang.Attaque.buttonactiv+' : ON';
    	  t.activeAttack();
        }
        t.clickRAACitySourceSelect(t.sourceCity);
       }
       t.updateFey(t.sourceCity);
    },
    saveRAID:function() {
		var t = myBO.Attaque;
		var x=t.destinationCityx.value;
        var y=t.destinationCityy.value;
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.pf = 0;
		params.ctrl = 'BotManager';
		params.action = 'saveMarch';
		params.settings = {};
    	params.queue = {0:{botMarches:{botMarchStatus:1,botState:1},cityMarches:{}}};
    	params.queue[0].cityMarches.knightId = ById("RAApiKnight").value;
		params.queue[0].cityMarches.toXCoord = x;
		params.queue[0].cityMarches.toYCoord = y;
		params.queue[0].cityMarches.unit1Count = parseIntNan(ById("RAAnbunit1").value);
		params.queue[0].cityMarches.unit2Count = parseIntNan(ById("RAAnbunit2").value);
		params.queue[0].cityMarches.unit3Count = parseIntNan(ById("RAAnbunit3").value);
		params.queue[0].cityMarches.unit4Count = parseIntNan(ById("RAAnbunit4").value);
		params.queue[0].cityMarches.unit5Count = parseIntNan(ById("RAAnbunit5").value);
		params.queue[0].cityMarches.unit6Count = parseIntNan(ById("RAAnbunit6").value);
		params.queue[0].cityMarches.unit7Count = parseIntNan(ById("RAAnbunit7").value);
		params.queue[0].cityMarches.unit8Count = parseIntNan(ById("RAAnbunit8").value);
		params.queue[0].cityMarches.unit9Count = parseIntNan(ById("RAAnbunit9").value);
		params.queue[0].cityMarches.unit10Count = parseIntNan(ById("RAAnbunit10").value);
		params.queue[0].cityMarches.unit11Count = parseIntNan(ById("RAAnbunit11").value);
		params.queue[0].cityMarches.unit12Count = parseIntNan(ById("RAAnbunit12").value);
		params.queue[0].cityMarches.unit13Count = parseIntNan(ById("RAAnbunit13").value);
		params.queue[0].cityMarches.unit14Count = parseIntNan(ById("RAAnbunit14").value);
		params.settings.cityId = t.sourceCity.id;
		new AjaxRequest2(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
		    		  		method: "post",
		    		         parameters: params,
		    				 loading: true,
		    				 onSuccess: function(transport){
		    					var rslt = eval("(" + transport.responseText + ")");
		    	                  if (rslt.ok) {
		      	                  		setTimeout(function() { unsafeWindow.update_seed_ajax(true); }, 500);
		      	                  		t.statutRAA.innerHTML = "<center><font size='2px'><b>OK !</b></font></center>";
		      	                  		t.clickRAACitySourceSelect(t.sourceCity);
		    					 } else {
									  t.statutRAA.innerHTML = "<center><font size='2px'><b>"+rslt.msg+"</b></font></center>";
		    					 }
		    				 },
    		 });
	},
    getclosestcity : function (){
	var t = myBO.Attaque;
	var x1 = parseIntNan(t.sourceCity.x);
	var x2 = parseIntNan(t.destinationCityx.value);
	var y1 = parseIntNan(t.sourceCity.y);
	var y2 = parseIntNan(t.destinationCityy.value);
	var dist = distance (x1, y1, x2, y2);
     	var closestDist=999999;
     	var closestLoc=null;
 	var closestNum=1;
 	for (var c=0; c<Cities.numCities; c++){
	 var city = Cities.cities[c];
	 var dist=distance(city.x,city.y,x2,y2);
	 if(dist<closestDist) {
 	  closestDist=dist;
 	  closestLoc=city.x +','+ city.y;
 	   closestNum=c;
	  }
	}
	return closestNum;
    },
    MapAjax : new CMapAjax(),
    rechercheDEST:function() {
     var t = myBO.Attaque;
     t.BOinfodest.innerHTML="<center>"+uW.g_js_strings.commonstr.research+"</center>";
     var xcoord=t.destinationCityx.value;
     var ycoord=t.destinationCityy.value;
     t.MapAjax.request (xcoord, ycoord, 1, function(left, top, width, rslt) {
       	   map = rslt.data;
     	   for (k in map){
		   if (xcoord==map[k].xCoord && ycoord==map[k].yCoord) {
		    var m="";
		    var uid=map[k].tileUserId;

		    if (uid==null || uid==0 || uid=="0") {
		     t.BOinfodest.innerHTML="<center>---</center>";
		     return;
		    }
		    var params = uW.Object.clone(uW.g_ajaxparams);
		               params.checkArr = uid;
		               new MyAjaxRequest(uW.g_ajaxpath + "ajax/getOnline.php" + uW.g_ajaxsuffix, {
		                 method: "post",
		                 parameters: params,
		               onSuccess: function (rslt) {
		                  var p = rslt.data;
		         	  if (p[uid] == true) {
		         	         m = '<span style="color:green"><b>'+uW.g_js_strings.commonstr.online+'</b></span>';
		         	       } else {
		         	          m = '<center><span style="color:red"><b>'+uW.g_js_strings.commonstr.offline+'</b></span>';
		                   }
		                   var params = uW.Object.clone(uW.g_ajaxparams);
			           params.pid = uid;
				   new MyAjaxRequest(uW.g_ajaxpath + "ajax/viewCourt.php" + uW.g_ajaxsuffix, {
				         method: "post",
				         parameters: params,
				         onSuccess: function (rslt) {
				            t.BOinfodest.innerHTML="<center><b><a onclick=boshowthrone("+uid+",'"+rslt.playerInfo.displayName+"','Calc');>" + rslt.playerInfo.displayName+"</a></b><bR>"+m;
				         },
				         onFailure: function (rslt) {},
    				   });
		             },onFailure: function (rslt) {},
			 });
		  }
           }
     });
    },
    AutoattackOnOff:function() {
     var t = myBO.Attaque;
     t.BOCompAttack.innerHTML='';
     clearTimeout (t.BOAttackTimer);
     if (t.BOActiveAttack.value==lang.Attaque.buttonactiv+' : OFF') {
    	t.BOActiveAttack.value=lang.Attaque.buttonactiv+' : ON';
    	     Options.AttackOnOff = true;
    	     saveOptions();
    	     t.activeAttack();

    	    } else {
    	     Options.AttackOnOff = false;
    	     saveOptions();
    	     t.BOActiveAttack.value=lang.Attaque.buttonactiv+' : OFF';
    }
    },
    activeAttack:function() {
     var t = myBO.Attaque;
     clearTimeout (t.BOAttackTimer);
     if (Options.AttackGoHorloge) {
       var depart=new Date()
       depart.setTime(Options.AttackGoHorloge);
       var now = unixTime()*1000;
       if (now >= Options.AttackGoHorloge) {
	t.BOCompAttack.innerHTML='<center><font color=red>'+lang.Attaque.BOCompAttack+'</font></center>';
	t.destinationCityx.value = Options.AttackCibleX;
	t.destinationCityy.value = Options.AttackCibleY;
	ById("RAApiKnight").value=Options.AttackKnight;
	nHtml.Click(ById("ptRAA0_"+Cities.byID[Options.AttackFromCity].idx));
	 var r=0;
			  		   	       for (y in uW.unitcost) {
		r++;
	   ById("RAAnbunit"+r).value=Options.AttackUnits[r-1];
          }


      setTimeout(function() { t.clickATTAQUEDo(4,0, false, 0); }, parseInt((Math.random()*1500)+100));
      clearTimeout (t.BOAttackTimer);
      Options.AttackGoHorloge=null;
      Options.AttackOnOff = false;
      saveOptions();
      return;
     }
     if (now > depart.getTime()) {
         t.BOCompAttack.innerHTML='<center><font color=red>'+lang.Attaque.error2+'</font></center>';
         clearTimeout (t.BOAttackTimer);
       	 Options.AttackGoHorloge=null;
         saveOptions();
         return false;
     }
     t.BOAttackTimer=setTimeout(function(){
        var depart=new Date();
	depart.setTime(Options.AttackGoHorloge);
        var now = unixTime()*1000;
        var tempsrestant = depart.getTime() - now;
        t.BOCompAttack.innerHTML='<center><font color=red><b>'+lang.Attaque.BOCompAttackIn+' '+timestr(tempsrestant/1000)+'</b></font></center>';
        t.activeAttack();
      },1000);
     }
    },
    enregistreAttack : function() {
     var t = myBO.Attaque;
     if (t.BOHorloge.value.match("^[0-9]{2}:[0-9]{2}:[0-9]{2}$")) {
       var horloge = t.BOHorloge.value;
       Options.AttackHorloge = horloge;
       var ndate=new Date();
       ndate.setHours(horloge.substr(0,2));
       ndate.setMinutes(horloge.substr(3,2));
       ndate.setSeconds(0);
       var atunits=new Array();
       var r=0;
	  		  		   	       for (y in uW.unitcost) {
			   r++;
          atunits.push(parseIntNan(ById("RAAnbunit"+r).value));
       }
       Options.AttackUnits = atunits;
       Options.AttackFromCity = t.sourceCity.id;
       Options.AttackKnight = ById("RAApiKnight").value;
       Options.AttackCibleX = t.destinationCityx.value;
       Options.AttackCibleY = t.destinationCityy.value;

       var x1 = parseIntNan(t.sourceCity.x);
       var x2 = parseIntNan(t.destinationCityx.value);
       var y1 = parseIntNan(t.sourceCity.y);
       var y2 = parseIntNan(t.destinationCityy.value);
       var dist = distance (x1, y1, x2, y2);
       var tempplusgrand=0;
       var r=0;
	   for (y in uW.unitcost) {
		 r++;
         if (parseIntNan(ById("RAAnbunit"+r).value)>0) {
               var m = estETA(dist, r, t.sourceCity.id,4);
               if (tempplusgrand<m.ETA) tempplusgrand=m.ETA;
         }
       }
       var departtime=ndate.getTime() - (tempplusgrand*1000);
       var depart=new Date()
       depart.setTime(departtime);
       var now = unixTime()*1000;
       if (now > depart.getTime()) {
        t.BOAttackProg.innerHTML = lang.Attaque.error3;
        return false;
       }
       Options.AttackGoHorloge =  depart.getTime();
       saveOptions ();
       t.BOAttackProg.innerHTML = Options.AttackCibleX + ","+ Options.AttackCibleY +" "+lang.Attaque.saved;
       t.BOEditAttack.disabled=false;
     } else {
      t.BOAttackProg.innerHTML = lang.Attaque.error4;;
     }
    },
    clickATTAQUEDo: function(typemarche, bouffe, porc) {
      var t = myBO.Attaque;
      var totalunit=0;
      if (typemarche==3 && parseIntNan(ById("RAAnbunit3").value)==0) ById("RAAnbunit3").value=1;
       var r=0;
	   for (y in uW.unitcost) {
		 r++;
         if (typemarche==3 && r!=3) {
          ById("RAAnbunit"+r).value=0;
         }
          if (parseIntNan(ById("RAAnbunit"+r).value) > parseIntNan(ById("RAAdestunit"+r).value)) {
            ById("RAAnbunit"+r).style.backgroundColor="red";
            return false;
          }
          totalunit=totalunit+parseIntNan(ById("RAAnbunit"+r).value);
          ById("RAAnbunit"+r).style.backgroundColor="";
      }
     var errMsg = "";
     if (isNaN (t.destinationCityx.value) ||t.destinationCityx.value<0 || t.destinationCityx.value>749)
       errMsg = "X doit &ecirc;tre entre 0 et 749<BR>";
     if (isNaN (t.destinationCityy.value) || t.destinationCityy.value<0 || t.destinationCityy.value>749)
       errMsg += "Y doit &ecirc;tre entre 0 et 749<br>";
     if (ById("RAApiKnight").value==0 && typemarche==4) {
       errMsg += uW.g_js_strings.modal_attack.chooseknightlead + "<BR>";
     }
     if (errMsg != "") {
          t.statutRAA.innerHTML = "<FONT COLOR=#550000>"+ errMsg +"</font>";
          return;
     }
     var x=t.destinationCityx.value;
     var y=t.destinationCityy.value;
     t.SaveCoordsOptions(x,y);
     var params = uW.Object.clone(uW.g_ajaxparams);

     if($(".spellcb").prop("checked")){
	 		params.bs=$(".spellcb").attr("id").replace("modal_attack_spell","");
	 }


     if (totalunit==0) {
         t.statutRAA.innerHTML = '<FONT COLOR=#550000>'+uW.g_js_strings.modal_attack_do.sendtroop+'</font>';
         return;
     }
     var BOitem_932=0,BOitem_931=0;
	 var l_elem=ById("BOitem_931");
	 if(l_elem&&l_elem.checked&&parseInt(Seed.items["i931"])>0){ BOitem_931=1;	}
	 var l_elem=ById("BOitem_932");
	 if(l_elem&&l_elem.checked&&parseInt(Seed.items["i932"])>0){  BOitem_932=1;  }
     var maxtroupe=March.getMaxSize(t.sourceCity.id,BOitem_931,BOitem_932);

     if (totalunit>maxtroupe) {
       t.statutRAA.innerHTML = '<FONT COLOR=#550000>Impossible avec plus de '+maxtroupe+' unit&eacute;es a la fois.</font>';
       return;
      }
      var iused=new Array();
      var itemlist=[55,57,931,932];
      for(var i=0;i<itemlist.length;i++){
       var l_elem=ById("BOitem_"+itemlist[i]);
       if(l_elem&&l_elem.checked&&parseInt(Seed.items["i"+itemlist[i]])>0){
        iused.push(itemlist[i]);
       }
      }
      var res=0;
      if (bouffe==1) {
        var r=0;
	   	for (yy in uW.unitcost) {
		r++;
        res += parseInt(uW.unitstats[yy][5] * ById("RAAnbunit"+r).value * (1 + (0.10 * Seed.tech.tch10)));
          }
       }
     params.items=iused.join(",");
     params.cid= t.sourceCity.id;
     params.type = typemarche;
     params.xcoord = x;
     params.ycoord = y;
     var unitsarr = {};
     if (typemarche==3)
           params.kid=0;
     else
   	       params.kid=ById("RAApiKnight").value;
	params.r1 = res;
    var r=0;
	for (y in uW.unitcost) {
	 r++;
     if (typemarche!=3) {
      if (ById("RAAnbunit"+r))
        if (parseIntNan(ById("RAAnbunit"+r).value)>0) {
		  params["u" + r] = unitsarr[r] = parseIntNan(ById("RAAnbunit"+r).value);
        } else {
		  unitsarr[r] = 0;
        }
	  }else {
	    params.u3 = ById("RAAnbunit3").value;
	  }
    }
  	t.actionRAA.disabled=true;    t.actionREN.disabled=true;    t.actionREE.disabled=true;
	t.statutRAA.innerHTML = "<i><b>"+uW.g_js_strings.commonstr.loadingddd+"</b></i>";
	var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
	new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
	  method: "post",   parameters: params, loading: true,
	  onSuccess: function (transport) {
	    var t = myBO.Attaque;
	    profiler.stop();
	    var rslt = eval("(" + transport.responseText + ")");
	    t.actionRAA.disabled=false; t.actionREN.disabled=false; t.actionREE.disabled=false;
	    if (rslt.ok) {
		  if(rslt.bsEndDate){
			  var h={1:11,2:21,3:31};
			  var ii=h[Seed.cityData.city[cityId].prestigeInfo.prestigeType];
			  Seed.cityData.city[params.cid].spells={};
			  Seed.cityData.city[params.cid].spells[ii]={endDate:parseInt(rslt.bsEndDate)};
			  $("#modal_attack_spell"+ii).attr("checked",false);
			  $("#modal_attack_spell"+ii).attr("disabled",true);
		  }
          var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
          var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
	      var ut = uW.unixtime();
	      var resources=[0,0,0,0,0];
	      for(var i=0; i<=4; i++) if (params["r"+i]) resources[i] = parseIntNan(params["r"+i]);
	      uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, params.cid, true,ut+rtimediff);
	      if (typemarche==2) var typeattaque=lang.Attaque.marche2;
	      if (typemarche==4) var typeattaque=lang.Attaque.marche3;
	      if (typemarche==3) var typeattaque=lang.Attaque.marche4;
     	  t.statutRAA.innerHTML = "<center><font color=#005500><b>"+typeattaque+"</b></font></center>";
          t.actionRAA.disabled=false;t.actionREE.disabled=false;t.actionREN.disabled=false;
	      var ut = uW.unixtime();
		  boosted = false;
		  uW.updateBoosts(rslt);
		  if (rslt.liftFog) {
		     boosted = true;
		     Seed.playerEffects.fogExpire = 0;
		     uW.g_mapObject.getMoreSlots();
		  }
		  if (boosted) uW.update_boosts()
		  if (parseInt(rslt.knightCombatBoostTime) > 0) {}
		var mpiused = "no";
		if (iused.length > 0) mpiused = "yes"
		for (var i = 0; i < iused.length; i++) {
		                          Seed.items["i" + iused[i]] = parseInt(Seed.items["i" + iused[i]]) - 1;
		                          uW.ksoItems[iused[i]].subtract();
		}
	    t.clickRAACitySourceSelect(t.sourceCity);
      	if (porc) t.clickATTAQUEDo(typemarche, bouffe, porc);
      	//if(rslt.updateSeed){unsafeWindow.update_seed(rslt.updateSeed)};
      } else {
		if (rslt.user_action) {
		 if (rslt.user_action=="marchWarning") {
	      t.statutRAA.innerHTML ="<font COLOR=#550000>" + uW.g_js_strings.modal_attack.useractionwarningtitle  +"</font>";
	     }
		 if (rslt.user_action=="marchCaptcha") {
	      t.statutRAA.innerHTML ="<font COLOR=#550000>" + g_js_strings.modal_attack.useractioncaptchap1 +"</font>";
	     }
	     if (rslt.user_action=="backOffWaitTime") {
	       //t.statutRAA.innerHTML ="<br><font color=black size='2px'>" + uW.g_js_strings.modal_attack.useractionwarningtitle  +"</font>";
	       uW.cm.MarchModal.setBackedOff(true);
	       setTimeout(function () {
			   t.clickATTAQUEDo(typemarche, bouffe, porc);
			}, rslt.wait_time * 1000)

		 }
	    } else {
	      t.statutRAA.innerHTML ="<font COLOR=#550000>" + rslt.error_code +" : " + (rslt.msg || "error") +"</font>";
	      if (rslt.error_code == 213 || rslt.error_code == 212) {
		   Seed.knights['city'+params.cid]['knt'+params.kid].knightStatus = 10;
	       t.clickRAACitySourceSelect(t.sourceCity);
	       t.clickATTAQUEDo(typemarche, bouffe, porc);
	      }
	      if (rslt.error_code == 3 || rslt.error_code == 8 || rslt.error_code == undefined)
	       t.clickATTAQUEDo(typemarche, bouffe, porc);
	    }

      }

	},
	onFailure: function () {
	                    var t = myBO.Attaque;
	                    profiler.stop();

	                    t.statutRAA.innerHTML = lang.Attaque.error0;
	                    t.actionRAA.disabled=false;
      			        t.actionREN.disabled=false;
      			        t.actionREE.disabled=false;
	                  }
	    });
    },
    Timerpr:null,
    slotPRTimer:function() {
		var t = myBO.Attaque;
		clearTimeout(t.Timerpr);
		ById("BOEstimationPR").innerHTML = "<b>" + March.getMarchSlots(t.sourceCity.id) + " / " + March.getTotalSlots(t.sourceCity.id) +"</b>";
		t.Timerpr=setTimeout(function() { t.slotPRTimer(); }, 4000);
	},
    estimerRes: function() {
     var t = myBO.Attaque;
     var x1 = parseInt(t.sourceCity.x);
     var x2 = parseInt(t.destinationCityx.value);
     var y1 = parseInt(t.sourceCity.y);
     var y2 = parseInt(t.destinationCityy.value);
     var dist = distance (x1, y1, x2, y2);
     t.slotPRTimer();
     ById("BOEstimationD").innerHTML = '<b>' + dist + '</b>&nbsp;<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ t.destinationCityx.value +','+ t.destinationCityy.value +')</a>';
     var r=0,finalETA=0,finalETAfriend=0;
	 for (y in uW.unitcost) {
	   r++;
       var m = estETA(dist, r, t.sourceCity.id,4);
       var m2 = estETA(dist, r, t.sourceCity.id,2);
       finalETA=m.ETA;
	   finalETAfriend=m2.friendETA;
	   ById("BOEstimationTT"+r).innerHTML = "<b>" + timestr(finalETA,1) + "</b>";
       ById("BOEstimationTZ"+r).innerHTML = "<b>" + timestr(finalETAfriend,1) + "</b>";
     }
    var closestDist=999999;
	var closestLoc=null;
	var closestNum=1;
	for (var c=0; c<Cities.numCities; c++){
	var city = Cities.cities[c];
	var dist=distance(city.x,city.y,x2,y2);
	if(dist<closestDist) {
	 closestDist=dist;
	 closestLoc=city.x +','+ city.y;
	 closestNum=c+1;
	}
	}
	ById("BOVilleProche").innerHTML='<input type="submit" value="'+closestNum+'" class="castleBut castleButNon">'
    },
    SelectFavoris:function() {
      var t = myBO.Attaque;
      if (t.listeFavoris.value!='') {
       var valeur=t.listeFavoris.value;
       var x=valeur.substr(0, valeur.lastIndexOf(','));
       var y=valeur.substr(valeur.lastIndexOf(',')+1, valeur.length);
       t.destinationCityx.value = x;
       t.destinationCityy.value = y;
      }
      t.estimerRes();
     },
      chercherFavoris: function() {
      var t = myBO.Attaque;
      var myA = getMyAlliance ();
      if (myA[0]!=0) {
       var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
       params.perPage = 100;params.type="might";params.page = 1; params.allianceId = myA[0];
             new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getUserLeaderboard.php" + unsafeWindow.g_ajaxsuffix, {
   	        method: "post",
   	        parameters: params,
   	        onSuccess: function (rslt) {
   	          if (rslt.ok){
   	           var z=0;
   	           var m="";
   	           for (var i=0; i<rslt.results.length; i++){
        		      p = rslt.results[i];
   		      if (p.userId != 0){
   		       for (var c=0; c<p.cities.length; c++){
   		         if (Seed.player.name!=p.displayName) {
   		          m += "<option value='" + p.cities[c].xCoord + ","+ p.cities[c].yCoord+"'>" + p.displayName + " - Ville " + (c+1) + " - " + p.cities[c].xCoord + "," + p.cities[c].yCoord+"</option>";
   		         }
   		       }
   		      }
         	    }
         	    t.listeFavoris.innerHTML="<option value=''>...</option>"+m;
   	          }
   	        },
   	        onFailure: function (rslt) {
   	          t.listeFavoris.innerHTML="<option>...</option>";
   	        },
       	});
      } else {
        t.listeFavoris.innerHTML="<option>...</option>";
      }
  },
   SaveCoordsOptions: function(x,y) {
       Options.Xrenfort = x;
       Options.Yrenfort = y;
       saveOptions ();
  },
  clickRAACitySourceSelect : function (city){
     var t = myBO.Attaque;
     if (t.sourceCity!=city) {
      t.sourceCity = city;
     }
     t.updateFey(t.sourceCity);
	if (uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing("BLOOD_MAGIC"), t.sourceCity.id)) {
     if (Seed.cityData.city[t.sourceCity.id].spells && Seed.cityData.city[t.sourceCity.id].spells[21] && parseInt(Seed.cityData.city[t.sourceCity.id].spells[21].endDate)>uW.unixtime()) {
	 	 $("#modal_attack_spell21").attr("checked",false).attr("disabled",true);
	 	 var i=Seed.cityData.city[t.sourceCity.id].spells[21].endDate-uW.unixtime();
		 $("#spelltime21").html(" (<i onclick=cm.SpellsView.speedup(21);>" +uW.cm.log.convertToHMS(i)+ "</i>)");
	  } else {
	     $("#modal_attack_spell21").attr("checked",false).attr("disabled",false);
	     $("#spelltime21").html("");
	  }
	 } else {
		 $("#modal_attack_spell21").attr("checked",false).attr("disabled",true);
		 $("#spelltime21").html("");
	 }

	 if (uW.cm.BlessingSystemModel.getBlessing("NATURE_MAGIC") && uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing("NATURE_MAGIC"), t.sourceCity.id)) {
	  if (Seed.cityData.city[t.sourceCity.id].spells && Seed.cityData.city[t.sourceCity.id].spells[11] && parseInt(Seed.cityData.city[t.sourceCity.id].spells[11].endDate)>uW.unixtime()) {
	  	 	 $("#modal_attack_spell11").attr("checked",false).attr("disabled",true);
	  	 	 var i=Seed.cityData.city[t.sourceCity.id].spells[11].endDate-uW.unixtime();
	  		 $("#spelltime11").html(" (<i onclick=cm.SpellsView.speedup(11);>" +uW.cm.log.convertToHMS(i)+ "</i>)");
	  	  } else {
	  	     $("#modal_attack_spell11").attr("checked",false).attr("disabled",false);
	  	     $("#spelltime11").html("");
	  }
 	} else {
		 $("#modal_attack_spell11").attr("checked",false).attr("disabled",true);
		 $("#spelltime11").html("");
	}
     var m="";
     m="<table cellspacing=0 cellpadding=0 width=80%><tr><td colspan=2>"+uW.g_js_strings.commonstr.troops+"</tr>";
     var cityID = 'city'+ t.sourceCity.id;
     var r=0;
	 for (y in uW.unitcost) {
			   r++;
       m += '<tr><td align=right><img title="'+uW.unitcost[y][0]+'" height=20 src='+gameurl+'img/units/unit_'+r+'_30.jpg></td>\
             <td align=left><input style="border:1px solid black;height:16px;font-size:11px;" id="RAAdestunit'+r+'" type=text size=7 readonly value="'+parseIntNan(Seed.units[cityID]['unt'+r])+'">&nbsp;\
             <input type=button value=">" id="RAApdestunit'+r+'"  style="border:1px solid black;height:16px;font-size:11px;"></td></tr>';
     }
     m += "</table>";
     ById("RAAstatsource").innerHTML = m;
        var knt = new Array();
        for (k in Seed.knights['city' + t.sourceCity.id]){
               		if (Seed.knights['city' + t.sourceCity.id][k]["knightStatus"] == 1 && Seed.leaders['city' + t.sourceCity.id]["resourcefulnessKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"] && Seed.leaders['city' + t.sourceCity.id]["politicsKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"] && Seed.leaders['city' + t.sourceCity.id]["combatKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"] && Seed.leaders['city' + t.sourceCity.id]["intelligenceKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"]){
               			knt.push ({
               				Name:   Seed.knights['city' + t.sourceCity.id][k]["knightName"],
               				Combat:	Seed.knights['city' + t.sourceCity.id][k]["combat"],Intel:	Seed.knights['city' + t.sourceCity.id][k]["intelligence"],
               				ID:	Seed.knights['city' + t.sourceCity.id][k]["knightId"],
               			});
               		}
               }
               knt = knt.sort(function sort(a,b) {a = parseInt(a['Combat']);b = parseInt(b['Combat']);return a == b ? 0 : (a > b ? -1 : 1);});
               ById('RAApiKnight').innerHTML="";
               var o = document.createElement("option");
     	       o.text = uW.g_js_strings.modal_attack.dchooseknightd;
     	       o.value = 0;
               ById("RAApiKnight").options.add(o);
               for (k in knt){
            			if (knt[k]["Name"] !=undefined){
        	    			var o = document.createElement("option");
        	    			o.text = (knt[k]["Name"] + ' (C' + knt[k]["Combat"] +' I' + knt[k]["Intel"] +')')
        	    			o.value = knt[k]["ID"];
        	    			ById("RAApiKnight").options.add(o);
            			}
         }
      if (ById('RAApiKnight').options.length>0) {
       ById('RAApiKnight').selectedIndex=1;
      }

      var itemlist=[55,57,931,932];
      for(var i=0;i<itemlist.length;i++){
        ById('BOitemSpan_'+itemlist[i]).innerHTML = unsafeWindow.ksoItems[itemlist[i]].count;
      }
     var r=0;
	 for (y in uW.unitcost) {
	   r++;
       ById("RAApdestunit"+r).addEventListener ('click', function() {
		    var t = myBO.Attaque;
       var nomcha=this.id.replace("RAApdest","RAAdest");
       var nomcha2=this.id.replace("RAApdestunit","RAAnbunit");
       ById(nomcha2).value=0;
       var BOitem_932=0,BOitem_931=0;
	   var l_elem=ById("BOitem_931");
	   if(l_elem&&l_elem.checked&&parseInt(Seed.items["i931"])>0){ BOitem_931=1;	}
	   var l_elem=ById("BOitem_932");
	   if(l_elem&&l_elem.checked&&parseInt(Seed.items["i932"])>0){  BOitem_932=1;  }
       var maxtroupe=March.getMaxSize(t.sourceCity.id,BOitem_931,BOitem_932);
       var nbunitto=0,r=0;
	   for (y in uW.unitcost) {
		 r++;
		 if (parseIntNan(ById("RAAnbunit"+r).value)<0) ById("RAAnbunit"+r).value=0;
          nbunitto+=parseIntNan(ById("RAAnbunit"+r).value);
	    }
        var libre = parseIntNan(maxtroupe - nbunitto);
        if (ById(nomcha).value>=libre) {
           ById(nomcha2).value = libre;
         }  else {
           ById(nomcha2).value= ById(nomcha).value;
         }
         t.estimerRes();
        }, false);
     }
     if (t.sourceCity!=city) {
            var r=0;
		   	 for (y in uW.unitcost) {
			   r++;
            ById("RAAnbunit"+r).value="0";
           }
     } else {
          var r=0;
		  for (y in uW.unitcost) {
			   r++;
              if (ById("RAAnbunit"+r).value=="") ById("RAAnbunit"+r).value="0";
              if (ById("RAAdestunit"+r).value=="") ById("RAAdestunit"+r).value="0";
                if (parseInt(ById("RAAnbunit"+r).value)>parseIntNan(ById("RAAdestunit"+r).value)) {
                 ById("RAAnbunit"+r).value="0";
                }
           }
     }
     t.estimerRes();
   },
}

myBO.Stock= {
   cont : null,timer: null,
   init : function (){
    var t = myBO.Stock;
    uW.BOutiliser = t.useItem;
    t.cont = document.createElement('div');
    return t.cont;
   },
   getContent : function (){
       var t = myBO.Stock;
       return t.cont;
   },
   hide : function (){
       var t = myBO.Stock;
       t.state = null;
       clearTimeout (t.displayTimer);
   },
   show : function (){
      var t = myBO.Stock;
      m = "<DIV class=boStat>"+lang.stock.title+"</div>";
      m += "<div style='max-height:480px; height:480px; overflow-y:auto' id='BOStockContenu'></div>";
      t.cont.innerHTML = m;
      t.voir();
   },
   voir:function() {
    var t = myBO.Stock;
    var category = ['',lang.stock.cat1,lang.stock.cat2,lang.stock.cat3,lang.stock.cat4,lang.stock.cat5,lang.stock.cat6];
    var puipui={1490:2250,1492:11250,1493:15000,1481:13000,1485:15000,1489:13000,1410:500,1444:300,1331:2000,1469:900,1473:750,1477:50000,1340:450,1454:525,1330:400,1350:600,1475:1500,1411:2000,1412:10,1440:300,1468:675,1476:10000,1455:1350,1370:700,1381:3000,1471:100,1390:900,1474:1000,1465:1350,1351:3000,1445:400,1452:175,1461:90,1371:3500,1391:4500,1427:150,1443:200,1311:1000,1401:1800,1341:2250,1321:2000,};
    var puitotal=0;
    var m = "<TABLE border=0 align=center><tr><td colspan=2><b>"+lang.stock.col1+"</td><td><b>"+lang.stock.col2+"</td><td><b>"+lang.stock.col3+"</td><td></td></tr>";
      var test = Seed.items;
      var e=uW.Object.keys(Seed.items);
      var lestock = [];
      for(var d=0;d<e.length;d++) {
       var h=e[d].split("i")[1];
       var pui=0;
       if(uW.itemlist["i"+h] && parseInt(Seed.items[e[d]])>0){
        if ((parseInt(h)<1100 || parseInt(h)>1199) && parseInt(uW.itemlist["i"+h].category)>0) {
         if (puipui[h])
          pui=puipui[h] * parseInt(Seed.items[e[d]]);
         m += "<tr><td><img title='"+h+"' id='BOitem"+h+"' onclick='BOutiliser("+h+");' src='"+gameurl+"img/items/70/"+ h + ".jpg' width=25></td><td>"+uW.itemlist["i"+h].name+"</td><td><center><b>"+Seed.items["i"+h]+"</td><td>"+ category[unsafeWindow.itemlist["i"+h].category] + "</td>";
         m+="<td>"+addCommas(pui)+"</td>";
         m+="</tr>";
         puitotal=puitotal+pui;
        }
       }
      }
      if (puitotal>0) {

      m+="<tr><td colspan=4>"+lang.stock.puitotal+"</td><td><b>"+addCommas(puitotal)+"</tr></table>";

      }
    ById('BOStockContenu').innerHTML = m;
   },
   useItem : function(num) {
		var t = myBO.Stock;
		uW.cm.ItemController.use(num);
		 t.voir();
	},

}
myBO.Info = {
  cont : null,
  state : null,
  ModelCity : {},
  init : function (){
    var t = myBO.Info;
    t.cont = document.createElement('div');
    return t.cont;
  },

  getContent : function (){
    var t = myBO.Info;
    return t.cont;
  },

  hide : function (){
    var t = myBO.Info;
  },

  show : function (){
    fortmight = {u53: "4",u55: "7",u60: "1",u61: "2",u62: "3",};
    var t = myBO.Info;
    rownum = 0;
    m = '<STYLE>.xtabH {background:#ffffe8; border:none; padding-right: 5px; padding-left: 5px; margin-left:10px; }\
              .xtabHL { background:#ffffe8; border-width: 1px; border-style: none none none solid; padding-right:5px; padding-left:5px; margin-left:10px; }\
              .xtabL { background:none; border-width: 1px; border-style: none none none solid; padding-right:5px; padding-left: 5px; margin-left:10px; }\
              .xtabLine { padding:0px; spacing:0px; height:1px; border-color:black; border-width: 1px; border-style: none none solid none }</style>\
          <DIV style="height:650px; max-height:650px; overflow-y:auto; overflow-x:auto"><DIV class=boStat><b>'+lang.info.title1+'</div>\
          <table border=0 width=100%><tr><td colspan=2><center><b><a href=http://www.facebook.com/groups/142657062507166/ target=_blank><font size=3>SUPPORT DE LA BOITE SUR FACEBOOK</font></a></td>\
          </tr><tr><td width=50%>La carte koc.dunno.com : <a target=_blank HREF="http://koc.dunno.com/index.sjs?f=KocMapViewer&server_id=' + getServerId() +'">Domain ' + getServerId() +'</A>\
          </td><td><a target=_blank HREF="http://koc-bao.com">Site Web koc-bao</a></td></tr>\
          <tr><td><a HREF="http://forum.koc-bao.com" target=_blank>Forum Support KOC BAO</a></td><td>Sons dispo : <a href=http://www.koc-bao.com/phpBB3/viewtopic.php?f=18&t=1744 target=_blank>FAQ</a></td></table><br>\
          <DIV class=boStat>'+lang.info.title2+'</div><TABLE align=center cellpadding=1 cellspacing=0 width=98%>\
          <TR align=center><td colspan=15><center><SPAN id=BOInfoCity></span></tr><TR align=center><TD class=xtab></td><TD class=xtabHL><B>Entr</b></td><TD class=xtabHL colspan=5><B>COST TO BUILD</b></td><TD class=xtabHL colspan=8><B>STATS</b></td></tr>\
          <TR valign=bottom align=right><TD class=xtab></td><TD class=xtabHL>Food</td><TD class=xtabHL>Food</td><TD class=xtabH>Wood</td><TD class=xtabH>Stone</td>\
          <TD class=xtabH>Ore</td><TD class=xtabH>Pop</td><TD class=xtabHL>Might</td><TD class=xtabH>Life</td><TD class=xtabH>Atk</td><TD class=xtabH>Def</td><TD class=xtabH>Speed</td><TD class=xtabH>Range</td><TD class=xtabH>Load</td><TD class=xtabH>Training</td>\
          </tr>\
          <TR style="height:1px;"><TD style="padding:0px; spacing:0px; height:1px; border-color:black; border-width: 1px; border-style: none none solid none" colspan=15></td></tr>';
		var ui=0;
		var tch8 = Seed.tech.tch8 * 5;
		var tch9 = Seed.tech.tch9 * 5;
		var tch10 = Seed.tech.tch10 * 10;
		var tch13 = Seed.tech.tch13 * 5;
		var tch15 = Seed.tech.tch15 * 5;
		var thr1 = uW.cm.ThroneController.effectBonus(1);
		var thr24 = uW.cm.ThroneController.effectBonus(24);
		var thr34 = uW.cm.ThroneController.effectBonus(34);
		var thr44 = uW.cm.ThroneController.effectBonus(44);
		var thr56 = uW.cm.ThroneController.effectBonus(56);
		var thr2 = uW.cm.ThroneController.effectBonus(2);
		var thr25 = uW.cm.ThroneController.effectBonus(25);
		var thr35 = uW.cm.ThroneController.effectBonus(35);
		var thr45 = uW.cm.ThroneController.effectBonus(45);
		var thr3 = uW.cm.ThroneController.effectBonus(3);
		var thr26 = uW.cm.ThroneController.effectBonus(26);
		var thr36 = uW.cm.ThroneController.effectBonus(36);
		var thr46 = uW.cm.ThroneController.effectBonus(46);
		var thr4 = uW.cm.ThroneController.effectBonus(4);
		var thr27 = uW.cm.ThroneController.effectBonus(27);
		var thr47 = uW.cm.ThroneController.effectBonus(47);
		var thr57 = uW.cm.ThroneController.effectBonus(57);
		var thr5 = uW.cm.ThroneController.effectBonus(5);
		var thr37 = uW.cm.ThroneController.effectBonus(37);
		var thr58 = uW.cm.ThroneController.effectBonus(58);
		var thr6 = uW.cm.ThroneController.effectBonus(6);
		var thr48 = uW.cm.ThroneController.effectBonus(48);
		var thr59 = uW.cm.ThroneController.effectBonus(59);
		var thr13 = uW.cm.ThroneController.effectBonus(13);
		var thr14 = uW.cm.ThroneController.effectBonus(14);
		var thr15 = uW.cm.ThroneController.effectBonus(15);
		var thr16 = uW.cm.ThroneController.effectBonus(16);
		var knight = parseFloat(255)/200;
		for (y in uW.unitcost) {
		  ui++;
          if (++rownum % 2) rsty = ''; else rsty = ' style="background: #e8e8e8" ';


       			var cost = unsafeWindow.unitcost['unt' + ui];
	   			var stats = unsafeWindow.unitstats['unt' + ui];
	   			var food = unsafeWindow.unitupkeeps[ui];
	   			var might = unsafeWindow.unitmight['unt' + ui];

	   			var attack 	= thr1;
	   			var defence = thr2;
	   			var life 		= thr3;
	   			var speed 	= thr4;
	   			var range		= thr5;
	   			var load 		= thr6;



				var life2 	= 100 + tch15 + 20;
	   			var attack2 = 100 + tch8 +  (255*0.005);
	   			var defence2= 100 + tch9 + (255*0.005);
	   			var speed2 	= 100;
	   			var range2	= 100 + tch13;
	   			var load2	= 100 + tch10;

	   			if (uW.cm.unitFrontendType[ui] == "infantry") {
	   				attack 	+= thr24;
	   				defence += thr25;
	   				life 		+= thr26;
	   				speed 	+= thr27;
	   			}
	   			if (uW.cm.unitFrontendType[ui] == "ranged") {
	   				attack 	+= thr34;
	   				defence += thr35;
	   				life 		+= thr36;
	   				range		+= thr37;
	   			}
	   			if (uW.cm.unitFrontendType[ui] == "horsed") {
	   				attack 	+= thr44;
	   				defence += thr45;
	   				life 		+= thr46;
	   				speed 	+= thr47;
	   				load 		+= thr48;
	   			}
	   			if (uW.cm.unitFrontendType[ui] == "siege") {
	   				attack 	+= thr56;
	   				speed 	+= thr57;
	   				range		+= thr58;
	   				if (ui != 9) load += thr59;
	   			}
	   			var attackColor = "red";
	   			if (attack > 800) {
	   				attack = 800;
	   				attackColor = "blue";
	   			}
	   			var defenceColor = "red";
	   			if (defence > 4000) {
	   				defence = 4000;
	   				defenceColor = "blue";
	   			}
	   			var lifeColor = "red";
	   			if (life > 200) {
	   				life = 200;
	   				lifeColor = "blue";
	   			}
	   			var speedColor = "red";
	   			if (speed > 300) {
	   				speed = 300;
	   				speedColor = "blue";
	   			}
	   			var rangeColor = "red";
	   			if (range > 150) {
	   				range = 150;
	   				rangeColor = "blue";
	   			}
	   			var loadColor = "red";
	   			if (load > 500) {
	   				load = 500;
	   				loadColor = "blue";
	   			}


	   			var attackfinal 	= stats[1] * (attack + attack2) / 100;
	   			var defencefinal 	= stats[2] * (defence + defence2) / 100;
	   			var lifefinal 		= stats[0] * (life + life2) / 100;
	   			var speedfinal 		= stats[3] * (speed + speed2) / 100;
	   			var rangefinal		= stats[4] * (range + range2) / 100;
			var loadfinal 		=  stats[5] * (load + load2) / 100;


		var lifefinal=stats[0]*(1+(Seed.tech.tch15*5)/100);
        lifefinal=lifefinal + (stats[0]*((life/100))) + (stats[0]*0.00);

	    var attackfinal=(stats[1]*(0+(Seed.tech.tch8*5)/100)) ;
        attackfinal=stats[1] +  attackfinal + (stats[1]*((attack/100))) + (stats[1]* ( parseFloat(255*0.005))) + (stats[1]*0.32)  + (stats[1]*0.00);

		var defencefinal=(stats[2]*(0+(Seed.tech.tch9*5)/100)) ;
        defencefinal=stats[2] +  defencefinal + (stats[2]*((defence/100))) + (stats[2]* ( parseFloat(255*0.005))) + (stats[2]*0.00);


        m += '<TR '+ rsty +'align=right><TD class=xtab align=left><B>'+ cost[0].substr(0,16) +'</b></td><TD class=xtabL>'+ food +'</td><TD class=xtabL>'+ cost[1] +'</td><TD class=xtab>'+ cost[2] +'</td>\
            <TD class=xtab>'+ cost[3] +'</td><TD class=xtab>'+ cost[4] +'</td><TD class=xtab>'+ cost[6] +'</td><TD class=xtabL>'+ might +'</td>\
            <TD class=xtab>'+ stats[0] +'</td><TD class=xtab>'+ stats[1] +'</td><TD class=xtab>'+ stats[2] +'</td><TD class=xtab>'+ stats[3] +'</td>\
            <TD class=xtab>'+ stats[4] +'</td><TD class=xtab>'+ stats[5] +'</td><td>'+parseInt(cost[7])+'</tr>';

	m += '<TR '+ rsty +' align=right ><TD class=xtab align=left>&nbsp;</td><TD class=xtabL>&nbsp;</td><TD class=xtabL>&nbsp;</td><TD class=xtab>&nbsp;</td>\
            <TD class=xtab>&nbsp;</td><TD class=xtab>&nbsp;</td><TD class=xtab>&nbsp;</td><TD class=xtabL>&nbsp;</td>\
            <TD class=xtab style="color:red">'+ Math.round(lifefinal*100)/100 +'</td><TD class=xtab style="color:red">'+ Math.round(attackfinal*100)/100 +'</td><TD class=xtab style="color:red">'+ Math.round(defencefinal*100)/100 +'</td>\
            <TD class=xtab style="color:red">'+ Math.ceil(speedfinal) +'</td><TD class=xtab style="color:red">'+ Math.ceil(rangefinal) +'</td><TD class=xtab style="color:red">'+ Math.ceil(loadfinal) +'</td></tr>';
      }
      m += '<TR class=xtabLine><TD colspan=15 class=xtabLine></td></tr>';
      for (k in unsafeWindow.fortcost){
        if (++rownum % 2)
          rsty = '';
        else
          rsty = ' style="background: #e8e8e8" ';
        cost = unsafeWindow.fortcost[k];
        fi = k.substring(3);
        stats = unsafeWindow.fortstats['unt'+fi];
        food = 0;
        might = fortmight['u'+fi];
        name = cost[0].replace ('Defensive','');
        name = name.replace ('Wall-Mounted','');
        m += '<TR '+ rsty +'align=right><TD align=left class=xtab><B>'+ name.substr(0,20) +'</b></td><TD class=xtabL>'+ food +'</td><TD class=xtabL>'+ cost[1] +'</td><TD class=xtab>'+ cost[2] +'</td>\
            <TD class=xtab>'+ cost[3] +'</td><TD class=xtab>'+ cost[4] +'</td><TD class=xtab>'+ cost[6] +'</td><TD class=xtabL>'+ might +'</td>\
            <TD class=xtab>'+ stats[0] +'</td><TD class=xtab>'+ stats[1] +'</td><TD class=xtab>'+ stats[2] +'</td><TD class=xtab>'+ stats[3] +'</td>\
            <TD class=xtab>'+ stats[4] +'</td><TD class=xtab>'+ stats[5] +'</td></tr>';
      }
      m += '<TR class=xtabLine><TD colspan=15 class=xtabLine></td></tr>';
      m += '</table>';
      function _displayrow (name, row){
                    var tot=0;
      			style = ((rownum++ % 2)?'':' style = "background: #e8e8e8"');
      			m += '<TR' + style + '><TD align=right><B>' + name + '</B></td>';
      			for (i=0; i<row.length; i++) {
      				m += ((row[i]==0)?'<td align=right><SPAN class=boldRed>0</SPAN></td>':'<td align=right>'+addCommas(parseInt(row[i]))+'</td>');
      				tot+=parseInt(row[i]);
      				}
      			m += '<td align=right>'+addCommas(tot)+'</td></tr>';
      		}
      		m += '<BR /><DIV class=boStat>'+lang.info.title3+'</div><BR /><SPAN id="Research">&nbsp;</SPAN><BR><DIV class=boStat>'+lang.info.title4+'</div>' +
      			'<BR /><TABLE align=center cellpadding=1 cellspacing=0><TABLE align=center cellpadding=1 cellspacing=0><TR align=right><TD></td>';
      		infoRows = [];
      		for (r=0; r<30; r++)
      			infoRows[r] = [];
      		for(i=0; i<Cities.numCities; i++) {
      			cityID = 'city'+ Cities.cities[i].id;
      			m += "<TD align=center valign=bottom width=60px><B>" + Cities.cities[i].name.replace(/ /g, "<BR>").substr(0,10)  + "</B></TD>";
      			getTroopDefTrainEstimates(cityID,Cities.cities[i].id);
      			infoRows[0][i] = Cities.cities[i].numBarracks;
      			infoRows[1][i] = Cities.cities[i].totLevelsBarracks;
      			infoRows[2][i] = Cities.cities[i].foremanBasePoliticsScore;
      			infoRows[3][i] = Cities.cities[i].marshallCombatScore;
      			infoRows[5][i] = Cities.cities[i].stableLevel;
      			infoRows[6][i] = Cities.cities[i].workshopLevel;
      			infoRows[23][i] = Cities.cities[i].blacksmithLevel;
      			infoRows[24][i] = Cities.cities[i].numHouse;
      			for (var j=1; j<16; j++) {
      				infoRows[j+6][i] = ((Cities.cities[i]['Troop'+j+'Time'] > 0)?(3600 / Cities.cities[i]['Troop'+j+'Time']):0);
			   }
      			infoRows[25][i] = Cities.cities[i]['Def53Time'];
      			if (infoRows[25][i] > 0)
      				infoRows[25][i] = 3600 / infoRows[25][i];
      			infoRows[26][i] = Cities.cities[i]['Def55Time'];
      			if (infoRows[26][i] > 0)
      				infoRows[26][i] = 3600 / infoRows[26][i];
      			infoRows[27][i] = Cities.cities[i]['Def60Time'];
      			if (infoRows[27][i] > 0)
      				infoRows[27][i] = 3600 / infoRows[27][i];
      			infoRows[28][i] = Cities.cities[i]['Def61Time'];
      			if (infoRows[28][i] > 0)
      				infoRows[28][i] = 3600 / infoRows[28][i];
      			infoRows[29][i] = Cities.cities[i]['Def62Time'];
      			if (infoRows[29][i] > 0)
      				infoRows[29][i] = 3600 / infoRows[29][i];
      		}
      		m += "<td align=center valign=bottom width=60px><b>"+lang.info.tot+"</td></tr>";
      		rownum=0;
      		_displayrow (lang.info.row25, infoRows[24]);
      		_displayrow (lang.info.row0, infoRows[0]);
      		_displayrow (lang.info.row1, infoRows[1]);
      		_displayrow (lang.info.row2, infoRows[2]);
      		_displayrow (lang.info.row3, infoRows[3]);
      		_displayrow (lang.info.row5, infoRows[5]);
      		_displayrow (lang.info.row24, infoRows[23]);
      		_displayrow (lang.info.row6, infoRows[6]);
      		m += "<TR><TD></TD><TD nowrap align=center colspan="+(Cities.numCities)+"><B>"+lang.info.trainhour+"</B></TD></TR>";
      		_displayrow (uW.unitcost['unt1'][0], infoRows[7]);
      		_displayrow (uW.unitcost['unt2'][0], infoRows[8]);
      		_displayrow (uW.unitcost['unt3'][0], infoRows[9]);
      		_displayrow (uW.unitcost['unt4'][0], infoRows[10]);
      		_displayrow (uW.unitcost['unt5'][0], infoRows[11]);
      		_displayrow (uW.unitcost['unt6'][0], infoRows[12]);
      		_displayrow (uW.unitcost['unt7'][0], infoRows[13]);
      		_displayrow (uW.unitcost['unt8'][0], infoRows[14]);
      		_displayrow (uW.unitcost['unt9'][0], infoRows[15]);
      		_displayrow (uW.unitcost['unt10'][0], infoRows[16]);
      		_displayrow (uW.unitcost['unt11'][0], infoRows[17]);
      		_displayrow (uW.unitcost['unt12'][0], infoRows[18]);
      		_displayrow (uW.unitcost['unt13'][0], infoRows[19]);
      		_displayrow (uW.unitcost['unt14'][0], infoRows[20]);
      		_displayrow (uW.unitcost['unt15'][0], infoRows[21]);
      		m += "<TR><TD></TD><TD nowrap align=center colspan="+(Cities.numCities)+"><B>"+lang.info.buildhour+"</B></TD></TR>";
      		_displayrow (uW.fortcost['frt53'][0], infoRows[25]);
      		_displayrow (uW.fortcost['frt55'][0], infoRows[26]);
      		_displayrow (uW.fortcost['frt60'][0], infoRows[27]);
      		_displayrow (uW.fortcost['frt61'][0], infoRows[28]);
      		_displayrow (uW.fortcost['frt62'][0], infoRows[29]);
		m += "</TABLE><BR />";
      m += '<BR><DIV class=boStat>'+lang.info.title5+'</div><DIV class=ptentry><TABLE align=center cellpadding=1 cellspacing=0>\
      <TR><TD class=xtab align=right><B>'+lang.General.source+' : </b></td><TD  class=xtab> X: <INPUT id=calcX type=text\> Y: <INPUT id=calcY type=text\> '+lang.General.or+' '+unsafeWindow.g_js_strings.commonstr.city+' : <SPAN id=ptloc1></span></td></tr>\
      <TR><TD class=xtab><B>'+lang.General.dest+' : </b></td><TD class=xtab> X: <INPUT id=calcX2 type=text\> Y: <INPUT id=calcY2 type=text\> '+lang.General.or+' '+unsafeWindow.g_js_strings.commonstr.city+' <SPAN id=ptloc2></span></td></tr></table>\
      <CENTER><DIV style="width:60%; font-size:14px; border: 1px solid; background-color:white; margin:20px 3px 3px 0px; padding:4px" id=ptdistout></div>\
<div><b>'+lang.General.EstimateT+' </b><select id="idETASelect">\
        <option value="0" > ---- </option>';
        var z=0;
        for (y in unsafeWindow.unitcost) {
          z++;
          m+='<option value="'+z+'">'+unsafeWindow.unitcost[y][0]+'</option>';
	}
m +='</select></div><DIV style="width:60%; font-size:14px; border: 1px solid; background-color:white; margin:20px 3px 3px 0px; padding:4px" id=ptETAout></div></center>';

m += '<BR><DIV class=boStat>'+lang.info.title6+'</div><DIV id=ptProvMap style="height:'+ provMapCoords.imgHeight +'px; width:'+ provMapCoords.imgWidth +'px; background-repeat:no-repeat; background-image:url(\''+ URL_PROVINCE_MAP +'\')"></div></div>';
var bor,ector,kay,bedivere,gawain,percival,galahad,lancelot,arthur,morgana,mordred;
if (Seed.items.i1101){bor=Seed.items.i1101}else{bor=0};
if (Seed.items.i1102){ector=Seed.items.i1102}else{ector=0};
if (Seed.items.i1103){kay=Seed.items.i1103}else{kay=0};
if (Seed.items.i1104){bedivere=Seed.items.i1104}else{bedivere=0};
if (Seed.items.i1105){gawain=Seed.items.i1105}else{gawain=0};
if (Seed.items.i1106){percival=Seed.items.i1106}else{percival=0};
if (Seed.items.i1107){galahad=Seed.items.i1107}else{galahad=0};
if (Seed.items.i1108){lancelot=Seed.items.i1108}else{lancelot=0};
if (Seed.items.i1109){arthur=Seed.items.i1109}else{arthur=0};
if (Seed.items.i1110){morgana=Seed.items.i1110}else{morgana=0};
if (Seed.items.i1111){mordred=Seed.items.i1111}else{mordred=0};
if (Seed.items.i1112){Stag=Seed.items.i1112}else{Stag=0};
if (Seed.items.i1113){Pendragon=Seed.items.i1113}else{Pendragon=0};
if (Seed.items.i1114){Lady=Seed.items.i1114}else{Lady=0};
if (Seed.items.i1115){Merlin=Seed.items.i1115}else{Merlin=0};
if (Seed.items.i1120){aetherseal=Seed.items.i1120}else{aetherseal=0};
if (Seed.items.i1121){ysbadden=Seed.items.i1121}else{ysbadden=0};
if (Cities.cities[1]){ville2="#99EE99";}else{ville2="#EE9999";}
if (Cities.cities[2]){ville3="#99EE99";}else{ville3="#EE9999";}
if (Cities.cities[3]){ville4="#99EE99";}else{ville4="#EE9999";}
if (Cities.cities[4]){ville5="#99EE99";}else{ville5="#EE9999";}
if (Cities.cities[5]){ville6="#99EE99";}else{ville6="#EE9999";}
if (Cities.cities[6]){ville7="#99EE99";}else{ville7="#EE9999";}
if (Cities.cities[7]){ville8="#99EE99";}else{ville8="#EE9999";}
m += '<style>CAPTION.MYTABLE  {background-color:eeffff;color:black;border-style:solid;border-width:1px;border-color:black;}\
  TABLE.MYTABLE  { \
     font-family:arial;\
     border-collapse:collapse;\
     font-size:10pt;\
     background-color:F5F5F5;\
     width:100%;\
     border-style:solid;\
     border-color:black;\
     border-width:1px;\
  } TH.MYTABLE  {\
     font-size:10pt;\
     color:black;\
     text-align:center;\
     border-style:solid;\
     border-color:black;\
     border-width:1px;\
  } TR.MYTABLE { }\
  TD.MYTABLE {  \
     font-size:10pt;\
     background-color:FFFFE5;\
     color:black;\
     border-style:solid;\
     border-width:1px;\
     text-align:left;\
  }</style>\
<TABLE CLASS="MYTABLE" CELLPADDING=0 CELLSPACING=0>\
    <CAPTION CLASS="MYTABLE">'+lang.info.title7+'</CAPTION><THEAD >\
      <TR CLASS="MYTABLE">\
        <TH CLASS="MYTABLE">'+uW.g_js_strings.commonstr.cities+'</TH>\
        <TH CLASS="MYTABLE">Besoins 1</TH>\
        <TH CLASS="MYTABLE">Besoins 2</TH>\
        <TH CLASS="MYTABLE">Besoins 3</TH>\
      </TR>\
    </THEAD><TBODY>\
      <TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville2+';">'+uW.g_js_strings.commonstr.city+' 2</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+ville2+';">Niveau 7 ('+Seed.player.title+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+ville2+';">10 Amis</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+ville2+';">&nbsp;</TD>\
      </TR><TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville3+';">'+uW.g_js_strings.commonstr.city+' 3</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+ ( (bor>=4)?"#99EE99":ville3 ) +';"><img width=25 src='+gameurl+'img/items/70/1101.jpg>&nbsp;4 Bor ('+bor+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+ ( (ector>=2)?"#99EE99":ville3 ) +';"><img width=25 src='+gameurl+'img/items/70/1102.jpg>&nbsp;2 Ector ('+ector+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+ ( (kay>=1)?"#99EE99":ville3 ) +';"><img width=25 src='+gameurl+'img/items/70/1103.jpg>&nbsp;1 Kay ('+kay+')</TD>\
      </TR><TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville4+';">'+uW.g_js_strings.commonstr.city+' 4</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (kay>=4)?"#99EE99":ville4 )+';"><img width=25 src='+gameurl+'img/items/70/1103.jpg>&nbsp;4 Kay ('+kay+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (bedivere>=3)?"#99EE99":ville4 )+';"><img width=25 src='+gameurl+'img/items/70/1104.jpg>&nbsp;3 Bedivere ('+bedivere+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (gawain>=1)?"#99EE99":ville4 )+';"><img width=25 src='+gameurl+'img/items/70/1105.jpg>&nbsp;1 Gawain ('+gawain+')</TD>\
      </TR>\
      <TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville5+';">'+uW.g_js_strings.commonstr.city+' 5</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (percival>=4)?"#99EE99":ville5 )+';"><img width=25 src='+gameurl+'img/items/70/1106.jpg>&nbsp;4 Perceval ('+percival+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (galahad>=3)?"#99EE99":ville5 )+';"><img width=25 src='+gameurl+'img/items/70/1107.jpg>&nbsp;3 Galaad ('+galahad+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (lancelot>=2)?"#99EE99":ville5 )+';"><img width=25 src='+gameurl+'img/items/70/1108.jpg>&nbsp;2 Lancelot ('+lancelot+')</TD>\
      </TR>\
      <TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville6+';">'+uW.g_js_strings.commonstr.city+' 6</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (arthur>=4)?"#99EE99":ville6 )+';"><img width=25 src='+gameurl+'img/items/70/1109.jpg>&nbsp;4 Roi Arthur ('+arthur+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (morgana>=3)?"#99EE99":ville6 )+';"><img width=25 src='+gameurl+'img/items/70/1110.jpg>&nbsp;3 Morgane ('+morgana+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (mordred>=2)?"#99EE99":ville6 )+';"><img width=25 src='+gameurl+'img/items/70/1111.jpg>&nbsp;2 Mordred ('+mordred+')</TD>\
      </TR>\
       <TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville7+';">'+uW.g_js_strings.commonstr.city+' 7</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (Stag>=4)?"#99EE99":ville7 )+';"><img width=25 src='+gameurl+'img/items/70/1112.jpg>&nbsp;4 Roi Stag ('+Stag+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (Pendragon>=3)?"#99EE99":ville7 )+';"><img width=25 src='+gameurl+'img/items/70/1113.jpg>&nbsp;3 Terrestre ('+Pendragon+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (Lady>=2)?"#99EE99":ville7 )+';"><img width=25 src='+gameurl+'img/items/70/1114.jpg>&nbsp;2 Aquatique ('+Lady+')</TD>\
      </TR>\
      <TR CLASS="MYTABLE">  \
        <TD CLASS="MYTABLE" style="background-color:'+ville8+';">'+uW.g_js_strings.commonstr.city+' 8</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (Merlin>=4)?"#99EE99":ville8 )+';"><img width=25 src='+gameurl+'img/items/70/1115.jpg>&nbsp;4 Merlin ('+Merlin+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (aetherseal>=3)?"#99EE99":ville8 )+';"><img width=25 src='+gameurl+'img/items/70/1120.jpg>&nbsp;3 Aetherseal ('+aetherseal+')</TD>\
        <TD CLASS="MYTABLE" style="background-color:'+( (ysbadden>=2)?"#99EE99":ville8 )+';"><img width=25 src='+gameurl+'img/items/70/1121.jpg>&nbsp;2 Ysbadden  ('+ysbadden +')</TD>\
      </TR>\
    </TBODY></TABLE><TABLE CLASS="MYTABLE" CELLPADDING=0 CELLSPACING=0><CAPTION CLASS="MYTABLE">'+lang.info.title8+'</CAPTION><THEAD >\
        <TR CLASS="MYTABLE">\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1101.jpg title="Bor"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1102.jpg title="Ector"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1103.jpg title="Kay"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1104.jpg title="Bedivere"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1105.jpg title="Gawain"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1106.jpg title="Perceval"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1107.jpg title="Galaad"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1108.jpg title="Lancelot"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1109.jpg title="Arthur"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1110.jpg title="Morgane"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1111.jpg title="Mordred"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1112.jpg title="Stag"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1113.jpg title="Terrestre"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1114.jpg title="Aquatique"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1115.jpg title="Merlin"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1120.jpg title="Aetherseal"></TH>\
          <TH CLASS="MYTABLE"><img width=20 src='+gameurl+'img/items/70/1121.jpg title="Ysbadden"></TH>\
         </TR>\
 </THEAD><TR CLASS="MYTABLE">\
  <TD CLASS="MYTABLE"><center><b>'+bor+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+ector+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+kay+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+bedivere+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+gawain+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+percival+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+galahad+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+lancelot+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+arthur+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+morgana+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+mordred+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+Stag+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+Pendragon+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+Lady+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+Merlin+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+aetherseal+'</TD>\
  <TD CLASS="MYTABLE"><center><b>'+ysbadden+'</TD>\
  </TR><TR CLASS="MYTABLE"></tr>\
  </table>';

 t.cont.innerHTML = m;
 if (Options.BOInfoCity==undefined) Options.BOInfoCity=0;
 new CdispCityPicker ('ptloc1', ById('ptloc1'), true, t.eventFromLocChanged, 0).bindToXYboxes(ById('calcX'), ById('calcY'));
 new CdispCityPicker ('ptloc2', ById('ptloc2'), true, t.eventLocChanged, 0).bindToXYboxes(ById('calcX2'), ById('calcY2'));
 t.eventFromLocChanged(Cities.cities[0], Cities.cities[0].x, Cities.cities[0].y);

 ById('idETASelect').addEventListener ( 'change', t.eventLocChanged, false);
    function rlShow(rl) {
    			var retval = '<TD nowrap><B>'+rl.Name+'</B></TD><TD align=right><B>&nbsp;&nbsp;';
    			nlETA = ((rl.NextLevelETA > 0)?('(' + (rl.Level + 1) + ': ' + timestr(rl.NextLevelETA) + ')'):'');
    			retval += ((rl.Level < 9)?('<SPAN class=boldRed>' + rl.Level + '</SPAN></B></TD><TD nowrap>&nbsp;&nbsp;' + nlETA + '</TD>'):(rl.Level + '</B></TD><TD nowrap>&nbsp;&nbsp;' + nlETA + '</TD>'));
    			return retval;
    };
    var m = '';
    getResearchLevels();
    m += '<TABLE align=center cellpadding=1 cellspacing=0>' +
    			'<TR>' + rlShow(researchLevels[1]) + '<TD width=10></TD>' + rlShow(researchLevels[6]) + '<TD width=10></TD>' + rlShow(researchLevels[12]) + '</TR>' +
    			'<TR>' + rlShow(researchLevels[2]) + '<TD></TD>' + rlShow(researchLevels[8]) + '<TD></TD>' + rlShow(researchLevels[13]) + '</TR>' +
    			'<TR>' + rlShow(researchLevels[3]) + '<TD></TD>' + rlShow(researchLevels[9]) + '<TD></TD>' + rlShow(researchLevels[14]) + '</TR>' +
    			'<TR>' + rlShow(researchLevels[4]) + '<TD></TD>' + rlShow(researchLevels[15]) + '<TD></TD>' + rlShow(researchLevels[10]) + '</TR>' +
    			'<TR>' + rlShow(researchLevels[5]) + '<TD></TD>' + rlShow(researchLevels[11]) + '<TD></TD>' + rlShow(researchLevels[16]) + '</TR></TABLE>';
     m += '<TABLE align=center cellpadding=1 cellspacing=0>' +
				    			'<TR>' + rlShow(research2Levels[1]) + '<TD width=10></TD>' + rlShow(research2Levels[2]) + '<TD width=10></TD>' + rlShow(research2Levels[4]) + '</TR>' +
				    			'<TR>' + rlShow(research2Levels[4]) + '<TD></TD>' + rlShow(research2Levels[5]) + '<TD></TD>' + rlShow(research2Levels[6]) + '</TR></TABLE>';
    ById('Research').innerHTML = m;
     for (var c=0; c<Cities.numCities; c++)
        t.makeCityImg (c, ById('ptProvMap'));
   //   t.state = 1;
   // }
  },
  makeCityImg : function (cityNum, eMap){
    var t = my.Info;
    var city = Cities.cities[cityNum];
    var x = parseInt((provMapCoords.mapWidth * city.x) / 750);
    var y = parseInt((provMapCoords.mapHeight * city.y) / 750);
    var ce = document.createElement ('div');
    ce.style.background = 'black';
    ce.style.opacity = '1.0';
    ce.style.position='relative';
    ce.style.display='block';
    ce.style.width='14px';
    ce.style.height='16px';
    ce.style.border='1px solid #fff';
    ce.style.color = 'white';
    ce.style.textAlign = 'center';
    ce.style.top = (y+provMapCoords.topMargin-(cityNum*16)-8) +'px';
    ce.style.left = (x+provMapCoords.leftMargin-7) +'px';
    eMap.appendChild(ce);
    ce.innerHTML = (cityNum+1) +'';
  },

  eventLocChanged : function (city, x, y){
    var t = myBO.Info;
    var x1 = parseInt(ById('calcX').value);
    var x2 = parseInt(ById('calcX2').value);
    if (isNaN(x2))
      return;
    var y1 = parseInt(ById('calcY').value);
    var y2 = parseInt(ById('calcY2').value);
    var m = lang.info.ptdistout1+' '+ x1 +','+ y1 +' '+lang.info.ptdistout2+' '+ x2 +','+ y2 +' '+lang.info.ptdistout3+' <B>'+ distance (x1, y1, x2, y2).toFixed(2) +'</b>';
    ById('ptdistout').innerHTML = m;
    var dist = distance (x1, y1, x2, y2);
    if (t.ModelCity) m = estETA(dist, ById('idETASelect').value, t.ModelCity.id,4)
     else
      m = estETA(dist, ById('idETASelect').value, 0, 4)
    if (m != null)
           ById('ptETAout').innerHTML = "Atk : "+m.etaStr+" - Renf : "+m.friendEtaStr;
  },
  eventFromLocChanged : function (city, x, y){
    var t = myBO.Info;
    t.ModelCity = city;
    var x1 = parseInt(ById('calcX').value);
    var x2 = parseInt(ById('calcX2').value);
    if (isNaN(x2))
      return;
    var y1 = parseInt(ById('calcY').value);
    var y2 = parseInt(ById('calcY2').value);
    var m = lang.info.ptdistout1+' '+ x1 +','+ y1 +' '+lang.info.ptdistout2+' '+ x2 +','+ y2 +' '+lang.info.ptdistout3+' <B>'+ distance (x1, y1, x2, y2).toFixed(2) +'</b>';
    ById('ptdistout').innerHTML = m;
    var dist = distance (x1, y1, x2, y2);
       if (t.ModelCity) m = estETA(dist, ById('idETASelect').value, t.ModelCity.id,4)
        else
      m = estETA(dist, ById('idETASelect').value, 0, 4)
    if (m != null)
       ById('ptETAout').innerHTML = "Atk : "+m.etaStr+" - Renf : "+m.friendEtaStr;
  },
}
myBO.Alliance = {
  tabOrder : 120,
  cont : null,
  alliancemembers:[],
  number:0,
  totalmembers:0,
  error:false,

  getContent : function (){
      var t = myBO.Alliance;
      return t.cont;
  },
  init : function (){
      var t = myBO.Alliance;
      t.cont = document.createElement('div');
      return t.cont;
  },
  show : function (){
     var t = myBO.Alliance;
     t.cont.style.overflowY = 'scroll';
     t.cont.style.maxHeight = '500px';
     t.totalmembers=0;
     t.alliancemembers=[];
     unsafeWindow.getdetails = t.getMemberDetails;
    var m =  '<DIV class=boStat><b>'+lang.Alliance.title+'</b></div><TABLE align=center cellpadding=1 cellspacing=0></table>';
    m +='<TABLE class=ptTab><TD width=200px>'+lang.Alliance.title1+'</td><TD>'+lang.Alliance.sortby+' <select id="searchAlli"><option value="name">'+lang.General.name+'</options>';
    m += '<option value="might">'+uW.g_js_strings.commonstr.might+'</option>';
    m += '<option value="login">'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+'</option>';
    m += '<option value="cities">'+uW.g_js_strings.commonstr.cities+'</option>';
    m += '<option value="position">'+uW.g_js_strings.commonstr.position+'</option>';
    m += '<option value="glory">'+uW.g_js_strings.commonstr.glory+'</option><option value="dip">'+uW.g_js_strings.showMemberInfo.daysincurrpos+'</option></select></td>';
    m += '<TD><INPUT id=alList type=button class=pbButton  value="'+lang.Alliance.alList+'"></td>';
    m += '<TD id=progress></td>';
    m += '<TR><TD width=200px>'+uW.g_js_strings.allianceInfo.allidiplomacy+'</td><TD><INPUT id=aldiplo class=pbButton  type=button value="'+lang.Alliance.alList+'"></td></tr></table>';
    m+='<DIV class=boStat><b>&nbsp;</div><TABLE align=center cellpadding=1 cellspacing=0 class=ptTab></table>';
    m += '<TABLE id=alOverviewTab class=alTab><TR align="center"></tr></table>';
   t.cont.innerHTML = m;
   ById('alList').addEventListener('click', function(){
    	if (!t.searching){
	    	t.totalmembers=0;
	    	t.alliancemembers=[];
		    ById('alOverviewTab').innerHTML ="";
		    ById('progress').innerHTML ="";
		    ById('progress').innerHTML = uW.g_js_strings.commonstr.research+"...";
		    ById('alList').disabled = true;
		    t.error=false;
		    t.fetchAllianceMemberPage();
		}
    }, false);

    ById('searchAlli').addEventListener('click', function(){
        if (t.alliancemembers!="") {
        	ById('alOverviewTab').innerHTML ="";
        	t.paintMembers();
        }
    }, false);
    ById('aldiplo').addEventListener('click', function(){t.paintDiplomacy();}, false);

  window.addEventListener('unload', t.onUnload, false);
  },
  paintMembers: function(){
  var t = myBO.Alliance;
	  		  if (ById('searchAlli').value == "name") {
				  var sortmembers = t.alliancemembers.sort(function(a, b){
				         var sortA=a.Name.toLowerCase(), sortB=b.Name.toLowerCase()
				         if (sortA < sortB)
				          return -1
				         if (sortA > sortB)
				          return 1
				         return 0
				        });
			  }
			  if (ById('searchAlli').value == "might") {
			  	  var sortmembers = t.alliancemembers.sort(function(a, b){
			  	         var sortA=parseInt(a.Might),sortB=parseInt(b.Might)
			  	         if (sortA > sortB)
			  	          return -1
			  	         if (sortA < sortB)
			  	          return 1
			  	         return 0
			  	        });
			  }
			  if (ById('searchAlli').value == "login") {
			  	  var sortmembers = t.alliancemembers.sort(function(a, b){
			  	         var sortA=a.LastLogin,sortB=b.LastLogin
			  	         if (sortA < sortB)
			  	          return -1
			  	         if (sortA > sortB)
			  	          return 1
			  	         return 0
			  	        });
			  }
			  if (ById('searchAlli').value == "cities") {
			  	  var sortmembers = t.alliancemembers.sort(function(a, b){
			  	         var sortA=a.Cities,sortB=b.Cities
			  	         if (sortA < sortB)
			  	          return -1
			  	         if (sortA > sortB)
			  	          return 1
			  	         return 0
			  	        });
			  }
			  if (ById('searchAlli').value == "dip") {
			  	  var sortmembers = t.alliancemembers.sort(function(a, b){
			  	         var sortA=a.dip,sortB=b.dip
			  	         if (sortA < sortB)
			  	          return -1
			  	         if (sortA > sortB)
			  	          return 1
			  	         return 0
			  	        });
			  }
			  if (ById('searchAlli').value == "position") {
			  	  var sortmembers = t.alliancemembers.sort(function(a, b){
			  	         var sortA=a.Position,sortB=b.Position
			  	         if (sortA < sortB)
			  	          return -1
			  	         if (sortA > sortB)
			  	          return 1
			  	         return 0
			  	        });
			  }
			  if (ById('searchAlli').value == "glory") {
			  	  var sortmembers = t.alliancemembers.sort(function(a, b){
			  	         var sortA=parseInt(a.glory),sortB=parseInt(b.glory);
			  	         if (sortA > sortB)
			  	          return -1
			  	         if (sortA < sortB)
			  	          return 1
			  	         return 0
			  	        });
			  }
			  for (var y = (sortmembers.length-1); y >=0; y--) {
			                      t._addTab(sortmembers[y].Name,sortmembers[y].Might,sortmembers[y].LastLogin,sortmembers[y].Position,sortmembers[y].dip,sortmembers[y].uid,sortmembers[y].fbuid,sortmembers[y].Cities,sortmembers[y].avatarurl,sortmembers[y].glory,sortmembers[y].dateJoined);
			                      t.cont.style.overflowY = 'scroll';
			  }
			 t._addTabHeader();
   },

    _addTab: function(Name,Might,LastLogin,Position,dip,uid,fbuid,Cities,avatar,gloire,arrive){
             var t = myBO.Alliance;
             var row = ById('alOverviewTab').insertRow(0);
             row.vAlign = 'top';
             row.insertCell(0).innerHTML ='<img width=25 src="'+ avatar +'">';
             row.insertCell(1).innerHTML ='<A target="_tab" href="http://www.facebook.com/profile.php?id='+ fbuid +'">FB</a>';
             row.insertCell(2).innerHTML = Name;
             var cell2 = row.insertCell(3);
       		 cell2.width = "60" ;
       		 cell2.align = "right" ;
       		 cell2.vAlign = "top";
       		 cell2.innerHTML = addCommas(Might);
       		var cell2 = row.insertCell(4);
       		 cell2.width = "60" ;
       		 cell2.align = "right" ;
       		 cell2.vAlign = "top";
       		 cell2.innerHTML = addCommas(gloire);
       		row.insertCell(5).innerHTML = Cities;
       		 row.insertCell(6).innerHTML = officerId2String (Position);
       		 row.insertCell(7).innerHTML = dip;
       		 row.insertCell(8).innerHTML = LastLogin;
       		 row.insertCell(9).innerHTML = arrive;
          },

    _addTabHeader: function() {
    var t = myBO.Alliance;
        var row = ById('alOverviewTab').insertRow(0);
        row.vAlign = 'top';
        row.insertCell(0).innerHTML = "<b>Avatar";
        row.insertCell(1).innerHTML = "<b>Facebook";
        row.insertCell(2).innerHTML = "<b>"+lang.General.name;
        row.insertCell(3).innerHTML = "<b>"+uW.g_js_strings.commonstr.might;
        row.insertCell(4).innerHTML = "<b>"+uW.g_js_strings.commonstr.glory;
        row.insertCell(5).innerHTML = "<b>"+uW.g_js_strings.commonstr.cities;
        row.insertCell(6).innerHTML = "<b>"+uW.g_js_strings.commonstr.position;
        row.insertCell(7).innerHTML = "<b>DIP";
        row.insertCell(8).innerHTML = "<b>"+lang.Alliance.row8;
        row.insertCell(9).innerHTML = "<b>"+lang.Alliance.row9;
    },
    paintDiplomacy : function () {
    	ById('alOverviewTab').innerHTML ="";
    	ById('progress').innerHTML ="";
    	var m= '<TR><TD colspan=4 style=\'background: #33CC66;\' align=center><B>'+uW.g_js_strings.commonstr.friendly+' : </b></td></tr>';
    	if (Seed.allianceDiplomacies['friendly'] == null) m+='<TR><TD>'+uW.g_js_strings.getDiplomacy.sorrynoalli+'</td>';
    	else m += '<TABLE class=xtab><TR><TD>'+uW.g_js_strings.getDiplomacy.alliname+'</td><TD>'+lang.Alliance.member+'</td></tr>';
    	for (k in Seed.allianceDiplomacies['friendly']){
				m+='<TR><TD>'+Seed.allianceDiplomacies['friendly'][k]['allianceName']+'</td>';
				m+='<TD align=center>'+Seed.allianceDiplomacies['friendly'][k]['membersCount']+'</td>';
    	}
    	m+='<TR></tr></table>';
    	m+= '<TR><TD colspan=4 style=\'background: #CC0033;\' align=center><B>'+uW.g_js_strings.commonstr.hostile+' : </b></td></tr>';
    	if (Seed.allianceDiplomacies['hostile'] == null) m+='<TR><TD>'+uW.g_js_strings.getDiplomacy.sorrynoalli+'</td>';
    	else m += '<TABLE class=xtab><TR><TD>'+uW.g_js_strings.getDiplomacy.alliname+'</td><TD>'+lang.Alliance.member+'</td></tr>';
    	for (k in Seed.allianceDiplomacies["hostile"]){
    		m+='<TR><TD>'+Seed.allianceDiplomacies["hostile"][k]['allianceName']+'</td>';
    		m+='<TD align=center>'+Seed.allianceDiplomacies["hostile"][k]['membersCount']+'</td>';
    	}
    	m+='<TR></tr></table>';
    	m+= '<TR><TD colspan=4 style=\'background: #FF6633;\' align=center><B>'+uW.g_js_strings.getDiplomacy.friendlytoyou+'</b></td></tr>';
    	if (Seed.allianceDiplomacies['friendlyToYou'] == null) m+='<TR><TD>'+uW.g_js_strings.getDiplomacy.sorrynoalli+'</td>';
    	else m += '<TABLE class=xtab><TR><TD>'+uW.g_js_strings.getDiplomacy.alliname+'</td><TD>'+lang.Alliance.member+'</td></tr>';
    	for (k in Seed.allianceDiplomacies["friendlyToYou"]){
    		m+='<TR><TD>'+Seed.allianceDiplomacies["friendlyToYou"][k]['allianceName']+'</td>';
    		m+='<TD align=center>'+Seed.allianceDiplomacies["friendlyToYou"][k]['membersCount']+'</td>';
    	}
    	m+='<TR></tr></table>';
    	ById('alOverviewTab').innerHTML = m;
    },


    fetchAllianceMemberPage : function () {
    var t = myBO.Alliance;
    ById('alList').disabled = true;
    var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);

    params.pf = 0;

    new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/allianceGetInfo.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (transport) {
      	  var rslt = eval("(" + transport.responseText + ")");
          t.totalmembers = (rslt["allianceInfo"]["members"]);
          for (var i=1;i<=10;i++) {
                 params.pageNo = i;
                 params.pf = 0;
                 new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/allianceGetMembersInfo.php" + unsafeWindow.g_ajaxsuffix, {
                   method: "post",
                   parameters: params,
                   onSuccess: function (transport) {
                    var info = eval("(" + transport.responseText + ")");
                    if (info.ok) {
                       for (var k in info["memberInfo"]){
                         if ( info["memberInfo"][k]["might"] != undefined && !t.error){
                           t.alliancemembers.push ({
                               Name: info["memberInfo"][k]["name"],
                               Might: info["memberInfo"][k]["might"],
                               Cities: info["memberInfo"][k]["cities"],
                               Position : info["memberInfo"][k]["positionType"],
                               dip : info["memberInfo"][k]["daysInPosition"],
                               LastLogin : info["memberInfo"][k]["lastLogin"],
                               uid : info["memberInfo"][k]["userId"],
                               fbuid : info["memberInfo"][k]["fbuid"],
                               avatarurl : info["memberInfo"][k]["avatarurl"],
                               glory : info["memberInfo"][k]["glory"],
                               dateJoined : info["memberInfo"][k]["dateJoined"],
                           });
                          }
                           ById('alOverviewTab').innerHTML ="";
                           t.paintMembers();
                   		}
                       if (!t.error) ById('progress').innerHTML	 = '(' + (t.alliancemembers.length) +'/'+ t.totalmembers +')';
                       if ( t.alliancemembers.length >= t.totalmembers) ById('alList').disabled = false;
                    } else  if (info.error) {
                    	ById('alList').disabled = false;
                    	ById('progress').innerHTML = "ERREUR";
                    	t.error=true;
                   	}
                   },
                   onFailure: function (rslt) {;
                     notify ({errorMsg:'AJAX error'});
                   },
           });
          }
      },
      onFailure: function (rslt) {;
        notify ({errorMsg:'AJAX error'});
      },
    });
  },
  hide : function (){
  },
};
myBO.Tournoi = {
 cont:null,
 state:null,
 pos:0,
 displayTimer : null,
 init : function (){
    this.cont = document.createElement('div');
    return this.cont;
 },
 hide : function (){
  var t = myBO.Tournoi;
  clearTimeout (t.displayTimer);
 },
 getContent : function (){
	    var t = myBO.Tournoi;
	    return t.cont;
 },
 show : function () {
  var t = myBO.Tournoi;

  clearTimeout (t.displayTimer);


  t.cont.innerHTML = "<div class='tourny_modal_upsell'></div><DIV class=boStat><b>"+lang.tournoi.title+" - <input type=button value='?' id='boaidetournoi' class=boAide onclick=window.open('"+sitesupport+"?page=aide_tournoi');></b></div>";


  var mhtl = "<table width=100% class=ptTab><tr><td></td>";
  for(var i=0; i<Cities.numCities; i++) {
   mhtl += "<TD align=center valign=bottom width=50px><B>" + Cities.cities[i].name.replace(/ /g, "<BR>").substr(0,10) + "</B></TD>";
  }
  mhtl += "<td align=center width=60px><b>Total</td></tr>";

    var p = Options.TourUnit;
    mhtl += "<tr><td>Population/h</td>";
    var pop=[],tot1=0;
    for(var i=0; i<Cities.numCities; i++) {
     cityID = 'city'+ Cities.cities[i].id;
     pop[i] =  parseInt(Seed.citystats[cityID]["pop"][1] / uW.unitcost['unt'+p][6]) / 2;
     mhtl += "<td  align=right>" + addCommas(parseInt(pop[i])) +"</td>";
     tot1+=parseInt(pop[i]);
    }
  mhtl += "<td align=right><b>"+addCommas(tot1)+"</td></tr>";


  mhtl +=" <tr><td><select id=BOTournoiUnit>";
  var r=0;
  for (y in uW.unitcost) {
   r++;
   mhtl += "<option value="+r+" " + (p == r?'SELECTED':'') + ">"+uW.unitcost[y][0]+"</option>";
  }
  mhtl +="</select></td>";
  var temps=[],tot=0;
  for(var i=0; i<Cities.numCities; i++) {
   temps[i]=((Cities.cities[i]['Troop'+p+'Time'] > 0)?(3600 / Cities.cities[i]['Troop'+p+'Time']):0);
   mhtl += "<td align=right>" + addCommas(parseInt(temps[i] )) +"</td>";
   tot+=parseInt(temps[i]);
  }
  mhtl += "<td align=right><b>"+addCommas(tot)+"</td></tr>";

  mhtl +=" <tr><td>&nbsp;</td>";
  var diff=0;
  for(var i=0; i<Cities.numCities; i++) {
   diff = parseInt(pop[i] - temps[i]);
   var couleur=" style='color:green' ";
   if (diff<0) couleur=" style='color:red' ";
   mhtl += "<td "+couleur+"  align=right><b>" + addCommas(parseInt(diff)) +"</b></td>";
  }
  diff = parseInt(tot1 - tot);
  var couleur=" style='color:green' ";
  if (diff<0) couleur=" style='color:red' ";
  mhtl += "<td "+couleur+" align=right><b>" + addCommas(parseInt(diff)) +"</b></td></tr>";
  mhtl +="<tr><td></td></tr><tr><td>"+uW.g_js_strings.commonstr.happiness+"</td>";
  for(var i=0; i<Cities.numCities; i++) {
   cityID = 'city'+ Cities.cities[i].id;
   var bon = parseInt(Seed.citystats[cityID]["pop"][2]);
   var bonc = "red";
   if (bon>99) bonc="green";
   mhtl += "<td style='color:"+bonc+"'><center><b>"+bon+"</td>";
  }
  var now = unixTime();
  var totalpop=0,tpop=0;
  mhtl += "</tr><tr><td>"+lang.tournoi.training+"</td>";
  for(var i=0; i<Cities.numCities; i++) {
   cityID = Cities.cities[i].id;
   var q = Seed.queue_unt['city'+cityID];
   if (parseInt(q.length)>=parseInt(getCityBuilding(cityID, 13).count-1)) {
   mhtl += "<td style='color:red;'><center><b>"+ q.length +"/"+getCityBuilding(cityID, 13).count +"</td>";
   }else{
   mhtl += "<td><center><b>"+ q.length +"/"+getCityBuilding(cityID, 13).count +"</td>";
   }
  }
  mhtl += "</tr><tr><td>"+lang.tournoi.training+"</td>";
  var phtl = "</tr><tr><td>"+lang.tournoi.popdispo+"</td>";
    for(var i=0; i<Cities.numCities; i++) {
     cityID = 'city'+ Cities.cities[i].id;
     var totTime = 0, totTime2=0;
     var q = Seed.queue_unt[cityID];
     first = true;     first2 = true;
     if (q!=null && q.length>0) {
		 totalpop=0;
         for (var zz=0; zz<q.length; zz++){
			if (q[zz][7]) {
				start2 = q[zz][2];
				end2 = q[zz][3];
				if (first2)
					   actual2 = end2 - now;
				else
					 actual2 = end2 - lastEnd2;
				if (actual2 < 0)
			            actual2 = 0;
				lastEnd2 = end2;
				first2 = false;
          		totTime2 = totTime2 + actual2;
			}else{
				start = q[zz][2];
				end = q[zz][3];
				if (first)
					   actual = end - now;
				else
					 actual = end - lastEnd;
				if (actual < 0)
			            actual = 0;
				lastEnd = end;
				first = false;
          		totTime = totTime + actual;
			}

         totalpop += parseIntNan((parseInt(q[zz][1]) * uW.unitcost['unt'+q[zz][0]][6]) / 2);
         }
     }
     tpop+=totalpop;
     if (totTime < 0) totTime = 0;
     if (totTime < 3600)
      var bonc="style='color:red'";
     else
      var bonc="";
     if (totTime2 < 0) totTime2 = 0;
	 if (totTime2 < 3600)
	   var bonc2="style='color:red'";
	  else
       var bonc2="";
     mhtl += "<td><center><span "+bonc+"><b>"+timestr(totTime)+"</b></span>";
     if (totTime2>0) mhtl += "<br><span "+bonc2+"><b>"+timestr(totTime2)+"</b></span>"
     mhtl += "</td>";
     phtl += "<td "+bonc+"><center><b>"+addCommas(totalpop)+"</td>";
    }
  mhtl += '<tr><td></td></tr>'+phtl+'<td><center><b>'+addCommas(tpop)+'</td>';
  var tpop="";
  for(var i=0; i<Cities.numCities; i++) {
     cityID = 'city'+ Cities.cities[i].id;
     popact=parseIntNan(Math.round(Seed.citystats[cityID]["pop"][0] / Seed.citystats[cityID]["pop"][1] *10000)/100);
    tpop += "<td><center><b>"+popact+"</td>";
 }
  mhtl += '<tr><td></td></tr><td>Pop Reg%</td>'+tpop+'</tr>';
  mhtl +='<tr><td><img height=18 src='+gameurl+'img/iron_30.png></td>'
  for(var i=0; i<Cities.numCities; i++) {
   cityID = 'city'+ Cities.cities[i].id;
   var mine=Seed.resources[cityID]['rec4'][0] / 3600
   var bonc="";
   if (mine<=15000000)
    var bonc="style='color:red'";

    mhtl += '<td "+bonc+" align=right><b>'+UniteKMG(parseInt(mine)) +'</td>';
  }
  mhtl += "</tr></table><br><DIV class=boStat><b>"+lang.tournoi.title2+"</b>&nbsp;<select id=BOPosTournoi><option value=0>"+uW.g_js_strings.commonstr.tournament+"</option><option value=1>"+uW.g_js_strings.commonstr.previous+" 1</option><option value=2>"+uW.g_js_strings.commonstr.previous+" 2</option><option value=3>"+uW.g_js_strings.commonstr.previous+" 3</option><option value=4>"+uW.g_js_strings.commonstr.previous+" 4</option></select></div><div id=BOTournoiResult></div>";
  t.cont.innerHTML += mhtl;

  ById("BOTournoiUnit").addEventListener('change', function(e){

       	      Options.TourUnit = ById("BOTournoiUnit").value;
       	      saveOptions();
       	      t.show();

  },false);
  ById("BOPosTournoi").value=t.pos;
  ById("BOPosTournoi").addEventListener('change', function(e){
  		t.pos =  ById("BOPosTournoi").value;
         	t.Tournoi(t.pos);
  },false);


  t.Tournoi(t.pos);
},
Tournoi: function(pos) {
  var t = myBO.Tournoi;
  var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
  params.format=2;
  params.tournyPos=pos;
  new AjaxRequest(unsafeWindow.g_ajaxpath+"ajax/getLeaderboard.php"+unsafeWindow.g_ajaxsuffix, {  method:"post",  parameters:params,
  onSuccess:function(transport){
   var rslt=eval("("+transport.responseText+")");
   if(rslt.ok){

    if(!rslt.data && !rslt.name){

			ById("BOTournoiResult").innerHTML ="<div class='tourny_modal_upsell'><br><center><b>"+unsafeWindow.g_js_strings.modal_tourny_changetab.notourny+"</b></center></div>"+pubdusite;

    }else{ // fin rslt.data
     var tournyhtml=new Array();

     if(rslt.name){
	    tournyhtml.push("<div><center><b><u>"+rslt.name+"</u></b></center></div>")
     }  else{
	    tournyhtml.push("<div class='tournymodaltitle'><center>"+unsafeWindow.g_js_strings.commonstr.tournament+"</div>")
     }
	   tournyhtml.push("<div>");



	   if(rslt.startDate&&rslt.endDate){
	   	   	    var startTime=rslt.startDate;
	   	   	    var endTime=rslt.endDate;
	   	   	    var lastupdate=rslt.lastUpdated;
	   	   	    var dup = new Date();
	   	   	     dup.setTime (lastupdate * 1000);
	   	   	    var now=parseInt(new Date().getTime()/1000);
	   	   	    tournyhtml.push("<table width=100% align=center class=ptTab><tr bgcolor=#FE8888><td width=30%><b>"+lang.tournoi.start+"</td><td width=30%><b>"+lang.tournoi.end+"</td><td width=20%><b>"+lang.tournoi.timeRem+"</td><td width=20%><b>Last Update</td></tr>");
	   	   	    dt = new Date ();
	   	            dt.setTime (startTime * 1000);
	   	            dtf = new Date ();
	   	            dtf.setTime (endTime * 1000);

	   	            var restant = endTime - now;


	   	   	   tournyhtml.push("<tr><td>");
	   	   	     tournyhtml.push("" + dt.toLocaleDateString() + " - "+ dt.toLocaleTimeString());
	   	   	    tournyhtml.push("</td><td>");
	   	   	    tournyhtml.push("" + dtf.toLocaleDateString()+ " - "+ dtf.toLocaleTimeString());
	   	   	    tournyhtml.push("</td><td>"+timestr(restant,1)+"</td><td>"+dup.toLocaleTimeString()+"</td></tr></table>");

	   }


	   tournyhtml.push("<center><DIV style='max-height:300px; overflow-y:auto;'><table class='tourny_list_table' cellpadding='0' cellspacing='0' border='0' width=90% style='margin:3px'>");
	   tournyhtml.push("<thead>");
	   tournyhtml.push("<tr>");
	   tournyhtml.push("<td class='rankcol' style='background-color:red'>");
	   tournyhtml.push("<div><select id='BOTournoiPM'><option value=5>5</option><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option><option value=200>200</option></select></div>");
	    tournyhtml.push("</td>");
     if(rslt.type==24){ // << tournoi de glore
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>"+unsafeWindow.g_js_strings.modal_tourny_changetab.chancellorname+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>"+unsafeWindow.g_js_strings.commonstr.alliance.substring(0,20)+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>"+unsafeWindow.g_js_strings.modal_tourny_changetab.mightgained+"</div>");
	    tournyhtml.push("</td  style='background-color:red'>");
	    tournyhtml.push("<td  style='background-color:red'> ");
	    tournyhtml.push("<div>"+unsafeWindow.g_js_strings.modal_tourny_changetab.rewardperplayer+"</div>");
	    tournyhtml.push("</td>")
      }else{
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>Nom Joueur</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>"+unsafeWindow.g_js_strings.commonstr.alliance+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>"+rslt.contestcategory+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td  style='background-color:red'>");
	    tournyhtml.push("<div>"+unsafeWindow.g_js_strings.commonstr.reward+"</div>");
	    tournyhtml.push("</td>")
     }
	   tournyhtml.push("</tr>");
	   tournyhtml.push("</thead>");
	   tournyhtml.push("</tbody>");
	   var nb=0;
	   if (rslt.data)
	    nb=rslt.data.length;
	   var votrepuissance = 0;
	   if (nb>0) {

	   for(var i=0;i<nb;i++){
	    var row=rslt.data[i];
	    if(rslt.type==24){
	     // pour le tournoi alliance
	     if (getMyAlliance()[1] == row.alliance) {
	      votrepuissance=row.contestValue;
	      break;
	     }
	    } else {
	     if (Seed.player.prefix + ' '+ Seed.player.name == row.name ) {
	      votrepuissance=row.contestValue;
	      break;
	     }
	    }
	   }
	   for(var i=0;i< Options.TournoiLigne;i++){
	    var row=rslt.data[i];
	    if (!row) continue;
	    var rewardString=row.itemCount+" ";
	    if(row.itemType==0){
	     rewardString+=unsafeWindow.g_js_strings.commonstr.gems;
	    }else{
	     rewardString+=unsafeWindow.itemlist["i"+row.itemType].name;
	    }
	    var couleur="";
	    if(rslt.type==24){
	     // pour le tournoi alliance
	     if (getMyAlliance()[1] == row.alliance) {
	      couleur=" style='background-color:#77FF77' ";
	     }
	    }else{
	     if (getMyAlliance()[1] == row.alliance) {
	       if(i%2==1){
	     	      couleur=" style='background-color:#FF9977' ";
	     	    }else{
	     	      couleur=" style='background-color:#FFAA88' ";
	       }

	     }
	     if (Seed.player.prefix + ' '+ Seed.player.name == row.name ) {
	      couleur=" style='background-color:#77FF77' ";
	     }
	    }
	    if(i%2==1){
	     tournyhtml.push("<tr>")
	    }else{
	     tournyhtml.push("<tr class='stripe'>")
	    }
	    tournyhtml.push("<td class='rankcol' "+couleur+">");
	    tournyhtml.push("<div><b>"+row.ranking+"</b></div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td "+couleur+">");
	    tournyhtml.push("<div>"+row.name+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td "+couleur+">");
	    tournyhtml.push("<div>"+(row.alliance||"----")+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td "+couleur+">");
	    tournyhtml.push("<div><b>"+addCommas(row.contestValue))+"<b>";
	    if (votrepuissance>0) {
	      var ecartavecvous = parseInt(row.contestValue - votrepuissance);
	      if (ecartavecvous>0) {
	       tournyhtml.push("<br><span style='font-size:10px'><i>+" + addCommas(ecartavecvous) +"</i></span>");
	      }
	      if (ecartavecvous<0) {
	       tournyhtml.push("<br><span style='font-size:10px'><i>" + addCommas(ecartavecvous) +"</i></span>");
	      }
	    }
	    tournyhtml.push("</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("<td "+couleur+">");
	    tournyhtml.push("<div>"+rewardString+"</div>");
	    tournyhtml.push("</td>");
	    tournyhtml.push("</tr>")
	   } // fin du for

	   if(rslt.type!=24){

	    for(var i= Options.TournoiLigne;i<rslt.data.length;i++){
	   	    var row=rslt.data[i];

	   	    if (Seed.player.prefix + ' '+ Seed.player.name == row.name ) {
	   	      var rewardString=row.itemCount+" ";
	   	     	    if(row.itemType==0){
	   	     	     rewardString+=unsafeWindow.g_js_strings.commonstr.gems;
	   	     	    }else{
	   	     	     rewardString+=unsafeWindow.itemlist["i"+row.itemType].name;
	   	     	    }
	   	     	    tournyhtml.push("<tr class='stripe' >")
	   	     	    tournyhtml.push("<td class='rankcol' style='background-color:#77FF77'>");
	   	     	    tournyhtml.push("<div><b>"+row.ranking+"</b></div>");
	   	     	    tournyhtml.push("</td>");
	   	     	    tournyhtml.push("<td style='background-color:#77FF77'>");
	   	     	    tournyhtml.push("<div>"+row.name+"</div>");
	   	     	    tournyhtml.push("</td>");
	   	     	    tournyhtml.push("<td style='background-color:#77FF77'>");
	   	     	    tournyhtml.push("<div>"+(row.alliance||"----")+"</div>");
	   	     	    tournyhtml.push("</td>");
	   	     	    tournyhtml.push("<td style='background-color:#77FF77'>");
	   	     	    tournyhtml.push("<div>"+addCommas(row.contestValue)+"</div>");
	   	     	    tournyhtml.push("</td>");
	   	     	    tournyhtml.push("<td style='background-color:#77FF77'>");
	   	     	    tournyhtml	.push("<div>"+rewardString+"</div>");
	   	     	    tournyhtml.push("</td>");
	   	            tournyhtml.push("</tr>")
	   	   }
	   }
	   }

   } else {
	   tournyhtml.push("<tr class='stripe' >")
	   	     	    tournyhtml.push("<td colspan=5 class='rankcol' style='background-color:#77FF77'>");

	   	    tournyhtml.push(rslt.description+"</td>");
	   	            tournyhtml.push("</tr>")
   }
	   tournyhtml.push("</tbody>");
	   tournyhtml.push("</table>");
      tournyhtml.push("</div></div>");
      ById("BOTournoiResult").innerHTML = tournyhtml.join("");

    ById('BOTournoiPM').value=Options.TournoiLigne;
           ById('BOTournoiPM').addEventListener ('change',
           function() {
            Options.TournoiLigne=ById('BOTournoiPM').value;
            saveOptions();
            t.show();
           }, false);


          } // fin rslt.data
         } else {
            ById("BOTournoiResult").innerHTML = "<div class='tourny_modal_upsell'><center>"+lang.tournoi.error+"</div>";
         }
       }, onFailure:function()  {
         ById("BOTournoiResult").innerHTML = "<div class='tourny_modal_upsell'><center>"+lang.tournoi.error+"</div>";
       }
   });
   t.displayTimer = setTimeout (function() { t.Tournoi(pos); }, 240000);

  },

},
myBO.Resources = {
   cont:null,
  resource : {1:uW.g_js_strings.commonstr.food, 2:uW.g_js_strings.commonstr.wood, 3:uW.g_js_strings.commonstr.stone, 4:uW.g_js_strings.commonstr.ore},
  users : [],
  doList : [],
  accepting : false,
  city : null,
  total : {gold:0, 1:0, 2:0, 3:0, 4:0},
  init : function (){
    this.cont = document.createElement('div');
    return this.cont;
  },
  show : function (){
    var t = myBO.Resources;
    this.cont.style.overflowY = 'scroll';
     this.cont.innerHTML = '<DIV class=boStat><b>'+lang.Resources.title+'</b></div><TABLE cellpadding=0 cellspacing=0 class=pbTab width=100%><TR><TD align=center><INPUT id="pballlist" type=button class=pbButton value="'+lang.Resources.pballlist+'" \><INPUT id="pballlist2" type=button class=pbButton  value="'+lang.Resources.pballlist2+'" \></td></tr></table><HR>\
        <DIV id=resDiv style="width:100%; min-height:300px; height:100%">';
    ById('pballlist').addEventListener ('click', function() { t.e_clickfetchlist(1); }, false);
    ById('pballlist2').addEventListener ('click', function() { t.e_clickfetchlist(2); }, false);
  },

  hide : function (){
  },

  progress : function (msg, span, add){
	if(add)
		ById(span).innerHTML+=msg;
	else
		ById(span).innerHTML=msg;
  },

  e_clickfetchlist : function  (tt){     // (also cancel accepting)
    var t = myBO.Resources;
	t.users = [];
    if (t.accepting){
      ById('pballlist').value = lang.Resources.pballlist;
      ById('resDiv').innerHTML+= '<BR><SPAN class=boldRed>'+lang.Resources.cancel+'</span>';
      t.accepting = false;
      return;
    }
    if (tt==1) ById('resDiv').innerHTML = lang.Resources.load1+' <span id=pbResUserListCount></span>';
    if (tt==2) ById('resDiv').innerHTML = lang.Resources.load2+' <span id=pbResUserListCount></span>';

    t.fetchUserList (tt, gotUserList);
    function gotUserList(userList){
		if(userList.length < 1){
			listGifts();
			return;
		}
		ById('resDiv').innerHTML += '<BR>'+lang.Resources.check+' <span id=pbResUserAvailCount></span>';
		t.checkDailyAction(userList, listGifts);
	}

    function listGifts (){
	  t.city = Cities.cities[0];
	  var m = '<DIV class=boStat><CENTER>'+lang.Resources.title2+'&nbsp;('+ t.users.length +' '+lang.Resources.find+')</center></div>';
      if (t.users.length<1){
        ById('resDiv').innerHTML = m + '<BR><BR><CENTER>'+lang.Resources.nothing+'</center>';
        return;
      }
      m += '<TABLE class=pbTab align=center><TR><TD align=right>'+unsafeWindow.g_js_strings.commonstr.city+' : </td><TD id=pbrescityselspan></td></tr>\
          <TR><TD align=right>'+lang.Resources.collect+'</td><TD>'
        + htmlSelector (t.resource, Options.getResType, 'id=pbResColType')
        + '</td></tr><TR><TD>'+lang.Resources.select+'</td><TD width=250><INPUT type=button class=pbButton id=pbResDo value="'+lang.Resources.accept+'">\
        &nbsp; <SPAN id=pbResNone class=boldRed></span></td></tr></table><HR><TABLE class=pbTab><TR valign=top><TD>\
        <INPUT id=pbResButAll type=button value="'+lang.General.all+'" class=pbButton ><BR><INPUT id=pbResButNone type=submit value="'+lang.General.nothing+'"></td>\
        <TD width=10></td><TD><TABLE align=center cellpadding=0 cellspacing=0 class=pbTabLined>\
        <TBODY id=pbResTbody style="height:250px; overflow:auto; display:block;">\
        <TR style="font-weight:bold; background:white"><TD>'+lang.General.name+'</td><TD>'+uW.g_js_strings.commonstr.might+'</td><TD width=20></td></tr>';
      for (var i=0; i<t.users.length; i++){
        m += '<TR><TD><INPUT type=checkbox id=pbrchk_'+ i +'> &nbsp;'+ t.users[i].name +'</td><TD>'+ t.users[i].might +'</td></tr>';
      }
      ById('resDiv').innerHTML = m + '</tbody></table></td></tr></table>';
	  new CdispCityPicker ('pbrescitysel', ById('pbrescityselspan'), true, t.e_CityButton, t.city.idx);
      ById('pbResDo').addEventListener ('click', t.getErDone, false);
      ById('pbResButAll').addEventListener ('click', t.e_butAll, false);
      ById('pbResButNone').addEventListener ('click', t.e_butNone, false);
    }
  },
  e_CityButton : function (city, x, y){
    var t = myBO.Resources;
	t.city = city;
  },

  e_butAll : function (){
    var t = myBO.Resources;
    for (var i=0; i<t.users.length; i++)
      ById('pbrchk_'+i).checked = true;
  },

  e_butNone : function (){
    var t = myBO.Resources;
    for (var i=0; i<t.users.length; i++)
      ById('pbrchk_'+i).checked = false;
  },

  getErDone : function (){
    var t = myBO.Resources;
    t.doList = [];
    ById('pbResNone').innerHTML = '';
	Options.getResType = ById('pbResColType').value;
	t.total = {gold:0, 1:0, 2:0, 3:0, 4:0};
    for (var i=0; i<t.users.length; i++){
      if (ById('pbrchk_'+i).checked)
        t.doList.push (t.users[i]);
    }
    if (t.doList.length==0){
      ById('pbResNone').innerHTML = lang.Resources.error1;
      return;
    }
    t.accepting = true;
    ById('pballlist').value = lang.Resources.stop;
    ById('resDiv').innerHTML = '<DIV id=rsltDiv style="height:400px; max-height:400px; overflow-y:auto"><B>'+lang.Resources.collecting+' '+ t.doList.length +' '+lang.Resources.members+'</b><BR></div>';
    t.acceptNext ();
  },


  allDone : function (msg){
    var t = myBO.Resources;
	msg += '<BR><BR>'+lang.Resources.total+'<BR>\
		   Or : '+addCommas(t.total.gold)+'<BR>';
	for(var i=1; i<=4; i++){
		msg += t.resource[i]+': '+addCommas(t.total[i])+'<BR>';
	}
    ById('rsltDiv').innerHTML += '<BR><BR>' + msg;
    ById('pballlist').value = lang.Resources.pballlist;
    t.accepting = false;
  },


  acceptNext : function (){
    var t = myBO.Resources;
    var gift = t.doList.shift();
    if (gift == null){
      t.allDone (lang.Resources.alldone);
      return;
    }
    var acpDiv = ById('rsltDiv');
    var curDiv = document.createElement ('div');
    acpDiv.appendChild (curDiv);
    curDiv.innerHTML = '<B>>> '+ gift.name +': ';
    var statSpan = document.createElement ('span');
    curDiv.appendChild (statSpan);
    statSpan.innerHTML = lang.Resources.collecting2;
    t.getCourtAction (gift, gotGiftData);

    function gotGiftData (rslt){
      if (!t.accepting)
        return;
      if (rslt.ok){
        var msg = rslt.gold +' '+uW.g_js_strings.commonstr.gold+' - '+rslt.resource +' '+ t.resource[rslt.resourcetype]+'&nbsp; &nbsp; <font color=green><b>OK</b></font>.';
        statSpan.innerHTML += msg;
		t.total.gold += rslt.gold;
		t.total[rslt.resourcetype] += rslt.resource;
		t.acceptNext ();
        return;
      }

      if (rslt.msg)
        msg = '<B>'+ rslt.msg + '</b>';
      else
        msg = '<SPAN class=boldRed>ERROR : '+ rslt.ajaxErr +'</span>';

      curDiv.removeChild (statSpan);
      curDiv = document.createElement ('div');
      curDiv.className = 'indent25';
      acpDiv.appendChild (curDiv);
      curDiv.innerHTML = msg;
      t.acceptNext ();
    }

  },

  getMembersInfo : function (pageNo, notify) {
    var t = myBO.Resources;
    var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);

    params.pageNo = pageNo;
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/allianceGetMembersInfo.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onFailure: function (rslt) {
        notify ({errMsg:'Ajax Comm Error'});
      },
    });
  },
    getFriendsInfo : function (notify) {
      var t = myBO.Resources;
      var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
      new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getAppFriends.php" + unsafeWindow.g_ajaxsuffix, {
        method: "post",
        parameters: params,
        onSuccess: function (rslt) {
          notify (rslt);
        },
        onFailure: function (rslt) {
          notify ({errMsg:'Ajax Comm Error'});
        },
      });
  },
  getDailyAction : function (uid, notify){
	var t = myBO.Resources;
    var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);

    params.pid = uid;
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/viewCourt.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onFailure: function (rslt) {
        notify ({errMsg:'Ajax Comm Error'});
      },
    });
  },

  getCourtAction : function (gift, notify){
	var t = myBO.Resources;
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.atype = Options.getResType;
	params.toid = gift.userId;
	params.givercityid = t.city.id;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/courtDoAction.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onFailure: function (rslt) {
        notify ({errMsg:'Ajax Comm Error'});
      },
    });
  },

  checkDailyAction : function (userList, notify){
	var t = myBO.Resources;
	var count = 0;
    t.getDailyAction(userList[count].userId, parseViewCourt);

	function parseViewCourt (rslt){
		if (!rslt.ok || rslt.errMsg)
			notify ({errMsg:'Ajax Comm Error'});
		if(rslt.dailyActionFlag == 0)
			t.users.push(userList[count]);
		t.progress(count, 'pbResUserAvailCount');
		count++;
		if(count < userList.length){
			t.getDailyAction(userList[count].userId, parseViewCourt);
		} else {
			notify();
		}
	}
  },
  fetchUserList : function (tt, notify){
    var t = myBO.Resources;
    var userList = [];
    if (tt==1)
      t.getMembersInfo(1, parseAlliancePage);

    if (tt==2)
      t.getFriendsInfo(parseAlliancePage2);
    function parseAlliancePage (rslt){
      if (!rslt.ok || rslt.errMsg)
        notify ({errMsg:'Ajax Comm Error'});
	  var users = rslt.memberInfo;
      for(var k in users){
		userList.push({userId:users[k].userId, name:users[k].name, might:users[k].prestige, type:'alliance'});
	  }
	  t.progress(userList.length, 'pbResUserListCount');
	  if(rslt.currentPage < rslt.noOfPages){
		t.getMembersInfo((rslt.currentPage+1), parseAlliancePage);
	  } else {
		notify(userList);
		//t.getFriendsInfo(parseAlliancePage2);
	  }
    }


    function parseAlliancePage2 (rslt){
	      if (!rslt.ok || rslt.errMsg)
	        notify ({errMsg:'Ajax Comm Error'});
		  var users = rslt.data;
	          for(var k in users){
	             if (users[k].userId!=undefined)
			userList.push({userId:users[k].userId, name:users[k].displayName, might:users[k].might, type:'friends'});
		  }
		  t.progress(userList.length, 'pbResUserListCount');
		  notify(userList);
    }

  },
   getContent : function (){
  	    var t = myBO.Resources;
  	    return t.cont;
 },
},

myBO.Spam = {
  cont : null,
  timer : null,

  init : function (){
    var t = myBO.Spam;
    t.cont = document.createElement('div');
     return t.cont;
 },
    getContent : function (){
   	    var t = myBO.Spam;
   	    return t.cont;
 },
  show : function (){
    var t = myBO.Spam;

        var m = '<DIV class=boStat>'+lang.Spam.title+'</div><TABLE class=pbTab width=100% height=0% ><TR align="center">';

           if (Options.spamconfig.aspam == true) {
            m += '<TD><INPUT id=pbSpamEnable type=button class=pbButton value="Spam On"></td>';
           }
           else {
            m += '<TD><INPUT id=pbSpamEnable type=button class=pbButton value="Spam Off"></td>';
           }

           if (Options.spamconfig.spamstate == 'a') {
            m += '<TD><INPUT id=pbSpamState type=button class=pbButton value="'+lang.Spam.pbSpamState1+'"></td>';
           }
           else {
            m += '<TD><INPUT id=pbSpamState type=button class=pbButton value="'+lang.Spam.pbSpamState2+'"></td>';
           }
            m += '</tr></table></div>';
           m += '<DIV class=boStat>OPTIONS</div><TABLE class=pbTab>';
            m += '<tr><td>'+lang.Spam.pbSpamMin+' <INPUT id=pbSpamMin type=text size=2 maxlength=3 value="'+ Options.spamconfig.spammins +'"  \> '+lang.General.mins+'</td></tr><BR>\
                  <tr><TD><TABLE cellpadding=0 cellspacing=0>\
                  <TD align=left>'+lang.Spam.pbSpamAd+' &nbsp; </td><TD><INPUT id=pbSpamAd type=text size=60 maxlength=250 value="'+ Options.spamconfig.spamvert +'" \></td></tr>\
                  </table><BR>';

        t.cont.innerHTML = m;

        ById('pbSpamEnable').addEventListener ('click', function(){t.toggleon(this);}, false);
        ById('pbSpamAd').addEventListener ('change', t.e_spamOptChanged, false);
        ById('pbSpamMin').addEventListener ('change', t.e_spamOptChanged, false);
    ById('pbSpamState').addEventListener ('click', function(){t.togglespam(this);}, false);

  },
  hide : function (){
    var t = myBO.Spam;
  },


 e_spamOptChanged : function (){
  var t = myBO.Spam;
  Options.spamconfig.spamvert = ById('pbSpamAd').value;
  Options.spamconfig.spammins = ById('pbSpamMin').value;
  if(parseInt(Options.spamconfig.spammins) < 30){
   Options.spamconfig.spammins = 30;
   ById('pbSpamMin').value = 30;
  }
  saveOptions ();
 },

 togglespam: function(obj){
  var t = myBO.Spam;
  if (Options.spamconfig.spamstate == 'a') {
   Options.spamconfig.spamstate = 'g';
   obj.value = lang.Spam.pbSpamState2;
  }
  else {
   Options.spamconfig.spamstate = 'a';
   obj.value = lang.Spam.pbSpamState1;
  }
  saveOptions ();

 },

 toggleon: function(obj){
  var t = myBO.Spam;
  if (Options.spamconfig.aspam == true) {
   Options.spamconfig.aspam = false;
   obj.value = "Spam Off";
  }
  else {
   Options.spamconfig.aspam = true;
   obj.value = "Spam On";
   SpamEvery.init();
  }
  saveOptions ();

 },
};

var SpamEvery  = {
  timer : null,
  spamtimer : 0,
  init : function (){
    if (!Options.spamconfig.aspam) return;
    if (Options.spamconfig.spammins < 30)
      Options.spamconfig.spammins = 30;
    SpamEvery.setEnable (Options.spamconfig.aspam);
  },
  setEnable : function (tf){
    var t = SpamEvery;
    clearTimeout (t.timer);
    if (tf)
      t.timer = setTimeout (t.count, 60*1000);
  },
  count : function (){
   var t = SpamEvery;
   t.spamtimer = Options.spamconfig.spammins;
   if(parseInt(t.spamtimer) < 30) t.spamtimer = 30;
   if (Options.spamconfig.atime > t.spamtimer) {
    Options.spamconfig.atime = 2;
    t.doit ();
   } else {
    Options.spamconfig.atime = (Options.spamconfig.atime + 1);
    SpamEvery.init ();
   }
   saveOptions ();
  },
  doit : function (){
    sendChat ("/" + Options.spamconfig.spamstate + " " +  Options.spamconfig.spamvert);
    SpamEvery.init ();
  }
}
myBO.ActionLog = {
  myDiv : null,
  logTab : null,
  maxEntries: 50,
  last50 : [],
  state : null,
  init : function (){
     this.myDiv = document.createElement('div');
     window.addEventListener('unload', t.onUnload, false);
    return this.myDiv;
  },
  show : function (div){
    var t = myBO.ActionLog;

        t.myDiv = this.myDiv;
        t.myDiv.innerHTML = '<DIV  class=boStat>'+lang.log.title+'</div><DIV style="height:335px; max-height:335px; overflow-y:auto">\
       <select id=BOSuiviFiltre><option value="">'+uW.g_js_strings.commonstr.all+'</option><option value="Erreur">'+lang.log.option1+'</option>\
       <option value="Rapport">'+lang.log.option2+'</option><option value="AutoCons">'+uW.g_js_strings.commonstr.build+'</option><option value="Transport">'+lang.log.option3+'</option><option value="Appro">'+lang.log.option8+'</option>\
       <option value="AutoForm">'+lang.log.option9+'</option><option value="Reassign">'+lang.log.option4+'</option><option value="AutoFO">'+lang.log.option7+'</option>\
       <option value="RAID">Raid</option><option value="AutoTS">'+lang.log.option5+'</option><option value="AutoSalvage">'+lang.log.option10+'</option><option value="AutoTrone">'+lang.log.option6+'</option></select>\
       &nbsp;<input type=button class=pbButton value="'+lang.log.clear+'" id=BOLogClean><br><TABLE cellpadding=0 cellspacing=0 id=BOactionlog class=pbTabLined></table></div>\
       <DIV  class=boStat>'+lang.log.title2+'</div><DIV style="height:160px; max-height:160px; overflow-y:auto">\
       <INPUT id=BOLogsAutoTs type=checkbox '+ (Options.LogsAutoTs?'CHECKED ':'') +'/>'+lang.log.BOLogsAutoTs+'&nbsp;\
       <INPUT id=BOLogsSalvage type=checkbox '+ (Options.LogsSalvage?'CHECKED ':'') +'/>'+lang.log.BOLogsSalvage+'&nbsp;\
       <INPUT id=BOLogsTransportAuto type=checkbox '+ (Options.LogsTransportAuto?'CHECKED ':'') +'/>'+lang.log.BOLogsTransportAuto+'&nbsp;\
       <INPUT id=BOLogsReassign type=checkbox '+ (Options.LogsReassign?'CHECKED ':'') +'/>'+lang.log.BOLogsReassign+'&nbsp;\
       <INPUT id=BOLogsAppro type=checkbox '+ (Options.LogsAppro?'CHECKED ':'') +'/>'+lang.log.BOLogsAppro+'&nbsp;\
       <INPUT id=BOLogsRapport type=checkbox '+ (Options.LogsRapport?'CHECKED ':'') +'/>'+lang.log.BOLogsRapport+'&nbsp;\
       <INPUT id=BOLogsAutoForm type=checkbox '+ (Options.LogsAutoForm?'CHECKED ':'') +'/>'+lang.log.BOLogsAutoForm+'<br>\
       <INPUT id=BOLogsAutoCons type=checkbox '+ (Options.LogsAutoCons?'CHECKED ':'') +'/>'+lang.log.BOLogsAutoCons+'&nbsp;\
       <INPUT id=BOLogsAutoCraft type=checkbox '+ (Options.LogsAutoCraft?'CHECKED ':'') +'/>'+lang.log.BOLogsAutoCraft+'&nbsp;\
       </div>';
    t.logTab = ById('BOactionlog');
    t.filtre = ById('BOSuiviFiltre');
    t.state = 1;
    t.filtre.addEventListener ('change', t.pouette, false);
    ById('BOLogClean').addEventListener ('click', t.deleteall, false);
	ById('BOLogsAutoTs').addEventListener ('click', function () {Options.LogsAutoTs = ById('BOLogsAutoTs').checked;saveOptions();}, false);
	ById('BOLogsSalvage').addEventListener ('click', function () {Options.LogsSalvage = ById('BOLogsSalvage').checked;saveOptions();}, false);
    ById('BOLogsTransportAuto').addEventListener ('click', function () {Options.LogsTransportAuto = ById('BOLogsTransportAuto').checked;saveOptions();}, false);
    ById('BOLogsAppro').addEventListener ('click', function () {Options.LogsAppro = ById('BOLogsAppro').checked;saveOptions();}, false);
    ById('BOLogsRapport').addEventListener ('click', function () {Options.LogsRapport = ById('BOLogsRapport').checked;saveOptions();}, false);
    ById('BOLogsAutoForm').addEventListener ('click', function () {Options.LogsAutoForm = ById('BOLogsAutoForm').checked;saveOptions();}, false);
    ById('BOLogsReassign').addEventListener ('click', function () {Options.LogsReassign = ById('BOLogsReassign').checked;saveOptions();}, false);
    ById('BOLogsAutoCons').addEventListener ('click', function () {Options.LogsAutoCons = ById('BOLogsAutoCons').checked;saveOptions();}, false);
    ById('BOLogsAutoCraft').addEventListener ('click', function () {Options.LogsAutoCraft = ById('BOLogsAutoCraft').checked;saveOptions();}, false);
    t.pouette();
  },
  deleteall: function() {
    var t = myBO.ActionLog;
    GM_setValue ('BOlog_'+getServerId(), '[]');
     t.pouette();
  },
  pouette: function() {
    var t = myBO.ActionLog;
    t.logTab.innerHTML="<TR><TD></td><td></td><TD width=95%></td></tr>";
      var a = JSON2.parse(GM_getValue ('BOlog_'+getServerId(), '[]'));
      if (matTypeof(a) == 'array'){
        t.last50 = a;
        for (var i=0; i<t.last50.length; i++) {
           if (t.filtre.value=="" || t.filtre.value==t.last50[i].ou) {
           t._addTab (t.last50[i].msg, t.last50[i].ou, t.last50[i].ts);
          }

        }
    }

  },
  hide : function (){
  },
  getContent : function (){
      return myBO.ActionLog.myDiv;
  },
  _addTab : function (msg, ou, ts){
    var t = myBO.ActionLog;
    if (t.state != 1)
      return;
    if (t.logTab.rows.length >= t.maxEntries)
      t.logTab.deleteRow(t.maxEntries-1);
    var row = t.logTab.insertRow(0);
    row.vAlign = 'top';
    row.insertCell(0).innerHTML = ts;
    row.insertCell(1).innerHTML = ou;
    row.insertCell(2).innerHTML = msg;
  },

  log : function (msg,ou){
    var t = myBO.ActionLog;
    var ts = new Date().toTimeString().substring (0,8);
    if (t.filtre) {
     if (t.filtre.value=="" || t.filtre.value==ou) {
      t._addTab (msg, ou, ts);
     }
    }else {
    t._addTab (msg, ou, ts);
    }
    while (t.last50.length >= 50)
      t.last50.shift();
    t.last50.push ({msg:msg, ts:ts, ou:ou});
    GM_setValue ('BOlog_'+getServerId(), JSON2.stringify(t.last50));
  },
    onUnload : function (){
      var t = myBO.ActionLog;
      if (!ResetAll) GM_setValue ('BOlog_'+getServerId(), JSON2.stringify(t.last50));
  },
}

function actionLog (ou,msg){
    myBO.ActionLog.log (msg,ou);
}
function chuchoLog (msg, qui){
    myBO.chucho.log (msg,qui);
}

myBO.Trone = {
  myDiv : null,  cont : null,  passage:null,  timer : null,  filtre:"",  tableau:[],  filtre9:"", filtre2:"",  filtre3:"",  filtre6:0,  filtre15:0,  filtre7:false,  filtre8:"",  filtre4:Options.AllEffet, filtre5:Options.EffetRouge,
  init : function (){
    this.myDiv = document.createElement('div');
    return this.myDiv;
  },
  hide : function (){
    var t = myBO.Trone;
  },
  getContent : function (){
      return myBO.Trone.myDiv;
  },
  postToChat:function(id) {
	 var t = myBO.Trone;
  	 var item = uW.kocThroneItems[id];
	 var msg = ThroneItemName(item) + " | ";
	 for (i=1;i<=5;i++) {
	 		id = item["effects"]["slot"+i]["id"];
	 		tier = parseInt(item["effects"]["slot"+i]["tier"]);
	 		level = item["level"];
	 		if (uW.cm.thronestats.tiers[id][tier])
	 			p = uW.cm.thronestats.tiers[id][tier];
	 		else
	 			p = uW.cm.thronestats.tiers[id][tier-1];
	 		Current = p.base + ((level * level + level) * p.growth * 0.5);
	 		var quality = parseInt(y["quality"]);
	 		msg += ' | ' + Math.round(Current*100)/100 + "% " + uW.cm.thronestats["effects"][id]["1"];
	 }
	 sendChat ("/a "+  msg);
  },
  Quality: ["ALL","Common","Uncommon","Rare","Epic","Wondrous"],
  ActionPopup : function(id) {
    var t = myBO.Trone;
      var action="";
      var m = '<DIV id=pbTowrtDivF class=boStat>'+lang.Trone.addqueuetitle+'</div><BR><TABLE id=pbCompareStats width=100% height=0% class=pbTab>';
    	m+= '<TR ><TD><input id=RadioEnhance type="radio" name="actions" value="Enhance">Enhance '+ ThroneItemName(uW.kocThroneItems[id]) +' '+lang.Trone.to1+' <SELECT id=EnhaceItems type=list></select></td></tr>';
    	m+= '<TR><TD><input id=RadioUpgrade type="radio" name="actions" value="Upgrade">Upgrade '+ ThroneItemName(uW.kocThroneItems[id]) +' '+lang.Trone.to+' <SELECT id=UpgradeItems type=list></select></td></tr>';
    	m+= '<TR><TD align=center><INPUT id=AaddToQueue type=button class=pbButton value="'+lang.Trone.addqueue+'"></td></tr></table><BR>';
    	m+= '<DIV id=pbTowrtDivF class=boStat>'+lang.Trone.addpreset+'</div><BR>';
    	m+= '<DIV>Preset: <SELECT id=PresetNames type=list></select><INPUT id=AddPreset type=button class=pbButton value="'+lang.Trone.addqueue+'"></div><BR>';

    	m+= '<DIV id=pbTowrtDivF class=boStat>Action</div><BR>';
    	m+= '<DIV align=center><INPUT id=PostToChat type=button class=pbButton value="'+lang.Trone.posttochat+'"></div><BR>';

       var popaction = new CPopup ('ActionPopup', 0, 0, 425, 330, true);
       popaction.centerMe (mainPop2.getMainDiv());
       popaction.getMainDiv().innerHTML = m;
       popaction.getTopDiv().innerHTML = '<CENTER><B>'+lang.Trone.actiontitle+'</b></center>';

       popaction.show (true);

       ById('EnhaceItems').options.length=0;
       var QualityCheck = parseInt(uW.kocThroneItems[id].quality) +1;
  	   for (i=QualityCheck;i<=5;i++){
  		var o = document.createElement("option");
  		o.text = t.Quality[i];
  		o.value = i;
  		ById("EnhaceItems").options.add(o);
  	}
  	ById('EnhaceItems').value = 5;
    ById('UpgradeItems').options.length=0;
    var LevelCheck = 1 + parseInt(uW.kocThroneItems[id].level);
  	for (i=LevelCheck;i<=14;i++){
  		var o = document.createElement("option");
  		o.text = i;
  		o.value = i;
  		ById("UpgradeItems").options.add(o);
  	}

  	ById('PresetNames').options.length=0;
  	for (i=1;i<=8;i++){
  		var o = document.createElement("option");
  		o.text = ThroneOptions.BOPresetName[i];
  		o.value = i;
  		ById("PresetNames").options.add(o);
  	}

  	ById("AaddToQueue").addEventListener ('click', function (){
  		if (ById("RadioEnhance").checked) action = "Enhance";
  		if (ById("RadioUpgrade").checked) action = "Upgrade";
  		if (action != "") {
  			if (action == "Enhance") var diff = parseInt(ById('EnhaceItems').value) - parseInt(uW.kocThroneItems[id].quality);
  			if (action == "Upgrade") var diff = parseInt(ById('UpgradeItems').value) -  parseInt(uW.kocThroneItems[id].level);
  			for (ii=0;ii<diff;ii++) ThroneOptions.Items.push ({id:parseInt(id),action:action,name:uW.kocThroneItems[id]["name"],qualityfrom:0,qualityto:0,levelfrom:0,levelto:0,cost:0,active:false});
  	    	saveThroneOptions();
  	    	popaction.show(false);
  	    	Tabs.Throne.checkUpgradeInfo(false);
  		}
  	},false);
   ById("PostToChat").addEventListener ('click', function (){
  			t.postToChat(parseInt(id));
  	    	pop.show(false);
  	},false);
	ById("AddPreset").addEventListener ('click', function (){
  			t.AddToPreset(parseInt(id));
  	    	popaction.show(false);
  	},false);
  },
  AddToPreset : function(id) {
  	var t = myBO.Trone;
  	if (typeof(uW.kocThroneItems[id]) == 'object') {
  				var y = uW.kocThroneItems[id];
  		} else return;
  	var type = y.type;
  	if (type == "window") type = "windows";
  	ThroneOptions.Presets[ById('PresetNames').value][type] = y.id;
  	saveThroneOptions();
  	if (ById("ShowTrPresets")) setTimeout(Dashboard.ShowTrPresets,1000);
},
  show : function (){
     var t = myBO.Trone;

     if (Options.salvageconfig.CityCity==undefined) Options.salvageconfig.CityCity=0;
     if (TESTBAO==-1) return false;
     uW.BOsalvage=t.salvage;
     uW.BOequipItem=t.equipItem;
     uW.BOUnequipItem=t.UnequipItem;
     uW.BORepair = t.Repair;
     uW.BOupgradeQualite = t.upgradeQualite;
     uW.BOupgradeLevel = t.upgradeLevel;
     uW.BOactionPop =t.ActionPopup;
     uW.BOUseSpeedRepair =t.BOUseSpeedRepair;
     t.cont = this.myDiv;
     var m="",nb=0,nbbroken=0,k=Seed.throne.slotEquip[Seed.throne.activeSlot],i=Seed.throne.inventory,e,faction,i = uW.kocThroneItems,sl=0;
     if (t.passage==null) {
      t.passage=1;
     var taille = 390;
      m += '<DIV class=boStat><b>'+lang.Trone.title+' - <input type=button value="?" id=boaidetrone class=boAide></b></div><table style="background-color:transparent;max-width:100%;width:755px;" cellspacing=0 cellpadding=2><tr>\
      <td><input type=checkbox id=BOFiltre4ST> '+lang.Trone.BOFiltre4ST+'<br><input type=checkbox id=BOFiltre7ST> '+lang.Trone.BOFiltre7ST+'<br>\
      Trone: <select id="BOFiltre9ST"><option value="">...</option>';
	   for (k= 1; k <= Seed.throne.slotNum; k++)
	   	{
	            m += '<option value="'+k+'">'+ k +' - '+ThroneOptions.presetname[k]+'</option>';
	  	}
       m += '</select></td><td><center>'+lang.Trone.BOlisteeffets+'<br><select id=BOlisteeffets multiple="multiple"></select>\
         </td><td style="text-align:right">'+pubdusite+'</center><font size=1><br>'+lang.Trone.BOTroneCityCity+'<br><span id=BOTroneCityCity></span></td>\
         </tr></table>';
      m +='<DIV class=boStat><b>'+lang.Trone.title2+'</b></div><DIV id=BOTroneAether style="width:100%;height:45px;max-height:45px;"></DIV><DIV class=boStat><b>'+lang.Trone.title3+' ';
      if (ThroneOptions.presetname[Seed.throne.activeSlot])
       m += " : " + ThroneOptions.presetname[Seed.throne.activeSlot];
      m +='</b></div><DIV id=BOTroneE style="width:100%;height:33px;max-height:33px;"></DIV>\
      <DIV class=boStat><b>'+lang.Trone.title4+' - <span id=BONbArticle></span></b></div><center><table style="background-color:transparent;max-width:95%;width:755px;" cellspacing=0 cellpadding=2>\
      <tr><td colspan=1 width=35>&nbsp;</td>\
      <td width=35><select id=BOFiltre8ST><option value="">'+uW.g_js_strings.commonstr.level+'...</option><option value=0>0</option><option value=1>+1</option><option value=2>+2</option><option value=3>+3</option><option value=4>+4</option><option value=5>+5</option><option value=6>+6</option><option value=7>+7</option><option value=8>+8</option><option value=9>+9</option><option value=10>+10</option><option value=11>+11</option><option value=12>+12</option><option value=13>+13</option><option value=14>+14</option></select></td>\
      <td width=120><select id=BOFiltre2ST><option value="">'+uW.g_js_strings.commonstr.quality+'...</option><option value="0">'+uW.g_js_strings.throneRoom.simple+'</option><option value="1">'+uW.g_js_strings.throneRoom.common+'</option><option value="2">'+uW.g_js_strings.throneRoom.uncommon+'</option><option value="3">'+uW.g_js_strings.throneRoom.rare+'</option><option value="4">'+uW.g_js_strings.throneRoom.epic+'</option><option value="5">'+uW.g_js_strings.throneRoom.wondrous+'</option><option value="6">'+uW.g_js_strings.throneRoom.unique+'</option></select></td>\
      <td width=80><select id=BOFiltreST><option value="">'+uW.g_js_strings.commonstr.faction+'...</option><option value="briton">briton</option><option value="druid">druid</option><option value="fey">fey</option></select></td>\
      <td width=80><select id=BOFiltre3ST><option value="">'+uW.g_js_strings.commonstr.type+'...</option><option value="advisor">'+uW.g_js_strings.throneRoom.advisor+'</option><option value="banner">'+uW.g_js_strings.throneRoom.banner+'</option><option value="chair">'+uW.g_js_strings.throneRoom.chair+'</option><option value="table">'+uW.g_js_strings.throneRoom.table+'</option><option value="window">'+uW.g_js_strings.throneRoom.window+'</option><option value="trophy">'+uW.g_js_strings.throneRoom.trophy+'</option><option value="candelabrum">'+uW.g_js_strings.throneRoom.candelabrum+'</option><option value="hero">'+uW.g_js_strings.throneRoom.hero+'</option></select></td>\
      <td width=250><select id=BOFiltre15ST></select><br><select id=BOFiltre5ST></select></td>\
      <td width=80><input type=checkbox id=BOTroneInverse>'+lang.Trone.BOTroneInverse+'</td></tr></table><DIV id=BOTroneC style="width:100%;height:'+taille+'px; max-height:'+taille+'px; overflow-y:auto"></div><br>';
      t.cont.innerHTML = m;
      ById('boaidetrone').addEventListener('click', function(){ window.open(sitesupport+"?page=aide_trone"); } , false);
      var dcp0 = new CdispCityPicker ('BORCityC', ById('BOTroneCityCity'), false, function(c) { var t = myBO.Trone;Options.salvageconfig.CityCity=c.idx;saveOptions();t.show();}, Options.salvageconfig.CityCity);
      var liste = uW.cm.thronestats.effects;
	  ById("BOlisteeffets").innerHTML="";
	  for (k in liste){
	         if (liste[k] !=undefined){
	             	var o = document.createElement("option");
	             	o.text = liste[k][1].substring(0,30);
	             	o.value = k;
	             	for (var ww=0;ww<t.filtre5.length;ww++)
			  if(t.filtre5[ww]==k)
	       			o.selected = true;
	             	ById("BOlisteeffets").options.add(o);
	         }
	     }
	     ById("BOFiltre5ST").innerHTML="";
	     ById("BOFiltre15ST").innerHTML="";
	      var o = document.createElement("option");
	     	     o.text = "----";
	     	     o.value = 0;
	     ById("BOFiltre15ST").options.add(o);
	     var ef=[];
	       	 var liste1 = uW.cm.thronestats.boosts;
	     for (k in liste1){
	         if (liste1[k] !=undefined ){
	          var o = document.createElement("option");
		  	             	o.text = liste1[k].BoostName;
		  	             	o.value = k;
	             	ById("BOFiltre15ST").options.add(o);
	         }
	     }


	     var o = document.createElement("option");
	     o.text = "----";
	     o.value = 0;
	     ById("BOFiltre5ST").options.add(o);
	     for (k in liste){
	         if (liste[k] !=undefined){
	           if (t.filtre15==0 || t.filtre15==liste[k][2]) {
	             	var o = document.createElement("option");
	             	o.text = liste[k][1].substring(0,35);
	             	o.value = k;
	             	ById("BOFiltre5ST").options.add(o);
	             	}
	         }
	     }

	     ById("BOlisteeffets").addEventListener ('change', t.filtreaction, false);

	     ById('BOFiltreST').value=t.filtre;
	     ById('BOFiltreST').addEventListener ('change', t.filtreaction, false);
	     ById('BOFiltre2ST').value=t.filtre2;
	     ById('BOFiltre2ST').addEventListener ('change', t.filtreaction, false);
	     ById('BOFiltre3ST').value=t.filtre3;
	     ById('BOFiltre3ST').addEventListener ('change', t.filtreaction, false);
	     ById('BOFiltre4ST').checked=t.filtre4;
	     ById('BOFiltre4ST').addEventListener ('click', t.filtreaction, false);
	     ById('BOFiltre5ST').value=t.filtre6;

	     ById('BOFiltre15ST').value=t.filtre15;
             ById('BOFiltre5ST').addEventListener ('change', function() {

             t.filtreaction();
             }, false);
    	     ById('BOFiltre15ST').addEventListener ('change', function() {
    	                t.filtre15 = ById('BOFiltre15ST').value;
	     	         var liste = uW.cm.thronestats.effects;
	     	         ById("BOFiltre5ST").innerHTML="";
	     	         var o = document.createElement("option");
	     	         	     o.text = "----";
	     	         	     o.value = 0;
	     	         	     ById("BOFiltre5ST").options.add(o);
	     	         	     for (k in liste){
	     	         	         if (liste[k] !=undefined){
	     	         	           if (t.filtre15==0 || t.filtre15==liste[k][2]) {
	     	         	             	var o = document.createElement("option");
	     	         	             	o.text = liste[k][1];
	     	         	             	o.value = k;
	     	         	             	ById("BOFiltre5ST").options.add(o);
	     	         	             	}
	     	         	         }
    }

    	     t.filtreaction();

    	     }, false);
    	     ById('BOFiltre7ST').checked=t.filtre7;
	     ById('BOFiltre7ST').addEventListener ('click', t.filtreaction, false);
	     ById('BOFiltre8ST').value=t.filtre8;
	     ById('BOFiltre8ST').addEventListener ('click', t.filtreaction, false);
	     ById('BOFiltre9ST').value=t.filtre9;
	     ById('BOFiltre9ST').addEventListener ('click', t.filtreaction, false);

	     ById('BOTroneInverse').checked=Options.TroneInverse;
	     ById('BOTroneInverse').addEventListener ('click', function() {
	      Options.TroneInverse = ById('BOTroneInverse').checked;

	      saveOptions ();
   		 t.show();
	     }, false);

     }
     m='<table style="background-color:transparent;width:760px;max-width:98%;" cellspacing=0 cellpadding=2>';
     t.tableau=[];
     for (var z in i) {
           if (i[z].id) {
            e=uW.kocThroneItems[i[z].id];
            if (e) {

              t.tableau[sl]=i[z].id;
              sl++
            }
           }
     }
     var lignauto = Seed.throne.rowNum * 5;
     if (Options.TroneInverse) t.tableau.reverse();
     var pastoucher = [];

       for (var nbslot=1;nbslot<=Seed.throne.slotNum;nbslot++) {
        B = Seed.throne.slotEquip[nbslot];
        for (var zzz in B) {
         if (uW.kocThroneItems[B[zzz]]) {
          pastoucher.push(B[zzz]);
         }
        }
       }

     var nbl=t.tableau.length+1;

     var BOtimeLeft=-1;
     if (Seed.queue_throne) {
      if (Seed.queue_throne.end)
          BOtimeLeft = Seed.queue_throne.end - uW.unixtime();
     }

     for (var z=0;z<t.tableau.length;z++) {
       e=uW.kocThroneItems[t.tableau[z]];
       var p="";
       var itemNr=0; for(z2 in uW.kocThroneItems) {itemNr++;if(z2==e.id)break;}
       nb++
       faction=e.faction;
       x=0;
       nbl--;
       if ((t.filtre9=="" || t.filtre9==e.presetId) && (t.filtre=="" || t.filtre==faction) && (t.filtre2=="" || t.filtre2==e.quality) && (t.filtre3=="" || t.filtre3==e.type) && (!t.filtre7 || (t.filtre7==e.isBroken || (t.filtre7!=e.isBroken && e.statut==3) || (t.filtre && Seed.queue_throne.itemId==e.id)))  && (t.filtre8=="" || t.filtre8==e.level)   )  {

       var ok=0;
       for (var u in e.effects) {
            if (t.filtre6==e.effects[u].id) {
                 ok=1;
            }
            if (t.filtre6=="0") {
             for (l=0;l<uW.cm.thronestats.effects[e.effects[u].id]["2"].length;l++){
	   	type = uW.cm.thronestats.effects[e.effects[u].id]["2"][l];
	   	if (type==t.filtre15) {
	   	 ok=1
	   	}
	     }
	    }

       }
       if ((t.filtre6=="0" || ok==1) && (t.filtre15=="0" || ok==1)) {
       var styleez="";
       var name="";

       if (e.isEquipped) {
        equip="equip";
        styleez="background-color:#DC9999";
        name=faction+"/"+ faction +"_"+e.type+"_"+equip+"_1.png";
        if (e.type=="trophy" || e.type=="candelabrum" || e.type=="hero")
         name=faction+"/"+ faction +"_"+e.type+"_"+equip+"_1_"+e.quality+".png";
       }else{
        equip="normal";
        name=faction+"/"+ faction +"_"+e.type+"_"+equip+"_1_"+e.quality+".png";
        }
       if (e.unique>0) {
		if (e.unique==30283) {
		 name="druid/druid_table_unique_"+equip+"_30283.png";
 	    } else if (e.unique==30230 || e.unique==30240|| e.unique==30250) {
 	      name="halloween/halloween_table_"+equip+"_1.png";
	    } else if (e.unique==30261){
			name="christmas/christmas_"+e.type+"_"+equip+"_1.png";
        } else {
		   name=faction + "/"+faction+"_"+e.type+"_unique_"+equip+"_"+e.unique+".png";
	    }
   	   }
       if (pastoucher.toString().indexOf(t.tableau[z])>-1 && equip=="normal")
          styleez="background-color:#99DC99";
       var styleauto=styleez;
       for (k in ThroneOptions.Items) {
	     if (ThroneOptions.Items[k]["id"] == e.id) { styleauto="background-color:#D9D988";break;}
       }
       m+="<tr><td style='"+styleauto +";width:35px'>"
       if (Seed.queue_throne) {
        if (Seed.queue_throne.itemId==e.id) {
           nbbroken++
           m+="<img title='"+ThroneItemName(e) +"' width=30 src="+gameurl+"img/throne/modal/sm_hammer.png onclick='BOactionPop("+e.id+");'>";
         } else {
         if (e.isBroken) {
            nbbroken++
	        m+="<img title='"+ThroneItemName(e) +"' width=30 src="+gameurl+"img/throne/modal/sm_fail_overlay.png onclick='BOactionPop("+e.id+");'>";
         } else {
          m+="<div title='"+ThroneItemName(e) +"' style='border:1px dotted black;background-repeat:no-repeat;width:30px;height:29px;background:url("+gameurl+"img/throne/icons/30/"+ name +")' onclick='BOactionPop("+e.id+");'>";
         }
        }
       } else {
         if (e.isBroken) {
	       m+="<img title='"+ThroneItemName(e) +"' width=30 src="+gameurl+"img/throne/modal/sm_fail_overlay.png>";
         } else {
           m+="<div title='"+ThroneItemName(e) +"' style='border:1px dotted black;background-repeat:no-repeat;width:30px;height:29px;background:url("+gameurl+"img/throne/icons/30/"+ name +")' onclick='BOactionPop("+e.id+");'>";
         }
       }
       p+=ThroneItemName(e) +" ";
        m+="</td><td colspan=4 style='"+styleez+";width:215x'>"+ ThroneItemName(e) +"<br>#"+itemNr+" / "+e.faction+" / "+e.type+"</td>";
        m+="<td style='"+styleez+";width:300px'>";
        for (var u in e.effects) {
           x++;
           L = e.effects[u];
           if ((e.quality >= x && !t.filtre4) || t.filtre4) {
           var coleur="";
           var stylee="";
           if (e.quality < x)
            stylee="text-decoration:line-through";
            for (var ww=0;ww<t.filtre5.length;ww++)
             if (t.filtre5[ww]==e.effects[u].id)
               stylee+=";color:#AA1111;font-weigth:bold";
 	   		 effect = uW.cm.thronestats.effects[L.id];
 	   		if (uW.cm.thronestats.tiers[L.id][L.tier])
             tier = uW.cm.thronestats.tiers[L.id][L.tier];
             else tier = uW.cm.thronestats.tiers[L.id][L.tier-1];
            var percent = + tier.base + (e.level * e.level + e.level) * + tier.growth * 0.5;
            percent = Math.round(percent*100)/100;
            typpee="";
            for (l=0;l<effect["2"].length;l++){
             typpee+=effect["2"][l];
            }
           m+="<span style='"+stylee+"' title='"+typpee+"'><font color="+coleur+">" + percent + "% " + effect[1] + "</font></span><bR>";
           p+="" + percent + "% " + effect[1] + " ";
         }
        }
        m+='</td>';
        if ((Options.TroneInverse && nbl<=lignauto) || (!Options.TroneInverse && nb<=lignauto)) {

        m+="<td style='"+styleez+";width:240px'><center>";

         if (Seed.queue_throne && Seed.queue_throne.itemId==e.id) {
	              var timeLeft = Seed.queue_throne.end - uW.unixtime();
	              if (timeLeft<0) timeLeft=0;
	 	      m+=lang.Trone.repairing+"<br>"+timestr(timeLeft)+'<br><a class="buttonv2 h30 blue" id="BOthronePanelBrokenInstantButton">'+uW.g_js_strings.throneRoom.button_speedUp+"</a>";
	}else{
	  if (e.isBroken) {
	    if (BOtimeLeft<0) {
	              m+="<a onclick='BORepair("+t.tableau[z]+")' class='buttonv2 h20 blue'>"+lang.Trone.repair+"</a>";
	    }

         } else {
         if (e.quality<5) {
           stoneenhance=uW.cm.thronestats["enhance"][e.quality+1].Stones;
           cityId='city'+Seed.cities[Options.salvageconfig.CityCity][0];
	   if (parseIntNan(stoneenhance)<parseIntNan(Seed.resources[cityId]['rec5'][0])) {
             m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",0)' class='buttonv2 h20 brown' title='Enhance - "+stoneenhance+" ether'>"+lang.Trone.enhance+"</a>";
             if (uW.ksoItems[20001].count > 0)
                  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20001)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20001.jpg'> "+lang.Trone.enhance+"</a>";

             if (uW.ksoItems[20002].count > 0)
                  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20002)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20002.jpg'> "+lang.Trone.enhance+"</a>";

   			 if (uW.ksoItems[20004].count > 0)
                  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20004)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20004.jpg'> "+lang.Trone.enhance+"</a>";

			if (e.quality==0 && uW.ksoItems[20007].count > 0) {
				  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20007)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20007.jpg'> "+lang.Trone.enhance+"</a>";
			}
			if (e.quality==1 && uW.ksoItems[20008].count > 0) {
				  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20008)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20008.jpg'> "+lang.Trone.enhance+"</a>";
			}
			if (e.quality==2 && uW.ksoItems[20009].count > 0) {
				  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",200098)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20009.jpg'> "+lang.Trone.enhance+"</a>";
			}
			if (e.quality==3 && uW.ksoItems[20010].count > 0) {
				  m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20010)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20010.jpg'> "+lang.Trone.enhance+"</a>";
			}
			if (e.quality==4 && uW.ksoItems[20011].count > 0) {
				m+="<a onclick='BOupgradeQualite("+t.tableau[z]+",20011)' class='buttonv2 h20 brown' title='Besoin de "+stoneenhance+" pierres ether'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20011.jpg'> "+lang.Trone.enhance+"</a>";
			}
           }
         }
         m+="<bR>";
         if (e.level<13) {
           stoneupgrade=uW.cm.thronestats["upgrade"][e.level+1].Stones;
           cityId='city'+Seed.cities[Options.salvageconfig.CityCity][0];
	   if (parseIntNan(stoneupgrade)<parseIntNan(Seed.resources[cityId]['rec5'][0])) {
            m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",0)' class='buttonv2 h20 brown' title='Upgrade - "+stoneupgrade+" ether'>"+lang.Trone.upgrade+"</a>";
            if (uW.ksoItems[20001].count > 0)
               m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20001)' class='buttonv2 h20 brown' title='"+stoneupgrade+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20001.jpg'> "+lang.Trone.upgrade+"</a>";

            if (uW.ksoItems[20002].count > 0)
               m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20002)' class='buttonv2 h20 brown' title='"+stoneupgrade+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20002.jpg'> "+lang.Trone.upgrade+"</a>";

            if (uW.ksoItems[20005].count > 0)
               m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20005)' class='buttonv2 h20 brown' title='"+stoneupgrade+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20005.jpg'> "+lang.Trone.upgrade+"</a>";

            if (uW.ksoItems[20006].count > 0)
               m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20006)' class='buttonv2 h20 brown' title='"+stoneupgrade+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20006.jpg'> "+lang.Trone.upgrade+"</a>";

 				if (uW.ksoItems[20012].count > 0 && e.level==2)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20012)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20012].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20012.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20013].count > 0 && e.level==4)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20013)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20013].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20013.jpg'> "+lang.Trone.upgrade+"</a>";

				if (uW.ksoItems[20014].count > 0 && e.level==6)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20014)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20014].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20014.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20015].count > 0 && e.level==8)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20015)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20015].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20015.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20016].count > 0 && e.level==9)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20016)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20016].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20016.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20017].count > 0 && e.level==10)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20017)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20017].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20017.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20018].count > 0 && e.level==11)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20018)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20018].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20018.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20019].count > 0)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20019)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20019].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20019.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20020].count > 0 && e.level==12)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20020)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20020].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20020.jpg'> "+lang.Trone.upgrade+"</a>";
				if (uW.ksoItems[20021].count > 0 && e.level==13)
                       m+="<a onclick='BOupgradeLevel("+t.tableau[z]+",20021)' class='buttonv2 h20 brown' title='"+uW.ksoItems[20021].name+"'><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20021.jpg'> "+lang.Trone.upgrade+"</a>";
           }
          }
          m+="<br><a onclick='BOsalvage("+t.tableau[z]+")' class='buttonv2 h20 red'>"+lang.Trone.salvage+"</a>";
		  m+="<br>";
		  var a=0;
		  for (k= 1; k <= Seed.throne.slotNum; k++) {
			var F=Seed.throne.slotEquip[k];
			if (F != null){
			 for (ll=0; ll < F.length; ll++){
			  if (F[ll]==t.tableau[z]) { // il existe dans un trone
			   a=1;
			   if (k==Seed.throne.activeSlot)
			    m+="<a onclick='BOUnequipItem("+t.tableau[z]+","+k+")' class='buttonv2 h20 blue'>"+lang.Trone.unequip+"</a>";
			   else
  				m+="<a onclick='BOUnequipItem("+t.tableau[z]+","+k+")' class='buttonv2 h20 blue'>"+lang.Trone.unequip.substring(0,1)+"-"+k+"</a>";
			 }
			 }
			}
		  }

		  for (k= 1; k <= Seed.throne.slotNum; k++) {
            if (k!=e.presetId) {

				if (a==1) {m+="<br>";a=2;}
				  if (k==Seed.throne.activeSlot)
		           m+="<a onclick='BOequipItem("+t.tableau[z]+","+k+")' class='buttonv2 h20 blue'>"+lang.Trone.equip+"</a>";
		          else
		            m+="<a onclick='BOequipItem("+t.tableau[z]+","+k+")' class='buttonv2 h20 blue'>"+lang.Trone.equip.substring(0,1)+"-"+k+"</a>";
		  }
	      }

         }
         }
        } else {
           m+="<td style="+styleez+"><center><i><b>"+lang.Trone.norow+"</b>";
        }
        m+='</td></tr>';
       }
      }

     }
     ById("BOTroneC").innerHTML=m;
     // Equipement
     var effft="",faction={0:'advisor',1:'banner',2:'chair',3:'table',4:'window',5:'trophy',6:'candelabrum',7:'hero'};
     var zz="<center><table width=100%><tr>";
     for (var fp in faction) {
      equip="normal";
      effft="";
      var k=Seed.throne.slotEquip[Seed.throne.activeSlot];
      for (var tt in k) {
      if (uW.kocThroneItems[k[tt]])
       if (uW.kocThroneItems[k[tt]].type==faction[fp]) {
        equip="equip";
        x=0;
        for (var u in uW.kocThroneItems[k[tt]].effects) {
          x++;
          if (uW.kocThroneItems[k[tt]].quality >= x) {
            var ww=uW.cm.thronestats.tiers[uW.kocThroneItems[k[tt]].effects[u].id][uW.kocThroneItems[k[tt]].effects[u].tier];
            var pourc = + ww.base + (uW.kocThroneItems[k[tt]].level * uW.kocThroneItems[k[tt]].level + uW.kocThroneItems[k[tt]].level) * + ww.growth * 0.5;
            pourc = Math.ceil(pourc);
            effft+= pourc + "% " + uW.cm.thronestats.effects[uW.kocThroneItems[k[tt]].effects[u].id][1]+ "&#013;";

            }
        }
       }
      }


      if (equip=="equip") {
         name=faction[fp] +"_"+equip+"_1.png";
          if (faction[fp]=="trophy" || faction[fp]=="candelabrum" || faction[fp]=="hero")
               name=faction[fp]+"_"+equip+"_1_1.png";
             }else{
              name=faction[fp] +"_"+equip+"_1_1.png";
        }

      zz+="<td><img title='"+effft+"' align=absmiddle width=30 src="+gameurl+"img/throne/icons/30/briton/briton_"+name+"><td>"+faction[fp]+"</td>";
     }
     zz+="</tr></table>";
     ById("BOTroneE").innerHTML=zz;
     ById("BONbArticle").innerHTML= nb + " "+lang.Trone.nbart+" "+ nbbroken +" "+lang.Trone.nbart1;
     if (ById("BOthronePanelBrokenInstantButton"))
      ById("BOthronePanelBrokenInstantButton").addEventListener("click", function() {
		 var Z=uW.kocThroneItems[Seed.queue_throne.itemId];
		 uW.modal_speedup("throne", Z.id, undefined, Z.name)
		 }, false);
     clearTimeout(t.citystattimer);
     t.citystat();
  },
  citystattimer:null,
  citystat:function() {
   var t = myBO.Trone;
   var zz="<TABLE class=ptTabLined cellspacing=0 style='margin-bottom:1px;'><tr>";
   var zx="";
   clearTimeout(t.citystattimer);

   for(var i=0; i<Cities.numCities; i++) {
      var cityID = 'city'+ Cities.cities[i].id;
            zz += "<TD width=81 align=center><B>"+ Cities.cities[i].name.substring(0,10) +'</b></td>';
            zx += "<TD width=81 align=center><B>"+ addCommas(parseIntNan(Seed.resources[cityID]['rec5'][0])) + "</b></td>";
      }


   zz+="<td align=center><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20001.jpg'></td>\
   <td align=center><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20002.jpg'></td>\
   <td align=center><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20004.jpg'></td>\
   <td align=center><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20005.jpg'></td>\
   <td align=center><img align=absmiddle width=13 src='"+gameurl+"img/items/70/20006.jpg'></td></tr><tr>"+zx+"<td align=center>"+uW.ksoItems[20001].count+"</tD><td align=center>"+uW.ksoItems[20002].count+"</tD><td align=center>"+uW.ksoItems[20004].count+"</tD><td align=center>"+uW.ksoItems[20005].count+"</tD><td align=center>"+uW.ksoItems[20006].count+"</tD>";
   zz+="</table>";

   ById("BOTroneAether").innerHTML=zz;
   t.citystattimer=setTimeout(t.citystat,5000);

  },
  filtreaction: function() {
    var t = myBO.Trone;
    t.filtre15 = ById('BOFiltre15ST').value;
    t.filtre = ById('BOFiltreST').value;
    t.filtre2 = ById('BOFiltre2ST').value;
    t.filtre3 = ById('BOFiltre3ST').value;
    t.filtre4 = ById('BOFiltre4ST').checked;
    t.filtre5 = [];
    for (i=0; i<ById('BOlisteeffets').options.length; i++) {
      if (ById('BOlisteeffets').options[i].selected ) {
         t.filtre5.push(ById('BOlisteeffets').options[i].value);
      }
    }
    t.filtre6 = ById('BOFiltre5ST').value;
    t.filtre9 = ById('BOFiltre9ST').value;
    t.filtre7 = ById('BOFiltre7ST').checked;
    t.filtre8 = ById('BOFiltre8ST').value;
    Options.EffetRouge = t.filtre5;
    Options.AllEffet = t.filtre4;
    saveOptions ();
    t.show();
  },
  upgradeQualite:function(id,objet) {
    var t = myBO.Trone;
    var currentcityid = Seed.cities[Options.salvageconfig.CityCity][0];
    var params = uW.Object.clone(uW.g_ajaxparams);
       params.action="upgradeQuality";
       params.ctrl="throneRoom\\ThroneRoomServiceAjax";
       params.throneRoomItemId=id;
       params.buffItemId=objet;
       params.payment="aetherstone";
       params.cityId=currentcityid;
       uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
        onSuccess:function(transport) {
         var m = eval("(" + transport.responseText + ")");
         if (m.ok === true){
          Seed.resources["city" + currentcityid].rec5[0] = Seed.resources["city" + currentcityid].rec5[0] - m.aetherstones;
          if (objet>0) {
           uW.ksoItems[objet].subtract();
          }
          var s = uW.kocThroneItems[id];
          if (m.success) {
           s.quality = m.item.quality;s.level = m.item.level;s.name = s.createName();
          } else {
           s.quality = m.item.quality;s.level = m.item.level;s.name = s.createName();
           if (m.break) {
            s.brokenType = "quality";
            s.isBroken = true;
            s.name = s.createName();
           }
          }
          uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
          t.show();

         }
        }
   });

  },
  upgradeLevel:function(id,objet) {
    var t = myBO.Trone;
        var currentcityid = Seed.cities[Options.salvageconfig.CityCity][0];
	if (objet==200013 || objet==20014 || objet==20015) {
		var a = confirm("Use " + uW.ksoItems[20014].name + " ?");
		if (!a) return false;
    }
        var params = uW.Object.clone(uW.g_ajaxparams);
           params.action="upgradeLevel";
           params.ctrl="throneRoom\\ThroneRoomServiceAjax";
           params.throneRoomItemId=id;
           params.buffItemId=objet;
           params.payment="aetherstone";
           params.cityId=currentcityid;
           uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
            onSuccess:function(transport) {
             var m = eval("(" + transport.responseText + ")");
             if (m.ok === true){
              Seed.resources["city" + currentcityid].rec5[0] = Seed.resources["city" + currentcityid].rec5[0] - m.aetherstones;
              if (objet>0) {
	                 uW.ksoItems[objet].subtract();
          }
                        var s = uW.kocThroneItems[id];
	                if (m.success) {
	                 s.quality = m.item.quality;s.level = m.item.level;s.name = s.createName();
	                } else {
	                 s.quality = m.item.quality;s.level = m.item.level;s.name = s.createName();
	                 if (m.break) {
	                  s.brokenType = "level";
	                  s.isBroken = true;
	                  s.name = s.createName();
	                 }
	                }
	                uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
          		t.show();
             }
            }
   });

  },
  Repair:function(id) {
   var t = myBO.Trone;
   var params = uW.Object.clone(uW.g_ajaxparams);
   params.action="timeRepair";
   params.ctrl="throneRoom\\ThroneRoomServiceAjax";
   params.throneRoomItemId=id;
   uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
    onSuccess:function(transport) {
     var m = eval("(" + transport.responseText + ")");
     if (m.ok === true){
      Seed.queue_throne.start = uW.unixtime();
      Seed.queue_throne.end = m.eta;
      Seed.queue_throne.itemId = id;
      uW.kocThroneItems[id].isBroken = false;
      uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
      t.show();
     }
    }
   });

  },
  checkType:function (E,num){
	  var D=E.type,B=num,F=Seed.throne.slotEquip[B],C=[],z;
	  var G=0;
	  var A={};
	   if (F != null)
	   {
         for (ll=0; ll < F.length; ll++)
         {
		  z=uW.kocThroneItems[F[ll]];
		  if(z.type===D){

			  A.item1=E;
			  A.item2=z;
			  A.idx=ll;
			  break;
		  }
		 }
		}
	  return A;
  },
  equipItem: function(id,num) {
   var t = myBO.Trone;
   if (!num)
    num=Seed.throne.activeSlot;
    var params = uW.Object.clone(uW.g_ajaxparams);
   params.action="equipItem";
   params.ctrl="throneRoom\\ThroneRoomServiceAjax";
   params.itemId=id;
   params.presetId=num;
   uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
    onSuccess:function(transport) {
     var m = eval("(" + transport.responseText + ")");
     if (m.ok === true){

	  var G=t.checkType(uW.kocThroneItems[id],num);
	  if($.isEmptyObject(G)) {
		   H=Seed.throne.slotEquip[num];
		   uW.kocThroneItems[id].presetId = num;
		   H.push(id);
		   Seed.throne.slotEquip[num]=H;
  	  }else{
		H=Seed.throne.slotEquip[num];
	  	G.item2.isEquipped=false;
	  	G.item2.presetId=0;
	  	Seed.throne.slotEquip[num]=H.splice(G.idx,1);
	  	uW.kocThroneItems[id].presetId=num;
	  	H.push(G.item1.id);
	  	Seed.throne.slotEquip[num]=H;
 	  }
 	  if (num==Seed.throne.activeSlot) {
	  	 	  uW.cm.ThroneView.clickItemEquip(uW.kocThroneItems[id]);

  	  }
  	  if (ById("ShowTrPresets")) setTimeout(Dashboard.ShowTrPresets,1000);
      t.show();
     }
    }
   });
  },
  UnequipItem: function(id,num) {
     var t = myBO.Trone;
     if (!num)
    num=Seed.throne.activeSlot;
      var params = uW.Object.clone(uW.g_ajaxparams);
     params.action="unequipItem";
     params.ctrl="throneRoom\\ThroneRoomServiceAjax";
     params.itemId=id;
     params.presetId=num;
     uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
      onSuccess:function(transport) {
       var m = eval("(" + transport.responseText + ")");
       if (m.ok === true){
		 if (num==Seed.throne.activeSlot) {
			 uW.kocThroneItems[id].presetId = 0;
 			 uW.cm.ThroneView.clickItemUnequip(uW.kocThroneItems[id]);
	  	     t.show();
	    	 return false;
  		 }
		 var G=t.checkType(uW.kocThroneItems[id],num);
	     if($.isEmptyObject(G)) {
			uW.kocThroneItems[id].presetId = 0;
 		 }else {
				H=Seed.throne.slotEquip[num];
	  			G.item2.presetId=0;
	  			Seed.throne.slotEquip[num]=H.splice(G.idx,1);
		 }
		if (ById("ShowTrPresets")) setTimeout(Dashboard.ShowTrPresets,1000);
        t.show();
       }
      }
     });
  },
  salvage: function(id) {
   var t = myBO.Trone;

   if (uW.kocThroneItems[id].level>0) {
    var a=confirm("Etes-vous sur ?");
    if (!a) return;
   }

    var params = uW.Object.clone(uW.g_ajaxparams);
   params.action="salvage";
   params.ctrl="throneRoom\\ThroneRoomServiceAjax";
   params.itemId=id;
   params.cityId=Seed.cities[Options.salvageconfig.CityCity][0];
   uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
    onSuccess:function(transport) {
     var m = eval("(" + transport.responseText + ")");
     if (m.ok){

      uW.kocThroneItems[id].salvage();
      setTimeout(t.show,250);
     }else{

     }
    }
   });
  }
}
myBO.Test = {
  tabOrder: 25,
  tabDisabled : false,
  tabLabel : 'Test',
  myDiv : null,
  cont : null,
  init : function (){
    this.myDiv = document.createElement('div');
    return this.myDiv;
  },

  hide : function (){
    var t = myBO.Test;
  },
  getContent : function (){
      return myBO.Test.myDiv;
  },
  show : function (){
     var t = myBO.Test;
     t.cont = this.myDiv;
     var citySelect = '   <SELECT id=fakeCity>';
     	    for (var c=0; c<Cities.numCities; c++) {
     		 	 aCity = Cities.cities[c].name + ' ('+Cities.cities[c].x + ','+ Cities.cities[c].y+')';
     	         citySelect += '<option value=\''+c+'\' '+ (Options.alertConfig.hq==Cities.cities[c].id?'SELECTED ':'') +'>'+aCity+'</option>';
     	    }
  citySelect += '</select>';
  if (TESTBAO==-1) return false;
  var m = '<DIV class=boStat><b>'+lang.fake.title+'</b></div><TABLE><TR><TD align=right>'+uW.g_js_strings.commonstr.scouting+'</td><TD><INPUT type=checkbox id=fakeIsScout></td><TD align=right>'+uW.g_js_strings.commonstr.wilderness+'</td><TD><INPUT type=checkbox id=fakeIsWild></td></tr>\
        <TR><TD colspan=2 align=right>'+lang.fake.duration+' ('+lang.General.secs+') : </td><TD><INPUT type=text size=4 value=300 id=fakeSeconds></td></tr>\
        <TR><TD align=right><img height=18 title="'+uW.unitcost['unt1'][0]+'" src='+gameurl+'img/units/unit_1_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop0></td><TD align=right><img height=18 title="'+uW.unitcost['unt2'][0]+'" src='+gameurl+'img/units/unit_2_30.jpg></td><TD><INPUT type=text size=6 value=1 id=faketroop1></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt3'][0]+'" src='+gameurl+'img/units/unit_3_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop2></td><TD align=right><img height=18 title="'+uW.unitcost['unt4'][0]+'" src='+gameurl+'img/units/unit_4_30.jpg></td><TD><INPUT type=text size=6 value=0 id=faketroop3></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt5'][0]+'" src='+gameurl+'img/units/unit_5_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop4></td><TD align=right><img height=18 title="'+uW.unitcost['unt6'][0]+'" src='+gameurl+'img/units/unit_6_30.jpg></td><TD><INPUT type=text size=6 value=0 id=faketroop5></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt7'][0]+'" src='+gameurl+'img/units/unit_7_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop6></td><TD align=right><img height=18 title="'+uW.unitcost['unt8'][0]+'" src='+gameurl+'img/units/unit_8_30.jpg></td><TD><INPUT type=text size=6 value=0 id=faketroop7></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt9'][0]+'" src='+gameurl+'img/units/unit_9_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop8></td><TD align=right><img height=18 title="'+uW.unitcost['unt10'][0]+'" src='+gameurl+'img/units/unit_10_30.jpg></td><TD><INPUT type=text size=6 value=0 id=faketroop9></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt11'][0]+'" src='+gameurl+'img/units/unit_11_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop10></td><TD align=right><img height=18 title="'+uW.unitcost['unt12'][0]+'" src='+gameurl+'img/units/unit_12_30.jpg></td><TD><INPUT type=text size=6 value=0 id=faketroop11></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt13'][0]+'" src='+gameurl+'img/units/unit_13_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop12></td><TD align=right><img height=18 title="'+uW.unitcost['unt14'][0]+'" src='+gameurl+'img/units/unit_14_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop13></td></tr>\
	<TR><TD align=right><img height=18 title="'+uW.unitcost['unt15'][0]+'" src='+gameurl+'img/units/unit_15_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop14></td><TD align=right><img height=18 title="'+uW.unitcost['unt16'][0]+'" src='+gameurl+'img/units/unit_16_30.jpg?6545></td><TD><INPUT type=text size=6 value=0 id=faketroop15></td></tr>\
	<TR><TD align=right>'+uW.g_js_strings.commonstr.attacker+'</td><TD><INPUT type=text size=13 value="Kabam!" id=fakeName></td><td align=right>'+uW.g_js_strings.commonstr.might+'</td><td><INPUT type=text size=13 value="5441192" id=fakeMight></td></tr>\
	<TR><TD align=right>'+uW.g_js_strings.commonstr.target+'</td><TD>'+citySelect+'</td><td><INPUT id=testSendMarch type=button class=pbButton value="'+lang.fake.fakeatk+'" \></td></tr>';
   m+='</td></tr></table><br><hr>Autres Options :<br><INPUT id=ptReloadKOC type=submit value="'+lang.fake.reloadkoc+'" \><hr></span><BR><DIV id=testDiv style="background-color:#fffff0; maxwidth:675; max-height:30px; height:0px; overflow-y:auto;"></div>';
    t.cont.innerHTML = m;

    ById('testSendMarch').addEventListener ('click', t.clickFakeAttack, false);
    ById('ptReloadKOC').addEventListener ('click', t.reloadKOC, false);

    function xyNotify(city, x, y){
      var m = '[ Notified: '+ (city?city.name:'null') +', x='+ x +', y='+ y +' ]';
      ById('testNotify').innerHTML = m;
    }

  },
  writeDiv : function (msg){
    var t = myBO.Test;
    if (t.state != null)
    ById('testDiv').innerHTML = msg;
  },

  addDiv : function (msg){
    var t = myBO.Test;
    if (t.state != null)
    ById('testDiv').innerHTML += msg;
  },

  reloadKOC : function (){

      reloadKOC();
  },

  createFakeAttack : function (cityNum, isScout, isWild, isFalse, secs, troops, name, might){
     var marchId = 'm'+ (88888 + Math.floor(Math.random()*11111));
     var march = {};
     if (matTypeof(Seed.queue_atkinc)=='array')
       Seed.queue_atkinc = {};
     if (isFalse)
       march.marchType = 0;
     else if (isScout)
       march.marchType = 3;
     else
       march.marchType = 4;

     march.toCityId = Cities.cities[cityNum].id;
     march.fromXCoord = 350;
     march.fromYCoord = 350;
     if (isWild) {
       keys = uW.Object.keys(Seed.wilderness['city'+Cities.cities[cityNum].id]);
       march.toTileId = Seed.wilderness['city'+Cities.cities[cityNum].id][keys[0]].tileId;
     } else {
       march.toTileId = Cities.cities[cityNum].tileId;
     }
     secs = parseInt(secs);
     march.arrivalTime = unixTime() + secs;
     march.departureTime = unixTime() - 10;
     march.knt=[];
     march.knt['cbt'] = 255;
     march.knightCombat =255;
     march.unts = {}
 	for(i=0; i<16; i++){
 	  if(troops[i] > 0)
 		march.unts["u"+(i+1)] = troops[i];
 	}
     march.pid = 1234567;
     march.score = 9;
     march.mid = marchId.substr(1);
     march.players = {}
     march.players.u1234567 = {}
     march.players.u1234567.n = name;
     march.players.u1234567.t = 60;
     march.players.u1234567.m = might;
     march.players.u1234567.s = 'M';
     march.players.u1234567.w = 1;
     march.players.u1234567.a = 1;
     march.players.u1234567.i = 5;
     Seed.queue_atkinc[marchId] = march;
     Seed.players.u1234567 = march.players.u1234567;
   },

   clickFakeAttack : function (){
     var t = myBO.Test;
     var isScout = ById('fakeIsScout').checked;
     var isWild = ById('fakeIsWild').checked;
     var isFalse = false;
 	var troops = [];
 	for(i=0; i<16; i++)
 		troops[i] = parseIntNan(ById('faketroop'+i).value);
     var secs = parseInt(ById('fakeSeconds').value);
 	var name = ById('fakeName').value;
 	var city = ById('fakeCity').value;
 	var might = ById('fakeMight').value;
     t.createFakeAttack (city, isScout, isWild, isFalse, secs, troops ,name,might);
   },
}
Tabs.Overview = {
  tabOrder: 1,
  tabLabel: lang.BoiteLabelResume,
  myDiv: null,
  displayTimer : null,
  checkBox:null,
  defMode : {},
  checkBox1:null,
  Overview : function (){
  },
  init : function (div){
    var t = Tabs.Overview;
    uW.BOCrafting = t.Crafting;
    uW.BOCraftingItem = t.CraftingItem;
    t.myDiv = div;
    var str= '<div id="BOResumeDIV" style="height:' + (Options.HauteurBoite-30) +'px;max-height:' + (Options.HauteurBoite-30) +'px;overflow-y:auto"></div>';
    t.myDiv.innerHTML = str;
    t.BOResumeDIV = ById("BOResumeDIV");

  },

  getContent : function (){

  },

  hide : function (){
   var t = Tabs.Overview;
    clearTimeout (t.displayTimer);
  },
 show : function (){
   var t = Tabs.Overview;
   clearTimeout (t.displayTimer);if (TESTBAO==-1) return false;
   t.setContent();
 },
 CraftingItem: function (obj, currentcity, itemId, recipeId, categoryId) {
  var t = Tabs.Overview;
  if (obj) obj.value="Crafting...";
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.action="craft";
        params.ctrl="Crafting";
        params.cityId=currentcity;
        params.insurance=false;
 	params.itemId=itemId;
 	params.recipeId=recipeId;
 	params.categoryId=categoryId;

        new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
                      method: "post",
       		    parameters: params,
      	onSuccess: function (transport) {
          var o=eval("("+transport.responseText+")");
          if(o.ok===true){
           if (o.status=="error") {
            //alert("Erreur crafting : " + o.errorMessage);
            if (obj) obj.value="Craft";
           } else if(o.status=="failure"){
	     //alert("Echec crafting !");
	     if (obj) obj.value="Craft - try again";
	   } else if (o.status=="success"){
	     if (obj) obj.value="Craft OK";
		//if(!Seed.queue_craft["city"+currentcity]) {
		 Seed.queue_craft["city"+currentcity]=[];
		//}
     		var n={};

     		n.recipeId=recipeId;
     		n.craftingUnixTime=o.time.startTime;
     		n.craftingEtaUnixTime=o.time.endTime;
     		n.craftingId=o.craftingId;
     		n.categoryId=null;
     		n.recipeIndex=null;
     		Seed.queue_craft["city"+currentcity].push(n);
     		setTimeout(function() { t.Crafting(currentcity); },1000);
     	  }
        }

        },
         onFailure: function () {          t.Crafting(currentcity);         }
        });
 },
 Crafting: function(currentcity) {
  var t = Tabs.Overview;
   var messagebody ="", ReciId=0, catId=0;
   var ret=getCityBuilding(currentcity,20).count;
   if (ret>0) {
     var texte="";
     var i=Seed.queue_craft["city"+currentcity];
     if(i.length>0) {
      var q=i[0];
      var totTime = 0;
      var now = unixTime();
      totTime = q.craftingEtaUnixTime - now;
      if (totTime > 0) {
         texte= "Reste " + timestr(totTime);
         ReciId=q.recipeId;
         catId=q.categoryId;
      }
     }
     messagebody += "<TABLE width=95% border=0 align=center class=ptTab>";
     messagebody += "<tr style='background-Color:#AAA;'><td colspan=2><b>"+uW.g_js_strings.commonstr.items+"</td><td><b>"+lang.Overview.col1+"</td><td><b>"+lang.Overview.col2+"</td><td><b>"+uW.g_js_strings.commonstr.requirements+"</td></tr>";

     for (ZZ in uW.recipelist) {
     for(var i=0; i < uW.recipelist[ZZ].length; i++){
       var h = parseInt(uW.recipelist[ZZ][i].output_item_id);
       var recipe_id = uW.recipelist[ZZ][i].recipe_id;
       var category = uW.recipelist[ZZ][i].category;
       var qte=0;
       if (parseInt(Seed.items["i"+h])>0) qte=parseIntNan(Seed.items["i"+h]);
            messagebody += "<tr><td colspan=2><img src='"+gameurl+"img/items/70/"+ h + ".jpg' width=25>&nbsp;"+uW.itemlist["i"+h].name+"</td><td><center><b>"+qte+"</td>";
 	if (texte!="") {
 	   if (ReciId==recipe_id && catId==category) {
 	     messagebody += "<td><b><i>"+texte+"</td>";
 	   }else {
	           messagebody += "<td>&nbsp;</td>";
	           }
	 }     else
         messagebody += "<td><input type=button class=pbButton  value='Craft' onclick='BOCraftingItem(this,"+currentcity+","+h+","+recipe_id+","+category+")'></td>";
         messagebody += "<td>"+ uW.recipelist[ZZ][i].input.resources[1] + " Ether<bR>";
        for (k in uW.recipelist[ZZ][i].input.items) {
         if (uW.itemlist["i"+k])
          messagebody += uW.recipelist[ZZ][i].input.items[k] + "/"+parseIntNan(Seed.items["i"+k])+" " + uW.itemlist["i"+k].name+"<br>";
       }


        messagebody += "</td></tr>"
      }

     }

       messagebody+="</table>";

  } else {
   messagebody += "<center>"+lang.Overview.nofey+"</center>";
  }
  if (t.BOPopCrafting == null) {
     	t.BOPopCrafting = new CPopup('BOPopCrafting', 0, 0, 560, 700, true, function() {clearTimeout (1000);});
     	t.BOPopCrafting.centerMe (mainPop.getMainDiv());
     	}
     	var m = '<DIV style="max-height:665px; height:665px; overflow-y:scroll">';
     	m+= messagebody + '</div>';
     	t.BOPopCrafting.getMainDiv().innerHTML = m;
     	t.BOPopCrafting.getTopDiv().innerHTML = '<DIV align=center><B>'+lang.Overview.titlefey+'</B></DIV>';
	t.BOPopCrafting.show(true);

 },

 setContent : function (){

    var t = Tabs.Overview;
    var rownum = 0;
    var totalentre = 0;
    function UniteFormation(id) {
     var nbunit=0; //
     for(i=0; i<Cities.numCities; i++) {
      var cityIdd = Cities.cities[i].id;
      var q = Seed.queue_unt['city'+cityIdd];
      var qs = q.toString();
       if (q!=null && q.length>0 ){
        for (var ii=0; ii<q.length; ii++){
         if (q[ii][0]==id) nbunit+=parseIntNan(q[ii][1]);

        }
      }
      }
      totalentre += parseIntNan(nbunit*UniteCout(id));
      return nbunit;
    }
    function UniteCout(id) {
      var Unitcout=parseIntNan(uW.unitupkeeps[id]);
      return Unitcout;
    }

    function _row (name, row, noTotal, typee){
      if (rownum++ % 2)
        style = '';
      else
        style = ' style = "background: #e8e8e8"';
      var tot = 0;
      var m = [];
      m.push ('<TR style="background: #fff" align=right');
      m.push (style);
      m.push ('><TD');
      m.push (style);
      m.push ('><B>');
      m.push (name);
      m.push ('</td>');
      if (noTotal){
        m.push ('<TD');
        m.push (style);
        m.push ('>&nbsp;</td>');
      } else {
        for (i=0; i<row.length; i++)
          tot += row[i];
        m.push ('<TD style="background: #ffc">');
         if (tot<0) {
              m.push ("<SPAN class=boldRed>"+UniteKMG(tot)+"</span>");
         } else {
	   if (typee>0 || !Options.EnableReduireUnit)
	    m.push (addCommas(tot));
           else
            m.push (UniteKMG(tot));
         }
        m.push ('</td>');
      }
      for (i=0; i<row.length; i++){
        m.push ('<TD');
        m.push (style);
        m.push ('>');
        if (typee>0 || !Options.EnableReduireUnit)
         m.push (addCommas(row[i]));
        else
         m.push (UniteKMG(row[i]));
        m.push ('</td>');
      }
      if (Options.EnableFormation && typee>0) {
       m.push ('<td>'+addCommas(UniteFormation(typee))+'</td>');
      }
      if (Options.EnableFormation && name=='Form') {
         if (!Options.EnableReduireUnit)
          m.push("<td>&nbsp;</td><td>" + addCommas(totalentre) + "</td>");
         else
          m.push("<td>&nbsp;</td><td>" + UniteKMG(totalentre) + "</td>");
      }
      m.push ('</tr>');
      return m.join('');
    }


    try {
      if (Options.includeMarching)
        march = getMarchInfo();

      dt = new Date ();
      dt.setTime (Seed.player.datejoinUnixTime * 1000);

      str = '<DIV class=boStat style="margin-top:4px; margin-bottom:5px; "><TABLE cellspacing=0 class=ptTab cellpadding=0 width=98% align=center>\
        <TR align=left><TD align=center class=boStat2>' + uW.domainName +'</td><TD align=center><SPAN class=boStatLight>'+lang.Overview.opendate+'</span><br>'+ dt.toLocaleDateString() +'</td>\
        <TD align=center><SPAN class=boStatLight>Alliance</span><br>' + getMyAlliance()[1] +'</td>\
        <TD align=center><SPAN class=boStatLight>'+uW.g_js_strings.commonstr.might+'</span><br>' + addCommas(Seed.player.might) +'</td>\
        <TD align=center><SPAN class=boStatLight>'+uW.g_js_strings.commonstr.glory+'</span><br><span title="Max : ' + addCommas(Seed.player.maxGlory) +'">' + addCommas(Seed.player.glory) +'</span></td>\
        <TD align=center><SPAN class=boStatLight>'+uW.g_js_strings.commonstr.throneroom+'<br>'+addCommas(uW.cm.ThroneController.calcMight())+'</span></td>\
        </tr></table></div>';

      str += "<DIV id=overMainDiv style='font-size:10px;padding:5px'><TABLE class=ptTabOverview cellpadding=0 cellspacing=0><TR  align=center><TD width=45 align=center>";
      str +="<img src='data:image/png;base64,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%3D' id=BOAutel>";
      str += "</td><TD width=88 style='background: #ffc; font-size:150%' align=center><SPAN class=oohfancy>"+lang.Overview.sum+"</SPAN></td>";
      for(i=0; i<Cities.numCities; i++) {
         cityID = 'city'+ Cities.cities[i].id;
         Gate = parseInt(Seed.citystats[cityID].gate);
	 if(Gate == 0) var couleurr="#77EE77";
         if(Gate != 0) var couleurr="#EE7777";

         str += "<TD width=80 style='background-color:"+couleurr+"'><SPAN class=oohfancy>"+ Cities.cities[i].name.substring(0,10) +"</SPAN><BR><a href='javascript:void(0)' onclick='cm.utils.CoordinateLinkController.onClick(event)' class='coordinateLink'>("+Cities.cities[i].x +","+ Cities.cities[i].y+")</a><BR>"+ uW.provincenames['p'+ Cities.cities[i].provId] +"</td>";

      }

      if (Options.includeMarching)
        str += '<TD width=81><B>'+lang.Overview.includeMarching+'</b></td>';
      if (Options.EnableFormation)
       str += '<TD width=81><B>'+lang.Overview.EnableFormation+'</b></td>';

      str += "<td></td></tr>";
      str += "<tr><td>&nbsp;</td><td></td>";

      for (var cityId in Cities.byID)
      		str += '<TD align=center><INPUT type=submit id=BOtabut_'+ cityId +' value=""></td>';
      str += '</tr>';
      if (Options.includeAscension) {
      	row = [];
	  	var adata = uW.cm.WorldSettings.getSettingAsObject("ASCENSION_REQS_DRUID");
	  	for(i=0; i<Cities.numCities; i++) {
	  				var cityId = Cities.cities[i].id;
	  				if (Seed.cityData.city[cityId].isPrestigeCity) {
	  					var atype = Seed.cityData.city[cityId].prestigeInfo.prestigeType;
	  					var alevel = Seed.cityData.city[cityId].prestigeInfo.prestigeLevel;
	  					var avalue = Seed.cityData.city[cityId].cityValue;
	  					if (adata[parseInt(alevel)+1] != null) {
	  						var amin = adata[parseInt(alevel)+1].min;
	  						var amax = adata[parseInt(alevel)+1].max;
	  						if (avalue == 0) {
								var aproz = '';
							} else if (avalue < amin) {
	  							var aproz = ' (0%)';
	  						} else if (avalue >= amax) {
	  							var aproz = ' (<b style="color:green;">100%</b>)';
	  						} else {
	  							var aproz = ' (' + Math.round(1000*(avalue - amin)/(amax - amin))/10 + '%)';
	  						}
	  					} else
	  						var aproz = '';
	  					if (atype == 1) {
	  						row[i] = '<p style="text-align: center; margin:0;"><B>Druid<br>'+lang.marchs.level+' '+alevel+'</b>'+aproz+'</p>';
	  					} else if (atype == 2) {
	  						row[i] = '<p style="text-align: center; margin:0;"><B>Fey<br>'+lang.marchs.level+' '+alevel+'</b>'+aproz+'</p>';
	  					} else {
	  						row[i] = '<p style="text-align: center; margin:0;"><B>Briton<br>'+lang.marchs.level+' '+alevel+'</b>'+aproz+'</p>';
	  					}
	  				} else {
	  					var avalue = Seed.cityData.city[cityId].cityValue;
	  					var amin = adata[1].min;
	  					var amax = adata[1].max;
	  					if (avalue < amin) {
	  						var aproz = '0%';
	  					} else if (avalue >= amax) {
	  						var aproz = '<b style="color:green;">100%</b>';
	  					} else {
	  						var aproz = Math.round(1000*(avalue - amin)/(amax - amin))/10 + '%';
	  					}
	  					row[i] = '<p style="text-align: center; margin:0;">'+aproz+'</p>';
	  				}
	  }
      str += _row ('Asc.', row, true, 0);
  }
      if (Options.enableGuardians) {
      str += "<tr><td>&nbsp;</td><td></td>";
      for (var cityId in Cities.byID) {
       var typeg="No";
       var mm=Seed.guardian;
       for (var ii in mm) {
        var ww = mm[ii];
        if (ww.cityId==cityId) {
            typeg = ww.type;
            selectg="";
            for (var z in ww.cityGuardianLevels) {
             if (ww.cityGuardianLevels[z]>0) {
             if (typeg==z)
              selectg+="<div title='"+z+" "+lang.marchs.level+" "+ww.cityGuardianLevels[z]+"' style='border:1px solid RED;background-image:url("+gameurl+"img/chrome_icon_"+z+".png);background-repeat:no-repeat;width:17px;height:24px;font-size:11px;font-family:Georgia;color:#236454;font-weight:bold;padding:1px;position:relative;text-decoration:none;float:left'><span style='top:11px;position:relative'>"+ww.cityGuardianLevels[z]+"</span></div>";
             else
              selectg+="<div id='BoG_"+cityId+"_"+z+"' title='"+z+" "+lang.marchs.level+" "+ww.cityGuardianLevels[z]+"' style='background-image:url("+gameurl+"img/chrome_icon_"+z+".png);background-repeat:no-repeat;width:17px;height:24px;font-size:11px;font-family:Georgia;color:#236454;font-weight:bold;padding:1px;position:relative;text-decoration:none;float:left'><span style='top:11px;position:relative'>"+ww.cityGuardianLevels[z]+"</span></div>";
             }
            }
        }
       }
       str += '<TD align=center><div style="float:left;">'+selectg+'</div></td>';
      }
      str += '</tr>';
      }
     str += '<TR><TD style="font-size:6px"><BR></td></tr>';
     row = [];
     for(i=0; i<Cities.numCities; i++) {
        var niveauPointRall=March.RallyPoint(Cities.cities[i].id).maxSlots;
        var slots=March.RallyPoint(Cities.cities[i].id).marching;
         row[i] = '<SPAN><B>'+ slots +'/'+ niveauPointRall +'</b></span>';
     }
     str += _row (lang.Overview.march, row, true, 0);
     str += '<TR><TD style="font-size:6px"><BR></td></tr>';
     rows = [];
     rowsnm = [];
     rows[0] = [];
     if (Options.showRes) {
      for(i=0; i<Cities.numCities; i++) {
        cityID = 'city'+ Cities.cities[i].id;
        rows[0][i] = parseIntNan(Seed.citystats[cityID].gold[0]);
      }
      for (r=1; r<6; r++){
        rows[r] = [];
        for(i=0; i<Cities.numCities; i++) {
          cityID = 'city'+ Cities.cities[i].id;
          if (r==5)
           rows[r][i] = parseIntNan(Seed.resources[cityID]['rec'+r][0]);
          else
           rows[r][i] = parseIntNan(Seed.resources[cityID]['rec'+r][0] / 3600);

        }

      }

      if (Options.includeMarching){
        for (var i=0; i<6; i++)
          rows[i][Cities.numCities] = parseIntNan(march.resources[i]);
      }
      str += _row ('<img height=18 src='+gameurl+'img/gold_30.png>', rows[0], false, 0);
      str += _row ('<img height=18 src='+gameurl+'img/food_30.png>', rows[1], false, 0);
      str += _row ('<img height=18 src='+gameurl+'img/wood_30.png>', rows[2], false, 0);
      str += _row ('<img height=18 src='+gameurl+'img/stone_30.png>', rows[3], false, 0);
      str += _row ('<img height=18 src='+gameurl+'img/iron_30.png>', rows[4], false, 0);
      str += _row ('<img height=18 src='+gameurl+'img/aetherstone_30.png>', rows[5], false, 0);
    }
      if (Options.showEntrepot) {
				str += '<TR><TD><BR></td></tr>';
				rows = [];
				var STOREHOUSE = [0,100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,5000000,50000000];
				for(i=0; i<Cities.numCities; i++) {
					var cityID = 'city'+ Cities.cities[i].id;
					var sh = getCityBuilding(Cities.cities[i].id,9);
					if (sh.count == 0) {
						rows[i] = '0';
					} else {
						rows[i] = parseInt((STOREHOUSE[sh.maxLevel]*(1+ Seed.tech.tch14/10) * (1+unsafeWindow.cm.ThroneController.effectBonus(89)/100)));
					}
				}
				str += _row ('<img title="'+uW.buildingcost.bdg9[0]+'" height=18 src="'+gameurl+'img/buildings/storehouse_lvl10_26.png">', rows, true, 0);
	}
      if (Options.showProduction) {

          str += '<TR><TD><BR></td></tr>';

          row = [];
            for(i=0; i<Cities.numCities; i++) {
                        var rp = getResourceProduction (Cities.cities[i].id);
                        row[i] = parseIntNan(rp[1]);
            }
            str += _row ('<img height=18 title="'+lang.Overview.prodfood+'" src='+gameurl+'img/food_30.png>', row, false, 0);
          row = [];
                  for(i=0; i<Cities.numCities; i++) {
                              var rp = getResourceProduction (Cities.cities[i].id);
                              row[i] = parseIntNan(rp[2]);
                  }
                  str += _row ('<img height=18 title="'+lang.Overview.prodwood+'" src='+gameurl+'img/wood_30.png>', row, false, 0);

       row = [];
            for(i=0; i<Cities.numCities; i++) {
                        var rp = getResourceProduction (Cities.cities[i].id);
                        row[i] = parseIntNan(rp[3]);
            }
            str += _row ('<img height=18 title="'+lang.Overview.prodstone+'" src='+gameurl+'img/stone_30.png>', row, false, 0);

       row = [];
            for(i=0; i<Cities.numCities; i++) {
                        var rp = getResourceProduction (Cities.cities[i].id);
                        row[i] = parseIntNan(rp[4]);
            }
        str += _row ('<img height=18 title="'+lang.Overview.prodore+'" src='+gameurl+'img/iron_30.png>', row, false, 0);




     }

         str += '<TR><TD style="font-size:6px"><BR></td></tr>';
	            row = [];
	            var totalbouffe = 0;
	            for(i=0; i<Cities.numCities; i++) {
	              var rp = getResourceProduction (Cities.cities[i].id);
	              row[i] = parseIntNan(rp[1]);
	            }
	            for(i=0; i<Cities.numCities; i++) {
	              if (row[i] >= 0)
	                row[i] = '----';
	              else {
	                var timeLeft = parseInt(Seed.resources["city" + Cities.cities[i].id]['rec1'][0]) / 3600 / (0-row[i]) * 3600;
	                if (timeLeft > 86313600)
	                  row[i] = '----';
	                else {
	                  if (Options.enableFoodWarn && timeLeft<(Options.foodWarnHours*3600))
	                    row[i] = '<SPAN class=whiteOnRed><blink>'+ timestrShort(timeLeft) +'</blink></span>';
	                  else
	                    row[i] = timestrShort(timeLeft);
	                }
	              }
	            }
      str += _row (lang.Overview.auton, row, true, 0);


            var now = unixTime();
            str += '<TR><TD style="font-size:6px"><BR></font></td></tr>';
            str +='<tr style="background: #fff" align=right><td><img height=20 src='+gameurl+'img/items/70/131.jpg title="'+uW.g_js_strings.commonstr.buildings+'"></td><td>&nbsp;</td>';
            for(i=0; i<Cities.numCities; i++) {
             var totTime = 0;
             if (Seed.queue_con["city" + Cities.cities[i].id].length > 0) {
              var q=Seed.queue_con["city" + Cities.cities[i].id][0];
              var totTime = 0;
              totTime = q[4] - now;
              if (totTime < 0)
                totTime = 0;
              if (totTime < 3600)
                affuichage = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
              else
                affuichage = timestr(totTime);
              str +="<td>"+ affuichage + "</td>";
             } else {
             str +="<td>0s</td>";
             }
            }
            str +="</tr>";
            //
            str +='<tr style="background: #e8e8e8" align=right><td><img height=20 src='+gameurl+'img/items/70/1.jpg title="'+uW.g_js_strings.commonstr.technology+'"></b></td><td>&nbsp;</td>';
            for(i=0; i<Cities.numCities; i++) {
             var totTime=0,affuichage="0s",affuichage2="0s";
             if (getCityBuilding(Cities.cities[i].id,11).count>0) {
              if (Seed.queue_tch["city" + Cities.cities[i].id].length > 0) {
               var q=Seed.queue_tch["city" + Cities.cities[i].id][0];
               totTime = q[3] - now;
               if (totTime < 0)
                totTime = 0;
               if (totTime < 3600)
                affuichage = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
               else
                affuichage = timestr(totTime);
              }
            } else affuichage="-"
            if (getCityBuilding(Cities.cities[i].id,27).count>0) {
				if (Seed.queue_tch2["city" + Cities.cities[i].id].length > 0) {
               var q=Seed.queue_tch2["city" + Cities.cities[i].id][0];
               totTime = q[3] - now;
               if (totTime < 0)
                totTime = 0;
               if (totTime < 3600)
                affuichage2 = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
               else
                affuichage2 = timestr(totTime);
              }


             } else affuichage2="-"
		    str +="<td>"+affuichage+"<br>"+affuichage2+"</td>";
            }
             str +="</tr>";

          // crafting
          str +='<tr style="background: #e8e8e8" align=right><td><img height=20 src='+gameurl+'img/items/70/3.jpg title="Crafting"></b></td><td>&nbsp;</td>';
            for(i=0; i<Cities.numCities; i++) {
             var totTime = 0;
             if (Seed.queue_craft["city" + Cities.cities[i].id].length > 0) {
              var q=Seed.queue_craft["city" + Cities.cities[i].id][0];
              var totTime = 0;
              totTime = q.craftingEtaUnixTime - now;
              if (totTime < 0)
                totTime = 0;
              if (getCityBuilding(Cities.cities[i].id,20).count>0 && totTime == 0)
                affuichage = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
              else
                affuichage = timestr(totTime);

              str +="<td><span onclick='BOCrafting("+Cities.cities[i].id+");'>"+ affuichage + "</span></td>";

             } else {
             affuichage = timestr(totTime);
             if (getCityBuilding(Cities.cities[i].id,20).count>0)
                affuichage = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';

             str +="<td><span onclick='BOCrafting("+Cities.cities[i].id+");'>"+affuichage+"</span></td>";
             }
            }
             str +="</tr>";
             // Reviving
            str +='<tr style="background: #e8e8e8" align=right><td><img height=20 src="'+URL_HOSPITAL+'" title="'+uW.g_js_strings.revive.trainttl+'"></b></td><td>&nbsp;</td>';
            for(i=0; i<Cities.numCities; i++) {
             var totTime = 0;
             var ah=Seed.queue_revive["city" + Cities.cities[i].id];
             var l=0;
             if (ah) {
              for(var an=0;an<Math.min(ah.length,1);an++){
                 var P=uW.unixtime();
                 l=parseInt(ah[an][3])-P;
              }
              var totTime = 0;
              totTime = parseIntNan(l);
              if (totTime < 0)
                totTime = 0;
                affuichage = timestr(totTime);

              str +="<td><span>"+ affuichage + "</span></td>";

             } else {
             affuichage = timestr(totTime);

             str +="<td><span>"+affuichage+"</span></td>";
             }
            }
             str +="</tr>";



      // Population

      if (Options.showPop) {
       str += '<TR><TD style="font-size:6px"><BR></td></tr>';

              for (r=0; r<7; r++){
                rowsnm[r] = [];
              }
              for(i=0; i<Cities.numCities; i++) {
                cityID = 'city'+ Cities.cities[i].id;
                rowsnm[0][i] = parseIntNan(Seed.citystats[cityID]["pop"][1]);
                rowsnm[1][i] = parseIntNan(Seed.citystats[cityID]["pop"][0]);
                rowsnm[2][i] = parseIntNan(Seed.citystats[cityID]["pop"][3]);
                rowsnm[5][i] = parseIntNan(Seed.citystats[cityID]["pop"][2]);
                if (rowsnm[5][i] < 100)
		                  rowsnm[5][i] = '<SPAN class=boldRed>' + rowsnm[5][i] + '</SPAN>';
                rowsnm[3][i] = rowsnm[0][i] * rowsnm[5][i] / 100 - rowsnm[2][i];
                rowsnm[4][i] = rowsnm[1][i] - rowsnm[2][i];
                rowsnm[6][i] = parseIntNan(Seed.citystats[cityID]["gold"][1]);
                if (rowsnm[6][i] > 0)
                  rowsnm[6][i] = '<SPAN class=boldRed>' + rowsnm[6][i] + '</SPAN>';
              }

              rownum = 0;
              str += _row ('<span class=pdxCapShadowSG>'+lang.Overview.pop1+'</span>',  rowsnm[0]);
              str += _row ('<span class=pdxCapShadowSG>'+lang.Overview.pop2+'</span>',  rowsnm[1]);
              str += _row ('<span class=pdxCapShadowSG>'+lang.Overview.pop3+'</span>',  rowsnm[2]);
              str += _row ('<span class=pdxCapShadowSG>'+lang.Overview.pop4+'</span>', rowsnm[3]);
              str += _row ('<span class=pdxCapShadowSG>'+lang.Overview.pop5+'</span>', rowsnm[4]);
              str += _row ('<span class=pdxCapShadowSG><img height=20 src='+gameurl+'img/happiness.png title="'+uW.g_js_strings.commonstr.happiness+'"></span>',  rowsnm[5], true);
        str += _row ('<span class=pdxCapShadowSG><img height=20 src='+gameurl+'img/taxes.png title="'+uW.g_js_strings.changeTax.taxrate+'"></span>', rowsnm[6], true);
      }
      if (Options.showTroops) {
      str += '<TR><TD style="font-size:6px"><BR></td></tr>';
      var r=0;
	  for (y in uW.unitcost) {
		r++;
        rows[r] = [];
        for(i=0; i<Cities.numCities; i++) {
          cityID = 'city'+ Cities.cities[i].id;
          rows[r][i] = parseIntNan(Seed.units[cityID][y]);
        }
      }
      if (Options.includeMarching){
        var i=0;
		for (y in uW.unitcost) {
		  i++;
          rows[i][Cities.numCities] = parseIntNan(march.marchUnits[i]);
	     }
      }
      rownum = 0;
      this.totalentre = 0;
      var r=0;
      for (y in uW.unitcost) {
		 r++;
         str += _row ('<img height=18 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg?6545>', rows[r],false, r);
      }  }
      var row = [];
      for(i=0; i<Cities.numCities; i++) {
              var totTime = 0;
              var q = Seed.queue_unt['city'+Cities.cities[i].id];
              if (q!=null && q.length>0)
                totTime = q[q.length-1][3] - now;
              if (totTime < 0)
                totTime = 0;
              if (totTime < 86400)
                row[i] = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
              else
                row[i] = timestr(totTime);
            }
      str += _row (lang.Overview.EnableFormation, row, true, 0);
     if (Options.showDefense) {
             str += '<TR><TD style="font-size:6px"><BR></td></tr>';
             owsnm = [];
                     for (r=0; r<5; r++){
                       rowsnm[r] = [];
                     }
                     for(i=0; i<Cities.numCities; i++) {
                       var wall = {};
                       getWallInfo (Cities.cities[i].id, wall);
                       rowsnm[0][i] = parseIntNan(wall.Crossbows);
                       rowsnm[1][i] = parseIntNan(wall.Trebuchet);
                       rowsnm[2][i] = parseIntNan(wall.Caltrops);
                       if (isNaN(parseInt(wall.SpikedBarrier))) // KoC bug if wall lvl 0
                         rowsnm[3][i] = 0;
                       else
                       rowsnm[3][i] = parseIntNan(wall.SpikedBarrier);
                       rowsnm[4][i] = parseIntNan(wall.Trap);
                     }
                     if (Options.defBau){
                       var q = Seed.queue_unt;
                       for(i=0; i<Cities.numCities; i++) {
                         var q = Seed.queue_fort['city'+Cities.cities[i].id];
                         if (q && q.length>0){
                           for (qi=0; qi<q.length; qi++) {
                             if (q[qi][0]==53)
                               rowsnm[0][i] += parseIntNan(q[qi][1]);
                             if (q[qi][0]==55)
                               rowsnm[1][i] += parseIntNan(q[qi][1]);
                             if (q[qi][0]==60)
                               rowsnm[4][i] += parseIntNan(q[qi][1]);
                             if (q[qi][0]==61)
                               rowsnm[2][i] += parseIntNan(q[qi][1]);
                             if (q[qi][0]==62)
                               rowsnm[3][i] += parseIntNan(q[qi][1]);
                           }
                         }
                       }
                     }

                     rownum = 0;
                     str += _row ('<span class=pdxCapShadowSG><img height=18 title="'+uW.fortcost.frt53[0]+'" src="'+gameurl+'img/units/unit_53_30.jpg"></span>',  rowsnm[0]);
                     str += _row ('<span class=pdxCapShadowSG><img height=18 title="'+uW.fortcost.frt55[0]+'" src="'+gameurl+'img/units/unit_55_30.jpg"></span>',  rowsnm[1]);
                     str += _row ('<span class=pdxCapShadowSG><img height=18 title="'+uW.fortcost.frt60[0]+'" src="'+gameurl+'img/units/unit_60_30.jpg"></span>',  rowsnm[4]);
                     str += _row ('<span class=pdxCapShadowSG><img height=18 title="'+uW.fortcost.frt61[0]+'" src="'+gameurl+'img/units/unit_61_30.jpg"></span>', rowsnm[2]);
                     str += _row ('<span class=pdxCapShadowSG><img height=18 title="'+uW.fortcost.frt62[0]+'" src="'+gameurl+'img/units/unit_62_30.jpg"></span>',  rowsnm[3]);
      }


      var row = [];
      for(i=0; i<Cities.numCities; i++) {
        var wall = {};
        getWallInfo (Cities.cities[i].id, wall);
        var totTime = 0;
        var q = Seed.queue_fort['city'+Cities.cities[i].id];
        if (q!=null && q.length>0)
          totTime = q[q.length-1][3] - now;
        if (totTime < 0)
          totTime = 0;
        if (totTime<1 && (wall.wallSpaceUsed < wall.wallSpace-4 || wall.fieldSpaceUsed < wall.fieldSpace-4))
          row[i] = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
        else
          row[i] = timestr(totTime);
      }
      str += _row (lang.Overview.def, row, true, 0);
      str += '<TR><TD style="font-size:6px"><BR></td></tr>';
      // Terres sauvages
      row = [];
      for(i=0; i<Cities.numCities; i++) {
        var totWilds = 0;
        dat = Seed.wilderness['city'+ Cities.cities[i].id];
        if (dat!=null && matTypeof(dat)=='object')
          for (k in dat)
            ++totWilds;
        var nivcastle = parseIntNan(Seed.buildings['city'+ Cities.cities[i].id].pos0[1]);
        var castle = nivcastle;
        if (nivcastle==11) castle=12;
        if (nivcastle==12) castle=14;
        if (totWilds < castle)
        {
         row[i] = '<SPAN class=boldRed><B>'+ totWilds +'/'+ castle +'</b></span>';
        }else{

          row[i] = totWilds +'/'+ castle;
        }
      }
      str += _row (lang.Overview.ts, row, true, 0);
      row = [];
      var did = {};
      for(i=0; i<Cities.numCities; i++) {
        totKnights = 0;
        dat = Seed.knights['city'+ Cities.cities[i].id];
        for (k in dat)
          ++totKnights;

        var Knidispo = 0;
        var niveauPointRall=March.RallyPoint(Cities.cities[i].id).maxSlots;
        for (var z=0; z<knightRoles.length; z++){
	        var leader = Seed.leaders['city'+Cities.cities[i].id][knightRoles[z][1]+'KnightId'];
	        if (leader == 0) {

	        }else{
	         did['knt'+leader] = true;
	        }
         }
         for (k in Seed.knights['city'+Cities.cities[i].id]){
	         if (!did[k])
	           Knidispo++;
         }
         if (Knidispo<niveauPointRall) {
          row[i] = '<b>' + totKnights + '</b> - <span class=boldRed title="'+lang.Overview.knight1+'"><B>'+Knidispo+'/' + niveauPointRall +'</span>';
         }else {
          row[i] = '<b>' + totKnights + '</b> - <span title="'+lang.Overview.knight1+'">'+Knidispo+'/' + niveauPointRall +'</span>';
	 }

      }
      str += _row (lang.Overview.knight, row, true, 0);
      str += "</table>";
      t.BOResumeDIV.innerHTML = str +'</div>';

      function addListener (but, i){
                  but.addEventListener ('click', function (){t.butToggleDefMode(i)}, false);
      }
      function addListenerG (but,i,c) {
        but.addEventListener ('click', function (){
          numcid=Cities.byID[i].num + 1 ;
          uW.citysel_click(ById('citysel_'+ (numcid)));
          but.style.backgroundImage = "url(data:image/gif;base64,R0lGODlhDAAMAOMAAP///xo2b8jO3FVplBo2b3GDpo6cuJ2owf///////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCgABACwAAAAADAAMAAAEIjDISau9OOs6yMjdhwmDsA2DMQnshBrHwbZSYQjxfOHmFAEAIfkECQoAAQAsAAAAAAwADAAABCUwyEmrrYSMK/PmwyBcxWBwgTEUqFCMaHDMqGEcAlwJeK5buUoEACH5BAkKAAEALAAAAAAMAAwAAAQkMEg5hphYEjJyqEZ1ZVXhTYUxZkd7SodxvIFg05K9ejp947QIACH5BAkKAAEALAAAAAAMAAwAAAQnMEhpiphYjmFyOGBhCAQxTIZxTOUpCcelDZdge5Mt48HO/8CgMBMBACH5BAkKAAEALAAAAAAMAAwAAAQjMEh5jpiY1hyEF9YwGNM3iUV5TUaxctJADHA8193w4nzvTxEAIfkECQoAAQAsAAAAAAwADAAABCUwSCnEvLNanK05Bzd9oRiAm2kMhhkUQ+EKRooRxODiujkMNlcEACH5BAkKAAEALAAAAAAMAAwAAAQhMMhJq71UaBy04BvXGQd3kGBoDUOxDgJrWATRGl/F5lIEACH5BAEKAAEALAAAAAAMAAwAAAQjMMhJq7046z2Fz56giRJBDNNxkIE5FIZgGMc0DMJdqOwE9xEAOw%3D%3D)";
          clearTimeout(t.displayTimer);
          t.butToggleGuardian(i,c,but);
         }, false);
      }
      for (var cityId in Cities.byID){
        	  var but = ById('BOtabut_'+ cityId);
        	  addListener (but, cityId);
        	  t.defMode[cityId] =  parseInt(Seed.citystats["city" + cityId].gate);
        	  t.displayDefMode (cityId);
      }
      var mm=Seed.guardian;
      for (var ii in mm) {
              var ww = mm[ii];
              for (var z in ww.cityGuardianLevels) {
              if (ww.cityGuardianLevels[z]>0) {
               var but = ById('BoG_'+ww.cityId+'_'+z);
               if (but)
                addListenerG (but, ww.cityId, z);
              }
             }
      }
      ById('BOAutel').addEventListener('click', function(){
	       	t.autel();
    	} , false);

    } catch (e){
      t.BOResumeDIV.innerHTML = '<PRE>'+ e.name +' : '+ e.message +'</pre>';
    }
    t.displayTimer = setTimeout (t.setContent, 3000);
  },
  autel:function() {
	var t = Tabs.Overview;
	uW.BOCancelSacrifice = t.CancelSacrifice;
 	t.boSacrifice = new CPopup('boSacrifice', 0, 0, 380, 320, true, function() {clearTimeout (1000);clearTimeout(t.timerritual);});
	t.boSacrifice.centerMe (mainPop.getMainDiv());
	if (parseIntNan(Options.alertConfig.hq)>0) {
	var m="";

	m+="<table border=0 width=95%><tr><td>"+uW.g_js_strings.commonstr.city+" Fey : <span id=bocityfey></span></tr><tr><td><span id=bocontenu></span></td></tr>"
    m+="<tr><td><br><div class='effect'><b>"+uW.g_js_strings.modal_openBarracks.trainttl+"</b></div><br>";
    m+="Qte : <input type=text size=6 value=5000 id=BOQtesacrifie><br>";
    	var r=0;
			for (y in uW.unitcost) {
		  r++;
		   m+= '<img id="BOUnitSacrif_'+r+'" height=20 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg>&nbsp;';
       }

	m+="</table>";
}else {
	var m ="Pas de QG configure";
}
	t.boSacrifice.getMainDiv().innerHTML = m;
	t.boSacrifice.getTopDiv().innerHTML = '<DIV align=center><B>Sacrifice</B></DIV>';
	t.boSacrifice.show(true);
if (parseIntNan(Options.alertConfig.hq)>0) {
    t.citynumber=new CdispCityPicker ('bocityFey', ById('bocityfey'), true, t.updateFey, Cities.byID[parseIntNan(Options.alertConfig.hq)].idx);
    t.updateFey(t.citynumber.city);

    var r=0;
	for (y in uW.unitcost) {
	  r++;
  	  ById("BOUnitSacrif_"+r).addEventListener ('click', function() {
		  var uni=this.id.replace("BOUnitSacrif_","");
		  var a=confirm("Voulez vous sacrifier "+ById("BOQtesacrifie").value+" "+uW.unitcost['unt'+uni][0]+" ?");
		  if (a)  t.addsacrifice(t.citynumber.city.id,uni);
	   }, false);

	}
   }
  },
  cityselec:0,timerritual:null,
  updateFey:function(city) {
	 var t = Tabs.Overview;
	 clearTimeout(t.timerritual);
     var O = Seed.queue_sacr["city"+Seed.cities[city.idx][0]],L=uW.cm.BlessingSystemController.getSelectedBlessings(),J=uW.cm.BlessingSystemModel.getActiveBlessingNames(),M=uW.cm.BlessingSystemModel.getActiveBlessingDescriptions();
     var H=uW.unixtime();
     var G="";
     G+='<div class="effect"><b>'+uW.g_js_strings.sacrifice_tooltip.active_rituals+'</b></div><table width=95%>';
     if(O.length>0){
     var x=0;
     $.each(O,function(P,R){

	  var Q=parseInt(R.eta,10)-H,S=Math.round((R.multiplier[0]-1)*100),T=R.buffedUnitType[0];
	  G+="<tr><td><b>"+uW.g_js_strings.sacrifice_tooltip["unitdesc"+T].replace("%1$s",S)+"</b></td><td>"+uW.g_js_strings.sacrifice_tooltip.duration_left.replace("%1$s",timestr(Q))+"";
	  G+="<td><a id=button_training_cancel class=button20 onclick='BOCancelSacrifice("+Seed.cities[city.idx][0]+","+(x)+");return false;' href=#><span>"+uW.g_js_strings.commonstr.cancel+"</span></a></td></tr>";
	  x++;
	 })

	}else {
		G+="<tr><tr><b>"+uW.g_js_strings.commonstr.none+"</tr>";
    }
    G+="</table>";
    ById('bocontenu').innerHTML=G;
    t.timerritual=setTimeout(function() {
		 t.updateFey(city);
	 },1000);
  },
  addsacrifice:function(cityId,unitId) {
	var t = Tabs.Overview;
    var params=uW.Object.clone(uW.g_ajaxparams);
    params.cid=cityId;params.type=unitId;params.quant=ById("BOQtesacrifie").value;
    new AjaxRequest(uW.g_ajaxpath + "ajax/sacrifice.php" + uW.g_ajaxsuffix, {
	       			method: "post",
	       			parameters: params,
	    			onSuccess: function (rslt) {
						 var rslt=eval("("+rslt.responseText+")");
						 if(rslt.ok) {
						   Seed.queue_sacr["city"+cityId].push(rslt.queue_sacr);
						   t.updateFey(t.citynumber.city);
						 }
				    }

	});
  },
  CancelSacrifice:function(cityId,queueNumber) {
   var t = Tabs.Overview;
   var queue=Seed.queue_sacr["city"+cityId][queueNumber];
   var params = uW.Object.clone(uW.g_ajaxparams);
   params.cid = cityId;
   params.type=queue.unitType;params.quant=queue.quantity;params.start=queue.start;params.eta=queue.eta;
   new AjaxRequest(uW.g_ajaxpath + "ajax/cancelSacrificing.php" + uW.g_ajaxsuffix, {
       			method: "post",
       			parameters: params,
    			onSuccess: function (rslt) {
					var rslt=eval("("+rslt.responseText+")");
					 if(rslt.ok)
					   Seed.queue_sacr["city"+cityId].splice(queueNumber,1);
			    }
		});
  },
  butToggleGuardian:function (cityId, guardiuan, but) {
   var t = Tabs.Overview;
   var params = uW.Object.clone(uW.g_ajaxparams);
    		params.cityId = cityId;
    		params.ctrl = "Guardian";
    		params.action="summon";
    		params.type=guardiuan;
    		new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
    			method: "post",
    			parameters: params,
    			onSuccess: function (rslt) {
    			     var rslt=eval("("+rslt.responseText+")");
    				if (rslt.ok) {
    				var g = uW.cm.guardianModalModel.gObj();
    				g.summonGuardian = {summonFinishTime: parseInt(rslt.summonFinishTime), level: rslt.summonGuardian.cl0, type: rslt.summonGuardian.type, upgrading: false};
    				var now = unixTime();
        		 	var tempsrestant = parseInt(rslt.summonFinishTime) - now;
        		 	if (but==null) return;
        		 	numcid=Cities.byID[cityId].num + 1 ;
        		 	setTimeout(function() {
        		 	uW.citysel_click(ById('citysel_'+ (numcid)));
        		 	setTimeout (t.setContent, 1000);
    				}, tempsrestant*1000);
    				} else {
						 if (but==null) return;
    				  setTimeout (t.setContent, 1000);
    				}
    			},
    			onFailure: function () {
                 if (but==null) return;
    			 setTimeout (t.setContent, 1000);
    			}
   });
  },
  butToggleDefMode : function (cityId){
      var t = Tabs.Overview;
      var mode = 1;
      if (Seed.citystats["city" + cityId].gate != 0)
        mode = 0;
      t.ajaxSetDefMode (cityId, mode, function (newMode){
          t.defMode[cityId] = newMode;
          t.displayDefMode (cityId);
        });
    },

    displayDefMode : function (cityId){
      var t = Tabs.Overview;
      var but = ById('BOtabut_'+ cityId);
      if (t.defMode[cityId]){
        but.className = 'BODefButOn';
        but.value = lang.Overview.def+' = ON';
      } else {
        but.className = 'BODefButOff';
        but.value = lang.Overview.def+' = OFF';
      }
  },
  ajaxSetDefMode : function (cityId, state, notify){
  		var params = uW.Object.clone(uW.g_ajaxparams);
  		params.cid = cityId;
  		params.state = state;
  		new MyAjaxRequest(uW.g_ajaxpath + "ajax/gate.php" + uW.g_ajaxsuffix, {
  			method: "post",
  			parameters: params,
  			onSuccess: function (rslt) {
  				if (rslt.ok) {
  					Seed.citystats["city" + cityId].gate = state;
  					notify (state);
  				}
  			},
  			onFailure: function () {
  			}
  		})
  },
};
Tabs.Rpt = {
	tabOrder:		2,
	tabLabel:		uW.g_js_strings.commonstr.reports,
	cont:			null,
	state:			null,
	minPages:		parseInt(Options.arPageFrom),
	maxPages:		parseInt(Options.arPageTo),
	data:			[],
	dataDF:	[],dataAT:	[],
	report:			[],
	reportDF:		[],
	reportAT:		[],
	totalPages:	parseInt(Options.arPageTo),
	what:			'',
	whatNot:		'',
	content:		'',

  show : function () {

    var t = Tabs.Rpt;
    if (Options.RptAuto) t.handleRptSearch();
  },
	hide : function (){
  	},

	init : function (div) {
		var t = Tabs.Rpt;
		t.cont = div;
		uW.getmsg = t.getMailBody;
		uW.DelMail = t.DeleteMail;
		uW.getReport = t.getReportBody;
		uW.DelReport = t.DeleteReport;
	        var tc = '<DIV class=boStat>'+uW.g_js_strings.commonstr.reports.toUpperCase() +' '+uW.g_js_strings.commonstr.alliance.toUpperCase() +'-'+uW.g_js_strings.commonstr.player.toUpperCase() +' - '+uW.g_js_strings.commonstr.message.toUpperCase() +' - <input type=button value="?" id=boaiderapport class=boAide></DIV><DIV class=ptentry><TABLE><TR align=center valign=center>';
		tc += '<TD class=xtab align=right>'+lang.Rpt.type+'&nbsp;<SELECT id="idRptType">';
		tc += '<OPTION value="alliance" ' + (Options.rptType=='alliance'?'SELECTED':'') + '>'+uW.g_js_strings.commonstr.reports+' '+uW.g_js_strings.commonstr.alliance+'</OPTION>';
		tc += '<OPTION value="player" ' + (Options.rptType=='player'?'SELECTED':'') + '>'+uW.g_js_strings.commonstr.reports+' '+uW.g_js_strings.commonstr.player+'</OPTION>';
		tc += '<OPTION value="inbox" ' + (Options.rptType=='inbox'?'SELECTED':'') + '>'+uW.g_js_strings.commonstr.inbox+'</OPTION>';
		tc += '<OPTION value="outbox" ' + (Options.rptType=='outbox'?'SELECTED':'') + '>'+uW.g_js_strings.commonstr.outbox+'</OPTION></SELECT>';
		tc += '<BR /><INPUT id=idRptSearch type=button class=pbButton  value="Ok" />&nbsp;Auto : <input type=checkbox id="idRptAuto" ' +(Options.RptAuto?'CHECKED':'')+'> '+lang.Rpt.pages+'&nbsp;<INPUT id="idRptPageFrom" size=1 value="' + Options.arPageFrom + '">'+lang.Rpt.to+'<INPUT id="idRptPageTo" size=1 value="' + Options.arPageTo + '"></TD>';
		tc += '<TD class=xtab align=right>'+uW.g_js_strings.commonstr.attacker+' :&nbsp;<SELECT id="idRptAttacker">'; // Options.arPageFrom - Options.arPageTo
		tc += '<OPTION value="Them" ' + (Options.arAttacker=='Them'?'SELECTED':'') + '>'+lang.Rpt.them+'</OPTION>';
		tc += '<OPTION value="Us" ' + (Options.arAttacker=='Us'?'SELECTED':'') + '>'+lang.Rpt.us+'</OPTION>';
		tc += '<OPTION value="Both" ' + (Options.arAttacker=='Both'?'SELECTED':'') + '>'+lang.Rpt.both+'</OPTION></SELECT>';
		tc += '<BR />'+uW.g_js_strings.commonstr.target+' :&nbsp;<SELECT id="idRptTarget">';
		tc += '<OPTION value="Them" ' + (Options.arTarget=='Them'?'SELECTED':'') + '>'+lang.Rpt.them+'</OPTION>';
		tc += '<OPTION value="Us" ' + (Options.arTarget=='Us'?'SELECTED':'') + '>'+lang.Rpt.us+'</OPTION>';
		tc += '<OPTION value="Both" ' + (Options.arTarget=='Both'?'SELECTED':'') + '>'+lang.Rpt.both+'</OPTION></SELECT></TD>';
		tc += '<TD class=xtab align=right>'+lang.Rpt.idRptWhat+'&nbsp;<INPUT id=idRptWhat type=text size=11 maxlength=50 value=""><BR />';
		tc += ''+lang.Rpt.idRptWhatNot+'&nbsp;<INPUT id=idRptWhatNot type=text size=11 maxlength=50 value=""></TD>';
		tc += '<TD class=xtab align=left><INPUT id=idRptAttack type=checkbox '+(Options.arAttack?'CHECKED':'')+' />&nbsp;'+uW.g_js_strings.commonstr.atk+'<BR />';
		tc += '<INPUT id=idRptScout type=checkbox '+(Options.arScout?'CHECKED':'')+' />&nbsp;'+uW.g_js_strings.commonstr.scouting+'</TD>';
		tc += '<TD class=xtab align=left><INPUT id=idRptReinforce type=checkbox '+(Options.arReinforce?'CHECKED':'')+' />&nbsp;'+uW.g_js_strings.commonstr.reinforce+'<BR />';
		tc += '<INPUT id=idRptTransport type=checkbox '+(Options.arTransport?'CHECKED':'')+' />&nbsp;'+uW.g_js_strings.commonstr.transporting+'</TD>';
		tc += '<TD class=xtab align=left><select id=idRptFiltre1><option value="">--</option><option value="0">'+lang.Rpt.idRptFiltre1_1+'</option><option value=54>'+lang.Rpt.idRptFiltre1_2+'</option></select><br>'+lang.Rpt.BOSyntheseAttack+' <input type=checkbox id=BOSyntheseAttack></TD></TR></TABLE></DIV>';
		tc += '<DIV class=boStat><TABLE width=100% cellspacing=0><TR><TD class=xtab align=left width=125><DIV id=idRptSearched></DIV></TD></TD>';
		tc += '<TD class=xtab><TD class=xtab align=center><SPAN style="white-space:normal" id=idRptStatus>&nbsp;</span></TD></TD>';
		tc += '<TD class=xtab><TD class=xtab align=right width=125><DIV id=idRptFound></DIV></TD></TR></TABLE></DIV>';
		tc += '<DIV id="idBoRptResultsDiv" style="height:' + (Options.HauteurBoite-140) +'px; max-height:' + (Options.HauteurBoite-140) +'px; overflow-x:auto; overflow-y:auto; white-space:nowrap;"></DIV>';

		t.cont.innerHTML = tc;

		 ById('boaiderapport').addEventListener('click', function(){
		             	 window.open(sitesupport+"?page=aide_rapport");
		      	} , false);

		ById('idRptType').addEventListener ('change', t.handleRptType, false);
		ById('idRptPageFrom').addEventListener ('change', t.handleRptPages, false);
		ById('idRptPageTo').addEventListener ('change', t.handleRptPages, false);
		ById('idRptAttacker').addEventListener ('change', t.handleRptAttacker, false);
		ById('idRptTarget').addEventListener ('change', t.handleRptTarget, false);
		ById('idRptWhat').addEventListener ('keyup', t.handleRptWhat, false);
		ById('idRptWhatNot').addEventListener ('keyup', t.handleRptWhatNot, false);
		ById('idRptSearch').addEventListener ('click', t.handleRptSearch, false);
		ById('idRptFiltre1').addEventListener ('change', t.handleRptWhat, false);

		t.togOpt ('idRptAttack', 'arAttack');
		t.togOpt ('idRptScout', 'arScout');
		t.togOpt ('idRptReinforce', 'arReinforce');
		t.togOpt ('idRptTransport', 'arTransport');
		t.togOpt ('idRptAuto','RptAuto');

	},
	FindReport : function(rpId, pageNum) {
	 var t = Tabs.Rpt;
	 //t.report = [];
	 t.report[rpId] = [];
	 var params = uW.Object.clone(uW.g_ajaxparams);
	 params.rid=rpId;
	 new MyAjaxRequest(uW.g_ajaxpath + "ajax/fetchReport.php" + uW.g_ajaxsuffix, {
	 method: "post",
	 parameters: params,
	 onSuccess: function (rslt) {
	  var rpt = rslt['index'];

		var reportId = parseInt(rpt.marchReportId);
        t.report[reportId] = [];
					t.report[reportId].side1Name = '';
					t.report[reportId].side1AllianceId = parseInt(rpt.side1AllianceId);
					t.report[reportId].side1AllianceName = '-';
					t.report[reportId].side1CityName = '-';
					t.report[reportId].side1XCoord = rpt.side1XCoord;
					t.report[reportId].side1YCoord = rpt.side1YCoord;
					t.report[rpId].side0PlayerId = rpt.side0PlayerId;
					t.report[rpId].side1PlayerId = rpt.side1PlayerId;
					if (parseInt(rpt.side0PlayerId) == 0) { // Kabam
						t.report[reportId].side0Name = 'Ennemi';
						t.report[reportId].side0AllianceName = '';
						t.report[reportId].side0CityName = '';
					} else {
						t.report[reportId].side0Name = '';
						t.report[reportId].side0AllianceName = '-';
						t.report[reportId].side0CityName = '-';
					}
					t.report[reportId].side0AllianceId = parseInt(rpt.side0AllianceId);
					t.report[reportId].side0XCoord = rpt.side0XCoord;
					t.report[reportId].side0YCoord = rpt.side0YCoord;
					if (parseInt(rpt.side0TileType) == 10)
						t.report[reportId].side0TileTypeText='Prair';
					else if (parseInt(rpt.side0TileType) == 11)
						t.report[reportId].side0TileTypeText='Lac';
					else if (parseInt(rpt.side0TileType) == 20)
						t.report[reportId].side0TileTypeText='Fore';
					else if (parseInt(rpt.side0TileType) == 30)
						t.report[reportId].side0TileTypeText='Coll';
					else if (parseInt(rpt.side0TileType) == 40)
						t.report[reportId].side0TileTypeText='Mont';
					else if (parseInt(rpt.side0TileType) == 50)
						t.report[reportId].side0TileTypeText='Plai';
					else if (parseInt(rpt.side0TileType) == 51 && parseInt(rpt.side0CityId) == 0)
						t.report[reportId].side0TileTypeText='Barb';
					else if (parseInt(rpt.side0TileType) == 54)
						t.report[reportId].side0TileTypeText='F.S.';
					else if (parseInt(rpt.side0TileType) == 55)
						t.report[reportId].side0TileTypeText='Merc';
					else if (parseInt(rpt.side0CityId) == 0)
						t.report[reportId].side0TileTypeText='Barb';
					else
						t.report[reportId].side0TileTypeText='Vil';

					t.report[reportId].side0TileTypeLevel = t.report[reportId].side0TileTypeText + ' ' + rpt.side0TileLevel;
					t.report[reportId].side0TileType = rpt.side0TileType;
					t.report[reportId].side0TileLevel = rpt.side0TileLevel;
					t.report[reportId].page = "0";
					t.report[reportId].reportUnixTime = rpt.reportUnixTime;
					if (rpt.side0AllianceId == parseInt(getMyAlliance()[0]))
						t.report[reportId].sideId = 0;
					else if (rpt.side1AllianceId == parseInt(getMyAlliance()[0])) {
						t.report[reportId].sideId = 1;
					} else {
						if (rpt.side0PlayerId == uW.tvuid)
							t.report[reportId].sideId = 0;
						else if (rpt.side1PlayerId == uW.tvuid)
							t.report[reportId].sideId = 1;
						else
							t.report[reportId].sideId = -1;
					}


					if (rpt.marchType == 0)
						t.report[reportId].marchName = 'Desertion';
					else if (rpt.marchType == 1)
						t.report[reportId].marchName = 'Transport';
					else if (rpt.marchType == 2)
						t.report[reportId].marchName = 'Renfort';
					else if (rpt.marchType == 3 || rpt.marchType == 11) {
						if (t.report[reportId].sideId == 0)
							t.report[reportId].marchName = 'Contre-Ecl';
						else
							t.report[reportId].marchName = 'Eclaireur';
					} else if (rpt.marchType == 4) {
						if (t.report[reportId].sideId == 0)
							t.report[reportId].marchName = 'Defense';
						else
							t.report[reportId].marchName = 'Attaque';
					} else if (rpt.marchType == 10 || rpt.marchType == 9) {
					 t.report[reportId].marchName = 'Attaque';
					} else
						t.report[reportId].marchName = '?';




	  t.GetNames(rpId,rpt);
	},
	onFailure: function () {
	},
	}, false);
    },
	GetNames : function(rpId,rpt) {
	var t = Tabs.Rpt;
	var params = uW.Object.clone(uW.g_ajaxparams);
	params.uid= t.report[rpId].side0PlayerId;
	new MyAjaxRequest(uW.g_ajaxpath + "ajax/getUserGeneralInfo.php" + uW.g_ajaxsuffix, {
	method: "post",
	parameters: params,
	onSuccess: function (rslt) {
	t.report[rpId].side0Name = rslt['userInfo']['0']['name'];
	var params = uW.Object.clone(uW.g_ajaxparams);
	params.uid=t.report[rpId].side1PlayerId;
	new MyAjaxRequest(uW.g_ajaxpath + "ajax/getUserGeneralInfo.php" + uW.g_ajaxsuffix, {
	method: "post",
	parameters: params,
	onSuccess: function (rslt) {
	t.report[rpId].side1Name = rslt['userInfo']['0']['name'];
	t.getReportBody(rpId);
	},
	onFailure: function () {
	},
	}, false);
	},
	onFailure: function () {
	},
	}, false);
},
DeleteMail: function(rptid, type) {
   var t = Tabs.Rpt;
   var params = uW.Object.clone(uW.g_ajaxparams);
   params.requestType="ACTION_ON_MESSAGES";
   params.selectedAction="delete";
   params.boxType=ById('idRptType').value;
   params.selectedMessageIds=rptid;

   new MyAjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
         method: "post",
         parameters: params,
         onSuccess: function (rslt) {
           if (rslt.ok) {

           t.handleRptSearch();

           }
           if (notify)
             notify (rslt.errorMsg);
         },
         onFailure: function () {
           if (notify)
             notify ('AJAX ERROR');
         },
       });
  },

  DeleteReport: function(rptid, isUnread) {
   var t = Tabs.Rpt;

   var params = uW.Object.clone(uW.g_ajaxparams);
   params.s0rids = rptid;
   params.s1rids = '';
   params.cityrids = '';

   new MyAjaxRequest(uW.g_ajaxpath + "ajax/deleteCheckedReports.php" + uW.g_ajaxsuffix, {
         method: "post",
         parameters: params,
         onSuccess: function (rslt) {
           if (rslt.ok) {

           if (isUnread){
             Seed.newReportCount = parseInt(Seed.newReportCount) - 1;
             uW.messages_notify_bug()
           }
           //t.handleRptSearch();
           //t.DisplayRpt();
           }

         },
         onFailure: function () {
             t.handleRptSearch();
         },
       });
  },
	togOpt: function (checkboxId, optionName){
		var t = Tabs.Rpt;
		var checkbox = ById(checkboxId);
		checkbox.addEventListener ('change', eventHandler, false);
		function eventHandler (){
			Options[optionName] = this.checked;
			saveOptions();
			if (t.data.length > 0)
				if (Options.rptType == 'alliance' || Options.rptType == 'player')
					t.DisplayRpt();
				else
					t.DisplayMail();
		}
	},

	handleRptType: function(){
		var t = Tabs.Rpt;
		Options.rptType = ById("idRptType").value;
		saveOptions();
		ById("idRptSearched").innerHTML = '';
		ById("idRptStatus").innerHTML = '&nbsp;';
		ById("idRptFound").innerHTML = '';
		ById("idBoRptResultsDiv").innerHTML = '';
	},

	handleRptPages: function(){
		var t = Tabs.Rpt;
		t.minPages=parseInt(ById("idRptPageFrom").value);
		t.maxPages=parseInt(ById("idRptPageTo").value);
		if (t.maxPages < t.minPages) {
			t.maxPages = t.minPages;
			ById("idRptPageTo").value = t.maxPages;
		}
		Options.arPageFrom = t.minPages;
		Options.arPageTo = t.maxPages;
		saveOptions();
		t.totalPages=t.maxPages;
	},

	handleRptAttacker: function(){
		var t = Tabs.Rpt;
		Options.arAttacker = ById("idRptAttacker").value;
		saveOptions();
		if ((Options.rptType == 'alliance' || Options.rptType == 'player') && t.data.length > 0)
			t.DisplayRpt();
	},

	handleRptTarget: function(){
		var t = Tabs.Rpt;
		Options.arTarget = ById("idRptTarget").value;
		saveOptions();
		if ((Options.rptType == 'alliance' || Options.rptType == 'player') && t.data.length > 0)
			t.DisplayRpt();
	},

	handleRptWhat: function(){
		var t = Tabs.Rpt;
		t.what = ById("idRptWhat").value;
		if (t.data.length > 0)
			if (Options.rptType == 'alliance' || Options.rptType == 'player')
				t.DisplayRpt();
			else
				t.DisplayMail();
	},

	handleRptWhatNot: function(){
		var t = Tabs.Rpt;
		t.whatNot = ById("idRptWhatNot").value;
		if (t.data.length > 0)
			if (Options.rptType == 'alliance' || Options.rptType == 'player')
				t.DisplayRpt();
			else
				t.DisplayMail();
	},

	handleRptSearch: function(){
		var t = Tabs.Rpt;
		if (t.searchRunning){
			t.searchRunning = false;
			t.stopSearch (uW.g_js_strings.commonstr.cancelled.toUpperCase());
			return;
		}
		t.handleRptPages();
		var attt=0;
		ById ('idRptSearch').value = 'Stop';
		ById('idRptStatus').innerHTML = uW.g_js_strings.commonstr.research+' page ' + t.minPages + ' / ' + t.maxPages;
		t.searchRunning = true;
		if (t.data.length > 0) attt=1
		t.data=[];
		t.report = [];
		t.dataDF=[];
		t.dataAT=[];
		t.reportAT=[];
		t.reportDF = [];
		if (Options.rptType == 'alliance' || Options.rptType == 'player') {
			if (attt==0)
			 t.getRpt(t.minPages);
			else
			 setTimeout(function() {t.getRpt(t.minPages);},1000);

		}
		else
			t.getMail(t.minPages);
	},

	stopSearch: function (msg){
		var t = Tabs.Rpt;
		if (t.searchRunning || msg == uW.g_js_strings.commonstr.cancelled.toUpperCase())
			ById ('idRptStatus').innerHTML = '<FONT color=#ffaaaa>' + msg + '</FONT>';
		ById ('idRptSearch').value = 'Ok';
		t.searchRunning = false;
		if (Options.rptType == 'alliance' || Options.rptType == 'player')
			t.DisplayRpt();
		else
			t.DisplayMail();
	},

	getMail: function (pageNum){
		var t = Tabs.Rpt;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.pf=0;
		params.requestType="GET_MESSAGE_HEADERS_FOR_USER_INBOX";
		params.boxType = ById('idRptType').value;
		params.pageNo = pageNum;
		new MyAjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			onSuccess: function (rslt) {
				t.getMailCallback(rslt, pageNum);
			},
			onFailure: function () {
			},
		}, false);
	},

	getMailCallback: function(rslt, page) {
		var t = Tabs.Rpt;
		if (rslt) {
			if (!rslt.ok) {
				ById("idRptStatus").innerHTML = '<FONT color=#ffaaaa>' + rslt.errorMsg + '</FONT>';
				return;
			}
			t.totalPages=parseInt(rslt.noOfPages);
			if (t.totalPages < t.maxPages)
				t.maxPages = t.totalPages;
			if (rslt.message && page) {
				var ml = rslt.message;
				if (rslt.messageCount > 0) {
					var rptkeys = uW.Object.keys(ml);
					for (var i = 0; i < rptkeys.length; i++) {
						var rpt = ml[rptkeys[i]];
						rpt.page = page;
						t.data.push(rpt);
					}
				}
			}
			if (parseInt(page)+1 <= t.maxPages && t.searchRunning) {
				ById("idRptStatus").innerHTML = uW.g_js_strings.commonstr.research +' page ' + (parseInt(page)+1) + ' / ' + t.maxPages;
				t.getMail(parseInt(page)+1);
				if (t.data.length > 0)
					t.DisplayMail();
			} else if (page)
				t.stopSearch ('Fini !');
		}
	},

	getRpt: function (pageNum){
		var t = Tabs.Rpt;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.pageNo = pageNum;
		if (Options.rptType == 'alliance')
			params.group = "a";
		new MyAjaxRequest(uW.g_ajaxpath + "ajax/listReports.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			onSuccess: function (rslt){
				t.getRptCallback (rslt, pageNum);
			},
			onFailure: function (rslt){
				t.getRptCallback (rslt, pageNum);
			},
		}, false);
	},
	getRptCallback: function(rslt, page){
		var t = Tabs.Rpt;
		if (rslt) {
			if (!rslt.ok) {
				ById("idRptStatus").innerHTML = '<FONT color=#ffaaaa>' + rslt.errorMsg + '</FONT>';
				return;
			}
			t.totalPages=parseInt(rslt.totalPages);
			if (t.totalPages < t.maxPages)
				t.maxPages = t.totalPages;
			if (rslt.arReports && page) {
				var ar = rslt.arReports;
				//if (ar.length == 0)
					//t.stopSearch('Page vide trouve depuis la page ' + page + ' - Kabam glitch');
				var rptkeys = uW.Object.keys(ar);
				for (var i = 0; i < rptkeys.length; i++) {
					var rpt = ar[rptkeys[i]];
					var reportId = parseInt(rpt.reportId);
					t.report[reportId] = [];
					t.report[reportId].side1Name = rslt.arPlayerNames['p'+rpt.side1PlayerId];
					t.report[reportId].side1PlayerId = parseInt(rpt.side1PlayerId);
					t.report[reportId].side0PlayerId = parseInt(rpt.side0PlayerId);
					t.report[reportId].side1AllianceId = parseInt(rpt.side1AllianceId);
					if (rpt.side1AllianceId > 0)
						t.report[reportId].side1AllianceName = rslt.arAllianceNames['a'+rpt.side1AllianceId];
					else
						t.report[reportId].side1AllianceName = '-';
					if (rpt.side1CityId > 0)
						t.report[reportId].side1CityName = rslt.arCityNames['c'+rpt.side1CityId];
					else
						t.report[reportId].side1CityName = '-';
					t.report[reportId].side1XCoord = rpt.side1XCoord;
					t.report[reportId].side1YCoord = rpt.side1YCoord;
					if (parseInt(rpt.side0PlayerId) == 0) { // Kabam
						t.report[reportId].side0Name = 'Ennemi';
						t.report[reportId].side0AllianceName = '';
						t.report[reportId].side0CityName = '';
					} else {
						t.report[reportId].side0Name = rslt.arPlayerNames['p'+rpt.side0PlayerId];
						if (rpt.side0AllianceId > 0)
							t.report[reportId].side0AllianceName = rslt.arAllianceNames['a'+rpt.side0AllianceId];
						else
							t.report[reportId].side0AllianceName = '-';
						if (rpt.side0CityId > 0)
							t.report[reportId].side0CityName = rslt.arCityNames['c'+rpt.side0CityId];
						else
							t.report[reportId].side0CityName = '-';
					}
					t.report[reportId].side0AllianceId = parseInt(rpt.side0AllianceId);
					t.report[reportId].side0XCoord = rpt.side0XCoord;
					t.report[reportId].side0YCoord = rpt.side0YCoord;
					if (parseInt(rpt.side0TileType) == 10)
						t.report[reportId].side0TileTypeText='Prair';
					else if (parseInt(rpt.side0TileType) == 11)
						t.report[reportId].side0TileTypeText='Lac';
					else if (parseInt(rpt.side0TileType) == 20)
						t.report[reportId].side0TileTypeText='Fore';
					else if (parseInt(rpt.side0TileType) == 30)
						t.report[reportId].side0TileTypeText='Coll';
					else if (parseInt(rpt.side0TileType) == 40)
						t.report[reportId].side0TileTypeText='Mont';
					else if (parseInt(rpt.side0TileType) == 50)
						t.report[reportId].side0TileTypeText='Plai';
					else if (parseInt(rpt.side0TileType) == 51 && parseInt(rpt.side0CityId) == 0)
						t.report[reportId].side0TileTypeText='Barb';
					else if (parseInt(rpt.side0TileType) == 54)
						t.report[reportId].side0TileTypeText='F.S.';
					else if (parseInt(rpt.side0TileType) == 55)
						t.report[reportId].side0TileTypeText='Merc.';
					else if (parseInt(rpt.side0CityId) == 0)
						t.report[reportId].side0TileTypeText='Barb';
					else
						t.report[reportId].side0TileTypeText='Vil';

					t.report[reportId].side0TileTypeLevel = t.report[reportId].side0TileTypeText + ' ' + rpt.side0TileLevel;
					t.report[reportId].side0TileType = rpt.side0TileType;
					t.report[reportId].side1CityId = rpt.side1CityId;
					t.report[reportId].side0CityId = rpt.side0CityId;
					t.report[reportId].side0TileLevel = rpt.side0TileLevel;
					t.report[reportId].page = page;
					t.report[reportId].reportUnixTime = rpt.reportUnixTime;
					if (rpt.side0AllianceId == parseInt(getMyAlliance()[0]))
						t.report[reportId].sideId = 0;
					else if (rpt.side1AllianceId == parseInt(getMyAlliance()[0])) {
						t.report[reportId].sideId = 1;
					} else {
						if (rpt.side0PlayerId == uW.tvuid)
							t.report[reportId].sideId = 0;
						else if (rpt.side1PlayerId == uW.tvuid)
							t.report[reportId].sideId = 1;
						else
							t.report[reportId].sideId = -1;
					}
					if (!ById("BOSyntheseAttack").checked && (parseInt(rpt.side0TileType) == 54 || parseInt(rpt.side0TileType) == 55) && Options.rptType=='player') {
					    t.FindItemRpt(reportId, t.report[reportId].sideId, t.report[reportId].side0TileLevel);
				        }
					if (ById("BOSyntheseAttack").checked && (rpt.marchType == 4 || rpt.marchType == 3))
					{
					    t.BOSyntheseAttack(reportId, t.report[reportId].sideId, 0);
					}

					if (rpt.marchType == 0)
						t.report[reportId].marchName = 'Desertion';
					else if (rpt.marchType == 1)
						t.report[reportId].marchName = 'Transport';
					else if (rpt.marchType == 2)
						t.report[reportId].marchName = 'Renfort';
					else if (rpt.marchType == 3 || rpt.marchType == 11) {
						if (t.report[reportId].sideId == 0)
							t.report[reportId].marchName = 'Contre-Ecl';
						else
							t.report[reportId].marchName = 'Eclaireur';
					} else if (rpt.marchType == 4) {
						if (t.report[reportId].sideId == 0)
							t.report[reportId].marchName = 'Defense';
						else
							t.report[reportId].marchName = 'Attaque';
					} else if (rpt.marchType == 10 || rpt.marchType == 9) {
					 t.report[reportId].marchName = 'Attaque';
					} else
						t.report[reportId].marchName = '?';
					t.data.push ({
						reportId: reportId,
					});
				}
			}
			if (parseInt(page)+1 <= t.maxPages && t.searchRunning) {
				ById("idRptStatus").innerHTML = uW.g_js_strings.commonstr.research + ' page ' + (parseInt(page)+1) + ' / ' + t.maxPages;
				setTimeout(function() { t.getRpt(parseInt(page)+1); } ,1000);
				if (t.data.length > 0)
					t.DisplayRpt();
			} else if (page) {

				if (ById("BOSyntheseAttack").checked) {
				 t.stopSearch ('<a id=BOresumeAT style="color:#ffaaaa" onclick="javascript:void(0);"><u>'+lang.Rpt.BOresumeAT+'</u></a>');
				 setTimeout(function() { ById("BOresumeAT").addEventListener ('click', t.AfficheResumeAtk, false);  }, 1000);
				} else {

				if (Options.rptType=='player') {
				 t.stopSearch ('<a id=BOresumeDF style="color:#ffaaaa" onclick="javascript:void(0);"><u>'+lang.Rpt.BOresumeDF+' '+uW.g_js_strings.commonstr.darkForest+'</u></a>');
				 setTimeout(function() {
				   ById("BOresumeDF").addEventListener ('click', t.AfficheResume, false);
				  }, 1000);
				 } else {
				  t.stopSearch (lang.Rpt.end);
				 }
				}
			}
		}
	},
	AfficheResumeAtk:function() {
	 var t = Tabs.Rpt;
	 var puipui=new Array();
	 var fortmight = {u53: "4",u55: "7",u60: "1",u61: "2",u62: "3",    };
	 for (y in uW.unitmight)
		 puipui.push(uW.unitmight[y]);
	 puipui[52] = fortmight['u53'];
	 puipui[54] = fortmight['u55'];
	 puipui[59] = fortmight['u60'];
	 puipui[60] = fortmight['u61'];
	 puipui[61] = fortmight['u62'];
	 var messageBody="";
	 reportsSearched = t.dataAT.length;
	 reportsFound = 0;
         var tr0=0,tr1=0,tr2=0,tr3=0,tr4=0,tr5=0;
	 if (reportsSearched>0) {
	  messageBody +='<br><table width=98%><thead><th>'+uW.g_js_strings.commonstr.player+'<br>'+uW.g_js_strings.commonstr.alliance+'</th><th><img src='+gameurl+'img/gold_30.png></th>\
	  <th><img src='+gameurl+'img/food_30.png></th><th><img src='+gameurl+'img/wood_30.png></th>\
	  <th><img src='+gameurl+'img/stone_30.png></th><th><img src='+gameurl+'img/iron_30.png></th>\
	  <th><img src='+gameurl+'img/aetherstone_30.png></th></thead><tbody>';
	  t.dataAT.sort(function(a, b){
		var sortA=a.nom,sortB=b.nom;
		if (sortA < sortB) return -1
		if (sortA > sortB) return 1
		return 0
	  });
	 var datartp = [];
	 var nbrp=0;
	 for (var i=0; i<reportsSearched;i++) {
	  var idrapport=t.dataAT[i].reportId;
	  if ((t.what == '' || (t.dataAT[i].nom.search(t.what, "i") != -1)  || (t.dataAT[i].alliance.search(t.what, "i") != -1))
	      && (t.whatNot == '' || (t.dataAT[i].nom.search(t.whatNot, "i") != -1 && t.dataAT[i].alliance.search(t.whatNot, "i") != -1)))
	  {

	   if (datartp[nbrp]==undefined) {
	     datartp[nbrp]=[];
	     datartp[nbrp].nom = t.dataAT[i].nom;
	     datartp[nbrp].alliance = t.dataAT[i].alliance;
	     datartp[nbrp].res0=0;
	     datartp[nbrp].res1=0;
	     datartp[nbrp].res2=0;
	     datartp[nbrp].res3=0;
	     datartp[nbrp].res4=0;
	     datartp[nbrp].res5=0;
	     for (var z=1;z<64;z++) {
	      datartp[nbrp]['s1unit'+z] =0;
	      datartp[nbrp]['s0unit'+z] =0;
	     }
	   }
	   if(datartp[nbrp].nom==t.dataAT[i].nom && datartp[nbrp].alliance==t.dataAT[i].alliance) {
	     datartp[nbrp].res0 += parseIntNan(t.reportAT[idrapport].res0);
	     datartp[nbrp].res1 += parseIntNan(t.reportAT[idrapport].res1);
	     datartp[nbrp].res2 += parseIntNan(t.reportAT[idrapport].res2);
	     datartp[nbrp].res3 += parseIntNan(t.reportAT[idrapport].res3);
	     datartp[nbrp].res4 += parseIntNan(t.reportAT[idrapport].res4);
	     datartp[nbrp].res5 += parseIntNan(t.reportAT[idrapport].res5);
	       for (var z=1;z<64;z++) {
	        datartp[nbrp]['s1unit'+z] += parseIntNan(t.reportAT[idrapport]['s1unit'+z]);
	        datartp[nbrp]['s0unit'+z] += parseIntNan(t.reportAT[idrapport]['s0unit'+z]);
	      }
	   } else {
	     nbrp++;
	     datartp[nbrp]=[];
	     datartp[nbrp].nom = t.dataAT[i].nom;
	     datartp[nbrp].alliance = t.dataAT[i].alliance;
	     datartp[nbrp].res0=0;
	     datartp[nbrp].res1=0;
	     datartp[nbrp].res2=0;
	     datartp[nbrp].res3=0;
	     datartp[nbrp].res4=0;
	     datartp[nbrp].res5=0;
	     datartp[nbrp].res0 += parseIntNan(t.reportAT[idrapport].res0);
	     datartp[nbrp].res1 += parseIntNan(t.reportAT[idrapport].res1);
	     datartp[nbrp].res2 += parseIntNan(t.reportAT[idrapport].res2);
	     datartp[nbrp].res3 += parseIntNan(t.reportAT[idrapport].res3);
	     datartp[nbrp].res4 += parseIntNan(t.reportAT[idrapport].res4);
	     datartp[nbrp].res5 += parseIntNan(t.reportAT[idrapport].res5);
	     for (var z=1;z<64;z++) {
	     	      datartp[nbrp]['s1unit'+z] =0;
	     	      datartp[nbrp]['s0unit'+z] =0;
	     	      datartp[nbrp]['s1unit'+z] += parseIntNan(t.reportAT[idrapport]['s1unit'+z]);
	     	      datartp[nbrp]['s0unit'+z] += parseIntNan(t.reportAT[idrapport]['s0unit'+z]);
	     }
	   }
	   }
	  }
	  reportsSearched = datartp.length;
	  var tres=[0,0,0,0,0,0];
	  var perts1=[];var perts0=[];
	  for (var z=1;z<64;z++) { perts1[z]=0;perts0[z]=0; }

	  for (var i=0; i<reportsSearched;i++) {
	   messageBody += '<tr><td>'+datartp[i].nom+'<br>'+datartp[i].alliance+'</td>';
	    for (var res=0;res<6;res++) {
	     messageBody += '</td><td align=right>';
	     var cb=0;
	     if (datartp[i]["res"+res] != undefined) {
	       cb=parseIntNan(datartp[i]["res"+res]);
	       tres[res]+=cb;
	     }
	     messageBody += addCommas(cb);
	    }
	    for (var z=1;z<64;z++) {
	     perts1[z]+=parseIntNan(datartp[i]['s1unit'+z]);
	     perts0[z]+=parseIntNan(datartp[i]['s0unit'+z]);
	    }
	  }
	  messageBody += '</td></tr><tr><td><b>'+lang.Rpt.sum+'</td>';
	  for (var res=0;res<6;res++) messageBody +='<td align=right><b>'+addCommas(tres[res])+'</b></td>';
	  messageBody += "</tr></table>";
	  messageBody += "<br><table><thead><th width=120><b>"+lang.Rpt.pertes+"</b></th>";
	  for (var z=1;z<64;z++) {
	    if (perts1[z]>0) {
	      messageBody +='<th width=6%><img height=20 src='+gameurl+'img/units/unit_'+z+'_30.jpg ';
	      if(z<18 && uW.unitcost['unt'+z])
	        messageBody +='title="'+uW.unitcost['unt'+z][0]+'"';
	      messageBody +='></th>';
	    }
	  }
	  messageBody +='<th></th></thead><tr><td>'+lang.Rpt.number+'</td>';
	  for (var z=1;z<64;z++) if (perts1[z]>0) messageBody +='<td align=right>'+ addCommas(perts1[z])+'</td>';
	  messageBody +='<td></td></tr><tr><td>'+uW.g_js_strings.commonstr.might+'</td>';
	  for (var z=1;z<64;z++) if (perts1[z]>0) messageBody +='<td align=right>'+ addCommas(parseIntNan(perts1[z])*parseIntNan(puipui[z-1]))+'</td>';
	  var to1=0;
	  messageBody +='<td></td></tr><tr><td>'+uW.g_js_strings.commonstr.might+' total</td>';
	  for (var z=1;z<64;z++) to1+=(parseIntNan(perts1[z])*parseIntNan(puipui[z-1]));
	  messageBody += "<td align=right><b>"+addCommas(to1)+"</b></td></tr><thead><th><b>"+lang.Rpt.pertes2+"</b></th>";
	  for (var z=1;z<64;z++) {
	   if (perts0[z]>0) {
	      messageBody +='<th width=6%><img height=20 src='+gameurl+'img/units/unit_'+z+'_30.jpg ';
	      if(z<14 && uW.unitcost['unt'+z])
	        messageBody +='title="'+uW.unitcost['unt'+z][0]+'"';
	      messageBody +='></th>';
	   }
	  }
	  messageBody +='<th></th></thead><tr><td>'+lang.Rpt.number+'</td>';
	  for (var z=1;z<64;z++) if (perts0[z]>0)messageBody +='<td align=right>'+ addCommas(parseIntNan(perts0[z]))+'</td>';
	  messageBody +='<td></td></tr><tr><td>'+uW.g_js_strings.commonstr.might+'</td>';

	  for (var z=1;z<64;z++) if (perts0[z]>0)messageBody +='<td align=right>'+ addCommas(parseIntNan(perts0[z])*parseIntNan(puipui[z-1]))+'</td>';
	  var to2=0;
	  messageBody +='</tr><tr><td>'+uW.g_js_strings.commonstr.might+' total</td>';
	  for (var z=1;z<64;z++) to2+= (parseIntNan(perts0[z])*parseIntNan(puipui[z-1]));
	  messageBody +="<td align=right><b>"+addCommas(to2)+"</b></td></tr></table><br>";

	  if (to1<to2)
	    messageBody += "<br><b>"+lang.Rpt.mes1+" <font color=#449944>"+addCommas((to2-to1))+"</font><br>";
	  if (to1==to2)
	    messageBody += "<br><b>"+lang.Rpt.mes2+"<br>";
	   if (to1>to2)
	    messageBody += "<br><b>"+lang.Rpt.mes1+" <font color=#994444>"+addCommas((to1-to2))+"</font><br>";

	 } else {
	  messageBody +="<br><center>"+lang.Rpt.err1+"<br>";
	 }
	 t.popRapportAT = new CPopup('pbRapportATBody', 0, 0, 770, 500, true, function() {clearTimeout (1000);});
	 t.popRapportAT.centerMe (mainPop.getMainDiv());
	 var m = '<DIV style="max-height:455px; height:455px; overflow-y:scroll">';
	 m+= messageBody + '</div>';
	 t.popRapportAT.getMainDiv().innerHTML = m;
	 t.popRapportAT.getTopDiv().innerHTML = '<DIV align=center><B>'+lang.Rpt.title1+'</B></DIV>';
	 t.popRapportAT.show(true);
	},
	AfficheResume:function() {
	 var t = Tabs.Rpt;
	 var messageBody="";
	 if (t.reportDF.length>0) {
	  messageBody +='<br><center><table width=60%><thead><th colspan=2>'+lang.Rpt.itemfind+'</th><th>Qte</th></thead><tbody>';
	for (var i in t.reportDF) {
	 var rpt =  t.reportDF[i];
     if (uW.ksoItems[i])
	  messageBody += '<tr><td><img width=30 src='+gameurl+'img/items/70/' + i + '.jpg></td><td>'+uW.ksoItems[i].name+'</td><td>'+rpt.qte+'</td></tr>';
	}
	messageBody += "</tbody></table>";
	} else {
	messageBody +="<br><center>"+lang.Rpt.noitem+"<br>";
	}

	messageBody +='<br><input type=button class=pbButton value="'+lang.Rpt.BODelAllDF+'" id=BODelAllDF></center>';


	t.popRapportDF = new CPopup('pbRapportDFBody', 0, 0, 500, 405, true, function() {clearTimeout (1000);});
	t.popRapportDF.centerMe (mainPop.getMainDiv());

	var m = '<DIV style="max-height:365px; height:4365px; overflow-y:scroll">';
	m+= messageBody + '</div>';
	t.popRapportDF.getMainDiv().innerHTML = m;
	t.popRapportDF.getTopDiv().innerHTML = '<DIV align=center><B>'+lang.Rpt.title_popRapportDF+' '+uW.g_js_strings.commonstr.darkForest+'</B></DIV>';
	t.popRapportDF.show(true);
	ById('BODelAllDF').addEventListener ('click', t.DeleteRptDF, false);

	},
	pagesasup:0,
	DeleteRptDF:function() {
	 var t = Tabs.Rpt;
	 t.pagesasup = 0;
	 t.fetchreport(0, t.checkreports);
	 t.popRapportDF.show(false);
	 t.popRapportDF.destroy();
	 t.popRapportDF = null;
	},
	 fetchreport : function(pageNo, callback){
		var t =  Tabs.Rpt;
		 if (t.pagesasup>=t.maxPages) return;
			var params = uW.Object.clone(uW.g_ajaxparams);
			if(pageNo > 1)
				params.pageNo = pageNo;
			new MyAjaxRequest(uW.g_ajaxpath + "ajax/listReports.php" + uW.g_ajaxsuffix, {
				method: "post",
				parameters: params,
				onSuccess: function (rslt) {
				        t.pagesasup++;
					callback(rslt);
				},
					onFailure: function () {
					t.pagesasup++;
					callback();
				},
			});
	    },

	    checkreports : function(rslt){
			var t = Tabs.Rpt;
			if(!rslt.ok){
				return;
			}
			if(rslt.arReports.length < 1){
				return;
			}
			var reports = rslt.arReports;
			var totalPages = rslt.totalPages;
			var deletes1 = new Array();
			for(k in reports){
					if(reports[k].side0TileType==54)
						deletes1.push(k.substr(2));

			}
			if(deletes1.length > 0 ){
				t.deleteCheckedReports(deletes1);
			} else {

				return;
			}
	    },
    	deleteCheckedReports : function(deletes1){
    		var t =  Tabs.Rpt;
    		var params = uW.Object.clone(uW.g_ajaxparams);
    		params.s1rids = deletes1.join(",");
    		params.cityrids = '';
    		new MyAjaxRequest(uW.g_ajaxpath + "ajax/deleteCheckedReports.php" + uW.g_ajaxsuffix, {
    			method: "post",
    			parameters: params,
    			onSuccess: function (rslt) {
    				if(rslt.ok){
    					Seed.newReportCount = parseInt(Seed.newReportCount) - parseInt(deletes1.length);
    				}
    				t.fetchreport(0, t.checkreports);
    				t.DisplayRpt();
    			},
    			onFailure: function () {
    			},
    		});
    },
    BOSyntheseAttack:function(reportId, sideId, lvl) {

     var t = Tabs.Rpt;
     var rpt = t.report[reportId];
     var params = uW.Object.clone(uW.g_ajaxparams);
     	  params.rid=reportId;
	  params.side=sideId;
     if (params.side > -1) {
     	   new AjaxRequest(uW.g_ajaxpath+"ajax/fetchReport.php"+uW.g_ajaxsuffix, {  method:"post",  parameters:params,

     	   onSuccess:function(msg){
     		var rslt = eval("(" + msg.responseText + ")");
     		t.dataAT.push ({reportId: reportId, nom:rpt.side0Name, alliance:rpt.side0AllianceName});
     		t.reportAT[reportId] = [];
     		t.reportAT[reportId].nom = rpt.side0Name;
     		t.reportAT[reportId].alliance = rpt.side0AllianceName;
     		t.reportAT[reportId].res0=0;
     		t.reportAT[reportId].res1=0;
     		t.reportAT[reportId].res2=0;
     		t.reportAT[reportId].res3=0;
     		t.reportAT[reportId].res4=0;
     		t.reportAT[reportId].res5=0;
     		if (rslt.loot) {
     		 if (rslt['loot'][0] !== undefined) t.reportAT[reportId].res0=rslt['loot'][0];
     		 if (rslt['loot'][1] !== undefined) t.reportAT[reportId].res1=rslt['loot'][1];
     		 if (rslt['loot'][2] !== undefined) t.reportAT[reportId].res2=rslt['loot'][2];
     		 if (rslt['loot'][3] !== undefined) t.reportAT[reportId].res3=rslt['loot'][3];
     		 if (rslt['loot'][4] !== undefined) t.reportAT[reportId].res4=rslt['loot'][4];
     		 if (rslt['loot'][6] !== undefined) t.reportAT[reportId].res5=rslt['loot'][6];
     	        }
     	        if (sideId==0) {
     	         for (var zz=0;zz<6;zz++)
     	            t.reportAT[reportId]["res"+zz] = t.reportAT[reportId]["res"+zz] *-1;
     	        }
     	        if (rslt['fght'] != undefined){
     	        	if (rslt['fght']["s1"] != undefined) {
     				var i=0;
	   				for (y in uW.unitcost) {
				i++;
					if (rslt['fght']["s1"]['u'+i] != undefined) {
						if (sideId==1) t.reportAT[reportId]['s1unit'+i]=rslt['fght']["s1"]['u'+i][0] - rslt['fght']["s1"]['u'+i][1];
						else t.reportAT[reportId]['s0unit'+i]=rslt['fght']["s1"]['u'+i][0] - rslt['fght']["s1"]['u'+i][1];

					}else{
					 	if (sideId==1) t.reportAT[reportId]['s1unit'+i]=0;
						else t.reportAT[reportId]['s0unit'+i]=0;
					}
				}
				for (var i=53;i<=55;i++) {
					if (rslt['fght']["s1"]['f'+i] != undefined) {
						if (sideId==1) t.reportAT[reportId]['s1unit'+i] = rslt['fght']["s1"]['f'+i][0] - rslt['fght']["s1"]['f'+i][1];
						else t.reportAT[reportId]['s0unit'+i] = rslt['fght']["s1"]['f'+i][0] - rslt['fght']["s1"]['f'+i][1];

			 		}else{
			 			if (sideId==1) t.reportAT[reportId]['s1unit'+i]=0;
			 			else t.reportAT[reportId]['s0unit'+i]=0;
					}
			 	}
		 		for (var i=60;i<=63;i++) {
					if (rslt['fght']["s1"]['f'+i] != undefined) {
						if (sideId==1) t.reportAT[reportId]['s1unit'+i] = rslt['fght']["s1"]['f'+i][0] - rslt['fght']["s1"]['f'+i][1];
						else t.reportAT[reportId]['s0unit'+i] = rslt['fght']["s1"]['f'+i][0] - rslt['fght']["s1"]['f'+i][1];

					}else{
			 			if (sideId==1) t.reportAT[reportId]['s1unit'+i]=0;
			 			else t.reportAT[reportId]['s0unit'+i]=0;
					}
			 	}
		 	}
     	         	if (rslt['fght']["s0"] != undefined) {
     	         					var i=0;
					  				for (y in uW.unitcost) {
				i++;
					if (rslt['fght']["s0"]['u'+i] != undefined) {
					  if (sideId==1) {
					   t.reportAT[reportId]['s0unit'+i]=rslt['fght']["s0"]['u'+i][0] - rslt['fght']["s0"]['u'+i][1];
					  }else{
					    t.reportAT[reportId]['s1unit'+i]=rslt['fght']["s0"]['u'+i][0] - rslt['fght']["s0"]['u'+i][1];
					  }
					} else {
					 if (sideId==1) {
					  t.reportAT[reportId]['s0unit'+i]=0;
					 } else {
					   t.reportAT[reportId]['s1unit'+i]=0;
					 }
					}
				}
     	         		for (var i=53;i<=55;i++) {
		 			if (rslt['fght']["s0"]['f'+i] != undefined) {
		 				if (sideId==1) {
		 					t.reportAT[reportId]['s0unit'+i] = rslt['fght']["s0"]['f'+i][0] - rslt['fght']["s0"]['f'+i][1];
		 				} else {
		 					t.reportAT[reportId]['s1unit'+i] = rslt['fght']["s0"]['f'+i][0] - rslt['fght']["s0"]['f'+i][1];
		 				}
		 			}else{
						if (sideId==1) t.reportAT[reportId]['s0unit'+i]=0;
						else t.reportAT[reportId]['s1unit'+i]=0;
					}
			 	}
		 		for (var i=60;i<=63;i++) {
		 			if (rslt['fght']["s0"]['f'+i] != undefined) {
		 				if (sideId==1) {
		 					t.reportAT[reportId]['s0unit'+i] = rslt['fght']["s0"]['f'+i][0] - rslt['fght']["s0"]['f'+i][1];
		 				} else {
		 					t.reportAT[reportId]['s1unit'+i] = rslt['fght']["s0"]['f'+i][0] - rslt['fght']["s0"]['f'+i][1];
		 				}
		 			}else{
			 			if (sideId==1) {
			 					t.reportAT[reportId]['s0unit'+i]=0;
			 				} else {
			 					t.reportAT[reportId]['s1unit'+i]=0;
						}
			 		}
		 		}
			}
     	        }

        } });
      }
    },
    FindItemRpt:function(reportId, sideId, lvl) {
	  var t = Tabs.Rpt;
	  var params = uW.Object.clone(uW.g_ajaxparams);
	  params.rid=reportId;
	  params.side=sideId;
	  if (params.side > -1) {
	   new AjaxRequest(uW.g_ajaxpath+"ajax/fetchReport.php"+uW.g_ajaxsuffix, {  method:"post",  parameters:params,
	   onSuccess:function(msg){
		var rslt = eval("(" + msg.responseText + ")");
		if (rslt.loot) {
			if (rslt['loot'][5] !== undefined) {
				var q=uW.Object.keys(rslt['loot'][5]);
				var zz=rslt['loot'][5];
				for (var tt in zz) {
					var zzz=rslt['loot'][5][tt];
					C=tt;
					if (uW.ksoItems[C]!==undefined) {
					if (!t.reportDF[C]){
						t.reportDF[C] = [];
						 t.reportDF[C].qte=0;
					 }
					 t.reportDF[C].c=C;
			 		 t.reportDF[C].qte= t.reportDF[C].qte + parseInt(zzz);
				   }
				}


			 }}}
            });
          }

	},
	DisplayMail: function (){
		var t = Tabs.Rpt;
		var results = ById("idBoRptResultsDiv");
		if(!t.data.length) {
			results.innerHTML = '<center>'+lang.Rpt.noresult+'</center>';
			return;
		}
		reportsSearched = t.data.length;
		reportsFound = 0;
		t.content = '';
		for (var i=0; i<reportsSearched;i++) {
			var rpt = t.data[i];
			if ((t.what == '' || (rpt.subject.search(t.what, "i") != -1) || (rpt.displayName.search(t.what, "i") != -1))
				&& (t.whatNot == '' || ((rpt.subject.search(t.whatNot, "i") == -1) && (rpt.displayName.search(t.whatNot, "i") == -1)))) {
				if (rpt.subject == '')
					rpt.subject = lang.Rpt.nosubject;
				reportsFound++;
				if (reportsFound == 1)
					t.content += '<center><table width=97%><thead><th>P</th><th>Date</th><th>De</th><th>Sujet</th><th>X</th></thead><tbody>';
				var stylee="";
				if (rpt.messageRead==0) stylee=' style="background-color:#CCCCCC;"';
				t.content += '<tr><td align=right '+stylee+'>'+rpt.page+'</td><td '+stylee+'>'+rpt.dateSent+'</td><td '+stylee+'>'+rpt.displayName+'</td>';
				t.content += '<td '+stylee+'><A><SPAN onclick="getmsg('+ rpt.messageId +')">' + rpt.subject + '</SPAN></a></td><td><a onclick="DelMail('+ rpt.messageId +');"><img src="'+CANCELBTN+'" border=0 title="Supprimer ce message"></a></td></tr>';
			}
		}
		if (reportsFound > 1)
			t.content += '</tbody></table></center>';
		if (reportsFound == 0 && reportsSearched > 0)
			t.content = '<center>'+lang.Rpt.noresult+'</center>';
		results.innerHTML = t.content;
		ById("idRptSearched").innerHTML = '&nbsp'+lang.Rpt.result+' ' + reportsSearched;
		ById("idRptFound").innerHTML = lang.Rpt.found+' ' + reportsFound;
	},

	getMailBody: function(ID,dataI){
		var t = Tabs.Rpt;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.messageId=ID;
		params.requestType="GET_MESSAGE_FOR_ID";

		new MyAjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			onSuccess: function (rslt) {
				if (rslt.ok)
					t.displayMailBody(rslt.messageBody, ID);
			},
			onFailure: function () {},
		}, false);
	},

	displayMailBody: function (messageBody, ID) {
		var t = Tabs.Rpt;
		if (t.popMsg == null) {
		  t.popMsg = new CPopup('pbMailBody', 0, 0, 670, 500, true, function() {clearTimeout (1000);});
		  t.popMsg.centerMe (mainPop.getMainDiv());
		}
		messageBody=messageBody.replace(/custom-line-break/g,"<br>");
		var m = '<DIV style="max-height:465px; height:465px; overflow-y:scroll"><br><hr>';
		m+= messageBody + '<hr><a onclick="DelMail('+ ID +');"><img src="'+CANCELBTN+'" border=0 title="Supprimer ce message">'+lang.General.delete+'</a><br></div>';
		t.popMsg.getMainDiv().innerHTML = m;
		t.popMsg.getTopDiv().innerHTML = '<DIV align=center><B>Messagerie</B></DIV>';
		t.popMsg.show(true);
	},

	DisplayRpt: function (){
		var t = Tabs.Rpt;
		var results = ById("idBoRptResultsDiv");
		if(!t.data.length) {
			results.innerHTML = '<center>'+lang.Rpt.noresult+'</center>';
			return;
		}
		var myAllianceId = parseInt(getMyAlliance()[0]);
		reportsSearched = t.data.length;
		reportsFound = 0;
		t.content = '';
		for (var i=0; i<reportsSearched;i++) {
			var reportId = t.data[i].reportId;
			var rpt = t.report[reportId];
			if ((rpt.side0Name=='undefined') && (rpt.marchName != 'Desertion'))
				continue;
			if ((((myAllianceId == parseInt(rpt.side1AllianceId) && Options.arAttacker != 'Them')
				|| (myAllianceId != parseInt(rpt.side1AllianceId) && Options.arAttacker != 'Us')
				|| Options.arAttacker == 'Both')
				&& ((myAllianceId == parseInt(rpt.side0AllianceId) && Options.arTarget != 'Them')
				|| (myAllianceId != parseInt(rpt.side0AllianceId) && Options.arTarget != 'Us')
				|| Options.arTarget == 'Both')
				&& ((Options.arAttack && (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense'))
				|| (Options.arScout && (rpt.marchName == 'Contre-Ecl' || rpt.marchName == 'Eclaireur'))
				|| (Options.arReinforce && rpt.marchName == 'Renfort')
				|| (Options.arTransport && rpt.marchName == 'Transport')))
				|| (rpt.marchName == 'Desertion')) {
				if (((t.what == ''
					|| (rpt.side1Name.search(t.what, "i") != -1)
					|| (rpt.side1AllianceName.search(t.what, "i") != -1)
					|| (rpt.side0Name.search(t.what, "i") != -1)
					|| (rpt.side0AllianceName.search(t.what, "i") != -1)
					|| (rpt.side0TileTypeText.search(t.what, "i") != -1))
					&& (t.whatNot == ''
					|| ((rpt.side1Name.search(t.whatNot, "i") == -1)
					&& (rpt.side1AllianceName.search(t.whatNot, "i") == -1)
					&& (rpt.side0Name.search(t.whatNot, "i") == -1)
					&& (rpt.side0AllianceName.search(t.whatNot, "i") == -1)
					&& (rpt.side0TileTypeText.search(t.whatNot, "i") == -1))))
					|| (rpt.marchName == 'Desertion')) {

					if ((ById("idRptFiltre1").value=="") ||   (rpt.side0TileType==54 && ById("idRptFiltre1").value==54)  ||
					    (rpt.side0TileType>0 && rpt.side0TileType<51 && ById("idRptFiltre1").value==0)) {


					reportsFound++;
					if (reportsFound == 1) {
						t.content += '<center><table class=ptTabOverview width=100% cellspacing=0 cellpadding=3><thead><th>P</th><th>R.</th><th>Date</th><th>'+uW.g_js_strings.commonstr.attacker+'</th><th>De</th>';
						if (Options.arAttacker != 'Us')
							t.content += '<th>Alliance</th>';
						t.content += '<th>Action</th><th>'+uW.g_js_strings.commonstr.target+'</th><th>A</th>';
						if (Options.arTarget != 'Us')
							t.content += '<th>Alliance</th>';
						t.content += '<th>Type</th><th><span title="Ville la plus proche">VP</span></th><th><span title="Distance de la ville la plus proche">D</span></th></thead><tbody>';
					}


					var closestDist=999999;
					var closestLoc=null;
					var closestNum=1;
					for (var c=0; c<Cities.numCities; c++){
						var city = Cities.cities[c];
						var dist=distance(city.x,city.y,rpt.side0XCoord,rpt.side0YCoord);
						if(dist<closestDist) {
							closestDist=dist;
							closestLoc=city.x +','+ city.y;
							closestNum=c+1;
						}
					}
					if (rpt.marchName == 'Contre-Ecl' || rpt.marchName == 'Defense')
					 style=' style="background-color:#EF9999;"';
					else if (rpt.marchName == 'Renfort')
					 style=' style="background-color:#99EF99;"';
					else
					 style="";
					t.content += '<tr id="BOrpt'+ reportId +'"><td align=right '+style+'>'+rpt.page+'</td><td  align=right '+style+'><a onclick="getReport('+ reportId+')"><img  border=0 src="'+SEARCHBTN+'"></a>';
					 if (rpt.side0Name==Seed.player.name || rpt.side1Name==Seed.player.name) {
					         t.content +='&nbsp;<a onclick="DelReport('+ reportId +', false);document.getElementById(\'BOrpt'+ reportId +'\').style.display=\'none\';"><img src="'+CANCELBTN+'" border=0 title="Supprimer mon rapport"></a>';
        					}
					t.content += '</td><td '+style+'>'+formatUnixTime(rpt.reportUnixTime,'24hour')+'</td>';
					if (rpt.marchName == 'Desertion') {
						t.content += '<td '+style+'></td><td '+style+'></td>';
						if (Options.arAttacker != 'Us')
							t.content += '<td '+style+'></td>';
						t.content += '<td '+style+'>'+rpt.marchName+'</td><td '+style+'></td><td '+style+'></td><td '+style+'></td>';
						if (Options.arAttacker != 'Us')
							t.content += '<td '+style+'></td>';
						t.content += '<td '+style+'></td><td '+style+'></td>';
						} else {
						t.content += '<td '+style+'><span title="'+rpt.side1Name+'"><a onclick=boshowthrone('+rpt.side1PlayerId+',"'+rpt.side1Name+'","Calc");>'+rpt.side1Name.substring(0,12)+'</a></span></td><td align=center '+style+'><a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side1XCoord +','+ rpt.side1YCoord +')</a></td>';
						if (Options.arAttacker != 'Us')
						t.content += '<td '+style+'><span title="'+rpt.side1AllianceName+'">'+rpt.side1AllianceName.substring(0,17)+'</span></td>';
						            if (rpt.marchName == 'Contre-Ecl' || rpt.marchName == 'Eclaireur')
						             t.content += '<TD '+style+'><FONT color="FF8822">'+rpt.marchName+'</font></td>';
							    else if (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense')
							     t.content += '<TD '+style+'><FONT color="FF1122">'+rpt.marchName+'</font></td>';
							    else if (rpt.marchName == 'Renfort')
	      					 	     t.content += '<TD '+style+'><FONT color="339933">'+rpt.marchName+'</font></td>';
	      					 	    else
	      					 	     t.content += '<TD '+style+'>'+rpt.marchName+'</td>';
						t.content += '<td '+style+'><span title="'+rpt.side0Name+'"><a onclick=boshowthrone('+rpt.side0PlayerId+',"'+rpt.side0Name+'","Calc");>'+rpt.side0Name.substring(0,12)+'</a></span></td>';
						t.content += '<td align=center '+style+'><a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side0XCoord +','+ rpt.side0YCoord +')</a>';
						if (rpt.side0CityId!=0) {
							if (parseIntNan(Options.alertConfig.hq)>0) {
								if (parseIntNan(Options.alertConfig.hq)==rpt.side0CityId)
								 t.content += '<b>';
							}
							if (Cities.byID[rpt.side0CityId])
							t.content += '<br>'+Cities.byID[rpt.side0CityId].name;
						}
						t.content +='</td>';
						if (Options.arTarget != 'Us')
							t.content += '<td '+style+'><span title="'+rpt.side0AllianceName+'">'+rpt.side0AllianceName.substring(0,17)+'</span></td>';
						t.content += '<td '+style+'>'+rpt.side0TileTypeLevel+'</td><td align=center '+style+'><A onclick=\"citysel_click(document.getElementById(\'citysel_'+ (closestNum)+'\'));\">' + closestLoc + '</a></td><td align=right '+style+'>'+Math.floor(closestDist)+'</td></tr>';
					}
				}
				}
			}
		}
		if (reportsFound > 1)
			t.content += '</tbody></table></center>';
		if (reportsFound == 0 && reportsSearched > 0)
			t.content = '<center>'+lang.Rpt.noresult+'</center>';
		results.innerHTML = t.content;
		ById("idRptSearched").innerHTML = lang.Rpt.result+' ' + reportsSearched;
		ById("idRptFound").innerHTML = lang.Rpt.found+' ' + reportsFound;
	},

	getReportBody: function(reportId){
		var t = Tabs.Rpt;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.rid=reportId;
		params.side=t.report[reportId].sideId;
		if (params.side > -1) {
			new MyAjaxRequest(uW.g_ajaxpath + "ajax/fetchReport.php" + uW.g_ajaxsuffix, {
				method: "post",
				parameters: params,
				onSuccess: function (rslt) {
					t.displayReportBody(rslt,reportId);
				},
				onFailure: function (rslt) {},
			}, false);
		} else {

		}
	},

	displayReportBody: function (rslt, reportId) {
		var t = Tabs.Rpt;
		var popReport = null;
		var rpt = t.report[reportId];
		var m = '';
		var fortmight = {u53: "4",u55: "7",u60: "1",u61: "2",u62: "3",    };
		var unitImg = [];
		var puipui=new Array();
		for (y in uW.unitmight)
		 puipui.push(uW.unitmight[y]);
		puipui[53] = fortmight['u53'];
		puipui[55] = fortmight['u55'];
		puipui[60] = fortmight['u60'];
		puipui[61] = fortmight['u61'];
		puipui[62] = fortmight['u62'];
		ordre_grandeur=0;
		delta_perte=0;
		var perte_atk = 0;
		var perte_def = 0,i=0;
		for (y in uW.unitcost) {
			i++
			unitImg[i] = '<img height=20 src='+gameurl+'img/units/unit_'+i+'_30.jpg title="'+uW.unitcost[y][0]+'"></TD><TD>' + uW.unitcost[y][0].substr(0,15);
	    }
		for (var i=101;i<111;i++)
		 unitImg[i] = '<img height=20 src='+gameurl+'img/units/unit_'+i+'_30.jpg title="'+uW.g_js_strings.monsterUnitsNames['m'+i]+'"></TD><TD>' + uW.g_js_strings.monsterUnitsNames['m'+i].substr(0,15);
	    unitImg[53] = '<img height=20 src='+gameurl+'img/units/unit_53_30.png></TD><TD>'+ uW.fortcost.frt53[0].substr(0,20);
		unitImg[55] = '<img height=20 src='+gameurl+'img/units/unit_55_30.png></TD><TD>'+ uW.fortcost.frt55[0].substr(0,20);
		unitImg[60] = '<img height=20 src='+gameurl+'img/units/unit_60_30.png></TD><TD>'+ uW.fortcost.frt60[0].substr(0,20);
		unitImg[61] = '<img height=20 src='+gameurl+'img/units/unit_61_30.png></TD><TD>'+ uW.fortcost.frt61[0].substr(0,20);
		unitImg[62] = '<img height=20 src='+gameurl+'img/units/unit_62_30.png></TD><TD>' + uW.fortcost.frt62[0].substr(0,20);
		goldImg = '<img src='+gameurl+'img/gold_30.png></TD><TD>' + uW.g_js_strings.commonstr.gold;
		foodImg = '<img src='+gameurl+'img/food_30.png></TD><TD>' + uW.g_js_strings.commonstr.food;
		woodImg = '<img src='+gameurl+'img/wood_30.png></TD><TD>' + uW.g_js_strings.commonstr.wood;
		stoneImg = '<img src='+gameurl+'img/stone_30.png></TD><TD>' + uW.g_js_strings.commonstr.stone;
		oreImg = '<img src='+gameurl+'img/iron_30.png></TD><TD>' + uW.g_js_strings.commonstr.ore;
		aetherstoneImg = '<img src='+gameurl+'img/aetherstone_30.png></TD><TD>'+ uW.g_js_strings.commonstr.aetherstone;

		function buildHeader () {
			var h='<TABLE class=ptTab width=100%>';
			h+='<TR valign=top><TD align=left width=10%><B>';
			if (rpt.marchName == 'Contre-Ecl')
			 h+=uW.g_js_strings.commonstr.location+" " + uW.g_js_strings.modal_messages_viewreports_view.antiscoutingat+' ';
			else if (rpt.marchName == 'Eclaireur')
				h+=uW.g_js_strings.modal_messages_viewreports_view.scoutrpt+' ';
			else if (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense')
				h+=uW.g_js_strings.modal_messages_viewreports_view.battleat+' ';

			else if (rpt.marchName == 'Renfort' || rpt.marchName == 'Transport')
				h+=rpt.marchName+' depuis<BR />'+rpt.marchName+' vers</B>';
			else if (rpt.marchName == 'Transport')
			  h+=rpt.marchName+' depuis<BR />'+uW.g_js_strings.modal_messages_viewreports_view.transpto+'</B>';
			if (rpt.side0TileTypeText == 'Barb')
				h+=' Camp Barbare '+uW.g_js_strings.commonstr.level+' ' + rpt.side0TileLevel;
			else if (rpt.side0TileTypeText != 'Ville')
				h+=' '+rpt.side0TileTypeText+' '+uW.g_js_strings.commonstr.level+' '+ rpt.side0TileLevel+' ';
			h+='</B>';
			if (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense' || rpt.marchName == 'Contre-Ecl' || rpt.marchName == 'Eclaireur')
			 if (rslt['displayGlory']!==undefined)
			   h+='<br><B>'+uW.g_js_strings.commonstr.glory+' : <font color=red>'+rslt['glory']+'</font></B>';

			h+='</td>';
			if (rpt.marchName == 'Renfort' || rpt.marchName == 'Transport') {
				h+='<TD align=left width=1%>';
				if (Seed.player.name != rpt.side1Name)
					h+=rpt.side1Name;
				if (Seed.player.name != rpt.side0Name)
					h+='<BR />'+rpt.side0Name;
				h+='</TD>';
			}
			h+='<TD align=left width=5%>';

			if (rpt.marchName == 'Renfort' || rpt.marchName == 'Transport')
				h+='<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side1XCoord +','+ rpt.side1YCoord +')</a><BR />';
			h+='<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side0XCoord +','+ rpt.side0YCoord +')</a></TD>';

			if (rpt.side0TileTypeText != 'Ville' && rpt.side0TileTypeText != 'Barb' && (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense')) {
				if (rslt['conquered']==1)
					h+='<TD><FONT color="#CC0000"><B>'+uW.g_js_strings.commonstr.conquered+'</B></font></td>';
				else if (rslt['conquered']==0)
					h+='<TD><FONT color="#66CC33"><B>S&eacute;curis&eacute;</B></font></td>';
			} else if (rpt.marchName == 'Renfort' || rpt.marchName == 'Transport') {
				if (rpt.side1CityName) h+='<TD align=left width=5%>'+rpt.side1CityName+'<BR />';
				if (rpt.side0CityName)
					h+=rpt.side0CityName+'</TD>';
				else
					h+=rpt.side0TileTypeText+' Niv '+ rpt.side0TileLevel+'</TD>';
			}

			h+='<TD align=right>' + formatUnixTime(rpt.reportUnixTime,'24hour') + '<BR />&nbsp;';
			if (rpt.side0Name==Seed.player.name || rpt.side1Name==Seed.player.name) {
			  h+='-<a onclick="DelReport('+ reportId +', false);document.getElementById(\'BOrpt'+ reportId +'\').style.display=\'none\';document.getElementById(\'pbShowOther_X\').click();"><img src="'+CANCELBTN+'" border=0 title="Supprimer mon rapport"></a>';
		   	  if (parseIntNan(rpt.side0PlayerId)==0)
		   	    h+='&nbsp;'+uW.g_js_strings.modal_messages_viewreports_view.reportno+' ' + reportId + '</TD></TR></TABLE>';
		   	   else
		   	    h+='&nbsp;<a id=BOSendtoTchat href="javascript:void(0)">'+uW.g_js_strings.modal_messages_viewreports_view.reportno+' ' + reportId + '</a></TD></TR></TABLE>';
		    } else
			h+='&nbsp;<a id=BOSendtoTchat href="javascript:void(0)">'+uW.g_js_strings.modal_messages_viewreports_view.reportno+' ' + reportId + '</a></TD></TR></TABLE>';
			return h;
		}

		function handleunts () {
			var hunts = '', th = '', tc = '', tf = '';
			if (rslt['unts'] != undefined) {
				if (rpt.marchName == 'Renfort')
					th='<TABLE class=ptTab><TR><TH colspan=3 align=left>Renforts Envoy&eacute;s</TH></TR>';
				else if (rslt['unts']['u1'] != undefined || rslt['unts']['u2'] != undefined || rslt['unts']['u3'] != undefined || rslt['unts']['u4'] != undefined || rslt['unts']['u5'] != undefined || rslt['unts']['u6'] != undefined || rslt['unts']['u7'] != undefined || rslt['unts']['u8'] != undefined || rslt['unts']['u9'] != undefined || rslt['unts']['u10'] != undefined || rslt['unts']['u11'] != undefined || rslt['unts']['u12'] != undefined)
					th='<TABLE class=ptTab><TR><TH colspan=3 align=left>'+uW.g_js_strings.commonstr.troops+'</TH></TR>';
							var i=0;
			  				for (y in uW.unitcost) {
				i++;
					if (rslt['unts']['u'+i] != undefined)
						tc+='<TR><TD>' + unitImg[i] + '</TD><TD align=right>'+addCommas(rslt['unts']['u'+i])+'</TD></TR>';
			    }
				tf='</TABLE>';
			}
			if (tc != '')
				hunts = th + tc + tf;
			return hunts;
		}

		function handlersc () {
			var hrsc = '', th = '', tc = '', tf = '';
			if (rslt['rsc'] != undefined) {
				if (rslt['rsc']['r1'] > 0 || rslt['rsc']['r2'] > 0 || rslt['rsc']['r3'] > 0 || rslt['rsc']['r4'] > 0) {
					if (rpt.marchName == 'Renfort')
						th='<TABLE class=ptTab><TR><TH colspan=3 align=left>'+uW.g_js_strings.commonstr.resources+'</TH></TR>';
					else {
						th='<TABLE class=ptTab><TR><TH colspan=3 align=left>'+uW.g_js_strings.commonstr.resources+'</TH></TR>';
						if (rslt['gld'] > 0)
							tc+='<TR><TD>'+goldImg+'</TD><TD align=right>'+addCommasInt(rslt['gld'])+'</TD></TR>';
					}
					if (rslt['rsc']['r1'] > 0)
						tc+='<TR><TD>'+foodImg+'</TD><TD align=right>'+addCommasInt(rslt['rsc']['r1'])+'</TD></TR>';
					if (rslt['rsc']['r2'] > 0)
						tc+='<TR><TD>'+woodImg+'</TD><TD align=right>'+addCommasInt(rslt['rsc']['r2'])+'</TD></TR>';
					if (rslt['rsc']['r3'] > 0)
						tc+='<TR><TD>'+stoneImg+'</TD><TD align=right>'+addCommasInt(rslt['rsc']['r3'])+'</TD></TR>';
					if (rslt['rsc']['r4'] > 0)
						tc+='<TR><TD>'+oreImg+'</TD><TD align=right>'+addCommasInt(rslt['rsc']['r4'])+'</TD></TR>';
					tf='</TABLE>';
				}
			}
			if (tc != '')
				hrsc = th + tc + tf;
			return hrsc;
		}

		function handlefrt () {
			var hfrt = '', th = '', tc = '', tf = '';
			if (rslt['frt'] != undefined) {
				if (rslt['frt']['f53'] != undefined || rslt['frt']['f55'] != undefined || rslt['frt']['f60'] != undefined || rslt['frt']['f61'] != undefined || rslt['frt']['f62'] != undefined) {
					th='<TABLE class=ptTab><TR><TH colspan=3 align=left>'+uW.g_js_strings.modal_openWalls.walldef+'</TH></TR>';
					if (rslt['frt']['f53'] != undefined)
						tc+='<TR><TD>' + unitImg[53] + '</TD><TD align=right>'+addCommas(rslt['frt']['f53'])+'</TD></TR>';
					if (rslt['frt']['f55'] != undefined)
						tc+='<TR><TD>' + unitImg[55] + '</TD><TD align=right>'+addCommas(rslt['frt']['f55'])+'</TD></TR>';
					if (rslt['frt']['f60'] != undefined)
						tc+='<TR><TD>' + unitImg[60] + '</TD><TD align=right>'+addCommas(rslt['frt']['f60'])+'</TD></TR>';
					if (rslt['frt']['f61'] != undefined)
						tc+='<TR><TD>' + unitImg[61] + '</TD><TD align=right>'+addCommas(rslt['frt']['f61'])+'</TD></TR>';
					if (rslt['frt']['f62'] != undefined)
						tc+='<TR><TD>' + unitImg[62] + '</TD><TD align=right>'+addCommas(rslt['frt']['f62'])+'</TD></TR>';
					tf='</TABLE>';
				}
			}
			if (tc != '')
				hfrt = th + tc + tf;
			return hfrt;
		}

		function handleblds (bType) {
		     if (rslt['blds'] != undefined) {

			var blds = rslt['blds']['b'+bType];
			var couleur='';
			if (bType==8) couleur=' style="background-color:red"';
			b = '<TR><TD '+couleur+'>'; arField = [], firstbld = true;
			b+=uW.buildingcost["bdg"+bType][0]+'</TD><TD '+couleur+'>';
			for (var i=1; i<13; i++)
				arField[i]=0;
			for (var i=0; i < blds.length; i++)
				arField[blds[i]]++
			for (var i=11; i>0; i--) {
				if (arField[i] > 0) {
					if (firstbld)
						firstbld = false;
					else
						b+=', ';
					if (arField[i] > 1)
						b+=arField[i] + ' x ';
					b+=' ' + i;
				}
			}
			b+='</TD></TR>';
		       } else {
		        b='';
		       }
		       return b;
		}
		t.popReport=null;
    	if (t.popReport == null) {
 		if (rpt.marchName == 'Renfort') {
			t.popReport = new CPopup('pbShowRein', 0, 0, 525, 340, true, function() {t.popReport=null;clearTimeout (1000);});
			m+= '<DIV style="height:185px">';
		} else if (rpt.marchName == 'Transport') {
			t.popReport = new CPopup('pbShowTrans', 0, 0, 525, 240, true, function() {t.popReport=null;clearTimeout (1000);});
			m+= '<DIV style="height:185px">';
		} else if (rpt.marchName == 'Eclaireur' && rslt['winner']>=1 && rpt.sideId==1){
			t.popReport = new CPopup('pbShowOther', 0, 0, 550, (Options.HauteurBoite-100), true, function() {t.popReport=null;clearTimeout (1000);});
			m+= '<DIV style="max-height:'+(Options.HauteurBoite-120)+'px; height:'+(Options.HauteurBoite-120)+'px; overflow-y:scroll">';
		} else {
			t.popReport = new CPopup('pbShowOther', 0, 0, 630, (Options.HauteurBoite-100), true, function() {t.popReport=null;clearTimeout (1000);});
			m+= '<DIV style="max-height:'+(Options.HauteurBoite-120)+'px; height:'+(Options.HauteurBoite-120)+'px; overflow-y:scroll">';
		}
		   t.popReport.centerMe (mainPop.getMainDiv());
	        t.popReport.autoHeight (true);
	      }
		m+=buildHeader();

		if (rpt.marchName == 'Transport') {
			m+='<TABLE class=ptTab>';
			if (parseInt(rslt['gold']) > 0)
				m+='<TR><TD>'+goldImg+'</TD><TD align=right>'+addCommas(rslt['gold'])+'</TD></TR>';
			if (parseInt(rslt['resource1']) > 0)
				m+='<TR><TD>'+foodImg+'</TD><TD align=right>'+addCommas(rslt['resource1'])+'</TD></TR>';
			if (parseInt(rslt['resource2']) > 0)
				m+='<TR><TD>'+woodImg+'</TD><TD align=right>'+addCommas(rslt['resource2'])+'</TD></TR>';
			if (parseInt(rslt['resource3']) > 0)
				m+='<TR><TD>'+stoneImg+'</TD><TD align=right>'+addCommas(rslt['resource3'])+'</TD></TR>';
			if (parseInt(rslt['resource4']) > 0)
				m+='<TR><TD>'+oreImg+'</TD><TD align=right>'+addCommas(rslt['resource4'])+'</TD></TR>';
			if (parseInt(rslt['resource5'])> 0)
				m+='<TR><TD>'+aetherstoneImg+'</TD><TD align=right>'+addCommas(rslt['resource5'])+'</TD></TR>';
			m+='</TABLE>';
		}

		m+='<TABLE class=ptTab>';
		if ((rslt['winner']>=1 && rpt.sideId==0) || (rslt['winner']==0 && rpt.sideId==1)) {
			if (rpt.marchName == 'Eclaireur')
				m+='<TR><TD><FONT color="#CC0000"><B>'+uW.g_js_strings.modal_messages_viewreports_view.scoutfail+'</B></font></TD></TR>';
			else
				m+='<TR><TD><FONT color="#CC0000"><B>'+uW.g_js_strings.commonstr.defeat+'</B></font></TD></TR>';
		}
		if (rslt['winner']==0 && rpt.sideId==0)
			m+='<TR><TD><FONT color="#66CC33"><B>'+uW.g_js_strings.commonstr.victory+' !</B></font></TD></TR>';
		if (rslt['winner']>=1 && rpt.sideId==1)
			m+='<TR><TD><FONT color="#66BB33"><B>'+uW.g_js_strings.commonstr.victory+' !</B></font></TD></TR>';

		if (rslt['wall'] != undefined) {


			if (rslt['wall'] > 0 && rslt['wall'] < 100)
				m+='<TR><TD>'+uW.g_js_strings.modal_messages_viewreports_view.wallbreach+' '+rslt['wall']+' '+uW.g_js_strings.modal_messages_viewreports_view.percdamage+'</TD></TR>';
			else
				m+='<TR><TD>'+ uW.g_js_strings.modal_messages_viewreports_view.wallbreach+'</TD></TR>';
		}
		m+= '</TABLE><BR />';
		if (rslt['wonGloryItem']) {
		  m+="<TABLE class=ptTab><TR><td><img width=30 src="+gameurl+"img/items/70/" + rslt['wonGloryItem'] + ".jpg></td><td colspan=2>"+uW.ksoItems[rslt['wonGloryItem']].name+"</td></tr></TABLE><BR />";
		}

		if (rslt['throneRoomDrop']) {
		  var A=rslt['throneRoomDrop'];
		  faction=A.faction;
		  if (uW.kocThroneItems[rslt['throneRoomDrop'].id]) {
       	           var name=ThroneItemName(uW.kocThroneItems[rslt['throneRoomDrop'].id]);

		  m+="<TABLE class=ptTab><TR><td><img width=30 src="+gameurl+"img/throne/icons/30/"+faction+"/"+faction+"_"+A.type+"_normal_1.png></td><td colspan=2>"+name+"</td></tr></TABLE><BR />";
		 }
		}
		if (rslt['loot'] != undefined) {
			m+='<TABLE class=ptTab>';
			if (rslt['loot'][0] > 0)
				m+='<TR><TD>'+goldImg+'</TD><TD align=right>'+addCommas(rslt['loot'][0])+'</TD></TR>';
			if (rslt['loot'][1] > 0)
				m+='<TR><TD>'+foodImg+'</TD><TD align=right>'+addCommas(rslt['loot'][1])+'</TD></TR>';
			if (rslt['loot'][2] > 0)
				m+='<TR><TD>'+woodImg+'</TD><TD align=right>'+addCommas(rslt['loot'][2])+'</TD></TR>';
			if (rslt['loot'][3] > 0)
				m+='<TR><TD>'+stoneImg+'</TD><TD align=right>'+addCommas(rslt['loot'][3])+'</TD></TR>';
			if (rslt['loot'][4] > 0)
				m+='<TR><TD>'+oreImg+'</TD><TD align=right>'+addCommas(rslt['loot'][4])+'</TD></TR>';
			if (rslt['loot'][6] > 0)
				m+='<TR><TD>'+aetherstoneImg+'</TD><TD align=right>'+addCommas(rslt['loot'][6])+'</TD></TR>';
			if (rslt['loot'][5] !== undefined) {
				var q=uW.Object.keys(rslt['loot'][5]);
				if (q.length>0) {
				 for(var u=0,y=q.length;u<y;++u){
				 C=q[u];
				 if (uW.ksoItems[C]!==undefined)
				  m+="<TR><td><img width=30 src="+gameurl+"img/items/70/" + C + ".jpg></td><td colspan=2>"+uW.ksoItems[C].name+"</td></tr>";
			        }
			        }

			}

			m+='</TABLE><BR />';
		}

		if (rpt.marchName == 'Renfort') {
			m+=handleunts();
			m+=handlersc();
		}

		if (rpt.marchName == 'Eclaireur' && rslt['winner']>=1) {
			m+='<TABLE class=ptTab width=100%><TR><TD width=50% align=left valign=top>';
			m+=handleunts();
			if (rpt.side0TileTypeText!='F.S.')  m+=handlefrt();
			 m+=handlersc();
			m+='</TD><TD width=50% align=left valign=top>';
			if (rpt.side0TileTypeText!='F.S.') {
			m+='<TABLE class=ptTab width=100%>';
			if (rslt['lstlgn'] != undefined) {
				if (!rslt['lstlgn'])
					m+='<TR><TD>'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+' : -</TD></TR>';
				else
					m+='<TR><TD>'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+' : ' + formatUnixTime(rslt['lstlgn']) + '</TD></TR>';
			}
			m+='<TR><TD>'+uW.g_js_strings.modal_messages_viewreports_view.knightskills+' : ';
			if (rslt['knt'] != undefined)
				m+=rslt['knt']['cbt'];
			else
				m+='None';
			m+='</TD></TR>';

			if (rslt['pop'] != undefined)
				m+='<TR><TD>'+uW.g_js_strings.commonstr.population+' : ' + addCommas(rslt['pop']) + '</TD></TR>';
			if (rslt['hap'] != undefined)
				m+='<TR><TD>'+uW.g_js_strings.commonstr.happiness+' : ' + addCommas(rslt['hap']) + '</TD></TR></TABLE>';

			 if (rslt['blds'] != undefined) {
				m+='<b><u><a id=BORptBatClick>'+uW.g_js_strings.commonstr.buildings+'</a></u></b><br><div style="height:100px;max-height:100px;overflow-x:hidden;overflow-y:scroll;width:95%;display:none" id=BORptBat><TABLE class=ptTab>';
				for (var i=0; i<53; i++)
					if (rslt['blds']['b'+i] != undefined)
						m+=handleblds(i);
				m+='</TABLE></div>';
			 }
			 if (rslt['tch'] != undefined) {
				m+='<b><u><a id=BORptRechercheClick>'+uW.g_js_strings.commonstr.technology+'</a></u></b><br><div style="height:100px;max-height:100px;width:95%;overflow-x:hidden;overflow-y:scroll;display:none" id=BORptRecherche><TABLE class=ptTab>';
				for (var tl=1; tl < 17; tl++)
					if (tl != 7)
						m+='</TD></TR><TR><TD>'+researchLevels[tl].Name+'</TD><TD align=right>' + rslt['tch']['t'+tl] + '</TD></TR>';

				if (rslt['tch2'] != undefined) {

				}
				m+='</TABLE></div>';
			 }
			}
			m+='</TD></TR></TABLE>';
		}

		if (rslt['fght'] != undefined){
			m+='<TABLE class=ptTab width=100%><TR><TD width=50% align=left valign=top>';
			m+='<TABLE class=ptTab width=100%>';
			m+='<TR><TD colspan=4><B>'+uW.g_js_strings.commonstr.attacker+'</B> ('+rpt.side1Name+')';
			if (rslt['winner']>=1)
				m+='<FONT color="#CC0000"><B> '+uW.g_js_strings.commonstr.winner+'</B></FONT>';
			m+='</TD></TR>';
			if (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense')
				m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.knightskills+' : ' + rslt['s1KCombatLv'] + '</TD></TR>';
			if (rslt['s1atkBoost']!== undefined)
			 if (100*rslt['s1atkBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.attackboosted+' : ' + 100*rslt['s1atkBoost'] + '%</TD></TR>';
			if (rslt['s1defBoost']!== undefined)
			 if (100*rslt['s1defBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.defenseboosted+' : ' + 100*rslt['s1defBoost'] + '%</TD></TR>';
			if (rslt['s1lifeBoost']!== undefined)
			 if (100*rslt['s1lifeBoost']>0)
			  m+='<TR><TD colspan=4>Vie : ' + 100*rslt['s1lifeBoost'] + '%</TD></TR>';
			if (rslt['s1guardianDefBoost']!== undefined)
			 if (100*rslt['s1guardianDefBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.guardian_defenseboosted+' : ' + 100*rslt['s1guardianDefBoost'] + '%</TD></TR>';
			if (rslt['s1guardianAtkBoost']!== undefined)
			 if ( 100*rslt['s1guardianAtkBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.guardian_attackboosted+' : ' + 100*rslt['s1guardianAtkBoost'] + '%</TD></TR>';
			if (rslt['s1guardianMarchBoost']!== undefined)
			 if (100*rslt['s1guardianMarchBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.guardian_marchboosted+' : ' + 100*rslt['s1guardianMarchBoost'] + '%</TD></TR>';
			m+='<TR><TD colspan=4><a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side1XCoord +','+ rpt.side1YCoord +')</a> ' + rpt.side1CityName + '</TD></TR>';
			if (rslt['fght']["s1"] != undefined) {
				m+='<TR><TH></TH><TH align=left>'+uW.g_js_strings.commonstr.troops+'</TH><TH align=right>'+uW.g_js_strings.report_view.fought+'</TH><TH align=right>'+uW.g_js_strings.report_view.survived+'</TH><TH align=right>'+uW.g_js_strings.report_view.wounded+'</TH></TR>';
								var i=0;
				  				for (y in uW.unitcost) {
				i++;
					if (rslt['fght']["s1"]['u'+i] != undefined) {
						if (rslt['fght']["s1"]['u'+i][0] > rslt['fght']["s1"]['u'+i][1]) {
							perte_atk= perte_atk +(rslt['fght']["s1"]['u'+i][0] - rslt['fght']["s1"]['u'+i][1])*puipui[i-1];
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s1"]['u'+i][0])+'</td>';
							m+='<TD align=right><FONT color="#CC0000">'+addCommas(rslt['fght']["s1"]['u'+i][1])+'</FONT></td>';
							m+='<TD align=right><FONT color="#CC0000">'+addCommas(rslt['fght']["s1"]['u'+i][2])+'</FONT></td></tr>';
						} else {
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s1"]['u'+i][0])+'</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s1"]['u'+i][1])+'</td></tr>';
						}
					}
				}
			}
			m+='</TABLE><br>';
			if (rslt['s1ThroneRoomBoosts']) {
			m+='<b><u><a id=BORptS1ThroneClick>'+uW.g_js_strings.report_view.throne_room+'</a></u></b><br><TABLE class=ptTab id=BORptS1Throne style="display:none">';
			  for (var i in rslt['s1ThroneRoomBoosts']) {

			   m+='<TR><TD><B>'+uW.cm.thronestats.effects[i][1].substring(0,30)+'</B></td><td align=right>'+ rslt['s1ThroneRoomBoosts'][i] +' %</td></tr>';

			  }
			m+='</TABLE>';
			}


			m+='</TD><TD width=50% align=left valign=top>';
			m+='<TABLE class=ptTab width=100%>';
			m+='<TR><TD colspan=4><B>'+uW.g_js_strings.commonstr.defenders+'</B> ('+rpt.side0Name+')';
			if (rslt['winner']==0)
				m+='<FONT color="#CC0000"><B> '+uW.g_js_strings.commonstr.winner+'</B></FONT>';
			m+='</TD></TR>';
			if (rpt.marchName == 'Attaque' || rpt.marchName == 'Defense')
				m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.knightskills+' : ' + rslt['s0KCombatLv'] + '</TD></TR>';
			if (rslt['s0atkBoost'] !== undefined)
			 if (100*rslt['s0atkBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.attackboosted+' : ' + 100*rslt['s0atkBoost'] + '%</TD></TR>';
			if (rslt['s0defBoost'] !== undefined)
			 if (rslt['s0defBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.defenseboosted+' : ' + 100*rslt['s0defBoost'] + '%</TD></TR>';
			if (rslt['s0lifeBoost']!== undefined)
			 if (100*rslt['s0lifeBoost']>0)
			  m+='<TR><TD colspan=4>Vie : ' + 100*rslt['s0lifeBoost'] + '%</TD></TR>';
			if (rslt['s0guardianDefBoost']!== undefined)
			 if (100*rslt['s0guardianDefBoost']>0)
			 m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.guardian_defenseboosted+' : ' + 100*rslt['s0guardianDefBoost'] + '%</TD></TR>';
			if (rslt['s0guardianAtkBoost']!== undefined)
			 if (100*rslt['s0guardianAtkBoost']>0)
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.guardian_attackboosted+' : ' + 100*rslt['s0guardianAtkBoost'] + '%</TD></TR>';
			if (rslt['s0guardianMarchBoost']!== undefined)
			 if (100*rslt['s0guardianMarchBoost'])
			  m+='<TR><TD colspan=4>'+uW.g_js_strings.modal_messages_viewreports_view.guardian_marchboosted+' : ' + 100*rslt['s0guardianMarchBoost'] + '%</TD></TR>';
			if (rslt['rnds']!==undefined)
			   m+='<TR><TD colspan=4>Tour : ' + rslt['rnds'] + '</TD></TR>';
			if (rslt['fght']["s0"] != undefined) {
				m+='<TR><TH></TH><TH align=left>'+uW.g_js_strings.commonstr.troops+'</TH><TH align=right>'+uW.g_js_strings.report_view.fought+'</TH><TH align=right>'+uW.g_js_strings.report_view.survived+'</TH></TR>';
							var i=0;
			  				for (y in uW.unitcost) {
				i++;
					if (rslt['fght']["s0"]['u'+i] != undefined) {
						if (rslt['fght']["s0"]['u'+i][0] > rslt['fght']["s0"]['u'+i][1]) {
							perte_def= perte_def +(rslt['fght']["s0"]['u'+i][0] - rslt['fght']["s0"]['u'+i][1])*puipui[i-1];
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['u'+i][0])+'</td>';
							m+='<TD align=right><FONT color="#CC0000">'+addCommas(rslt['fght']["s0"]['u'+i][1])+'</FONT></td></tr>';
						} else {
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['u'+i][0])+'</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['u'+i][1])+'</td></tr>';
						}
					}
				}
				for (var i=101;i<111;i++) {
									if (rslt['fght']["s0"]['m'+i] != undefined) {
										if (rslt['fght']["s0"]['m'+i][0] > rslt['fght']["s0"]['m'+i][1]) {
											m+='<TR><TD>' + unitImg[i] + '</td>';
											m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['m'+i][0])+'</td>';
											m+='<TD align=right><FONT color="#CC0000">'+addCommas(rslt['fght']["s0"]['m'+i][1])+'</FONT></td></tr>';
										} else {
											m+='<TR><TD>' + unitImg[i] + '</td>';
											m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['m'+i][0])+'</td>';
											m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['m'+i][1])+'</td></tr>';
										}
									}
				}
				for (var i=53;i<=55;i++) {
					if (rslt['fght']["s0"]['f'+i] != undefined) {
						if (rslt['fght']["s0"]['f'+i][0] > rslt['fght']["s0"]['f'+i][1]) {
							perte_def= perte_def +(rslt['fght']["s0"]['f'+i][0] - rslt['fght']["s0"]['f'+i][1])*puipui[i];
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['f'+i][0])+'</td>';
							m+='<TD align=right><FONT color="#CC0000">'+addCommas(rslt['fght']["s0"]['f'+i][1])+'</font></td></tr>';
						} else {
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['f'+i][0])+'</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['f'+i][1])+'</td></tr>';
						}
					}
				}
				for (var i=60;i<=63;i++) {
					if (rslt['fght']["s0"]['f'+i] != undefined) {
						if (rslt['fght']["s0"]['f'+i][0] > rslt['fght']["s0"]['f'+i][1]) {
							perte_def= perte_def +(rslt['fght']["s0"]['f'+i][0] - rslt['fght']["s0"]['f'+i][1])*puipui[i];
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['f'+i][0])+'</td>';
							m+='<TD align=right><FONT color="#CC0000">'+addCommas(rslt['fght']["s0"]['f'+i][1])+'</font></td></tr>';
						} else {
							m+='<TR><TD>' + unitImg[i] + '</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['f'+i][0])+'</td>';
							m+='<TD align=right>'+addCommas(rslt['fght']["s0"]['f'+i][1])+'</td></tr>';
						}
					}
				}
			} else
				m+='<TR><TD>'+uW.g_js_strings.modal_messages_viewreports_view.notroopsdef+'</TD></TR>';
			m+='</TABLE><br>';
			if (rslt['s0ThroneRoomBoosts']) {
			m+='<b><u><a id=BORptS0ThroneClick>'+uW.g_js_strings.report_view.throne_room+'</a></u></b><br><TABLE class=ptTab id=BORptS0Throne style="display:none">';
			for (var i in rslt['s0ThroneRoomBoosts']) {
			   m+='<TR><TD><B>'+uW.cm.thronestats.effects[i][1].substring(0,30)+'</B></td><td align=right>'+ rslt['s0ThroneRoomBoosts'][i] +' %</td></tr>';
			}
			m+='</TABLE>';
			}
			m+='</TD></TR><tr><td colspan=2>';



			if (rslt['bonus']) {
				m+='<b><u><a id=BORptS1Click>Bonus</a></u></b>'
				if (rslt['bonus']['mod']['s1']) {
				 m+='<br><TABLE class=ptTab id=BORptS1 style="display:none;width:95%"><tr><td colspan=2><u><font color=red><b>Troops Attacker</u></td><td><b>Life</b></td><td><b>Attack</b></td><td><b>Defense</b></td><td><b>Speed</b></td><td><b>Range</b></td><td><b>Load</b></td></tr>';
				 var i=0;
  				 for (y in uW.unitcost) {
				  i++;
				  if (rslt['bonus']['mod']['s1']['u'+i] != undefined) {
					m+="<TR><td>" + unitImg[i] + "</td>";
					for (z in rslt['bonus']['mod']['s1']['u'+i]) {
					     pp=rslt['bonus']['mod']['s1']['u'+i][z];
					     m+='<td align=left>'+pp[1]+'</td>';
					}
					m+="</tr>";
				  }
				 }
				}

				if (rslt['bonus']['mod']['s0']) {
				 m+='<tr><td colspan=2><u><font color=red><b>Troops Defenser</td><td><b>Life</b></td><td><b>Attack</b></td><td><b>Defense</b></td><td><b>Speed</b></td><td><b>Range</b></td><td><b>Load</b></td></tr>';
				 var i=0;
  				 for (y in uW.unitcost) {
				  i++;
				  if (rslt['bonus']['mod']['s0']['u'+i] != undefined) {
				   m+="<TR><td>" + unitImg[i] + "</td>";
				   for (z in rslt['bonus']['mod']['s0']['u'+i]) {
					pp=rslt['bonus']['mod']['s0']['u'+i][z];
					m+='<td align=left>'+pp[1]+'</td>';
				   }
				   m+="</tr>";
                  }
                 }
                 for (var i=101;i<111;i++) {
				 	if (rslt['bonus']['mod']['s0']['m'+i] != undefined) {
				 								  m+="<TR><td>" + unitImg[i] + "</td>";
				 								  for (z in rslt['bonus']['mod']['s0']['m'+i]) {
				 									pp=rslt['bonus']['mod']['s0']['m'+i][z];
				 									m+='<td align=left>'+pp[1]+'</td>';
				 								  }
				 								 m+="</tr>";
				 	 }
				  }

			    }

 				if (rslt['bonus']['tch']&&rslt['bonus']['tch']['s1']) {
				  	m+="<tr><td colspan=2><u><font color=red><b>Research</td><td><b>Life</b></td><td><b>Attack</b></td><td><b>Defense</b></td><td><b>Speed</b></td><td><b>Range</b></td><td><b>Load</b></td></tr>";
				  	m+="<TR><td colspan=2>Attacker :</td>";
				  	for (z in rslt['bonus']['tch']['s1']) {
				  		pp=rslt['bonus']['tch']['s1'][z];
				  		m+='<td align=left>'+Math.round(pp*100)+' %</td>';
				  	}
				  	m+"</tr>";
				 }
				 if (rslt['bonus']['tch']&&rslt['bonus']['tch']['s0']) {
					m+="<TR><td colspan=2>Defenser :</td>";
					for (z in rslt['bonus']['tch']['s0']) {
					 pp=rslt['bonus']['tch']['s0'][z];
					 m+='<td align=left>'+Math.round(pp*100)+' %</td>';
					}
					m+"</tr>";
				}
				if (rslt['bonus']['tch2']&&rslt['bonus']['tch2']['s1'] || rslt['bonus']['tch2']&&rslt['bonus']['tch2']['s0']) {
				  m+="<tr><td colspan=3><u><font color=red><b>Research Britton</td><td><b>Cartography</b></td><td><b>Defenses</b></td><td><b>Strengthen</b></td><td><b>Fletching</b></td><td></td></tr>";
			    }
				if (rslt['bonus']['tch2']&&rslt['bonus']['tch2']['s1']) {
				  					 m+="<TR><td colspan=3>Attacker :</td>";
				  					 for (z in rslt['bonus']['tch2']['s1']) {
				  						 pp=rslt['bonus']['tch2']['s1'][z];
				  					     m+='<td align=left>'+Math.round(pp*100)+' %</td>';
				  					}
				  					m+"</tr>";
				}
				if (rslt['bonus']['tch2']&&rslt['bonus']['tch2']['s0']) {
				  					 m+="<TR><td colspan=3>Defenser :</td>";
				  					 for (z in rslt['bonus']['tch2']['s0']) {
				  						 pp=rslt['bonus']['tch2']['s0'][z];
				  					     m+='<td align=left>'+Math.round(pp*100)+' %</td>';
				  					}
				  					m+"</tr>";
				}




			 m+='</TABLE>';
			}

			m+="</tr>";
			delta_perte = perte_atk - perte_def;
			delta_pos = 1;
			ordre_grandeur = 1;
			delta_perte = delta_perte/1000;
			if (delta_perte<0){
				delta_pos = -1;
				delta_perte = Math.abs(delta_perte);
			}
			if (delta_perte>1000) {
				ordre_grandeur = 2;
				delta_perte = entier_1dec(delta_perte/1000);
			}
			if (delta_perte<1) {
				ordre_grandeur = 0;
				delta_perte = entier_1dec(delta_perte*1000);
			}
			if (ordre_grandeur == 1) {
				delta_perte = entier_1dec(delta_perte);
			}
			perte_atk = entier_1dec(perte_atk/1000);
			perte_def = entier_1dec(perte_def/1000);
			m+='<TR><TD colspan=4>&nbsp;</TD></TR>';
			if ((delta_pos == 1) && (delta_perte != 0)) {
				m+='<TR><TD><FONT color="#000"><b>'+uW.g_js_strings.commonstr.might+' '+lang.Rpt.lost+'</b> ('+rpt.side1Name+') : </FONT><FONT color="#CC0000"> '+(perte_atk)+'k</FONT></TD><TD><FONT color="#00"><b>'+uW.g_js_strings.commonstr.might+' '+lang.Rpt.lost+'</b> ('+rpt.side0Name+') : '+perte_def+'k </FONT></TD></TR>';
				if (ordre_grandeur==2) {
					m+='<TR><TD style="background-color: #FFFF00;"><FONT color="#ff00ff">'+lang.Rpt.lost1+'</FONT><FONT color="#CC0000"> '+delta_perte+'M</FONT></TD><TD></TD></TR></table>';
				} else if (ordre_grandeur==1){
					m+='<TR><TD style="background-color: #FFFF00;"><FONT color="#ff00ff">'+lang.Rpt.lost1+'</FONT><FONT color="#CC0000"> '+delta_perte+'k </FONT></TD><TD></TD></TR></table>';
				} else if(ordre_grandeur==0){
					m+='<TR><TD style="background-color: #FFFF00;"><FONT color="#ff00ff">'+lang.Rpt.lost1+'</FONT><FONT color="#CC0000"> '+delta_perte+'</FONT></TD><TD></TD></TR></table>';
				}
			}
			if ((delta_pos == -1) && (delta_perte != 0)) {
				m+='<TR><TD><FONT color="#000"><b>'+uW.g_js_strings.commonstr.might+' '+lang.Rpt.lost+'</b> ('+rpt.side1Name+') : '+perte_atk+'k</FONT></TD><TD><FONT color="#000"><b>'+uW.g_js_strings.commonstr.might+' '+lang.Rpt.lost+'</b> ('+rpt.side0Name+') : </FONT><FONT color="#CC0000"> '+perte_def+'k </FONT></TD></TR>';
				if (ordre_grandeur==2) {
					m+='<TR><TD></TD><TD style="background-color: #FFFF00;"><FONT color="#ff00ff">'+lang.Rpt.lost1+'</FONT><FONT color="#CC0000"> '+delta_perte+'M</FONT></TD></TR></table>';
				} else if (ordre_grandeur==1){
					m+='<TR><TD></TD><TD style="background-color: #FFFF00;"><FONT color="#ff00ff">'+lang.Rpt.lost1+'</FONT><FONT color="#CC0000"> '+delta_perte+'k</FONT></TD></TR></table>';
				} else if (ordre_grandeur==0){
					m+='<TR><TD style="background-color: #FFFF00;"><FONT color="#ff00ff">'+lang.Rpt.lost1+'</FONT><FONT color="#CC0000"> '+delta_perte+'</FONT></TD><TD></TD></TR></table>';
				}
			}
			if (delta_perte == 0 && (perte_def>0 || perte_atk>0)) {
				m+='<TR><TD><FONT color="#000"><b>'+uW.g_js_strings.commonstr.might+' '+lang.Rpt.lost+'</b> ('+rpt.side1Name+') : '+perte_atk+'k</FONT></TD><TD><FONT color="#000"><b>'+uW.g_js_strings.commonstr.might+' '+lang.Rpt.lost+'</b> ('+rpt.side0Name+') : '+perte_def+'k </FONT></TD></TR></TABLE>';
			}
		}

		m+='</DIV>';
		t.popReport.getMainDiv().innerHTML = m;
		t.popReport.getTopDiv().innerHTML = '<DIV align=center><B>'+uW.g_js_strings.commonstr.report+'</B></DIV>';
	        t.popReport.show(true);
    		t.popReport.autoHeight (true);

    		if (ById("BOSendtoTchat")) {
				ById('BOSendtoTchat').addEventListener('click', function () {
					sendChat ("/a Rpt:" + reportId);
				},false);

			}
    		if (ById('BORptS0ThroneClick')) {
				 ById('BORptS0ThroneClick').addEventListener('click', function () {
				    		  if (ById('BORptS0Throne').style.display=="none") {ById('BORptS0Throne').style.display="block";} else {ById('BORptS0Throne').style.display="none";}
				 },false);
    		}
    		if (ById('BORptS1ThroneClick')) {
		 ById('BORptS1ThroneClick').addEventListener('click', function () {
		    		  if (ById('BORptS1Throne').style.display=="none") {ById('BORptS1Throne').style.display="block";} else {ById('BORptS1Throne').style.display="none";}
		 },false);
    		}
    		if (ById('BORptS1Click')) {
		 ById('BORptS1Click').addEventListener('click', function () {
		    		  if (ById('BORptS1').style.display=="none") {ById('BORptS1').style.display="block";} else {ById('BORptS1').style.display="none";}
		 },false);
    		}
    		if (ById('BORptBatClick')) {
		 ById('BORptBatClick').addEventListener('click', function () {
		    		  if (ById('BORptBat').style.display=="none") {ById('BORptBat').style.display="block";} else {ById('BORptBat').style.display="none";}
		 },false);
    		}
    		if (ById('BORptRechercheClick')) {
    		 ById('BORptRechercheClick').addEventListener('click', function () {
    		  if (ById('BORptRecherche').style.display=="none") {ById('BORptRecherche').style.display="block";} else {ById('BORptRecherche').style.display="none";}
    		 },false);
	      }
	},

};

Tabs.Marches = {
  tabOrder: 3,
  tabLabel: uW.g_js_strings.commonstr.march,
  cont:null,
  displayTimer:null,
  curTabBut : null,
  curTabName : null,
  state : null,
  defMode : {},
  hide : function (){
      var t = Tabs.Marches;
      clearTimeout (t.displayTimer);
      t.state=null;
  },
  show : function (){
   var t = Tabs.Marches;if (TESTBAO==-1) return false;
   clearTimeout (t.displayTimer);
   t.state = null;
   if (t.curTabName == 'M')
     t.showMarches(9);
   else
     t.showAttacks();
  },
  init : function (div){
    var t = Tabs.Marches;
    t.cont = div;
    uW.pr58Recall = t.ajaxRecall;
    uW.BOraid_delete = t.ajaxDeleteRaid;
    uW.r8x6Home = t.butSendHome;
    uW.pr57Recall = t.butRecall2;
    uW.boshowthrone = t.showthrone;
    var atkclass='';
    if(Seed && Seed.queue_atkinc) {
      for(k in Seed.queue_atkinc){
        m = Seed.queue_atkinc[k];
        if (m.marchType == 4){
    	   atkclass = 'style="background-color:#FF9999;"';
    	 }
      }
    }
    t.cont.innerHTML = '<TABLE class=ptTab align=center><TR><TD><INPUT class=bopbSubtab ID=BoptmrchSubM type=button class=pbButton value="'+ uW.g_js_strings.commonstr.marching +'"></td>\
          <TD><INPUT class=bopbSubtab ID=BoptmrchSubA class=pbButton type=button '+atkclass+' value="' + uW.g_js_strings.modaltitles.impatks + '"></td>\
          <td><input type=button value="?" id=boaidemarches class=boAide></td></tr></table>\
      <DIV id="BoptMarchOutput" style="margin-top:5px; height:'+(Options.HauteurBoite-65)+'px;max-height:'+(Options.HauteurBoite-65)+'px;overflow-y:auto"></div>';
    t.marchDiv = ById('BoptMarchOutput');
    ById('BoptmrchSubA').addEventListener('click', e_butSubtab, false);
    ById('BoptmrchSubM').addEventListener('click', e_butSubtab, false);
    ById('boaidemarches').addEventListener('click', function(){
    	       	 window.open(sitesupport+"?page=aide_marches");
    	} , false);
       if (atkclass!='') {
       changeSubtab (ById('BoptmrchSubA'));
       }else {
       changeSubtab (ById('BoptmrchSubM'));
       }

      function e_butSubtab (evt){
          changeSubtab (evt.target);
      }

      function changeSubtab (but){
          if (but == t.curTabBut)
            return;
          if (t.curTabBut){
            t.curTabBut.className='bopbSubtab';
            t.curTabBut.disabled=false;
          }
          t.curTabBut = but;
          but.className='bopbSubtab bopbSubtabSel';
          but.disabled=true;
          t.curTabName = but.id.substr(11);
          if (Options.currentTab=="Marches") t.show2();
      }

  },
  show2 : function (){
    var t = Tabs.Marches;
    t.state = null;
    clearTimeout (t.displayTimer);
    if (t.curTabName == 'M')
      t.showMarches(9);
    else
      t.showAttacks();
  },
  HisStatEffects: [],
  MyStatEffects: [],
  showthrone:function(uid,name,what){
    var t = Tabs.Marches;

    var params = uW.Object.clone(uW.g_ajaxparams);
 	params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
 	params.action = 'getEquipped';
 	params.playerId = uid;

     new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
     method: "post",
     parameters: params,
     loading: true,
     onSuccess: function (transport) {
       var rslt = eval("(" + transport.responseText + ")");
         if(rslt.ok){
           for (k in uW.cm.thronestats.effects) t.HisStatEffects[k] = 0;
           for (kk=0;kk<=6;kk++){
               y = rslt.items[kk];
               if (y != undefined) {
                 for (i=1;i<=5;i++) {
                      id = y["effects"]["slot"+i]["id"];
                    tier = parseInt(y["effects"]["slot"+i]["tier"]);
                    level = y["level"];
                    if (uW.cm.thronestats.tiers[id][tier]) p = uW.cm.thronestats.tiers[id][tier];
                    else p = uW.cm.thronestats.tiers[id][tier-1];
                    Current = p.base + ((level * level + level) * p.growth * 0.5);
                    if (i<=parseInt(y["quality"])) t.HisStatEffects[id] += Current;
               }
             }
           }
           for (k in uW.cm.thronestats.effects) t.MyStatEffects[k] = 0;
             for (k in uW.kocThroneItems){
               y = uW.kocThroneItems[k];
               for (i=1;i<=5;i++) {
                 id = y["effects"]["slot"+i]["id"];
                 tier = parseInt(y["effects"]["slot"+i]["tier"]);
                 level = y["level"];
                 if (uW.cm.thronestats.tiers[id][tier]) p = uW.cm.thronestats.tiers[id][tier];
                  else p = uW.cm.thronestats.tiers[id][tier-1];
                 Current = p.base + ((level * level + level) * p.growth * 0.5);
                 if (y.isEquipped && i<=y["quality"]) t.MyStatEffects[id] += Current
             }
           }
           if (what == "Compare") t.PaintTRCompare(uid,name);
           if (what == "Calc") t.PaintTRCalc(uid,name);
          }
     },
     onFailure: function () {
        return;
     },
   });
  },
  TRlineHolder : {
  		1:{1:uW.g_js_strings.throneRoom.effectName_1,2:null},2:{1:1,2:17},3:{1:24,2:29},4:{1:34,2:39},5:{1:44,2:50},6:{1:56,2:61},7:{1:17,2:1},8:{1:29,2:24},9:{1:39,2:34},10:{1:50,2:44},11:{1:61,2:56},
  		12:{1:uW.g_js_strings.throneRoom.effectName_2,2:null},13:{1:2,2:18},14:{1:25,2:30},15:{1:35,2:40},16:{1:45,2:51},17:{1:18,2:2},18:{1:30,2:25},19:{1:40,2:35},20:{1:51,2:45},
  		21:{1:uW.g_js_strings.throneRoom.effectName_3,2:null},22:{1:3,2:19},23:{1:26,2:31},24:{1:36,2:41},25:{1:46,2:52},26:{1:19,2:3},27:{1:31,2:26},28:{1:41,2:36},29:{1:52,2:46},
  		30:{1:uW.g_js_strings.throneRoom.effectName_4,2:null},31:{1:4,2:20},32:{1:27,2:32},33:{1:47,2:53},34:{1:57,2:62},35:{1:20,2:4},36:{1:32,2:27},37:{1:53,2:47},38:{1:62,2:57},
  		39:{1:uW.g_js_strings.throneRoom.effectName_5,2:null},40:{1:5,2:21},41:{1:37,2:42},42:{1:58,2:63},43:{1:21,2:5},44:{1:42,2:37},45:{1:63,2:58},
  		46:{1:uW.g_js_strings.throneRoom.effectName_6,2:null},47:{1:6,2:22},48:{1:48,2:54},49:{1:59,2:64},50:{1:22,2:6},51:{1:54,2:48},52:{1:64,2:59},
  		52:{1:uW.g_js_strings.throneRoom.effectName_7,2:null},53:{1:7,2:23},54:{1:28,2:33},55:{1:38,2:43},56:{1:49,2:55},57:{1:60,2:65},58:{1:23,2:7},59:{1:33,2:28},60:{1:43,2:38},61:{1:55,2:49},62:{1:65,2:60},
  		63:{1:uW.g_js_strings.commonstr.other,2:null},64:{1:8,2:8},65:{1:9,2:9},65:{1:10,2:10},66:{1:11,2:11},67:{1:12,2:12},68:{1:13,2:13},69:{1:14,2:14},70:{1:15,2:15},71:{1:16,2:16},72:{1:66,2:66},73:{1:67,2:67},74:{1:68,2:68},75:{1:69,2:69},76:{1:70,2:70},77:{1:71,2:71},78:{1:72,2:72},79:{1:73,2:73},80:{1:74,2:74},81:{1:75,2:75},82:{1:76,2:76},83:{1:77,2:77},84:{1:78,2:78},85:{1:79,2:79},86:{1:80,2:80},87:{1:81,2:81},88:{1:82,2:82},89:{1:83,2:83},90:{1:84,2:84},91:{1:85,2:85},92:{1:86,2:86},93:{1:87,2:87},94:{1:88,2:88},95:{1:89,2:89},96:{1:90,2:90},97:{1:91,2:91},98:{1:92,2:92},99:{1:93,2:93},100:{1:94,2:94},101:{1:95,2:95},102:{1:96,2:96},
   },
   PaintTRCalc : function (uid, name){
   		var t = Tabs.Marches;
   		uW.bocshowthrone = t.showthrone;
   		if (!Options.advThrone) {
			t.countref=0;
			t.showthroneBAK(uid);return false;
		}
   		m = '<DIV style="max-height:600px; height:600px; overflow-y:scroll;"><TABLE><TD class=xtab><B>' + name + '</b><TD width="35px" class=xtab><img onclick=bocshowthrone('+uid+',"'+name+'","Calc"); src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAEnQAABJ0BfDRroQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANtSURBVDiNZVJfbFN1GD2/23vvevtnbYFObukYqHNrO4yw2jUsExl1mWxZ1CCLijiNPmDinwR5EOIDJLiImgUjcQYJ0ZCY4QO44CJjDGFBWReRQW0doGwLbsgKdqzt7b239/fzoYxU/V6+8/Cdk/N95yOMMfy3SoJN1cJ93qaAz18zR4njz4nxC+rV0Z/Ui0NnGGO0eJYUCxBCxOotO3e1rV//5oMet2TiOGgGRVanmLqTwakfTp9LnDj6cnbkxG//EzDJy51PvrP71LORhkdMHIFmMGgGg04pNFrAqsHwc3zs5o+9h9++3fdlj70m1HBPILTt4563NrdvZMC/yKrBoFMGjTLoBkOeMUxMTc1OjsViylwqwQOAuHLtxq2dXRvmyWnNwODIhfGLo78cySrqzLJlFWtqw/VNFkkit1QVqqXUYa0J1c+e/T52z4Et8lz7Y82tW4OrVgaPnxwcOn/gwxb9xkR6fteFzZveXdTasdtssxBJIJAEglT05Oe8fc0zr5mdC0uVaP9nfQNf91ifeKHFuDV9uZgsBcIB19qnW0qsEjELBGaBQBI4KIKJ48rur3pg53s7Ptq099A135Zd+/LT167mzg9eKY4qFx++kp9IHFJ/PXdazGcNSeBgFghEwUR4g1LKcxweXeEvW+Grfn1sXeSV0PZ9A7GBb/dko/1DAMAY0wB0A+j2rmuLeGrDL8n+QKu5hCe8kTeYZhSiylMG2e02R7NpYvw9c7nYRdnqiN/9cPANpqQ/ie7Z/uKS2roKhyyv4vOGYegU0O8KUBCkwUu8zS7Okxc3tj20tOmpbm9tXQOrb3j+8R3vfyM5HHvjx44e4SmjNJs3oFEGxgDFoCC+ukbZLQ9XbusaMYsmvnJDR2hBefkis0AgeeTSMnfpZnV6oh/AJRNfXtU4eX1q+sZMMuMpr/BOzuWQVDTYFrjsLu/SKpfXW2l3OS2SQGARC9f//XjvgTOfdn1QeH/J6mRKZlao8MnB9le/4ALh5iwDkUQOkkAgiQQWoYAFqtHxwb7vhg/u75i7+VcKADMhr+cAmOhsMn/9bH+vquVyIsc8NqfDYbVJnEXgwKl3aCox+kfs8Fedwwf3d2qZjA6AAaCEMQZCCAeAByAAEAGIlsVL/HJwdVhPJZVk/FI8ezuZAKAA0AFod7vxDwfkm7pTnR7NAAAAAElFTkSuQmCC"></td><TD width="20px" class=xtab></td><TD class=xtab><B>'+ Seed.player.name+'</b></td>';
   		for (z=1;z<=102;z++) {
   			var HisContent = "";
   			var MyContent = "";
   			var His = t.TRlineHolder[z][1];
   			var My = t.TRlineHolder[z][2];
   			var diff = 0;
   			var color = "black";
   			if (t.TRlineHolder[z][2] == null) {
   			  m+= '<TR><TD class=xtab colspan=4><hr></td></tr><TR><TD class=xtab colspan=4><B><U>' + t.TRlineHolder[z][1] + '</b></u></td></tr>';
   			} else {
   				if (t.HisStatEffects[His] != 0) HisContent = t.HisStatEffects[His] + '% ' + uW.cm.thronestats["effects"][His]["1"];
   				if (t.MyStatEffects[My] != 0) MyContent = t.MyStatEffects[My] + '% ' + uW.cm.thronestats["effects"][My]["1"];
   				if (t.HisStatEffects[His] != 0 && t.MyStatEffects[My] != 0) {
   				if (z < 63) diff = (parseInt(t.HisStatEffects[His]) + parseInt(t.MyStatEffects[My]));
   				if (z > 63) diff = ( parseInt(t.MyStatEffects[My]) - parseInt(t.HisStatEffects[His]) );
   				if (MyContent.indexOf("Debuff") != -1 && diff > 0) color = "red";
   				else if (MyContent.indexOf("Debuff") != -1 && diff < 0) color = "green";
   				else if (HisContent.indexOf("Debuff") != -1 && diff > 0) color = "green";
   				else if (HisContent.indexOf("Debuff") != -1 && diff < 0) color = "red";
   				else if (diff < 0) color = "red";
   				else color = "green";
   				m+='<TR><TD class=xtab>' + HisContent.substring(0,40) + '</td><TD class=xtab><center><FONT color='+ color +'><I><B>'+ diff +'</b></i></font></td><TD class=xtab></td><TD class=xtab>' + MyContent.substring(0,40) + '</td>';
   			  } else if (t.HisStatEffects[His] != 0 || t.MyStatEffects[His] != 0) m+='<TR><TD class=xtab>' + HisContent.substring(0,40) + '</td><TD class=xtab></td><TD class=xtab></td><TD class=xtab>' + MyContent.substring(0,40) + '</td>';
   			  m+='</tr>';
   			}
   		}
   		m +='</table></div>';
    	  var title=uW.g_js_strings.commonstr.throneroom+' : ' + name;
   		      if (t.popuptrone==null){
		        t.popuptrone = new CPopup('BOpopuptrone', 0, 0, 550, 650, true, function() { clearTimeout (1000); });
			    t.popuptrone.centerMe (mainPop.getMainDiv());
		      }
		      t.popuptrone.getMainDiv().innerHTML = m;
	  t.popuptrone.getTopDiv().innerHTML = '<b><CENTER>'+title+'</center></b>&nbsp;';
	  t.popuptrone.show(true);
   	},
   	PaintTRCompare : function (uid, name){
       	var t = Tabs.Marches;
       	m = '<DIV style="max-height:690px; height:690px; overflow-y:scroll;"><TABLE><TD class=xtab></td><TD class=xtab><B>' + name + '</b><TD></td><TD class=xtab><B>'+ Seed.player.name+'</b></td></tr><TR><TD>&nbsp</td></tr>';
     		for (k=1;k<t.MyStatEffects.length;k++) {
       		var HisContent = "";
       		var MyContent = "";
       		if (t.HisStatEffects[k] != 0) HisContent = t.HisStatEffects[k] + '% ' + uW.cm.thronestats["effects"][k]["1"];
       		if (t.MyStatEffects[k] != 0) MyContent = t.MyStatEffects[k] + '% ' + uW.cm.thronestats["effects"][k]["1"];
       		if (t.HisStatEffects[k] != 0 || t.MyStatEffects[k] != 0) m+='<TR><TD  width="25px" class=xtab></td><TD class=xtab>' + HisContent + '</td><TD  width="50px" class=xtab></td><TD class=xtab>' + MyContent + '</td></tr>';
     		}
   		m +='</table></div>';
  	 var title=uW.g_js_strings.commonstr.throneroom+' : ' + name;
   		      if (t.popuptrone==null){
		        t.popuptrone = new CPopup('BOpopuptrone', 0, 0, 650, 750, true, function() { clearTimeout (1000); });
			    t.popuptrone.centerMe (mainPop.getMainDiv());
		      }
		      t.popuptrone.getMainDiv().innerHTML = m;
	  t.popuptrone.getTopDiv().innerHTML = '<b><CENTER>'+title+'</center></b>';
	  t.popuptrone.show(true);
  },
  countref:0,
  showthroneBAK:function(uid,UserName,Online) {
	  var t = Tabs.Marches;
	  uW.bocshowthrone = t.showthrone;
	  if (t.countref==0) {
		  fetchPlayerInfo(uid, function(r) {
			  var u = r.userInfo[0];
			  t.countref++;
			  t.showthroneBAK(uid,u.name,r.online);
		  });
		  return;
	  }
	  t.countref++;
      var params = uW.Object.clone(uW.g_ajaxparams);
      params.ctrl="throneRoom\\ThroneRoomServiceAjax";
      params.action ="getEquipped";
      params.playerId = uid;
      new MyAjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
             method: "post",
             parameters: params,
      onSuccess: function (rslt) {
		 if (rslt.ok){
           var B=0, w={}, x, C;
           var w = new Array();
	       var k=rslt.items;
	       var m="";
	       for (var K in k) {
	         x=0;
	         var F = k[K].effects;
	       	 for (var M in F) {
	           x++;
			   if (k[K].quality >= x) {
	                    B++;
	                    I = uW.cm.thronestats.effects[F[M].id];
	                    if (uW.cm.thronestats.tiers[F[M].id][F[M].tier]) z = uW.cm.thronestats.tiers[F[M].id][F[M].tier];
	                    else z =uW.cm.thronestats.tiers[F[M].id][F[M].tier-1];
	                    C = + (z.base + ((k[K].level * k[K].level + k[K].level) * + z.growth * 0.5)).toFixed(2);
	                    if (!w[F[M].id]) w[F[M].id] = {};
	       	     		if (!w[F[M].id].percent) {
	       	     			w[F[M].id].percent = C;
	       	      		} else {
	       	     			w[F[M].id].percent += C;
	       	     		}
	       	    		w[F[M].id].name = I[1];
	       	    		w[F[M].id].name2 = I[2];
	           }
	         }
	        }
	  m+="<table border=0 width=290 cellpadding=1 cellspacing=0>";
	  var final = new Array();
	  for (var K in w) {
		  final.push({id:K,name:w[K].name,name2:w[K].name2,percent:w[K].percent});
	  }
	  var cText = "";
	  final=final.sort(function sort(a,b) {a = a['name2'];b = b['name2'];return a == b ? 0 : (a < b ? -1 : 1);});
	  for (var K in final) {
	   if (final[K].percent>0 || final[K].percent<0) {
	    var Current =  Math.round(final[K].percent*100)/100;
	    if (final[K].name2.indexOf('Defense')>=0 || final[K].name2.indexOf('Life')>=0  || final[K].name2.indexOf('Attack')>=0  || final[K].name2.indexOf('Speed')>=0   || final[K].name2.indexOf('Range')>=0  || final[K].name2.indexOf('Accuracy')>=0  || final[K].name2.indexOf('Load')>=0)
	         couleur="#000"
	    else
	         couleur="#666";
	    G="<tr><td align=right><font color='"+couleur+"'><b>"+ Current + " %</b></td><td align=left><font color='"+couleur+"'><span title='"+ final[K].name2 + "'>" + final[K].name + "</span></td></tr>";
	    HisContent = Current + " % " +  final[K].name;
	    cText +=  HisContent + "||";
	    m+=G;
       }
	  }
	  m+="</table>";
	  m+="<br><center><input type=button  class=pbButton id=BOautoref value=''>&nbsp;<input type=button  class=pbButton id=BOposttochatte value='Post to chat'>";
      var title=UserName;
      if (t.popuptrone==null){
        t.popuptrone = new CPopup('BOpopuptrone', 0, 0, 320, 544, true, function() { t.refreshgo="OFF";clearTimeout(t.refreshtimer); });
	    t.popuptrone.centerMe (mainPop.getMainDiv());
      }
      cText = cText.replace(/\|\|\s*$/, "");
      cText = title + "|| "+ cText;
      t.popuptrone.getMainDiv().innerHTML = "<div style='max-height:500px; height:500px; overflow-x:auto; overflow-x:auto;'>" + m + "</div>";
      var n="";
      if (Online) n = '<bR><span style="color:#f00;">('+uW.g_js_strings.commonstr.online+')</span>';
	  t.popuptrone.getTopDiv().innerHTML = '<b><CENTER>'+title+'&nbsp;'+n+'</center></b>';
	  t.popuptrone.show(true);
	  if (t.refreshgo=="OFF") {
		  ById("BOautoref").value="Refresh Auto OFF";
	  }else{
		  ById("BOautoref").value="Refresh Auto ON";
		  clearTimeout(t.refreshtimer);
		  t.refreshtimer=setTimeout(function() { t.showthroneBAK(uid,UserName,Online); },1500);
	  }
	  ById("BOposttochatte").addEventListener('click', function(){

		 sendChat ("/a "+  cText);

	  },false);
	  ById("BOautoref").addEventListener('click', function(){

		  if (t.refreshgo=="OFF") {
			  t.refreshgo="ON";
			  t.countref=0;
			  ById("BOautoref").value="Refresh Auto ON";
			  t.refreshtimer=setTimeout(function() { t.showthroneBAK(uid); },200);
		  }else{
			  t.refreshgo="OFF";
			  ById("BOautoref").value="Refresh Auto OFF";
			  clearTimeout(t.refreshtimer);
			  t.countref=0;
		  }


	  },false);

      }
     },
   });
  },
  popuptrone:null,
  refreshgo:"OFF",
  refreshtimer:null,
  butToggleDefMode : function (cityId){
        var t = Tabs.Marches;
        var mode = 1;
        if (Seed.citystats["city" + cityId].gate != 0)
          mode = 0;
        Tabs.Overview.ajaxSetDefMode (cityId, mode, function (newMode){
            t.defMode[cityId] = newMode;
            t.displayDefMode (cityId);
          });
      },

      displayDefMode : function (cityId){
        var t = Tabs.Marches;
        var but = ById('BOSabut_'+ cityId);
        if (t.defMode[cityId]){
          but.className = 'BODefButOn';
          but.value = lang.Overview.def+' = ON';
        } else {
          but.className = 'BODefButOff';
          but.value = lang.Overview.def+' = OFF';
        }
  },
  showAttacks : function (){
      var t = Tabs.Marches;
      clearTimeout (t.displayTimer);
      function addListener (but, i){      	 but.addEventListener ('click', function (){t.butToggleDefMode(i)}, false);       }
      var now = unixTime();
      var target, atkType, who, atkclass;
      if (t.state==null) {
		uW.BOTowerPost = Tabs.Options.postToChat;
       var ss = '<div class=boStat>'+uW.g_js_strings.modaltitles.impatks.toUpperCase()+'</div>';
       var s = '';
       s += '<STYLE> .eclkk{background:#ffff55;} .attackkk{background:#ff5555;} .attackkA{background:#ff9955;}.tot{background:#f0e0f8;} .city{background:#ffffaa;} .entete{background:#efa9a9;}</style>';
       s += '<TABLE border=0 cellspacing=0 cellpadding=2 class=ptTab><tr>';
       for (k= 1; k <= Seed.throne.slotNum; k++)
	    	{
	             s += '<td><button class="'+(Seed.throne.activeSlot==k?"pbButton_selected":"pbButton")+'" id="BOMarchTrone_'+k+'">'+ k +' - '+ThroneOptions.presetname[k]+'</button>';
	    }
       s+='</tr></table>';
       s += '<TABLE border=0 cellspacing=0 cellpadding=2 width=100% class=ptTab><tr>';
       for(i=0; i<Cities.numCities; i++) {
	            cityID = 'city'+ Cities.cities[i].id;
	            var couleurr="#77EE77";
	            s += '<TD width=90 style="background-color:'+couleurr+'"><SPAN class=oohfancy>'+ Cities.cities[i].name.substring(0,12) +'</SPAN><BR><INPUT type=button id="BOSabut_'+Cities.cities[i].id+'" value=""></td>';
      }
       s += '<td></tr></table><TABLE border=0 cellspacing=0 cellpadding=2 width=100% class=ptTab>';
       s += '<tr><td width=25></td><td width=80><b>'+uW.g_js_strings.commonstr.timeremaining+'</td><td width=50><b>'+lang.marchs.attackcol2+'</td><td width=140 colspan=2 align=center><b>'+uW.g_js_strings.commonstr.location+'</td><td width=150 colspan=2><b>'+uW.g_js_strings.commonstr.attacker+'</td><td width=30><b>'+uW.g_js_strings.commonstr.distance.substring(0,4)+'</td><td width=25><b>'+uW.g_js_strings.commonstr.knight.substring(0,4)+'</td><td width=200><b>'+uW.g_js_strings.commonstr.troops+'</td></tr>';
       s += '</table><div id="BOattaqueimmi" style="height:'+(Options.HauteurBoite-70)/2+'px;max-height:'+(Options.HauteurBoite-70)/2+'px;overflow-y:auto">';
       s += '</div><br><div class=boStat>'+lang.marchs.title2.toUpperCase()+'</div><div id="BOcampement" style="height:'+(Options.HauteurBoite-250)/2+'px;max-height:'+(Options.HauteurBoite-250)/2+'px;overflow-y:auto"></div>';
       t.state=1;

       t.marchDiv.innerHTML = s;
       for(i=0; i<Cities.numCities; i++) {
	   	  	            cityId = Cities.cities[i].id;
	   	  	           	var but = ById('BOSabut_'+ cityId);
	   	  	           	addListener (but, cityId);
	   }
      }
	  for(i=0; i<Cities.numCities; i++) {
			 cityId = Cities.cities[i].id;
			 t.defMode[cityId] =  parseInt(Seed.citystats["city" + cityId].gate);
	  	     t.displayDefMode (cityId);
 	  }
 	  for (k= 1; k <= Seed.throne.slotNum; k++)
	    	{
				ById("BOMarchTrone_"+k).addEventListener ('click', function( ) {
					var p = this.id.replace("BOMarchTrone_","");
					Tabs.Throne.doPreset(p);
				}, false);
			}
      var at=0,s = '<TABLE border=0 cellspacing=0 cellpadding=2 width=100% class=ptTab00>';
      if(Seed && Seed.queue_atkinc) {
       var sortem = [];
       for (var k in Seed.queue_atkinc)
          sortem.push (Seed.queue_atkinc[k]);

        sortem.sort (function (a,b){
          var x; if ((x = a.arrivalTime-b.arrivalTime)!=0)
            return x;
          return b.arrivalTime-a.arrivalTime;
        });
       enc = {};
	   numSlots = 0;
       for (i=0; i<sortem.length; i++){
          var m = sortem[i];
            if (m.marchType == 2){
		  	            ++numSlots;
		  	            city = m.toCityId;
		  	            from = m.fromPlayerId;
		  	            if (!enc[city])
		  	              enc[city] = {};
		  	            if (!enc[city][from])
		  	              enc[city][from] = [];
		  	            rr = {};
		  	            rr.from = from;
		  	            rr.city = city;
		  	            rr.knight = parseInt (m.knightCombat);
		  	            rr.marchId = k.substr(1);
		  	            rr.destinationUnixTime= m.destinationUnixTime;
		  	            rr.fromXCoord = m.fromXCoord;
		  	            rr.fromYCoord = m.fromYCoord;
		  	            rr.troops = [];
		  	            var pp=0;
		  	  		    for (y in uW.unitcost) {
		  	  				pp++;
		  	              if (parseInt (m['unit'+ pp +'Return'])>0)
		  	                rr.troops[pp] = parseInt (m['unit'+ pp +'Return']);
		  	              else
		  	                rr.troops[pp] = parseInt (m['unit'+ pp +'Count']);
		  	            }
		  	            enc[city][from].push (rr);
	          }
      	if (m.marchType == 3){
	      atkType = uW.g_js_strings.commonstr.scouting;
	      atkclass = 'eclkk';
	    } else if (m.marchType == 4){
	      atkType = uW.g_js_strings.commonstr.atk;
	      atkclass = 'attackkk';
	       var nbtroupe=0;
	       for (k in m.unts){
	                nbtroupe += parseInt(m.unts[k]);
                }
	        if (nbtroupe==1) {
	         atkclass = 'attackkA';
	        }

	    } else {
	      atkType ="?";
	      atkclass = '';
    	 }
    	 if (atkclass !='') {
    	 at++;


    	 s += '<tr align=left class="'+atkclass+'"><td width=25><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sKHgUKLm6pWe8AAAM6SURBVEjH1VU9TCNHFP7e7OwQg4X5LSI5oYAE0hzQIKQAUQJdihQWbSTadKko0iUoRQoqJCRCARIdOlGcTo4QETqJCBRRoJjQbGEIYAdEIMgL6xu8M1fEcxrbu3BtRnranZ3Z9733vvfNAP/3QY8tzs7Ofjg4ONhGRDpqXWvdMCciuri4eDg9PT2dn5/3+SPOO/v6+l6k0+lnTzmvB0omkxXO+beZTGYpFkBrPTY+Pv6sv78fYRg+CWDPiYhns9mvhBDPYwGIKNHS0oL7+3uttaYoZ/bTtubmZmitGREx9ggFytSUiGLLUh+9taYB6FiAUqlUJiIwxkBEiHrnnD8JyDOZTGp0dPTrdDr9mRDCdIIul8sfeJ6Hk5OThgjN8H0fIyMjIKLYPXxsbGxoeHj4h4GBgZRNZvUnbVq5vjyMMRQKBeTzefT29tZwUAPQ3d3d0dbWlurq6oKUUtvaICKqJ9V20NTUhIODgwaiawAcx/mPUaWglCITvflmP+vBGGORjms4iGjPyPaLAjDAj2YQJSCzSSkVKyirFUkppQGAMUbWfl0DEBVpnKjsc8f3/TCZTDqlUglaa1UsFsPLy0v37OzsVblc/odHpRhXkvpvRITd3d0NIcQXExMTHblc7nhhYeF713Vfra6uHr/NwPxkk/kuxwIRIQzD3zY2Nhaurq5We3p6WlKplLu4uHhsAmdxGbyLEREeHh4Sy8vLv8/NzX2+vr7+orW19dPp6el0NXiHm1Srram11hSnSisjbQ4opRQH8J7nef96nvfN1NTU++3t7cLoid/c3AS3t7fwfR8AyHXdtwoOgqChbY0AAaBQKEBr/RcAWa2Gu7W1VQSghBCQUip+dHT0hxDip0qlMui67idDQ0NprTXL5XJ/VyqVP+0ympvNgB4eHhavr69fAnhtTk9jUsqaK7MJQPvS0tLy5OTkl/l8vri2tvbdzs7OPufcsZyHjDHlOI4SQmB/fz8PQCYSCQRBEFlXLoRgUsrXMzMzH9/d3X20t7f36/b29s8rKyu/VIkyGaiqhZYBAA+CIDTCagCQUioArLOzs+P8/PzHzc3NvWw2ewJAVJ0oS5kqYm7vaRhvACc0jXTcDMdmAAAAAElFTkSuQmCC" onclick="BOTowerPost('+m.mid+',true,'+m.cityId+')"></td>';

    	 var arrivedans = uW.timestr(parseInt(m.arrivalTime - unixTime()));
    	 s += '<td width=80 class="'+atkclass+'">' + arrivedans +'</td>';
    	 var couelur="",coordos="";
    	 var city = Cities.byID[m.toCityId];
    	 if (city.tileId == m.toTileId) {
           target = '<a onclick="citysel_click(document.getElementById(\'citysel_'+ (city.idx+1)+'\'));">'+ city.name.substring(0,10) +'</a>';
           cityID = 'city'+ m.toCityId;
	   Gate = parseInt(Seed.citystats[cityID].gate);
	   if(Gate == 0) {
	   	bouttt = '<input type=button value="OFF" style="background-color:#00AA00;padding:2px;border:1px solid yellow;">';
	   	}	   else {
		bouttt = '<input type=button value="ON"  style="background-color:red;">';
		}
           coordos = '<a class="coordinateLink" onclick="cm.utils.CoordinateLinkController.onClick(event)" href="javascript:void(0)">('+ city.x + ',' + city.y +')</a>';
         } else {
           target = lang.marchs.targetTS;
           bouttt='';
           for (k in Seed.wilderness['city'+m.toCityId]){
            if (Seed.wilderness['city'+m.toCityId][k].tileId == m.toTileId){
             coordos = '<a class="coordinateLink" onclick="cm.utils.CoordinateLinkController.onClick(event)" href="javascript:void(0)">('+Seed.wilderness['city'+m.toCityId][k].xCoord + ',' + Seed.wilderness['city'+m.toCityId][k].yCoord+')</a>';
             break;
            }
           }
         }
         s += '<td width=50 class="'+atkclass+'" align=center>'+bouttt+'</td><td class="'+atkclass+'" align=center width=100><b>' + target + '<td width=40 class="'+atkclass+'" align=center>'+coordos+'</b></td>';

         if (Seed.players['u'+m.pid]) {
	       who = '<span><a href="javascript:void(0);" onclick=boshowthrone('+m.pid+',"'+Seed.players['u'+m.pid].n+'","Calc");>'+Seed.players['u'+m.pid].n +'</a> '+addCommas(Seed.players['u'+m.pid].m)+'</span>';
	     } else if (m.players && m.players['u'+m.pid]) {
	      who = m.players['u'+m.pid].n;
	     }  else{
	      who = lang.marchs.unknow;
      	 }
      	 if (m.fromXCoord) {
      	  who += '</td><td width=50 class="'+atkclass+'"><a class="coordinateLink" onclick="cm.utils.CoordinateLinkController.onClick(event)" href="javascript:void(0)">(' + m.fromXCoord +','+ m.fromYCoord+')</a>';
      	 } else {
      	  who += '</td><td width=50 class="'+atkclass+'">???</a></td>';
      	 }
      	 s += '<td class="'+atkclass+'" width=100>' + who + '</td>';
      	 if (m.fromXCoord) {
      	  s +='<td class="'+atkclass+'" width=30>'+ distance(city.x,city.y,m.fromXCoord,m.fromYCoord) +'</td>';
      	 } else {
      	   s +='<td class="'+atkclass+'" width=30>&nbsp;</td>';
      	 }
         var troupe = "";
         for (k in m.unts){
          var uid = parseInt(k.substr (1));
          troupe += m.unts[k] +' '+ uW.unitcost['unt'+uid][0] +'<br>';
         }
         var knh='&nbsp;';
         if (m.knt) {
	       if (m.knt['cbt']!=undefined && m.knt['cbt']!=null) knh=parseInt(m.knt['cbt']);
         }
	     s += '<td class="'+atkclass+'" width=25>'+knh+'</td>';
         s += '<td class="'+atkclass+'"  width=200>' + troupe +'</td>';

         s += '</tr>';
         }
      	}
      	s+='</table>';
      	if (at==0) {
      	 s ="<tr><colspan=4><br><center>"+uW.g_js_strings.ImpendingAttacks.noIncomingAttacks+"...</td></tr></table>";
      	}
      }
      ById("BOattaqueimmi").innerHTML=s;

      var s="";

	  if (numSlots == 0){
	        s += '<BR><CENTER><B>'+lang.marchs.notroops+'</b></center>';
	      } else {

	        s += '<TABLE cellspacing=0 cellpadding=2 width=100%>\
	        <tr><td class="entete">'+lang.marchs.refcol1+'</td><td class="entete">'+lang.marchs.refcol2+'</td><td class="entete">'+lang.marchs.refcol3+'</td><td class="entete">'+uW.g_js_strings.commonstr.knight+'</td><td colspan=12 class="entete">'+uW.g_js_strings.commonstr.troops+'</td><td class="entete">'+lang.marchs.refcol5+'</td></tr>';
	        tot = [];
	        totent= 0;
	        var i=0;
	  	  	for (y in uW.unitcost) {
	  		i++;
	          tot[i] = 0;
	        }
	        for (c in Cities.cities){
	          dest = Cities.cities[c].id;
	          var emb = getCityBuilding(m.toCityId, 8);
	          if (enc[dest] && emb.count>0){
	            s+= '<TR><TD class="city" colspan=17 align=left><B>'+uW.g_js_strings.commonstr.city+' ' + (parseInt(c)+1) + ' : '+ Cities.cities[c].name +'</b></td></tr>';
	            for (p in enc[dest]){

				  	                try {
				  						                player = Seed.players['u'+p].n;
				  						              } catch (err){
				  						                player = '???';
	                }

	              for (m=0; m<enc[dest][p].length; m++){
	                var march = enc[dest][p][m];
	                knight = '';



	                if (march.knight > 0)
	                  knight = ' '+ march.knight +'';

	                 s += '<TR align=left><td align=left width=12%>';
	                arrivedans = uW.timestr(parseInt(march.destinationUnixTime - unixTime()));
	  		      arrivedanssec = parseInt(march.destinationUnixTime - unixTime());
	  		      if (arrivedanssec<=0) {
	  				  s+='<A class=button20 onclick="r8x6Home('+ march.marchId +')"><SPAN>'+uW.g_js_strings.commonstr.dismiss+'</span></a></td>';
	  		      }else{
	  			      s+=''+arrivedans+'</td>';
	  		      }

	                s+='<TD align=left><a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+march.fromXCoord+','+march.fromYCoord+')'+'</a></td>\
	                <TD align=left width=25%>'+ player +' </td><td align=left>'+ knight+'</td><td colspan=12>'
	                var g=0,i=0;

	  			  for (y in uW.unitcost) {
	  			   i++;
	                 if (march.troops[i] > 0) {
	                  s += ''+ march.troops[i]  +' '+ uW.unitcost[y][0].substring(0,15) +'<br>';
	                 }
	                 tot[i] += march.troops[i];
	                 g+=parseInt(march.troops[i])*parseInt(uW.unitupkeeps[i]);

	                }
	                totent += g;
	                s += '</td><td>';
	                s += addCommas(g) + '</td></tr>';
	              }
	            }
	          }
	        }
	        s += '<TR><TD colspan=17><BR><BR></td></tr></table><TABLE cellspacing=0 cellpadding=2 width=100%><tr><td colspan=1></td>';
	         for (y in uW.unitcost)
	                s += '<TD width=7% align=center><B>' + uW.unitcost[y][0].substring(0,5)+ '</b></td>';

	        s += '</tr>';
	        s += '<TR align=center><TD class="tot" align=left width=10% rowspan=2><B>'+lang.marchs.tot+'</b></td>';
	        var i=0;
	  	  for (y in uW.unitcost) {
	  		i++;
	          s+= '<TD class="tot">'+ tot[i] +'</td>';
	        }
	        s += '</tr><td colspan=12>'+lang.marchs.refcol5+' : '+addCommas(totent)+' '+lang.marchs.foodh+'</td></table>';
	      }
	      s += '<BR><BR><DIV style="font-size: 10px"><b>'+lang.marchs.comment+'</b></div>';

	ById("BOcampement").innerHTML=s;
    t.displayTimer = setTimeout (t.showAttacks, 1000);
  },
  showMarches : function (numville){
      var t = Tabs.Marches;
      var rownum = 0;
      var now = unixTime();
      clearTimeout (t.displayTimer);
      if (t.state == null){
       var s = '<div class=boStat>'+uW.g_js_strings.modal_openRallypoint.troopmove+' ('+uW.g_js_strings.commonstr.remove+' Raid :<input id=BOVoirRaid type=checkbox '+ (!Options.voirRaid?'':' CHECKED ') +'>) - <input type=button value="?" id=boaidemarches1 class=boAide></div>';
       s += '<STYLE> .tot{background:#f0e0f8;} .city{background:#ffffaa;}</style><input style="font-size:12px" type=button id="9_BOVilleBouton" value="0">';
       for (var c=0; c<Cities.numCities; c++){
            s += '<input style="font-size:12px" type=button id="'+ c +'_BOVilleBouton" value="' + (parseInt(c)+1) + ' : '+ Cities.cities[c].name.substring(0,10) +'">';
       }
       s += '<div id="showMarchDiv"></div>';
       t.marchDiv.innerHTML = s;
        ById('boaidemarches1').addEventListener('click', function(){
           	       	 window.open(sitesupport+"?page=aide_marches1");
    	} , false);
       ById('BOVoirRaid').addEventListener('click', function() {

         Options.voirRaid = ById('BOVoirRaid').checked;
         saveOptions();

       }, false);

       ById("9_BOVilleBouton").addEventListener('click', function(){
                           var t = Tabs.Marches;
                           clearTimeout (t.displayTimer);
                           t.showMarches(this.id.substring(0,1));

       }, false);

       for (var c=0; c<Cities.numCities; c++){
          ById(c + "_BOVilleBouton").addEventListener('click', function(){
                    var t = Tabs.Marches;
                    clearTimeout (t.displayTimer);
                    t.showMarches(this.id.substring(0,1));
           }, false);
       }
       t.state = 1;
      }
      s = '<TABLE cellspacing=0 cellpadding=2 width=100% class=ptTab>';
      tot = [];
      for (i=0; i<20; i++)  tot[i] = 0;
      var nbmarche=0;
      for (var c=0; c<Cities.numCities; c++){
		if (numville==9 || numville==c) {
         var que = Seed.queue_atkp['city'+ Cities.cities[c].id];
         if (matTypeof(que)=='object') {
          var a=0;
          for (k in que) {
           march = que[k];
           if ((!Options.voirRaid) || (march.marchType!=9 && Options.voirRaid) ) {
            a++;
            if (a==1) {
      	     var cityID = 'city'+ Cities.cities[c].id;
      	     var slots=March.RallyPoint(Cities.cities[c].id).marching;
	 		 var niveauPointRall=March.RallyPoint(Cities.cities[c].id).maxSlots;
      	     s+= '<TR class="city"><TD class="city">'+lang.marchs.PR+' : '+slots+' / '+niveauPointRall+'</td><TD class="city" colspan=19 align=center><font size=3><B><i><u>'+uW.g_js_strings.commonstr.city+' ' + (parseInt(c)+1) + ' : '+ Cities.cities[c].name +'</b></td></tr>';
      	    }
		    nbmarche++;
            var mid = k.substr(1);
            knight = '';
            if (Seed.queue_atkp['city'+ Cities.cities[c].id][k]["knightId"] !=0){
		    for (i in Seed.knights['city'+ Cities.cities[c].id])
		      if (i == ("knt" + Seed.queue_atkp['city'+ Cities.cities[c].id][k]["knightId"]) ) knight = '' +Seed.knights['city'+ Cities.cities[c].id][i]["combat"] +'';
              } else knight = '';
            var playerId = march.toPlayerId,player='';
	        if (playerId==undefined) playerId=0;
            var cityId = march.toCityId,tileType = parseInt(march.toTileType),tileLevel = march.toTileLevel,who = lang.marchs.unknow;
            if (Seed.players['u' + playerId]) who = Seed.players['u' + playerId].n;
		    if (march.marchType==1) player = "<span>"+lang.marchs.citylevel+" "+ tileLevel +"</span>";
		    else player = "<span title=''>"+lang.marchs.boglevel+" "+ tileLevel +"</span>";
		    if (march.marchType==10 || march.marchType==11) player = "<span>"+lang.marchs.folevel+" "+ tileLevel +"</span>";
		    var numtile=parseInt(tileType/10) + 1;
		    if (tileType==10) numtile=1;
		    if (tileType==11) numtile=2;
            if (tileType <= 50) player = tileNames[numtile] +" " + tileLevel;
            if (tileType == 51 && playerId == 0 && march.toTileLevel==7) player = uW.g_js_strings.commonstr.city+" " + tileLevel;
            if (tileType == 51 && playerId == 0 && march.toTileLevel==9) player = lang.marchs.barblevel+" " + tileLevel;
            if (tileType == 54 && playerId == 0) player = lang.marchs.folevel+" " + tileLevel;
            if (tileType == 55 && playerId == 0) player = "Merc " + tileLevel;
            var nomville="";
            if (playerId > 0 && tileType == 51) {
                 if (march.marchType==1) {
                  for(i=0; i<Cities.numCities; i++) {
                   if (cityId==Cities.cities[i].id) {
                     nomville=Cities.cities[i].name
                     break;
                   }
                  }
                  player = lang.marchs.mycity+' '+ nomville;
                 } else {
                  player = lang.marchs.citylevel+' '+ tileLevel;
                 }
            }
            var typeattack="?";
            if (march.marchType==3) typeattack=uW.g_js_strings.commonstr.scouting;
            if (march.marchType==4) typeattack=uW.g_js_strings.modal_barracks_train.attack;
            if (march.marchType==10) typeattack=uW.g_js_strings.modal_barracks_train.attack;
            if (march.marchType==11) typeattack=uW.g_js_strings.commonstr.scouting;
            if (march.marchType==1) typeattack=uW.g_js_strings.commonstr.transporting;
            if (march.marchType==2) typeattack=uW.g_js_strings.commonstr.defending;
            if (march.marchType==5) typeattack=uW.g_js_strings.commonstr.reassign;
            if (march.marchType==9) typeattack=uW.g_js_strings.modal_barracks_train.attack + ' Raid';
            var now = new Date();
            var statusm = march.marchStatus;
            var Marchstatut="<span title='Type : "+march.marchType+" "+uW.g_js_strings.commonstr.status+" : "+statusm+"'>?</span> ";
            var arrivedans="0s";
            var arrivedanssec=0;
		    if (statusm==1) {
		     Marchstatut="";
		     if (march.marchType==3 || march.marchType==11) Marchstatut+='<img src="'+gameurl+'img/scouting.jpg" align=absmiddle>';
		     if (march.marchType==4 || march.marchType==10) Marchstatut+='<img src="'+gameurl+'img/attacking.jpg" align=absmiddle>';
		     if (march.marchType==9) Marchstatut+='<img src="'+gameurl+'img/attacking.jpg" align=absmiddle>';
		     if (march.marchType==1) Marchstatut+='<img src="'+gameurl+'img/transporting.jpg" align=absmiddle>';
             if (march.marchType==5 || march.marchType==2) Marchstatut+='<img src="'+gameurl+'img/reinforce.jpg" align=absmiddle>';
		     Marchstatut+="&nbsp;"+uW.g_js_strings.commonstr.marching;
		     arrivedans = uW.timestr(parseInt(march.destinationUnixTime - unixTime()));
		     arrivedanssec = parseInt(march.destinationUnixTime - unixTime());
		    }
            if (statusm==8) {
                  Marchstatut = '<img src="'+gameurl+'img/returning.jpg" align=absmiddle>&nbsp;'+uW.g_js_strings.commonstr.back;
                  arrivedans = uW.timestr(march.returnUnixTime - unixTime());
                  arrivedanssec = parseInt(march.returnUnixTime - unixTime());
            }
            if (statusm==2) {
                   Marchstatut='<img src="'+gameurl+'img/reinforce.jpg" align=absmiddle>&nbsp;'+uW.g_js_strings.commonstr.encamped;
            }
            if (statusm==5) {
                   Marchstatut='<img src="'+gameurl+'img/reinforce.jpg" align=absmiddle>&nbsp;'+uW.g_js_strings.attack_generatequeue.waitreport;
            }
            if (statusm==4) {
		     Marchstatut='<img src="'+gameurl+'img/autoAttack/raid_resting.png" align=absmiddle>&nbsp;' + uW.g_js_strings.attack_generatequeue.unloadingloot;
            }
            if (statusm==3) {
		     Marchstatut='<img src="'+gameurl+'img/autoAttack/raid_stopped_desat.png" align=absmiddle>&nbsp;' + uW.g_js_strings.attack_generatequeue.raidstopped;
		    }
 			s += '<TR align=left><td align=left width=10%>';
            if (march.marchType!=9 && statusm==1 && arrivedanssec>60) s +='<A class=button20 onclick="pr58Recall('+ mid+','+Cities.cities[c].id+')"><SPAN>'+uW.g_js_strings.commonstr.recall+'</span></a>';
	        if (march.marchType!=9 && march.marchType!=2 && statusm==2) s +='<A class=button20 onclick="attack_recall('+ mid+', 1, '+Cities.cities[c].id+');"><span>'+uW.g_js_strings.commonstr.recall+'</span></a>';
	        if (march.marchType==2 && statusm==2) s +='<A class=button20 onclick="pr57Recall('+ mid+');"><span>'+uW.g_js_strings.commonstr.recall+'</span></a>';
	        if (march.marchType==9 && statusm==10 && arrivedanssec<=0) s +='<A class=button20 onclick="BOraid_delete('+ mid+','+Cities.cities[c].id+');return false;"><span>'+uW.g_js_strings.commonstr.remove+'</span></a>';
            s +='</td><td align=left width=10%>'+typeattack+'</td><td>'+arrivedans+'</td><td align=left width=15%>' + Marchstatut +'</td>\
                <TD align=left width=15%>' + player + '</td><td><a class="coordinateLink" onclick="cm.utils.CoordinateLinkController.onClick(event)" href="javascript:void(0)">(' + march.toXCoord +','+ march.toYCoord +')</a></td><td>' + knight +' </td><td colspan=12>'
	        var i=0;

		    for (y in uW.unitcost) {
			   i++;
	           if (statusm==8 || statusm==2) {
	               if (parseInt (march['unit'+ i +'Return']) > 0) {
	      	           s += uW.unitcost['unt'+i][0].substr(0,12)+" :" + parseInt (march['unit'+ i +'Return']) + "<br>";
	      	          tot[i] += parseInt (march['unit'+ i +'Return']);
	               } else {
	                 if (parseInt (march['unit'+ i +'Count']) > 0) {
				   	                       s += uW.unitcost['unt'+ i][0].substr(0,12) +" :" + parseInt (march['unit'+ i +'Count']) + "<br>";
				   	                       tot[i] += parseInt (march['unit'+ i +'Count']);
	                   }
			      }
 			   } else {
	                   if (parseInt (march['unit'+ i +'Count']) > 0) {
	                       s += uW.unitcost['unt'+ i][0].substr(0,12) +" :" + parseInt (march['unit'+ i +'Count']) + "<br>";
	                       tot[i] += parseInt (march['unit'+ i +'Count']);
	                   }
	           }
            }
            s += '</td><td style="font-size:11px">';
      		if (march.marchType!=9) {
      		  s += '<a  class=button20 onclick="view_march('+ mid+');return false;";><span>'+uW.g_js_strings.commonstr.view+'</psan></a></td>';
      		  }else {
      		  s+='</td>';
      		  }
                s += '</tr>';
            } // fin condiftion
		} // for (k in que) {
     }  // if (matTypeof(que)=='object') {
    } // si juste la ville
   } // fin boucle ville
   if (nbmarche>0) {
       s += '<TR><TD colspan=20><BR><BR></td></tr></table><TABLE cellspacing=0 cellpadding=2 width=100%><tr><td colspan=1></td>';
       var r=0;
 	   for (y in uW.unitcost) {
		    r++;
 			     	   s += '<TD width=7% align=center><B><img title="' + uW.unitcost['unt'+r][0] + '" src='+gameurl+'img/units/unit_'+r+'_30.jpg></b></td>';
				   }
 			    	 s += '</tr>';
 			     	 s += '<TR align=center><TD class="tot" align=left width=10%><B>'+lang.marchs.tot+'</b></td>';
 			    	 var r=0;
 				 	 for (y in uW.unitcost)  {
 				  	  r++; s+= '<TD class="tot">'+ addCommas(tot[r]) +'</td>';
 				 	 }
 			         s += '<td></td></tr></table>';
	     s += '<BR><BR><DIV style="font-size: 10px"></div>';
	}else{
		  s += '<br><br>'+lang.marchs.nomarch;
	}
    ById('showMarchDiv').innerHTML = s;
    t.displayTimer = setTimeout (function() { t.showMarches(numville);   }, 1000);
  },
  ajaxDeleteRaid: function(marchId, cityId) {
      var villeencours=cityId;
               var march = Seed.queue_atkp["city" + villeencours]["m" + marchId];
               if (march == null){
                            return;
               }
               var params = uW.Object.clone(uW.g_ajaxparams);
               params.action="deleteMarch";
               params.marchId = marchId;
           params.ctrl="BotManager";
           params.settings={cityId:villeencours};
      	   uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
onSuccess:function(transport) {
  var m = eval("(" + transport.responseText + ")");
   if (m.ok){
            var j=marchId;
            var t=cityId;
            var n=Seed.units["city"+t];
            var o=0;
			for (y in uW.unitcost) {
		     o++;
             if (m["unit"+o+"Return"]) {
              var p=parseInt(m["unit"+o+"Return"]);
              if(!isNaN(p)&&(p>0)){
               n["unt"+o]=parseInt(n["unt"+o])+p;
               }
             }
            }
            uW.cityinfo_army();
            var s="city"+t;
            var mymarch = Seed.queue_atkp["city" + t]["m" + j];
            var kngId= mymarch.knightId;
            delete Seed.queue_atkp[s]["m"+j];
            if(uW.Object.keys(Seed.queue_atkp[s]).length==0){
              Seed.queue_atkp[s]=[];
            }
            Seed.knights["city"+t]["knt"+kngId].knightStatus=1;
     } else {


     }
    }, onFailure: function () {

    },
   });
  },
  showReinforcements : function (){
   var rownum = 0;clearTimeout (t.displayTimer);
   var t = Tabs.Marches;


    t.displayTimer = setTimeout (t.show2, 2000);
  },
  butSendHome : function (marchId){
        var t = Tabs.Marches;
        t.ajaxSendHome (marchId);
   },
   ajaxSendHome : function (marchId, notify){
     var march = Seed.queue_atkinc['m'+ marchId];
     if (march == null)
         return;
     var upkeep = 0,i=0;
     for (y in uW.unitcost) {
		i++;
		upkeep += parseInt(march["unit" + i + "Return"]) * parseInt(uW.unitupkeeps[i]);
	 }
     var params = uW.Object.clone(uW.g_ajaxparams);
     params.mid = marchId;
     params.cid = march.toCityId;
     params.fromUid = march.fromPlayerId;
     params.fromCid = march.fromCityId;
     new MyAjaxRequest(uW.g_ajaxpath + "ajax/kickoutReinforcements.php" + uW.g_ajaxsuffix, {
         method: "post",
         parameters: params,
         onSuccess: function (rslt) {
           if (rslt.ok){
			 if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)}
			 do{
			 				var march=Seed.queue_atkinc["m"+params.mid];
			 				if(!march||march.marchStatus!=2){break}
			 				Seed.resources["city"+params.cid].rec1[3]=parseInt(Seed.resources["city"+params.cid].rec1[3])-upkeep;
			 				delete Seed.queue_atkinc["m"+params.mid]
			 			}
			while(false);
             if (notify != null)
               notify(null);


           } else {
			 delete Seed.queue_atkinc["m" + marchId];
             if (notify != null)
               notify(rslt.errorMsg);
           }
         },
         onFailure: function () {
           if (notify != null)
             notify(rslt.errorMsg);
         },
     });
  },
  butRecall2 : function (marchId){
     var t = Tabs.Marches;
     t.ajaxRecall2 (marchId);
  },
  ajaxRecall2 : function (marchId, notify){
    var villeencours;
          for (var c=0; c<Cities.numCities; c++){
            var que = Seed.queue_atkp['city'+ Cities.cities[c].id];
            if (matTypeof(que)=='array')
              continue;
            for (k in que){
              if (k == 'm'+marchId){
                villeencours = Cities.cities[c].id;
                break;
              }
            }
        }
     var march = Seed.queue_atkp["city" + villeencours]["m" + marchId];
           if (march == null){
             return;
           }
           var params = uW.Object.clone(uW.g_ajaxparams);
           params.mid = marchId;
           params.cid = villeencours;
           new MyAjaxRequest(uW.g_ajaxpath + "ajax/undefend.php" + uW.g_ajaxsuffix, {
               method: "post",
               parameters: params,
               onSuccess: function (rslt) {
                 if (rslt.ok){
                   if(rslt.updateSeed){
		   Seed.queue_atkp["city"+params.cid]["m"+params.mid].marchStatus=8;
		   var marchtime=parseInt(Seed.queue_atkp["city"+params.cid]["m"+params.mid].returnUnixTime)-parseInt(Seed.queue_atkp["city"+params.cid]["m"+params.mid].destinationUnixTime);
		   var ut=uW.unixtime();
		   if(Seed.playerEffects.returnExpire>ut){marchtime*=0.5}
		   Seed.queue_atkp["city"+villeencours]["m"+marchId].destinationUnixTime=rslt.destinationUnixTime||ut;
		   Seed.queue_atkp["city"+villeencours]["m"+marchId].returnUnixTime=rslt.returnUnixTime||ut+marchtime*rslt.returnMultiplier;
		   Seed.queue_atkp["city"+villeencours]["m"+marchId].marchStatus=8;
 		  }
 		 }
        }, onFailure: function () { },
     });

  },
  ajaxRecall : function (marchId, cid, notify){
       var params = uW.Object.clone(uW.g_ajaxparams);
              params.mid = marchId;
              params.cid = cid;

              new MyAjaxRequest(uW.g_ajaxpath + "ajax/cancelMarch.php" + uW.g_ajaxsuffix, {
                  method: "post",
                  parameters: params,
                  onSuccess: function (rslt) {
                    if (rslt.ok){

                     if(rslt.updateSeed){
 		       uW.seed.queue_atkp["city"+params.cid]["m"+params.mid].marchStatus=8;
 		       var marchtime=parseInt(uW.seed.queue_atkp["city"+params.cid]["m"+params.mid].returnUnixTime)-parseInt(uW.seed.queue_atkp["city"+params.cid]["m"+params.mid].destinationUnixTime);
 		       var ut=uW.unixtime();
 		       if(uW.seed.playerEffects.returnExpire>uW.unixtime()){marchtime*=0.5}
		       uW.seed.queue_atkp["city"+cid]["m"+marchId].destinationUnixTime=rslt.destinationUnixTime||ut;
		       uW.seed.queue_atkp["city"+cid]["m"+marchId].returnUnixTime=rslt.returnUnixTime||ut+marchtime*rslt.returnMultiplier;
		       uW.seed.queue_atkp["city"+cid]["m"+marchId].marchStatus=8;
              }
              var i=0;
			   	  for (y in uW.unitcost) {
				i++;
		       uW.seed.queue_atkp["city"+cid]["m"+marchId]["unit"+i+"Return"]=parseInt(uW.seed.queue_atkp["city"+cid]["m"+marchId]["unit"+i+"Count"])
 		     }
 		    }
                  },
                  onFailure: function () {


                  },
     });

  },
};
Tabs.Search = {
  tabOrder: 4,
  tabLabel: uW.g_js_strings.commonstr.research,
  cont:null,
  state : null,
  show : function (div){
    var t = Tabs.Search;
  },
  hide : function (){
  },
  clickedPlayerDetail : function (span, uid){
    var t = Tabs.AllianceList;
    span.onclick = '';
    span.innerHTML = lang.Search.PDetail;
    t.fetchPlayerInfo (uid, function (r) {t.gotPlayerDetail(r, span)});
  },
  clickedPlayerLeaderboard : function (span, uid){
    var t = Tabs.AllianceList;
    span.onclick = '';
    span.innerHTML = lang.Search.PLeaderboard;
    t.fetchLeaderboard (uid, function (r) {t.gotPlayerLeaderboard(r, span)});
  },
  gotPlayerLeaderboard : function (rslt, span){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      span.innerHTML = rslt.errorMsg;
      return;
    }
    if (rslt.totalResults == 0){
      span.innerHTML = lang.Search.PLb2;
      return;
    }
    var p = rslt.results[0];
    var an = p.allianceName;
    if (!an || an=='' || p.officerType==4)
      an = lang.Search.ANothing;
    else
      an += ' ('+ officerId2String(p.officerType) +')';
    m = '<TABLE cellspacing=0 class=ptTab><TR><TD><B>'+uW.g_js_strings.commonstr.leaderboard+' : </b></td><TD colspan=2> '+uW.g_js_strings.commonstr.might+' : '+ p.might  +' &nbsp; '+uW.g_js_strings.commonstr.alliance+' : '+ an +'</td></tr>';
    for (var i=0; i<p.cities.length; i++){
      var c = p.cities[i];
      m += '<TR><TD align=right><B>'+uW.g_js_strings.commonstr.city+' #'+ (i+1) +':</b></td><TD> &nbsp; '+ c.cityName
      +' <a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ c.xCoord +',' +c.yCoord+ ')</a></td><TD width=75%> &nbsp; Niveau : '
      + c.tileLevel +' &nbsp; &nbsp; status: '+ cityStatusString (c.cityStatus) +' &nbsp; &nbsp; cr&eacute;de : ' + c.dateCreated.substr(0,10) +'</td></tr>';
    }
    span.innerHTML = m + '</table>';
  },
  gotPlayerDetail : function (rslt, span){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      span.innerHTML = rslt.errorMsg;
      return;
    }
    var u = rslt.userInfo[0];
    var a = lang.Search.ANothing;
    if (u.allianceName)
      a = u.allianceName +' ('+ getDiplomacy(u.allianceId) + ')';
    var m = '<TABLE cellspacing=0 class=ptTab><TR><TD><B>'+lang.Search.detail+'</b> &nbsp; </td><TD>'+uW.g_js_strings.commonstr.alliance+' : '+ a +' &nbsp; '+uW.g_js_strings.commonstr.cities+' : '
          + u.cities +' &nbsp; '+uW.g_js_strings.commonstr.population+' : '+ u.population +'</td></tr><TR><TD></td><TD>'+uW.g_js_strings.commonstr.province+' : ';
    var pids = u.provinceIds.split (',');
    var p = [];
    for (var i=0; i<pids.length; i++)
      p.push(uW.provincenames['p'+pids[i]]);
    span.innerHTML = m + p.join (', ') +'</td></tr></table>';
  },

  aName : '',
  eventSubmit : function (){
    var t = Tabs.AllianceList;
    ById('ptallErr').innerHTML='';
    t.aName = ById('allAllName').value;
    if (t.aName.length < 3){
      ById('ptallErr').innerHTML = uW.g_js_strings.getAllianceSearchResults.entryatleast3;
      return;
    }
    var myA = getMyAlliance ();
    ById('altInput').innerHTML = '';
    ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
    if (myA[0]!=0 && myA[1].toLowerCase().indexOf(t.aName.toLowerCase())>=0 )
      t.fetchAllianceList (t.aName, myA[0], t.eventGotAllianceList);
    else
      t.fetchAllianceList (t.aName, null, t.eventGotAllianceList);
  },
  init : function (div){
    var t = Tabs.Search;
    this.cont = div;
    uW.BoPTpd = t.clickedPlayerDetail;
    uW.BoPTpd2 = t.clickedPlayerLeaderboard;
    uW.BoPCpo2 = t.clickedPlayerCheckOnline;
    uW.BoPCplo2 = t.clickedPlayerGetLastLogin;
    uW.BOGetThrone = t.clickedPlayerGetThrone;
    var Provinces={1:{name:uW.provincenames["p1"],x:75,y:75},2:{name:uW.provincenames["p2"],x:275,y:75},3:{name:uW.provincenames["p3"],x:375,y:75},4:{name:uW.provincenames["p4"],x:575,y:75},5:{name:uW.provincenames["p5"],x:675,y:75},6:{name:"Paimpont",x:75,y:225},7:{name:"Cameliard",x:275,y:225},8:{name:"Sarras",x:375,y:225},9:{name:"Canoel",x:575,y:225},10:{name:"Avalon",x:675,y:225},11:{name:"Carmathen",x:75,y:375},12:{name:"Shallot",x:275,y:375},13:{name:"-------",x:375,y:375},14:{name:uW.provincenames["p13"],x:575,y:375},15:{name:uW.provincenames["p14"],x:675,y:375},16:{name:uW.provincenames["p15"],x:75,y:525},17:{name:uW.provincenames["p16"],x:275,y:525},18:{name:uW.provincenames["p17"],x:375,y:525},19:{name:uW.provincenames["p18"],x:575,y:525},20:{name:uW.provincenames["p19"],x:675,y:525},21:{name:uW.provincenames["p20"],x:75,y:675},22:{name:uW.provincenames["p21"],x:275,y:675},23:{name:uW.provincenames["p22"],x:375,y:675},24:{name:uW.provincenames["p23"],x:575,y:675},25:{name:uW.provincenames["p24"],x:675,y:675}}
    if (t.state == null){
      this.cont.innerHTML = '\
        <DIV class=ptentry><table><tr valign=bottom><TD class=xtab width=100 align=right>Type : </td><TD>\
        <SELECT id="srcType">\
          <OPTION value=0>'+uW.g_js_strings.commonstr.barbariancamp+'</option>\
          <OPTION value=1>'+uW.g_js_strings.commonstr.wilderness+'</option>\
	  <OPTION value=2>'+uW.g_js_strings.commonstr.city+'</option>\
	  <OPTION value=3>'+uW.g_js_strings.commonstr.darkForest+'</option>\
	  <OPTION value=4>'+uW.g_js_strings.commonstr.mercenaryHideout+'</option>\
        </select></td></tr>\
        </table>\
        <DIV id="srcOpts" style="height:80px"></div></div>\
        <DIV id="srcResults" style="height:400px; max-height:400px;"></div>';
      var psearch = ById ("pasrcType");
      m = '<TABLE><TR valign=middle><TD class=xtab width=100 align=right>&nbsp; X: </td><TD class=xtab>\
        <INPUT id="srchX" type=text size=3\> &nbsp; Y: <INPUT id="srchY" type=text size=3\>';
      m += '&nbsp;<span><select id="BOprovinceXY"><option>--'+uW.g_js_strings.commonstr.province+'--</option>';
      for (var i in Provinces) {
	    m += '<option value="'+i+'">'+Provinces[i].name+'</option>';
      }
      m += '</select></span> &nbsp; <SPAN id=spInXY></span>';
	  m += '</td></tr><TR><TD class=xtab align=right>'+uW.g_js_strings.commonstr.distance+' : </td><TD class=xtab>'+lang.Search.between+' <INPUT id=srcaDist size=4 value=0 /> '+lang.Search.and+' <INPUT id=srcDist size=4 value=10 /></td></tr>';
      m += '<TR><TD class=xtab></td><TD class=xtab><INPUT id=srcStart type=button class=pbButton value="'+uW.g_js_strings.commonstr.research+'"/></td></tr>';
      m += '</table>';
      ById ('srcOpts').innerHTML = m;
      var citysrc0=new CdispCityPicker ('srchdcp', ById('spInXY'), false, t.clickCitySourceSelect, Cities.byID[uW.currentcityid].idx);
      if (Options.srcTypeSelect) ById ('srcType').value=Options.srcTypeSelect;
      if (Options.srcaDist) ById ('srcaDist').value=Options.srcaDist;
      if (Options.srcDist) ById ('srcDist').value=Options.srcDist;
      ById ('srcType').addEventListener ('change', function() {
        Options.srcTypeSelect = ById ('srcType').value;
        saveOptions();
      }, false);
      ById ('srcaDist').addEventListener ('change', function() {
              Options.srcaDist = ById ('srcaDist').value;
              saveOptions();
      }, false);
      ById ('srcDist').addEventListener ('change', function() {
              Options.srcDist = ById ('srcDist').value;
              saveOptions();
      }, false);
      ById ('BOprovinceXY').addEventListener ('change', function() {
	  if (this.value >= 1) {
	      ById ('srchX').value = Provinces[this.value].x;
		  ById ('srchY').value = Provinces[this.value].y;
		  ById ('srcDist').value = "75";
	  }
	  }, false);
      ById ('srcStart').addEventListener ('click', t.clickedSearch, false);
      t.state = 1;
    }
  },
  clickCitySourceSelect : function (city){
    var t = Tabs.Search;
    t.sourceCity = city;
    ById ('srchX').value=t.sourceCity.x;
    ById ('srchY').value=t.sourceCity.y;
  },
  opt : {},
  searchRunning : false,
  tilesSearched : 0,
  tilesFound : 0,
  curX : 0,
  curY : 0,
  lastX : 0,
  firstX : 0,
  firstY : 0,
  lastY : 0,
  normalizeCoord : function (x){
    if ( x >= 750)
      x -= 750;
    else if (x < 0)
      x += 750;
    return parseInt (x/5) * 5;
  },
  clickedSearch : function (){
    var t = Tabs.Search;
    if (t.searchRunning){
      t.stopSearch (lang.Search.cancel);
      return;
    }
    t.opt.searchType = ById('srcType').value;
    t.opt.startX = parseInt(ById('srchX').value);
    t.opt.startY = parseInt(ById('srchY').value);
    t.opt.maxDistance = parseInt(ById('srcDist').value);
    t.opt.maxDistanceA = parseInt(ById('srcaDist').value);
    errMsg = '';
    if (isNaN (t.opt.startX) ||t.opt.startX<0 || t.opt.startX>749)
      errMsg = lang.Search.err1+"<BR>";
    if (isNaN (t.opt.startY) ||t.opt.startY<0 || t.opt.startY>749)
      errMsg += lang.Search.err2+"<BR>";
    if (isNaN (t.opt.maxDistanceA) ||t.opt.maxDistanceA<0)
     errMsg += lang.Search.err3+"<BR>";
    if (isNaN (t.opt.maxDistance) ||t.opt.maxDistance<1)
      errMsg += lang.Search.err4+"<BR>";
    if (t.opt.maxDistance<=t.opt.maxDistanceA)
      errMsg += lang.Search.err5+"<BR>";
    if(t.opt.maxDistanceA > 375)
       errMsg += lang.Search.err1+"<BR>";
    if (errMsg != ''){
      ById('srcResults').innerHTML = '<FONT COLOR=#660000>'+lang.Search.error+' :</font><BR><BR>'+ errMsg;
      return;
    }

    t.searchRunning = true;
    ById('srcStart').value = lang.Search.stop;
    m = '<DIV class=boStat><TABLE width=100% cellspacing=0><TR><TD class=xtab width=125><DIV id=statSearched></div></td>\
        <TD class=xtab align=center><SPAN id=statStatus></span></td>\
        <TD class=xtab align=right width=125><DIV id=statFound></div></td></tr></table></div>\
      <TABLE width=100%><TR valign=top><TD><DIV id=divOutTab style="height:'+(Options.HauteurBoite-230)+'px; max-height:'+(Options.HauteurBoite-230)+'px; overflow-y:auto; width:420px;"></div></td>\
      <TD id="tddivOutOpts" width=100% height=100% style="background:#e0e0f0; height:100%; padding:5px"><DIV id=divOutOpts></div></td></tr><tr><td colspan=2><div id=BOdivKOCAttackExport style="position:absolute;background-color:white;height:470px; max-height:470px; overflow-y:auto; width:600px;display:none"></div></td><input type=checkbox id=ShowHideOpts>'+lang.Search.ShowHideOpts+'</tr></table>';
    ById('srcResults').innerHTML = m;
    ById('ShowHideOpts').addEventListener ('click', function (){
		  if (ById("ShowHideOpts").checked) {
		  ById("tddivOutOpts").style.display="none";
		  ById("divOutTab").style.width="100%";
		  } else {
		  ById("tddivOutOpts").style.display="block";
		  ById("divOutTab").style.width="420px";
		  }
	  }, false);

    if (t.opt.searchType == 0)
      typeName = uW.g_js_strings.commonstr.barbarians;
    else if (t.opt.searchType == 1)
      typeName = uW.g_js_strings.commonstr.wilderness;
    else if (t.opt.searchType == 3)
      typeName = uW.g_js_strings.commonstr.darkForest;
	else if (t.opt.searchType == 4)
      typeName = uW.g_js_strings.commonstr.mercenaryHideout;
    else
	  typeName = uW.g_js_strings.commonstr.cities;

    m = '<CENTER><B>'+uW.g_js_strings.commonstr.research+' : '+ typeName +'<BR>\
        '+lang.Search.center+' : '+ t.opt.startX +','+ t.opt.startY +'  &nbsp; '+uW.g_js_strings.commonstr.distance+' : '+ t.opt.maxDistanceA +' -> '+ t.opt.maxDistance +'<BR></center>\
        <DIV class=ptentry><TABLE cellspacing=0 width=100%><TR align=center><TD class=xtab colspan=10><B>OPTIONS :</b><BR></td></tr>';
    if (t.opt.searchType == 1 || t.opt.searchType == 0 || t.opt.searchType == 3 || t.opt.searchType == 4) {
     m += '<TR><TD class=xtab align=right>'+lang.Search.minlevel+'</td><TD class=xtab> <INPUT id=filMinLvl size=2 value='+ Options.srcMinLevel +' /></td></tr>\
        <TR><TD class=xtab align=right>'+lang.Search.maxlevel+'</td><TD class=xtab> <INPUT id=filMaxLvl size=2 value='+ Options.srcMaxLevel +' /></td></tr>';
	}
    if (t.opt.searchType == 1){
      m += '<TR><TD class=xtab align=right>'+lang.Search.typewilderness+':</td><TD class=xtab align=right>'+uW.g_js_strings.commonstr.woods+'<INPUT id=woodWild type=CHECKBOX'+ (Options.woodWild?' CHECKED':'') +'></td></tr>';
      m += '<TR><TD class=xtab align=right>'+uW.g_js_strings.commonstr.grassland+'/'+uW.g_js_strings.commonstr.lake+'<INPUT  id=foodWild type=CHECKBOX '+ (Options.foodWild?' CHECKED':'') +'></td>\
	       <TD class=xtab align=right>'+uW.g_js_strings.commonstr.mountain+'<INPUT id=mtnWild type=CHECKBOX '+ (Options.mtnWild?' CHECKED':'') +'></td></tr>';
      m += '<TR><TD class=xtab align=right>'+uW.g_js_strings.commonstr.plain+'<INPUT id=plnWild type=CHECKBOX '+ (Options.plnWild?' CHECKED':'') +'></td>\
           <TD class=xtab align=right>'+uW.g_js_strings.commonstr.hills+'<INPUT id=hillWild type=CHECKBOX'+ (Options.hillWild?' CHECKED':'') +'></td></tr>';
      m += '<TR><TD class=xtab align=right>'+lang.Search.filter+':</td><TD class=xtab><SELECT style="width: 135px" id=idTSSrchFilter>\
             <OPTION value=0>'+lang.Search.TS0+'</option><OPTION value=1>'+lang.Search.TS1+'</option><OPTION value=2>'+lang.Search.TS2+'</option><OPTION value=3>'+lang.Search.TS3+'</option><OPTION value=4>'+lang.Search.TS4+'</option></select></td></tr>';
    }
    if (t.opt.searchType == 1 || t.opt.searchType == 0 || t.opt.searchType == 3 || t.opt.searchType == 4 ) {
        m+= '<TR><TD class=xtab align=right>'+lang.Search.orderby+':</td><TD class=xtab><SELECT id=filSortBy>\
          <OPTION value="level" '+ (Options.srcSortBy=='level'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.level+'</option>\
          <OPTION value="dist" '+ (Options.srcSortBy=='dist'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.distance+'</option>';
          if (t.opt.searchType == 1) {
                m+= '<OPTION value="play" '+ (Options.srcSortBy=='play'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.player+'</option>';
                m+= '<OPTION value="alli" '+ (Options.srcSortBy=='alli'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.alliance+'</option>';
            }
		  m+= '</select></td></tr>\
			<TR><TD class=xtab align=right>'+lang.Search.coords+':</td><TD class=xtab><INPUT type=checkbox id=coordsOnly \></td></tr>\
			</table></div><BR><SPAN id=srchSizeWarn></span><DIV id=BOpbSrcExp></div>';
    } else {

		m+= '<TR><TD class=xtab align=right >'+uW.g_js_strings.commonstr.view+':</td><TD class=xtab align=left ><SELECT style="width: 135px" id=idSrchFilter>\
             <OPTION value=0>'+lang.Search.Cit0+'</option>\
             <OPTION value=1>'+lang.Search.Cit1+'</option>\
	     <OPTION value=2>'+lang.Search.Cit2+'</option>\
	     <OPTION value=3>'+lang.Search.Cit3+'</option>\
	     <OPTION value=4>'+lang.Search.Cit4+'</option>\
	     <OPTION value=5>'+lang.Search.Cit5+'</option>\
	     <OPTION value=6>'+lang.Search.Cit6+'</option>\
             </select></td></tr>';

		m+= '<TR><TD class=xtab align=right>'+lang.Search.orderby+':</td><TD class=xtab><SELECT id=filSortBy>\
          <OPTION value="might" '+ (Options.srcSortBy=='might'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.might+'</option>\
          <OPTION value="dist" '+ (Options.srcSortBy=='dist'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.distance+'</option>\
                  <OPTION value="play" '+ (Options.srcSortBy=='play'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.player+'</option>\
        <OPTION value="alli" '+ (Options.srcSortBy=='alli'?'SELECTED':'')  +'>'+uW.g_js_strings.commonstr.alliance+'</option>\
        </select></td></tr>\
        <tr><TD class=xtab align=right>'+uW.g_js_strings.commonstr.alliance+' '+lang.Rpt.idRptWhat+'</td><TD class=xtab><input size=8 id=filAll0 value="'+Options.filAll0+'"></td></tr>\
        <tr><TD class=xtab align=right>'+uW.g_js_strings.commonstr.alliance+' '+lang.Rpt.idRptWhatNot+'</td><TD class=xtab><input size=8 id=filAll1 value="'+Options.filAll1+'"></td></tr>\
        <tr><TD class=xtab align=right>'+uW.g_js_strings.commonstr.might+' min :</td><TD class=xtab><input size=8 id=filPuissance value="'+Options.filPuissance+'"></td></tr>\
         <tr><TD class=xtab align=right>'+uW.g_js_strings.commonstr.might+' max :</td><TD class=xtab><select id=filPuissanceMax>\
         <option value="500" '+ (Options.filPuissanceMax=='500'?'SELECTED':'')  +'>500</option>\
         <option value="2500" '+ (Options.filPuissanceMax=='2500'?'SELECTED':'')  +'>2 500</option>\
         <option value="10000" '+ (Options.filPuissanceMax=='10000'?'SELECTED':'')  +'>10 000</option>\
         <option value="50000" '+ (Options.filPuissanceMax=='50000'?'SELECTED':'')  +'>50 000</option>\
         <option value="100000" '+ (Options.filPuissanceMax=='100000'?'SELECTED':'')  +'>100 000</option>\
         <option value="500000" '+ (Options.filPuissanceMax=='100000'?'SELECTED':'')  +'>500 000</option>\
         <option value="1000000" '+ (Options.filPuissanceMax=='1000000'?'SELECTED':'')  +'>1 000 000</option>\
         <option value="100000000" '+ (Options.filPuissanceMax=='100000000'?'SELECTED':'')  +'>100m</option>\
         <option value="900000000" '+ (Options.filPuissanceMax=='900000000'?'SELECTED':'')  +'>900m</option>\
         <option value="9900000000" '+ (Options.filPuissanceMax=='9900000000'?'SELECTED':'')  +'>+++</option>\
         </select></td></tr>\
        <TR><TD class=xtab align=right>'+lang.Search.coords+':</td><TD class=xtab><INPUT type=checkbox id=coordsOnly \></td></tr>\
         </table></div><BR><SPAN id=srchSizeWarn></span><BR><SPAN id=srchSizeWarn></span><DIV id=BOpbSrcExp></div>';
	}
    ById('divOutOpts').innerHTML = m;
    if (t.opt.searchType == 1 || t.opt.searchType == 0 || t.opt.searchType == 3 || t.opt.searchType == 4) {
		ById('filMinLvl').addEventListener ('change', function (){
		  Options.srcMinLevel = ById('filMinLvl').value;
		  saveOptions();
		  t.dispMapTable ();
		  }, false);


		ById('filMaxLvl').addEventListener ('change', function (){
		  Options.srcMaxLevel = ById('filMaxLvl').value;
		  saveOptions();
		  t.dispMapTable ();
		  }, false);
	 }
    ById('filSortBy').addEventListener ('change', function (){
      Options.srcSortBy = ById('filSortBy').value;
      saveOptions();
      t.dispMapTable ();
      }, false);
    ById('coordsOnly').addEventListener ('change', function (){ t.dispMapTable (); }, false);
    if (t.opt.searchType == 1){
    ById('foodWild').addEventListener ('change', function(){
        Options.foodWild = ById('foodWild').checked;
        saveOptions();
        t.dispMapTable ();
        }, false);
    ById('hillWild').addEventListener ('change', function(){
        Options.hillWild = ById('hillWild').checked;
        saveOptions();
        t.dispMapTable();
        }, false);
    ById('mtnWild').addEventListener ('change', function(){
        Options.mtnWild = ById('mtnWild').checked;
        saveOptions();
        t.dispMapTable();
        }, false);
    ById('plnWild').addEventListener ('change', function(){
        Options.plnWild = ById('plnWild').checked;
        saveOptions();
        t.dispMapTable();
        }, false);
    ById('woodWild').addEventListener ('change', function(){
        Options.woodWild = ById('woodWild').checked;
        saveOptions();
        t.dispMapTable ();
        }, false);

      ById('idTSSrchFilter').addEventListener ('change', function (){
             Options.TSSrchFilter = (ById('idTSSrchFilter').value);
              saveOptions();
              t.dispMapTable ();
        }, false);
        ById('idTSSrchFilter').value = Options.TSSrchFilter;
    }
    if (t.opt.searchType == 2){

	ById('idSrchFilter').addEventListener ('change', function (){
        Options.citySrchFilter = ById('idSrchFilter').value;
        if (ById('idSrchFilter').value==2) {
		 ById('filPuissance').value=0;
         Options.filPuissance = parseInt(ById('filPuissance').value);
	   }
        saveOptions();
        t.dispMapTable ();
        }, false);

	ById('idSrchFilter').value = Options.citySrchFilter;


        ById('filPuissance').addEventListener ('change', function (){
        Options.filPuissance = parseInt(ById('filPuissance').value);
        saveOptions();
        t.dispMapTable ();
        }, false);
        ById('filPuissanceMax').addEventListener ('change', function (){
        Options.filPuissanceMax = parseInt(ById('filPuissanceMax').value);
        saveOptions();
        t.dispMapTable ();
        }, false);


			  ById('filAll0').addEventListener ('change', function (){
			  		  Options.filAll0 = ById('filAll0').value;
			  		  saveOptions();
			  		  t.dispMapTable ();
			  }, false);
			  ById('filAll1').addEventListener ('change', function (){
			  		  Options.filAll1 = ById('filAll1').value;
			  		  saveOptions();
			  		  t.dispMapTable ();
			  }, false);
	}
    t.mapDat = [];
    t.firstX =  t.opt.startX - t.opt.maxDistance;
    t.lastX = t.opt.startX + t.opt.maxDistance;
    t.firstY =  t.opt.startY - t.opt.maxDistance;
    t.lastY = t.opt.startY + t.opt.maxDistance;
    t.tilesSearched = 0;
    t.tilesFound = 0;
    t.curX = t.firstX;
    t.curY = t.firstY;
    var xxx = t.normalizeCoord(t.curX);
    var yyy = t.normalizeCoord(t.curY);
    ById ('statStatus').innerHTML = uW.g_js_strings.commonstr.research+' : '+ xxx +','+ yyy;
    setTimeout (function(){Map.request (xxx, yyy, 20, t.mapCallback)}, MAP_DELAY);
  },

  dispMapTable : function (){
    var t = Tabs.Search;

    function mySort(a, b){
      if (Options.srcSortBy == 'level'){
        if ((x = a[4] - b[4]) != 0)
          return x;
      }
	  if (Options.srcSortBy == 'might'){
        if ((x = b[10] - a[10]) != 0)
          return x;
      }
      if (Options.srcSortBy == 'alli'){

          if (a[11] < b[11]) return -1;
	      else if (a[11] == b[11]) return 0;
	       else return 1;

      }
        if (Options.srcSortBy == 'play'){

          if (a[9] < b[9]) return -1;
	      else if (a[9] == b[9]) return 0;
	       else return 1;

      }
      return a[2] - b[2];
    }

    dat = [];
    for (i=0; i<t.mapDat.length; i++){
     lvl = parseInt (t.mapDat[i][4]);
     type = t.mapDat[i][3];
     puissance = t.mapDat[i][10];
     alliance = t.mapDat[i][11];
     if (t.opt.searchType == 2 && type == 7 ) {
 		 if ((Options.filAll0== '' || (alliance.search(Options.filAll0, "i") != -1)) && (Options.filAll1 == '' || (alliance.search(Options.filAll1, "i") == -1)))		  {
	  switch(parseInt (Options.citySrchFilter)) {
                case 0:
                 if (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax) {
                  dat.push(t.mapDat[i]);
                 }
                 break;
                case 1:
                   if ((t.mapDat[i][12] == 'hostile') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                    dat.push(t.mapDat[i]);
                   }
                   break;
                case 2:
                   if ((t.mapDat[i][5]===true) && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                    dat.push(t.mapDat[i]);
                   }
                   break;
                case 3:
                   if ((t.mapDat[i][12] == 'allie') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                    dat.push(t.mapDat[i]);
                   }
                   break;
                case 4:
                   if ((t.mapDat[i][12] == 'amicale') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                    dat.push(t.mapDat[i]);
                   }
                   break;
                case 5:
                   if ((t.mapDat[i][12] == 'neutre') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                    dat.push(t.mapDat[i]);
                   }
                   break;
                 case 6:
                   if ((t.mapDat[i][12] == 'unaligned') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                    dat.push(t.mapDat[i]);
                   }
                   break;
             }

  }
	  } else {
       if (lvl>=Options.srcMinLevel && lvl<=Options.srcMaxLevel){
        if (((t.opt.searchType==4 || t.opt.searchType==3) && (type == 8 || type == 9 || type == 10 || type == 11 || type == 12 || type == 13 || type == 14 || type == 15)) || t.opt.searchType==0
            || (Options.woodWild==1 && type == 3)
            || (Options.hillWild==1 && type ==4)
            || (Options.mtnWild==1 && type==5)
            || (Options.plnWild==1 && type == 6)
            || (Options.foodWild==1 && (type==1 || type==2)))
          if (Options.TSSrchFilter==0 && (t.opt.searchType==4 || t.opt.searchType==3 || t.opt.searchType==0 || t.opt.searchType==1))
          	  dat.push (t.mapDat[i]);
          else if (Options.TSSrchFilter==1 && !t.mapDat[i][5])
            dat.push (t.mapDat[i]);
          else if (Options.TSSrchFilter==2 && t.mapDat[i][12] =='hostile')
            dat.push (t.mapDat[i]);
          else if (Options.TSSrchFilter==3 && t.mapDat[i][12] =='neutre')
            dat.push (t.mapDat[i]);
          else if (Options.TSSrchFilter==4 && t.mapDat[i][12] =='unaligned')
            dat.push (t.mapDat[i]);
        }

       }
    }

    ById('statFound').innerHTML = lang.Search.find+' '+ dat.length;
    if (dat.length == 0){
      m = '<BR><CENTER>'+lang.Search.nofind+'</center>';
    } else {
      dat.sort(mySort);
      if (ById("coordsOnly").checked)
        m = '<TABLE align=center id=srcOutTab cellpadding=0 cellspacing=0><TR style="font-weight: bold"><TD>'+uW.g_js_strings.commonstr.location+'</td></tr>';
      else {
        if (t.opt.searchType == 0 || t.opt.searchType == 3  || t.opt.searchType == 4) {
			m = '<TABLE id=srcOutTab cellpadding=0 cellspacing=0><TR style="font-weight: bold"><TD>'+uW.g_js_strings.commonstr.location+'</td><TD style="padding-left: 10px">'+lang.Search.distance+'</td><TD style="padding-left: 10px;">'+lang.Search.level+'</td><TD style="padding-left: 10px;">Type</td></tr>';
		}
		if (t.opt.searchType == 1 ) {
			m = '<TABLE id=srcOutTab cellpadding=2 cellspacing=2><TR style="font-weight: bold"><TD>'+uW.g_js_strings.commonstr.location+'</td><TD style="padding-left: 10px">'+lang.Search.distance+'</td><TD style="padding-left: 10px;">'+lang.Search.level+'</td><TD style="padding-left: 10px;">Type</td><TD style="padding-left: 10px;">'+uW.g_js_strings.commonstr.player+'</td><td style="padding-left: 10px;">'+uW.g_js_strings.commonstr.might+'</td><td style="padding-left: 10px;">'+uW.g_js_strings.commonstr.alliance+'</td><td>'+lang.Search.status+'</td><td>'+lang.Search.connexion+'</td></tr>';
		}
		if (t.opt.searchType == 2) {
			 m = '<TABLE id=srcOutTab cellpadding=2 cellspacing=2><TR style="font-weight: bold"><TD>'+uW.g_js_strings.commonstr.location+'</td><TD >'+lang.Search.distance+'</td><TD>'+uW.g_js_strings.commonstr.city+'</td><TD>Proprio</td><TD>'+uW.g_js_strings.commonstr.level+'</td><TD>Puis.</td><td>'+uW.g_js_strings.commonstr.alliance+'</td><TD width=50% style="font-size:9px;">'+lang.Search.more+'</td><td width=30%>&nbsp;</td></tr>';
		}

	  }
	  var numRows = dat.length;
      if (numRows > 500 && t.searchRunning){
        numRows = 500;
        ById('srchSizeWarn').innerHTML = lang.Search.notetable+' '+ dat.length +' ' + lang.Search.notetable1;
      }
      for (i=0; i<numRows; i++){
        m += '<TR valign="top"';
		if (dat[i][12]) m += 'class="'+dat[i][12]+'"';

		if (ById("coordsOnly").checked){
		   m += ' ><TD valign="top"><DIV>'+ dat[i][0] +','+ dat[i][1] +'</div></td></tr>';
        } else {
           m += ' ><TD valign="top"><DIV>\
	             <a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ dat[i][0] +','+ dat[i][1] +')</a></div></td>';
   		  if (t.opt.searchType == 2) {
			m += '<TD align="left"  valign="top"><DIV onclick="PTscout('+ dat[i][0] +','+ dat[i][1] +');return false;"><img src="'+gameurl+'img/scouting.jpg" title="Scout">&nbsp;'+ dat[i][2].toFixed(2) +'</a></td><TD align=left>'+ dat[i][8] +'<br><i>('+dat[i][13]+')</i></td><TD valign="top">'+dat[i][9]+'</td><td>'+dat[i][4]+'</td><TD valign="top">'+addCommasInt(dat[i][10])+'</td><td>'+dat[i][11]+'</td><td>';
			if (dat[i][5]) {
			 m += '<DIV onclick="BoPTscout('+ dat[i][0] +','+ dat[i][1] +');return false;"><A style="font-size:9px;" >'+uW.g_js_strings.commonstr.scouting+'</a></div>';
			} else {
			 m += '<DIV onclick="BoPTpd(this, '+ dat[i][7] +')"><A style="font-size:9px;" >Details</a></div> <DIV style="" onclick="BoPTpd2(this, '+ dat[i][7] +')"><A style="font-size:9px;">'+uW.g_js_strings.commonstr.leaderboard+'</a></div>\
			 		<DIV style="" onclick="BoPCpo2(this, '+ dat[i][7] +')"><A style="font-size:9px;">'+uW.g_js_strings.commonstr.status+'</a></div>\
					<DIV style="" onclick="BoPCplo2(this, '+ dat[i][7] +')"><A style="font-size:9px;">'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+'</a></div>';
             m+= '</td><td><DIV style="" onclick="BOGetThrone(this, '+ dat[i][7] +')"><A style="font-size:9px;">'+uW.g_js_strings.commonstr.throneroom+'</a></div>';


             m+= '</tr>';
            }

            m+='';
		  } else {
           m += '<TD align=right  valign="top">'+ dat[i][2].toFixed(2) +' &nbsp; </td><TD align=right>'+ dat[i][4] +'</td><TD> &nbsp; '+ tileNames[dat[i][3]];
             +'</td>';
           if (t.opt.searchType == 1) {
            if (dat[i][5]) {
             m += '<td>'+dat[i][9]+'<td>'+addCommasInt(dat[i][10])+'</td><td>'+dat[i][11]+'</td>';

             if (dat[i][7] && dat[i][7]!=0) {
             m+='<td><DIV style="" onclick="BoPCpo2(this, '+ dat[i][7] +')"><A style="font-size:9px;">'+uW.g_js_strings.commonstr.status+'</a></div></td><td><DIV style="" onclick="BoPCplo2(this, '+ dat[i][7] +')"><A style="font-size:9px;">'+uW.g_js_strings.modal_messages_viewreports.lastlogin+'</a></div></td>';
             } else {
             m+='<td>&nbsp;</td><td>&nbsp;</td>';
             }


            } else  {
             m +='<td colspan=5 style="text-align=center"><i><b>'+lang.Search.free+'</b></i>';
            }
		   }else{
            m+="<td></td>";
           }
            m +='</tr>';
		  }
		}
       }
      m += '</table>';
    }
    ById('divOutTab').innerHTML = m;
    dat = null;
  },

  mapDat : [],

  stopSearch : function (msg){
    var t = Tabs.Search;
    ById ('statStatus').innerHTML = '<FONT color=#ffaaaa>'+ msg +'</font>';
    ById ('srcStart').value = uW.g_js_strings.commonstr.research;
    ById('srchSizeWarn').innerHTML = '';
    if (t.opt.searchType==3){
    	  ById ('BOpbSrcExp').innerHTML = '<CENTER>'+ strButton20(lang.Search.generateFSList, 'id=BOSrcDoFS') +'</center>';
          ById ('BOSrcDoFS').addEventListener ('click', t.generateFSList, false);
    }
    if (t.opt.searchType==2){
    	  ById ('BOpbSrcExp').innerHTML = '<CENTER>'+ strButton20(lang.Search.generateScoutList, 'id=pbSrcDoScout') +'</center>';
          ById ('pbSrcDoScout').addEventListener ('click', t.generateScoutList, false);
	}
    t.searchRunning = false;
  },
  generateFSList :function ()
  {
      var t = Tabs.Search;
      var bulkFS = [];
      for (i=0; i<t.mapDat.length; i++){
         bulkFS.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2], lvl:parseInt(t.mapDat[i][4])});
      }
      bulkFS = bulkFS.sort(function sort(a,b) {a = parseInt(a['dist']);b = parseInt(b['dist']);return a == b ? 0 : (a < b ? -1 : 1);});
      if(t.selectedCity == null)
  		t.selectedCity = Cities.cities[0];
      t.ShowFSList (bulkFS, t.selectedCity);

  },
 ShowFSList:function (coordlist, city) {
   var t = Tabs.Search;
   t.FScity = city;
   if(t.popFS==null){
	  t.popFS = new CPopup ('BOsrcFS', 0,0, 380,600, true, function (){t.popFS.destroy(); t.popFS=null;});
          t.popFS.centerMe (mainPop.getMainDiv());
    }
    	var m = '<DIV class=boStat>'+uW.g_js_strings.commonstr.darkForest+'</div><div>'+uW.g_js_strings.commonstr.level+': <select id=BOsrcFSLevel><option value=1>1</option><option value=2>2</option><option value=3>3</option><option value=4>4</option><option value=5>5</option><option value=6>6</option><option value=7>7</option><option value=8>8</option><option value=9>9</option><option value=10>10</option></select>&nbsp<input type=button id=BOsrcFSSave value="'+uW.g_js_strings.commonstr.save+'"><br>';
    	var r=0;
		for (y in uW.unitcost) {
		  r++;
	      m += '<DIV style="float:left;"><img height=20 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg>&nbsp;<input style="border:1px solid black;height:16px;font-size:11px;" id="BOFsUnits'+r+'" type=text size=7 value="0"></DIV>';
    }
    m += '</div><br><br><br><br><br><br><DIV>'+uW.g_js_strings.commonstr.city+' : <span id=BOsrcFScitypick> </span></div><BR>';
    m += '<DIV class=boStat>'+uW.g_js_strings.commonstr.from+' <span id=BOsrcFScity>'+city.name+'</span> <BR> '+lang.Search.numberCible+': '+coordlist.length+'</div>';
    m += '<DIV style="max-height:220px; overflow-y:auto;"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class=pbTabPadNW><TR style="font-weight:bold; background-color:white"><TD width=15><input type=checkbox id=pbsrcScout_All /></td><TD>Coords</td><td><select id=pbsrcScout_lvl><option value="">Niveau</option><option value=1>1</option><option value=2>2</option><option value=3>3</option><option value=4>4</option><option value=5>5</option><option value=6>6</option><option value=7>7</option><option value=8>8</option><option value=9>9</option><option value=10>10</option></select></td><td>'+uW.g_js_strings.commonstr.distance+'</td></tr>';
    for(i=0; i<coordlist.length; i++){
    			m += '<TR style="background-color:white"><TD><input type=checkbox name="pbsrcFSCheck" id="pbsrcScoutCheck_'+coordlist[i].x+'_'+coordlist[i].y+'_'+coordlist[i].lvl+'" value="'+coordlist[i].x+'_'+coordlist[i].y+'_'+coordlist[i].lvl+'" /></td><TD>'+coordlist[i].x+ ','+coordlist[i].y+'</td><td>'+coordlist[i].lvl+'</td><td>'+coordlist[i].dist+'</td></tr>';
    }
    m += '</table></div>';
    m += '<BR><CENTER>'+ strButton20(lang.Search.startattack, 'id=pbSrcStartScout') +'</center>';
    m += '<CENTER><DIV style="width:100%; height:100px;max-height:100px; overflow-y:auto;" id=pbSrcScoutResult></DIV></center>';
	t.popFS.getMainDiv().innerHTML = m;
	new CdispCityPicker ('BOFSPick', ById('BOsrcFScitypick'), false, function(c,x,y){ById('BOsrcFScity').innerHTML = c.name; t.attackcity = c; }, city.idx);
	t.popFS.show(true);
	ById('BOsrcFSSave').addEventListener('click', t.enregistrerscrLevel, false);
	ById('BOsrcFSLevel').addEventListener('click', t.changescrLevel, false);
	ById('pbsrcScout_All').addEventListener('change', function(){
			for(k in document.getElementsByName('pbsrcFSCheck'))
				document.getElementsByName('pbsrcFSCheck')[k].checked = ById('pbsrcScout_All').checked;
	}, false);
	ById('pbsrcScout_lvl').addEventListener('change', function(){
			if (ById('pbsrcScout_lvl').value!="") {
				for(k in document.getElementsByName('pbsrcFSCheck')) {
				 var lvl = document.getElementsByName('pbsrcFSCheck')[k].value;
				 if (lvl!==undefined) {
				  var lvll = lvl.split("_");
			          if (lvll[2]==ById('pbsrcScout_lvl').value){
					document.getElementsByName('pbsrcFSCheck')[k].checked = true;
				  }
				 }
			        }
			}
	}, false);
	ById('pbSrcStartScout').addEventListener('click', t.clickedStartFSAttack, false);
	t.changescrLevel();
 },
 changescrLevel: function() {
  var t = Tabs.Search;
  if (parseIntNan(Options.AttackFSUnits[ById('BOsrcFSLevel').value])!==undefined) {
           var r=0;
	 	  for (y in uW.unitcost) {
		r++;
      ById('BOFsUnits'+r).value=parseIntNan(Options.AttackFSUnits[ById('BOsrcFSLevel').value][r]);
     }
   }
 },
 enregistrerscrLevel: function() {
   var t = Tabs.Search;
   Options.AttackFSUnits[ById('BOsrcFSLevel').value]=[];
   var r=0;
   for (y in uW.unitcost) {
		r++;
        Options.AttackFSUnits[ById('BOsrcFSLevel').value][r] = parseIntNan(ById('BOFsUnits'+r).value);
   }
   saveOptions ();
   t.changescrLevel();
 },
 attacking : false,
 attackcity : null,
 doFSAttack: function(list, city){
  var t = Tabs.Search;
 	ById('pbSrcScoutResult').innerHTML = '';
 	if(list.length < 1){
 		ById('pbSrcScoutResult').innerHTML = '<SPAN class=boldRed>'+lang.Search.errFS1+'</span><br>';
 		t.clickedStartFSAttack();
 		return;
 	}
 	for (var lvl=1;lvl<11; lvl++){
         var totalunit=0;
               var r=0;
		 	  for (y in uW.unitcost) {
		r++;
          if (parseIntNan(Options.AttackFSUnits[lvl])!=undefined) {
           totalunit += parseIntNan(Options.AttackFSUnits[lvl][r]);
 	   if(parseInt(Seed.units['city'+city.id]['unt'+r]) < parseIntNan(Options.AttackFSUnits[lvl][r])){
 		ById('pbSrcScoutResult').innerHTML = '<SPAN class=boldRed>ERREUR : '+uW.unitcost['unt'+r][0]+' non disponible pour le niveau '+lvl+'</span><br>';
 		t.clickedStartFSAttack();
 	 	return;
 	   }
 	  }
 	 }
 	}
	t.doFSAttackCount(list, city, list.length, 0);

 },
 doFSAttackCount : function(list, city, total, count){
	var t = Tabs.Search;

        if(!t.attacking){
 		ById('pbSrcScoutResult').innerHTML += '<SPAN class=boldRed>Stop</span><BR>';
 		ById('pbSrcStartScout').className = 'button20 ptButton20';
 		ById('pbSrcStartScout').innerHTML = '<SPAN>'+lang.Search.startattack+'</span>';
 		return;
 	}
 	if(total <= (count)){
 		ById('pbSrcScoutResult').innerHTML += lang.Search.finishattack+'<BR>';
 		t.clickedStartFSAttack();
 		return;
 	}
 	var slots=March.RallyPoint(city.id).marching;
	var rallypointlevel=March.RallyPoint(city.id).maxSlots;
 	if(slots >= rallypointlevel){
 		setTimeout(function(){t.doFSAttackCount(list, city, total, count)}, 10000);
 		ById('pbSrcScoutResult').innerHTML += lang.Search.waitPR+'<br>';
 		return;
 	}
 	var coords = list[count].split("_");
 	if(coords[0] == 'undefined' || coords[1] == 'undefined'){
 		ById('pbSrcScoutResult').innerHTML += '<SPAN class=boldRed>'+lang.Search.errFS2+'</span>';
 		t.clickedStartFSAttack();
 		return;
 	}
 	ById('pbSrcScoutResult').innerHTML += lang.Search.sendto+' '+coords[0]+','+coords[1]+'...';
 	ById('pbsrcScoutCheck_'+coords[0]+'_'+coords[1]+'_'+coords[2]).checked = false;
 	t.sendAttackFS(coords[0], coords[1], coords[2], city, count, function(c){t.doFSAttackCount(list, city, total, c)});
 },
 sendAttackFS : function(x, y, lvl, city, count, notify, tt){
  var t = Tabs.Search;
  count = parseInt(count);
  var totalunit = 0;
  var r=0;
  for (zz in uW.unitcost) {
   r++;
   if (parseIntNan(Options.AttackFSUnits[lvl])!=undefined)
       totalunit += parseIntNan(Options.AttackFSUnits[lvl][r]);
  }
  if (totalunit>0) {


  var params = uW.Object.clone(uW.g_ajaxparams);
  params.cid = city.id;
  params.kid = 0;
  params.type = 4;
  params.xcoord = x;
  params.ycoord = y;
  if (tt)
   params.tt = tt;
  var r=0;
  	for (y in uW.unitcost) {
	r++;
    params['u'+r]=parseIntNan(Options.AttackFSUnits[lvl][r]);
  }
  var knt = new Array();
  for (k in Seed.knights['city' + city.id]){
   if (Seed.knights['city' + city.id][k]["knightStatus"] == 1 && Seed.leaders['city' + city.id]["resourcefulnessKnightId"] != Seed.knights['city' + city.id][k]["knightId"] && Seed.leaders['city' + city.id]["politicsKnightId"] != Seed.knights['city' + city.id][k]["knightId"] && Seed.leaders['city' + city.id]["combatKnightId"] != Seed.knights['city' + city.id][k]["knightId"] && Seed.leaders['city' + city.id]["intelligenceKnightId"] != Seed.knights['city' + city.id][k]["knightId"]){
       knt.push ({
                 				Name:   Seed.knights['city' + city.id][k]["knightName"],
                 				Combat:	Seed.knights['city' + city.id][k]["combat"],
                 				ID:	Seed.knights['city' + city.id][k]["knightId"],
       });
    }
  }
  knt = knt.sort(function sort(a,b) {a = parseInt(a['Combat']);b = parseInt(b['Combat']);return a == b ? 0 : (a > b ? -1 : 1);});
  if (knt[0]) {
    params.kid= knt[0]["ID"];
    var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
    new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
    		 method: "post",
    		 parameters: params,
    		 loading: true,
    		 onSuccess: function (rslt) {
				 profiler.stop();
    		 rslt = eval("(" + rslt.responseText + ")");
    		 if (rslt.ok) {
    			 var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
    			 var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
    			 var ut = unixTime();
    			 var unitsarr = [];
            	 for (j in uW.unitcost) unitsarr.push(0);
    			 var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];
    			 for(i = 1; i <= unitsarr.length; i++)
    				if(params["u"+i]) unitsarr[i] = params["u"+i];
    			 var currentcityid = params.cid;
    			 uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
    			 if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
    			 ById('pbSrcScoutResult').innerHTML += lang.Search.send+'<BR>';
    			 if (notify)
    			  setTimeout(function(){ notify(count+1); }, 4000);
    		 } else {
    			if (rslt.user_action) {
				 ById('pbSrcScoutResult').innerHTML += "<font color=red>Alert : "+rslt.user_action+"</font><BR>";
				 	if (rslt.user_action == "backOffWaitTime") {

							if(rslt.tt)
							var tt = rslt.tt;
							var wait = 1;
							if(rslt.wait_time)
	 						wait = rslt.wait_time;
							setTimeout (function(){t.sendAttackFS(x, y, lvl, city, count, notify, tt);}, wait*1000);
							return;
					    }
			   } else {
    			 if (rslt.error_code==104 && rslt.msg=="Ne peux attaquer le marais") {
    			  ById('pbSrcScoutResult').innerHTML += '<span title="'+rslt.msg+'">Error - '+uW.g_js_strings.commonstr.bog+'</span><BR>';
    			  if (notify)
    			    setTimeout(function(){ notify(count+1); }, 4000);
    			 } else {
    			   ById('pbSrcScoutResult').innerHTML += '<span title="'+rslt.msg+'">Error !</span><BR>';
    			  if (notify)
    			   setTimeout(function(){ notify(count); }, 4000);
    			 }
    			 }
    		  }
    		},
    		onFailure: function () {profiler.stop();}
  		});



  } else {
   ById('pbSrcScoutResult').innerHTML += 'Error : '+uW.g_js_strings.commonstr.knight+'...<BR>';
   if (notify)
    setTimeout(function(){ notify(count); }, 1000);
  }

  } else {

   ById('pbSrcScoutResult').innerHTML += '<span>Error !</span><BR>';
   setTimeout(function(){ notify(count+1); }, 500);

  }


 },
 generateScoutList : function (){
     var t = Tabs.Search;
     var bulkScout = [];
     for (i=0; i<t.mapDat.length; i++){
           lvl = parseInt (t.mapDat[i][4]);
           type = t.mapDat[i][3];
           puissance = t.mapDat[i][10];
           alliance = t.mapDat[i][11];

           if (t.opt.searchType == 2 && type == 7 ) {
if ((Options.filAll0== '' || (alliance.search(Options.filAll0, "i") != -1))
	         		  	      && (Options.filAll1 == '' || (alliance.search(Options.filAll1, "i") == -1)))
		  {
     	  switch(parseInt (Options.citySrchFilter)) {
                     case 0:
                      if (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax) {
                       bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                      }
                      break;
                     case 1:
                        if ((t.mapDat[i][12] == 'hostile') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                         bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                        }
                        break;
                     case 2:
                        if ((t.mapDat[i][5]===true) && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                         bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                        }
                        break;
                     case 3:
                        if ((t.mapDat[i][12] == 'allie') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                         bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                        }
                        break;
                     case 4:
                        if ((t.mapDat[i][12] == 'amicale') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                         bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                        }
                        break;
                     case 5:
                        if ((t.mapDat[i][12] == 'neutre') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                         bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                        }
                        break;
                      case 6:
                        if ((t.mapDat[i][12] == 'unaligned') && (Options.filPuissance<=puissance && puissance<=Options.filPuissanceMax)) {
                         bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
                        }
                        break;
                  }

}
     	  } else {
            if (lvl>=Options.srcMinLevel && lvl<=Options.srcMaxLevel){

             if ((t.opt.searchType==3 && (type == 8 || type == 9 || type == 10 || type == 11 || type == 12 || type == 13 || type == 14 || type == 15)) || t.opt.searchType==0
                 || (Options.woodWild==1 && type == 3)
                 || (Options.hillWild==1 && type ==4)
                 || (Options.mtnWild==1 && type==5)
                 || (Options.plnWild==1 && type == 6)
                 || (Options.foodWild==1 && (type==1 || type==2)))
               if (Options.TSSrchFilter==0)
                 bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
               else if (Options.TSSrchFilter==1 && !t.mapDat[i][5])
                 bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
               else if (Options.TSSrchFilter==2 && t.mapDat[i][12] =='hostile')
                 bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
               else if (Options.TSSrchFilter==3 && t.mapDat[i][12] =='neutre')
                 bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
               else if (Options.TSSrchFilter==4 && t.mapDat[i][12] =='unaligned')
                 bulkScout.push({x:t.mapDat[i][0], y:t.mapDat[i][1], dist:t.mapDat[i][2]});
             }
            }


     }

 	if(t.selectedCity == null)
 		t.selectedCity = Cities.cities[0];
     t.ShowScoutList (bulkScout, t.selectedCity);
   },
   ShowScoutList : function (coordlist, city){
 	var t = Tabs.Search;
 	var popScout = null;
 	t.scoutcity = city;

 	if(popScout==null){
 	  popScout = new CPopup ('pbsrcscout', 0,0, 350,500, true, function (){popScout.destroy(); popScout=null;});
       popScout.centerMe (mainPop.getMainDiv());
     }
 	var m = '<DIV class=boStat>'+ lang.Search.scoutTitle +'</div>';
 		m += '<DIV>'+uW.g_js_strings.commonstr.troops+': <input id=pbsrcScoutAmt value="'+Options.srcScoutAmt+'" /></div><BR>';
 		m += '<DIV>'+lang.General.source+' : <span id=pbsrcScoutcitypick> </span></div><BR>';
 		m += '<DIV class=boStat>'+uW.g_js_strings.commonstr.from+' <span id=pbsrcScoutcity>'+city.name+'</span> <BR> '+lang.Search.numberCible+' '+coordlist.length+'</div>';
 		m += '<DIV style="max-height:220px; overflow-y:auto;"><TABLE align=center cellpadding=0 cellspacing=0 class=pbTabPadNW><TR style="font-weight:bold; background-color:white"><TD width=15><input type=checkbox id=pbsrcScout_All /></td><TD>'+uW.g_js_strings.commonstr.target+'</td></tr>';
 	  for(i=0; i<coordlist.length; i++){
 			m += '<TR style="background-color:white"><TD><input type=checkbox name=pbsrcScoutCheck id="pbsrcScoutCheck_'+coordlist[i].x+'_'+coordlist[i].y+'" value="'+coordlist[i].x+'_'+coordlist[i].y+'" /></td><TD>'+coordlist[i].x+','+coordlist[i].y+'</td></tr>';
 	  }
 	    m += '</table></div>';
 		m += '<BR><CENTER>'+ strButton20(lang.Search.startattack, 'id=pbSrcStartScout') +'</center>';
 		m += '<CENTER><DIV style="width:70%; max-height:75px; overflow-y:auto;" id=pbSrcScoutResult></DIV></center>';
 	popScout.getMainDiv().innerHTML = m;
 	new CdispCityPicker ('pbScoutPick', ById('pbsrcScoutcitypick'), false, function(c,x,y){ById('pbsrcScoutcity').innerHTML = c.name; t.scoutcity = c; }, city.idx);
 	popScout.getTopDiv().innerHTML = '<CENTER><B>'+lang.Search.generateScoutList+'</b></center>';
 	popScout.show(true);

 	ById('pbsrcScoutAmt').addEventListener('change', function(){
 		Options.srcScoutAmt = parseInt(ById('pbsrcScoutAmt').value);
 		saveOptions();
 	}, false);
 	ById('pbsrcScout_All').addEventListener('change', function(){
 		for(k in document.getElementsByName('pbsrcScoutCheck'))
 			document.getElementsByName('pbsrcScoutCheck')[k].checked = ById('pbsrcScout_All').checked;
 	}, false);
 	ById('pbSrcStartScout').addEventListener('click', t.clickedStartScout, false);
   },
   scouting : false,
   scoutcity : null,
   doScout : function(list, city){
 	var t = Tabs.Search;
 	ById('pbSrcScoutResult').innerHTML = '';
 	if(list.length < 1){
 		ById('pbSrcScoutResult').innerHTML = '<SPAN class=boldRed>ERROR : No coords selected</span>';
 		t.clickedStartScout();
 		return;
 	}
 	if(parseInt(Seed.units['city'+city.id]['unt'+3]) < Options.srcScoutAmt){
 		ById('pbSrcScoutResult').innerHTML = '<SPAN class=boldRed>ERROR : No scouts available</span>';
 		t.clickedStartScout();
 		return;
 	}
 	t.doScoutCount(list, city, list.length, 0);

   },
   	clickedStartScout : function(){
   	var t = Tabs.Search;
   		if(t.scouting == false){
   			t.scouting = true;
   			var ScoutList = [];
   			for(k=0; k<document.getElementsByName('pbsrcScoutCheck').length; k++){
   				if(document.getElementsByName('pbsrcScoutCheck')[k].checked){
   					ScoutList.push(document.getElementsByName('pbsrcScoutCheck')[k].value);
   				}
   			}
   			t.doScout(ScoutList, t.scoutcity);
   			ById('pbSrcStartScout').className = 'button20 pbButCancel';
   			ById('pbSrcStartScout').innerHTML = '<SPAN>Stop</span>';
   		} else {
   			t.scouting = false;
   			ById('pbSrcStartScout').className = 'button20 ptButton20';
   			ById('pbSrcStartScout').innerHTML = '<SPAN>'+lang.Search.startattack+'</span>';
   		}
	},
   doScoutCount : function(list, city, total, count){
 	var t = Tabs.Search;
 	if(!t.scouting){
 		ById('pbSrcScoutResult').innerHTML += '<SPAN class=boldRed>Stop</span><BR>';
 		ById('pbSrcStartScout').className = 'button20 ptButton20';
 		ById('pbSrcStartScout').innerHTML = '<SPAN>'+lang.Search.startattack+'</span>';
 		return;
 	}
 	if(total <= (count)){
 		ById('pbSrcScoutResult').innerHTML += lang.Search.finishattack+'<BR>';
 		t.clickedStartScout();
 		return;
 	}
 	var slots=March.RallyPoint(city.id).marching;
	var rallypointlevel=March.RallyPoint(city.id).maxSlots;
 	if(slots >= rallypointlevel){
 		setTimeout(function(){t.doScoutCount(list, city, total, count)}, 10000);
 		ById('pbSrcScoutResult').innerHTML += lang.Search.waitPR+'<br>';
 		return;
 	}
 	var coords = list[count].split("_");
 	if(coords[0] == 'undefined' || coords[1] == 'undefined'){
 		ById('pbSrcScoutResult').innerHTML += '<SPAN class=boldRed>'+lang.Search.errFS2+'</span>';
 		t.clickedStartScout();
 		return;
 	}
 	ById('pbSrcScoutResult').innerHTML += lang.Search.sendto + ' '+coords[0]+','+coords[1]+'...';
 	ById('pbsrcScoutCheck_'+coords[0]+'_'+coords[1]).checked = false;
 	t.sendScout(coords[0], coords[1], city, count, function(c){t.doScoutCount(list, city, total, c)});
   },
   sendScout : function(x, y, city, count, notify, tt){
 	var t = Tabs.Search;
 	count = parseInt(count);
 	var params = uW.Object.clone(uW.g_ajaxparams);
     params.cid = city.id;
 	params.kid = 0;
 	params.type = 3;
 	params.xcoord = x;
 	params.ycoord = y;
 	if (tt)
      params.tt = tt;
 	params.u3 = Options.srcScoutAmt;
 	var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
 	new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
 		 method: "post",
 		 parameters: params,
 		 loading: true,
 		 onSuccess: function (rslt) {
			  profiler.stop();
 		 rslt = eval("(" + rslt.responseText + ")");
 		 if (rslt.ok) {
 			 var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
 			 var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
 			 var ut = unixTime();
 			 var unitsarr = [];
            	 for (j in uW.unitcost) unitsarr.push(0);
 			 var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];
 			 for(i = 1; i <= unitsarr.length; i++)
 			  if(params["u"+i])
 			    unitsarr[i] = params["u"+i];
 			 var currentcityid = params.cid;
 			 uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
 			 if(rslt.updateSeed){uW.update_seed(rslt.updateSeed);}
 			 ById('pbSrcScoutResult').innerHTML += lang.Search.send+'<BR>';
 			 if (notify)
 			  setTimeout(function(){ notify(count+1); }, 1000);
 		 } else {
			if (rslt.error_code==208) {
				ById('pbSrcScoutResult').innerHTML += 'Paix...<BR>';
				setTimeout(function(){ notify(count+1); }, 1000);$
				reutnr;
			}
 			 if (rslt.user_action) {
			  					  ById('pbSrcScoutResult').innerHTML += 'Alert : '+rslt.user_action+'<BR>';
			 					 	if (rslt.user_action == "backOffWaitTime") {

			 							if(rslt.tt)
			 							var tt = rslt.tt;
			 							var wait = 1;
			 							if(rslt.wait_time)
			 	 						wait = rslt.wait_time;
			 							setTimeout (function(){t.sendScout(x, y, city, count, notify, tt);}, wait*1000);
			 							return;
								}
			 }
			  ById('pbSrcScoutResult').innerHTML += 'Fail! tentative....<BR>';
 			 if (notify)
 			  setTimeout(function(){ notify(count); }, 1000);
 		  }
 		},
 		onFailure: function () { profiler.stop();}
   		});
  },
 getRallypoint: function(cityId){
       var t = Tabs.Search;
       cityId = 'city'+cityId;
       for (o in Seed.buildings[cityId]){
 		var buildingType = parseInt(Seed.buildings[cityId][o][0]);
 		var buildingLevel = parseInt(Seed.buildings[cityId][o][1]);
 		if (buildingType == 12){
 			return parseInt(buildingLevel);
 			break;
 		}
 	   }
 	  return 0;
    },
 clickedStartFSAttack : function(){
   var t = Tabs.Search;
   	if(t.attacking == false){
   			t.attacking = true;
   			var ScoutList = [];
   			for(k=0; k<document.getElementsByName('pbsrcFSCheck').length; k++){
   				if(document.getElementsByName('pbsrcFSCheck')[k].checked){
   					ScoutList.push(document.getElementsByName('pbsrcFSCheck')[k].value);
   				}
   			}
   			t.doFSAttack(ScoutList, t.attackcity);
   			ById('pbSrcStartScout').className = 'button20 pbButCancel';
   			ById('pbSrcStartScout').innerHTML = '<SPAN>Stop</span>';
   		} else {
   			t.attacking = false;
   			ById('pbSrcStartScout').className = 'button20 ptButton20';
   			ById('pbSrcStartScout').innerHTML = '<SPAN>'+lang.Search.startattack+'</span>';
		}
 },
 clickedPlayerCheckOnline : function (span, uid){
        var t = Tabs.AllianceList;
      	var s = Tabs.Search;
          span.onclick = '';
          span.innerHTML = uW.g_js_strings.commonstr.loadingddd+"...";
          t.fetchPlayerStatusSimple (uid, function (r) {s.gotPlayerStatus(r, span, uid)});
        },

 clickedPlayerGetLastLogin : function (span, uid){
   var t = Tabs.AllianceList;
 var s = Tabs.Search;
          span.onclick = '';
          span.innerHTML = uW.g_js_strings.commonstr.loadingddd+"...";
          t.fetchPlayerLastLogin (uid, function (r) {s.gotPlayerLastLogin(r, span)});
  },
  fetchPlayerThrone : function (uid, notify){
  var t = Tabs.AllianceList;
   var s = Tabs.Search;
        var params = uW.Object.clone(uW.g_ajaxparams);
        	params.ctrl="throneRoom\\ThroneRoomServiceAjax";
	    		params.action ="getEquipped";
    		params.playerId = uid;
        new MyAjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
          method: "post",
          parameters: params,
          onSuccess: function (rslt) {
            notify (rslt);
          },
          onSuccess: function (rslt) {
            notify (rslt);
          },
      });
  },
  clickedPlayerGetThrone: function(span, uid) {
    var t = Tabs.AllianceList;
    var s = Tabs.Search;
    span.onclick = '';
    span.innerHTML = uW.g_js_strings.commonstr.loadingddd+"...";
    s.fetchPlayerThrone (uid, function (r) {s.gotThronePlayer(r, span)});

  },
  gotThronePlayer : function (rslt, span){
        var t = Tabs.AllianceList;
        var s = Tabs.Search;
        if (!rslt.ok){
          span.innerHTML = "Impossible";
          return;
        }
        var B=0, w={}, x, C;
        var k=rslt.items;
        var m="";
        for (var K in k) {
           x=0;
           var F = k[K].effects;
	   for (var M in F) {
            x++;

            if (k[K].quality >= x) {
             B++;
             I = uW.cm.thronestats.effects[F[M].id];
             if (uW.cm.thronestats.tiers[F[M].id][F[M].tier]) z = uW.cm.thronestats.tiers[F[M].id][F[M].tier];
             else  z = uW.cm.thronestats.tiers[F[M].id][F[M].tier-1];
             C = + z.base + (k[K].level * k[K].level + k[K].level) * + z.growth * 0.5;
             if (!w[F[M].id]) {
	     	w[F[M].id] = {};
	     }
	     if (!w[F[M].id].percent) {
	     	w[F[M].id].percent = C;
	      } else {
	     	w[F[M].id].percent += C;
	     }
	     w[F[M].id].name = I[1];
            }
           }
        }

        m+="<table border=0 width=250 cellspacing=0>";
        for (var K in w) {
             var Current =  Math.round(w[K].percent*100)/100;
             G="<tr><td align=right><b>"+ Current + " %</b></td><td align=left>" + w[K].name + "</td></tr>";
	     m+=G;
        }
        m+="</table>";
        span.innerHTML = m;
    },
  gotPlayerStatus : function (rslt, span,uid){
      var t = Tabs.AllianceList;
      if (!rslt.ok){
        span.innerHTML = rslt.errorMsg;
        return;
      }

      var p = rslt.data;
      if (p[uid] == true) {
        m = '<span style="color:green"><b>'+uW.g_js_strings.commonstr.online+'</b></span>';
      } else {
         m = '<span style="color:red"><b>'+uW.g_js_strings.commonstr.offline+'</b></span>';
      }
      span.innerHTML = m + '';
    },

  gotPlayerLastLogin : function (rslt, span){
      var t = Tabs.AllianceList;
      if (!rslt.ok){
        span.innerHTML = rslt.errorMsg;
        return;
      }

      var p = rslt.playerInfo;
      var lastLogin = rslt.playerInfo.lastLogin;

      if (lastLogin) {
        m = '<span style="color:black">'+lastLogin+'</span>';
      } else {
         m = '<span style="color:red">?</span>';
      }

      span.innerHTML = m + '';
  },

  mapCallback : function (left, top, width, rslt){
    function insertRow (x, y, msg){
      row = ById('srcOutTab').insertRow(-1);
      row.insertCell(0).innerHTML = x +','+ y;
      row.insertCell(1).innerHTML = distance (t.opt.startX, t.opt.startY, x, y);
      row.insertCell(2).innerHTML = msg;
    }
    var t = Tabs.Search;
    if (!t.searchRunning)
      return;
    if (!rslt.ok){
      t.stopSearch ('ERROR : '+ rslt.errorMsg);
      return;
    }
    map = rslt.data;
    var userInfo = rslt.userInfo;
    var alliance = rslt.allianceNames;
    for (k in map){
      if (t.opt.searchType==0 && map[k].tileType==51 && !map[k].tileCityId ) {
        type = 0;
      } else if (t.opt.searchType==1 && map[k].tileType>=10 &&  map[k].tileType<=50) {
        if (map[k].tileType == 10)
          type = 1;
        else if (map[k].tileType == 11)
          type = 2;
        else
          type = (map[k].tileType/10) + 1;
      } else if (t.opt.searchType==2 && map[k].tileCityId >= 0 && map[k].tileType > 50 && map[k].cityName) {
		  type = 7;
      } else if (t.opt.searchType==3 && map[k].tileType==54) {
        type=9;
      } else if (t.opt.searchType==4 && map[k].tileType==55) {
		 type=10;
      } else if (t.opt.searchType==3 && map[k].tileType>100) {
        type=9 + (map[k].tileType-100);

      } else {
        continue;
      }
      dist = distance (t.opt.startX, t.opt.startY, map[k].xCoord, map[k].yCoord);
      if (dist <= t.opt.maxDistance && dist >= t.opt.maxDistanceA){
		  if (t.opt.searchType==2) {
			var isMisted = map[k].tileUserId == 0 || false;
			var uu = 'u'+map[k].tileUserId;
			var aU = 'inconnu';
			var aD = 'inconnu';
			var mightU = 0;
			var nameU = 'inconnu';
			if (isMisted) {
				nameU = 'Brume';
				mightU = 0;
			} else {
				if (userInfo[uu] ) {
					nameU = "<a onclick=getInfoForAnUser('"+ map[k].tileUserId +"');>"+ userInfo[uu].n +"</a>";
					mightU = userInfo[uu].m;
					aD = getDiplomacy(userInfo[uu].a);
					if ( alliance && alliance['a'+userInfo[uu].a] ) {
						aU = alliance['a'+userInfo[uu].a];
					}
					else {
						aU = '----';
						aD = 'unaligned';
					}
				}
			}
			// PRestige
			var Prestige="Normal";
			if ( map[k].isPrestige) {
			 if (map[k].prestigeType==1) Prestige="Druid " + map[k].prestigeLevel;
			 if (map[k].prestigeType==2) Prestige="Fey " + map[k].prestigeLevel;
    	     if (map[k].prestigeType==3) Prestige="Briton " +map[k].prestigeLevel;
		    }
			t.mapDat.push ([map[k].xCoord, map[k].yCoord, dist, type, map[k].tileLevel, isMisted, map[k].tileCityId, map[k].tileUserId, map[k].cityName,nameU,mightU,aU,aD,Prestige,map[k].tileId]);
		} else {
			isOwned = map[k].tileUserId>0 || map[k].misted;
			var uu = 'u'+map[k].tileUserId;
			var aU = 'inconnu';
			var aD = 'inconnu';
			var nameU = 'inconnu';
			var mightU = 0;
			if (map[k].misted) {
				nameU = 'Sous la Brume';
			}else {
			 if (userInfo[uu] ) {
			   var nameU = "<a onclick=getInfoForAnUser('"+ map[k].tileUserId +"');>"+ userInfo[uu].n +"</a>";
			   mightU = userInfo[uu].m;
			   aD = getDiplomacy(userInfo[uu].a);
					if ( alliance && alliance['a'+userInfo[uu].a] ) {
						aU = alliance['a'+userInfo[uu].a];
					}
			 }else {
			   var nameU = 'inconnu';
			 }
			}
			t.mapDat.push ([map[k].xCoord, map[k].yCoord, dist, type, map[k].tileLevel, isOwned, map[k].tileCityId, map[k].tileUserId, map[k].cityName, nameU, mightU, aU, aD,0,map[k].tileId]);
		}
			++t.tilesFound;
       }
    }
    t.tilesSearched += (20*20);
    ById('statSearched').innerHTML = lang.Search.find+': '+ t.tilesSearched;
    t.dispMapTable();
    t.curX += 20;
    if (t.curX > t.lastX){
      t.curX = t.firstX;
      t.curY += 20;
      if (t.curY > t.lastY){
        t.stopSearch ('Finish');
        return;
      }
    }
    var x = t.normalizeCoord(t.curX);
    var y = t.normalizeCoord(t.curY);
    document.getElementById ('statStatus').innerHTML = uW.g_js_strings.commonstr.research+' : '+ x +','+ y;
    setTimeout (function(){Map.request (x, y, 20, t.mapCallback)}, MAP_DELAY);
  },
};

Tabs.Crest = {
  tabOrder: 17,
  tabLabel: lang.BoiteLabelCrest,
  myDiv : null,
  rallypointlevel:null,
  error_code: 0,
  knt:{},
  init : function (div){
    var t = Tabs.Crest;
    Options.crestMarchError = 0;
    setTimeout(function() {

	if (Options.BORac_Ts) {
	AddSubTabLink(lang.crest.button, t.toggleCrestState, 'pbautotstab');
	if (Options.crestRunning == false)
	  updatebotbutton(lang.crest.button+" - OFF", 'pbautotstab');
	else
	  updatebotbutton(lang.crest.button+" - ON", 'pbautotstab');
    }

    },100);
    t.myDiv = div;
    var selbut=0;
    var m = '<DIV id=pbTowrtDivF class=boStat>'+lang.crest.title+'</div><TABLE id=pbcrestfunctions width=100% height=0% class=pbTab><TR align="center">';
    if (Options.crestRunning == false) {
	       m += '<TD><INPUT id=Cresttoggle type=button class=pbButton value="'+lang.crest.Cresttoggle+' = OFF"></td>';
	   } else {
	       m += '<TD><INPUT id=Cresttoggle type=button class=pbButton value="'+lang.crest.Cresttoggle+' = ON"></td>';
    }
    m += '<TD colspan=2><INPUT id=CrestHelp type=button class=pbButton value="'+lang.crest.help+'">';
    m += '<INPUT id=showCrestTargets type=button class=pbButton  value="'+lang.crest.target+'"><INPUT id=ResetCrestTargets type=button value="Reset" class=pbButton ><br>'+lang.crest.interval+' <INPUT type=text size=3 value='+Options.Crestinterval+' id=pbcrest_interval /> '+lang.General.secs+'</td>';
    m += '<TD><INPUT id=pbsendreport type=checkbox '+ (Options.crestreport?' CHECKED':'') +'\> '+lang.crest.sendrpt+'&nbsp;';
    m += '<INPUT id=pbsendcrestreportint value='+ Options.CrestMsgInterval +' type=text size=3 \> '+lang.General.hours+' - <input type=button class=pbButton value="'+uW.g_js_strings.modal_auto_attack.now+'" id=bosendreportnow><br>';
    m += lang.crest.keep+' <INPUT id=bocrestslot value='+Options.CrestSlot+' type=text size=2 \> '+lang.crest.keep2+'</td></table>';
    m += '<DIV id=pbOpt class=boStat>OPTIONS</div><TABLE id=pbcrestopt	 width=100% height=0% class=pbTab><TR align="center"></table>';
    m += '<DIV style="margin-bottom:10px;">'+uW.g_js_strings.commonstr.from+' : <span id=crestcity></span></div>';
    m += '<TABLE class=ptTab><TR><TD>'+uW.g_js_strings.commonstr.location+' : &nbsp;&nbsp;X:<INPUT id=pbcrestx type=text size=3 maxlength=3 value=""></td>';
    m += '<TD>Y:<INPUT id=pbcresty type=text size=3 maxlength=3 value=""></td></tr></table>';
    m += '<TABLE class=ptTab><TR><TD>'+lang.crest.wave+' <b>1</b>: </td><TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_1_30.jpg></td><TD><INPUT id=R1ST type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_2_30.jpg></td><TD><INPUT id=R1MM type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_3_30.jpg></td><TD><INPUT id=R1Scout type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_4_30.jpg></td><TD><INPUT id=R1Pike type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_5_30.jpg></td><TD><INPUT id=R1Sword type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_6_30.jpg></td><TD><INPUT id=R1Arch type=text size=6 maxlength=6 value=0></td></tr>';
    m += '<tr><td></td><TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_7_30.jpg></td><TD><INPUT id=R1LC type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_8_30.jpg></td><TD><INPUT id=R1HC type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_9_30.jpg></td><TD><INPUT id=R1SW type=text size=7 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_10_30.jpg></td><TD><INPUT id=R1Ball type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_11_30.jpg></td><TD><INPUT id=R1Ram type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_12_30.jpg></td><TD><INPUT id=R1Cat type=text size=6 maxlength=6 value=0></td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr>';
    m += '<TR><TD>'+lang.crest.wave+' <b>2</b>: </td><TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_1_30.jpg></td><TD><INPUT id=R2ST type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_2_30.jpg></td><TD><INPUT id=R2MM type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_3_30.jpg></td><TD><INPUT id=R2Scout type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_4_30.jpg></td><TD><INPUT id=R2Pike type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_5_30.jpg></td><TD><INPUT id=R2Sword type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_6_30.jpg></td><TD><INPUT id=R2Arch type=text size=6 maxlength=6 value=0></td></tr>';
    m += '<tr><td></td><TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_7_30.jpg></td><TD><INPUT id=R2LC type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_8_30.jpg></td><TD><INPUT id=R2HC type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_9_30.jpg></td><TD><INPUT id=R2SW type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_10_30.jpg></td><TD><INPUT id=R2Ball type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_11_30.jpg></td><TD><INPUT id=R2Ram type=text size=6 maxlength=6 value=0></td>';
    m += '<TD>&nbsp;&nbsp;<img src='+gameurl+'img/units/unit_12_30.jpg></td><TD><INPUT id=R2Cat type=text size=6 maxlength=6 value=0></td></tr></table>';
    m += '<DIV style="text-align:center; margin-top:15px"><INPUT id=pbSaveRouteCrest type=button class=pbButton  value="'+lang.crest.add+'"></div>';
    m+='<br>'+pubdusite;
    t.myDiv.innerHTML = m;
	ById('bocrestslot').addEventListener('change', function(){
	  if (parseIntNan(ById('bocrestslot').value)>10) ById('bocrestslot').value=1;
		Options.CrestSlot = ById('bocrestslot').value;
		saveOptions();
	}, false);
	ById('ResetCrestTargets').addEventListener('click', function(){
		resetCrestData();
	}, false);
	ById('pbsendreport').addEventListener('change', function(){
		Options.crestreport = document.getElementById('pbsendreport').checked;
		saveOptions();
	}, false);
	ById('pbsendcrestreportint').addEventListener('change', function(){
		Options.CrestMsgInterval = parseIntNan(ById('pbsendcrestreportint').value);
		saveOptions();
	}, false);
    ById("pbcrest_interval").addEventListener('change', function(e){
       		if (parseIntNan(e.target.value)<3) e.target.value=3;
    		Options.Crestinterval = parseIntNan(e.target.value);
    		saveOptions();
	},false);
    for (var i=0;i<Seed.cities.length;i++){
		if (CrestOptions.CrestCity == Seed.cities[i][0]){
			selbut=i;break;
		}
	}
    t.tcp = new CdispCityPicker ('crestcityselect', ById('crestcity'), true, t.clickCitySelect, selbut);
    if (CrestOptions.CrestCity == 0) CrestOptions.CrestCity = t.tcp.city.id
    ById('bosendreportnow').addEventListener('click', function() {	t.sendCrestReportNow();	}, false);
    ById('pbcrestx').addEventListener('keyup', function(){if (isNaN(ById('pbcrestx').value)) ById('pbcrestx').value='';}, false);
    ById('pbcresty').addEventListener('keyup', function(){if (isNaN(ById('pbcresty').value)) ById('pbcresty').value='';}, false);
    ById('R1ST').addEventListener('keyup', function(){if (isNaN(ById('R1ST').value)) ById('R1ST').value=0;}, false);
    ById('R1MM').addEventListener('keyup', function(){if (isNaN(ById('R1MM').value)) ById('R1MM').value=0;}, false);
    ById('R1Pike').addEventListener('keyup', function(){ if (isNaN(ById('R1Pike').value)) ById('R1Pike').value=0;}, false);
    ById('R1Scout').addEventListener('keyup', function(){if (isNaN(document.getElementById('R1Scout').value)) document.getElementById('R1Scout').value=0;}, false);
    ById('R1Sword').addEventListener('keyup', function(){if (isNaN(document.getElementById('R1Sword').value)) document.getElementById('R1Sword').value=0;}, false);
    ById('R1Arch').addEventListener('keyup', function(){if (isNaN(document.getElementById('R1Arch').value)) document.getElementById('R1Arch').value=0;}, false);
    ById('R1LC').addEventListener('keyup', function(){if (isNaN(document.getElementById('R1LC').value)) document.getElementById('R1LC').value=0;}, false);

      document.getElementById('R1HC').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R1HC').value)) document.getElementById('R1HC').value=0 ;
      }, false);

      document.getElementById('R1SW').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R1SW').value)) document.getElementById('R1SW').value=0 ;
      }, false);

      document.getElementById('R1Ball').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R1Ball').value)) document.getElementById('R1Ball').value=0 ;
      }, false);

      document.getElementById('R1Ram').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R1Ram').value)) document.getElementById('R1Ram').value=0 ;
      }, false);

      document.getElementById('R1Cat').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R1Cat').value)) document.getElementById('R1Cat').value=0 ;
      }, false);

      document.getElementById('R2ST').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2ST').value)) document.getElementById('R2ST').value=0 ;
      }, false);

      document.getElementById('R2MM').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2MM').value)) document.getElementById('R2MM').value=0 ;
      }, false);

      document.getElementById('R2Pike').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Pike').value)) document.getElementById('R2Pike').value=0 ;
      }, false);

      document.getElementById('R2Scout').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Scout').value)) document.getElementById('R2Scout').value=0 ;
      }, false);

      document.getElementById('R2Sword').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Sword').value)) document.getElementById('R2Sword').value=0 ;
      }, false);

      document.getElementById('R2Arch').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Arch').value)) document.getElementById('R2Arch').value=0 ;
      }, false);

      document.getElementById('R2LC').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2LC').value)) document.getElementById('R2LC').value=0 ;
      }, false);

      document.getElementById('R2HC').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2HC').value)) document.getElementById('R2HC').value=0 ;
      }, false);

      document.getElementById('R2SW').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2SW').value)) document.getElementById('R2SW').value=0 ;
      }, false);

      document.getElementById('R2Ball').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Ball').value)) document.getElementById('R2Ball').value=0 ;
      }, false);

      document.getElementById('R2Ram').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Ram').value)) document.getElementById('R2Ram').value=0 ;
      }, false);

      document.getElementById('R2Cat').addEventListener('keyup', function(){
          if (isNaN(document.getElementById('R2Cat').value)) document.getElementById('R2Cat').value=0 ;
      }, false);

    document.getElementById('crestcity').addEventListener('click', function(){CrestOptions.CrestCity = t.tcp.city.id;} , false);
    document.getElementById('Cresttoggle').addEventListener('click', function(){t.toggleCrestState(this)} , false);
    document.getElementById('pbcrestx').addEventListener('change', function(){CrestOptions.X = document.getElementById('pbcrestx').value;;} , false);
    document.getElementById('pbcresty').addEventListener('change', function(){CrestOptions.Y = document.getElementById('pbcresty').value;} , false);
    document.getElementById('R1ST').addEventListener('change', function(){CrestOptions.R1ST = document.getElementById('R1ST').value;} , false);
    document.getElementById('R1MM').addEventListener('change', function(){CrestOptions.R1MM = document.getElementById('R1MM').value;} , false);
    document.getElementById('R1Scout').addEventListener('change', function(){CrestOptions.R1Scout = document.getElementById('R1Scout').value;} , false);
    document.getElementById('R1Pike').addEventListener('change', function(){CrestOptions.R1Pike = document.getElementById('R1Pike').value;} , false);
    document.getElementById('R1Sword').addEventListener('change', function(){CrestOptions.R1Sword = document.getElementById('R1Sword').value;} , false);
    document.getElementById('R1Arch').addEventListener('change', function(){CrestOptions.R1Arch = document.getElementById('R1Arch').value;} , false);
    document.getElementById('R1LC').addEventListener('change', function(){CrestOptions.R1LC = document.getElementById('R1LC').value;} , false);
    document.getElementById('R1HC').addEventListener('change', function(){CrestOptions.R1HC = document.getElementById('R1HC').value;} , false);
    document.getElementById('R1SW').addEventListener('change', function(){CrestOptions.R1SW = document.getElementById('R1SW').value;} , false);
    document.getElementById('R1Ball').addEventListener('change', function(){CrestOptions.R1Ball = document.getElementById('R1Ball').value;} , false);
    document.getElementById('R1Ram').addEventListener('change', function(){CrestOptions.R1Ram = document.getElementById('R1Ram').value;} , false);
    document.getElementById('R1Cat').addEventListener('change', function(){CrestOptions.R1Cat = document.getElementById('R1Cat').value;} , false);
    document.getElementById('R2ST').addEventListener('change', function(){CrestOptions.R2ST = document.getElementById('R2ST').value;} , false);
    document.getElementById('R2MM').addEventListener('change', function(){CrestOptions.R2MM = document.getElementById('R2MM').value;} , false);
    document.getElementById('R2Scout').addEventListener('change', function(){CrestOptions.R2Scout = document.getElementById('R2Scout').value;} , false);
    document.getElementById('R2Pike').addEventListener('change', function(){CrestOptions.R2Pike = document.getElementById('R2Pike').value;} , false);
    document.getElementById('R2Sword').addEventListener('change', function(){CrestOptions.R2Sword = document.getElementById('R2Sword').value;} , false);
    document.getElementById('R2Arch').addEventListener('change', function(){CrestOptions.R2Arch = document.getElementById('R2Arch').value;} , false);
    document.getElementById('R2LC').addEventListener('change', function(){CrestOptions.R2LC = document.getElementById('R2LC').value;} , false);
    document.getElementById('R2HC').addEventListener('change', function(){CrestOptions.R2HC = document.getElementById('R2HC').value;} , false);
    document.getElementById('R2SW').addEventListener('change', function(){CrestOptions.R2SW = document.getElementById('R2SW').value;} , false);
    document.getElementById('R2Ball').addEventListener('change', function(){CrestOptions.R2Ball = document.getElementById('R2Ball').value;} , false);
    document.getElementById('R2Ram').addEventListener('change', function(){CrestOptions.R2Ram = document.getElementById('R2Ram').value;} , false);
    document.getElementById('R2Cat').addEventListener('change', function(){CrestOptions.R2Cat = document.getElementById('R2Cat').value;} , false);
    document.getElementById('CrestHelp').addEventListener('click', function(){t.helpPop();} , false);
    document.getElementById('pbSaveRouteCrest').addEventListener('click', function(){CrestOptions.active="Actif";t.addCrestRoute();}, false);
    document.getElementById('showCrestTargets').addEventListener('click', function(){t.showCrestRoute();}, false);
  },


helpPop : function (){
    var helpText = lang.crest.helpText;
    var pop = new CPopup ('ArmoiriesHelp', 0, 0, 585, 400, true);
    pop.centerMe (mainPop.getMainDiv());
    pop.getMainDiv().innerHTML = helpText;
    pop.getTopDiv().innerHTML = '<CENTER><B>'+lang.crest.helpTitle+'</b></center>';
    pop.show (true);
  },
    addCrestRoute : function () {
		if(CrestOptions.X == "" || CrestOptions.Y == "") {
			return;
		}
		var t = Tabs.Crest;
		var CrestLength = CrestData.length;
		CrestData[CrestLength] = new CrestFunc(CrestOptions);
		saveCrestData();
    },
    showCrestRoute : function () {
		var t = Tabs.Crest;
		var popCrestTargets = null;
		t.popCrestTargets = new CPopup('pbShowCrestTargets', 0, 0, 1100, 500, true, function() {clearTimeout (1000);});
		var m = '<DIV style="max-height:460px; height:460px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbShowCrestTargets" id="pbCrestTargets">';
		t.popCrestTargets.getMainDiv().innerHTML = '</table></div>' + m;
		t.popCrestTargets.getTopDiv().innerHTML = '<TD><B>'+lang.crest.popCrest+'</td>';
		t.paintCrestTargets();
		t._addTabHeader();
		t.popCrestTargets.show(true);
    },
    _addTabHeader : function () {
		var row = document.getElementById('pbCrestTargets').insertRow(0);
		row.vAlign = 'top';
	     	row.insertCell(0).innerHTML = uW.g_js_strings.commonstr.target;
	     	row.insertCell(1).innerHTML = lang.crest.wave + " #";
	     	row.insertCell(2).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_1_30.png>";
	     	row.insertCell(3).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_2_30.png>";
	     	row.insertCell(4).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_3_30.png>";
	     	row.insertCell(5).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_4_30.png>";
	     	row.insertCell(6).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_5_30.png>";
	     	row.insertCell(7).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_6_30.png>";
	     	row.insertCell(8).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_7_30.png>";
	     	row.insertCell(9).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_8_30.png>";
	     	row.insertCell(10).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_9_30.png>";
	     	row.insertCell(11).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_10_30.png>";
	     	row.insertCell(12).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_11_30.png>";
	     	row.insertCell(13).innerHTML = "<img width=25 src="+gameurl+"img/units/unit_12_30.png>";
	     	row.insertCell(14).innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;";
	     	row.insertCell(14).innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
    },
    paintCrestTargets : function () {
		t = Tabs.Crest;

		for(var i = 0; i < CrestData.length; i++) {
			t._addTabCrest(i, uW.g_js_strings.commonstr.location+' : <a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">(' + CrestData[i].X + ',' + CrestData[i].Y+')</a>', "<b>2</b>", CrestData[i].R2ST, CrestData[i].R2MM, CrestData[i].R2Scout, CrestData[i].R2Pike, CrestData[i].R2Sword, CrestData[i].R2Arch, CrestData[i].R2LC, CrestData[i].R2HC, CrestData[i].R2SW, CrestData[i].R2Ball, CrestData[i].R2Ram, CrestData[i].R2Cat, " "," ");
			if (CrestData[i].active=="Actif")
			 t._addTabCrest(i, CrestData[i].CrestCity, "<b>1</b>", CrestData[i].R1ST, CrestData[i].R1MM, CrestData[i].R1Scout, CrestData[i].R1Pike, CrestData[i].R1Sword, CrestData[i].R1Arch, CrestData[i].R1LC, CrestData[i].R1HC, CrestData[i].R1SW, CrestData[i].R1Ball, CrestData[i].R1Ram, CrestData[i].R1Cat, uW.g_js_strings.commonstr.remove, lang.crest.actif);
			else
			 t._addTabCrest(i, CrestData[i].CrestCity, "<b>1</b>", CrestData[i].R1ST, CrestData[i].R1MM, CrestData[i].R1Scout, CrestData[i].R1Pike, CrestData[i].R1Sword, CrestData[i].R1Arch, CrestData[i].R1LC, CrestData[i].R1HC, CrestData[i].R1SW, CrestData[i].R1Ball, CrestData[i].R1Ram, CrestData[i].R1Cat, uW.g_js_strings.commonstr.remove, lang.crest.inactif);
			t._addTabCrest(i, "","","","","","","","","","","","","","","","");
		}
    },
    _addTabCrest : function (QueID, col0, col1, col2, col3, col4, col5, col6, col7, col8, col9, col10, col11, col12, col13, col14, col15) {
		var t = Tabs.Crest;
		var row = ById('pbCrestTargets').insertRow(0);
		for (var i = 0; i <= 15; i++) {
			if (i == 14 && col14 == uW.g_js_strings.commonstr.remove) {
				row.insertCell(i).innerHTML = "<input type=button class=pbButton  id=pbCrestDel_" + QueID + " value='" + uW.g_js_strings.commonstr.remove+"'>";
				ById('pbCrestDel_' + QueID).addEventListener('click', function(){t.cancelCrestTarget(QueID);}, false);
			} else if (col14 == uW.g_js_strings.commonstr.remove && i == 0) {
				row.insertCell(i).innerHTML = Cities.byID[col0].name;
			} else if  (i == 15 && col14 == uW.g_js_strings.commonstr.remove) {

			  if (CrestData[QueID].active=="Actif") {
			   row.insertCell(i).innerHTML = "<input type=button class=pbButton id=BOCrestAct_" + QueID + " value='"+lang.crest.actif+"'>";
			     ById('BOCrestAct_' + QueID).addEventListener('click', function(){ CrestData[QueID].active="De-Actif";saveCrestData();t.showCrestRoute();  }, false);
			  } else if (CrestData[QueID].active=="De-Actif") {
			   row.insertCell(i).innerHTML = "<input type=button class=pbButton id=BOCrestAct_" + QueID + " value=" +lang.crest.inactif+"'>";
			     ById('BOCrestAct_' + QueID).addEventListener('click', function(){ CrestData[QueID].active="Actif";saveCrestData();t.showCrestRoute();  }, false);
			  }
			}else{
				row.insertCell(i).innerHTML = eval("col" + i) + "&nbsp; &nbsp;";
			}
		}
   },
   cancelCrestTarget : function (QueID) {
	     var t = Tabs.Crest;
	     var queueId = parseInt(QueID);
	     CrestData.splice(queueId, 1);
	     saveCrestData();
	     t.showCrestRoute();
   },
   getAtkKnight : function(cityID,tri){
		var t = Tabs.Crest;
		t.knt = new Array();
		for (k in Seed.knights[cityID]){
			if (Seed.knights[cityID][k]["knightStatus"] == 1 && Seed.leaders[cityID]["resourcefulnessKnightId"] != Seed.knights[cityID][k]["knightId"] && Seed.leaders[cityID]["politicsKnightId"] != Seed.knights[cityID][k]["knightId"] && Seed.leaders[cityID]["combatKnightId"] != Seed.knights[cityID][k]["knightId"] && Seed.leaders[cityID]["intelligenceKnightId"] != Seed.knights[cityID][k]["knightId"]){
     			t.knt.push ({
     				Name:   Seed.knights[cityID][k]["knightName"],
     				Combat:	parseInt(Seed.knights[cityID][k]["combat"]),
     				ID:		Seed.knights[cityID][k]["knightId"],
     			});
     		}
		}
		if (tri==1) {
			t.knt = t.knt.sort(function sort(a,b) {a = parseInt(a['Combat']);b = parseInt(b['Combat']);return a == b ? 0 : (a < b ? -1 : 1);});
			//actionLog("AutoTS", "Changement chevalier ! " + tri);
		}else {
			t.knt = t.knt.sort(function sort(a,b) {a = parseInt(a['Combat']);b = parseInt(b['Combat']);return a == b ? 0 : (a > b ? -1 : 1);});
			//actionLog("AutoTS", "Changement chevalier ! " + tri);
		}
	},
 	sendMarch: function(p,callback,r,retry, CrestDataNum,tri){
		var t = Tabs.Crest;
		tri=0;
		if (Options.crestRunning == false) {
			clearTimeout(t.timer);
		    return;
	    }
  		March.addMarch(p, function(rslt){
			 if(rslt.ok){
			  if(r==1){
			  	 	Options.Crest1Count++;
			  	 	r = 2;
			  	 	var now = new Date().getTime()/1000.0;
					now = now.toFixed(0);
			  	 	CrestData[CrestDataNum].lastRoundTwo = now;
			  	 	saveCrestData();
					setTimeout (function(){callback(2,0,parseInt(CrestDataNum)+1,tri);}, Options.Crestinterval*1000);
			        return;
 			  } else {
				 Options.Crest2Count++;
				 saveCrestData();
				 setTimeout (function(){callback(r,0,parseInt(CrestDataNum)+1,tri);}, (Math.random()*1000)+((Options.Crestinterval-1)*1000));
			     return;
 			  }

			 } else { //onFailure

			  	if (rslt.error_code==213) { // pb chevalier
			 	 tri=1;
				}
				if (rslt.error_code==206) {
					var cityID = 'city' + CrestData[CrestDataNum].CrestCity;
					for (var k in Seed.wilderness[cityID] ){
						if (Seed.wilderness[cityID][k]['xCoord']==CrestData[CrestDataNum].X && Seed.wilderness[cityID][k]['yCoord']==CrestData[CrestDataNum].Y) {
							//if (Options.LogsAutoTs) actionLog("AutoTS",Cities.byID[p.cid].name + " - abandon suite");
							t.abandonWilderness(Seed.wilderness[cityID][k]['tileId'],Seed.wilderness[cityID][k]['xCoord'],Seed.wilderness[cityID][k]['yCoord'],CrestData[CrestDataNum].CrestCity,t.Rounds,retry,CrestDataNum);
						}
					}
				}

			    if (Options.LogsAutoTs) actionLog("AutoTS",Cities.byID[p.cid].name + " - Erreur Envoi marche numero "+r + " - code : " + rslt.error_code);
			  	setTimeout (function(){callback(r,0,parseInt(CrestDataNum)+1,tri);}, (Math.random()*1200)+((Options.Crestinterval-2)*1000));
			  }
	 	});
	},
	abandonWilderness: function(tid,x,y,cid,callback,retry, CrestDataNum){
		var t = Tabs.Crest;
		if (!Options.crestRunning) return;
		var params = uW.Object.clone(uW.g_ajaxparams);
		var cityID = cid;
		var tileid = tid;
		params.tid=tid;
		params.cid=cid;
		params.x=x;
  		params.y=y;
  		new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/abandonWilderness.php" + unsafeWindow.g_ajaxsuffix, {
			method: "post",
  		    parameters: params,
  		    loading: true,
  		    onSuccess:function(transport){
				var rslt=eval("("+transport.responseText+")");
				if (rslt.ok) {
					t.error_code = 0;
					if (rslt.returningMarches) {
						var cities = Object.keys(rslt.returningMarches);
						for (var i = 0; i < cities.length; i++) {
							for (var j = 0; j < rslt.returningMarches[cities[i]].length; j++) {
				                var cid = cities[i].split("c")[1];
				                var mid = rslt.returningMarches[cities[i]][j];
				                var march = Seed.queue_atkp["city" + cid]["m" + mid];
								if (march) {
									var marchtime = Math.abs(parseInt(march.destinationUnixTime) - parseInt(march.marchUnixTime));
				                    var ut = unsafeWindow.unixtime();
				                    Seed.queue_atkp["city" + cid]["m" + mid].destinationUnixTime = ut;
				                    Seed.queue_atkp["city" + cid]["m" + mid].marchUnixTime = ut - marchtime;
				                    Seed.queue_atkp["city" + cid]["m" + mid].returnUnixTime = ut + marchtime;
				                    Seed.queue_atkp["city" + cid]["m" + mid].marchStatus = 8
				                }
				            }
				        }
				    }
					if(rslt.updateSeed){unsafeWindow.update_seed(rslt.updateSeed)};
				    if (Object.keys(Seed.wilderness["city" + cityID]).length == 1) {
						Seed.wilderness["city" + cityID] = []
  		         	} else	{
						delete Seed.wilderness["city"+cityID]["t"+tileid];
  		         	}
				} else {
					if (rslt.error_code != 401) {
						t.error_code = rslt.error_code;

               		}
  		        }
  		    },
  		    onFailure: function () {}
  		});
    },
    Rounds : function (r, retry, CrestDataNum,tri) {
		var t = Tabs.Crest;
		clearTimeout(t.timer);
		if (!Options.crestRunning) return;
		if (CrestData.length == 0)
			return;
		if (CrestDataNum >= CrestData.length)
			CrestDataNum = 0;
		if (CrestData[CrestDataNum].active=="De-Actif") {
			CrestDataNum++;
			if (CrestDataNum >= CrestData.length) CrestDataNum = 0;
		    t.Rounds(1,0,CrestDataNum,tri);
		    return;
		}
		cityID = 'city' + CrestData[CrestDataNum].CrestCity;
		retry++;
		for (var k in Seed.wilderness[cityID] ){
			if (Seed.wilderness[cityID][k]['xCoord']==CrestData[CrestDataNum].X && Seed.wilderness[cityID][k]['yCoord']==CrestData[CrestDataNum].Y && t.error_code!=401) {
				t.abandonWilderness(Seed.wilderness[cityID][k]['tileId'],Seed.wilderness[cityID][k]['xCoord'],Seed.wilderness[cityID][k]['yCoord'],CrestData[CrestDataNum].CrestCity,t.Rounds,retry,CrestDataNum);
				break;
			}
		}

		switch (retry) {
			case 10:
				t.timer = setTimeout(function(){ t.Rounds(r,retry,CrestDataNum,tri);},Options.Crestinterval*1000);
				return;
				break;
			case 20:
				t.timer = setTimeout(function(){ t.Rounds(r,retry,CrestDataNum,tri);},Options.Crestinterval*1000);
				return;
				break;
		}
		if ((r==1 && (parseInt(Seed.units[cityID]['unt1']) < CrestData[CrestDataNum].R1ST || parseInt(Seed.units[cityID]['unt2']) < CrestData[CrestDataNum].R1MM || parseInt(Seed.units[cityID]['unt3']) < CrestData[CrestDataNum].R1Scout || parseInt(Seed.units[cityID]['unt4']) < CrestData[CrestDataNum].R1Pike || parseInt(Seed.units[cityID]['unt5']) < CrestData[CrestDataNum].R1Sword || parseInt(Seed.units[cityID]['unt6']) < CrestData[CrestDataNum].R1Arch || parseInt(Seed.units[cityID]['unt7']) < CrestData[CrestDataNum].R1LC || parseInt(Seed.units[cityID]['unt8']) < CrestData[CrestDataNum].R1HC || parseInt(Seed.units[cityID]['unt9']) < CrestData[CrestDataNum].R1SW || parseInt(Seed.units[cityID]['unt10']) < CrestData[CrestDataNum].R1Ball || parseInt(Seed.units[cityID]['unt11']) < CrestData[CrestDataNum].R1Ram || parseInt(Seed.units[cityID]['unt12']) < CrestData[CrestDataNum].R1Cat
		     )) || (r==2 && (parseInt(Seed.units[cityID]['unt1']) < CrestData[CrestDataNum].R2ST || parseInt(Seed.units[cityID]['unt2']) < CrestData[CrestDataNum].R2MM || parseInt(Seed.units[cityID]['unt3']) < CrestData[CrestDataNum].R2Scout || parseInt(Seed.units[cityID]['unt4']) < CrestData[CrestDataNum].R2Pike || parseInt(Seed.units[cityID]['unt5']) < CrestData[CrestDataNum].R2Sword || parseInt(Seed.units[cityID]['unt6']) < CrestData[CrestDataNum].R2Arch || parseInt(Seed.units[cityID]['unt7']) < CrestData[CrestDataNum].R2LC || parseInt(Seed.units[cityID]['unt8']) < CrestData[CrestDataNum].R2HC || parseInt(Seed.units[cityID]['unt9']) < CrestData[CrestDataNum].R2SW || parseInt(Seed.units[cityID]['unt10']) < CrestData[CrestDataNum].R2Ball || parseInt(Seed.units[cityID]['unt11']) < CrestData[CrestDataNum].R2Ram || parseInt(Seed.units[cityID]['unt12']) < CrestData[CrestDataNum].R2Cat
		     )))
		    {
			if (Options.LogsAutoTs)
			 actionLog("AutoTS","Pas assez de troupes dispo pour la vague "+r);
			if (CrestData.length == 1) {
				t.timer =setTimeout(function(){ t.Rounds(r,retry,CrestDataNum,tri);},Options.Crestinterval*1000);
				return;
			 } else
				t.timer =setTimeout(function(){ t.Rounds(1,retry,parseInt(CrestDataNum)+1,tri);},Options.Crestinterval*1000);
			return;
		}
		t.rallypointlevel = March.RallyPoint(CrestData[CrestDataNum].CrestCity).maxSlots;
		t.getAtkKnight(cityID,tri);
		slots=March.RallyPoint(CrestData[CrestDataNum].CrestCity).marching;
        slots=parseInt(slots)+parseInt(Options.CrestSlot);
          if (t.rallypointlevel <= slots) {
							 if (Options.LogsAutoTs)
			 					actionLog("AutoTS",Cities.byID[CrestData[CrestDataNum].CrestCity].name + " -Point de ralliement complet - vague n "+r);
							if (CrestData.length == 1) {
								t.timer = setTimeout(function(){ t.Rounds(r,retry,CrestDataNum,tri);},Options.Crestinterval*1000);
							} else {
								t.timer = setTimeout(function(){ t.Rounds(1,retry,parseInt(CrestDataNum)+1,tri);},Options.Crestinterval*1000);
							}
							return;

						}
		if  (t.knt.toSource() == "[]") {
			if (Options.LogsAutoTs)actionLog("AutoTS",Cities.byID[CrestData[CrestDataNum].CrestCity].name + " - Aucun Chevalier disponible");
			t.timer = setTimeout(function(){ t.Rounds(1,retry,parseInt(CrestDataNum)+1,tri);},Options.Crestinterval*1000);
			return;
		}
		var kid = t.knt[0].ID;
		if (CrestData[CrestDataNum].R1ST == 0 && CrestData[CrestDataNum].R1MM == 0 && CrestData[CrestDataNum].R1Scout == 0 && CrestData[CrestDataNum].R1Pike == 0 && CrestData[CrestDataNum].R1Sword == 0 && CrestData[CrestDataNum].R1Arch == 0 && CrestData[CrestDataNum].R1LC == 0 && CrestData[CrestDataNum].R1HC == 0 && CrestData[CrestDataNum].R1SW == 0 && CrestData[CrestDataNum].R1Ball == 0 && CrestData[CrestDataNum].R1Ram == 0 && CrestData[CrestDataNum].R1Cat == 0) {
		   r=2;
	   	}else {
			var now = new Date().getTime()/1000.0;
			now = now.toFixed(0);
			if (parseInt(now) > parseInt(CrestData[CrestDataNum].lastRoundTwo) + 400) {
				r=1;
			}else {
				 r=2;
			}
		}
		saveCrestData();
		switch(r) {
			case 1:
				if ((t.rallypointlevel-slots) < 2) {
					t.timer =setTimeout(function(){ t.Rounds(1,retry,(parseInt(CrestDataNum)+1),tri);},Options.Crestinterval*1000);
					return;
				}
				var params 		= 	unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
				params.cid		= 	CrestData[CrestDataNum].CrestCity;
				params.type		=	4;
				params.kid		= 	kid;
				params.xcoord 	= 	CrestData[CrestDataNum].X;
				params.ycoord 	= 	CrestData[CrestDataNum].Y;
				if (now < (parseInt(CrestData[CrestDataNum].lastRoundTwo) + 400)) {

					params.u2 	= 	(CrestData[CrestDataNum].R1MM / 10);
					params.u2 	= 	params.u2.toFixed(0);

					if (params.u2 < (CrestData[CrestDataNum].R1MM / 10))
						params.u2++;
				} else {
					params.u2	= 	CrestData[CrestDataNum].R1MM;
				}
				params.u1 		= 	CrestData[CrestDataNum].R1ST;
				params.u2 		= 	CrestData[CrestDataNum].R1MM;
				params.u3 		= 	CrestData[CrestDataNum].R1Scout;
				params.u4 		= 	CrestData[CrestDataNum].R1Pike;
				params.u5 		= 	CrestData[CrestDataNum].R1Sword;
				params.u6 		= 	CrestData[CrestDataNum].R1Arch;
				params.u7 		= 	CrestData[CrestDataNum].R1LC;
				params.u8 		= 	CrestData[CrestDataNum].R1HC;
				params.u9 		= 	CrestData[CrestDataNum].R1SW;
				params.u10 		= 	CrestData[CrestDataNum].R1Ball;
				params.u11 		= 	CrestData[CrestDataNum].R1Ram;
				params.u12 		= 	CrestData[CrestDataNum].R1Cat;

				t.sendMarch(params,t.Rounds,r,retry, CrestDataNum,tri);
				break;
			default:
				var params 		= 	unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
				params.cid		= 	CrestData[CrestDataNum].CrestCity;
				params.type		= 	4;
				params.kid		= 	kid;
				params.xcoord 	= 	CrestData[CrestDataNum].X;
				params.ycoord 	= 	CrestData[CrestDataNum].Y;
				params.u1 		= 	CrestData[CrestDataNum].R2ST;
				params.u2 		= 	CrestData[CrestDataNum].R2MM;
				params.u3 		= 	CrestData[CrestDataNum].R2Scout;
				params.u4 		= 	CrestData[CrestDataNum].R2Pike;
				params.u5 		= 	CrestData[CrestDataNum].R2Sword;
				params.u6 		= 	CrestData[CrestDataNum].R2Arch;
				params.u7 		= 	CrestData[CrestDataNum].R2LC;
				params.u8 		= 	CrestData[CrestDataNum].R2HC;
				params.u9 		= 	CrestData[CrestDataNum].R2SW;
				params.u10 		= 	CrestData[CrestDataNum].R2Ball;
				params.u11 		= 	CrestData[CrestDataNum].R2Ram;
				params.u12 		= 	CrestData[CrestDataNum].R2Cat;
				t.sendMarch(params,t.Rounds,r,retry, CrestDataNum,tri);
				break;
		}

	},



	toggleCrestState: function(obj) {
		var t = Tabs.Crest;
		obj = ById('Cresttoggle');
			if (Options.crestRunning == true) {
				Options.crestRunning = false;
				if (obj) obj.value = lang.crest.Cresttoggle+" = OFF";
				if (Options.BORac_Ts) updatebotbutton(lang.crest.button+' - OFF', 'pbautotstab');
				saveOptions();
			} else {
				Options.crestRunning = true;
				if (obj) obj.value = lang.crest.Cresttoggle+" = ON";
				if (Options.BORac_Ts) updatebotbutton(lang.crest.button+' - ON', 'pbautotstab');
				Options.Creststatus={1:0,2:0,3:0,4:0,5:0,34001:0,20013:0,37:0,30347:0,20005:0,20006:0,20012:0,27001:0,401:0,20011:0,3002:0,3011:0,10021:0,3001:0,1101:0,1102:0,1103:0,1104:0,911:0,1105:0,1106:0,1107:0,1108:0,1109:0,1110:0,1111:0,1112:0,1113:0,1114:0,1115:0,9:0,36:0,37:0,38:0,55:0,57:0,261:0,262:0,271:0,272:0,351:0,361:0,362:0,911:0,3000:0,3001:0,3002:0,3003:0,3007:0,3008:0,3009:0,3011:0,931:0,932:0,285:0,};
				for (crest in Options.Creststatus) {
					owned = Seed.items['i'+crest];
					if (owned == undefined) {
						owned=0;
					}
					Options.Creststatus[crest] = owned;
					Options.Crest1Count = 0;
					Options.Crest2Count = 0;
				}
				var now = new Date().getTime()/1000.0;
				now = now.toFixed(0);
				Options.LastCrestReport = now;
				saveOptions();
				t.timer =setTimeout(function(){ t.Rounds(1,0,0,0);}, 1000);
			}
	},
	 sendCrestReportNow: function(){
	    	var t = myBO.Crest;
	    	var now = new Date().getTime()/1000.0;
	        now = now.toFixed(0);
	    	var total = 0;
	    	var wildtype = '';

		var message = lang.crest.msg1+' %0A';
		message += '%0A '+lang.crest.msg2+'%0A';

		for (crest in Options.Creststatus) {
			owned = Seed.items['i'+crest];
			if (owned == undefined)
				owned =	0;
			if ((owned - Options.Creststatus[crest]) > 0)
				message	+= 	'<DIV><B>' + unsafeWindow.itemlist['i'+crest]['name'] +': '+ (owned - Options.Creststatus[crest]) +'%0A </b></div>';
			total += (owned - Options.Creststatus[crest]);
			Options.Creststatus[crest] = owned;

		}
		message += '%0A '+lang.crest.msg3+' ' + timestr(now-Options.LastCrestReport) + '%0A'
		message += '%0A '+lang.crest.msg4+' '+ total +'%0A';
		message += '%0A '+lang.crest.msg5+' '+ Options.Crest1Count +'%0A';
		message += ''+lang.crest.msg6+' '+ Options.Crest2Count +'%0A';

	    	Options.Crest1Count = 0;
	    	Options.Crest2Count = 0;
	    	Options.Crest3Count = 0;
	    	Options.Crest4Count = 0;
	      var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
	      params.emailTo = Seed.player.name;
	      params.subject = lang.crest.msg7;
	      params.message = message;
	      params.requestType = "COMPOSED_MAIL";
	      new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getEmail.php" + unsafeWindow.g_ajaxsuffix, {
	          method: "post",
	          parameters: params,
	          onSuccess: function (message) {
	              var rslt = eval("(" + message.responseText + ")");
	              if (rslt.ok) {
	              		Options.LastCrestReport = now;
	              } else {
	              }
	          },
	          onFailure: function () {
	          },
	      });
	      saveOptions();
      },
	sendCrestReport: function(){
		if(!Options.crestRunning  || !Options.crestreport)
			return;

		var t = Tabs.Crest;
		var now = new Date().getTime()/1000.0;
		now = now.toFixed(0);

		if (now < (parseInt(Options.LastCrestReport)+(Options.CrestMsgInterval*60*60)))
			return;

		var total = 0;
		var wildtype = 	'';

		var message = 'Crest Stats: %0A';
		message += '%0A Crests Gained%0A';

		for (crest in Options.Creststatus) {
			owned = Seed.items['i'+crest];
			if (owned == undefined)
				owned =	0;
			if ((owned - Options.Creststatus[crest]) > 0)
				message	+= 	'<DIV><B>' + unsafeWindow.itemlist['i'+crest]['name'] +': '+ (owned - Options.Creststatus[crest]) +'%0A </b></div>';
			else
				message	+= 	unsafeWindow.itemlist['i'+crest]['name'] +': '+ (owned - Options.Creststatus[crest]) +'%0A';

			total += (owned - Options.Creststatus[crest]);
			Options.Creststatus[crest] = owned;
		}

		message += '%0A Total Crests gained: '+ total +'%0A';
		message += '%0A Numbers of 1st Wave send: '+ Options.Crest1Count +'%0A';
		message += 'Numbers of 2nd Wave send: '+ Options.Crest2Count +'%0A';

		Options.Crest1Count = 0;
		Options.Crest2Count = 0;

		var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
		params.emailTo = Seed.player.name;
		params.subject = lang.crest.msg7;
		params.message = message;
		params.requestType = "COMPOSED_MAIL";

		new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getEmail.php" + unsafeWindow.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			onSuccess: function (message) {
				var rslt = eval("(" + message.responseText + ")");
				if (rslt.ok) {
					Options.LastCrestReport = now;
				}
			},
			onFailure: function () {
			},
		});

		saveOptions();
	},


	hide : function (){
		var t = Tabs.Crest;
	},

	show : function (){
	 var t = Tabs.Crest;if (TESTBAO==-1) return false;
	if (ById ('maparea_map').style.display!="none") {
	         ById ('pbcrestx').value = ById ('mapXCoor').value;
                 ById ('pbcresty').value = ById ('mapYCoor').value;
                 CrestOptions.X = ById('pbcrestx').value;
                 CrestOptions.Y = ById('pbcresty').value;
         }
	},
 };
Tabs.AllianceList = {
  tabOrder: 6,
  tabLabel: uW.g_js_strings.commonstr.player,
  cont : null,
  nombre: null,
  state : null,
  dat : [],

  show : function (){
  },

  hide : function (){
  },

  init : function (div){
     var t = Tabs.AllianceList;
        t.cont = div;
        t.nombre=0;
        uW.BoPTgetMembers = t.eventGetMembers;
        uW.PTPaintMembers = t.GetDataForMap;
        uW.BoPTDme = t.eventGetLienMember;
        uW.BoPTpd = t.clickedPlayerDetail;
        uW.BoPTpl = t.clickedPlayerLeaderboard;
        uW.BoPTpl2 = t.clickedPlayerLeaderboard2;
        uW.BoPCplo = t.clickedPlayerGetLastLogin;
        uW.BoPTalClickPrev = t.eventListPrev;
        uW.BoPTalClickNext = t.eventListNext;

    if (t.state == null){
      if (getMyAlliance()[0] == 0) {
        t.cont.innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.membersInfo.youmustbelong+'</center>';
        t.state = 1;
        return;
      }
      var m = '<DIV class=ptentry><TABLE width=100% cellpadding=0><TR><TD class=xtab align=right></td><TD class=xtab>'+lang.AllianceList.allPlayName+' &nbsp;</td>\
            <TD width=80% class=xtab><INPUT id=allPlayName size=20 type=text/> &nbsp; <INPUT id=playSubmit type=submit value="'+uW.g_js_strings.modal_fow_leaderboard.searchuser+'" /> <INPUT id=ffbuidsubmit  type=submit value="UID" /></td>\
            <TD class="xtab ptErrText"><SPAN id=ptplayErr></span></td></tr><TR><TD class=xtab>&nbsp;</td><TD class=xtab>'+uW.g_js_strings.setDiplomacyWindow.srchalli+' : &nbsp;</td>\
            <TD class=xtab><INPUT id=allAllName type=text /> &nbsp; <INPUT id=allSubmit type=submit value="'+uW.g_js_strings.modal_fow_leaderboard.findalli+'" /></td>\
            <TD class="xtab ptErrText"><SPAN id=ptallErr></span></td></tr><TR><TD class=xtab>&nbsp;</td><TD class=xtab> &nbsp;\
            <INPUT align=left id=allListSubmit type=submit value="'+uW.g_js_strings.modal_alliance.allilist+'" /></td>\
            <TD class=xtab><INPUT align=right id=allGotoPage type=submit value="Page" />\
             <INPUT align=right id=idPageNum type="text" value='+t.curPage+' size=4 /><INPUT align=left id="idMyAllSubmit" type=submit value="'+ getMyAlliance()[1] +'"/><INPUT align=left id="idMyTHSubmit" type=submit value="TOP 100"/>\
             <span align=right <b>'+uW.g_js_strings.commonstr.estimatedtime+' : </b></span></td>\
	         <TD class=xtab ><div><select id="idFindETASelect">\
	             <option value="0" > -- -- </option>';
	                 var r=0;
				 	for (y in uW.unitcost) {
	  				r++
	             	    m+='<option value="'+r+'" >'+uW.unitcost[y][0]+'</option>';
				 }
        m+='</select></div></td></tr></table><span style="vertical-align:middle;" id=altInput></span></div><SPAN id=allListOut></span>';
      t.cont.innerHTML = m;
      ById('allSubmit').addEventListener ('click', t.eventSubmit, false);
      ById('playSubmit').addEventListener ('click', t.eventPlayerSubmit, false);
      ById('allAllName').addEventListener ('focus', function (){ById('ptallErr').innerHTML='';}, false);
      ById('idMyTHSubmit').addEventListener ('click', t.eventListTHSubmit, false);
      ById('allPlayName').addEventListener ('focus', function (){ById('ptplayErr').innerHTML='';}, false);
      ById('allListSubmit').addEventListener ('click', t.eventListSubmit, false);
      ById('allGotoPage').addEventListener ('click', t.gotoPage, false);
      ById('idMyAllSubmit').addEventListener ('click', t.showMyAlliance, false);
      ById('allGotoPage').disabled = true;
      ById('idFindETASelect').addEventListener ('click', t.handleEtaSelect, false);
      ById('idFindETASelect').disabled = true;
      ById('ffbuidsubmit').addEventListener ('click', t.eventPlayerUIDSubmit, false);
      t.ModelCity=Cities.cities[0];
      t.curPage = 0;
      t.MaxPage = -1;
      t.state = 1;
    }
  },
 eventPlayerUIDSubmit : function (){
    var t = Tabs.AllianceList;
    document.getElementById('ptplayErr').innerHTML='';
    var uid = document.getElementById('allPlayName').value;

	var params = uW.Object.clone(uW.g_ajaxparams);
    params.uid = uid;
    AjaxRequest(uW.g_ajaxpath + "ajax/getUserGeneralInfo.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (transport) {
      var rslt = eval("(" + transport.responseText + ")");
 	  if (rslt.ok) {

		       document.getElementById('altInput').innerHTML = '';
		       document.getElementById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'</center>';
               t.eventGotPlayerList(rslt);
      }
	  else document.getElementById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.barbarian.erroroccured+'</center>';
      },
      onFailure: function (rslt) {
           document.getElementById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.errorcode.err_602+'</center>';
		   return;
      },
    });

  },
  pName : '',
  eventPlayerSubmit : function (){
    var t = Tabs.AllianceList;
    ById('ptplayErr').innerHTML='';
    var name = ById('allPlayName').value;
     name = name.replace(/\'/g,"_");
    t.pName = name;
    if (name.length < 3){
      ById('ptplayErr').innerHTML = uW.g_js_strings.getAllianceSearchResults.entryatleast3;
      return;
    }
    ById('altInput').innerHTML = '';
     ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'</center>';
    t.fetchPlayerList (name, t.eventGotPlayerList);
  },
  eventGetLienMember: function(name) {
    var t = Tabs.AllianceList;
    ById('allPlayName').value = name;
    t.eventPlayerSubmit();
  },
  eventGotPlayerList : function (rslt){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      ById('allListOut').innerHTML = rslt.errorMsg;
      return;
    }
    var uList = [];
    if (rslt.matchedUsers) {
    t.playerList = rslt.matchedUsers;

    for (k in rslt.matchedUsers)
          uList.push (rslt.matchedUsers[k].userId);
    }else{
		t.playerList = rslt.userInfo;
		t.pName = rslt.userInfo[0].name;
		uList.push(rslt.userInfo[0].userId);
	}
      t.fetchPlayerStatus (uList, function(r) {t.eventGotPlayerOnlineList(r)});

      },

    eventGotPlayerOnlineList : function (rslt){
        var t = Tabs.AllianceList;
        if (!rslt.ok){
          ById('allListOut').innerHTML = rslt.errorMsg;
          return;
    }
    var m = '<DIV class=boStat>'+uW.g_js_strings.recommendSelectedFriends.playersrch+' : <b>"'+ t.pName +'"</b></div>\
      <DIV style="height:575px; max-height:575px; overflow-y:auto">\
      <TABLE width=95% align=center class=ptTab cellspacing=0><TR style="font-weight:bold"><TD width=20%>'+uW.g_js_strings.commonstr.nametx+'</td>\
      <TD align=right>'+uW.g_js_strings.commonstr.might+' &nbsp;&nbsp;&nbsp;&nbsp;</td><td>KOCMon<TD> &nbsp;'+uW.g_js_strings.commonstr.online+'</td><TD width=60%>'+lang.AllianceList.info+'</td></tr>';
    var row=0;
    var cl='';
    for (k in t.playerList){
      var u = t.playerList[k];
      if (u.genderAndName) {
       if (++row % 2)
        cl = 'class=ptOddrow ';
       else
        cl = '';
        if (u.allianceName) { var alliancenammme=u.allianceName; }else {var alliancenammme="---"; }
        m += '<TR '+ cl +'valign=top><TD><A onclick=\'boshowthrone('+u.userId +',"'+ u.name+'","Calc");\' href="javascript:void(0);">'+ u.genderAndName +'</a><br>'+alliancenammme+'<br>'
        if (u.fbuid) m += '<A target="_tab" href="http://www.facebook.com/profile.php?id='+ u.fbuid +'">profil</a>';
        m += '</td><TD align=center>&nbsp;'+ addCommasInt(u.might) +'&nbsp;</td><td><a target=_blank href="http://kocmon.com/'+ getServerId() +'/players/'+ u.userId +'">KOCmon</a></td>\
          <TD>'+ (rslt.data[u.userId]?"&nbsp;<SPAN class=boldDarkRed>"+uW.g_js_strings.commonstr.online+"</span>":"") +'</td>\
         <TD><SPAN onclick="BoPTpd(this, '+ u.userId +')"><A>'+uW.g_js_strings.modaltitles.memberdetails+'</a> &nbsp; <BR></span><span onclick="BoPTpl2(this,'+ u.userId+','+rslt.data[u.userId]+')"><A>'+uW.g_js_strings.modaltitles.leaderboard+'</a></span>&nbsp;<br><SPAN onclick="BoPCplo(this, \''+ u.userId +'\')"><A>'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+'</a></span></td></tr>';
     }
    }
    m += '</table></div>';
    ById('allListOut').innerHTML = m;
  },

  clickedPlayerDetail : function (span, uid){
    var t = Tabs.AllianceList;
    span.onclick = '';
    span.innerHTML = uW.g_js_strings.commonstr.search +': '+ uW.g_js_strings.modaltitles.memberdetails + " ...";
    t.fetchPlayerInfo (uid, function (r) {t.gotPlayerDetail(r, span)});
  },

  clickedPlayerLeaderboard : function (span, uid){
    var t = Tabs.AllianceList;
    span.onclick = '';
    span.innerHTML = uW.g_js_strings.commonstr.search +': '+ uW.g_js_strings.modaltitles.leaderboard + " ...";
    t.fetchLeaderboard (uid, function (r) {t.gotPlayerLeaderboard(r, span)});
  },
  clickedPlayerLeaderboard2 : function (span, uid,status){
      var t = Tabs.AllianceList;
    span.onclick = '';
    span.innerHTML = uW.g_js_strings.commonstr.search +': '+ uW.g_js_strings.modaltitles.leaderboard + " ...";
    t.fetchLeaderboard (uid, function (r) {t.gotPlayerLeaderboard2(r, span,uid,status)});
  },

   clickedPlayerGetLastLogin : function (span, uid){
      var t = Tabs.AllianceList;
      span.onclick = '';
      span.innerHTML = uW.g_js_strings.commonstr.search +': '+ uW.g_js_strings.modal_messages_viewreports_view.lastlogin + " ...";
      t.fetchPlayerLastLogin (uid, function (r) {t.gotPlayerLastLogin(r, span)});
    },
   gotPlayerLeaderboard2 : function (rslt,span,uid,status){
      var t = Tabs.AllianceList;
      if (!rslt.ok){
        span.innerHTML = rslt.errorMsg;
        return;
      }
      if (rslt.totalResults == 0){
        span.innerHTML = '<B>'+uW.g_js_strings.commonstr.leaderboard+': </b>'+uW.itemlist.i10021.name+'?<BR>';
        return;
      }
      var myA = getMyAlliance ();
      t.dat = [];
      var p = rslt.results[0];
          if ( myA[0] == p.allianceId)
             t.friendEta = true;
          else
             t.friendEta = false;
          for (var c=0; c<p.cities.length; c++){
                   t.dat.push ([p.displayName, parseInt(p.might), p.officerType, parseInt(p.numCities), parseInt(p.cities[c].tileLevel),
		                parseInt(p.cities[c].xCoord), parseInt(p.cities[c].yCoord), p.cities[c].cityName, 0, c, p.userId, p.avatarId, p.playerSex, p.rank, status, 'NA']);

          }
          t.setDistances (Cities.cities[0].x, Cities.cities[0].y);
          t.ModelCity=Cities.cities[0];
          t.setEta();
          t.fetchPlayerLastLogin (uid, function (r) {t.displayPlayer(p.allianceName,r)});
  },
  gotPlayerLeaderboard : function (rslt, span){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      span.innerHTML = rslt.errorMsg;
      return;
    }
    if (rslt.totalResults == 0){
      span.innerHTML =  '<B>'+uW.g_js_strings.commonstr.leaderboard+': </b>'+uW.itemlist.i10021.name+'?<BR>';
      return;
    }
    var p = rslt.results[0];
    var an = p.allianceName;
    if (!an || an=='' || p.officerType==4)
      an = 'Aucune';
    else
      an += ' ('+ officerId2String(p.officerType) +')';
    m = '<TABLE cellspacing=0 class=ptTab><TR><TD><B>'+uW.g_js_strings.commonstr.leaderboard+' : </b></td><TD colspan=2> '+uW.g_js_strings.commonstr.might+' : '+ p.might  +' &nbsp; '+uW.g_js_strings.commonstr.alliance+' : '+ an +'</td></tr>';
    for (var i=0; i<p.cities.length; i++){
      var c = p.cities[i];
      var created = '';
      if (c.dateCreated && c.dateCreated.substr(0,2)=='20')
        created = ' &nbsp; &nbsp; '+lang.AllianceList.add+' ' + c.dateCreated.substr(0,10);
      m += '<TR><TD align=right><B>'+uW.g_js_strings.commonstr.city+' #'+ (i+1) +':</b></td><TD> &nbsp; '+ c.cityName
        + '&nbsp;<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ c.xCoord +',' +c.yCoord+ ')</a>'
        + '</td><TD width=75%> &nbsp; '+uW.g_js_strings.commonstr.level+' : '
        + c.tileLevel +' &nbsp; &nbsp; '+uW.g_js_strings.commonstr.status+': '+ cityStatusString (c.cityStatus) + created +'</td></tr>';
    }
    span.innerHTML = m + '</table>';
  },
 displayPlayer : function (allName,rslt){
   var t = Tabs.AllianceList;
    function alClickSort (e){
      var t = Tabs.AllianceList;
      var newColNum = e.id.substr(8);
      ById('clickCol'+t.sortColNum).className = 'clickable';
      e.className='clickable clickableSel';
      if (newColNum == t.sortColNum)
        t.sortDir *= -1;
      else
        t.sortColNum = newColNum;
      t.reDisp();
    }
    uW.PTalClickSort = alClickSort;
    var m = '<STYLE>.clickable{background-color:#ddd; border:2px outset; border-color:#555; padding-left:5px; padding-right:5px}\
            .clickableSel{background-color:#ffffcc;}\
            .xxtab{background-color:none; padding-right:5px;} </style>\
            <DIV class=boStat ><TABLE id=tabAllMembers cellpadding=0  width=100%><TR font-weight:bold"><TD class=xtab>'+uW.g_js_strings.commonstr.alliance+': '+ allName +'</td>\
              <TD class=xtab width=80% align=center>'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+' : <SPAN id=lastlogin>'+  rslt.playerInfo.lastLogin+'</span></td><TD class=xtab align=right></td></tr></table></div>\
      <div style="max-height:470px; height:470px; overflow-y:auto;"><TABLE id=tabAllMembers align=center cellpadding=0 cellspacing=0><THEAD style="overflow-y:hidden;">\
      <TR style="font-weight:bold"><TD id=clickCol0 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.player+'</div></a></td>\
        <TD id=clickCol6 class=clickable align=center><DIV><INPUT id=ToggleScoutCheckbox type=checkbox unchecked=true></div></td>\
        <TD id=clickCol1 onclick="PTalClickSort(this)" class=clickable align=center><A><DIV>'+uW.g_js_strings.commonstr.rank+'</a></div></td>\
        <TD id=clickCol3 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.cities+'</a></div></td>\
        <TD id=clickCol2 onclick="PTalClickSort(this)" class=clickable align=center><A><DIV>'+uW.g_js_strings.commonstr.alliance+'</a></div></td>\
        <TD id=clickCol9 onclick="PTalClickSort(this)" class=clickable align=center><A><DIV>'+uW.g_js_strings.commonstr.online+'</a></div></td>\
        <TD id=clickCol7 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.MapObject.cityname+'</a></div></td>\
        <TD id=clickCol4 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.lvl+'</a></div></td>\
        <TD id=clickCol16 onclick="PTalClickSort(this)" class=clickable><A><DIV>Prestige</a></div></td>\
        <TD id=clickCol5 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.coordinates+'</a></div></td>\
        <TD id=clickCol8 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.distance+'</a></div></td>\
        <TD id=clickCol10 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.attack_generateincoming.estimatedarrival+'</a></div></td>\
		<TD class=clickable><A><DIV>'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+'</a></div></td></tr></thead>\
      <TBODY id=allBody style="background-color:#ffffff;"></tbody></table></div>\
      <DIV  width:100%; style="top:670px; left:0px; position:absolute; background-color:#ffffff; border-top:1px solid; margin-top:8px; color:#700; font-weight:bold;">';
    ById('allListOut').innerHTML = m;


    ById('altInput').innerHTML = '<HR><TABLE width=100% cellpaddding=0><TR align=center>\
        <TD class=xtab>'+uW.g_js_strings.commonstr.distance + ' ' + uW.g_js_strings.commonstr.from+' : &nbsp; X: <INPUT size=2 type=text id=plyrX /> Y: <INPUT size=2 type=text id=plyrY /> &nbsp; '+lang.AllianceList.orcity+' <span id=dmcoords></span></td></tr>\
        <TR><TD class=xtab><DIV id=PaintScout></div></td></tr></table><BR>Compare Throne Room : <INPUT id=CompareTR type=submit class=button value="Compare"><INPUT id=CalcTR type=submit class=button value="Calculate"><BR>';
    ById('clickCol'+t.sortColNum).className = 'clickable clickableSel';
    ById('ToggleScoutCheckbox').addEventListener ('change', t.doSelectall,false);
    t.reDisp();
    new CdispCityPicker ('plyrdcp', document.getElementById ('dmcoords'), true, t.eventCoords, 0).bindToXYboxes(ById('plyrX'), ById('plyrY'));
    ById('idFindETASelect').disabled = false;
    ById('CompareTR').addEventListener ('click', function (){Tabs.Marches.showthrone(rslt.playerInfo.userId,rslt.playerInfo.displayName,"Compare")},false);
    ById('CalcTR').addEventListener ('click', function (){Tabs.Marches.showthrone(rslt.playerInfo.userId,rslt.playerInfo.displayName,"Calc")},false);
  },

  gotPlayerLastLogin : function (rslt, span){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      span.innerHTML = rslt.errorMsg;
      return;
    }

    var p = rslt.playerInfo;
    var lastLogin = rslt.playerInfo.lastLogin;

    if (lastLogin) {
      m = '<span style="color:blue">'+lastLogin+'</span>';
    } else {
       m = '<span style="color:red">-</span>';
    }
     var fogExpireTimestamp = rslt.playerInfo.fogExpireTimestamp;
    if (fogExpireTimestamp != "0000-00-00 00:00:00") {
			  m += '<br><span style="color:black">Brume : '+fogExpireTimestamp+'</span>';
     }
    span.innerHTML = m + '';
  },
  gotPlayerDetail : function (rslt, span){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      span.innerHTML = rslt.errorMsg;
      return;
    }
    var u = rslt.userInfo[0];
    var a = 'Aucune';
    if (u.allianceName)
      a = u.allianceName +' ('+ getDiplomacy(u.allianceId) + ')';
    var m = '<TABLE cellspacing=0 class=ptTab><TR><TD><B>Details :</b> &nbsp; </td><TD>'+uW.g_js_strings.commonstr.alliance+' : '+ a +' &nbsp; '+uW.g_js_strings.commonstr.cities+' : '
          + u.cities +' &nbsp; '+uW.g_js_strings.commonstr.population+' : '+ u.population +'</td></tr><TR><TD></td><TD>'+uW.g_js_strings.commonstr.province+' : ';
    var pids = u.provinceIds.split (',');
    var p = [];
    for (var i=0; i<pids.length; i++)
      p.push(uW.provincenames['p'+pids[i]]);
    span.innerHTML = m + p.join (', ') +'</td></tr></table>';
  },

  aName : '',
  eventSubmit : function (){
    var t = Tabs.AllianceList;
    ById('ptallErr').innerHTML='';
    t.aName = ById('allAllName').value;
    if (t.aName.length < 3){
      ById('ptallErr').innerHTML = uW.g_js_strings.getAllianceSearchResults.entryatleast3;
      return;
    }
    var myA = getMyAlliance ();
    ById('altInput').innerHTML = '';
    ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
    if (myA[0]!=0 && myA[1].toLowerCase().indexOf(t.aName.toLowerCase())>=0 )
      t.fetchAllianceList (t.aName, myA[0], t.eventGotAllianceList);
    else
      t.fetchAllianceList (t.aName, null, t.eventGotAllianceList);
  },
  eventListSubmit : function (){
    var t = Tabs.AllianceList;
    var myA = getMyAlliance ();
    ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
    if (myA[0]!=0  ) {
       t.curPage=1;
       t.fetchOtherAllianceInfo ( 1, t.eventGotOtherAlliancePage);
       ById('allGotoPage').disabled = false;
    }
    else {
       ById('allListOut').innerHTML =  uW.g_js_strings.membersInfo.youmustbelong;
    }
  },
  eventListTHSubmit : function (){
      var t = Tabs.AllianceList;
      ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
      t.fetchUserLeaderboard (1, t.eventGetUserLeaderboard);
  },
  eventGotAllianceList : function (rslt){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      ById('allListOut').innerHTML = rslt.errorMsg;
      return;
    }
    var m = '<DIV class=boStat>'+uW.g_js_strings.commonstr.alliances+' <B>"'+ t.aName +'"</b></div>\
    <TABLE><TR style="font-weight:bold"><TD class=xtab>'+uW.g_js_strings.commonstr.alliance+'</td><TD class=xtab>'+uW.g_js_strings.commonstr.rank+'</td><TD class=xtab>'+uW.g_js_strings.commonstr.members+'</td>\
        <TD align=right class=xtab>'+uW.g_js_strings.commonstr.might+'</td><TD class=xtab>'+uW.g_js_strings.getAllianceSearchResults.currdiplo+'</td><TD class=xtab>'+uW.g_js_strings.commonstr.members+'</td><TD class=xtab>'+uW.g_js_strings.commonstr.viewmap+'</td></tr>';
    for (k in rslt.alliancesMatched){
      var all = rslt.alliancesMatched[k];
      var dip = '';
      if (all.relation && all.relation==1)
        dip = 'Amicale';
      else if (all.relation && all.relation==2)
        dip = 'Hostile';
      m += '<TR  class="'+ dip + '"><TD class=xtab>'+ all.allianceName +'</td><TD align=right class=xtab>'+ all.ranking +'</td><TD align=right class=xtab>'+ all.membersCount +'</td>\
       <TD align=right class=xtab>'+ addCommasInt(all.might) +'</td><TD class=xtab>'+ dip +'</td>\
       <TD class=xtab><a onclick="BoPTgetMembers('+ all.allianceId +')">'+uW.g_js_strings.commonstr.members+'</a></td>\
       <TD class=xtab><a onclick="PTPaintMembers('+ all.allianceId +')">'+uW.g_js_strings.commonstr.viewmap+'</a></td></tr>';
    }
    ById('allListOut').innerHTML = m;
  },
  GetDataForMap : function (allianceId) {
    var t = Tabs.AllianceList;
    var params = uW.Object.clone(uW.g_ajaxparams);
    var Data=[];
    params.perPage = 100;
    params.page = 1;params.type="might";
    params.allianceId = allianceId;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/getUserLeaderboard.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
      	var city = '';
      	for (var i=0; i<rslt.results.length; i++) {
      	    if (rslt.results[i]['userId'] !=0){
	      	    player = rslt.results[i]['cities'];
	      	    for (var ii=0; ii<player.length; ii++)
	      			Data.push ({X:player[ii]['xCoord'],Y:player[ii]['yCoord']});
	    	}
        }
        if (Data != []) t.PaintDataOnMap(Data);
      },
      onFailure: function (rslt) {
        notify ({errorMsg:'AJAX error'});
      },
    });
  },
  PaintDataOnMap : function(Data){
  		var provMapCoordsA = {imgWidth:710, imgHeight:708, mapWidth:670, mapHeight:670, leftMargin:31, topMargin:19};
  		var map = '<div style="overflow:auto; height:'+(Options.HauteurBoite-150)+'px;max-height:'+(Options.HauteurBoite-150)+'px;"><DIV id=ptAlliProvMap style="height:'+ provMapCoordsA.imgHeight +'px; width:'+ provMapCoordsA.imgWidth +'px; background-repeat:no-repeat; background-image:url(\''+ URL_PROVINCE_MAP +'\')"></div></div>';
		ById('allListOut').innerHTML = map;
		var eMap =  ById('ptAlliProvMap');
		for (var cc=0; cc<Seed.cities.length; cc++) {
		    var city = Seed.cities;
		    var Xplot = parseInt((provMapCoordsA.mapWidth * parseInt(city[cc][2])) / 750);
		    var Yplot = parseInt((provMapCoordsA.mapHeight * parseInt(city[cc][3])) / 750);
		    var cf = document.createElement ('div');
		    cf.style.background = 'black';
		    cf.style.opacity = '1.0';
		    cf.style.position='relative';
		    cf.style.display='block';
		    cf.style.width='14px';
		    cf.style.height='16px';
		    cf.style.border='1px solid #fff';
		    cf.style.color = 'white';
		    cf.style.textAlign = 'center';
		    cf.style.top = (Yplot+provMapCoordsA.topMargin-(cc*16)-8) +'px';
		    cf.style.left = (Xplot+provMapCoordsA.leftMargin-7) +'px';
		    cf.innerHTML = (cc+1) +'';
		    eMap.appendChild(cf);

		}
		for (var i=0;i<Data.length;i++) {
			var x = parseInt(Data[i]['X']);
			var y = parseInt(Data[i]['Y']);
  	        var xplot = parseInt((provMapCoordsA.mapWidth * x) / 750);
  	        var yplot = parseInt((provMapCoordsA.mapHeight * y) / 750);
  	    	var ce= document.createElement ('div');
  	    		ce.style.background = 'red';
  	    		ce.style.opacity = '1.0';
  	    		ce.style.position='relative';
  	    		ce.style.display='block';
  	    		ce.style.width='4px';
  	    		ce.style.height='4px';
  	    		ce.style.color = 'white';
  	    		ce.style.textAlign = 'center';
  	    	ce.style.top = (yplot+provMapCoordsA.topMargin -(4*i)-((Seed.cities.length)*18)) +'px';
  	    	ce.style.left = (xplot+provMapCoordsA.leftMargin -2) +'px';
  	    	ce.innerHTML = '<DIV onclick="ptGotoMap('+ x +','+ y +')">&nbsp;</div>';
  	        eMap.appendChild(ce);
  	   }
  },
 showMyAlliance : function (){
    var t = Tabs.AllianceList;
    var myA = getMyAlliance ();
    ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
    if (myA[0]!=0  ) {
       t.eventGetMembers(myA[0]);
    }
    else {
       ById('allListOut').innerHTML =  uW.g_js_strings.membersInfo.youmustbelong;
    }
  },
 curPage : 0,
  MaxPage : 0,

  eventListNext : function (amt){
    var t = Tabs.AllianceList;
    if( parseInt(amt) >= 9999 )
       t.curPage = t.MaxPage;
    else {
	    t.curPage = parseInt(t.curPage) + parseInt(amt);
	    if ( t.curPage > t.MaxPage) {
	      t.curPage = t.MaxPage;
	    }
    }
    ById('allListOut').innerHTML = '<BR><BR><CENTER> ...</center>';
    t.fetchOtherAllianceInfo (t.curPage, t.eventGotOtherAlliancePage);
  },

  eventListPrev : function (amt){
    var t = Tabs.AllianceList;
    if(amt <= -1)
       t.curPage = 1;
    else {
	    t.curPage-=amt;
	    if ( t.curPage < 1 ) {
	      t.curPage = 1;
	    }
    }
    ById('allListOut').innerHTML = '<BR><BR><CENTER> ...</center>';
    t.fetchOtherAllianceInfo (t.curPage, t.eventGotOtherAlliancePage);
  },

  gotoPage : function (){
    var t = Tabs.AllianceList;
    var val = ById('idPageNum').value;
    if (t.MaxPage < 0 ) {
      ById('allListOut').innerHTML = 'List Alliances first.';
      return;
    }
    if (t.MaxPage < 0 || val > t.MaxPage || val < 1) {
      ById('allListOut').innerHTML = 'Page number out of range';
      return;
    }
    t.curPage = val;
    ById('allListOut').innerHTML = '<BR><BR><CENTER> ...</center>';
    t.fetchOtherAllianceInfo (t.curPage, t.eventGotOtherAlliancePage);
  },

  eventGetUserLeaderboard: function(rslt) {
   var t = Tabs.AllianceList;
      if (!rslt.ok){
        ById('allListOut').innerHTML = rslt.errorMsg;
        return;
    }
    var m = '<div style="overflow:auto; height:'+(Options.HauteurBoite-155)+'px;max-height:'+(Options.HauteurBoite-155)+'px;"><TABLE width="100%"><thead><TR style="font-weight:bold"> \
          <th class=xtab>'+uW.g_js_strings.commonstr.ranking+'</th><th class=xtab>'+uW.g_js_strings.commonstr.nametx+'</th><th>Avatar</th><th class=xtab>'+uW.g_js_strings.commonstr.might+'</th>\
          <th class=xtab>'+uW.g_js_strings.commonstr.alliance+'</th><th class=xtab>'+uW.g_js_strings.commonstr.rank+'</th><th class=xtab>'+uW.g_js_strings.commonstr.cities+'</th></tr></thead><tbody>';
    ById('allListOut').innerHTML = m;
    for (var i=0; i<rslt.results.length; i++) {
     var resultat = rslt.results[i];

     m += '<TR class=xtab><TD class=xtab align=center><b>' + resultat.rank +'</b></td><td class=xtab><a onclick=BoPTDme("' + resultat.displayName +'");>';
     if (resultat.playerSex) m+='<img src="'+gameurl+'img/avatars/v2/25/' + resultat.playerSex.toLowerCase() + '' + resultat.avatarId + '.png"></a>'
     m+='</td>\
     		<TD class=xtab>' + resultat.displayName +'</td>\
     		<td class=xtab>' + resultat.might + '</td>\
     		<td class=xtab><a onclick="BoPTgetMembers('+ resultat.allianceId +')">' + resultat.allianceName + '</a></td>\
     		<td class=xtab>' + officerId2String(resultat.officerType) + '</td><td class=xtab>' + resultat.numCities + '</td>\
     		</tr>';
     m += '</div>';
     ById('allListOut').innerHTML = m;
    }
  },
  fetchUserLeaderboard: function(pagNum, notify) {
        var t = Tabs.AllianceList;
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.page = pagNum;params.type="might";params.page=1;
        params.perPage = 100;
        new MyAjaxRequest(uW.g_ajaxpath + "ajax/getUserLeaderboard.php" + uW.g_ajaxsuffix, {
          method: "post",
          parameters: params,
          onSuccess: function (rslt) {
            notify (rslt);
          },
          onFailure: function (rslt) {
            notify (rslt);
          },
      });
  },


  eventGotOtherAlliancePage : function (rslt){
    var t = Tabs.AllianceList;
    if (!rslt.ok){
      ById('allListOut').innerHTML = rslt.errorMsg;
      return;
    }

    ById('idPageNum').value = t.curPage;

    t.MaxPage=rslt.noOfPages;

    var m = '<div style="overflow:auto; height:'+(Options.HauteurBoite-230)+'px;width:95%;"><TABLE><thead><TR style="font-weight:bold"> \
   <th class=xtab>'+uW.g_js_strings.commonstr.rank+'</th><th class=xtab>'+uW.g_js_strings.modaltitles.alliance+'</th><th class=xtab>'+uW.g_js_strings.commonstr.chancellor+'</th><th class=xtab>'+uW.g_js_strings.commonstr.members+'</th>\
        <th align=right class=xtab>'+uW.g_js_strings.commonstr.might+'</th><th align=right class=xtab>'+uW.g_js_strings.commonstr.glory+'</th><th class=xtab>'+uW.g_js_strings.getAllianceSearchResults.currdiplo.substr(0,10)+'</th><th class=xtab>'+uW.g_js_strings.commonstr.members+'</th><th class=xtab>'+uW.g_js_strings.commonstr.viewmap+'</th></tr></thead><tbody>';
    ById('allListOut').innerHTML = m;

    for (var i=0; i<rslt.otherAlliances.length; i++) {
      var alliance = rslt.otherAlliances[i];
      var dip = '';
      dip = getDiplomacy(alliance.allianceId);

      m += '<TR class="'+ dip + '"><TD align=right class=xtab>'+ alliance.ranking +'</td><TD class=xtab>' + alliance.name +'</td><TD class=xtab>' + alliance.hostGenderAndName +'</td><TD align=right class=xtab>'+ alliance.membersCount +'</td>\
       <TD align=right class=xtab>'+ addCommasInt(alliance.might) +'</td><TD align=right class=xtab>'+ addCommasInt(alliance.glory) +'</td><TD class=xtab>'+ dip +'</td>\
       <TD class=xtab><a onclick="BoPTgetMembers('+ alliance.allianceId +')">'+uW.g_js_strings.commonstr.members+'</a></td>\
       <TD class=xtab><a onclick="PTPaintMembers('+ alliance.allianceId +')">'+uW.g_js_strings.commonstr.viewmap+'</a></td></tr>';
    }
    m += '</tbody></TABLE><div style="font-weight:bold; height:20px;width:95%;text-align:center;"><span><center><a onclick="BoPTalClickPrev(-1)"> ['+uW.g_js_strings.commonstr.first+'] </a><a onclick="BoPTalClickPrev(10)"> [-10] </a><a onclick="BoPTalClickPrev(5)"> [-5] </a><a onclick="BoPTalClickPrev(1)"> ['+uW.g_js_strings.commonstr.previous+'] </a> \
          <a onclick="BoPTalClickNext(1)"> ['+uW.g_js_strings.commonstr.next+'] </a><a onclick="BoPTalClickNext(5)"> [+5] </a><a onclick="BoPTalClickNext(10)"> [+10] </a><a onclick="BoPTalClickNext(9999)"> [End] </a> </span></div>';
    m += '</div>';
    ById('allListOut').innerHTML = m;
 },

  showCurrentPage : function (){
    var t = Tabs.AllianceList;
    var myA = getMyAlliance ();

    ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
    if (myA[0]!=0  ) {
       t.fetchOtherAllianceInfo ( t.curPage, t.eventGotOtherAlliancePage);
    }
    else {
       t.fetchOtherAllianceInfo ( t.curPage, t.eventGotOtherAlliancePage);
    }

  },


  eventGotMemberList : function (rslt){
     var t = Tabs.AllianceList;
     if (!rslt.ok){
       ById('allListOut').innerHTML = rslt.msg;
       return;
     }
     t.memberListRslt = rslt;
     var uList = [];
     for (k in rslt.results)
       uList.push (rslt.results[k].userId);
     t.fetchPlayerStatus (uList, function(r){t.eventGotMemberOnlineList(r)});
   },

  eventGotMemberOnlineList : function (rslt){
    var t = Tabs.AllianceList;
    var numInvalid = 0;
    var numPlayers = 0;
    var myA = getMyAlliance ();
    t.dat = [];
    for (var i=0; i<t.memberListRslt.results.length; i++){
      p = t.memberListRslt.results[i];
      if (p.userId == 0){
        ++numInvalid;
      } else {
        ++numPlayers;
        if ( myA[0] == p.allianceId)
          t.friendEta = true;
	        else
           t.friendEta = false;
        for (var c=0; c<p.cities.length; c++){
           t.dat.push ([p.displayName, parseInt(p.might), p.officerType, parseInt(p.numCities), parseInt(p.cities[c].tileLevel),
               parseInt(p.cities[c].xCoord), parseInt(p.cities[c].yCoord), p.cities[c].cityName, 0, c, p.userId, p.avatarId, p.playerSex, p.rank, rslt.data[p.userId]?1:0, 'NA', p.cities[c].prestigeType,p.cities[c].prestigeLevel,p.cities[c].blessing,p.cities[c].tileProvinceId]);
        }
      }
    }
    t.setDistances (Cities.cities[0].x, Cities.cities[0].y);
    t.ModelCity=Cities.cities[0];
    t.setEta();
    t.displayMembers (t.memberListRslt.allianceName, numPlayers);
  },
  reDisp : function (){
    var t = Tabs.AllianceList;
    function sortFunc (a, b){
          var t = Tabs.AllianceList;
     if (typeof(a[t.sortColNum]) == 'number'){
             if (t.sortDir > 0)
               return a[t.sortColNum] - b[t.sortColNum];
             else
               return b[t.sortColNum] - a[t.sortColNum];
           } else if (typeof(a[t.sortColNum]) == 'boolean'){

     	return 0;
           } else {
             if (t.sortDir > 0)
               return a[t.sortColNum].localeCompare(b[t.sortColNum]);
             else
               return b[t.sortColNum].localeCompare(a[t.sortColNum]);
      }
    }
    t.dat.sort (sortFunc);
    var m = '';
    var tbody = ById('allBody');
    if (tbody)tbody.innerHTML ='';
    if (tbody)tbody.style.maxHeight = '';
    var csvXL="";
    var cityName= "";
    for (var i=0; i<t.dat.length; i++){
    	if (i % 2 == 0) {
        		 tabclass = 'xxtab';
        	} else {
        		tabclass = 'xxtab_even';
    	}
    	var Prestige="Normal";
    	 cityName = t.dat[i][5].toString() + t.dat[i][6].toString();
    	if (t.dat[i][16]==1) Prestige="Druid " + t.dat[i][17];
    	if (t.dat[i][16]==2) Prestige="Fey " + t.dat[i][17];
    	if (t.dat[i][16]==3) Prestige="Briton " + t.dat[i][17];
    	var status = '<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAWJJREFUeNrUU79PwkAUvv5IG6iAg8HEMIlxNLBCNxkkYah/gP6NmAChiYQUupjA4uCicbKJBQ0E24OWtvjdgCHGdmHyJV/efffuvrx37x232WzIPsaTPW1vAXGXaJpGRFGUOY67AD0FMsAX8IpSH4Mg8JrNZrwATI6i6KrRaGjVarWWTqePXde1TdO873Q67GYX8GIFwjAs1ev160qlckMp5QG2XQC/Xa1WnK7r7+APsQLr9fq8XC7XbNvmWXd832d7BFnxxWKxhnUvUQAXcqg/7zgOcRyKjIKfmCRJeRZPfETP89zJ5HO6XIYngiAThq1R6k5ZPLGNOPBsGMYglcpEsqyQLSRJicbj8YDFEzOwLGvUat21KfVFVb1Us9nc0WIx/xgOe2a/323PZrPRbwFud5RRvyQIwpmiKCX4AvgB4g6684Z2PsG/MJ4kIMAdsnn4Y+jYi85x3o8V+J+f6VuAAQDR57f+eJX9fgAAAABJRU5ErkJggg=="/>';
		if (t.dat[i][14]) status = '<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAVNJREFUeNrUk09OwkAUh9+gUKpAFIuIfxJilLIlMd6gaw+Ax/AY7r2AnMFFb2DcC5gYYlBotYKttEwp83zjQtFIN6x8yZfJ9PfypZM3wxARFqkELFgLC5ZnN+yyQF9YjrR12hpEiegRJghoQIQunj7PF1DlQOB5dadi6Nt6cSWlKiPu8+ZTq9bu3tUoPyPc+UcQWK9sHRh6oVIOXF91XpzE2AtUXTss72tlQ+axR4AQjb313aJlWSCEAM75J3JS2dVMUebUdREjECWcojLwBiCZRJOvKB2mFZnH/wEXvb7b5zbaKmR+No6jMZd5/Bg5mt3HByupJQE24Js8gD/0LJnHC0zecNuO6d06HcGmAWRBTCEK/NZbh9+PTJn/FrDZq8wYS0GeVeE4cQIldkT6TZq/DT28gWtxBa/YpP73OMESLWuE8seli4gh9YdzBf/zMX0IMACs96WetcYlTQAAAABJRU5ErkJggg=="/>';

        m += '<TR><TD  class='+ tabclass +' style="padding-left:0px";><a onclick=BoPTDme("' +  t.dat[i][0] +'");><img src="'+gameurl+'img/avatars/v2/25/'+t.dat[i][12].toLowerCase()+''+t.dat[i][11]+'.png" align=absmiddle></a>&nbsp;<a onclick=getInfoForAnUser("'+ t.dat[i][10] +'");>'+ t.dat[i][0] +'</a></td>\
        <TD class=xxtab><INPUT id=ScoutCheckbox_'+cityName+' type=checkbox unchecked=true></td>\
        <TD class='+ tabclass +' style="padding-left:0px";>'+ addCommasInt(t.dat[i][1]) +'</td><TD class='+ tabclass +' style="padding-left:0px";>'+ t.dat[i][3] +'</td>\
	                <TD class='+ tabclass +' style="padding-left:0px";><span title="Classement : '+t.dat[i][13]+' joueur">'+ officerId2String(t.dat[i][2])  +'</span></td><TD class='+ tabclass +' style="padding-left:0px";>'+ status +'</td><TD class='+ tabclass +' style="padding-left:0px";><span title="'+ t.dat[i][7]+'">'+ t.dat[i][7].substring(0,8) +'</span></td><TD class='+ tabclass +' style="padding-left:0px";>'+ t.dat[i][4] +'</td>\
	                <TD class='+ tabclass +' style="padding-left:0px";>'+Prestige+'</td><TD  class='+ tabclass +' style="padding-left:0px";>\
	                <a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ t.dat[i][5] +','+ t.dat[i][6] +')</a>\
	                <bR>'+uW.provincenames['p'+ t.dat[i][19]]+'</td><TD  class=xxtab style="padding-left:0px";>'+ t.dat[i][8].toFixed(2) +'</td>';
      	m += '<TD nowrap class=xxtab  style="padding-left:0px";>'+ (t.dat[i][15]?'<SPAN>'+ (t.dat[i][15]>0?timestr(t.dat[i][15],1):'NA') +'</span>':'<SPAN>NA</span>') +'</td><td class='+ tabclass +'  style="padding-left:0px";><SPAN onclick="BoPCplo(this, \''+ t.dat[i][10] +'\');"><A>?</a></span><td></tr>';

	csvXL += t.dat[i][0]+';'+t.dat[i][1]+';'+t.dat[i][5]+';'+t.dat[i][6]+';'+t.dat[i][4]+';'+t.dat[i][8]+';'+t.dat[i][7]+'\n';
    }
    m += '<tr><td colspan=11><textarea cols="55" rows="12" onclick="this.focus();this.select();" id="cutAndPaste" name="csv">Joueur;'+uW.g_js_strings.commonstr.might+';X;Y;Niveau;Distance;Ville\n'+csvXL+'</textarea><br><b>Export XLS (pour toi public:</b><bR>Copiez le contenu de la zone, coller ensuite le contenu dans blocnote et enregistrer le fichier en .cvs</tr>';

   var tbody = ById('allBody');
    tbody.style.maxHeight = '';
    tbody.innerHTML = m;
    ById("cutAndPaste").innerHTML=csvXL;
    if (parseInt(tbody.clientHeight) > 475){
      tbody.style.height = '475px';
      tbody.style.maxHeight = '475px';
    }
  },
  setDistances : function (x, y){
    var t = Tabs.AllianceList;
    for (var i=0; i<t.dat.length; i++)
      t.dat[i][8] = distance (x, y, t.dat[i][5], t.dat[i][6]);
  },
  friendEta:false,
  setEta : function (){
    var t = Tabs.AllianceList;
    for (var i=0; i<t.dat.length; i++) {
      if (t.dat[i][8]) {
        if (ById('idFindETASelect').value>0) {
         var eta = estETA(parseFloat(t.dat[i][8]), ById('idFindETASelect').value, t.ModelCity.id,4);
         if (t.friendEta)
           t.dat[i][15] = eta.friendETA;
         else
           t.dat[i][15] = eta.ETA;
        }
      }
    }
  },
  handleEtaSelect : function (){
    var t = Tabs.AllianceList;
    t.setEta();
    t.reDisp();
  },
  sortColNum : 1,
  sortDir : 1,
  displayMembers : function (allName, numPlayers){
    var t = Tabs.AllianceList;
    function alClickSort (e){
      var t = Tabs.AllianceList;
      var newColNum = e.id.substr(8);
      ById('clickCol'+t.sortColNum).className = 'clickable';
      e.className='clickable clickableSel';
      if (newColNum == t.sortColNum)
        t.sortDir *= -1;
      else
        t.sortColNum = newColNum;
      t.reDisp();
    }
    uW.PTalClickSort = alClickSort;
    var m = '<STYLE>.clickable{background-color:#ddd; border:2px outset; border-color:#555; padding-left:5px; padding-right:5px;}\
            .clickableSel{background-color:#ffffcc;}\
            .xxtab{background-color:none; padding-left:5px; padding-right:5px;} </style>\
      <DIV class=boStat><TABLE id=tabAllMembers cellpadding=0  width=100%><TR font-weight:bold"><TD class=xtab> &nbsp; '+ allName +'</td>\
        <TD class=xtab width=80% align=center>'+uW.g_js_strings.commonstr.distance + ' ' + uW.g_js_strings.commonstr.from+' <SPAN id=distFrom>'+ Cities.cities[0].name +' ('+ Cities.cities[0].x +','+ Cities.cities[0].y +')</span></td><TD class=xtab align=right>'+ numPlayers +' joueurs trouv&eacute;s &nbsp; </td></tr></table></div>';
     m += '<div style="width:800px;max-height:'+(Options.HauteurBoite-200)+'px;height:'+(Options.HauteurBoite-200)+'px;overflow:auto;">\
      <TABLE id=tabAllMembers align=center cellpadding=0 cellspacing=0><THEAD>\
      <TR style="font-weight:bold"><TD id=clickCol0 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.player+'</div></a></td>\
      <TD id=clickCol6 class=clickable align=center><DIV><INPUT id=ToggleScoutCheckbox type=checkbox unchecked=true></div></td>\
        <TD id=clickCol1 onclick="PTalClickSort(this)" class=clickable align=center><A><DIV>'+uW.g_js_strings.commonstr.might+'</a></div></td>\
        <TD id=clickCol3 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.cities+'</a></div></td>\
        <TD id=clickCol2 onclick="PTalClickSort(this)" class=clickable align=center><A><DIV>'+uW.g_js_strings.commonstr.rank+'</a></div></td>\
        <TD id=clickCol14 onclick="PTalClickSort(this)" class=clickable align=center><A><DIV>'+uW.g_js_strings.commonstr.online+'</a></div></td>\
        <TD id=clickCol7 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.MapObject.cityname+'</a></div></td>\
        <TD id=clickCol4 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.lvl+'</a></div></td>\
        <TD id=clickCol16 onclick="PTalClickSort(this)" class=clickable><A><DIV>Prestige</a></div></td>\
        <TD id=clickCol5 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.coordinates+'</a></div></td>\
        <TD id=clickCol8 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.commonstr.distance+'</a></div></td>\
        <TD id=clickCol15 onclick="PTalClickSort(this)" class=clickable><A><DIV>'+uW.g_js_strings.attack_generateincoming.estimatedarrival+'</a></div></td>\
        <TD class=clickable><A><DIV>'+uW.g_js_strings.modal_messages_viewreports_view.lastlogin+'</div></a></td></tr></thead>\
      <tbody id=allBody ></tbody></table></div>';
    ById('allListOut').innerHTML = m;
    ById('altInput').innerHTML = '<HR><TABLE width=100% cellpaddding=0><TR align=center>\
        <TD class=xtab>'+uW.g_js_strings.commonstr.distance + ' ' + uW.g_js_strings.commonstr.from+' : &nbsp; X: <INPUT size=2 type=text id="plyrX" /> Y: <INPUT size=2 type=text id="plyrY" /> &nbsp; '+lang.AllianceList.orcity+' <span id=dmcoords></span></td></tr>\
        <TR><TD class=xtab><DIV id=PaintScout></div></td></tr></table>';
    ById('clickCol'+t.sortColNum).className = 'clickable clickableSel';
    t.reDisp();
    ById('ToggleScoutCheckbox').addEventListener ('change', t.doSelectall,false);
    new CdispCityPicker ('plyrdcp', document.getElementById ('dmcoords'), true, t.eventCoords, 0).bindToXYboxes(ById('plyrX'), ById('plyrY'));
    ById('idFindETASelect').disabled = false;

 },
   doSelectall : function (){
     var t = Tabs.AllianceList;
     var city = "";
     for (var k=0;k<t.dat.length;k++){
       city = t.dat[k][5].toString() + t.dat[k][6].toString();
       if (ById('ToggleScoutCheckbox').checked) ById('ScoutCheckbox_'+city).checked = true;
       else ById('ScoutCheckbox_'+city).checked = false
     }
  },
  doAddScout : function (){
    var t = Tabs.AllianceList;
    var count = -1;
    var city="";
    slots = March.RallyPoint(t.ScoutInfo.id).marching;
    rallypointlevel = March.RallyPoint(t.ScoutInfo.id).maxSlots;
    actionLog("Scout",slots + " _ " + rallypointlevel);
    for (var k=0;k<t.dat.length;k++){
		actionLog("Scout",t.dat[k][5] + " _ " + t.dat[k][6]);
      if (t.dat[k][5] != undefined && t.dat[k][6] != undefined){
        var x = t.dat[k][5];
        var y = t.dat[k][6];
        city = t.dat[k][5].toString() + t.dat[k][6].toString();
        var box = 'ScoutCheckbox_'+city;
        actionLog("Scout",t.dat[k][5] + " _ " + t.dat[k][6] + " : "  + ById(box).checked);
        if (document.getElementById(box).checked) count++;
        if (ById(box).checked && (count+1) <= (rallypointlevel-slots))
          setTimeout(t.doScout,2500*count, x,y,box);
      }
    }
  },
  MaxScouts : function (city){
  	    var t = Tabs.AllianceList;
  	    var othertroops=0;
  	    var max = 0;
  	    var maxsend = 0;
  	    t.getRallypoint("city" + city.id);
  	    RallypointMax = (t.rallypointlevel * 10000);
  	    maxsend = RallypointMax + ((RallypointMax / 100) * unsafeWindow.cm.ThroneController.effectBonus(66));
  	    for (i=1;i<=12;i++) othertroops += parseInt(ById('Unt'+3).value);
  	    if (othertroops < maxsend) max = (maxsend - othertroops);
  	    if (max > Seed.units["city" + city.id]["unt"+3]) max = Seed.units["city" + city.id]["unt"+3];
  	    ById('numScouts').value = max;
  	},
  doScout : function (x,y,box) {
    var t = Tabs.AllianceList;
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.cid= t.ScoutInfo.id;
      params.type = 3
      params.kid = 0
      params.xcoord = x;
      params.ycoord = y;
      params.u3 = ById('numScouts').value;
      params.gold = 0;
      params.r1 = 0;
      params.r2 = 0;
      params.r3 = 0;
      params.r4 = 0;
      params.r5 = 0;

    new MyAjaxRequest(uW.g_ajaxpath + "ajax/march.php" + unsafeWindow.g_ajaxsuffix, {
          method: "post",
          parameters: params,
          loading: true,
          onSuccess: function (rslt) {
              var t = Tabs.AllianceList;
              if (rslt.ok) {
                var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
                var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
                var ut = uW.unixtime();
                var unitsarr = [];
            	 for (j in uW.unitcost) unitsarr.push(0);
                for(i = 1; i <= unitsarr.length; i++){
                    if(params["u"+i]){
                      unitsarr[i] = params["u"+i];
                    }
                }
                var resources=new Array();
                resources[0] = params.gold;
                for(i=1; i<=4; i++){
                    resources[i] = params["r"+i];
                }
                var currentcityid =  params.cid;
                uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
                uW.update_seed(rslt.updateSeed)
                if(rslt.updateSeed){unsafeWindow.update_seed(rslt.updateSeed)};
                ById(box).checked = false;
               } else if (rslt.error_type==0 || rslt.error_type==8)
                 t.doScout(x,y,box);

          },
          onFailure: function () {},
    });
  },
 eventCoords : function (city, x, y){
    var t = Tabs.AllianceList;
    t.ScoutInfo = new Array;
	t.ScoutInfo = city;
	ById('PaintScout').innerHTML = uW.g_js_strings.commonstr.scout+' ' +uW.g_js_strings.commonstr.scout+ ' : ' + t.ScoutInfo.name + ' <INPUT id=numScouts type=text maxlength=7 size=7 value="1"><INPUT id=MaxScout type=submit class=button value=Max> #'+uW.g_js_strings.commonstr.scout+': <INPUT id=scoutAllSelected type=submit class=button value=GO>';
	ById('scoutAllSelected').addEventListener('click', function (){
		t.doAddScout();
	});
	ById('MaxScout').addEventListener('click', function (){t.MaxScouts(city);});
    var m = '';
    if (city != null)
      m = city.name +' ('+ city.x +','+ city.y +')';
    else
      m = x +','+ y;
    var distFrom = ById('distFrom');
    if (distFrom)
        distFrom.innerHTML = m;
    t.ModelCity=city;
    t.setDistances(x,y);
    t.setEta(x,y);
    t.reDisp();
  },

  eventGetMembers : function (aid){
    var t = Tabs.AllianceList;
    ById('allListOut').innerHTML = '<BR><BR><CENTER>'+uW.g_js_strings.commonstr.loadingddd+'...</center>';
    t.fetchAllianceMemberList (aid, null, t.eventGotMemberList);
  },

  fetchAllianceMemberList : function (allianceId, allianceName, notify) {
    var t = Tabs.AllianceList;
    var params = uW.Object.clone(uW.g_ajaxparams);
        params.page = 1;params.type="might";
    params.perPage = 100;
    if (allianceName)
      params.allianceName = allianceName;
    if (allianceId && allianceId != 0)
      params.allianceId = allianceId;
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getUserLeaderboard.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onFailure: function (rslt) {
        notify (rslt);
      },
    });
  },
  fetchLeaderboard : function (uid, notify) {
    var t = Tabs.AllianceList;
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.userId = uid;params.type="might"; params.page = 1;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/getUserLeaderboard.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onFailure: function (rslt) {
        notify (rslt);
      },
    });
  },
  fetchAllianceList : function (allianceName, myAid, notify) {
    var t = Tabs.AllianceList;
    function combineResults (rsltA, rsltM, notify){
      if (!rsltA.ok){
        if (rsltA.msg.indexOf("No alliance found under")!=0 || !rsltM.ok){
          notify (rsltA);
          return;
        }
        rsltA.ok = true;
        rsltA.count = 0;
        rsltA.alliancesMatched = {};
      }
      if (rsltM.ok){
        rsltA.alliancesMatched['a'+rsltM.allianceInfo.allianceId] = {allianceId: rsltM.allianceInfo.allianceId, allianceName: rsltM.allianceInfo.allianceName,
              membersCount: rsltM.allianceInfo.members, relation: null, might: rsltM.allianceInfo.might, ranking: rsltM.allianceInfo.ranking};
        ++rsltA.count;
      }
      notify (rsltA);
    }
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.allianceName = allianceName;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/allianceGetSearchResults.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (myAid!=null && myAid>0)
          t.fetchMyAllianceInfo  (function (r){ combineResults (rslt, r, notify)});
        else
          notify (rslt);
      },
      onFailure: function (rslt) {
        notify (rslt);
      },
    });
  },
  fetchOtherAllianceInfo : function (pageNum, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.pageNo = pageNum;
    params.cityId = unsafeWindow.currentcityid;
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/allianceGetOtherInfo.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onSuccess: function (rslt) {
        notify (rslt);
      },
    });
  },

  fetchMyAllianceInfo : function (notify){
    var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/allianceGetInfo.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onSuccess: function (rslt) {
        notify (rslt);
      },
    });
  },

  fetchPlayerList : function (name, notify){
    var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
    params.searchName = name;
    params.subType = "ALLIANCE_INVITE";
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/searchPlayers.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onSuccess: function (rslt) {
        notify (rslt);
      },
    });
  },

  fetchPlayerInfo : function (uid, notify){
    var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
    params.uid = uid;
    new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getUserGeneralInfo.php" + unsafeWindow.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify (rslt);
      },
      onSuccess: function (rslt) {
        notify (rslt);
      },
    });
  },
  fetchPlayerLastLogin : function (uid, notify){
      var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
      params.pid = uid;
      new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/viewCourt.php" + unsafeWindow.g_ajaxsuffix, {
        method: "post",
        parameters: params,
        onSuccess: function (rslt) {
          notify (rslt);
        },
        onSuccess: function (rslt) {
          notify (rslt);
        },
      });

  },
  fetchPlayerStatusSimple : function (uid, notify){
        var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
        params.checkArr = uid;
        new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getOnline.php" + unsafeWindow.g_ajaxsuffix, {
          method: "post",
          parameters: params,
          onSuccess: function (rslt) {
            if(rslt.ok)
             notify (rslt);
            else t.fetchPlayerStatusSimple(uidArray, notify);
          },
          onSuccess: function (rslt) {
            //notify (rslt);
            t.fetchPlayerStatusSimple(uidArray, notify);
          },
        });
   },
  fetchPlayerStatus : function (uidArray, notify){
      var params = uW.Object.clone(uW.g_ajaxparams);
      params.checkArr = uidArray.join(',');
      new MyAjaxRequest(uW.g_ajaxpath + "ajax/getOnline.php" + uW.g_ajaxsuffix, {
        method: "post",
        parameters: params,
        onSuccess: function (rslt) {
          if(rslt.ok)
		          notify (rslt);
        else t.fetchPlayerStatus(uidArray, notify);
        },
        onFailure: function (rslt) {
          t.fetchPlayerStatus(uidArray, notify);
        },
      });
  },
  ModelCity : {},
};

Tabs.TranspAuto = {
 tabOrder: 7,
 tabLabel: lang.BoiteLabelTransport,
 cont : null,
 displayTimer : null,
 state : null,
 curTabBut : null,
 curTabName : null,
 sourceCity : {},
 destinationCity : {},
 rows : [],
 timer: null,
 timer2:null,
 traderState: [],
 reapproState: [],
 lTR: [],
 tradeRoutes: [],
 checkdotradetimeout: null,
 count:0,
 check:false,
 show : function (){
   var t = Tabs.TranspAuto;
   if (TESTBAO==-1) return false;
   if (document.getElementById ('maparea_map').style.display!="none") {
     if (t.destinationCityx) {
                      t.destinationCityx.value = document.getElementById ('mapXCoor').value;
                      t.destinationCityy.value = document.getElementById ('mapYCoor').value;
                     }
   }
   if (t.curTabBut) {
    var but=t.curTabBut;
    t.show2();
   }
 },
 clickmap:function() {
  var t = Tabs.TranspAuto;
  if (document.getElementById ('maparea_map').style.display!="none") {
      if (t.destinationCityx) {
                       t.destinationCityx.value = document.getElementById ('mapXCoor').value;
                       t.destinationCityy.value = document.getElementById ('mapYCoor').value;
                      }
   }
 },
 hide : function (){
    var t = Tabs.TranspAuto;
    clearTimeout (t.displayTimer);
    clearTimeout (t.timer);
  },

  init : function (div){
   var t = Tabs.TranspAuto;
   uW.BOestimeres = t.estimerRes;
   t.traderState = {running: false,};
   t.reapproState = {running: false,city:-1,unit:9,mini:1000};
   t.readTraderState();
   t.readReapproState();
   t.readTradeRoutes();
   t.e_tradeRoutes();
   if (Options.BORac_Trp) AddSubTabLink('Trp', t.toggleTraderState, 'pbtrantab');
   if (Options.BORac_App) AddSubTabLink('Appro', t.toggleReapproState, 'boreapprotab');
   if (Options.BORac_App){
   if (t.reapproState.running == false) {
       	       updatebotbutton(lang.transport.labAppro+' - OFF', 'boreapprotab');
             } else {
       	      updatebotbutton(lang.transport.labAppro+' - ON', 'boreapprotab');
       	      t.checkdoreapprotimeout = setTimeout(t.actionreappro,8000);
   }
   }
   if (Options.BORac_Trp) {
    if (t.traderState.running == false) {
       	       updatebotbutton(lang.transport.labTrp+' - OFF', 'pbtrantab');
             } else {
       	       updatebotbutton(lang.transport.labTrp+' - ON', 'pbtrantab');
     }
    }
    window.addEventListener('unload', t.onUnload, false);
    t.cont = div;
    t.cont.innerHTML = '<TABLE class=ptTab align=center><TR><TD><INPUT class=bopbSubtab ID=BoTrpSubM type=submit value="'+lang.transport.manu+'"></td>\
             <TD><INPUT class=bopbSubtab ID=BoTrpSubA type=submit  value="'+lang.transport.auto+'"></td><TD><INPUT class=bopbSubtab ID=BoTrpSubR type=submit  value="'+lang.transport.appro+'"></td></tr></table>\
         <DIV id="BoTrpOutput" style="margin-top:5px; background-color:white; height:'+(Options.HauteurBoite-65)+'px;max-height:'+(Options.HauteurBoite-65)+'px;overflow-y:auto"></div>';
        t.TransportDiv = ById('BoTrpOutput');
  ById('BoTrpSubA').addEventListener('click', e_butSubtab, false);
  ById('BoTrpSubM').addEventListener('click', e_butSubtab, false);
  ById('BoTrpSubR').addEventListener('click', e_butSubtab, false);
  changeSubtab (ById('BoTrpSubM'));
  function e_butSubtab (evt){
          changeSubtab (evt.target);
      }
  function changeSubtab (but){
          if (but == t.curTabBut)
            return;
          if (t.curTabBut){
            t.curTabBut.className='bopbSubtab';
            t.curTabBut.disabled=false;
          }
          t.curTabBut = but;
          but.className='bopbSubtab bopbSubtabSel';
          but.disabled=true;
          t.curTabName = but.id.substr(8);
          t.show2();
      }
      var final = 0;
      if (t.reapproState.city>=0) {
      for(var i=0; i<Cities.numCities; i++) {
          var x2 = parseInt(Cities.cities[i].x);
          var x1 = parseInt(Cities.cities[t.reapproState.city].x);
          var y2 = parseInt(Cities.cities[i].y);
          var y1 = parseInt(Cities.cities[t.reapproState.city].y);
          var dist = distance (x1, y1, x2, y2);
          var m = estETA(dist,t.reapproState.unit,Cities.cities[t.reapproState.city].id,1);
          if (m.friendETA>final)
            final=m.friendETA;
        }
        Options.reapprointerval = parseInt(final/60*2+10);
       }
  },
   show2 : function (){
     var t = Tabs.TranspAuto
     t.state = null;
     clearTimeout (t.displayTimer);
     clearTimeout (t.timer);
     if (t.curTabName == 'M')
       t.showManuel();
     else  if (t.curTabName == 'R')
       t.showReappro();
     else {
       t.showAuto();
       t.showTimer();
     }

  },
  showTimer: function() {
   var t = Tabs.TranspAuto;
   t.updateTroops();
   t.updateResources();
   clearTimeout(t.timer);
   t.timer = setTimeout (t.showTimer, 1000);
  },
  showReappro: function () {
   var t = Tabs.TranspAuto;
   var m = '<DIV id=pbTowrtDivF class=boStat>'+lang.transport.titleappro+' - <input type=button value="?" id=boaideappro class=boAide></div><TABLE id=pbtraderfunctions width=100% height=0% class=pbTab><TR align="center">';
   if (t.reapproState.running == false) {
               m += '<TD><INPUT id=boReapproState type=submit value="'+lang.transport.labAppro+' = OFF"></td>';
     	       if (Options.BORac_App) updatebotbutton(lang.transport.labAppro+' - OFF', 'boreapprotab');
           } else {
               m += '<TD><INPUT id=boReapproState type=submit value="'+lang.transport.labAppro+' = ON"></td>';
     	      if (Options.BORac_App) updatebotbutton(lang.transport.labAppro+' - ON', 'boreapprotab');
   }
   m += '<td><input type=button value="'+lang.transport.BORecupReappro+'" id=BORecupReappro></td><td><input type=button value="'+uW.g_js_strings.commonstr.save+'" id="boReappro"><td><span title="'+lang.transport.pninterval+'">'+lang.transport.pbreapprointerval+': <INPUT id=pbreapprointerval type=text size=2 READONLY value="'+Options.reapprointerval+'"\> '+lang.General.mins+'</td></tr></table>';
   m += '<DIV id=pbReapproDivDRoute class=boStat>'+lang.transport.titleappro2+'</div>';
   m += '<TABLE id=pbaddReapproroute width=95% height=0% class=pbTab><TR align="left">';
   m += '<TR align="left"><TD colspan=2>'+lang.transport.cityFrom+':</td> <TD colspan=3><DIV style="margin-bottom:10px;"><span id=borescity></span></div></td><td colspan=4>'+uW.g_js_strings.commonstr.troops+' : '
   m += '<select id="BOApproUnit">';
   m += '<option value=9>'+uW.unitcost['unt9'][0]+'</option><option value=7>'+uW.unitcost['unt7'][0]+'</option><option value=8>'+uW.unitcost['unt8'][0]+'</option>';
   m += '</select>&nbsp;Min : <input type=text size=5 value="0" id=BOApproMin></td></tr>';
   var Types = ['gold','food','wood','stone','iron','aetherstone'];
   m += '<TR align="left"><td colspan=2>'+lang.transport.labAppro+'</td>';
   for (var y=0; y< Seed.cities.length;y++)
    m += '<td>'+Seed.cities[y][1]+'</td>';
   for (var i=0;i<5;i++) {
    m += '</tr><tr><td align=center valign=middle rowspan=2><img src="'+gameurl+'img/'+Types[i]+'_30.png"></td><td>'+uW.g_js_strings.commonstr.inventory+'</td>';
    for (var y=0; y< Seed.cities.length;y++)
     m += '<td><span id="ReappRec_'+y+'_'+i+'"></span></td>';
    m += '</tr><tr><td>'+lang.transport.keepmin+'</td>';
        for (var y=0; y< Seed.cities.length;y++)
     m += '<td><input id="ReappRes_'+y+'_'+i+'" type=text size=10 maxlength=12 value=0></td>';
    m +='</tr>';
   }
   m += '</table>';
   t.TransportDiv.innerHTML = m;
   if (t.reapproState.city==undefined ||t.reapproState.city==-1) {

    t.reapproState.city=0;
   }
   ById('boaideappro').addEventListener('click', function(){
       	 window.open(sitesupport+"?page=aide_appro");
    	} , false);
   t.reacp = new CdispCityPicker ('botrader', ById('borescity'), true, t.updateResources2, t.reapproState.city);
   ById('BOApproMin').addEventListener('change', function(){
    t.reapproState.mini = ById('BOApproMin').value;
    t.saveReappro();
    }, false);
   ById('boReapproState').addEventListener('click', function(){t.toggleReapproState(this);}, false);
   ById('boReappro').addEventListener('click', function(){t.saveReappro();}, false);

   ById('pbreapprointerval').addEventListener('keyup', function(){
      		if (isNaN(ById('pbreapprointerval').value)){ ById('pbreapprointerval').value=60 ;}
      		Options.reapprointerval = ById('pbreapprointerval').value;
      		saveOptions();
   }, false);

   ById('BORecupReappro').addEventListener('click', function(){t.RecupReappro();}, false);
   ById('BOApproUnit').value = t.reapproState.unit;
   ById('BOApproMin').value = parseIntNan(t.reapproState.mini);
   ById('BOApproUnit').addEventListener('change', function(){
    t.reapproState.unit = ById('BOApproUnit').value;
    t.saveReappro();

   }, false);

   t.updateResources2();
  },
  RecupReappro:function() {
   var t = Tabs.TranspAuto;
   var r = t.tradeRoutes;
   for (var y=0; y< Seed.cities.length;y++) {
    for (var i=0;i<(r.length);i++) {
     if (parseIntNan(Seed.cities[y][0]) == r[i].city) {
   ById('ReappRes_'+y+'_0').value=r[i].target_Gold;
   ById('ReappRes_'+y+'_1').value=r[i].target_Food;
   ById('ReappRes_'+y+'_2').value=r[i].target_Wood;
   ById('ReappRes_'+y+'_3').value=r[i].target_Stone;
   ById('ReappRes_'+y+'_4').value=r[i].target_Ore;
   //ById('ReappRes_'+y+'_5').value=r[i].target_Astone;
     }
    }
   }
   t.saveReappro();
  },
  saveReapproState: function(){
    var t = Tabs.TranspAuto;
    var serverID = getServerId();
    GM_setValue('reapproState_' + serverID, JSON2.stringify(t.reapproState));
  },
  saveReappro:function() {
   var t = Tabs.TranspAuto;
   for (var y=0; y< Seed.cities.length;y++) {
    t.reapproState['ReappRes_'+y+'_0'] = parseIntNan(ById('ReappRes_'+y+'_0').value);
    for (var i=1;i<5;i++) {
     t.reapproState['ReappRes_'+y+'_'+i] = parseIntNan(ById('ReappRes_'+y+'_'+i).value);
    }
   }
   t.saveReapproState();
  },
  readReapproState: function(){
             var t = Tabs.TranspAuto;
             var serverID = getServerId();
             s = GM_getValue('reapproState_' + serverID);
             if (s != null) {
                 state = JSON2.parse(s);
                 for (k in state)
                     t.reapproState[k] = state[k];
             }
  },
  toggleReapproState: function(obj){
     	   var t = Tabs.TranspAuto;
     	        clearTimeout(t.checkdoreapprotimeout);
     	   obj = ById('boReapproState');
             if (t.reapproState.running == true) {
                 t.reapproState.running = false;
                 if (obj)  obj.value = lang.transport.labAppro+' = OFF';
     	       if (Options.BORac_App) updatebotbutton(lang.transport.labAppro+' - OFF', 'boreapprotab');
             }
             else {
                t.reapproState.running = true;
                if (obj) obj.value = lang.transport.labAppro+' = ON';
     		if (Options.BORac_App) updatebotbutton(lang.transport.labAppro+' - ON', 'boreapprotab');
     		t.checkdoreapprotimeout = setTimeout(function() {t.actionreappro();},1000);
             }
  },
  retry:0,
  nbcity:-1,
  actionreappro:function(tt) {
   var t = Tabs.TranspAuto;
   t.nbcity++;
   clearTimeout(t.checkdoreapprotimeout);
   if (t.reapproState.running == false)   return false;
   if (t.nbcity==t.reapproState.city)
   	t.nbcity++;
   if ((Seed.cities.length-1)<t.nbcity) {
    t.nbcity=-1;
    t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, Options.reapprointerval*60*1000);
    return false;
   } else {
     var besoin=[0,0,0,0,0,0];
     var stock=[0,0,0,0,0,0];
     qtemin = parseIntNan(t.reapproState['ReappRes_'+t.nbcity+'_0']);
     qtest = parseIntNan(Seed.citystats["city" + Seed.cities[t.nbcity][0]]['gold'][0]);
     if (qtest<qtemin)
        besoin[0] = parseIntNan(qtemin - qtest);
     stock[0] = parseIntNan(Seed.citystats["city" + Seed.cities[t.reapproState.city][0]]['gold'][0]);
     for (var i=1;i<5;i++) {
        qtemin = parseIntNan(t.reapproState['ReappRes_'+t.nbcity+'_'+i]);
        qtest = parseIntNan(Seed.resources["city" + Seed.cities[t.nbcity][0]]['rec'+i][0]/3600);
        qtstock= parseIntNan(Seed.resources["city" + Seed.cities[t.reapproState.city][0]]['rec'+i][0]/3600);
        if (qtest<qtemin)
         besoin[i] = parseIntNan(qtemin - qtest);
        stock[i] = qtstock;
     }
     var rallypointlevel=March.RallyPoint(Cities.cities[t.reapproState.city].id).maxSlots;
     var slots=March.RallyPoint(Cities.cities[t.reapproState.city].id).marching;
     if(slots >= rallypointlevel){
      		if (Options.LogsAppro)actionLog("Appro","Transport from "+Cities.cities[t.reapproState.city].name+" to "+Cities.cities[t.nbcity].name+" : <font color=red>Point de ralliement complet !</font>");
      		t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 2000);
      		return false;
     }
     if (besoin[0]>0 || besoin[1]>0|| besoin[2]>0 || besoin[3]>0 || besoin[4]>0) {
     if (besoin[0]<=stock[0] && besoin[1]<=stock[1] && besoin[2]<=stock[2] && besoin[3]<=stock[3] && besoin[4]<=stock[4]) {
         var unit = 'unt' + t.reapproState.unit
       	 Troops = parseIntNan(Seed.units['city' + Seed.cities[t.reapproState.city][0]][unit]);
       	 var untid=t.reapproState.unit;
	     var techLoadBoost=parseIntNan(Seed.tech.tch10)*0.1;
	     var loadEffectBoost=0;
	     if(Seed.playerEffects.loadExpire>uW.unixtime()){loadEffectBoost=0.25}
	     var BBoost=0;
		 BBoost+=EffetTronePrc(6).percent;
         if(uW.cm.unitFrontendType[untid]=="horsed"){
		 		 	 BBoost+=EffetTronePrc(48).percent;
	     }
	     if (BBoost>=500) {BBoost=500;loadEffectBoost=0;}
	     var loadBoost=(BBoost*0.01)+loadEffectBoost+techLoadBoost;
       	  var LoadUnit=parseIntNan(parseIntNan(uW.unitstats["unt"+untid][5])*(1+loadBoost));
       	  LoadUnit=LoadUnit-1;
       	  TroopsNeeded = (besoin[0] + besoin[1] + besoin[2] + besoin[3] + besoin[4])  / LoadUnit;
       	  TroopsNeeded = TroopsNeeded.toFixed(0);
       	  if (TroopsNeeded < ((besoin[0] + besoin[1] + besoin[2] + besoin[3] + besoin[4])  / LoadUnit )) TroopsNeeded++;
          var maxtroupe=March.RallyPoint(Seed.cities[t.reapproState.city][0]).maxSize;
          if (parseIntNan(Troops)<parseIntNan(maxtroupe))  maxtroupe = Troops;
       	  if (parseIntNan(TroopsNeeded) > parseIntNan(maxtroupe)){
       	   TroopsNeeded = maxtroupe;
       	   var lemax=LoadUnit*TroopsNeeded;
       	   var totalb=lemax;
       	   for (var i=1;i<5;i++) {
       	    if (besoin[i]>=totalb)
       	    	besoin[i]=totalb;
       	    totalb=totalb-besoin[i];
       	   }
       	  }
       	  if (parseIntNan(TroopsNeeded)<=parseIntNan(Troops) && parseIntNan(TroopsNeeded)>=parseIntNan(t.reapproState.mini)) {
       	   var city = Seed.cities[t.reapproState.city][0];
       	   var params = uW.Object.clone(uW.g_ajaxparams);
       	   if(tt)
       params.tt = tt;
	   params.gold =besoin[0];
	   params.r1 =besoin[1];
	   params.r2 =besoin[2];
	   params.r3 =besoin[3];
	   params.r4 =besoin[4];
	   params.r5 =0;
   	   params.kid = 0;
   	   params.type = "1";
       	   params.cid=city;
       	   switch (unit){
	            case 'unt1': params.u1 = TroopsNeeded;break;
	            case 'unt2': params.u2 = TroopsNeeded;break;
	            case 'unt3': params.u3 = TroopsNeeded;break;
	            case 'unt4': params.u4 = TroopsNeeded;break;
	            case 'unt5': params.u5 = TroopsNeeded;break;
	            case 'unt6': params.u6 = TroopsNeeded;break;
	            case 'unt7': params.u7 = TroopsNeeded;break;
	            case 'unt8': params.u8 = TroopsNeeded;break;
	            case 'unt9': params.u9 = TroopsNeeded;break;
	            case 'unt10': params.u10 = TroopsNeeded;break;
	            case 'unt11': params.u11 = TroopsNeeded;break;
	            case 'unt12': params.u12 = TroopsNeeded;break;
           }
       	 params.xcoord = Seed.cities[t.nbcity][2];
   	  	 params.ycoord = Seed.cities[t.nbcity][3];
		 var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
         new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
	                       method: "post",
	                       parameters: params,
	                       loading: true,
	                       onSuccess: function (transport) {
						   profiler.stop();
						   var t = Tabs.TranspAuto;
	                       var rslt = eval("(" + transport.responseText + ")");
	                       if (rslt.ok) {
	                       var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
	                       var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
	                       var ut = uW.unixtime();
	                       var unitsarr = [];
            	 			for (j in uW.unitcost) unitsarr.push(0);
	                       for(i = 1; i <= unitsarr.length; i++)if(params["u"+i])unitsarr[i] = params["u"+i];
	                       var resources=new Array();
	                       resources[0] = params.gold;
	                       for(i=1; i<=5; i++)resources[i] = params["r"+i];
	                       var currentcityid = city;
	                       uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
	                       uW.update_seed(rslt.updateSeed)
	                       if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
	                       if (Options.LogsAppro)actionLog("Appro","Transport from "+Cities.cities[t.reapproState.city].name+" to "+Cities.cities[t.nbcity].name+" de "+TroopsNeeded+" "+uW.unitcost[unit][0]);
	                       t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 8000);
	                       return false;
	                  } else {

	  			if (Options.LogsAppro)actionLog("Appro","Transport from "+Cities.cities[t.reapproState.city].name+" to "+Cities.cities[t.nbcity].name+" <font color=red>" + transport.responseText +"<br>"+params.u7+"</font>");
	  			t.retry++;
	  			if (t.retry>4) {
	  			 t.retry=0;
	  			 t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 2000);
	  			 return false;
	  			}else {
				 var t = Tabs.TranspAuto;
	  			 t.checkdoreapprotimeout =  setTimeout(function() {t.nbcity--;t.actionreappro();},2000);
	  			 return false;
	  			}
	            }
	         },
	         onFailure: function (rslt) {
	                          var t = Tabs.TranspAuto;
							   profiler.stop();
	                          if (Options.LogsAppro)actionLog("Appro","<font color=red>" + rslt.responseText +"</font>");
	                          t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 2000);
	                          return false;
					}

             });
       	  } else {
           var t = Tabs.TranspAuto;
       	   if (Options.LogsAppro)actionLog("Appro","Transport de "+Cities.cities[t.reapproState.city].name+" vers "+Cities.cities[t.nbcity].name+" : blocage troupes minimun");
       	   t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 2000);
       	   return false;
       	  }
      } else {
       if (Options.LogsAppro)actionLog("Appro","Transport de "+Cities.cities[t.reapproState.city].name+" vers "+Cities.cities[t.nbcity].name+" : Stock insuffisant");
       t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 2000);
       return false;
      }
     } else {
       t.checkdoreapprotimeout = setTimeout(function() { t.actionreappro();}, 2000);
     }
   }
  },
  showAuto: function() {
   var t = Tabs.TranspAuto;
    var m = '<DIV id=pbTowrtDivF class=boStat>'+lang.transport.titleauto+'</div><TABLE id=pbtraderfunctions width=100% height=0% class=pbTab><TR align="center">';
         if (t.traderState.running == false) {
             m += '<TD><INPUT id=pbTraderState type=submit value="'+lang.transport.labTrp+' = OFF"></td>';
   	       if (Options.BORac_Trp) updatebotbutton(lang.transport.labTrp+' - OFF', 'pbtrantab');
         } else {
             m += '<TD><INPUT id=pbTraderState type=submit value="'+lang.transport.labTrp+' = ON"></td>';
   	      if (Options.BORac_Trp) updatebotbutton(lang.transport.labTrp+' - ON', 'pbtrantab');
         }
         m += '<TD><INPUT id=pbTradeReset type=submit value="Delete Routes"></td>';
    	 m += '<TD><INPUT id=pbShowRoutes type=submit value="'+lang.transport.showRoutes+'"></td>';
         m += '</tr></table></div>';
         m += '<DIV id=pbTraderDivDRoute class=boStat>'+lang.transport.titleauto2+'</div>';
         m += '<TABLE id=pbtraderfunctions width=100% height=0% class=pbTab><TR align="left">';
   	 m += '<TD colspan=2>'+lang.transport.pbtransportinterval+' <INPUT id=pbtransportinterval type=text size=4 value="'+Options.transportinterval+'"\> '+lang.General.mins+'</td>';
         m += '<TD colspan=4>'+lang.transport.pbminwagons+' <INPUT id=pbminwagons type=text size=4 value="'+Options.minwagons+'"\> '+uW.g_js_strings.commonstr.troops+'</td></tr></table>';
         m += '</table>';
         m += '<DIV id=pbTraderDivDRoute class=boStat>'+lang.transport.titleauto3+'</div>';
         m += '<TABLE id=pbaddtraderoute width=95% height=0% class=pbTab><TR align="left">';
         m += '<TR align="left"><TD>'+lang.General.source+':</td> <TD colspan=4><DIV style="margin-bottom:10px;"><span id=ptrescity></span></div></td></tr>';

         m += '<TR align="left">';
         m += '<TD>'+lang.General.dest+':</td> <TD width=310px><DIV style="margin-bottom:10px;"><span id=ptcityTo></span></div></td>';
         m += '<TD>OU</td>';
         m += '<TD>X:<INPUT id=ptcityX type=text size=3\></td>';
         m += '<TD>Y:<INPUT id=ptcityY type=text size=3\></td></tr>';
         m += '<TABLE id=pbaddtraderoute height=0% class=pbTab><TR align="left">';
         m += '<TD width=75px>'+uW.g_js_strings.commonstr.troops+':</td><TD width=150px><SELECT id="TransportTroop">';
         for (y in uW.unitcost) m+='<option value="'+y+'">'+uW.unitcost[y][0]+'</option>';
         m+='</select></td><TD width=75px>'+lang.transport.TroopAmount+':&nbsp;</td><TD id=TroopAmount align=left width=75px></td>';
         m+='<TD width=75px>'+lang.transport.CarryAmount+':&nbsp;</td><TD id=CarryAmount align=left width=75px></td>';
         m += '<TR><TD >'+uW.g_js_strings.commonstr.troops+' : </td><TD><INPUT id=TroopsToSend type=text size=6 maxlength=8 value="0">&nbsp;&nbsp;<INPUT id=MaxTroops type=submit value="Max"></td>';
         m += '<TD width=50px><INPUT id=FillInMax type=submit value="<----"></td>';
         m +='<TD id=Calc colspan=3></td></tr>';
         m += '<TABLE id=pbaddtraderoute height=0% class=pbTab><TR align="center">';
         m += '<TD width=5%><img src="'+gameurl+'img/food_30.png"></td>';
         m += '<TD id=TransRec1 align=right width=110px></td>';
         m += '<TD id=HaveRec1 align=right width=110px></td>';
         m += '<TD width=55px align=right><INPUT id=pbshipFood type=checkbox unchecked=true\></td>';
         m += '<TD width=180px  align=left>'+lang.transport.keep+': <INPUT id=pbtargetamountFood type=text size=11 maxlength=15 value="0" disabled=true\></td>';
         m += '<TD width=100px>'+lang.transport.trade+': <INPUT id=pbtradeamountFood type=text size=11 maxlength=12 value="0"\></td>';
         m += '<TD width=50px><INPUT id=MaxFood type=submit value="Max"></td></tr>';
         m += '<TR align="center">';
         m += '<TD width=5%><img src="'+gameurl+'img/wood_30.png"></td>';
         m += '<TD id=TransRec2 align=right width=110px></td>';
         m += '<TD id=HaveRec2 align=right width=110px></td>';
         m += '<TD width=55px align=right><INPUT id=pbshipWood type=checkbox unchecked=true\></td>';
         m += '<TD width=180px align=left>'+lang.transport.keep+': <INPUT id=pbtargetamountWood type=text size=11 maxlength=15 value="0" disabled=true\></td>';
         m += '<TD width=100px>'+lang.transport.trade+': <INPUT id=pbtradeamountWood type=text size=11 maxlength=12 value="0"\></td>';
         m += '<TD width=50px><INPUT id=MaxWood type=submit value="Max"></td></tr>';
         m += '<TR align="center">';
         m += '<TD width=5%><img src="'+gameurl+'img/stone_30.png"></td>';
         m += '<TD id=TransRec3 align=right width=110px></td>';
         m += '<TD id=HaveRec3 align=right width=110px></td>';
         m += '<TD width=55px align=right><INPUT id=pbshipStone type=checkbox unchecked=true\></td>';
         m += '<TD width=180px align=left>'+lang.transport.keep+': <INPUT id=pbtargetamountStone type=text size=11 maxlength=15 value="0" disabled=true\></td>';
         m += '<TD width=100px>'+lang.transport.trade+': <INPUT id=pbtradeamountStone type=text size=11 maxlength=12 value="0"\></td>';
         m += '<TD width=50px><INPUT id=MaxStone type=submit value="Max"></td></tr>';
         m += '<TR align="center">';
         m += '<TD width=5%><img src="'+gameurl+'img/iron_30.png"></td>';
         m += '<TD id=TransRec4 align=right width=110px></td>';
         m += '<TD id=HaveRec4 align=right width=110px></td>';
         m += '<TD width=55px align=right><INPUT id=pbshipOre type=checkbox unchecked=true\></td>';
         m += '<TD width=180px align=left>'+lang.transport.keep+': <INPUT id=pbtargetamountOre type=text size=11 maxlength=15 value="0" disabled=true\></td>';
         m += '<TD width=100px>'+lang.transport.trade+': <INPUT id=pbtradeamountOre type=text size=11 maxlength=12 value="0"\></td>';
         m += '<TD width=50px><INPUT id=MaxOre type=submit value="Max"></td></tr>';
          m += '<TR align="center">';
      m += '<TD width=5%><img src="'+gameurl+'img/aetherstone_30.png"></td>';
      m += '<TD id=TransRec5 align=right width=110px></td>';
      m += '<TD id=HaveRec5 align=right width=110px></td>';
      m += '<TD width=55px align=right><INPUT id=pbshipAstone type=checkbox unchecked=true\></td>';
      m += '<TD width=180px align=left>'+lang.transport.keep+': <INPUT id=pbtargetamountAstone type=text size=11 maxlength=15 value="0" disabled=true\></td>';
      m += '<TD width=100px>'+lang.transport.trade+': <INPUT id=pbtradeamountAstone type=text size=11 maxlength=12 value="0"\></td>';
      m += '<TD width=50px><INPUT id=MaxAstone type=submit value="Max"></td></tr>';
      m += '<TR align="center">';
         m += '<TD width=5%><img src="'+gameurl+'img/gold_30.png"></td>';
         m += '<TD id=TransGold align=right width=110px></td>';
         m += '<TD id=HaveGold align=right width=110px></td>';
         m += '<TD width=55px align=right><INPUT id=pbshipGold type=checkbox unchecked=true\></td>';
         m += '<TD width=180px align=left>'+lang.transport.keep+': <INPUT id=pbtargetamountGold type=text size=11 maxlength=15 value="0" disabled=true\></td>';
         m += '<TD width=100px>'+lang.transport.trade+': <INPUT id=pbtradeamountGold type=text size=11 maxlength=12 value="0"\></td>';
         m += '<TD width=50px><INPUT id=MaxGold type=submit value="Max"></td></tr>';

         m += '</table>';

         m += '<DIV style="text-align:center; margin-top:15px"><INPUT id=pbSaveRoute type=submit value="'+lang.transport.pbSaveRoute+'"><INPUT id=pbManualSend type=submit value="'+lang.transport.pbManualSend+'"></div>';
         m += '<DIV id=errorSpace></div>'
  	 t.TransportDiv.innerHTML = m;
     ById('TransportTroop').value = 'unt9';
     t.tcp = new CdispCityPicker ('pttrader', ById('ptrescity'), true, t.updateResources, 0);
     t.tcpto = new CdispCityPicker ('pttraderTo', ById('ptcityTo'), true, t.clickCitySelect).bindToXYboxes(document.getElementById ('ptcityX'), document.getElementById ('ptcityY'));
     ById('TransportTroop').addEventListener('change', function(){t.updateTroops();}, false);
     ById('pbTraderState').addEventListener('click', function(){t.toggleTraderState(this);}, false);
     ById('pbSaveRoute').addEventListener('click', function(){t.addTradeRoute();}, false);
     ById('pbManualSend').addEventListener('click', function(){t.ManualTransport();}, false);
     ById('pbShowRoutes').addEventListener('click', function(){t.showTradeRoutes();}, false);
     ById('FillInMax').addEventListener('click', function(){ById('TroopsToSend').value = t.TroopsNeeded;}, false);
     ById('MaxTroops').addEventListener('click', function(){
   	 var max = March.getMaxSize(t.tcp.city.id,0,0);
     ById('TroopsToSend').value = max;
   	  }, false);
         ById('MaxFood').addEventListener('click', function(){
         		t.Food = 0;
   			var input = t.MaxLoad - (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone);
         		ById('pbtradeamountFood').value = (parseInt(input) <= parseIntCommas(ById('TransRec1').innerHTML))?input:parseIntCommas(ById('TransRec1').innerHTML);
         }, false);
         ById('MaxWood').addEventListener('click', function(){
         		t.Wood = 0;
   			var input = t.MaxLoad - (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone);
         		ById('pbtradeamountWood').value = (parseInt(input) <= parseIntCommas(ById('TransRec2').innerHTML))?input:parseIntCommas(ById('TransRec2').innerHTML);
         }, false);
         ById('MaxStone').addEventListener('click', function(){
         		t.Stone = 0;
   			var input = t.MaxLoad - (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone);
         		ById('pbtradeamountStone').value = (parseInt(input) <= parseIntCommas(ById('TransRec3').innerHTML))?input:parseIntCommas(ById('TransRec3').innerHTML);
         }, false);
         ById('MaxOre').addEventListener('click', function(){
         		t.Ore = 0;
   			var input = t.MaxLoad - (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone);
         		ById('pbtradeamountOre').value = (parseInt(input) <= parseIntCommas(ById('TransRec4').innerHTML))?input:parseIntCommas(ById('TransRec4').innerHTML);
         }, false);
         ById('MaxGold').addEventListener('click', function(){
   			t.Gold = 0;
   			var input = t.MaxLoad - (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone);
         		ById('pbtradeamountGold').value = (parseInt(input) <= parseIntCommas(ById('TransGold').innerHTML))?input:parseIntCommas(ById('TransGold').innerHTML);
         }, false);
   	   ById('MaxAstone').addEventListener('click', function(){
         		t.Astone = 0;
   			var input = t.MaxLoad - (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone);
         		ById('pbtradeamountAstone').value = (parseInt(input) <= parseIntCommas(ById('TransRec5').innerHTML))?input:parseIntCommas(ById('TransRec5').innerHTML);
         }, false);

         ById('pbtransportinterval').addEventListener('keyup', function(){
   		if (isNaN(ById('pbtransportinterval').value)){ ById('pbtransportinterval').value=60 ;}
   		Options.transportinterval = ById('pbtransportinterval').value;
   		saveOptions();
         }, false);
        ById('pbTradeReset').addEventListener('click', function () {				t.tradeRoutes=[];t.saveTradeRoutes();        }, false);
         ById('pbtargetamountFood').addEventListener('keyup', function(){
             if (isNaN(ById('pbtargetamountFood').value)) ById('pbtargetamountFood').value=0 ;
         }, false);
         ById('pbtargetamountWood').addEventListener('keyup', function(){
             if (isNaN(ById('pbtargetamountWood').value)) ById('pbtargetamountWood').value=0 ;
         }, false);
         ById('pbtargetamountStone').addEventListener('keyup', function(){
             if (isNaN(ById('pbtargetamountStone').value)) ById('pbtargetamountStone').value=0 ;
         }, false);
         ById('pbtargetamountOre').addEventListener('keyup', function(){
             if (isNaN(ById('pbtargetamountOre').value)) ById('pbtargetamountOre').value=0 ;
         }, false);
   	  ById('pbtargetamountAstone').addEventListener('keyup', function(){
             if (isNaN(ById('pbtargetamountAstone').value)) ById('pbtargetamountAstone').value=0 ;
         }, false);
         ById('pbtargetamountGold').addEventListener('keyup', function(){
             if (isNaN(ById('pbtargetamountGold').value)) ById('pbtargetamountGold').value=0 ;
         }, false);
         ById('pbtradeamountFood').addEventListener('keyup', function(){
             if (isNaN(ById('pbtradeamountFood').value)) ById('pbtradeamountFood').value=0 ;
         }, false);
         ById('pbtradeamountWood').addEventListener('keyup', function(){
             if (isNaN(ById('pbtradeamountWood').value)) ById('pbtradeamountWood').value=0 ;
         }, false);
         ById('pbtradeamountStone').addEventListener('keyup', function(){
             if (isNaN(ById('pbtradeamountStone').value)) ById('pbtradeamountStone').value=0 ;
         }, false);
         ById('pbtradeamountOre').addEventListener('keyup', function(){
             if (isNaN(ById('pbtradeamountOre').value)) ById('pbtradeamountOre').value=0 ;
         }, false);
   	  ById('pbtradeamountAstone').addEventListener('keyup', function(){
             if (isNaN(ById('pbtradeamountAstone').value)) ById('pbtradeamountAstone').value=0 ;
         }, false);
         ById('pbtradeamountGold').addEventListener('keyup', function(){
             if (isNaN(ById('pbtradeamountGold').value)) ById('pbtradeamountGold').value=0 ;
         }, false);
        ById('pbminwagons').addEventListener('keyup', function(){
            if (isNaN(ById('pbminwagons').value)) ById('pbminwagons').value=100 ;
            Options.minwagons = parseInt(ById('pbminwagons').value);
            saveOptions();
        }, false)
 		ById('pbshipFood').addEventListener('click', function(){
             if (!ById('pbshipFood').checked) ById('pbtargetamountFood').disabled = true;
             else ById('pbtargetamountFood').disabled = false;
         },false);
         ById('pbshipWood').addEventListener('click', function(){
             if (!ById('pbshipWood').checked) ById('pbtargetamountWood').disabled = true;
             else ById('pbtargetamountWood').disabled = false;
         },false);
         ById('pbshipStone').addEventListener('click', function(){
             if (ById('pbshipStone').checked==false) {
                 ById('pbtargetamountStone').disabled = true;
             }
             else {
               ById('pbtargetamountStone').disabled = false;
             }
         },false);
         ById('pbshipOre').addEventListener('click', function(){
             if (ById('pbshipOre').checked==false) {
                 ById('pbtargetamountOre').disabled = true;
             }
             else {
               ById('pbtargetamountOre').disabled = false;
             }
         },false);
   	   ById('pbshipAstone').addEventListener('click', function(){
             if (ById('pbshipAstone').checked==false) {
                 ById('pbtargetamountAstone').disabled = true;
             }
             else {
               ById('pbtargetamountAstone').disabled = false;
             }
         },false);
          ById('pbshipGold').addEventListener('click', function(){
             if (ById('pbshipGold').checked==false) {
                 ById('pbtargetamountGold').disabled = true;
             }
             else {
               ById('pbtargetamountGold').disabled = false;
             }
         },false);

       },
       updateResources2 : function (){
       var t = Tabs.TranspAuto
       t.reapproState.city = t.reacp.city.idx;
       for (var y=0; y< Seed.cities.length;y++) {
         if (t.reacp.city.id==Seed.cities[y][0]) {
          ById('ReappRes_'+y+'_0').value="0";
          ById('ReappRes_'+y+'_0').disabled=true;
         }else {
          ById('ReappRes_'+y+'_0').disabled=false;
          ById('ReappRes_'+y+'_0').value=parseIntNan(t.reapproState['ReappRes_'+y+'_0']);
          ById('ReappRec_'+y+'_0').innerHTML = addCommas ( parseIntNan(Seed.citystats["city" + Seed.cities[y][0]]['gold'][0]) );
          }
         for (var i=1;i<5;i++) {
          if (t.reacp.city.id==Seed.cities[y][0]) {
            ById('ReappRes_'+y+'_'+i).value="0";
            ById('ReappRes_'+y+'_'+i).disabled=true;
          } else{
            ById('ReappRes_'+y+'_'+i).value= parseIntNan(t.reapproState['ReappRes_'+y+'_'+i]);
            ById('ReappRes_'+y+'_'+i).disabled=false;
          }
              ById('ReappRec_'+y+'_'+i).innerHTML = addCommas ( parseIntNan(Seed.resources["city" + Seed.cities[y][0]]['rec'+i][0]/3600));
         }

       }

       },
       updateResources : function (){
       	var t = Tabs.TranspAuto
       	var ToCity = null;
       	for (var i=1;i<=5;i++)
   			if(i==5)
   			   ById('TransRec'+i).innerHTML = addCommas ( parseIntNan(Seed.resources["city" + t.tcp.city.id]['rec'+i][0]) );
   			else
                          ById('TransRec'+i).innerHTML = addCommas ( parseIntNan(Seed.resources["city" + t.tcp.city.id]['rec'+i][0]/3600) );
       	ById('TransGold').innerHTML = addCommas ( parseInt(Seed.citystats["city" + t.tcp.city.id]['gold'][0]) );
       	for (ii in Seed.cities)
           if (Seed.cities[ii][2] == document.getElementById ('ptcityX').value && Seed.cities[ii][3] == document.getElementById ('ptcityY').value)
             ToCity = Seed.cities[ii][0];
         for (var i=1;i<=5;i++)
             if (ToCity != null)
   			if(i==5)
   			   ById('HaveRec'+i).innerHTML = addCommas ( parseInt(Seed.resources["city" + ToCity]['rec'+i][0]) );
   			else
                  ById('HaveRec'+i).innerHTML = addCommas ( parseInt(Seed.resources["city" + ToCity]['rec'+i][0]/3600) );
       	  else ById('HaveRec'+i).innerHTML = "----";
         if (ToCity != null) ById('HaveGold').innerHTML = addCommas ( parseInt(Seed.citystats["city" + ToCity]['gold'][0]) );
         else  ById('HaveGold').innerHTML =  "----";
       },

       updateTroops : function (city){
       	var t = Tabs.TranspAuto;
       	var fontcolor = 'black';
       	t.Food = parseInt(ById('pbtradeamountFood').value);
        t.Wood = parseInt(ById('pbtradeamountWood').value);
        t.Stone = parseInt(ById('pbtradeamountStone').value);
        t.Ore = parseInt(ById('pbtradeamountOre').value);
        t.Gold = parseInt(ById('pbtradeamountGold').value);
   		t.Astone = parseInt(ById('pbtradeamountAstone').value*5);
       	var unit = ById('TransportTroop').value;
       	t.Troops = parseInt(Seed.units['city' + t.tcp.city.id][unit]);
		var unit_number = parseInt(ById('TroopsToSend').value);
        var unitid = ById('TransportTroop').value;
        unitid = unitid.substr(3);
        var LoadUnit = getMaxLoad(unitid,1);
        var GlobalMaxLoad = Math.floor(t.Troops * LoadUnit);
        t.MaxLoad = getMaxLoad(unitid,unit_number);
        t.TroopsNeeded = (t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone) / LoadUnit;
        t.TroopsNeeded = Math.floor(t.TroopsNeeded + .9999);
        if (t.TroopsNeeded < ((t.Food + t.Wood + t.Stone + t.Ore + t.Gold + t.Astone) / LoadUnit)) t.TroopsNeeded++;
        if (t.TroopsNeeded > t.Troops) fontcolor = 'red';
        if (t.Troops > 0) ById('TroopAmount').innerHTML = '<FONT color=' + fontcolor + '>' + addCommas(t.Troops) + '</font>';
        else ById('TroopAmount').innerHTML = 0;
        if (GlobalMaxLoad > 0) ById('CarryAmount').innerHTML = addCommas(GlobalMaxLoad);
        else ById('CarryAmount').innerHTML = 0;
       	ById('Calc').innerHTML = uW.g_js_strings.commonstr.resource+': ' +  addCommas(t.Food + t.Wood + t.Stone + t.Ore + t.Gold  + t.Astone) + ' / ' + addCommas(t.MaxLoad) + '&nbsp;&nbsp;('+lang.transport.TroopsNeeded+' <FONT color='+fontcolor+'>' + addCommas(t.TroopsNeeded) + '</font> )' ;
       },
     getRallypoint: function(cityId){
        var t = Tabs.TranspAuto;
        for (var o in Seed.buildings[cityId]){
   		 var buildingType = parseInt(Seed.buildings[cityId][o][0]);
   		 var buildingLevel = parseInt(Seed.buildings[cityId][o][1]);
   		 if (buildingType == 12){
   			return parseInt(buildingLevel);
   			break;
   		 }
   	    }
   	    return 0;
    },
    e_tradeRoutes: function(){
         var t = Tabs.TranspAuto;
         var now = new Date();
         clearTimeout(t.timer2);
         if (t.traderState.running == true)    {
         	var now = new Date().getTime()/1000.0;
         	now = now.toFixed(0);
         	var last = Options.lasttransport;
          		if ( now > (parseInt(last) + (Options.transportinterval*60))){
   				  t.checkdoTrades();
         		}
         }
   	     t.timer2 = setTimeout(function(){ t.e_tradeRoutes();}, Options.transportinterval*60*1000);

    },
   	delTradeRoutes: function() {
   		var t = Tabs.TranspAuto;
   		t.tradeRoutes= [];
   	},

   	checkcoords : function (obj){
   		var t = Tabs.TranspAuto;
   		if(obj.id == 'pbok'){
   			t.check = true;
   			t.addTradeRoute();
   		}
   		return;
   	},

   	addTradeRoute: function () {
   		var valid = true;
   		var t = Tabs.TranspAuto;
   		var city = t.tcp.city.id;
   		if (ById('ptcityX').value==0 && ById('ptcityY').value ==0 && !t.check)
   		{
   			return;
   		}
   		var ship_Food = ById('pbshipFood').checked;
   		var ship_Wood = ById('pbshipWood').checked;
   		var ship_Stone = ById('pbshipStone').checked;
   		var ship_Ore = ById('pbshipOre').checked;
   		var ship_Astone = ById('pbshipAstone').checked;
   		var ship_Gold = ById('pbshipGold').checked;
   		var target_Food = ById('pbtargetamountFood').value;
   		var target_Wood = ById('pbtargetamountWood').value;
   		var target_Stone = ById('pbtargetamountStone').value;
   		var target_Ore = ById('pbtargetamountOre').value;
   		var target_Astone = ById('pbtargetamountAstone').value;
   		var target_Gold = ById('pbtargetamountGold').value;
   		var trade_Food = ById('pbtradeamountFood').value;
   		var trade_Wood = ById('pbtradeamountWood').value;
   		var trade_Stone = ById('pbtradeamountStone').value;
   		var trade_Ore = ById('pbtradeamountOre').value;
   		var trade_Astone = ById('pbtradeamountAstone').value;
   		var trade_Gold = ById('pbtradeamountGold').value;
   		var target_x = ById('ptcityX').value;
   		var target_y = ById('ptcityY').value;
   		var TroopType = ById('TransportTroop').value;
   		var route_state = true;

   		if (valid == true) {
   			var lTR = t.tradeRoutes;
   			lTR.push({
   				city:				city,
   				ship_Food:			ship_Food,
   				target_Food:		target_Food,
   				trade_Food: 		trade_Food,
   				ship_Wood:			ship_Wood,
   				target_Wood:		target_Wood,
   				trade_Wood: 		trade_Wood,
   				ship_Stone:			ship_Stone,
   				target_Stone:		target_Stone,
   				trade_Stone: 		trade_Stone,
   				ship_Ore:			ship_Ore,
   				target_Ore:			target_Ore,
   				trade_Ore:	 		trade_Ore,
   				ship_Astone:	    ship_Astone,
   				target_Astone:		target_Astone,
   				trade_Astone:	 	trade_Astone,
   				ship_Gold:			ship_Gold,
   				target_Gold:		target_Gold,
   				trade_Gold: 		trade_Gold,
   				target_x: 			target_x,
   				target_y: 			target_y,
   				TroopType:          TroopType,
   				route_state: 		"true"
   			});
   		}
   		ById('pbTraderDivDRoute').style.background ='#99FF99';
   		setTimeout(function(){ (ById('pbTraderDivDRoute').style.background =''); }, 500);
   	},
   	showTradeRoutes: function () {
   		var t = Tabs.TranspAuto;
   		if (t.popTradeRoutes == null) {
   		 t.popTradeRoutes = new CPopup('pbShowTrade', 0, 0, 750, 500, true, function() {clearTimeout (1000);});
   		 t.popTradeRoutes.centerMe (mainPop.getMainDiv());
   		}
   		var m = '<DIV style="max-height:460px; height:460px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbTab" id="pbRoutesQueue">';
   		t.popTradeRoutes.getMainDiv().innerHTML = '</table></div>' + m;
   		t.popTradeRoutes.getTopDiv().innerHTML = '<TD><B>'+lang.transport.TradeRoutes+'</td>';
   		t.paintTradeRoutes();
   		t.popTradeRoutes.show(true)	;
   	},
   	paintTradeRoutes: function(){
   	        var t = Tabs.TranspAuto;
   	        var r = t.tradeRoutes;
   	        var cityname;
   	        var citynameTo = null;
   	    var m= '<TABLE id=paintRoutes class=pbTab><tr><td colspan=4><input type=button id=BOTrpQG value="'+lang.transport.BOTrpQG+'"></tr>';
   			for (var i=0;i<(r.length);i++) {
   			  citynameTo = null;
   				for (var y=0; y< Seed.cities.length;y++) {
   					if ( parseInt(Seed.cities[y][0]) == r[i].city) var cityname = Seed.cities[y][1];
   					if ( parseInt(Seed.cities[y][2]) == r[i].target_x && parseInt(Seed.cities[y][3]) == r[i].target_y) var citynameTo = Seed.cities[y][1];
   				}
   				var queueId = i;
   				if (citynameTo == null) var TO =  r[i].target_x +','+ r[i].target_y ;
   				else TO = citynameTo;
   				if (r[i].route_state) var status = '<FONT color=green>'+lang.transport.status1+'</font>';
   				else var status = '<FONT color=red>'+lang.transport.status2+'</font>';
   				if (r[i].TroopType == undefined) var unit = 'unt9';
           else var unit = r[i].TroopType;
   				m += '<TR><TD TD width=12px>&nbsp;&nbsp;</td></tr>';
           m +='<TR><TD width=20px>'+(i+1)+'</td><TD width=175px>'+uW.g_js_strings.commonstr.from+':&nbsp;&nbsp;'+ cityname +'</TD><TD width=175px>'+lang.General.to+':&nbsp;&nbsp;'+ TO +'</td><TD width=175px>'+lang.transport.status1+'</td>';
           m +='<TD width=60px><A onclick="traceEdit('+queueId+')">'+lang.General.edit+'</a></td><TD width=60px><A onclick="traceDelete('+queueId+')">'+lang.General.delete+'</a></td></tr>';
           m += '<TR><TD></td><TD>'+uW.g_js_strings.commonstr.troops+':&nbsp;&nbsp;'+uW.unitcost[unit][0]+'</td></tr>';
           if (r[i].ship_Food) m += '<TR><TD></td><TD align=center><img src="'+gameurl+'img/food_30.png"></td><TD>'+lang.transport.keep+': '+ addCommas(r[i].target_Food) +'</td><TD>'+lang.transport.trade+': '+ addCommas(r[i].trade_Food)+'</td>';
   				if (r[i].ship_Wood) m += '<TR><TD></td><TD align=center><img src="'+gameurl+'img/wood_30.png"></td><TD>'+lang.transport.keep+': '+ addCommas(r[i].target_Wood) +'</td><TD>'+lang.transport.trade+': '+ addCommas(r[i].trade_Wood)+'</td>';
   				if (r[i].ship_Stone) m += '<TR><TD></td><TD align=center><img src="'+gameurl+'img/stone_30.png"></td><TD>'+lang.transport.keep+': '+ addCommas(r[i].target_Stone) +'</td><TD>'+lang.transport.trade+': '+ addCommas(r[i].trade_Stone)+'</td>';
   				if (r[i].ship_Ore) m += '<TR><TD></td><TD align=center><img src="'+gameurl+'img/iron_30.png"></td><TD>'+lang.transport.keep+': '+ addCommas(r[i].target_Ore) +'</td><TD>'+lang.transport.trade+': '+ addCommas(r[i].trade_Ore)+'</td>';
   				if (r[i].ship_Astone) m += '<TR><TD></td><TD align=center><img src="'+gameurl+'img/aetherstone_30.png"></td><TD>'+lang.transport.keep+': '+ addCommas(r[i].target_Astone) +'</td><TD>'+lang.transport.trade+': '+ addCommas(r[i].trade_Astone)+'</td>';
   				if (r[i].ship_Gold) m += '<TR><TD></td><TD align=center><img src="'+gameurl+'img/gold_30.png"></td><TD>'+lang.transport.keep+': '+ addCommas(r[i].target_Gold) +'</td><TD>'+lang.transport.trade+': '+ addCommas(r[i].trade_Gold)+'</td>';
          }
   	     m +='</table>';
   	     ById('pbRoutesQueue').innerHTML= m;
   	     ById("BOTrpQG").addEventListener('click', function(){
   	      if (parseIntNan(Options.alertConfig.hq)>0) {

   	       var mavilleId=Cities.byID[Options.alertConfig.hq];
	       if (mavilleId) {
	        var r = t.tradeRoutes;
	        for (var i=0;i<(r.length);i++) {

	           r[i].target_x=mavilleId.x;


	            r[i].target_y=mavilleId.y;

	        }
	        t.showTradeRoutes();
	       }


   	      }

   	     },false);
          uW.traceEdit = t.editQueueElement;
          uW.traceDelete = t.cancelQueueElement;
   	    },

   	 cancelQueueElement: function(queueId){
   	     var t = Tabs.TranspAuto;
   	     var queueId = parseInt(queueId);
   	     t.tradeRoutes.splice(queueId, 1);
   	     t.showTradeRoutes();
   	 },

   	 editQueueElement: function(queueId){
   	     var t = Tabs.TranspAuto;
   	     var r = t.tradeRoutes;
          var queueId = parseInt(queueId);
   	     var cityname;
   	     var citynameTo = null;
   	     var Types = ['food','wood','stone','iron','aetherstone','gold'];
   	     for (var y=0; y< Seed.cities.length;y++) {
   					if ( parseInt(Seed.cities[y][0]) == r[queueId].city) var cityname = Seed.cities[y][1];
   					if ( parseInt(Seed.cities[y][2]) == r[queueId].target_x && parseInt(Seed.cities[y][3]) == r[queueId].target_y) var citynameTo = Seed.cities[y][1];
   			 }
          if (citynameTo == null) var TO = "x:<input type=text size=3 id='pbbtargetx' value='"+r[queueId].target_x+"'> y:<input type=text size=3 id='pbbtargety' value='"+r[queueId].target_y+"'>";
   			 else TO = citynameTo;
          var n = '<TABLE id=editRoutes class=pbTab>';
   	     n +='<TD>'+uW.g_js_strings.commonstr.from+' :&nbsp;'+ cityname +'</td><TD>'+lang.General.to+':&nbsp;'+ TO +'</td>';
   	     n +='<TD><INPUT id=TradeStatus type=checkbox>&nbsp;'+lang.transport.status1+'</td>';
   	     n += '<TD width=150px>'+uW.g_js_strings.commonstr.troops+' :<SELECT id="pbbTransportTroop">';
          for (y in uW.unitcost) n+='<option value="'+y+'">'+uW.unitcost[y][0]+'</option>';
          n+='</select></td></table><BR><TABLE  id=editRoutes class=pbTab>';
          for (var i=0;i<Types.length;i++){
   	    var icon = Types[i];
            n += '<TR><TD width=50px align=center><img src="'+gameurl+'img/'+icon+'_30.png"></td>';
            n += '<TD width=50px align=center><INPUT id=pbbship'+Types[i]+' type=checkbox></td>';
            n += '<TD width=125px>'+lang.transport.keep+' : <INPUT id=pbbtargetamount'+Types[i]+' type=text size=11 maxlength=15 value="0"></td>';
            n += '<TD width=125px>'+lang.transport.trade+' : <INPUT id=pbbtradeamount'+Types[i]+' type=text size=11 maxlength=15 value="0"\></td></tr>';
          }
          n+='</table><BR><TABLE id=editRoutes class=pbTab><TR><TD><a class="button20" id="Cancel"><span>'+uW.g_js_strings.commonstr.cancel+'</span></a></td>';
          n+='<TD><a class="button20" id="Save"><span>'+lang.General.save+'</span></a></td></tr>';
          n +='</table>';

          ById('pbRoutesQueue').innerHTML= n;
          ById('TradeStatus').checked = r[queueId].route_state;
          if (r[queueId].TroopType == undefined) var unit = 'unt9';
          else var unit = r[queueId].TroopType;
          ById('pbbTransportTroop').value = unit;
	         ById('pbbshipfood').checked = r[queueId].ship_Food;
	         ById('pbbshipwood').checked = r[queueId].ship_Wood;
	         ById('pbbshipstone').checked = r[queueId].ship_Stone;
	         ById('pbbshipiron').checked = r[queueId].ship_Ore;
	  	     ById('pbbshipaetherstone').checked = r[queueId].ship_Astone;
	         ById('pbbshipgold').checked = r[queueId].ship_Gold;
	         ById('pbbtargetamountfood').value = r[queueId].target_Food;
	         ById('pbbtargetamountwood').value = r[queueId].target_Wood;
	         ById('pbbtargetamountstone').value = r[queueId].target_Stone;
	         ById('pbbtargetamountiron').value = r[queueId].target_Ore;
	  	     ById('pbbtargetamountaetherstone').value = r[queueId].target_Astone;
	         ById('pbbtargetamountgold').value = r[queueId].target_Gold;
	         ById('pbbtradeamountfood').value = r[queueId].trade_Food;
	         ById('pbbtradeamountwood').value = r[queueId].trade_Wood;
	         ById('pbbtradeamountstone').value = r[queueId].trade_Stone;
	         ById('pbbtradeamountiron').value = r[queueId].trade_Ore;
	  	     ById('pbbtradeamountaetherstone').value = r[queueId].trade_Astone;
	         ById('pbbtradeamountgold').value = r[queueId].trade_Gold;

	         ById('Cancel').addEventListener('click', function(){t.showTradeRoutes();}, false);
	         ById('Save').addEventListener('click', function(){
	              if (ById("pbbtargetx")) {

		 	   r[queueId].target_x = ById('pbbtargetx').value;
		 	   r[queueId].target_y = ById('pbbtargety').value;

	              }
	              r[queueId].route_state = ById('TradeStatus').checked;
	              r[queueId].TroopType = ById('pbbTransportTroop').value;
	              r[queueId].ship_Food = ById('pbbshipfood').checked;
	              r[queueId].ship_Wood = ById('pbbshipwood').checked;
	              r[queueId].ship_Stone = ById('pbbshipstone').checked;
	              r[queueId].ship_Ore = ById('pbbshipiron').checked;
	  			r[queueId].ship_Astone = ById('pbbshipaetherstone').checked;
	              r[queueId].ship_Gold = ById('pbbshipgold').checked;
	              r[queueId].target_Food = ById('pbbtargetamountfood').value;
	              r[queueId].target_Wood = ById('pbbtargetamountwood').value;
	              r[queueId].target_Stone = ById('pbbtargetamountstone').value;
	              r[queueId].target_Ore = ById('pbbtargetamountiron').value;
	  			r[queueId].target_Astone = ById('pbbtargetamountaetherstone').value;
	              r[queueId].target_Gold = ById('pbbtargetamountgold').value;
	              r[queueId].trade_Food = ById('pbbtradeamountfood').value;
	              r[queueId].trade_Wood = ById('pbbtradeamountwood').value;
	              r[queueId].trade_Stone = ById('pbbtradeamountstone').value;
	              r[queueId].trade_Ore = ById('pbbtradeamountiron').value;
	  			r[queueId].trade_Astone = ById('pbbtradeamountaetherstone').value;
	              r[queueId].trade_Gold = ById('pbbtradeamountgold').value;
	              t.showTradeRoutes();
	          }, false);
	 },

   	saveTradeRoutes: function(){
   		var t = Tabs.TranspAuto;
           var serverID = getServerId();
           GM_setValue('tradeRoutes_' + serverID, JSON2.stringify(t.tradeRoutes));
       },
     readTradeRoutes: function(){
           var t = Tabs.TranspAuto;
           var serverID = getServerId();
           s = GM_getValue('tradeRoutes_' + serverID);
           if (s != null) {
               route = JSON2.parse(s);
               for (k in route)
                   t.tradeRoutes[k] = route[k];
           }
       },
   	saveTraderState: function(){
   		var t = Tabs.TranspAuto;
           var serverID = getServerId();
           GM_setValue('traderState_' + serverID, JSON2.stringify(t.traderState));
       },
       readTraderState: function(){
           var t = Tabs.TranspAuto;
           var serverID = getServerId();
           s = GM_getValue('traderState_' + serverID);
           if (s != null) {
               state = JSON2.parse(s);
               for (k in state)
                   t.traderState[k] = state[k];
           }
       },
       toggleTraderState: function(obj){
   	   var t = Tabs.TranspAuto;
   	   obj = ById('pbTraderState');
           if (t.traderState.running == true) {
             t.traderState.running = false;
             if (obj)  obj.value = lang.transport.labTrp+' = OFF';
   	         if (Options.BORac_Trp) updatebotbutton(lang.transport.labTrp+' - OFF', 'pbtrantab');
   	         clearTimeout(t.checkdotradetimeout);
   	         clearTimeout(t.timer2);
   	         t.count = 0;
   	         Options.lasttransport = 0;
	         saveOptions();
           }
           else {
             t.traderState.running = true;
             if (obj) obj.value = lang.transport.labTrp+' = ON';
   		     if (Options.BORac_Trp) updatebotbutton(lang.transport.labTrp+' - ON', 'pbtrantab');
   			 t.e_tradeRoutes();
           }
       },

   	checkdoTrades: function(){
     	var t = Tabs.TranspAuto;
     	if (t.traderState.running == false) {
			clearTimeout(t.checkdotradetimeout);
			return;
		}
   	    if(t.tradeRoutes.length==0) return;
   	    t.doTrades(t.count);
   	    t.count++;
   	    if(t.count < t.tradeRoutes.length){
   			  t.checkdotradetimeout = setTimeout(function() { t.checkdoTrades();}, 10000);
   			} else {
   			  var now = new Date().getTime()/1000.0;
   			  now = now.toFixed(0);
   			  Options.lasttransport = now;
   			  saveOptions();
   			  t.count = 0;
	    }
   	},
    doTrades: function(count,tt){
      var t = Tabs.TranspAuto;
      if(!t.traderState.running) return;
      if(t.tradeRoutes.length==0) return;
      if(!t.tradeRoutes[count]["route_state"]) return;
      var city = t.tradeRoutes[count]["city"];
      if(!Cities.byID[city]) return;
	  var xcoord = t.tradeRoutes[count]["target_x"];
      var ycoord = t.tradeRoutes[count]["target_y"];
   	  var cityID = 'city' + city;
   	  for (var zz=0; zz< Seed.cities.length;zz++) {
	   if (parseInt(Seed.cities[zz][0]) == city)
	      var cityname = Seed.cities[zz][1];
	  }
      var rallypointlevel = March.RallyPoint(city).maxSlots;
      var slots = March.RallyPoint(city).marching;
	  if(slots >= rallypointlevel){
	    if (Options.LogsTransportAuto)actionLog("Transport","Transport de "+cityname+" vers " + xcoord + "," + ycoord + " <font color=red>Point de ralliement complet !</font>");
	    return;
      }
      var params = uW.Object.clone(uW.g_ajaxparams);
   		params.gold =0;
   		params.r1 =0;
   		params.r2 =0;
   		params.r3 =0;
   		params.r4 =0 ;
   		params.r5 =0 ;
   		params.kid = 0;
   		var carry_amount= 0,wagons_needed=0, citymax = 0;
       	var trade_Food = t.tradeRoutes[count]["trade_Food"];
       	var trade_Wood = t.tradeRoutes[count]["trade_Wood"];
       	var trade_Stone = t.tradeRoutes[count]["trade_Stone"];
       	var trade_Ore = t.tradeRoutes[count]["trade_Ore"];
   	    var trade_Astone = t.tradeRoutes[count]["trade_Astone"];
       	var trade_Gold = t.tradeRoutes[count]["trade_Gold"];
       	var target_Food = t.tradeRoutes[count]["target_Food"];
       	var target_Wood = t.tradeRoutes[count]["target_Wood"];
       	var target_Stone = t.tradeRoutes[count]["target_Stone"];
       	var target_Ore = t.tradeRoutes[count]["target_Ore"];
   		var target_Astone = t.tradeRoutes[count]["target_Astone"];
       	var target_Gold = t.tradeRoutes[count]["target_Gold"];
       	var ship_Food = t.tradeRoutes[count]["ship_Food"];
       	var ship_Wood = t.tradeRoutes[count]["ship_Wood"];
       	var ship_Stone = t.tradeRoutes[count]["ship_Stone"];
       	var ship_Ore = t.tradeRoutes[count]["ship_Ore"];
   		var ship_Astone = t.tradeRoutes[count]["ship_Astone"];
       	var ship_Gold = t.tradeRoutes[count]["ship_Gold"];
       	var citymax_Food = parseIntNan(Seed.resources[cityID]['rec1'][0] / 3600);
       	var citymax_Wood = parseIntNan(Seed.resources[cityID]['rec2'][0] / 3600);
       	var citymax_Stone = parseIntNan(Seed.resources[cityID]['rec3'][0] / 3600);
       	var citymax_Ore = parseIntNan(Seed.resources[cityID]['rec4'][0] / 3600);
   		var citymax_Astone = parseIntNan(Seed.resources[cityID]['rec5'][0]);
       	var citymax_Gold = parseIntNan(Seed.citystats[cityID]['gold']);
       	var carry_Food = parseIntNan(citymax_Food - target_Food);
       	var carry_Wood = parseIntNan(citymax_Wood - target_Wood);
       	var carry_Stone = parseIntNan(citymax_Stone - target_Stone);
       	var carry_Ore = parseIntNan(citymax_Ore - target_Ore);
   		var carry_Astone = parseIntNan(citymax_Astone - target_Astone);
       	var carry_Gold = 0;
       	if (carry_Food < 0 || ship_Food==false) carry_Food = 0;
       	if (carry_Wood < 0 || ship_Wood==false) carry_Wood = 0;
       	if (carry_Stone < 0 || ship_Stone==false) carry_Stone = 0;
       	if (carry_Ore < 0 || ship_Ore==false) carry_Ore = 0;
   		if (carry_Astone < 0 || ship_Astone==false) carry_Astone = 0;
       	if (trade_Food > 0 && (carry_Food > trade_Food)) carry_Food = parseIntNan(trade_Food);
       	if (trade_Wood > 0 && (carry_Wood > trade_Wood)) carry_Wood = parseIntNan(trade_Wood);
       	if (trade_Stone > 0 && (carry_Stone > trade_Stone)) carry_Stone = parseIntNan(trade_Stone);
       	if (trade_Ore > 0 && (carry_Ore > trade_Ore)) carry_Ore = parseIntNan(trade_Ore);
     	if (trade_Astone > 0 && (carry_Astone > trade_Astone)) carry_Astone = parseIntNan(trade_Astone);
   		carry_Astone *= 5;
         if (t.tradeRoutes[count]['TroopType'] == undefined) var wagons = parseInt(Seed.units[cityID]['unt'+ 9]);
         else var wagons =  parseInt(Seed.units[cityID][t.tradeRoutes[count]['TroopType']]);
         var maxtroupe=March.RallyPoint(city).maxSize;
       	 if (parseInt(wagons) > parseInt(maxtroupe)){ wagons = maxtroupe; }
         if (t.tradeRoutes[count]['TroopType'] == undefined) var unit = 'unt9';
         else var unit = t.tradeRoutes[count]['TroopType'];
         var Troops = parseInt(Seed.units[cityID][unit]);
   	     if(parseInt(Troops)>parseInt(wagons)) Troops = wagons;
   		  var maxloadperwagon = getMaxLoad(unit.substr(3),1);
      	  var maxload = getMaxLoad(unit.substr(3),Troops);
   		  if(wagons <= 0) {return; }
   		  for (var t=0; t< Seed.cities.length;t++) if ( parseInt(Seed.cities[t][0]) == city) var cityname = Seed.cities[t][1];
     	  var shift_Food = parseIntNan(Math.floor(maxload / 9)); //Total of 9 portions
		  var shift_Wood = parseIntNan(Math.floor(maxload / 9));
		  var shift_Stone = parseIntNan(Math.floor(maxload / 9));
		  var shift_Ore = parseIntNan(Math.floor(maxload / 9));
		  var shift_Astone = parseIntNan(Math.floor(maxload / 9 * 5)); //Aetherstone takes 5 of 9 portions
   		  if ((maxload - carry_Food - carry_Wood - carry_Stone - carry_Ore - carry_Astone) < 0){
   			 var shift_num=0;
   			 var shift_spare=0;
   			if (carry_Food < shift_Food) {
   				shift_spare += (shift_Food - carry_Food);
   				shift_Food = carry_Food;
   			}
   			if (carry_Wood < shift_Wood) {
   				shift_spare += (shift_Wood - carry_Wood);
   				shift_Wood = carry_Wood;
   			}
   			if (carry_Stone < shift_Stone) {
   				shift_spare += (shift_Stone - carry_Stone);
   				shift_Stone = carry_Stone;
   			}
   			if (carry_Ore < shift_Ore) {
   				shift_spare += (shift_Ore - carry_Ore);
   				shift_Ore = carry_Ore;
   			}
               if (carry_Astone < shift_Astone) {
   				shift_spare += (shift_Astone - carry_Astone);
   				shift_Astone = carry_Astone;
   			}

   		  while (shift_spare >1) {
   				 if (carry_Food < (shift_Food + shift_spare)){
   				    shift_spare = shift_spare - carry_Food;;
   				    shift_Food = carry_Food;
   				 }
   				 else{
   				  shift_Food = (shift_Food + shift_spare);
   				  shift_spare = shift_spare- shift_spare;
   				}
   				 if (carry_Wood < (shift_Wood + shift_spare)){
   				    shift_spare = shift_spare - carry_Wood;;
   				    shift_Wood = carry_Wood;
   				 }
   				 else{
   				  shift_Wood = shift_Wood + shift_spare;
   				  shift_spare = shift_spare- shift_spare;
   				}
           		if (carry_Stone < (shift_Stone + shift_spare)){
   				    shift_spare = shift_spare - carry_Stone;
   				    shift_Stone = carry_Stone;
   				 }
   				 else{
   				  shift_Stone = shift_Stone + shift_spare;
   				  shift_spare = shift_spare- shift_spare;
   				}
   				 if (carry_Ore < (shift_Ore + shift_spare)){
   				    shift_spare = shift_spare - carry_Ore;
   				    shift_Ore = carry_Ore;
   				 }
   				 else{
   				  shift_Ore = shift_Ore + shift_spare;
   				  shift_spare = shift_spare- shift_spare;
   				}
   				if (carry_Astone < (shift_Astone + shift_spare)){
   				    shift_spare = shift_spare - carry_Astone;
   				    shift_Astone = carry_Astone;
   				 }
   				 else{
   				  shift_Astone = shift_Astone + shift_spare;
   				  shift_spare = shift_spare- shift_spare;
   				}
   			 }

   		carry_Food = shift_Food;
   		carry_Wood = shift_Wood;
   		carry_Stone = shift_Stone;
   		carry_Ore = shift_Ore;
   		carry_Astone = shift_Astone;
   		}

   		if (maxload > (carry_Food + carry_Wood + carry_Stone + carry_Ore + carry_Astone) && ship_Gold==true) {
   		    if ((maxload-(carry_Food + carry_Wood + carry_Stone + carry_Ore + carry_Astone)) > (citymax_Gold - target_Gold)){
   		    	  carry_Gold = (citymax_Gold - target_Gold);
   		    	  if (carry_Gold < 0 ) carry_Gold = 0;
   		   	}
   		    else carry_Gold = (maxload-(carry_Food + carry_Wood + carry_Stone + carry_Ore + carry_Astone));
   		    if (trade_Gold > 0 && (carry_Gold > trade_Gold)) carry_Gold = parseInt(trade_Gold);
   		}

   		wagons_needed = ((carry_Food + carry_Wood + carry_Stone + carry_Ore + carry_Astone + carry_Gold) / maxloadperwagon);
   		wagons_needed = wagons_needed.toFixed(0);
   		if (wagons_needed < ((carry_Food + carry_Wood + carry_Stone + carry_Ore + carry_Astone + carry_Gold) / maxloadperwagon)) wagons_needed++;
   		if ( wagons_needed < Options.minwagons ) { return; }

   		params.cid= city;
   		params.type = "1";
   		params.xcoord = xcoord;
   		params.ycoord = ycoord;
   		params.r1 = carry_Food;
   		params.r2 = carry_Wood;
   		params.r3 = carry_Stone;
   		params.r4 = carry_Ore;
   		params.r5 = parseInt(carry_Astone/5);
   		params.gold = carry_Gold;

   		switch (unit){
         case 'unt1': params.u1 = wagons_needed;break;
         case 'unt2': params.u2 = wagons_needed;break;
         case 'unt3': params.u3 = wagons_needed;break;
         case 'unt4': params.u4 = wagons_needed;break;
         case 'unt5': params.u5 = wagons_needed;break;
         case 'unt6': params.u6 = wagons_needed;break;
         case 'unt7': params.u7 = wagons_needed;break;
         case 'unt8': params.u8 = wagons_needed;break;
         case 'unt9': params.u9 = wagons_needed;break;
         case 'unt10': params.u10 = wagons_needed;break;
         case 'unt11': params.u11 = wagons_needed;break;
         case 'unt12': params.u12 = wagons_needed;break;
         case 'unt13': params.u13 = wagons_needed;break;
         case 'unt14': params.u14 = wagons_needed;break;
         case 'unt15': params.u15 = wagons_needed;break;
       }
      if ((carry_Food + carry_Wood + carry_Stone + carry_Ore + carry_Astone + carry_Gold) > 0) {

      var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
            new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
                     method: "post",
                     parameters: params,
                     loading: true,
                     onSuccess: function (transport) {
						 profiler.stop();
                     var rslt = eval("(" + transport.responseText + ")");
                     if (rslt.ok) {
                     var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
                     var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
                     var ut = unsafeWindow.unixtime();
                     var unitsarr = [];
            	 	 for (j in uW.unitcost) unitsarr.push(0);
                     for(i = 1; i <= unitsarr.length; i++){
                     	if(params["u"+i]){
                     	unitsarr[i] = params["u"+i];
                     	}
                     }
                     var resources=new Array();
                     resources[0] = params.gold;
                     for(i=1; i<=5; i++){
                     	resources[i] = params["r"+i];
                     }
                     var currentcityid = city;
                     unsafeWindow.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
                     if(rslt.updateSeed){unsafeWindow.update_seed(rslt.updateSeed)};
                      if (Options.LogsTransportAuto)actionLog("Transport","Depuis: " + cityname + " Vers : " + xcoord + ',' + ycoord + "  -> "+ unsafeWindow.unitcost[unit][0] +": " + wagons_needed);
                     } else {
						 if (rslt.user_action) {
							if (Options.LogsTransportAuto)actionLog("Transport","<b><font color=red>Alert : "+rslt.user_action+"</font></b>");
					 	    if (rslt.user_action == "backOffWaitTime") {
							 if(rslt.tt)
						 		p.tt = rslt.tt;
						  	var wait = 1;
						  	if(rslt.wait_time)
						  	wait = rslt.wait_time;
						  	setTimeout (function(){t.doTrades(count,tt);}, wait*1000);
						  	return;
						  	}

					     }

                     }
                     },
                     onFailure: function (transport) {
						 profiler.stop();
                         if (Options.LogsTransportAuto)if (Options.LogsTransportAuto)actionLog("Transport","Depuis: " + cityname + " Vers : " + xcoord + ',' + ycoord + "<br><font color=red>" + transport.responseText + "</font>");
                     }
             });
           }
   	},

   ManualTransport: function(){
    var t = Tabs.TranspAuto;
    if (ById ('ptcityX').value == "" || ById ('ptcityY').value == "") return;
    if (t.TroopsNeeded > t.Troops) return;
    var params = uW.Object.clone(uW.g_ajaxparams);
    var unitType=ById('TransportTroop').value;
    unitid = unitType.substr(3);
    var LoadUnit=getMaxLoad(unitid,1);
    var MaxLoad = getMaxLoad(unitid,parseInt(Seed.units['city' + t.tcp.city.id][unitType]));
    ById ('errorSpace').innerHTML = '';
  	params.kid = 0;
    params.cid=  t.tcp.city.id;
   	params.type = "1";
   	params.xcoord = parseInt(ById ('ptcityX').value);
   	params.ycoord = parseInt(ById ('ptcityY').value);
   	params.r1 = parseInt(ById ('pbtradeamountFood').value);
   	params.r2 = parseInt(ById ('pbtradeamountWood').value);
   	params.r3 = parseInt(ById ('pbtradeamountStone').value);
   	params.r4 = parseInt(ById ('pbtradeamountOre').value);
   	params.r5 = parseInt(ById ('pbtradeamountAstone').value);
   	params.gold = parseInt(ById ('pbtradeamountGold').value);
    switch (unitType){
         case 'unt1': params.u1 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt2': params.u2 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt3': params.u3 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt4': params.u4 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt5': params.u5 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt6': params.u6 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt7': params.u7 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt8': params.u8 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt9': params.u9 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt10': params.u10 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt11': params.u11 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt12': params.u12 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt13': params.u13 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt13': params.u13 = parseInt(ById ('TroopsToSend').value);break;
		 case 'unt14': params.u14 = parseInt(ById ('TroopsToSend').value);break;
		 case 'unt15': params.u15 = parseInt(ById ('TroopsToSend').value);break;
	     case 'unt16': params.u16 = parseInt(ById ('TroopsToSend').value);break;
         case 'unt17': params.u17 = parseInt(ById ('TroopsToSend').value);break;
       }

       if ((params.r1 + params.r2 + params.r3 + params.r4 + params.r5 + params.gold) > 0) {
		   var profiler = new unsafeWindow.cm.Profiler("ResponseTime", "march.php");
            new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/march.php" + unsafeWindow.g_ajaxsuffix, {
                     method: "post",
                     parameters: params,
                     loading: true,
                     onSuccess: function (transport) {
						  profiler.stop();
                     var rslt = eval("(" + transport.responseText + ")");
                     if (rslt.ok) {
   		                  var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
   		                  var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
   		                  var ut = unixTime();
   		                  var unitsarr = [];
            	 			for (j in uW.unitcost) unitsarr.push(0);
   		                  for(i = 1; i <= unitsarr.length; i++)if(params["u"+i])unitsarr[i] = params["u"+i];
   		                  var resources=new Array();
   		                  resources[0] = params.gold;
   		                  for(i=1; i<=5; i++)resources[i] = params["r"+i];
   		                  var currentcityid = t.tcp.city.id;
   		                  uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
   		                  if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
   		                  ById('errorSpace').innerHTML = 'Envoy&eacute;: ' + addCommas(params.r1+params.r2+params.r3+params.r4+params.r5+params.gold) + ' Ressources avec ' + addCommas(parseInt(ById('TroopsToSend').value)) + ' ' + unsafeWindow.unitcost[unitType][0];
   		                  ById('pbtradeamountFood').value = 0;
   		                  ById('pbtradeamountWood').value = 0;
   		                  ById('pbtradeamountStone').value = 0;
   		                  ById('pbtradeamountOre').value = 0;
   						  ById('pbtradeamountAstone').value = 0;
   		                  ById('pbtradeamountGold').value = 0;
   		                  ById('TroopsToSend').value = 0;
                     } else {
						 if (rslt.user_action) {
							   ById('errorSpace').innerHTML ="<b><font color=red>Alert : "+rslt.user_action+"</font></b>";
						 					 	if (rslt.user_action == "backOffWaitTime") {
						 							if(rslt.tt)
						 							var tt = rslt.tt;
						 							var wait = 1;
						 							if(rslt.wait_time)
						 	 						wait = rslt.wait_time;
						 							setTimeout (function(){t.ManualTransport(tt);}, wait*1000);
						 							return;
						 					    }
						}
		                var errorcode =  'err_' + rslt.error_code;
   		                if (rlst.msg == undefined)ById('errorSpace').innerHTML = '<HR><FONT COLOR=red>Error: ' + unsafeWindow.g_js_strings.errorcode[errorcode] +'</font>';
   		                else ById('errorSpace').innerHTML = '<HR><FONT COLOR=red>Erreur : ' + rslt.msg +'</font>';
                     }
                     },
                     onFailure: function () { profiler.stop();}
             });
           }
   	},

  onUnload: function(){
     var t = Tabs.TranspAuto;
     if (!ResetAll) t.saveTradeRoutes();
     if (!ResetAll) t.saveTraderState();
     if (!ResetAll) t.saveReapproState();
  },
  showManuel : function() {
   var t = Tabs.TranspAuto
   var rownum = 0;

   var ModelCity = {};

   function _row (name, row, noTotal){
      if (rownum++ % 2)
        style = '';
      else
        style = ' style = "background: #e8e8e8"';
      var tot = 0;
      var m = [];
      m.push ('<TR style="background: #fff" align=right');
      m.push (style);
      m.push ('><TD');
      m.push (style);
      m.push ('><B>');
      m.push (name);
      m.push ('</td>');
      if (noTotal){
        m.push ('<TD');
        m.push (style);
        m.push ('>&nbsp;</td>');
      } else {
        for (i=0; i<row.length; i++)
          tot += row[i];
        m.push ('<TD style="background: #ffc">');
        m.push (UniteKMG(tot));
        m.push ('</td>');
      }
      for (i=0; i<row.length; i++){
        m.push ('<TD');
        m.push (style);
        m.push ('>');
        m.push (UniteKMG(row[i]));
        m.push ('</td>');
      }
      m.push ('</tr>');
      return m.join('');
    }
    dt = new Date ();
    dt.setTime (Seed.player.datejoinUnixTime * 1000);
    if (t.state == null) {
      m = '<DIV class=boStat>'+lang.transport.titleManuel+'</div>';

      m += "<TABLE width=100% class=ptTab border=0>\
       <tr align=center valign=top><td colspan=1 width=50%><b><u>"+lang.General.source+"</b></u><br><span id=srcptspeedcity></span></td>\
       <td colspan=1 width=50%  rowspan=2><b><u>"+lang.General.dest+"</b></u><br><span id=desptspeedcity></span><br>\
       <a id=boclickmap href='javascript:void(0);'>"+lang.transport.typetrpx+"</a> <br>X: <input type=text size=4 id=typetrpx value=0>&nbsp;Y: <input type=text size=4 id=typetrpy value=0><br><a href='javascript:void(0);' id='chargelistelieux'>Membres</a> : <select id='BOlisteFavori'></select><br><br><INPUT id='ptttButTransport' type=submit value='"+uW.g_js_strings.commonstr.transport+"' style='font-weight:bold'>\
       </td></tr>\
       <tr align=center><td colspan=1>"+uW.g_js_strings.commonstr.troops+" : <select id=typetrp>";
        var l=0;
	      for (y in uW.unitcost) {
	   		 l++;
	   		 if (l==9)
	   		  m+='<option selected value="'+l+'">'+uW.unitcost[y][0]+'</option>';
	   		 else
	   		  m+='<option value="'+l+'">'+uW.unitcost[y][0]+'</option>';
       }

       m+="</select><br>"+uW.g_js_strings.commonstr.quantity+": <input type=text size=6 value='1000' id='Choixnbwagon'><input type=button id='trswagmax' value='Max'\><br><i>"+lang.transport.trswagmax+"</i>\
       <br><b>"+uW.g_js_strings.commonstr.resources+":</b><input type=radio id='ChoixRess0' name='ChoixRess' value='gold' style='visibility:hidden'><img src="+gameurl+"img/gold_30.png onclick=document.getElementById('ChoixRess0').checked=true;BOestimeres(); height=20>\
       <input type=radio id='ChoixRess1' name='ChoixRess' value='rec1' style='visibility:hidden'><img src="+gameurl+"img/food_30.png onclick=document.getElementById('ChoixRess1').checked=true;BOestimeres(); height=20>\
       <input type=radio id='ChoixRess2' name='ChoixRess' value='rec2' style='visibility:hidden'><img src="+gameurl+"img/wood_30.png onclick=document.getElementById('ChoixRess2').checked=true;BOestimeres(); height=20>\
       <input type=radio id='ChoixRess3' name='ChoixRess' value='rec3' style='visibility:hidden'><img src="+gameurl+"img/stone_30.png onclick=document.getElementById('ChoixRess3').checked=true;BOestimeres(); height=20>\
       <input type=radio id='ChoixRess4' name='ChoixRess' value='rec4' style='visibility:hidden'><img src="+gameurl+"img/iron_30.png onclick=document.getElementById('ChoixRess4').checked=true;BOestimeres(); height=20>\
       <input type=radio id='ChoixRess5' name='ChoixRess' value='rec5' style='visibility:hidden'><img src="+gameurl+"img/aetherstone_30.png onclick=document.getElementById('ChoixRess5').checked=true;BOestimeres(); height=20>\
       </td></tr>\
       <tr><td colspan=2>"+lang.transport.BOEstimationR+"<span id=BOEstimationR></td></tr>\
       </table>\
       <TABLE align=center width=100% class=ptTab><TR><TD><div id=ptTranportStatus style='text-align:center;overflow-y:auto; max-height:40px; height: 40px;'></div></td></tr></table>";
           m +="<DIV class=boStat>"+lang.transport.titleManuel+"</div><div id='statpourTr'></div>";
    t.TransportDiv.innerHTML = m;
    t.destinationCityx = ById ('typetrpx');
    t.destinationCityy = ById ('typetrpy');

    t.destinationCityx.addEventListener ('change', t.estimerRes, false);
    t.destinationCityy.addEventListener ('change', t.estimerRes, false);
    ById ('ChoixRess0').addEventListener ('click', t.estimerRes, false);
    ById ('ChoixRess1').addEventListener ('click', t.estimerRes, false);
    ById ('ChoixRess2').addEventListener ('click', t.estimerRes, false);
    ById ('ChoixRess3').addEventListener ('click', t.estimerRes, false);
    ById ('ChoixRess4').addEventListener ('click', t.estimerRes, false);
    ById ('ChoixRess5').addEventListener ('click', t.estimerRes, false);
    t.listeFavoris = ById ('BOlisteFavori');
    t.estimationRes = ById ('BOEstimationR');
    t.chargelistelieux = ById ('chargelistelieux');
    t.chargelistelieux.addEventListener ('click', t.chercherFavoris, false);
    t.listeFavoris.addEventListener ('change', t.SelectFavoris, false);
    var dcp1 = new CdispCityPicker ('ptspeed1', ById('desptspeedcity'), false, t.clickCityDestinationSelect, 1);
    t.TTbutTransport = ById ('ptttButTransport');
    t.TTbutTransport.addEventListener ('click', t.clickTransportDo, false);
    t.divTranportStatus = ById ('ptTranportStatus');
    t.statpourTr = ById ('statpourTr');
    t.typetrp = ById ('typetrp');
    t.typetrp.addEventListener ('click', t.estimerRes, false);
    t.trswagmax = ById ('trswagmax');
    t.trswagmax.addEventListener ('click', t.clickUniteMax, false);
    t.Choixnbwagon  = ById ('Choixnbwagon');
    t.Choixnbwagon.addEventListener ('keyup', t.verifierWagons, false);
    ById("boclickmap").addEventListener ('click',t.clickmap, false);
    var dcp0 = new CdispCityPicker ('ptspeed0', ById('srcptspeedcity'), false, t.clickCitySourceSelect, Cities.byID[unsafeWindow.currentcityid].idx);
    t.state = 1;
   }
   if (t.state == 1) {
    if (ById ('maparea_map').style.display!="none") {
       t.destinationCityx.value = ById ('mapXCoor').value;
       t.destinationCityy.value = ById ('mapYCoor').value;
       t.destinationCityx.style.backgroundColor="#FF9999";
       t.destinationCityy.style.backgroundColor="#FF9999";
       setTimeout(function() {
             t.destinationCityx.style.backgroundColor="#fff";
       t.destinationCityy.style.backgroundColor="#fff";
       }, 3000);

    }
    t.state = 2;
   }
   rows=[];
   rows[0]=[];
   m = "<TABLE class=ptTabLined cellspacing=0><TR valign=top align=right><TD width=65></td><TD width=88 style='background: #ffc'><B>TOTAL</b></td>";
      for(i=0; i<Cities.numCities; i++)
         m += '<TD width=81><B>'+ Cities.cities[i].name.substring(0,10) +'</b></td>';


       row = [];
     for(i=0; i<Cities.numCities; i++) {
    	 var cityId = 'city'+ Cities.cities[i].id;
    	 var slots=March.RallyPoint(Cities.cities[i].id).marching;

	     var niveauPointRall=March.RallyPoint(Cities.cities[i].id).maxSlots;
	    row[i] = '<SPAN><B>'+ slots +'/'+ niveauPointRall +'</b></span>';
    }
     m += _row (lang.Overview.march, row, true);
       m += '<TR><TD><font size=1><BR></td></tr>';

      for(i=0; i<Cities.numCities; i++) {
        cityID = 'city'+ Cities.cities[i].id;
        rows[0][i] = parseInt(Seed.citystats[cityID].gold[0]);
      }
      for (r=1; r<6; r++){
        rows[r] = [];
        for(i=0; i<Cities.numCities; i++) {
          cityID = 'city'+ Cities.cities[i].id;
           if (r==5)
	    rows[r][i] = parseInt(Seed.resources[cityID]['rec'+r][0]);
	            else
           rows[r][i] = parseInt(Seed.resources[cityID]['rec'+r][0] / 3600);
        }
      }
      m += _row ('<img height=20 src='+gameurl+'img/gold_30.png>', rows[0]);
      m += _row ('<img height=20 src='+gameurl+'img/food_30.png>', rows[1]);
      m += _row ('<img height=20 src='+gameurl+'img/wood_30.png>', rows[2]);
      m += _row ('<img height=20 src='+gameurl+'img/stone_30.png>', rows[3]);
      m += _row ('<img height=20 src='+gameurl+'img/iron_30.png>', rows[4]);
      m += _row ('<img height=20 src='+gameurl+'img/aetherstone_30.png>', rows[5]);
      m += '<TR><TD><font size=1><BR></td></tr>';
      row = [];
      var totalbouffe = 0;
      for(i=0; i<Cities.numCities; i++) {
	   var rp = getResourceProduction (Cities.cities[i].id);
 	   row[i] = rp[1];
      }
      m += _row ('Ent.', row, false);
      for(i=0; i<Cities.numCities; i++) {
                    if (row[i] >= 0)
                      row[i] = '----';
                    else {
                      var timeLeft = parseInt(Seed.resources["city" + Cities.cities[i].id]['rec1'][0]) / 3600 / (0-row[i]) * 3600;
                      if (timeLeft > 86313600)
                        row[i] = '----';
                      else {
                        if (Options.enableFoodWarn && timeLeft<(Options.foodWarnHours*3600))
                          row[i] = '<SPAN class=whiteOnRed>'+ timestrShort(timeLeft) +'</span>';
                        else
                          row[i] = timestrShort(timeLeft);
                      }
                    }
      }
      m += _row ('Aut.', row, true, 0);
      m += '<TR><TD><font size=1><BR></td></tr>';
    var r=0;
	for (y in uW.unitcost) {
		r++;
        rows[r] = [];
        for(i=0; i<Cities.numCities; i++) {
          cityID = 'city'+ Cities.cities[i].id;
          rows[r][i] = parseInt(Seed.units[cityID]['unt'+r]);
        }
      }
      m += _row ('<img height=20 title="'+uW.unitcost['unt1'][0]+'" src='+gameurl+'img/units/unit_1_30.jpg>', rows[1]);
      m += _row ('<img height=20 title="'+uW.unitcost['unt7'][0]+'" src='+gameurl+'img/units/unit_7_30.jpg>', rows[7]);
      m += _row ('<img height=20 title="'+uW.unitcost['unt8'][0]+'" src='+gameurl+'img/units/unit_8_30.jpg>', rows[8]);
      m += _row ('<img height=20 title="'+uW.unitcost['unt9'][0]+'" src='+gameurl+'img/units/unit_9_30.jpg>', rows[9]);

     m += "</table>";
    t.statpourTr.innerHTML = m;
    clearTimeout (t.displayTimer);
    t.displayTimer = setTimeout (t.showManuel, 5000);
  },

  SelectFavoris:function() {
   var t = Tabs.TranspAuto;
   if (t.listeFavoris.value!='') {
    var valeur=t.listeFavoris.value;
    var x=valeur.substr(0, valeur.lastIndexOf(','));
    var y=valeur.substr(valeur.lastIndexOf(',')+1, valeur.length);
    t.destinationCityx.value = x;
    t.destinationCityy.value = y;
   }
   t.estimerRes();
  },

  chercherFavoris: function() {
   var t = Tabs.TranspAuto;
   var myA = getMyAlliance ();
   if (myA[0]!=0) {
      var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
      params.perPage = 100;
      params.page = 1;params.type="might";
      params.allianceId = myA[0];
          new MyAjaxRequest(unsafeWindow.g_ajaxpath + "ajax/getUserLeaderboard.php" + unsafeWindow.g_ajaxsuffix, {
	        method: "post",
	        parameters: params,
	        onSuccess: function (rslt) {
	          if (rslt.ok){
	           var z=0;
	           var m="";
	           for (var i=0; i<rslt.results.length; i++){
     		      p = rslt.results[i];
		      if (p.userId != 0){
		       for (var c=0; c<p.cities.length; c++){
		         if (Seed.player.name!=p.displayName) {
		          m += "<option value='" + p.cities[c].xCoord + ","+ p.cities[c].yCoord+"'>" + p.displayName + " - "+unsafeWindow.g_js_strings.commonstr.city+" " + (c+1) + " - " + p.cities[c].xCoord + "," + p.cities[c].yCoord+"</option>";
		         }
		       }
		      }
      	            }
      	            t.listeFavoris.innerHTML="<option value=''>...</option>"+m;
	          }
	        },
	        onFailure: function (rslt) {
	          t.listeFavoris.innerHTML="<option>Error</option>";
	        },
    	});
   } else {
     t.listeFavoris.innerHTML="<option>"+lang.transport.noalliance+"</option>";
   }
  },
  verifierWagons: function() {
   var t = Tabs.TranspAuto;
   var maxw=parseInt(rows[t.typetrp.value][t.sourceCity.idx]);
   var saisw=parseInt(t.Choixnbwagon.value);
   if (saisw > maxw) {
      t.Choixnbwagon.value=maxw;
      t.divTranportStatus.innerHTML = '<FONT COLOR=#550000>'+lang.transport.err1+' '+maxw+' !.</font>';
   }
   t.estimerRes();
  },
  estimerRes: function() {
   var t = Tabs.TranspAuto;
   var cityID = 'city'+ t.sourceCity.id,ic=0,resact=0,ic_ty="gold",ic_text=" "+uW.g_js_strings.commonstr.gold;
   if (ById("ChoixRess1").checked) { ic_ty="rec1";ic=1;ic_text=" "+unsafeWindow.g_js_strings.commonstr.food; }
   if (ById("ChoixRess2").checked) { ic_ty="rec2";ic=2;ic_text=" "+uW.g_js_strings.commonstr.wood; }
   if (ById("ChoixRess3").checked) { ic_ty="rec3";ic=3;ic_text=" "+uW.g_js_strings.commonstr.stone; }
   if (ById("ChoixRess4").checked) { ic_ty="rec4";ic=4;ic_text=" "+uW.g_js_strings.commonstr.ore; }
   if (ById("ChoixRess5").checked) { ic_ty="rec5";ic=5;ic_text=" "+uW.g_js_strings.commonstr.aetherstone; }
   if (ById("ChoixRess0").checked) { ic_ty="gold";ic=0;ic_text=" "+uW.g_js_strings.commonstr.gold; }
   var esti = 0;

   var total_units=t.Choixnbwagon.value;
   var untid=t.typetrp.value;
   var esti = getMaxLoad(untid,total_units);
   if (ic==5) {
    esti = parseInt(esti / 5);
   }
   var x1 = parseInt(t.sourceCity.x);
   var x2 = parseInt(t.destinationCityx.value);
   var y1 = parseInt(t.sourceCity.y);
   var y2 = parseInt(t.destinationCityy.value);
   var dist = distance (x1, y1, x2, y2);
   var m = estETA(dist,ById('typetrp').value,t.sourceCity.id,1);
   var a="";
   switch(ic){
    case 0:a=unsafeWindow.g_js_strings.commonstr.gold;break;
    case 1:a=unsafeWindow.g_js_strings.commonstr.food;break;
    case 2:a=unsafeWindow.g_js_strings.commonstr.wood;break;
    case 3:a=unsafeWindow.g_js_strings.commonstr.stone;break;
    case 4:a=unsafeWindow.g_js_strings.commonstr.ore;break;
    case 5:a=unsafeWindow.g_js_strings.commonstr.aetherstone;break;
   }
   t.estimationRes.innerHTML = "<b>" + addCommas(esti) + " "+a+"</b>";
   t.estimationRes.innerHTML += "<br>"+lang.General.EstimateT+" : <b>" + m.friendEtaStr + "</b>" ;

     if (ic==5)
      resact = parseIntNan(Seed.resources[cityID][ic_ty][0]);
     else {
      if (ic==0)
       resact = parseIntNan(Seed.citystats[cityID].gold[0]);
      else
       resact = parseIntNan(Seed.resources[cityID][ic_ty][0] / 3600);
     }
    if (resact < esti) {
     var untid=t.typetrp.value;
     var nbparunit = getMaxLoad(untid,1);
     if (ic==5) nbparunit=nbparunit/5;
     var uniteness = Math.floor(resact / nbparunit);
     if (uniteness<1) uniteness=0;
     t.Choixnbwagon.value = uniteness;
     t.TTbutTransport.disabled = false;
     t.estimerRes();
    }
  },
  clickUniteMax: function() {
    var t = Tabs.TranspAuto;
    var maxw=parseInt(rows[t.typetrp.value][t.sourceCity.idx]);
    var maxtroupe=March.RallyPoint(t.sourceCity.id).maxSize; //Math.floor(maxtroupe*(1+q/100));
    if (maxw>maxtroupe) maxw=maxtroupe;
    t.Choixnbwagon.value=maxw;
    t.estimerRes();
  },
  clickTransportDo: function(tt) {
   var t = Tabs.TranspAuto;
   var SourceId = t.sourceCity.id;
   var DestinationId = t.destinationCity.id;
   if (!ById("ChoixRess0").checked && !ById("ChoixRess1").checked && !ById("ChoixRess2").checked && !ById("ChoixRess3").checked && !ById("ChoixRess4").checked && !ById("ChoixRess5").checked) {
       t.divTranportStatus.innerHTML = '<FONT COLOR=#550000>'+lang.transport.err2+'</font>';
      return;
   }
   if (t.sourceCity.x==t.destinationCityx.value && t.sourceCity.y==t.destinationCityy.value) {
      t.divTranportStatus.innerHTML = '<FONT COLOR=#550000>'+lang.transport.err3+'</font>';
     return;
   }
   if (parseInt(t.Choixnbwagon.value)<=0) {
   t.divTranportStatus.innerHTML = '<FONT COLOR=#550000>'+uW.g_js_strings.modal_attack_do.sendtroop+'</font>';
     return;
   }
   var x=t.destinationCityx.value;
   var y=t.destinationCityy.value;
   if (x == 0 && y == 0) {
      t.divTranportStatus.innerHTML = '<FONT COLOR=#550000>'+lang.transport.err4+'</font>';
     return;
   }
   t.TTbutTransport.disabled=true;
   var params = unsafeWindow.Object.clone(unsafeWindow.g_ajaxparams);
   params.cid= t.sourceCity.id;
   params.type = 1;
   params.kid = 0;
   params.xcoord = x;
   params.ycoord = y;

   var esti = getMaxLoad(t.typetrp.value,t.Choixnbwagon.value) - 1; // Fix transport !
   if (ById("ChoixRess5").checked) {
    esti = parseInt(esti / 5);
   }
   params.gold = 0;
   params.r1 = 0;
   params.r2 = 0;
   params.r3 = 0;
   params.r4 = 0;
   params.r5 = 0;
   var r=0;
   for (y in uW.unitcost) {
      	r++;
          params['u'+r]=0;
   }
   params["u"+t.typetrp.value] = t.Choixnbwagon.value;
   if (ById("ChoixRess0").checked) { params.gold = esti; }
   if (ById("ChoixRess1").checked) { params.r1 = esti; }
   if (ById("ChoixRess2").checked) { params.r2 = esti; }
   if (ById("ChoixRess3").checked) { params.r3 = esti; }
   if (ById("ChoixRess4").checked) { params.r4 = esti; }
   if (ById("ChoixRess5").checked) { params.r5 = esti; }

   t.divTranportStatus.innerHTML = "<i><b>"+uW.g_js_strings.commonstr.loadingddd+"....</b></i>";

   var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
   new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
              method: "post",
              parameters: params,
              loading: true,
              onSuccess: function (transport) {
				  profiler.stop();
                  var t = Tabs.TranspAuto;
                  var rslt = eval("(" + transport.responseText + ")");
                  if (rslt.ok) {
		           var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
		           var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
                   var ut = unsafeWindow.unixtime();
                   var unitsarr = [];
            	 for (j in uW.unitcost) unitsarr.push(0);
                   for(i = 1; i <= unitsarr.length; i++){
                   	if(params["u"+i]){
                  	unitsarr[i] = params["u"+i];
                  	}
                   }
                   var resources=new Array();
                   resources[0] = params.gold;
                   for(i=1; i<=4; i++){
                  	resources[i] = params["r"+i];
                   }
                   var currentcityid =  t.sourceCity.id;
                   uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
                   if(rslt.updateSeed){unsafeWindow.update_seed(rslt.updateSeed)};
                   t.divTranportStatus.innerHTML = "<font size='3px'><b>"+lang.transport.trpdone+"</b>";
                   t.TTbutTransport.disabled=false;
        } else {
			 if (rslt.user_action) {
		               if (rslt.user_action == "backOffWaitTime") {
							if(rslt.tt)
							var tt = rslt.tt;
							var wait = 1;
							if(rslt.wait_time)
	 						wait = rslt.wait_time;
							setTimeout (function(){t.clickTransportDo(tt);}, wait*1000);
							return;
					    }
		     }
		     t.divTranportStatus.innerHTML ="<font color=red size='3px'><b>"+lang.transport.trperr+"<b></font>";
		     if (rslt.msg) {
		       t.divTranportStatus.innerHTML +="<br><font color=black size='2px'>" + rslt.msg +"</font>";
		       t.TTbutTransport.disabled=false;
         	 } else {
         	      t.divTranportStatus.innerHTML +="<br>"+lang.transport.trptryagain+"</font>";
         	      setTimeout(function() { t.clickTransportDo(); }, 2000);
         	 }
           }
         },
         onFailure: function (rslt) {
                   var t = Tabs.TranspAuto;
                   profiler.stop();
                   if (rslt.user_action) {
                    t.divTranportStatus.innerHTML ="<font color=red size='3px'><b>"+lang.transport.trperr+" "+rslt.user_action+"<b></font>";
                   } else {

                    t.divTranportStatus.innerHTML ="<font color=red size='3px'><b>"+lang.transport.trperr+"<b></font>";
                   }
                    t.TTbutTransport.disabled=false;
                  }
          });
  },
  clickCitySourceSelect : function (city){
    var t = Tabs.TranspAuto;
    t.sourceCity = city;
    t.TTbutTransport.disabled=false;
    var maxw=parseInt(rows[t.typetrp.value][t.sourceCity.idx]);
    var saisw=parseInt(t.Choixnbwagon.value);
    if (saisw > maxw)  t.Choixnbwagon.value=maxw;
    t.estimerRes();
   },
   clickCityDestinationSelect : function (city){
    var t = Tabs.TranspAuto;
    t.destinationCity = city;
    t.destinationCityx.value=t.destinationCity.x;
    t.destinationCityy.value=t.destinationCity.y;
    t.TTbutTransport.disabled=false;
    t.estimerRes();
   },

}
var troops = {1:'SupplyTroops',2:'Militiaman',3:'Scout',4:'Pikeman',5:'Swordsman',6:'Archer',7:'Cavalry',8:'HeavyCavalry',9:'SupplyWagon',10:'Ballista',11:'BatteringRam',12:'Catapult',13:'BloodThom',14:'Executioner',15:'SiegeWall',16:'FlameArcher',17:'Husar',};
Tabs.Reassign = {
 tabOrder: 8,
 tabLabel: uW.g_js_strings.commonstr.reassign,
 cont : null, displayTimer : null, state : null, curTabBut : null, curTabName : null, sourceCity : {},
 destinationCity : {},
 rows : [],
  timer: null,
  reassignState: [],
  lRE: [],
  reassignRoutes: [],
  rallypointlevel:null,
  count:0,
  check:false,
 show : function (){
 },
 hide : function (){
    var t = Tabs.Reassign;
    t.state = null;
    clearTimeout (t.displayTimer);
    clearTimeout (t.timer);
  },
  init : function (div){
   var t = Tabs.Reassign;
   t.cont = div;
   t.reassignState = { running: false,    };
   t.readReassignState();
   t.readReassignRoutes();
   t.e_reassignRoutes();
   if (Options.BORac_Rea) AddSubTabLink(lang.reassign.buttonlab, t.toggleReassignState, 'pbsigntab');
   if (t.reassignState.running == false) {
       if (Options.BORac_Rea) updatebotbutton(lang.reassign.buttonlab+' - OFF', 'pbsigntab');
   } else {
        if (Options.BORac_Rea) updatebotbutton(lang.reassign.buttonlab+' - ON', 'pbsigntab');
   }
   window.addEventListener('unload', t.onUnload, false);
   t.cont = div;
   t.cont.innerHTML = '<TABLE class=ptTab align=center><TR><TD><INPUT class=bopbSubtab ID=BoReeSubM type=submit value="'+lang.transport.manu+'"></td>\
             <TD><INPUT class=bopbSubtab ID=BoReeSubA type=submit  value="'+lang.transport.auto+'"></td></tr></table>\
         <DIV id="BoReeOutput" style="margin-top:5px; background-color:white; height:'+(Options.HauteurBoite-65)+'px;max-height:'+(Options.HauteurBoite-65)+'px;overflow-y:auto"></div>';
  t.ReassignDiv = ById('BoReeOutput');
  ById('BoReeSubA').addEventListener('click', e_butSubtab, false);
  ById('BoReeSubM').addEventListener('click', e_butSubtab, false);
  changeSubtab (ById('BoReeSubM'));
  function e_butSubtab (evt){
          changeSubtab (evt.target);
      }
  function changeSubtab (but){
          if (but == t.curTabBut)
            return;
          if (t.curTabBut){
            t.curTabBut.className='bopbSubtab';
            t.curTabBut.disabled=false;
          }
          t.curTabBut = but;
          but.className='bopbSubtab bopbSubtabSel';
          but.disabled=true;
          t.curTabName = but.id.substr(8);
          t.show2();
      }

  },
   show2 : function (){
    var t = Tabs.Reassign ;
        t.state = null;
     clearTimeout (t.displayTimer);
     if (t.curTabName == 'M')
       t.showManuel();
     else
          t.showAuto();
     },

  showAuto: function() {
      var t = Tabs.Reassign ;
       clearTimeout (t.timer);
    if (t.state == null) {

      t.state = 1;

           var m = '<DIV id=pbReMainDivF class=boStat>'+lang.reassign.title+'</div><TABLE id=pbtraderfunctions width=100% height=0% class=pbTab><TR align="center">';
      if (t.reassignState.running == false) {
          m += '<TD><INPUT id=pbReassignState type=submit value="'+lang.reassign.buttonlab+'  = OFF"></td>';
	      if (Options.BORac_Rea)updatebotbutton(lang.reassign.buttonlab+' - OFF', 'pbsigntab');
      } else {
          m += '<TD><INPUT id=pbReassignState type=submit value="'+lang.reassign.buttonlab+'  = ON"></td>';
	      if (Options.BORac_Rea)updatebotbutton(lang.reassign.buttonlab+' - ON', 'pbsigntab');
      }
      m += '<TD><INPUT id=pbReassShowRoutes type=submit value="'+lang.reassign.showroute+'"></td>';
      m += '</tr></table></div>';
      m += '<DIV id=pbReassignDivD class=boStat>'+lang.reassign.addroute+'</div>';
      m += '<TABLE id=pbaddreasignroute width=95% height=0% class=pbTab><TR align="left">';
      m += '<TD width=20px>'+lang.reassign.from+'</td> <TD width=310px><DIV style="margin-bottom:10px;"><span id=ptassigncity></span></div></td></tr>';
      m += '<TR align="left">';
      m += '<TD width=20px>'+lang.reassign.to+'</td> <TD width=310px><DIV style="margin-bottom:10px;"><span id=ptassigncityTo></span></div></td>';
	  m += '<TR align="left">';
	  m += '<TD colspan=4>'+lang.reassign.pbreassigninterval+'<INPUT id=pbreassigninterval type=text size=2 value="'+Options.reassigninterval+'"\> '+lang.General.mins+'</td></tr>';
	  m += '<TR><TD colspan=4><INPUT id=autofilloff type=checkbox unchecked=true\> '+lang.reassign.autofilloff+'</TR></TD></table>';
      m += '';
      m += '<TABLE id=pbaddreasignroute width=100% height=0% class=pbTab><TR align="center">';
      m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_1_50.jpg?6545"></td>';
      m += '<TD>'+uW.unitcost['unt1'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_2_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt2'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_3_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt3'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_4_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt4'][0]+'</td></tr>'
      m += '<TR><TD><INPUT id=pbSupplyTroops type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetSupplyTroops disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbMilitiaman type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetMilitiaman disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbScout type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetScout disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbPikeman type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetPikeman disabled=true type=text size=10 maxlength=10 value="0"\></td></tr>';
      m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_5_50.jpg?6545"></td>';
      m += '<TD>'+uW.unitcost['unt5'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_6_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt6'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_7_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt7'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_8_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt8'][0]+'</td></tr>'
      m += '<TR><TD><INPUT id=pbSwordsman type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetSwordsman disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbArcher type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetArcher disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbCavalry type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetCavalry disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbHeavyCavalry type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetHeavyCavalry disabled=true type=text size=10 maxlength=10 value="0"\></td></tr>';
      m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_9_50.jpg?6545"></td>';
      m += '<TD>'+uW.unitcost['unt9'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_10_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt10'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_11_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt11'][0]+'</td>'
      m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_12_50.jpg?6545"></td>'
      m += '<TD>'+uW.unitcost['unt12'][0]+'</td>'
      m += '</tr><TR><TD><INPUT id=pbSupplyWagon type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetSupplyWagon disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbBallista type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetBallista disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbBatteringRam type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetBatteringRam disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '<TD><INPUT id=pbCatapult type=checkbox unchecked=true\>';
      m += '<INPUT id=pbtargetCatapult disabled=true type=text size=10 maxlength=10 value="0"\></td></tr>';
      m += '<tr><TD rowspan="2"><img src="'+gameurl+'img/units/unit_13_30.jpg?6545"></td>'
	  m += '<TD>'+uW.unitcost['unt13'][0]+'</td>'
	  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_14_30.jpg?6545"></td>'
	  m += '<TD>'+uW.unitcost['unt14'][0]+'</td>'
	  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_15_30.jpg?6545"></td>'
	  m += '<TD>'+uW.unitcost['unt15'][0]+'</td>'
	  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_16_30.jpg?6545"></td>'
	  m += '<TD>'+uW.unitcost['unt16'][0]+'</td>'
	  m += '</tr><TR>';
	  m += '<TD><INPUT id=pbBloodThom type=checkbox unchecked=true\><INPUT id=pbtargetBloodThom disabled=true type=text size=10 maxlength=10 value="0"\></td>';
	  m += '<TD><INPUT id=pbExecutioner type=checkbox unchecked=true\><INPUT id=pbtargetExecutioner disabled=true type=text size=10 maxlength=10 value="0"\></td>';
	  m += '<TD><INPUT id=pbSiegeWall type=checkbox unchecked=true\><INPUT id=pbtargetSiegeWall disabled=true type=text size=10 maxlength=10 value="0"\></td>';
	  m += '<TD><INPUT id=pbFlameArcher type=checkbox unchecked=true\><INPUT id=pbtargetFlameArcher disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m += '</tr>';
      m += '<tr><TD rowspan="2"><img src="'+gameurl+'img/units/unit_17_30.jpg?6545"></td>'
	  m += '<TD>'+uW.unitcost['unt17'][0]+'</td>'
	  m +='</tr><TR>';
	  m += '<TD><INPUT id=pbHusar type=checkbox unchecked=true\><INPUT id=pbtargetHusar disabled=true type=text size=10 maxlength=10 value="0"\></td>';
      m+= '</table>';
      m += '<DIV style="text-align:center; margin-top:15px"><INPUT id=pbSaveRouteReassign type=submit value="'+lang.reassign.pbSaveRouteReassign+'"></div>';
      t.ReassignDiv.innerHTML = m;
      t.tcp = new CdispCityPicker ('ptreassign', ById('ptassigncity'), true, null, 0);
	  t.tcpto = new CdispCityPicker ('ptreassignTo', ById('ptassigncityTo'), true);
	  for(var k in troops){
       if (uW.unitcost['unt'+k]) ById('pbtarget'+troops[k]).value = parseInt(Seed.units['city' + t.tcp.city.id]['unt'+k]);
	  }
      ById('ptassigncity').addEventListener('click', function(){
		  if(ById('autofilloff').checked == false)
	    for(var k in troops)
         if (uW.unitcost['unt'+k])
           ById('pbtarget'+troops[k]).value = parseInt(Seed.units['city' + t.tcp.city.id]['unt'+k]);
      }, false);

      ById('pbReassignState').addEventListener('click', function(){
      	t.toggleReassignState(this);
      }, false);
      ById('pbSaveRouteReassign').addEventListener('click', function(){
      t.addReassignRoute();
      }, false);
      ById('pbReassShowRoutes').addEventListener('click', function(){
      t.showReassignRoutes();
      }, false);

      ById('pbreassigninterval').addEventListener('keyup', function(){
		if (parseIntNan(ById('pbreassigninterval').value)<10){ ById('pbreassigninterval').value=10 ;}
		Options.reassigninterval = ById('pbreassigninterval').value;
		saveOptions();
      }, false);

      ById('pbtargetSupplyTroops').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetSupplyTroops').value)) ById('pbtargetSupplyTroops').value=0 ;
      }, false);
      ById('pbtargetMilitiaman').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetMilitiaman').value)) ById('pbtargetMilitiaman').value=0 ;
      }, false);
      ById('pbtargetScout').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetScout').value)) ById('pbtargetScout').value=0 ;
      }, false);
      ById('pbtargetPikeman').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetPikeman').value)) ById('pbtargetPikeman').value=0 ;
      }, false);
      ById('pbtargetSwordsman').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetSwordsman').value)) ById('pbtargetSwordsman').value=0 ;
      }, false);
      ById('pbtargetArcher').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetArcher').value)) ById('pbtargetArcher').value=0 ;
      }, false);
      ById('pbtargetCavalry').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetCavalry').value)) ById('pbtargetCavalry').value=0 ;
      }, false);
      ById('pbtargetHeavyCavalry').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetHeavyCavalry').value)) ById('pbtargetHeavyCavalry').value=0 ;
      }, false);
      ById('pbtargetSupplyWagon').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetSupplyWagon').value)) ById('pbtargetSupplyWagon').value=0 ;
      }, false);
      ById('pbtargetBallista').addEventListener('keyup', function(){
          if (isNaN(ById('pbtargetBallista').value)) ById('pbtargetBallista').value=0 ;
      }, false);
     ById('pbtargetBatteringRam').addEventListener('keyup', function(){
         if (isNaN(ById('pbtargetBatteringRam').value)) ById('pbtargetBatteringRam').value=0 ;
     }, false);
     ById('pbtargetCatapult').addEventListener('keyup', function(){
         if (isNaN(ById('pbtargetCatapult').value)) ById('pbtargetCatapult').value=0 ;
     }, false);
	 ById('pbtargetBloodThom').addEventListener('keyup', function(){
         if (isNaN(ById('pbtargetBloodThom').value)) ById('pbtargetBloodThom').value=0 ;
     }, false);
	 ById('pbtargetExecutioner').addEventListener('keyup', function(){
         if (isNaN(ById('pbtargetExecutioner').value)) ById('pbtargetExecutioner').value=0 ;
     }, false);
	 ById('pbtargetSiegeWall').addEventListener('keyup', function(){
         if (isNaN(ById('pbtargetSiegeWall').value)) ById('pbtargetSiegeWall').value=0 ;
     }, false);
 	 ById('pbtargetFlameArcher').addEventListener('keyup', function(){
         if (isNaN(ById('pbtargetFlameArcher').value)) ById('pbtargetFlameArcher').value=0 ;
     }, false);
     ById('pbtargetHusar').addEventListener('keyup', function(){
	      if (isNaN(ById('pbtargetFlameArcher').value)) ById('pbtargetHusar').value=0 ;
     }, false);
     ById('pbSupplyTroops').addEventListener('click', function(){
          if (ById('pbSupplyTroops').checked==false)
              ById('pbtargetSupplyTroops').disabled = true;
          else
            ById('pbtargetSupplyTroops').disabled = false;

      },false);
      ById('pbMilitiaman').addEventListener('click', function(){
          if (ById('pbMilitiaman').checked==false) {
              ById('pbtargetMilitiaman').disabled = true;
          }
          else {
            ById('pbtargetMilitiaman').disabled = false;
          }
      },false);
      ById('pbScout').addEventListener('click', function(){
          if (ById('pbScout').checked==false)ById('pbtargetScout').disabled = true;
          else ById('pbtargetScout').disabled = false;
      },false);
      ById('pbPikeman').addEventListener('click', function(){
          if (ById('pbPikeman').checked==false) {
              ById('pbtargetPikeman').disabled = true;
          }
          else {
            ById('pbtargetPikeman').disabled = false;
          }
      },false);
      ById('pbSwordsman').addEventListener('click', function(){
          if (ById('pbSwordsman').checked==false) {
              ById('pbtargetSwordsman').disabled = true;
          }
          else {
            ById('pbtargetSwordsman').disabled = false;
          }
      },false);
      ById('pbArcher').addEventListener('click', function(){
          if (ById('pbArcher').checked==false) {
              ById('pbtargetArcher').disabled = true;
          }
          else {
            ById('pbtargetArcher').disabled = false;
          }
      },false);
      ById('pbCavalry').addEventListener('click', function(){
          if (ById('pbCavalry').checked==false) {
              ById('pbtargetCavalry').disabled = true;
          }
          else {
            ById('pbtargetCavalry').disabled = false;
          }
      },false);
      ById('pbHeavyCavalry').addEventListener('click', function(){
          if (ById('pbHeavyCavalry').checked==false) {
              ById('pbtargetHeavyCavalry').disabled = true;
          }
          else {
            ById('pbtargetHeavyCavalry').disabled = false;
          }
      },false);
      ById('pbSupplyWagon').addEventListener('click', function(){
          if (ById('pbSupplyWagon').checked==false) {
              ById('pbtargetSupplyWagon').disabled = true;
          }
          else {
            ById('pbtargetSupplyWagon').disabled = false;
          }
      },false);
      ById('pbBallista').addEventListener('click', function(){
          if (ById('pbBallista').checked==false) {
              ById('pbtargetBallista').disabled = true;
          }
          else {
            ById('pbtargetBallista').disabled = false;
          }
      },false);
      ById('pbBatteringRam').addEventListener('click', function(){
          if (ById('pbBatteringRam').checked==false) {
              ById('pbtargetBatteringRam').disabled = true;
          }
          else {
            ById('pbtargetBatteringRam').disabled = false;
          }
      },false);
      ById('pbCatapult').addEventListener('click', function(){
          if (ById('pbCatapult').checked==false) {
              ById('pbtargetCatapult').disabled = true;
          }
          else {
            ById('pbtargetCatapult').disabled = false;
          }
      },false);
	 ById('pbBloodThom').addEventListener('click', function(){
       if (ById('pbBloodThom').checked==false) ById('pbtargetBloodThom').disabled = true;
        else ById('pbtargetBloodThom').disabled = false;
     },false);
     ById('pbExecutioner').addEventListener('click', function(){
	   if (ById('pbExecutioner').checked==false) ById('pbtargetExecutioner').disabled = true;
	    else ById('pbtargetExecutioner').disabled = false;
    },false);
    ById('pbSiegeWall').addEventListener('click', function(){
	   if (ById('pbSiegeWall').checked==false)ById('pbtargetSiegeWall').disabled = true;
	    else ById('pbtargetSiegeWall').disabled = false;
	},false);
	  ById('pbFlameArcher').addEventListener('click', function(){
		   if (ById('pbFlameArcher').checked==false)ById('pbtargetFlameArcher').disabled = true;
		    else ById('pbtargetFlameArcher').disabled = false;
	},false);
	  ById('pbHusar').addEventListener('click', function(){
			   if (ById('pbHusar').checked==false)ById('pbtargetHusar').disabled = true;
			    else ById('pbtargetHusar').disabled = false;
	},false);
  }
  t.timer = setTimeout (t.showAuto, 3000);
  },
  e_reassignRoutes: function(){
        var t = Tabs.Reassign;
        var now = new Date();
        if (t.reassignState.running == true)    {
        	var now = new Date().getTime()/1000.0;
        	now = now.toFixed(0);
        	var last = Options.lastreassign;
         		if ( now > (parseInt(last) + (Options.reassigninterval*60))){
      			  t.checkdoReassign();
        		}
        }
        setTimeout(function(){ t.e_reassignRoutes();}, Options.reassigninterval*1000);
      },
  	delReassignRoutes: function() {
  		var t = Tabs.Reassign;
  		t.reassignRoutes= [];
  	},
  	checkcoords : function (obj){
  		var t = Tabs.Reassign;
  		if(obj.id == 'pbok'){
  			t.check = true;
  			t.addReassignRoute();
  		}
  		return;
  	},
  	addReassignRoute: function () {
  		var t = Tabs.Reassign;
  		var city = t.tcp.city.id;
  		if(t.tcpto.city == null)return;
  		if(t.tcp.city.id == t.tcpto.city.id)return;
  		t.check = false;
  		var SendSupplyTroop = ById('pbSupplyTroops').checked;
  		var SendMilitiaman = ById('pbMilitiaman').checked;
  		var SendScout = ById('pbScout').checked;
  		var SendPikeman = ById('pbPikeman').checked;
  		var SendSwordsman = ById('pbSwordsman').checked;
  		var SendArchers = ById('pbArcher').checked;
  		var SendCavalry = ById('pbCavalry').checked;
  		var SendHeavyCavalry = ById('pbHeavyCavalry').checked;
  		var SendSupplyWagons = ById('pbSupplyWagon').checked;
  		var SendBallista = ById('pbBallista').checked;
  		var SendBatteringRam = ById('pbBatteringRam').checked;
  		var SendCatapult = ById('pbCatapult').checked;
  		var SendBloodThom = ById('pbBloodThom').checked;
  		var SendExecutioner = ById('pbExecutioner').checked;
		var SendSiegeWall = ById('pbSiegeWall').checked;
		var SendFlameArcher = ById('pbFlameArcher').checked;
		var SendHusar = ById('pbHusar').checked;
  		var SupplyTroop = ById('pbtargetSupplyTroops').value;
  		var Militiaman = ById('pbtargetMilitiaman').value;
  		var Scout = ById('pbtargetScout').value;
  		var Pikeman = ById('pbtargetPikeman').value;
  		var Swordsman = ById('pbtargetSwordsman').value;
  		var Archers = ById('pbtargetArcher').value;
  		var Cavalry = ById('pbtargetCavalry').value;
  		var HeavyCavalry = ById('pbtargetHeavyCavalry').value;
  		var SupplyWagons = ById('pbtargetSupplyWagon').value;
  		var Ballista = ById('pbtargetBallista').value;
  		var BatteringRam = ById('pbtargetBatteringRam').value;
  		var Catapult = ById('pbtargetCatapult').value;
  		var BloodThom = ById("pbtargetBloodThom").value;
  		var Executioner = ById("pbtargetExecutioner").value;
		var SiegeWall = ById("pbtargetSiegeWall").value;
		var FlameArcher = ById("pbtargetFlameArcher").value;
		var Husar = ById("pbtargetHusar").value;
  		var target_x = t.tcpto.city.x;
  		var target_y = t.tcpto.city.y;
  		var lRE = t.reassignRoutes;
  		lRE.push({
  				city:				city,
  				target_x:			target_x,
  				target_y:			target_y,
  				SendSupplyTroop:	SendSupplyTroop,
  				SupplyTroop:		SupplyTroop,
  				SendMilitiaman:		SendMilitiaman,
  				Militiaman:			Militiaman,
  				SendScout:			SendScout,
  				Scout:				Scout,
  				SendPikeman: 		SendPikeman,
  				Pikeman: 			Pikeman,
  				SendSwordsman:		SendSwordsman,
  				Swordsman:			Swordsman,
  				SendArchers:		SendArchers,
  				Archers:			Archers,
  				SendCavalry: 		SendCavalry,
  				Cavalry: 			Cavalry,
  				SendHeavyCavalry:	SendHeavyCavalry,
  				HeavyCavalry:		HeavyCavalry,
  				SendSupplyWagons:	SendSupplyWagons,
  				SupplyWagons:		SupplyWagons,
  				SendBallista: 		SendBallista,
  				Ballista: 			Ballista,
  				SendBatteringRam:	SendBatteringRam,
  				BatteringRam:		BatteringRam,
  				SendCatapult:		SendCatapult,
  				Catapult:			Catapult,
  				SendBloodThom:		SendBloodThom,
  				BloodThom:			BloodThom,
  				SendExecutioner:	SendExecutioner,
  				Executioner:		Executioner,
  				SendSiegeWall:		SendSiegeWall,
  				SiegeWall:			SiegeWall,
  				SendFlameArcher:	SendFlameArcher,
  				FlameArcher:		FlameArcher,
  				SendHusar:			SendHusar,
  				Husar:				Husar,
  			});
  		ById('pbReassignDivD').style.background ='#99FF99';
  		setTimeout(function(){ (ById('pbReassignDivD').style.background =''); }, 1000);
  	},
  	showReassignRoutes: function () {
  		var t = Tabs.Reassign;
  		var popReassignRoutes = null;
  		t.popReassignRoutes = new CPopup('pbShowTrade', 0, 0, 1100, 500, true, function() {clearTimeout (1000);});
  		var m = '<DIV style="max-height:460px; height:460px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbShowReassignRoutes" id="pbRoutesQueue">';
  		t.popReassignRoutes.getMainDiv().innerHTML = '</table></div>' + m;
  		t.popReassignRoutes.getTopDiv().innerHTML = '<TD><B>'+lang.reassign.popReassignRoutes+'</td>';
  		t.paintReassignRoutes();
  		t._addTabHeader();
  		t.popReassignRoutes.show(true)	;
  	},
  	paintReassignRoutes: function(){
  	        var t = Tabs.Reassign;
  	        var r = t.reassignRoutes;
  	        var cityname;
  	        var citynameTo = null;
  			for (var i = (r.length-1); i>=0; i--) {
  				for (var y=0; y< Seed.cities.length;y++) {
  					if ( parseInt(Seed.cities[y][0]) == r[i].city) var cityname = Seed.cities[y][1];
  					if ( parseInt(Seed.cities[y][2]) == r[i].target_x && parseInt(Seed.cities[y][3]) == r[i].target_y) var citynameTo = Seed.cities[y][1];
  				}
  				if (citynameTo == null) var TO =  r[i].target_x +','+ r[i].target_y; else TO = citynameTo;
  				var queueId = i;
  				t._addTab(queueId, cityname, TO, r[i].SendSupplyTroop,r[i].SupplyTroop, r[i].SendMilitiaman, r[i].Militiaman, r[i].SendScout, r[i].Scout, r[i].SendPikeman, r[i].Pikeman, r[i].SendSwordsman, r[i].Swordsman, r[i].SendArchers, r[i].Archers, r[i].SendCavalry, r[i].Cavalry, r[i].SendHeavyCavalry, r[i].HeavyCavalry, r[i].SendSupplyWagons, r[i].SupplyWagons, r[i].SendBallista, r[i].Ballista, r[i].SendBatteringRam, r[i].BatteringRam, r[i].SendCatapult, r[i].Catapult, r[i].SendBloodThom, r[i].BloodThom, r[i].SendExecutioner, r[i].Executioner, r[i].SendSiegeWall, r[i].SiegeWall, r[i].SendFlameArcher, r[i].FlameArcher, r[i].SendHusar, r[i].Husar);
  	        }
  	 },
  	 _addTab: function(queueId,cityname,TO,SendSupplyTroop,SupplyTroop,SendMilitiaman,Militiaman,SendScout,Scout,SendPikeman,Pikeman,SendSwordsman,Swordsman,SendArchers,Archers,SendCavalry,Cavalry,SendHeavyCavalry,HeavyCavalry,SendSupplyWagons,SupplyWagons,SendBallista,Ballista,SendBatteringRam,BatteringRam,SendCatapult,Catapult,SendBloodThom,BloodThom,SendExecutioner,Executioner,SendSiegeWall,SiegeWall,SendFlameArcher,FlameArcher,SendHusar,Husar){
  	 	var t = Tabs.Reassign;
  	     var row = ById('pbRoutesQueue').insertRow(0);
  	     row.vAlign = 'top';
   	     row.insertCell(0).innerHTML = cityname;
  	     row.insertCell(1).innerHTML = TO;
  	     row.insertCell(2).innerHTML = "<input type=checkbox disabled "+ (SendSupplyTroop?' CHECKED':'') +">";
  	     row.insertCell(3).innerHTML = addCommas(SupplyTroop);
  	     row.insertCell(4).innerHTML = "<input type=checkbox disabled "+ (SendMilitiaman?' CHECKED':'') +">";
  	     row.insertCell(5).innerHTML = addCommas(Militiaman);
  	 	 row.insertCell(6).innerHTML = "<input type=checkbox disabled "+ (SendScout?' CHECKED':'') +">";
  	 	 row.insertCell(7).innerHTML = addCommas(Scout);
  	 	 row.insertCell(8).innerHTML = "<input type=checkbox disabled "+ (SendPikeman?' CHECKED':'') +">";
  	 	 row.insertCell(9).innerHTML = addCommas(Pikeman);
  	 	 row.insertCell(10).innerHTML = "<input type=checkbox disabled "+ (SendSwordsman?' CHECKED':'') +">";
  	 	 row.insertCell(11).innerHTML = addCommas(Swordsman);
  	 	 row.insertCell(12).innerHTML = "<input type=checkbox disabled "+ (SendArchers?' CHECKED':'') +">";
  	 	 row.insertCell(13).innerHTML = addCommas(Archers);
  	 	 row.insertCell(14).innerHTML = "<input type=checkbox disabled "+ (SendCavalry?' CHECKED':'') +">";
  	 	 row.insertCell(15).innerHTML = addCommas(Cavalry);
  	 	 row.insertCell(16).innerHTML = "<input type=checkbox disabled "+ (SendHeavyCavalry?' CHECKED':'') +">";
  	 	 row.insertCell(17).innerHTML = addCommas(HeavyCavalry);
  	 	 row.insertCell(18).innerHTML = "<input type=checkbox disabled "+ (SendSupplyWagons?' CHECKED':'') +">";
  	 	 row.insertCell(19).innerHTML = addCommas(SupplyWagons);
  	 	 row.insertCell(20).innerHTML = "<input type=checkbox disabled "+ (SendBallista?' CHECKED':'') +">";
  	 	 row.insertCell(21).innerHTML = addCommas(Ballista);
  	 	 row.insertCell(22).innerHTML = "<input type=checkbox disabled "+ (SendBatteringRam?' CHECKED':'') +">";
  	 	 row.insertCell(23).innerHTML = addCommas(BatteringRam);
  	 	 row.insertCell(24).innerHTML = "<input type=checkbox disabled "+ (SendCatapult?' CHECKED':'') +">";
  	 	 row.insertCell(25).innerHTML = addCommas(Catapult);
 	 	 row.insertCell(26).innerHTML = "<input type=checkbox disabled "+ (SendBloodThom?' CHECKED':'') +">";
  	 	 row.insertCell(27).innerHTML = addCommas(parseIntNan(BloodThom));
  	 	 row.insertCell(28).innerHTML = "<input type=checkbox disabled "+ (SendExecutioner?' CHECKED':'') +">";
  	 	 row.insertCell(29).innerHTML = addCommas(parseIntNan(Executioner));
  	 	 row.insertCell(30).innerHTML = "<input type=checkbox disabled "+ (SendSiegeWall?' CHECKED':'') +">";
  	 	 row.insertCell(31).innerHTML = addCommas(parseIntNan(SiegeWall));
  	 	 row.insertCell(32).innerHTML = "<input type=checkbox disabled "+ (SendFlameArcher?' CHECKED':'') +">";
  	 	 row.insertCell(33).innerHTML = addCommas(parseIntNan(FlameArcher));
  	 	 row.insertCell(34).innerHTML = "<input type=checkbox disabled "+ (SendFlameArcher?' CHECKED':'') +">";
  	 	 row.insertCell(35).innerHTML = addCommas(parseIntNan(FlameArcher));
  	 	 row.insertCell(36).innerHTML = '<a class="button20" id="tradecancel_' + queueId + '"><span>'+uW.g_js_strings.commonstr.remove+'</span></a>';
  	     ById('tradecancel_' + queueId).addEventListener('click', function(){
  	        t.cancelQueueElement(queueId);
  	     }, false);
  	 },

  	 _addTabHeader: function() {
  	     var t = Tabs.Reassign;
  	     var row = ById('pbRoutesQueue').insertRow(0);
  	     row.vAlign = 'top';
   	     row.insertCell(0).innerHTML = uW.g_js_strings.commonstr.from;
  	     row.insertCell(1).innerHTML = lang.General.to;
  	     row.insertCell(2).innerHTML = '<img height=20 title="'+uW.unitcost['unt1'][0]+'" src='+gameurl+'img/units/unit_1_30.jpg>';
  	     row.insertCell(3).innerHTML = "";
  	     row.insertCell(4).innerHTML = '<img height=20 title="'+uW.unitcost['unt2'][0]+'" src='+gameurl+'img/units/unit_2_30.jpg>';
  	     row.insertCell(5).innerHTML = "";
  	     row.insertCell(6).innerHTML = '<img height=20 title="'+uW.unitcost['unt3'][0]+'" src='+gameurl+'img/units/unit_3_30.jpg>';
  	     row.insertCell(7).innerHTML = "";
  	     row.insertCell(8).innerHTML = '<img height=20 title="'+uW.unitcost['unt4'][0]+'" src='+gameurl+'img/units/unit_4_30.jpg>';
  	     row.insertCell(9).innerHTML = "";
  	     row.insertCell(10).innerHTML = '<img height=20 title="'+uW.unitcost['unt5'][0]+'" src='+gameurl+'img/units/unit_5_30.jpg>';
  	     row.insertCell(11).innerHTML = "";
  	     row.insertCell(12).innerHTML = '<img height=20 title="'+uW.unitcost['unt6'][0]+'" src='+gameurl+'img/units/unit_6_30.jpg>';
  	     row.insertCell(13).innerHTML = "";
  	     row.insertCell(14).innerHTML = '<img height=20 title="'+uW.unitcost['unt7'][0]+'" src='+gameurl+'img/units/unit_7_30.jpg>';
  	     row.insertCell(15).innerHTML = "";
  	     row.insertCell(16).innerHTML = '<img height=20 title="'+uW.unitcost['unt8'][0]+'" src='+gameurl+'img/units/unit_8_30.jpg>';
  	     row.insertCell(17).innerHTML = "";
  	     row.insertCell(18).innerHTML = '<img height=20 title="'+uW.unitcost['unt9'][0]+'" src='+gameurl+'img/units/unit_9_30.jpg>';
  	     row.insertCell(19).innerHTML = "";
  	     row.insertCell(20).innerHTML = '<img height=20 title="'+uW.unitcost['unt10'][0]+'" src='+gameurl+'img/units/unit_10_30.jpg>';
  	     row.insertCell(21).innerHTML = "";
  	     row.insertCell(22).innerHTML = '<img height=20 title="'+uW.unitcost['unt11'][0]+'" src='+gameurl+'img/units/unit_11_30.jpg>';
  	     row.insertCell(23).innerHTML = "";
  	     row.insertCell(24).innerHTML = '<img height=20 title="'+uW.unitcost['unt12'][0]+'" src='+gameurl+'img/units/unit_12_30.jpg>';
  	     row.insertCell(25).innerHTML = "";
  	     row.insertCell(26).innerHTML = '<img height=20 title="'+uW.unitcost['unt13'][0]+'" src='+gameurl+'img/units/unit_13_30.jpg>';
  	     row.insertCell(27).innerHTML = "";
  	     row.insertCell(28).innerHTML = '<img height=20 title="'+uW.unitcost['unt14'][0]+'" src='+gameurl+'img/units/unit_14_30.jpg>';
  	     row.insertCell(29).innerHTML = "";
  	     row.insertCell(30).innerHTML = '<img height=20 title="'+uW.unitcost['unt15'][0]+'" src='+gameurl+'img/units/unit_15_30.jpg>';
  	     row.insertCell(31).innerHTML = "";
  	     row.insertCell(32).innerHTML = '<img height=20 title="'+uW.unitcost['unt16'][0]+'" src='+gameurl+'img/units/unit_16_30.jpg>';
  	     row.insertCell(33).innerHTML = "";
  	     row.insertCell(34).innerHTML = '<img height=20 title="'+uW.unitcost['unt17'][0]+'" src='+gameurl+'img/units/unit_17_30.jpg>';
  	     row.insertCell(35).innerHTML = "";
  	     row.insertCell(36).innerHTML = "X";
	     var row = ById('pbRoutesQueue').insertRow(0);
		 row.innerHTML='<td colspan=30 align=center><input type=button value="'+lang.transport.BOTrpQG+'" id=botradeQG>&nbsp;</td>';
		 ById('botradeQG').addEventListener('click', function(){
		  	      if (parseIntNan(Options.alertConfig.hq)>0) {
		   	       var mavilleId=Cities.byID[Options.alertConfig.hq];
			       if (mavilleId) {
			        var r = t.reassignRoutes;
			        for (var i = (r.length-1); i>=0; i--) {
			           r[i].target_x=mavilleId.x;
		          	   r[i].target_y=mavilleId.y;
			        }
			        t.showReassignRoutes();
			       }
			      }
  	     }, false);
  	   },
  	 cancelQueueElement: function(queueId){
  	     var t = Tabs.Reassign;
  	     var queueId = parseInt(queueId);
  	     t.reassignRoutes.splice(queueId, 1);
  	     t.showReassignRoutes();
  	 },
  	saveReassignRoutes: function(){
  		var t = Tabs.Reassign;
          var serverID = getServerId();
          GM_setValue('reassignRoutes_' + serverID, JSON2.stringify(t.reassignRoutes));
      },
      readReassignRoutes: function(){
          var t = Tabs.Reassign;
          var serverID = getServerId();
          s = GM_getValue('reassignRoutes_' + serverID);
          if (s != null) {
              route = JSON2.parse(s);
              for (k in route)
                  t.reassignRoutes[k] = route[k];
          }
      },
      saveReassignState: function(){
  		var t = Tabs.Reassign;
          var serverID = getServerId();
          GM_setValue('reassignState_' + serverID, JSON2.stringify(t.reassignState));
      },
      readReassignState: function(){
          var t = Tabs.Reassign;
          var serverID = getServerId();
          s = GM_getValue('reassignState_' + serverID);
          if (s != null) {
              state = JSON2.parse(s);
              for (k in state)
                  t.reassignState[k] = state[k];
          }
      },
      toggleReassignState: function(obj){
  		var t = Tabs.Reassign;
  	obj = ById('pbReassignState');
          if (t.reassignState.running == true) {
              t.reassignState.running = false;
              if (obj) obj.value = lang.reassign.buttonlab+" = OFF";
  		    if (Options.BORac_Rea)updatebotbutton(lang.reassign.buttonlab+' - OFF', 'pbsigntab');
  			t.checkdoreassigntimeout = null;
  			t.count = 0;
  			  		  Options.lastreassign = 0;
			  		  saveOptions();

          }
          else {
              t.reassignState.running = true;
              if (obj) obj.value = lang.reassign.buttonlab+" = ON";
  		    if (Options.BORac_Rea) updatebotbutton(lang.reassign.buttonlab+' - ON', 'pbsigntab');
  			t.e_reassignRoutes();
          }
      },

     checkdoReassign: function(){
  	var t = Tabs.Reassign;
  	t.doReassign(t.count);
  	t.count++;
  		if(t.count < t.reassignRoutes.length && t.reassignState.running){
  		  t.checkdoreassigntimeout = setTimeout(function() { t.checkdoReassign();}, 5000);
  		} else {
  		  var now = new Date().getTime()/1000.0;
  		  now = now.toFixed(0);
  		  Options.lastreassign = now;
  		  saveOptions();
  		  t.count = 0;
  		}
  	},
    doReassign: function(count,tt){
      	var t = Tabs.Reassign;
     	var params = uW.Object.clone(uW.g_ajaxparams);
     	if(t.reassignRoutes.length==0) return;
     	var send=[];
     	var citytotal=0;
     	var totalsend=0;
       // if (tt != undefined && tt != null) params.tt = tt;
     	var city = t.reassignRoutes[count]["city"];
     	var xcoord = t.reassignRoutes[count]["target_x"];
     	var ycoord = t.reassignRoutes[count]["target_y"];
      	var cityID = 'city' + city;
  		if(!Cities.byID[city]) return;
  		var marching = getMarchInfoBOT(cityID);
		maxsend=March.RallyPoint(city).maxSize;
      	totalsend=0;
      	var rallypointlevel=March.RallyPoint(city).maxSlots;
		var slots=March.RallyPoint(city).marching;
		if(slots >= rallypointlevel){
		      		return false;
        }
      	var troopsselect=["SupplyTroop","Militiaman","Scout","Pikeman","Swordsman","Archers","Cavalry","HeavyCavalry","SupplyWagons","Ballista","BatteringRam","Catapult","BloodThom","Executioner","SiegeWall","FlameArcher","Husar"];
      	for (k=0; k<troopsselect.length; k++) {
		  if (uW.unitcost['unt'+(k+1)]) {
  			var citytroops = Seed.units[cityID]['unt'+(parseInt(k)+1)];
  			var marchtroops = marching.marchUnits[parseInt(k)+1];
  			citytotal = parseIntNan(citytroops) + parseIntNan(marchtroops);
  			if(t.reassignRoutes[count]['Send'+troopsselect[k]]==false) {continue; }
  			if(citytotal > parseIntNan(t.reassignRoutes[count][troopsselect[k]])){
  				var sendtroops = parseIntNan(citytotal) - parseIntNan(t.reassignRoutes[count][troopsselect[k]]);
  				if (parseInt(sendtroops) > parseInt(citytroops)) sendtroops = citytroops;
  				if (parseInt(sendtroops) < 0) sendtroops = 0;
  				send[(parseInt(k)+1)] = sendtroops;
  				totalsend += send[(parseInt(k)+1)];
  			}
  			if(totalsend > maxsend){
  				totalsend -= send[(parseInt(k)+1)];
  				send[(parseInt(k)+1)] = parseInt(maxsend-totalsend);
  				totalsend += send[(parseInt(k)+1)];
  				break;
  			}
		   }else{
			   send[(parseInt(k)+1)] = 0;
			}
       }
      for (var zz=0; zz< Seed.cities.length;zz++)
      		if ( parseInt(Seed.cities[zz][0]) == city) var cityname = Seed.cities[zz][1];
    	params.cid= city;
  		params.type = "5";
  		params.kid=0;
  		params.g = 0;
		params.r1 = 0;
		params.r2 = 0;
		params.r3 = 0;
		params.r4 = 0;
		params.r5 = 0;
  		params.xcoord = xcoord;
  		params.ycoord = ycoord;
  		for (k=1; k<=troopsselect.length; k++) {
		 params["u"+k] = parseIntNan(send[k]);
		 if (parseIntNan(send[k]) > 0) params["u" + k] = parseIntNan(send[k]);
	    }
     	if (totalsend >0) {
				var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
        		new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
                    method: "post",
                    parameters: params,
                    loading: true,
                    onSuccess: function (transport) {
						 profiler.stop();
                    var rslt = eval("(" + transport.responseText + ")");
                   if (rslt.ok) {
                    var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
                    var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
                    var ut = unixTime();
                    var unitsarr = [];
            	 	for (j in uW.unitcost) unitsarr.push(0);
                    for(i = 1; i <= unitsarr.length; i++)
                     if(params["u"+i])
                      unitsarr[i] = params["u"+i];
                    var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];
                    var currentcityid = city;
                    uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
                    if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
                    if (Options.LogsReassign)actionLog("Reassign","From: " + cityname + " to : " + xcoord + ',' + ycoord + "    ->   "+uW.g_js_strings.commonstr.troops+" : " + totalsend);

      			} else {

					if (rslt.user_action) {
					if (rslt.user_action == "backOffWaitTime") {
						var t = Tabs.Reassign;
		  	var tt = null;
		  	if(rslt.tt)
		  	tt = rslt.tt;
		  	var wait = 1;
		  	if(rslt.wait_time)
		  	wait = rslt.wait_time;
		  	setTimeout (function(){t.doReassign(count,tt);}, wait*1000);
		  	return;
		 	}else{
				if (Options.LogsReassign)actionLog("Reassign","<b><font color=red>alert "+rslt.user_action+" </font></b>");
			}
		}else{
			if (Options.LogsReassign)actionLog("Reassign","From: " + cityname + " to : " + xcoord + ',' + ycoord + " -> <font colr=red>" + uW.printLocalError((rslt.error_code||null),(rslt.msg||null),(rslt.feedback||null)) +"</font>");
		}
       }
        }, onFailure: function (transport) {
			  profiler.stop();
                      var rslt = eval("(" + transport.responseText + ")");
                      if (rslt.user_action) {
		      						if (Options.LogsReassign)actionLog("Reassign","<b><font color=red>Detection Captcha</font></b>");
		      						new CdialogCancelContinue('<SPAN class=boldRed>CAPTCHA ALERT ! - REASSIGN AUTO</span>', null, null, mainPop.getMainDiv());
			         } else {

                      if (Options.LogsReassign)actionLog("Reassign","<font color=red>" + transport.responseText + "</font>");

                    }
                    }
            });
     	 }
  	},
    show: function(){
  		var t = Tabs.Reassign;
    },
  	hide: function(){
          var t = Tabs.Reassign;
      },
      onUnload: function(){
          var t = Tabs.Reassign;
          if (!ResetAll) t.saveReassignRoutes();
  	  if (!ResetAll) t.saveReassignState();
    },
  showManuel: function() {
    var t = Tabs.Reassign;
    var ModelCity = {};
    var rownum = 0;
    var rownum2 = 0;
    function _row (name, row, noTotal){
          if (rownum++ % 2)
            style = '';
          else
            style = ' style = "background: #e8e8e8"';
          var tot = 0;
          var m = [];
          m.push ('<TR style="background: #fff" align=right');
          m.push (style);
          m.push ('><TD');
          m.push (style);
          m.push ('><B>');
          m.push (name);
          m.push ('</td>');
          if (noTotal){
            m.push ('<TD');
            m.push (style);
            m.push ('>&nbsp;</td>');
          } else {
            for (i=0; i<row.length; i++)
              tot += row[i];
            m.push ('<TD style="background: #ffc">');
            m.push (addCommas(tot));
            m.push ('</td>');
          }
          for (i=0; i<row.length; i++){
            m.push ('<TD');
            m.push (style);
            m.push ('>');
            m.push (addCommas(row[i]));
            m.push ('</td>');
          }
          m.push ('</tr>');
          return m.join('');
    }
    if (t.state == null) {
      m = "<DIV class=boStat>"+lang.reassign.title2+"</div>";
      m += "<div><TABLE width='95%' class=ptTab border=0>\
        <tr align=center valign=middle><td colspan=1 width=100><b><u>"+lang.General.source+"</b></u><br><span id=REAsrcRptspeedcity></span></td>\
        <td colspan=1 width='100px'><input type=button style='font-weight:bold' id=REAaction value='"+uW.g_js_strings.commonstr.reassign+"'></td>\
        <td colspan=1 width='100px'><b><u>"+lang.General.dest+"</b></u><br><span id=REAdesRptspeedcity></span></td><td width=150 colspan=1><b><u>"+lang.General.EstimateT+"</b></u><br>&nbsp;"+uW.g_js_strings.commonstr.distance+": <span id='BOEstimationREAD'>&nbsp;</span></td></tr>\
        <tr align=center valign=top><td width=100><div id=REAstatsource></div></td>\
        <td ><table cellspacing=0 cellpadding=0 width=99%>";
         var r=0;
	 	for (y in uW.unitcost) {
	  r++
         if (rownum++ % 2)
	             style = '';
	           else
            style = ' style = "background: #e8e8e8"';
	     m += '<tr '+style+'><td  align=right><img height=20 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg></td><td align=left><input style="border:1px solid black;height:16px;font-size:11px;" id="REAnbunit'+r+'" type=text size=7 value="0"></td></tr>';
   	}

        m += "</table></td><td><div id=REAstatdest></div></td>";
        m += "<td colspan=2><table cellspacing=0 cellpadding=0 width=80%>";
    var r=0;
	for (y in uW.unitcost) {
	  r++
        if (rownum++ % 2)
	            style = '';
	          else
            style = 'background: #e8e8e8;';
		    m += '<tr style="'+style+' height:16px;font-size:11px;"><td width=50% height=20 align=center><span id="BOEstimationREAZ'+r+'">&nbsp;</span></td></tr>';
   	}
      m += "</tr></table>";
      m += "</tr><tr><td colspan=4>"+uW.g_js_strings.commonstr.knight+": <SELECT id='REApiKnight' type=list>&nbsp;&nbsp;<input type=checkbox id=BOREAGold> "+uW.g_js_strings.commonstr.gold+"&nbsp;\
      <input type=checkbox id=BOREAFood> "+uW.g_js_strings.commonstr.food+"&nbsp;<input type=checkbox id=BOREAWood> "+uW.g_js_strings.commonstr.wood+"&nbsp;\
      <input type=checkbox id=BOREAStone> "+uW.g_js_strings.commonstr.stone+"&nbsp;<input type=checkbox id=BOREAOre> "+uW.g_js_strings.commonstr.ore+"&nbsp;<input type=checkbox id=BOREAAetherstone> "+uW.g_js_strings.commonstr.aetherstone+"</tr><tr><td colspan=4><div id='ptREAStatus' style='text-align:center;overflow-y:auto; max-height:30px; height: 30px;'></div></td></tr></table>";
     m += "</div><DIV class=boStat>"+lang.reassign.title2+"</div>";
     m +="<div id='statpourREA'></div>";
     t.ReassignDiv.innerHTML = m;
      t.statpourREA = ById ('statpourREA');
      t.statutREA = ById ('ptREAStatus');
      t.actionREA = ById ('REAaction');
      t.BOREAGold = ById ('BOREAGold');
      t.BOREAFood = ById ('BOREAFood');
      t.BOREAWood = ById ('BOREAWood');
      t.BOREAStone = ById ('BOREAStone');
      t.BOREAOre = ById ('BOREAOre');
      t.BOREAAetherstone = ById ('BOREAAetherstone');
      t.actionREA.addEventListener ('click', function() { t.clickReassigneDo(t.BOREAFood.checked); }, false);
      t.BOREAGold.addEventListener ('click', function() {
		  t.BOREAAetherstone.checked=false;t.BOREAFood.checked=false;t.BOREAWood.checked=false;t.BOREAStone.checked=false;t.BOREAOre.checked=false;
	  },false);
      t.BOREAFood.addEventListener ('click', function() {
	  		  t.BOREAGold.checked=false;t.BOREAAetherstone.checked=false;t.BOREAWood.checked=false;t.BOREAStone.checked=false;t.BOREAOre.checked=false;
	  },false);
	  t.BOREAWood.addEventListener ('click', function() {
	  		  t.BOREAGold.checked=false;t.BOREAFood.checked=false;t.BOREAAetherstone.checked=false;t.BOREAStone.checked=false;t.BOREAOre.checked=false;
	  },false);
	  t.BOREAStone.addEventListener ('click', function() {
	  		  t.BOREAGold.checked=false;t.BOREAFood.checked=false;t.BOREAWood.checked=false;t.BOREAAetherstone.checked=false;t.BOREAOre.checked=false;
	  },false);
	  t.BOREAOre.addEventListener ('click', function() {
	  		  t.BOREAGold.checked=false;t.BOREAFood.checked=false;t.BOREAWood.checked=false;t.BOREAStone.checked=false;t.BOREAAetherstone.checked=false;
	  },false);
	  t.BOREAAetherstone.addEventListener ('click', function() {
	  		  t.BOREAGold.checked=false;t.BOREAFood.checked=false;t.BOREAWood.checked=false;t.BOREAStone.checked=false;t.BOREAOre.checked=false;
	  },false);
      var dcp1 = new CdispCityPicker ('ptREA1', ById('REAdesRptspeedcity'), false, t.clickREACityDestinationSelect, 1);
      var dcp0 = new CdispCityPicker ('ptREA0', ById('REAsrcRptspeedcity'), false, t.clickREACitySourceSelect, Cities.byID[uW.currentcityid].idx);
      t.state = 1;
      t.estimerTemps();
    }
    rows = [];
    rows[0]=[];
    m = "<TABLE class=ptTabLined cellspacing=0><TR valign=top align=right><TD width=20></td><TD width=88 style='background: #ffc'><B>TOTAL</b></td>";
    for(i=0; i<Cities.numCities; i++) {
             m += '<TD width=81><B>'+ Cities.cities[i].name.substring(0,10) +'</b></td>';
    }
     row = [];
	    for(var i=0; i<Cities.numCities; i++) {
	     slots=March.RallyPoint(Cities.cities[i].id).marching;
		 niveauPointRall=March.RallyPoint(Cities.cities[i].id).maxSlots;
		 row[i] = '<SPAN><B>'+ slots +'/'+ niveauPointRall +'</b></span>';
	    }
    m += _row (lang.Overview.march, row, true);
    var r=0;
	for (y in uW.unitcost) {
	  r++
      rows[r] = [];
      for(i=0; i<Cities.numCities; i++) {
              cityID = 'city'+ Cities.cities[i].id;
              rows[r][i] = parseIntNan(Seed.units[cityID][y]);
      }
    }
    var r=0;
	for (y in uW.unitcost) {
	 r++
     m += _row ('<img height=18 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg>', rows[r]);
    }

    m += "</table>";
    t.statpourREA.innerHTML = m;
    clearTimeout (t.displayTimer);
    t.displayTimer = setTimeout (t.showManuel, 5000);
  },
  estimerTemps: function() {
       var t = Tabs.Reassign;
       var x1 = parseInt(t.sourceCity.x);
       var x2 = parseInt(t.destinationCity.x);
       var y1 = parseInt(t.sourceCity.y);
       var y2 = parseInt(t.destinationCity.y);
       var dist = distance (x1, y1, x2, y2);
       ById("BOEstimationREAD").innerHTML = "<b>" + dist + "</b>";
    var r=0;
	for (y in uW.unitcost) {
		r++;
          var m = estETA(dist, r, t.sourceCity.id,5);
          ById("BOEstimationREAZ"+r).innerHTML = "<b>" + m.friendEtaStr + "</b>";
       }
    },
  clickReassigneDo: function() {
   var t = Tabs.Reassign;
   t.statutREA.innerHTML = '';
    var totalunit=0;
    var r=0;
	for (y in uW.unitcost) {
		r++;
       if (parseIntNan(ById("REAnbunit"+r).value) > parseIntNan(ById("REAdestunit"+r).value)) {
         ById("REAnbunit"+r).style.backgroundColor="red";
         return false;
       }
       totalunit=totalunit+parseIntNan(ById("REAnbunit"+r).value);
       ById("REAnbunit"+r).style.backgroundColor="";
   }
   if (t.sourceCity.id==t.destinationCity.id) {
         t.statutREA.innerHTML = '<FONT COLOR=#550000>'+lang.transport.err3+'</font>';
        return;
   }
   if (totalunit==0) {
      t.statutREA.innerHTML = '<FONT COLOR=#550000>'+uW.g_js_strings.modal_attack_do.sendtroop+'</font>';
        return;
   }
   var e=1;
   var f=uW.unixtime();
   var maxtroupe=March.RallyPoint(t.sourceCity.id).maxSize;
   if (totalunit>maxtroupe) {
    t.statutREA.innerHTML = '<FONT COLOR=#550000>'+lang.reassign.err1+' '+maxtroupe+' '+lang.reassign.err2+'</font>';
    return;
   }
  t.actionREA.disabled=true;
  var x=t.destinationCity.x;
  var y=t.destinationCity.y;
  t.statutREA.innerHTML ="<font size='2px'><b><i>"+lang.reassign.plzwait+"</i></b></font>";
  var params = uW.Object.clone(uW.g_ajaxparams);
  params.cid= t.sourceCity.id;
  params.type = 5;
  params.kid= ById("REApiKnight").value;
  params.xcoord = x;
  params.ycoord = y;

    var r=0;
    var res=0;
  	for (yy in uW.unitcost) {
  		r++;
		if (ById("REAnbunit"+r))
		if (parseInt(ById("REAnbunit"+r).value)>0) {
  		var techLoadBoost=parseIntNan(Seed.tech.tch10)*0.1;
		var loadEffectBoost=0;
		if(Seed.playerEffects.loadExpire>uW.unixtime()){loadEffectBoost=0.25}
		var BBoost=0;
		BBoost+=EffetTronePrc(6).percent;
		if(uW.cm.unitFrontendType[r]=="horsed") BBoost+=EffetTronePrc(48).percent;
		if(uW.cm.unitFrontendType[r]=="siege") BBoost+=EffetTronePrc(59).percent;
		if (BBoost>=500) {BBoost=500;loadEffectBoost=0;}
		var loadBoost=(BBoost*0.01)+loadEffectBoost+techLoadBoost;
		var LoadUnit=parseIntNan(parseIntNan(uW.unitstats["unt"+r][5])*(1+loadBoost));
        res += parseInt(LoadUnit * ById("REAnbunit"+r).value);
	   }
    }
   if (t.BOREAGold.checked) params["gold"] = res;
   if (t.BOREAFood.checked) params["r1"] = res;
   if (t.BOREAWood.checked) params["r2"] = res;
   if (t.BOREAStone.checked) params["r3"] = res;
   if (t.BOREAOre.checked) params["r4"] = res;
   if (t.BOREAAetherstone.checked) {
	   res=parseInt(res/5);

	   if (parseIntNan(Seed.resources["city" + t.sourceCity.id]['rec5'][0])<res)
	    res=parseIntNan(Seed.resources["city" + t.sourceCity.id]['rec5'][0]);

	   params["r5"] = res;
   }
  var i=0;
  for (y in uW.unitcost) {
	  i++;
	  if (ById("REAnbunit"+i)) {
 			if (parseIntNan(ById("REAnbunit"+i).value) > 0) {
 				params['u'+i] = parseIntNan(ById("REAnbunit"+i).value);
 			}
	}
  }
  var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
  new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
	method: "post",
	parameters: params,
	loading: true,
	onSuccess: function (transport) {
	 var t = Tabs.Reassign;
	 profiler.stop();
	 var rslt = eval("(" + transport.responseText + ")");
	 if (rslt.ok) {
	  var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
	  var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
	  var ut = uW.unixtime();
      var unitsarr = [];
      for (j in uW.unitcost) unitsarr.push(0);
	  for(var i = 1; i <= unitsarr.length; i++){
	    if(params["u"+i]){	unitsarr[i] = params["u"+i];	}
	  }
	  var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];
	  var currentcityid = t.sourceCity.id;
	  uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
	  t.clickREACitySourceSelect(t.sourceCity);
	  t.statutREA.innerHTML ="<font size='2px'><b>"+lang.reassign.done+" " + timestr(timediff)+"</font>";
	  t.actionREA.disabled=false;
	 } else {
          t.statutREA.innerHTML ="<font color=red size='2px'>"+lang.transport.trperr+"</font>";
          if (rslt.msg) {
           t.statutREA.innerHTML +="<br><font color=black size='2px'>" + rslt.msg +"</font>";
           t.actionREA.disabled=false;
          } else {
             t.statutREA.innerHTML +="<br>"+lang.transport.trptryagain+"</font>";
             setTimeout(function() { t.clickReassigneDo(); }, 2000);
             t.actionREA.disabled=false;
          }
        }
       },
       onFailure: function () {
		   profiler.stop();
        var t = Tabs.Reassign;
         t.statutREA.innerHTML ="<font color=red>"+lang.transport.trperr+"</font>";
         t.actionREA.disabled=false;
       }
    });
 },
 clickREACitySourceSelect : function (city){
   var t = Tabs.Reassign;
   var rownum=0;
   if (t.sourceCity!=city) {
         t.sourceCity = city;
    var r=0;
	for (y in uW.unitcost) {
		r++;
     ById("REAnbunit"+r).value="0";
    }
   } else {
    var cityID = 'city'+ t.sourceCity.id;
    var r=0;
	for (y in uW.unitcost) {
	  r++
      if (parseInt(Seed.units[cityID][y]) < ById("REAnbunit"+r).value)  ById("REAnbunit"+r).value="0";
    }
   }
   t.actionREA.disabled=false;
   var m="";
   m="<table cellspacing=0 cellpadding=0 width=80%>";
   var cityID = 'city'+ t.sourceCity.id;
   var r=0;
   for (y in uW.unitcost) {
	  r++
      if (rownum++ % 2)
   	     style = '';
   	  else
         style = 'background: #e8e8e8;';
     m += '<tr style="'+style+'"><td align=right><img title="'+uW.unitcost[y][0]+'" height=20 src='+gameurl+'img/units/unit_'+r+'_30.jpg></td>\
           <td align=left><input style="border:1px solid black;height:16px;font-size:11px;" id="REAdestunit'+r+'" type=text size=7 readonly value="'+parseIntNan(Seed.units[cityID]['unt'+r])+'">&nbsp;\
           <input type=button value=">" id="REApdestunit'+r+'"  style="border:1px solid black;height:16px;font-size:11px;"></td></tr>';
   }
   m += "</table>";
   ById("REAstatsource").innerHTML = m;
   var knt = new Array();
   ById('REApiKnight').innerHTML="";
   var o = document.createElement("option");
   o.text = uW.g_js_strings.modal_attack.dchooseknightd;
	  o.value = 0;
   	  ById("REApiKnight").options.add(o);
   	  for (k in Seed.knights['city' + t.sourceCity.id]){
          		if (Seed.knights['city' + t.sourceCity.id][k]["knightStatus"] == 1 && Seed.leaders['city' + t.sourceCity.id]["resourcefulnessKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"] && Seed.leaders['city' + t.sourceCity.id]["politicsKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"] && Seed.leaders['city' + t.sourceCity.id]["combatKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"] && Seed.leaders['city' + t.sourceCity.id]["intelligenceKnightId"] != Seed.knights['city' + t.sourceCity.id][k]["knightId"]){
          			knt.push ({
          				Name:   Seed.knights['city' + t.sourceCity.id][k]["knightName"],
          				Combat:	Seed.knights['city' + t.sourceCity.id][k]["combat"],
          				ID:	Seed.knights['city' + t.sourceCity.id][k]["knightId"],
          			});
          		}
          }
   knt = knt.sort(function sort(a,b) {a = parseInt(a['Combat']);b = parseInt(b['Combat']);return a == b ? 0 : (a > b ? -1 : 1);});
   for (k in knt){
       			if (knt[k]["Name"] !=undefined){
   	    			var o = document.createElement("option");
   	    			o.text = (knt[k]["Name"] + ' (' + knt[k]["Combat"] +')')
   	    			o.value = knt[k]["ID"];
   	    			ById("REApiKnight").options.add(o);
       			}
   }
    var r=0;
	for (y in uW.unitcost) {
	 r++;
     ById("REApdestunit"+r).addEventListener ('click', function() {
     var nomcha=this.id.replace("REApdest","REAdest");
     var nomcha2=this.id.replace("REApdestunit","REAnbunit");
     ById(nomcha2).value=0;
     var e=1;
     var f=uW.unixtime();
     var maxtroupe=March.RallyPoint(t.sourceCity.id).maxSize;
     var nbunitto=0;
     var z=0;
 	 for (y in uW.unitcost) {
		z++;
         nbunitto+=parseIntNan(ById("REAnbunit"+z).value);
       }
       var libre = parseInt(maxtroupe - nbunitto);
       if (ById(nomcha).value>=libre) {
         ById(nomcha2).value = libre;
       }  else {
         ById(nomcha2).value= ById(nomcha).value;
       }
      }, false);
   }
   t.estimerTemps();
 },
 clickREACityDestinationSelect : function (city){
    var t = Tabs.Reassign;
    var rownum=0;
    t.destinationCity = city;
    var m="";
    m="<table cellspacing=0 cellpadding=0 width=80%>";
    var r=0;
	for (y in uW.unitcost) {
		r++;
       if (rownum++ % 2)
   	            style = '';
   	          else
            style = 'background: #e8e8e8;';
         cityID = 'city'+ t.destinationCity.id;
         m += '<tr style="'+style+'"><td align=right><img height=20 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg></td><td align=left><input style="border:1px solid black;height:16px;font-size:11px;" type=text size=7 readonly value="'+parseIntNan(Seed.units[cityID]['unt'+r])+'"></td></tr>';
    }
    m += "</table>";
    ById("REAstatdest").innerHTML = m;
    t.estimerTemps();
  },
}

Tabs.autoFormation= {
 tabOrder: 9,
 tabLabel: lang.BoiteLabelautoFormation,
 cont : null,
 nbfil : 0,
 crfil : 0,
 timer:null,
 city : 0,
 numcity :-1,
 init : function (div){
   var t = Tabs.autoFormation;
   t.cont = div;
   t.state = null;
   if (Options.BORac_Tra) AddSubTabLink(lang.autoForm.buttonlabel, t.toggleautoFormationState, 'pbformtab');
   if (TrainOptions.Running == false) {
      if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+' - OFF', 'pbformtab');
   } else {
      if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+' - ON', 'pbformtab');
      clearTimeout(t.timer);
      t.timer=setTimeout(t.Start,5000);
   }
   if (TrainOptions.timelauch<3) {
    TrainOptions.timelauch=3;
    saveTrainingOptions();
   }
   return t.cont;
  },
 Start: function() {
  var t = Tabs.autoFormation;
  if (!TrainOptions.Running) {
    clearTimeout(t.timer);
    return;
  }
  if (t.numcity<Cities.numCities-1) {
      t.numcity++;
    } else {
     t.numcity=-1;
     clearTimeout(t.timer);

     t.timer=setTimeout(t.Start,parseIntNan(TrainOptions.timelauch*60)*1000);
     return;
  }
  var c=t.numcity;
  var cityId=Cities.cities[c].id;
  if (!TrainOptions.listactif[cityId]) {
   clearTimeout(t.timer);
    t.timer=setTimeout(function() { t.Start(); },1000);
   return;
  }
  if (TrainOptions.TrainthroneCheck && Seed.throne.activeSlot!=TrainOptions.TrainthroneSet) {
	 clearTimeout(t.timer);
	 actionLog("AutoFor",Cities.cities[c].name+ " - Mauvais Preset...");
	 t.timer=setTimeout(t.Start,parseIntNan(TrainOptions.timelauch*60)*1000);
     return;
  }
  var populationdispo = 0;
  if(!TrainOptions.listlabour[cityId]) {
   populationdispo = parseIntNan(Seed.citystats['city'+cityId].pop[0]) - parseIntNan(Seed.citystats['city'+cityId].pop[3]);
  }else {
    populationdispo = parseIntNan(Seed.citystats['city'+cityId].pop[0]).toFixed(0);
  }
  var availableTrainingSlots = March.getEmptyQueue(cityId,13);
  maxunite = t.unitemax(cityId, TrainOptions.list[Cities.cities[c].id],(c+1));
  var resources = t.checkresources(cityId, c);
  var barracks2 = 0;

  if (TrainOptions.AsEnabled[c+1]) {
	if (Seed.cityData.city[cityId].isPrestigeCity) {
	  	  var atype = Seed.cityData.city[cityId].prestigeInfo.prestigeType;
	  	  if (atype == 1) {
	         var barracks2 = March.getEmptyQueue(cityId,22);
	         var unitIdAsc = 13;
	         if (barracks2>0)maxunite = t.unitemax(cityId, unitIdAsc,(c+1));
	         var resources = t.checkresources(cityId, c);
	        }else if (atype == 2) {
	  	     var barracks2 = March.getEmptyQueue(cityId,24);
	  	     var unitIdAsc = 14;
	  	     if (barracks2>0)maxunite = t.unitemax(cityId, unitIdAsc,(c+1));
	  	     var resources = t.checkresources(cityId, c);
	  	    }else if (atype == 3) {
			 var barracks2 = March.getEmptyQueue(cityId,26);
	  	     var unitIdAsc = 15;
	  	     var resources = t.checkresources(cityId, c);
	  	     if (barracks2>0)maxunite = t.unitemax(cityId, unitIdAsc,(c+1));
	        } else {
	         var barracks2 = 0;
	        }
   }
 }
 if (!resources) {
    if (Options.LogsAutoForm) actionLog("AutoForm",Cities.cities[c].name+ " - ERREUR : Ressources - possible de faire : "+maxunite+"/"+parseInt(TrainOptions.unitemin[Cities.cities[c].id]));
    //return;
 } else if((!TrainOptions.AsEnabled[c+1] && availableTrainingSlots==0) || (TrainOptions.AsEnabled[c+1] && availableTrainingSlots+barracks2==0)) {
	if (Options.LogsAutoForm)actionLog("AutoForm",Cities.cities[c].name+ " - ERREUR : slot indisponible");

   //return;
    }else if ((maxunite>=parseIntNan(TrainOptions.unitemin[Cities.cities[c].id]) ) || (TrainOptions.AsEnabled[c+1] && maxunite>=parseInt(TrainOptions.AsTroops[c+1]) && barracks2>0)) {

       var unitId = TrainOptions.list[cityId];
       var num = parseInt(maxunite);
       if (barracks2!=0 && TrainOptions.AsEnabled[c+1]) {
        unitId = unitIdAsc;
        gam = 0;
        if (num>=parseInt(TrainOptions.AsMaxTroops[c+1])) num = parseInt(TrainOptions.AsMaxTroops[c+1]);
       } else {
        if (TrainOptions.unitemax[Cities.cities[c].id] != undefined) {
         var maxnum = TrainOptions.unitemax[Cities.cities[c].id];
         if (num>parseInt(maxnum)) num=parseInt(TrainOptions.unitemax[Cities.cities[c].id]);
        }
        var gam= TrainOptions.listboost[cityId];
      }
       var time = uW.modal_barracks_traintime(unitId, num);
         var params = uW.Object.clone(uW.g_ajaxparams);
         params.cid = cityId;
         params.type = unitId;
         params.quant = num;
         if (parseInt(TrainOptions.Item[(c+1)])) {
          params.items = TrainOptions.Item[(c+1)];
         }
         params.gambleId = gam;
         new AjaxRequest(uW.g_ajaxpath + "ajax/train.php" + uW.g_ajaxsuffix, {
           method: "post",
           parameters: params,
           loading: true,
           onSuccess: function(transport) {
            var rslt = eval("(" + transport.responseText + ")");
             if (rslt.ok) {
               var resourceFactors=[],resourceLost;
	              if(gam!=null){
	                time=rslt.timeNeeded;
	       	      }
	               for(var i=1;i<5;i++){
	               if(rslt.gamble){
	                resourceFactors.push(rslt.gamble[i.toString()]);
	               }else{
	               resourceFactors.push(1);
	               }
	               resourceLost=parseInt(uW.unitcost["unt"+unitId][i])*3600*parseInt(num);resourceLost=resourceLost*resourceFactors[i-1];
	               uW.seed.resources["city"+cityId]["rec"+i][0]=parseInt(uW.seed.resources["city"+cityId]["rec"+i][0])-resourceLost;
       }
       var prestige=false;
       if (unitId>12) { prestige=true;t.numcity--; }
         uW.seed.citystats["city"+cityId].gold[0]=parseInt(uW.seed.citystats["city"+cityId].gold[0])-parseInt(uW.unitcost["unt"+unitId][5])*parseInt(num);
         uW.seed.citystats["city"+cityId].pop[0]=parseInt(uW.seed.citystats["city"+cityId].pop[0])-parseInt(uW.unitcost["unt"+unitId][6])*parseInt(num);
         uW.seed.queue_unt["city"+cityId].push([unitId,num,rslt.initTS,parseInt(rslt.initTS)+time,0,time,null,prestige]);

	if(rslt.updateSeed) { uW.update_seed(rslt.updateSeed) }
         if (Options.LogsAutoForm)actionLog("AutoForm",Cities.cities[c].name+" - " + num+" "+uW.unitcost['unt'+ unitId][0]+" OK");
             } else {
              if (Options.LogsAutoForm)actionLog("AutoForm",Cities.cities[c].name+ " - " + num+" "+uW.unitcost['unt'+ unitId][0]+"<br><font color=red>" + transport.responseText +"</font>");
             }
           },
           onFailure: function(o) {
            if (Options.LogsAutoForm)actionLog("AutoForm",Cities.cities[c].name+ " - " + num+" "+uW.unitcost['unt'+ unitId][0]+"<br><font color=red>" +o.responseText+"</font>");
           }
  	});
   } else {
    if (unitId>12 && TrainOptions.AsEnabled[c+1]) {
	   if (Options.LogsAutoForm)actionLog("AutoForm",Cities.cities[c].name+ " - ERREUR : ASCENSION Seulement possible de faire  "+ maxunite + " compris entre " +parseInt(TrainOptions.AsTroops[c+1]) + " et " +parseInt(TrainOptions.AsMaxTroops[c+1]));

	}else{

       if (Options.LogsAutoForm)actionLog("AutoForm",Cities.cities[c].name+ " - ERREUR :  Seulement possible de faire "+maxunite+" sur "+parseInt(TrainOptions.unitemin[Cities.cities[c].id]) +" demande<BR>Cause probable : population ou manque de ressources");
    }

   }

   var cityNo = t.numcity + 1;
   		if (TrainOptions.doTraps[cityNo])
   			t.doAutoTraps(cityNo);
   		if (TrainOptions.doCalrops[cityNo])
   			t.doAutoCaltrops(cityNo);
   		if (TrainOptions.doSpikes[cityNo])
   			t.doAutoSpikes(cityNo);
   		if (TrainOptions.doXbows[cityNo])
			t.doAutoCrossbows(cityNo);
   		if (TrainOptions.doTrebu[cityNo])
			t.doAutoTrebu(cityNo);


    clearTimeout(t.timer);
    t.timer=setTimeout(function() { t.Start(); },5000);

 },
 doAutoTraps: function (cityNo) {
 		var t = Tabs.autoFormation;
 		wall = {};
 		var cityId = Cities.cities[cityNo - 1].id
 		var cityID = 'city'+ cityId;
 		getWallInfo (cityId, wall);
 		availableSpace = wall.fieldSpace - wall.fieldSpaceUsed;
 		if (availableSpace > 0 && wall.slotsBusy < 3) {
 			var food = parseInt (Seed.resources['city'+cityId].rec1[0]/3600);
 			var wood = parseInt (Seed.resources['city'+cityId].rec2[0]/3600);
 			var stone = parseInt (Seed.resources['city'+cityId].rec3[0]/3600);
 			var ore = parseInt (Seed.resources['city'+cityId].rec4[0]/3600);
 			availableSlots = 3 - wall.slotsBusy;
 			var foodRes = TrainOptions.keepFood[cityNo];
 			var woodRes = TrainOptions.keepWood[cityNo];
 			var stoneRes = TrainOptions.keepStone[cityNo];
 			var oreRes = TrainOptions.keepOre[cityNo];
 			var availFood = food - foodRes;
 			var availWood = wood - woodRes;
 			var availStone = stone - stoneRes;
 			var availOre = ore - oreRes;
 		        secsPerTrap = Cities.byID[cityId]['Def60Time'];
 			if (secsPerTrap > 0 && availableSpace > 4 && availableSlots > 0) {
 				if (availFood > 400 && availWood > 800 & availStone > 200 & availOre > 400) {
 					var numberToTrain = 9999999999;
 					if ((availFood / 400) < numberToTrain)
 						numberToTrain = parseInt(availFood / 400);
 					if ((availWood / 800) < numberToTrain)
 						numberToTrain = parseInt(availWood / 800);
 					if ((availStone / 200) < numberToTrain)
 						numberToTrain = parseInt(availStone / 200);
 					if ((availOre / 400) < numberToTrain)
 						numberToTrain = parseInt(availOre / 400);
 					if (numberToTrain > 5)
 						numberToTrain = 5;
 					if (wall.Trap + wall.TrapTraining < 10 || availableSpace < 15) {
 						numberToTrain = 1;
 					}
 					if (Options.LogsAutoForm)actionLog("AutoForm",Cities.byID[cityId].name + ' - Construction ' + numberToTrain + ' piege ');
 					doDefTrain (cityId, 0, 60, numberToTrain);
 				}
 			}
 		}
  },
 doAutoCaltrops: function (cityNo) {
 		var t = Tabs.autoFormation;
 		var wall = {};
 		var cityId = Cities.cities[cityNo - 1].id;
 		var cityID = 'city'+ cityId;
 		getWallInfo (cityId, wall);
 		availableSpace = wall.fieldSpace - wall.fieldSpaceUsed;
 		if (availableSpace > 0 && wall.slotsBusy < 3) {
 			var food = parseInt (Seed.resources['city'+cityId].rec1[0]/3600);
 			var wood = parseInt (Seed.resources['city'+cityId].rec2[0]/3600);
 			var stone = parseInt (Seed.resources['city'+cityId].rec3[0]/3600);
 			var ore = parseInt (Seed.resources['city'+cityId].rec4[0]/3600);
 			availableSlots = 3 - wall.slotsBusy;
 			var foodRes = TrainOptions.keepFood[cityNo];
 			var woodRes = TrainOptions.keepWood[cityNo];
 			var stoneRes = TrainOptions.keepStone[cityNo];
 			var oreRes = TrainOptions.keepOre[cityNo];
 			var availFood = food - foodRes;
 			var availWood = wood - woodRes;
 			var availStone = stone - stoneRes;
 			var availOre = ore - oreRes;
 			secsPerCaltrop = Cities.byID[cityId]['Def61Time'];
 			if (secsPerCaltrop > 0 && availableSpace > 1 && availableSlots > 0) {
 				if (availFood > 100 && availOre > 400) {
 					var numberToTrain = 9999999999;
 					if ((availFood / 100) < numberToTrain)
 						numberToTrain = parseInt(availFood / 100);
 					if ((availOre / 400) < numberToTrain)
 						numberToTrain = parseInt(availOre / 400);
 					if (numberToTrain > 5)
 						numberToTrain = 5;
 					if (wall.Caltrops + wall.CaltropsTraining < 10 || availableSpace < 15) {
 						numberToTrain = 1;
 					}
 					if (Options.LogsAutoForm)actionLog("AutoForm",Cities.byID[cityId].name + ' - Construction ' + numberToTrain + ' chausse-trape ');
 					doDefTrain (cityId,0,61,numberToTrain);
 				}
 			}
 		}
	},
	doAutoSpikes: function (cityNo) {
		var t = Tabs.autoFormation;
		wall = {};
		var cityId = Cities.cities[cityNo - 1].id
		var cityID = 'city'+ cityId;
		getWallInfo (cityId, wall);
		availableSpace = wall.fieldSpace - wall.fieldSpaceUsed;
		if (availableSpace > 0 && wall.slotsBusy < 3) {
			var food = parseInt (Seed.resources['city'+cityId].rec1[0]/3600);
			var wood = parseInt (Seed.resources['city'+cityId].rec2[0]/3600);
			var stone = parseInt (Seed.resources['city'+cityId].rec3[0]/3600);
			var ore = parseInt (Seed.resources['city'+cityId].rec4[0]/3600);
			availableSlots = 3 - wall.slotsBusy;
			var foodRes = TrainOptions.keepFood[cityNo];
			var woodRes = TrainOptions.keepWood[cityNo];
			var stoneRes = TrainOptions.keepStone[cityNo];
			var oreRes = TrainOptions.keepOre[cityNo];
			var availFood = food - foodRes;
			var availWood = wood - woodRes;
			var availStone = stone - stoneRes;
			var availOre = ore - oreRes;
			secsPerSpike = Cities.byID[cityId]['Def62Time'];
			if (secsPerSpike > 0 && availableSpace > 3 && availableSlots > 0) {
				if (availFood > 150 && availWood > 750 & availStone > 50) {
					var numberToTrain = 9999999999;
					if ((availFood / 150) < numberToTrain)
						numberToTrain = parseInt(availFood / 150);
					if ((availWood / 750) < numberToTrain)
						numberToTrain = parseInt(availWood / 750);
					if ((availStone / 50) < numberToTrain)
						numberToTrain = parseInt(availStone / 50);
					if (numberToTrain > 5)
						numberToTrain = 5;
					if (wall.SpikedBarrier + wall.SpikedBarrierTraining < 10 || availableSpace < 15) {
						numberToTrain = 1;
					}
					if (Options.LogsAutoForm)actionLog("AutoForm",Cities.byID[cityId].name + ' - Construction ' + numberToTrain + ' palissade ');
					doDefTrain (cityId, 0, 62, numberToTrain);
				}
			}
		}
	},
	doAutoCrossbows: function (cityNo) {
		var t = Tabs.autoFormation;
		wall = {};
		var cityId = Cities.cities[cityNo - 1].id
		var cityID = 'city'+ cityId;
		getWallInfo (cityId, wall);
		availableSpace = wall.wallSpace - wall.wallSpaceUsed;
		if (availableSpace > 0 && wall.slotsBusy < 2) {
			var food = parseInt (Seed.resources['city'+cityId].rec1[0]/3600);
			var wood = parseInt (Seed.resources['city'+cityId].rec2[0]/3600);
			var stone = parseInt (Seed.resources['city'+cityId].rec3[0]/3600);
			var ore = parseInt (Seed.resources['city'+cityId].rec4[0]/3600);
			availableSlots = 2 - wall.slotsBusy;
			var foodRes = TrainOptions.keepFood[cityNo];
			var woodRes = TrainOptions.keepWood[cityNo];
			var stoneRes = TrainOptions.keepStone[cityNo];
			var oreRes = TrainOptions.keepOre[cityNo];
			var availFood = food - foodRes;
			var availWood = wood - woodRes;
			var availStone = stone - stoneRes;
			var availOre = ore - oreRes;
			secsPerXbow = Cities.byID[cityId]['Def53Time'];
			if (secsPerXbow > 0 && availableSpace > 2 && availableSlots > 0) {
				if (availFood > 250 && availWood > 2000 & availStone > 750 & availOre > 500) {
					var numberToTrain = 9999999999;
					if ((availFood / 250) < numberToTrain)
						numberToTrain = parseInt(availFood / 250);
					if ((availWood / 2000) < numberToTrain)
						numberToTrain = parseInt(availWood / 2000);
					if ((availStone / 750) < numberToTrain)
						numberToTrain = parseInt(availStone / 750);
					if ((availOre / 500) < numberToTrain)
						numberToTrain = parseInt(availOre / 500);
					if (numberToTrain > 5)
						numberToTrain = 5;
					if (wall.Crossbows + wall.CrossbowsTraining < 10 || availableSpace < 15) {
						numberToTrain = 1;
					}
					if (Options.LogsAutoForm)actionLog("AutoForm",Cities.byID[cityId].name + ' - Construction ' + numberToTrain + ' arbaletes ');
					doDefTrain (cityId, 0, 53, numberToTrain);
				}
			}
		}
	},
	doAutoTrebu: function (cityNo) {
		var t = Tabs.autoFormation;
		wall = {};
		var cityId = Cities.cities[cityNo - 1].id
		var cityID = 'city'+ cityId;
		getWallInfo (cityId, wall);
		availableSpace = wall.wallSpace - wall.wallSpaceUsed;
		if (availableSpace > 0 && wall.slotsBusy < 2) {
			var food = parseInt (Seed.resources['city'+cityId].rec1[0]/3600);
			var wood = parseInt (Seed.resources['city'+cityId].rec2[0]/3600);
			var stone = parseInt (Seed.resources['city'+cityId].rec3[0]/3600);
			var ore = parseInt (Seed.resources['city'+cityId].rec4[0]/3600);
			availableSlots = 2 - wall.slotsBusy;
			var foodRes = TrainOptions.keepFood[cityNo];
			var woodRes = TrainOptions.keepWood[cityNo];
			var stoneRes = TrainOptions.keepStone[cityNo];
			var oreRes = TrainOptions.keepOre[cityNo];
			var availFood = food - foodRes;
			var availWood = wood - woodRes;
			var availStone = stone - stoneRes;
			var availOre = ore - oreRes;
			secsPerTrebu = Cities.byID[cityId]['Def55Time'];
			if (secsPerTrebu > 0 && availableSpace > 4 && availableSlots > 0) {
				if (availFood > 500 && availWood > 3500 & availStone > 1800 & availOre > 1200) {
					var numberToTrain = 9999999999;
					if ((availFood / 500) < numberToTrain)
						numberToTrain = parseInt(availFood / 500);
					if ((availWood / 3500) < numberToTrain)
						numberToTrain = parseInt(availWood / 3500);
					if ((availStone / 1800) < numberToTrain)
						numberToTrain = parseInt(availStone / 1800);
					if ((availOre / 1200) < numberToTrain)
						numberToTrain = parseInt(availOre / 1200);
					if (numberToTrain > 5)
						numberToTrain = 5;
					if (wall.Trebuchet + wall.TrebuchetTraining < 10 || availableSpace < 15) {
						numberToTrain = 1;
					}
					if (Options.LogsAutoForm)actionLog("AutoForm",Cities.byID[cityId].name + ' - Construction ' + numberToTrain + ' trebuchet ');
					doDefTrain (cityId, 0, 55, numberToTrain);
				}
			}
		}
	},
 unitemax : function(currentcityid, e, numcity){
 var gumble = TrainOptions.listboost[currentcityid];
 var mult=1;
 if (gumble==0) mult=1;
 if (gumble==1) mult=2;
 if (gumble==2) mult=4;
 var b=new Array();
 var a=new Array();
 for(var d=1;d<5;d++){
  b.push((parseInt(uW.unitcost["unt"+e][d])*3600)*mult);
  a.push(parseInt(uW.seed.resources["city"+currentcityid]["rec"+d][0]))
 }
  b.push((parseInt(uW.unitcost["unt"+e][5]))*mult);
  a.push(parseInt(uW.seed.citystats["city"+currentcityid].gold[0]));
  b.push((parseInt(uW.unitcost["unt"+e][6])));

  if (!TrainOptions.listlabour[currentcityid]) {
    a.push(parseInt(uW.seed.citystats["city"+currentcityid].pop[0])-parseInt(uW.seed.citystats["city"+currentcityid].pop[3]));
  } else {
    a.push(parseInt(uW.seed.citystats["city"+currentcityid].pop[0])-parseInt(uW.seed.citystats["city"+currentcityid].pop[3])+ parseInt((parseInt(uW.seed.citystats["city"+currentcityid].pop[3])*(TrainOptions.Workers[numcity]/100))));
  }
  var c=a[0]/b[0];
  for(var d=1;d<b.length;d++)
  {
    if(parseInt(b[d])!=0){
     c=Math.min(c,a[d]/b[d])
    }
  }
  if (c<0) c=0
  return parseInt(c)||0
 },
 hide : function (){
    var t = Tabs.autoFormation;
    t.saveOptionsAutoF();
  },
 show : function (){
    var t = Tabs.autoFormation;
    uW.BO_AF_TU_Change = t.AF_TU_Change;
    m = "<DIV class=boStat>"+lang.autoForm.title+" - <input type=button value='?' id=boaideautoform class=boAide></div>";
    m += '<div style="height:' + (Options.HauteurBoite-60) +'px;max-height:' + (Options.HauteurBoite-60) +'px;overflow-y:auto"><TABLE width=720 class=ptTab border=0 align=center><tr align=center valign=top><TD>';
    if (TrainOptions.Running == false) {
       m += '<INPUT id=autoFormationtoggle type=submit value="'+lang.autoForm.buttonlabel+' = OFF">';
    } else {
       m += '<INPUT id=autoFormationtoggle type=submit value="'+lang.autoForm.buttonlabel+' = ON">';
    }
    m+="&nbsp;<INPUT id=autoMilicienstoggle type=submit value='"+lang.autoForm.mode+" : '><select id=BOModeFA>";
    var r=0;
	for (y in uW.unitcost) {
	  r++
     m+= "<option value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
    }
    m+="</select></td><td>";
    m+="<input type=checkbox id=BOTrainThroneCheck "+ (TrainOptions.TrainthroneCheck?'CHECKED':'') +"> " + lang.autoCraft.OnlyThroneSet;
		m += " <SELECT id=BOTrainThroneSet>";
			for (i=1;i<=Seed.throne.slotNum;i++){
				m += '<option value="'+i+'">'+i+'</option>';
			}
		m +='</select></td>';

    m+="</tr></table>";
    m += "<TABLE width=100% class=ptTab border=0 align=center cellspacing=0 cellpadding=1>\
          <tr align=center><td align=center style='border-bottom:1px solid black' colspan=2><b>"+uW.g_js_strings.commonstr.city+"</td>\
          <td align=center style='border-bottom:1px solid black'><b>"+uW.g_js_strings.commonstr.troops+"</td>\
          <td align=center style='border-bottom:1px solid black'><b>"+uW.g_js_strings.commonstr.troops+" Min</td>\
          <td align=center style='border-bottom:1px solid black'><b>"+uW.g_js_strings.commonstr.troops+" Max</td>\
          <td align=center style='border-bottom:1px solid black' colspan=2><a id=BO_WorkersCalc><b>"+uW.g_js_strings.showPopTooltip.lbrforce+"</a></td>\
          <tD align=center style='border-bottom:1px solid black'><b>Boost</td></tr>";
    var city=0;
    for (var c=0; c<Cities.numCities; c++) {
     cityId=Cities.cities[c].id;
     var citynum = Seed.cities[c][0];
     city = c+1;
     m+="<tr><td rowspan=4 width=10% align=left style='border-bottom:1px solid black'><b>"+(c+1)+"</b> : "+Cities.cities[c].name+"<br></td><td align=right rowspan=4 style='border-bottom:1px solid black'>";
     if (TrainOptions.listactif && TrainOptions.listactif[cityId] == false) {
      m+="<input type=checkbox id='autoFCheck_"+cityId+"'>";
     }else {
      m+="<input checked type=checkbox id='autoFCheck_"+cityId+"'>";
     }
     m+="</td><TD align=center><SELECT id='autoFType_"+cityId+"' onchange='BO_AF_TU_Change("+cityId+",this.value);'>";
     var r=0;
     for (y in uW.unitcost) {
	  r++
      var faux = 0;
      var uc = uW.unitcost[y];
      if (r>12) {
		 // if (!Seed.cityData.city[cityId].isPrestigeCity) {
		//	    faux = 1;
                break;
		 // }
	  }
	  if (Seed.cityData && Seed.cityData.city[cityId].isPrestigeCity) {

	  }else{
      if (matTypeof(uc[8]) == 'object'){
            for (k in uc[8]){
              var b = getCityBuilding (cityId, k.substr(1));
              if (b.maxLevel < uc[8][k][1]){
                faux = 1;
                break;
              }
            }
          }
	  }
          if (matTypeof(uc[9]) == 'object'){
            for (k in uc[9]){
              if (parseInt(Seed.tech['tch'+k.substr(1)]) < uc[9][k][1]){
 	       faux = 1;
                break;
              }
            }
         }
    if (faux==0) {
	if (TrainOptions.list) {
	   if (r==TrainOptions.list[cityId]) {
		     	               m+= "<option selected value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
           } else {
		     	               m+= "<option value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
	   }
	}else{
	   if (r==2) {
	               m+= "<option selected value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
	              } else {
	               m+= "<option value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
	   }
       }
      }
    }
    if (TrainOptions.unitemax[Cities.cities[c].id] == undefined) TrainOptions.unitemax[Cities.cities[c].id] = 999999;
    if (TrainOptions.ascension[Cities.cities[c].id] == undefined) TrainOptions.ascension[Cities.cities[c].id] = false;
    if (isNaN(parseInt(TrainOptions.unitemin[cityId]))) TrainOptions.unitemin[cityId]=0 ;
    if (TrainOptions.Keep[city] == undefined) TrainOptions.Keep[city] ={};
    m+= "</select></td><td align=left><input type=text value='"+ parseIntNan(TrainOptions.unitemin[cityId]) +"' id='aFunitemin_"+cityId+"' size=4></td><td align=left><input type=text value='"+ parseIntNan(TrainOptions.unitemax[cityId]) +"' id='aFunitemax_"+cityId+"' size=5></td><td align=right>";
    if (TrainOptions.listlabour && TrainOptions.listlabour[cityId] == false) {
         m+="<input type=checkbox class="+city+" id='autoFWorkers_"+cityId+"'>";
    }else {
         m+="<input checked class="+city+" type=checkbox id='autoFWorkers_"+cityId+"'>";
    }
    m+="</td><td align=right>";
    m+='<SELECT class='+city+' id="workers'+city+'"><option value="0">0%</options>';
    m+='<option value="25">25%</options><option value="50">50%</options><option value="75">75%</options><option value="100">100%</options></select></td><td align=right>';
    m+="<select id='autoFboost_"+cityId+"'>";
    m+="<option value=0>Normal</option><option value=1 "+ (TrainOptions.listboost[cityId]==1?'SELECTED ':'') +">5-15%</option><option value=2 "+ (TrainOptions.listboost[cityId]==2?'SELECTED ':'') +">10-25%</option></select>";
    m+='<br><select class='+city+' id="TrainSpeedItem_'+city+'"><option value=0><CENTER>--- '+uW.g_js_strings.commonstr.items+' '+uW.g_js_strings.commonstr.speedup+' ---</center></option>\
 			<option value=36>'+uW.itemlist.i36.name+'</option>\
  			<option value=37>'+uW.itemlist.i37.name+'</option>\
			<option value=38>'+uW.itemlist.i38.name+'</option></select></td></tr>';
    m+='<TR><td colspan=6><img width=23 src="'+gameurl+'img/food_30.png">&nbsp;';
    m += '<INPUT class='+city+'  id="KeepFood'+city+'" type=text size=7 maxlength=8 value="'+ parseIntNan(TrainOptions.Keep[city]['Food'])+'"\>&nbsp;';
    m += '<img width=23 src="'+gameurl+'img/wood_30.png">&nbsp;';
    m += '<INPUT class='+city+' id="KeepWood'+city+'" type=text size=7 maxlength=8 value="'+ parseIntNan(TrainOptions.Keep[city]['Wood'])+'"\>&nbsp;';
    m += '<img width=23 src="'+gameurl+'img/stone_30.png">&nbsp;';
    m += '<INPUT class='+city+'  id="KeepStone'+city+'" type=text size=7 maxlength=8 value="'+ parseIntNan(TrainOptions.Keep[city]['Stone'])+'"\>&nbsp;';
    m += '<img width=23 src="'+gameurl+'img/iron_30.png">&nbsp;';
    m += '<INPUT class='+city+' id="KeepOre'+city+'" type=text size=7 maxlength=8 value="'+ parseIntNan(TrainOptions.Keep[city]['Ore'])+'"\>';
    m += "</td></tr>";
        if(Seed.cityData.city[citynum].prestigeInfo.blessings) {
		        if(Seed.cityData.city[citynum].prestigeInfo.blessings.indexOf(11) != -1) {
		         m += '<tr><td align=left colspan=5><INPUT class='+city+' id=AsEnabled'+city+' type=checkbox '+(TrainOptions.AsEnabled[city]?'CHECKED':'')+'> Auto '+uW.unitcost['unt13'][0]+' Min.: <INPUT class='+city+' id=AsTroops'+city+' type=text size=4 maxlength=6 value="'+TrainOptions.AsTroops[city]+'"> Max.: <INPUT class='+city+' id=AsMaxTroops'+city+' type=text size=4 maxlength=6 value="'+TrainOptions.AsMaxTroops[city]+'"></td></tr>';
		      };
		      if(Seed.cityData.city[citynum].prestigeInfo.blessings.indexOf(21) != -1) {
		         m += '<tr><td align=left colspan=5><INPUT class='+city+' id=AsEnabled'+city+' type=checkbox '+(TrainOptions.AsEnabled[city]?'CHECKED':'')+'> Auto '+uW.unitcost['unt14'][0]+' Min.: <INPUT class='+city+' id=AsTroops'+city+' type=text size=4 maxlength=6 value="'+TrainOptions.AsTroops[city]+'"> Max.: <INPUT class='+city+' id=AsMaxTroops'+city+' type=text size=4 maxlength=6 value="'+TrainOptions.AsMaxTroops[city]+'"></td></tr>';
		      };
		      if(Seed.cityData.city[citynum].prestigeInfo.blessings.indexOf(31) != -1) {
		         m += '<tr><td align=left colspan=5><INPUT class='+city+' id=AsEnabled'+city+' type=checkbox '+(TrainOptions.AsEnabled[city]?'CHECKED':'')+'> Auto '+uW.unitcost['unt15'][0]+' Min.: <INPUT class='+city+' id=AsTroops'+city+' type=text size=4 maxlength=6 value="'+TrainOptions.AsTroops[city]+'"> Max.: <INPUT class='+city+' id=AsMaxTroops'+city+' type=text size=4 maxlength=6 value="'+TrainOptions.AsMaxTroops[city]+'"></td></tr>';
		      };
	   }else{
		   m+='<tr></tr>';
	   }


    m+="<TR><td colspan=8 style='border-bottom:1px solid black'>"+lang.autoForm.DoTraps+" <INPUT class="+city+" type=CHECKBOX id='chkDoTraps"+city+"' "+ (TrainOptions.doTraps[city]?' CHECKED ':'') +">"+uW.fortcost.frt60[0]+"&nbsp;\
        	<INPUT class="+city+" type=CHECKBOX id='chkDoCaltrops"+city+"' "+ (TrainOptions.doCalrops[city]?' CHECKED ':'') +">"+uW.fortcost.frt61[0]+"&nbsp;\
        	<INPUT class="+city+" type=CHECKBOX id='chkDoSpikes"+city+"' "+ (TrainOptions.doSpikes[city]?' CHECKED ':'') +">"+uW.fortcost.frt62[0]+"&nbsp;\
        	<INPUT class="+city+" type=CHECKBOX id='chkDoXbows"+city+"' "+ (TrainOptions.doXbows[city]?' CHECKED ':'') +">"+uW.fortcost.frt53[0].substr(0,9)+"&nbsp;\
       	<INPUT class="+city+" type=CHECKBOX id='chkDoTrebu"+city+"' "+ (TrainOptions.doTrebu[city]?' CHECKED ':'') +">"+uW.fortcost.frt55[0]+"</TD></TR>";
   }
    m+="</table><table width=100% class=ptTab border=0><tr><td><u><b>"+lang.autoForm.options+"</b></u><br>"+lang.autoForm.interval+" <input id=aFtimelauch type=text size=2 value='"+parseInt(TrainOptions.timelauch)+"'> "+lang.General.mins+" "+lang.autoForm.note1;
    m+="<br>"+lang.autoForm.bomodediv+" : <select id=BOModeDiv><option value=25>25%</option><option value=50>50%</option><option value=75>75%</option><option value=90>90%</option><option value=100>100%</option></select> - <input type=button value='"+lang.autoForm.BO_AllCalculate+"' id=BO_AllCalculate>'";
    m+="<br><br>"+lang.autoForm.title2+"</td></tr>\
    <tr><td><u><b>"+lang.autoForm.BO_AF_CancelFirst+"</b></u> <input type=checkbox id=BO_AF_CancelFirst> "+lang.autoForm.CancelTrain+"</td><td><input type=button value='"+uW.g_js_strings.modaltitles.deleteall+"' id=BO_AF_CancelAll></td></tr>\
    <tr><td><span id='BO_AF_Progression'></span></td></tr></table><br></div><br>";

    t.cont.innerHTML = m;
    ById("BOTrainThroneCheck").addEventListener ('click', function(e){ TrainOptions.TrainthroneCheck = e.target.checked;t.saveOptionsAutoF();}, false);
	ById("BOTrainThroneSet").value = TrainOptions.TrainthroneSet;
    ById("BOTrainThroneSet").addEventListener ('change',function(e){TrainOptions.TrainthroneSet = this.value;t.saveOptionsAutoF();}, false);

    ById('boaideautoform').addEventListener('click', function(){
    	       	 window.open(sitesupport+"?page=aide_autoform");
    	} , false);
    for (i=0;i<Seed.cities.length;i++){
            city = i+1;
            ById('workers'+city).value = TrainOptions.Workers[city];
            ById('TrainSpeedItem_'+city).value = TrainOptions.Item[city];
    }
    ById('BOModeDiv').value=TrainOptions.UnitMixValue;
    ById('BOModeDiv').addEventListener('change', function(e){
      TrainOptions.UnitMixValue=ById('BOModeDiv').value;
      for (var c=0; c<Cities.numCities; c++) {
         cityId=Cities.cities[c].id;
         t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);
      }
    },false);
    ById('BO_WorkersCalc').addEventListener('click', function(){
     t.workers();
    } , false);
    ById('BO_AllCalculate').addEventListener('click', function(){
        for (var c=0; c<Cities.numCities; c++) {
     	 cityId=Cities.cities[c].id;
         t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);
      	}
    } , false);
    ById('autoFormationtoggle').addEventListener('click', function(){t.toggleautoFormationState(this)} , false);
    ById('autoMilicienstoggle').addEventListener('click', function(){t.milicien()} , false);
    ById('BO_AF_CancelAll').addEventListener('click', function(){t.AF_CancelAll()} , false);
    t.dispStatus = ById('BO_AF_Progression');
    var k=0;
    window.addEventListener('unload', t.onUnload, false);
    for (var c=0; c<Cities.numCities; c++) {
      k=c+1;
      cityID=Cities.cities[c].id;
      ById('aFunitemin_'+cityID).addEventListener('change', function(){
		  t.saveOptionsAutoF();
	  },false);
      ById('aFunitemax_'+cityID).addEventListener('change', function(){
		  t.saveOptionsAutoF();
      },false);
      if(ById('AsEnabled'+k)) {
		ById('AsEnabled'+k).checked = TrainOptions.AsEnabled[k];
		ById('AsTroops'+k).value = parseIntNan(TrainOptions.AsTroops[k]);
		ById('AsMaxTroops'+k).value = parseIntNan(TrainOptions.AsMaxTroops[k]);
		if (ById('AsMaxTroops'+k).value<ById('AsTroops'+k).value) {
			ById('AsMaxTroops'+k).value= ById('AsTroops'+k).value;
			TrainOptions.AsMaxTroops[k]=ById('AsTroops'+k).value;
 			saveTrainingOptions();
		}
        ById('AsEnabled'+k).addEventListener('change', function(e){
	      TrainOptions.AsEnabled[e.target['className']] = e.target.checked;
	      saveTrainingOptions();
	    }, false);
	    ById('AsTroops'+k).addEventListener('change', function(e){
	       if (isNaN(e.target.value)) e.target.value=0 ;
	       TrainOptions.AsTroops[e.target['className']] = e.target.value;
	        saveTrainingOptions();
	     }, false);
	    ById('AsMaxTroops'+k).addEventListener('change', function(e){
			if (isNaN(e.target.value)) e.target.value=0;
			if (TrainOptions.AsTroops[e.target['className']]>e.target.value) e.target.value=TrainOptions.AsTroops[e.target['className']];
			TrainOptions.AsMaxTroops[e.target['className']] = e.target.value;
			saveTrainingOptions();
	    }, false);
     }
      ById('autoFWorkers_'+cityID).addEventListener('click', function(e){
    	   cityId=Cities.cities[(e.target['className']-1)].id;
    	   TrainOptions.listlabour[cityId] = ById('autoFWorkers_'+cityId).checked;
	       t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);

      },false);
      ById('TrainSpeedItem_'+k).addEventListener('change', function(e){
	      TrainOptions.Item[e.target['className']] = e.target.value;
	      saveTrainingOptions();
	  }, false);
    	  ById('workers'+k).addEventListener('change', function(e){
	   TrainOptions.Workers[e.target['className']] = e.target.value;
	   cityId=Cities.cities[(e.target['className']-1)].id;
    	   t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);

      	  }, false);

    	 ById('chkDoTraps'+k).addEventListener('click', function(e){
    			TrainOptions.doTraps[e.target['className']] = e.target.checked;
         		saveTrainingOptions();
		}, false);
	ById('chkDoCaltrops'+k).addEventListener('click', function(e){
    			TrainOptions.doCalrops[e.target['className']] = e.target.checked;
         		saveTrainingOptions();
		}, false);
	ById('chkDoSpikes'+k).addEventListener('click', function(e){
    			TrainOptions.doSpikes[e.target['className']] = e.target.checked;
         		saveTrainingOptions();
		}, false);
       ById('chkDoXbows'+k).addEventListener('click', function(e){
    			TrainOptions.doXbows[e.target['className']] = e.target.checked;
         		saveTrainingOptions();
		}, false);
	 ById('chkDoTrebu'+k).addEventListener('click', function(e){
    			TrainOptions.doTrebu[e.target['className']] = e.target.checked;
         		saveTrainingOptions();
		}, false);
		ById('KeepFood'+k).addEventListener('change', function(e){
			if (isNaN(e.target.value)) e.target.value=0 ;
            TrainOptions.Keep[e.target['className']]['Food'] = e.target.value;
            saveTrainingOptions();
      	}, false);
      	ById('KeepWood'+k).addEventListener('change', function(e){
      	    if (isNaN(e.target.value)) e.target.value=0 ;
            TrainOptions.Keep[e.target['className']]['Wood'] = e.target.value;
            saveTrainingOptions();
      	}, false);
      	ById('KeepStone'+k).addEventListener('change', function(e){
			if (isNaN(e.target.value)) e.target.value=0 ;
            TrainOptions.Keep[e.target['className']]['Stone'] = e.target.value;
            saveTrainingOptions();
      	}, false);
      	ById('KeepOre'+k).addEventListener('change', function(e){
      	    if (isNaN(e.target.value)) e.target.value=0 ;
            TrainOptions.Keep[e.target['className']]['Ore'] = e.target.value;
            saveTrainingOptions();
      	}, false);
    }
  },
  unload:function() {
   var t = Tabs.autoFormation;
   t.saveOptionsAutoF();
  },
  checkresources : function(cityId, city){
  	var t = Tabs.autoFormation;
  	var city=city+1;
  	t.food = parseInt((Seed.resources['city'+cityId].rec1[0]/3600) - parseIntNan(TrainOptions['Keep'][city]['Food']));
  	t.wood = parseInt((Seed.resources['city'+cityId].rec2[0]/3600) - parseIntNan(TrainOptions['Keep'][city]['Wood']));
  	t.stone = parseInt((Seed.resources['city'+cityId].rec3[0]/3600) - parseIntNan(TrainOptions['Keep'][city]['Stone']));
  	t.ore = parseInt((Seed.resources['city'+cityId].rec4[0]/3600) - parseIntNan(TrainOptions['Keep'][city]['Ore']));
  	if(t.food>0 && t.wood>0 && t.stone>0 && t.ore>0){
  		return true;
  	}
  	return false;
  },
    AF_TU_Change: function(cityId,unit) {
     var t = Tabs.autoFormation;
     var coutenpop= uW.unitcost['unt'+unit][6];
     var numcity=Cities.byID[cityId].idx+1;
     var X = Seed.citystats['city'+cityId]["pop"][1];
     var Y = uW.seed.citystats["city"+cityId].pop[3];
     var Q= coutenpop;
     var Z = 0;
     var M = ById("BOModeDiv").value/100;
     if (ById("autoFWorkers_"+cityId).checked) {
        Z = ById('workers'+numcity).value/100;
        ById("aFunitemax_"+cityId).value = parseIntNan(X/Q);
     } else {
      Z = 0;
      ById("aFunitemax_"+cityId).value=parseIntNan((X-Y)/Q);
     }
     var Min =((X-(Y*(1-Z)))*M)/Q;
     if (Min<0) Min=0;
     ById("aFunitemin_"+cityId).value = parseIntNan(Min);
     if (ById("aFunitemax_"+cityId).value<0) { ById("aFunitemax_"+cityId).value=0;ById("aFunitemin_"+cityId).value =0; }
     t.saveOptionsAutoF();
  },

  workers:function() {
   var t = Tabs.autoFormation;
   for (var c=0; c<Cities.numCities; c++) {
    if (ById('workers'+(c+1)).value == "100")
     ById('workers'+(c+1)).value = "25"
    else
     ById('workers'+(c+1)).value = "100";

    TrainOptions.Workers[(c+1)] = ById('workers'+(c+1)).value ;
    cityId=Cities.cities[c].id;
    t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);
   }
   t.saveOptionsAutoF();
  },
  milicien: function() {
   var t = Tabs.autoFormation;
   var typeunite = ById('BOModeFA').value;
   ById('BOModeDiv').value="90";
   var coutenpop= uW.unitcost['unt'+typeunite][6];
   for (var c=0; c<Cities.numCities; c++) {
    cityId=Cities.cities[c].id;
    ById("autoFWorkers_"+Cities.cities[c].id).checked=true;
    ById("autoFCheck_"+Cities.cities[c].id).checked=true;
    ById("autoFType_"+Cities.cities[c].id).value=typeunite;
    t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);
   }
   for (var c=0; c<Cities.numCities; c++) {
        cityId=Cities.cities[c].id;
        t.AF_TU_Change(cityId,ById("autoFType_"+cityId).value);
   }
   t.saveOptionsAutoF();
  },
  saveOptionsAutoF: function() {
     var t = Tabs.autoFormation;
     if (parseIntNan(ById('aFtimelauch').value) < 3)  ById('aFtimelauch').value = "3";
     TrainOptions.timelauch=ById('aFtimelauch').value;
     TrainOptions.UnitMixValue=ById('BOModeDiv').value;

     TrainOptions.list={};
     TrainOptions.listDis={};
     TrainOptions.DisX={};
     TrainOptions.listactif={};
     TrainOptions.listlabour={};
     TrainOptions.unitemin={};
     TrainOptions.unitemax={};
     TrainOptions.listboost={};
     for (var c=0; c<Cities.numCities; c++) {
        TrainOptions.list[Cities.cities[c].id] = ById('autoFType_'+Cities.cities[c].id).value;
        TrainOptions.listactif[Cities.cities[c].id] = ById('autoFCheck_'+Cities.cities[c].id).checked;
        TrainOptions.listlabour[Cities.cities[c].id] = ById('autoFWorkers_'+Cities.cities[c].id).checked;
        TrainOptions.unitemin[Cities.cities[c].id]=parseIntNan(ById('aFunitemin_'+Cities.cities[c].id).value);
        TrainOptions.unitemax[Cities.cities[c].id]=parseIntNan(ById('aFunitemax_'+Cities.cities[c].id).value);
        TrainOptions.listboost[Cities.cities[c].id]=ById('autoFboost_'+Cities.cities[c].id).value;
        TrainOptions.Workers[(c+1)] = ById('workers'+(c+1)).value;
        TrainOptions.Item[(c+1)] = ById('TrainSpeedItem_'+(c+1)).value;
     }
     saveTrainingOptions();
  },
  toggleautoFormationState : function(obj) {
     var t = Tabs.autoFormation;
     obj = ById('autoFormationtoggle');
     if (TrainOptions.Running == true) {
              TrainOptions.Running = false;
              clearTimeout(t.timer);
              if (obj) obj.value = lang.autoForm.buttonlabel+" = OFF";
              if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+' - OFF', 'pbformtab');
              saveTrainingOptions();
      }  else {
              TrainOptions.Running = true;
              clearTimeout(t.timer);
              t.numcity=-1;
              t.timer=setTimeout(t.Start,5000);
              if (obj) obj.value = lang.autoForm.buttonlabel+" = ON";
              if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+" - ON", 'pbformtab');
              saveTrainingOptions();
      }
   },
    CancelActionall: function(numville, num, fintraitement,banzai) {

        var t = Tabs.autoFormation;
        var first=1;
        var cityId = Cities.cities[numville].id;
        var q = Seed.queue_unt['city'+cityId];
        var now = unixTime();
        start = q[num][2];
        end = q[num][3];
        actual = end - now;
        if (actual < 0) actual = 0;
        var param2=cityId;
        var param3=q[num][0];
        var param4=q[num][1];
        var param5=end;t
        var param6=start;
        var param7=actual;
        var params = uW.Object.clone(uW.g_ajaxparams);
             params.cityId = param2;
             params.requestType ="CANCEL_TRAINING";
             params.numtrptrn = param4;
             params.trnETA= param5;
             params.trnNeeded = param7;
             params.trnTmp = param6;
             params.typetrn= param3;

          new MyAjaxRequest(uW.g_ajaxpath + "ajax/cancelTraining.php" + uW.g_ajaxsuffix, {
                  method: "post",
                  parameters: params,
                onSuccess: function (rslt) {
                 var t = Tabs.autoFormation;
                 if (rslt.ok) {
                   if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
        	       var k=0;for(var j=0;j<uW.seed.queue_unt["city"+param2].length;j++){
        	        if(j>num){
        	         Seed.queue_unt["city"+param2][j][2]=parseInt(rslt.dateTraining[k]["start"]);
        	         Seed.queue_unt["city"+param2][j][3]=parseInt(rslt.dateTraining[k]["end"]);
        	         k++;
        	         }
        	        }
        	        Seed.queue_unt["city"+param2].splice(num,1);
        	        for(var i=1;i<5;i++){
        	         var totalReturn=parseInt(uW.unitcost["unt"+param3][i])*parseInt(param4)*3600/2;
        	         Seed.resources["city"+param2]["rec"+i][0]=parseInt(Seed.resources["city"+param2]["rec"+i][0])+totalReturn;
        	        }


                   t.crfil++;
     		ById('BO_AF_Progression').innerHTML = "<b><i>"+uW.g_js_strings.commonstr.loadingddd+" " + t.crfil+ " / " +t.nbfil +"</i></b>";
     	        var numnew = num - 1;
     	        if (numnew<fintraitement) {
   		  		 if (numville==Cities.numCities) {
   		  		  ById('BO_AF_Progression').innerHTML = "<font color=#880000><B>Termine...</b></font>";

   		  		  return;
   		  		 }
   		  		 numville++;
   		  		   		 var cityId = Cities.cities[numville].id;
   				 		 var q = Seed.queue_unt['city'+cityId];
   				   		 numnew=q.length-1;
   				   		if (q.length<=fintraitement) {
   				   		 ById('BO_AF_Progression').innerHTML = "<font color=#550000><B>Error...</b></font>";
   				   		 return;
   		  		}
   		  		 setTimeout(function (){
   				    t.CancelActionall(numville, numnew, fintraitement, banzai);
   		  		 }, (Math.random()*100)+100 );
   		  	        } else {
   		  	          setTimeout(function (){
   		  	            t.CancelActionall(numville, numnew, fintraitement, banzai);
   		  		  }, (Math.random()*100)+100 );

			}
                 } else {
                  ById('BO_AF_Progression').innerHTML = "<font color=#550000><B>"+lang.autoForm.err1+"</b></font>";
                 }
                },
                onFailure: function (rslt) {
                 var t = Tabs.autoFormation;
                 ById('BO_AF_Progression').innerHTML = "<font color=#550000><B>"+lang.autoForm.err1+"</b></font>";
                }
         });
       setTimeout(uW.update_seed_ajax, 250);
     },
     AF_CancelAll: function() {
      var t = Tabs.autoFormation;
      t.nbfil=0;
      t.crfil=0;
      var debutsup = 1;
      if ( ById('BO_AF_CancelFirst').checked) {
       var debutsup=0 ;
      }
       for(i=0; i<Cities.numCities; i++) {
        var cityId = Cities.cities[i].id;
        var q = Seed.queue_unt['city'+cityId];
        t.nbfil += q.length - debutsup;
       }
      for(i=0; i<Cities.numCities; i++) {
       var cityId = Cities.cities[i].id;
       var q = Seed.queue_unt['city'+cityId];
       if (q.length>debutsup) {
        obj = ById('autoFormationtoggle');
        TrainOptions.Running = false;
        if (obj) obj.value = lang.autoForm.buttonlabel+" = OFF";
        if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+' - OFF', 'pbformtab');
        saveTrainingOptions();
        t.CancelActionall(i, q.length-1, debutsup, false);
        return false;
       }
      }
  },
}

/*************************************** FORMATION ***********************************************/
Tabs.Train = {
  tabOrder: 8,
  tabLabel: uW.g_js_strings.commonstr.train,
  cont : null,
  timer : null,
  state : null,
  stats : {},
  selectedCity : {},
  sourceCity : {},
  destinationCity : {},

  show : function (){
   var t = Tabs.Train;
   t.displayCityStats();
   t.changeTroopSelect();
   t.changeDefSelect();
   t.timer = setTimeout (t.show, 4000);
  },

  hide : function (){
    var t = Tabs.Train;
    clearTimeout (t.timer);
  },
  renvoyer : function(typeunit, cityId) {
   var t = Tabs.Train;
   var qte = parseInt(Seed.citystats["city"+cityId]["pop"][1]) - parseInt(Seed.citystats['city'+cityId].pop[0]);
   var a=prompt("Renvoyer les unites - "+uW.unitcost['unt'+typeunit][0]+" - Quantite ?", qte);
   if (parseInt(a)>0) {
     a = parseInt(a);
     nbcity = Seed.units["city"+cityId]["unt"+typeunit];
     if (a<=nbcity) {
     var params = uW.Object.clone(uW.g_ajaxparams);
           params.cid = cityId;
           params.quant = a;
           params.type = typeunit;
               new MyAjaxRequest(uW.g_ajaxpath + "ajax/dismissUnits.php" + uW.g_ajaxsuffix, {
     	        method: "post",
     	        parameters: params,
	        onSuccess: function (rslt) {
                 if (rslt.ok){
     		  Seed.units["city"+cityId]["unt"+typeunit]=parseInt(Seed.units["city"+cityId]["unt"+typeunit])-parseInt(a);
     		   t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>Renvoi OK</font>';
                 }else{
					 t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>Renvoi ERREUR : '+rslt.msg+'</font>';
				 }
       		},
			        onFailure: function (rslt) {
			          t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>Renvoi ERREUR</font>';
			        },
    	});

    }
   }


  },
  init : function (div){
    var t = Tabs.Train;
    t.cont = div;
    uW.BOcancelTraining = t.cancelTrainingBO;
    uW.BOcancelFort = t.butcancelFort;
    uW.BoRenvoyer = t.renvoyer;

    if (t.state == null){

      s = "<DIV id=trainTopSelect >\
        <DIV class=boStat>"+lang.Train.title+"</div><DIV style='height:10px'></div><DIV class=ptentry>\
        <DIV style='text-align:center; margin-bottom:10px;'>"+uW.g_js_strings.commonstr.city+" : &nbsp; <span id=ptspeedcity></span></div>\
        <TABLE class=ptTab width=100%><TR valign=top><TD width=50%>\
        <TABLE align=center><TR><TD align=right>"+uW.g_js_strings.commonstr.troops+" : </td><TD colspan=2><table border=0 width=100%><tr><td>\
        <SELECT id=ptttType>";
        var r=0;
       for (y in uW.unitcost) {
			r++
         if (r==2) {
          s+= "<option selected value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
         } else {
          s+= "<option value='"+r+"'>"+uW.unitcost[y][0]+"</option>";
         }
        }
        if (Seed.items.i36){tutel1=Seed.items.i36}else{tutel1=0};
        if (Seed.items.i37){tutel2=Seed.items.i37}else{tutel2=0};
        if (Seed.items.i38){tutel3=Seed.items.i38}else{tutel3=0};
        if (Seed.items.i26){siege1=Seed.items.i26}else{siege1=0};
       s+= " </select> <br> (max <span id=ptttSpMax></span>)</td><td><span id=BOEntrTro></span></td></tr></table></td></tr>\
        <TR><TD align=right>par slot de </td><TD><INPUT id='ptttInpPS' size=5 type='text' value='0'\></td>\
          <TD><INPUT id='ptttButMaxPS' type=submit value='max'\> &nbsp; (max <span id=ptttSpMaxPS>0</span>)</td></tr>\
        <TR><TD align=right>sur</td><TD><INPUT id='ptttInpSlots' size=2 type='text' value='1'\> slots</td>\
          <TD width=75%><INPUT id='ptttButMaxSlots' type=submit value='max'\> &nbsp; (max <span id=ptttSpMaxSlots>1</span>)</td></tr>\
        <TR><TD align=right valign=top>"+uW.g_js_strings.showPopTooltip.lbrforce+" : </td><TD colspan=2><INPUT type=CHECKBOX id=chkPop"+ (Options.maxIdlePop?' CHECKED ':'') +">\
        - Boost: <SELECT id=BOGamble>\
        <option value='0'>-</option>\
        <option value='1'>5% - 15%</option>\
        <option value='2'>10% - 25%</option>\
        </select>\
        <br><SELECT id=tutelage>\
		<option value='0'><CENTER>--- "+uW.g_js_strings.commonstr.speedup+" ---</center></option>\
		<option value='36'>"+ uW.itemlist.i36.name+" ("+tutel1+")</option>\
        <option value='37'>"+ uW.itemlist.i37.name+" ("+tutel2+")</option>\
        <option value='38'>"+ uW.itemlist.i38.name+" ("+tutel3+")</option>\
		</select>\</td></tr>\
        <TR><TD colspan=3 align=center><DIV style='height:10px'></div><INPUT id='ptttButDo' type=submit value='"+uW.g_js_strings.modal_openBarracks.trainttl+"'\>\
        <br><span id='BOmodal_barracks_traintime'>"+uW.g_js_strings.modal_barracks_trainingtab.esttime+" :</span></td></tr>\
        </table></td><TD width=20></td><TD style='border-left:solid 2px;' width=50% align=center>\
        <TABLE align=center><TR><TD align=right>"+uW.g_js_strings.commonstr.defense+": </td><TD colspan=2>\
      <SELECT id=pttdType>\
        <option value='53'>"+uW.fortcost.frt53[0]+"</option>\
        <option value='55'>"+uW.fortcost.frt55[0]+"</option>\
        <option value='60'>"+uW.fortcost.frt60[0]+"</option>\
        <option value='61'>"+uW.fortcost.frt61[0]+"</option>\
        <option value='62'>"+uW.fortcost.frt62[0]+"</option>\
      </select> <br> (<span id=pttdSpMax></span>)</td></tr>\
        <TR><TD align=right>"+lang.Train.pttdInpPS+"</td><TD><INPUT id='pttdInpPS' size=5 type='text' value='0'\></td>\
          <TD><INPUT id='pttdButMaxPS' type=submit value='max'\> (max <span id=pttdSpMaxPS>0</span>)</td></tr>\
        <TR><TD align=right># </td><TD><INPUT id='pttdInpSlots' size=2 type='text' value='1'\> slots</td>\
          <TD width=75%><INPUT id='pttdButMaxSlots' type=submit value='max'\> (max <span id=pttdSpMaxSlots>1</span>)</td></tr>\
        <TR align=center><TD colspan=3><SPAN id=pttdSpace></span></td></tr>\
         <TR><TD colspan=3 align=center><DIV style='height:10px'>\
      <SELECT id=siege>\
      <option value='0'><CENTER>--- "+uW.g_js_strings.commonstr.speedup+" ---</center></option>\
      <option value='26'>"+ uW.itemlist.i26.name+" ("+siege1+")</option>\
      </select></div>\
      <BR><INPUT id='pttdButDo' type=submit value='"+uW.g_js_strings.modal_openWalls.builddefenses+"'\>\
      <br><span id='BOmodal_barracks_deftime'>"+uW.g_js_strings.modal_barracks_trainingtab.esttime+" :</span> </td></tr></table>\
      </td></tr></table></div></div><TABLE align=center width=100% class=ptTab><TR><TD><div id=ptTrainStatus style='overflow-y:auto; max-height:40px; height: 40px;'></div></td></tr></table>\
      <div style='height: "+(Options.HauteurBoite-370)+"pxpx; max-height:"+(Options.HauteurBoite-370)+"px; overflow-y:auto'>\
      <br><TABLE width=100% class=ptTab><TR><TD colspan=3><DIV id=divSTtop></div></td></tr>\
      <TR><TD rowspan=2 width=50% style='padding-left:3px; padding-right:3px'><DIV style='text-align:center'><div class=boStat><img id=BOCancelAllTrain valign=absmiddle border=0 title='Annuler toutes les formations' src='"+CANCELBTN+"'>&nbsp;&nbsp;<B>"+lang.Train.troops+" (<SPAN id=statTTtot></span>)</b></span></div></div>\
      <DIV id=divSTleft style='padding:3px; box-shadow:inset 0px 0px 3px #000; overflow-y: auto; height:"+(Options.HauteurBoite-570)+"px; max-height:"+(Options.HauteurBoite-570)+"px'></div></td>\
          <TD valign=top width=50% style='top:0px;padding-left:3px; padding-right:3px'><DIV style='text-align:center'><div  class=boStat><B>"+lang.Train.def+" (<SPAN id=statDTtot></span>)</b></div></div>\
      <DIV id=divSTright style='padding:3px;box-shadow:inset 0px 0px 3px #000; overflow-y: auto; height:"+(Options.HauteurBoite-640)+"px; max-height:"+(Options.HauteurBoite-640)+"px'></div></td></tr>\
      <TR><TD width=50% style='padding-left:3px; padding-right:3px'><DIV style='text-align:center'><div class=boStat><B>"+lang.Train.troops+" (<SPAN id=statTTtot2></span>)</b></span></div></div><DIV id=divSTleft2 style='padding:3px; box-shadow:inset 0px 0px 3px #000; overflow-y: auto; height:45px; max-height:45px'></div></td>\
          </tr>\
        </div></div>";
      t.cont.innerHTML = s;

      var dcp = new CdispCityPicker ('ptspeed', ById('ptspeedcity'), true, t.clickCitySelect, 0);
      t.TTspMax = ById ('ptttSpMax');
      t.BOGamble = ById ('BOGamble');
      t.TTspMaxPS = ById ('ptttSpMaxPS');
      t.TTspMaxSlots = ById ('ptttSpMaxSlots');
      t.TTbutMaxSlots = ById ('ptttButMaxSlots');
      t.TTbutMaxPerSlot = ById ('ptttButMaxPS');
      t.TTinpPerSlot = ById ('ptttInpPS');
      t.TTinpSlots = ById ('ptttInpSlots');
      t.TTselType = ById ('ptttType');
      t.TTbutDo = ById ('ptttButDo');
      t.TDspMax = ById ('pttdSpMax');
      t.TDspMaxPS = ById ('pttdSpMaxPS');
      t.TDspMaxSlots = ById ('pttdSpMaxSlots');
      t.TDbutMaxSlots = ById ('pttdButMaxSlots');
      t.TDbutMaxPerSlot = ById ('pttdButMaxPS');
      t.TDinpPerSlot = ById ('pttdInpPS');
      t.TDinpSlots = ById ('pttdInpSlots');
      t.TDselType = ById ('pttdType');
      t.TDbutDo = ById ('pttdButDo');
      t.TDspSpace = ById ('pttdSpace');
      t.divTrainStatus = ById ('ptTrainStatus');
      t.TTinpSlots.addEventListener ('change', t.updateTopTroops, false);
      t.BOGamble.addEventListener ('change', t.changeTroopSelect, false);
      t.TTbutMaxPerSlot.addEventListener ('click', t.clickTroopMaxPS, false);
      t.TTbutMaxSlots.addEventListener ('click', t.clickTroopMaxSlots, false);
      t.TTselType.addEventListener ('change', t.changeTroopSelect, false);
      t.TTbutDo.addEventListener ('click', t.clickTroopDo, false);
      t.TDinpSlots.addEventListener ('change', t.updateTopDef, false);
      t.TDselType.addEventListener ('change', t.changeDefSelect, false);
      t.TDbutMaxPerSlot.addEventListener ('click', t.clickDefMaxPS, false);
      t.TDbutMaxSlots.addEventListener ('click', t.clickDefMaxSlots, false);
      t.TDbutDo.addEventListener ('click', t.clickDefDo, false);
      ById ('BOCancelAllTrain').addEventListener ('click', t.CancelAllTraining, false);
      ById ('chkPop').addEventListener ('change', t.clickCheckIdlePop, false);
      t.state = 1;
    }
  },
  updateTopTroops : function (){
    var t = Tabs.Train;
			var slots = parseIntNan(t.TTinpSlots.value);
			var id = t.TTselType.value;
			if (isNaN(slots) || slots<0)
				slots = 0;
			t.TTspMax.innerHTML = t.stats.MaxTrain;
			if (id <=12 || id == 16)
				t.TTspMaxSlots.innerHTML = t.stats.barracks - t.stats.queued;
			else
				t.TTspMaxSlots.innerHTML = t.stats.barracks2 - t.stats.queued2;

			if (slots<1 ||
					(t.stats.barracks-t.stats.queued < 1 && (id <=12 || id == 16)) ||
					(t.stats.barracks2-t.stats.queued2 < 1 && (id >12 && id !=16)))
				t.TTspMaxPS.innerHTML = 0;
			else
			t.TTspMaxPS.innerHTML = parseInt(t.stats.MaxTrain / slots);
  },


  clickTroopMaxPS : function (){
    var t = Tabs.Train;
    	var slots = parseIntNan(t.TTinpSlots.value);
			var id = t.TTselType.value;
				if (slots<1 ||
							(t.stats.barracks-t.stats.queued < 1 && (id <=12 || id == 16)) ||
				(t.stats.barracks2-t.stats.queued2 < 1 && (id >12 && id !=16)))
				t.TTinpPerSlot.value = 0;
			else
			t.TTinpPerSlot.value = parseInt(t.stats.MaxTrain / slots);

  },

  clickTroopMaxSlots : function (){
    var t = Tabs.Train;
    var id = t.TTselType.value;
    t.TTinpSlots.value = t.stats.barracks - t.stats.queued;

    if (id>12 && id!=16)
		 t.TTinpSlots.value = t.stats.barracks2 - t.stats.queued2;

  },

  clickCitySelect : function (city){
    var t = Tabs.Train;
    t.selectedCity = city;
    t.lastQueString = null;
    t.lastDQueString = null;
    t.displayCityStats ();
    t.changeTroopSelect();
    t.changeDefSelect();
  },

  clickCheckIdlePop : function (){
    var t = Tabs.Train;
    if (ById ('chkPop').checked)
      Options.maxIdlePop = true;
    else
      Options.maxIdlePop = false;
    saveOptions ();
    t.displayCityStats ();
    t.changeTroopSelect ();
  },
  limitingFactor : null,
  changeTroopSelect : function (){
    var t = Tabs.Train;
    var cityId = t.selectedCity.id;
    var id = t.TTselType.value;
    ById("BOEntrTro").innerHTML='<img height=30 src='+gameurl+'img/units/unit_'+id+'_30.jpg?6545>';
    t.lastTroopSelect = id;
    t.limitingFactor = null;
    var uc = uW.unitcost['unt'+id];
    if (parseInt(id)>12 && parseInt(id)!=16) {
			  if (!Seed.cityData.city[cityId].isPrestigeCity) {
				   t.stats.MaxTrain = 0;
          		   t.limitingFactor = null;
	               t.updateTopTroops();
	               return;
			  }else{
				if (Seed.cityData.city[cityId].prestigeInfo.prestigeType==1 && id!=13) {
			      t.stats.MaxTrain = 0;
				  t.limitingFactor = null;
				  t.updateTopTroops();
	              return;
			    }
			    if (Seed.cityData.city[cityId].prestigeInfo.prestigeType==2 && id!=14) {
							      t.stats.MaxTrain = 0;
								  t.limitingFactor = null;
								  t.updateTopTroops();
					              return;
			    }
			    if (Seed.cityData.city[cityId].prestigeInfo.prestigeType==3 && id!=15) {
											      t.stats.MaxTrain = 0;
												  t.limitingFactor = null;
												  t.updateTopTroops();
									              return;
			    }
			  }
	}
    var a=1
    var gumble= t.BOGamble.value;
    if (gumble==0) a=1;
    if (gumble==1) a=2;
    if (gumble==2) a=4;
    var max = 9999999999;
    if ( (t.stats.food / (uc[1]*a)) < max){
      max = t.stats.food / (uc[1]*a);
      t.limitingFactor = 'food';
    }
    if ( (t.stats.wood / (uc[2]*a)) < max){
      max = t.stats.wood / (uc[2]*a);
      t.limitingFactor = 'wood';
    }
    if ( (t.stats.stone / (uc[3]*a)) < max){
      max = t.stats.stone / (uc[3]*a);
      t.limitingFactor = 'stone';
    }
    if ( (t.stats.ore / (uc[4]*a)) < max){
      max = t.stats.ore / (uc[4]*a);
      t.limitingFactor = 'ore';
    }
    if ( (t.stats.idlePop / uc[6]) < max){
      max = t.stats.idlePop / (uc[6]);
      t.limitingFactor = 'pop';
    }
    t.stats.MaxTrain = parseInt (max);
    if (t.stats.MaxTrain < 0)
      t.stats.MaxTrain = 0;

    if (Seed.cityData && Seed.cityData.city[cityId].isPrestigeCity) {

	}else{
    if (matTypeof(uc[8]) == 'object'){
      for (k in uc[8]){
        var b = getCityBuilding (cityId, k.substr(1));
        if (b.maxLevel < uc[8][k][1]){
          t.stats.MaxTrain = 0;
          t.limitingFactor = null;
          break;
        }
      }
    }
    }
    if (matTypeof(uc[9]) == 'object'){
      for (k in uc[9]){
        if (parseInt(Seed.tech['tch'+k.substr(1)]) < uc[9][k][1]){
          t.stats.MaxTrain = 0;
          t.limitingFactor = null;
          break;
        }
      }
    }
    if (parseInt(id)==16) {
			if (parseInt(uW.ksoItems[34001].count)<t.stats.MaxTrain)	{
				t.stats.MaxTrain = parseInt(uW.ksoItems[34001].count);
				t.limitingFactor = null;
			}
	}
    t.updateTopTroops();
  },

  clickTroopDo : function (){
    var t = Tabs.Train;
    var cityId = t.selectedCity.id;
    //unsafeWindow.citysel_click(ById('citysel_'+ (t.selectedCity.idx+1)+''));
    var unitId = t.TTselType.value;
    var perSlot = parseInt(t.TTinpPerSlot.value, 10);
    var numSlots = parseInt(t.TTinpSlots.value, 10);
    t.displayCityStats ();
    if (perSlot<1){
      t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err1+'</font>';
      return;
    }
    if (perSlot*numSlots > t.stats.MaxTrain){
      t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err3+' '+ t.stats.MaxTrain +')</font>';
      return;
    }
    if (unitId<13 && (numSlots<1 || numSlots>t.stats.barracks - t.stats.queued)){
      t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err2+'</font>';
      return;
    }
    if (unitId>12 && unitId!=16 && (numSlots<1 || numSlots>t.stats.barracks2 - t.stats.queued2)){
     t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err2+'</font>';
      return;
    }

    var tut = document.getElementById ('tutelage').value;
    var gam = t.BOGamble.value;
    t.setBusy(true);
    var que = [];
    for (var i=0; i<numSlots; i++)
      que.push (['T', unitId, parseInt (perSlot)]);
    t.divTrainStatus.innerHTML = '';
    t.doQueue (cityId, tut, gam, que);
  },
  updateTopDef : function (){
    var t = Tabs.Train;
    var slots = parseInt(t.TDinpSlots.value, 10);
    if (isNaN(slots) || slots<0)
      slots = 0;
    t.TDspMax.innerHTML = 'max:'+ t.stats.MaxDefTrain +'&nbsp; actuel:'+ t.stats.defOwned;
    t.TDspMaxSlots.innerHTML = t.stats.wallLevel-t.stats.Dqueued;
    if (slots<1)
      t.TDspMaxPS.innerHTML = 0;
    else
      t.TDspMaxPS.innerHTML = parseInt(t.stats.MaxDefTrain / slots);

    t.TDspSpace.innerHTML = '<table border=1 cellspacing=0 width=100% bordercolor=black><tr><td>Niveau</td><td>D&eacute;fense des Remparts</td><td>D&eacute;fense des Champs</td></tr>\
       <tr><td><B>'+ t.stats.wallLevel +'</b></td><td>'+ (t.stats.wallSpaceUsed+t.stats.wallSpaceQueued)  +'/<B>'+ t.stats.wallSpace +'</b></td>\
        <td>'+ (t.stats.fieldSpaceUsed+t.stats.fieldSpaceQueued) +'/<B>'+ t.stats.fieldSpace +'</b></td></table>';
  },
  changeDefSelect : function (){
    var t = Tabs.Train;
    var cityId = t.selectedCity.id;
    var id = t.TDselType.value;
    t.lastDefSelect = id;
    t.stats.defOwned = parseInt(Seed.fortifications['city' + cityId]['fort'+id]);
    var uc = uW.fortcost['frt'+id];
    var max = 9999999999;
    if ( (t.stats.food / uc[1]) < max)
      max = t.stats.food / uc[1];
    if ( (t.stats.wood / uc[2]) < max)
      max = t.stats.wood / uc[2];
    if ( (t.stats.stone / uc[3]) < max)
      max = t.stats.stone / uc[3];
    if ( (t.stats.ore / uc[4]) < max)
      max = t.stats.ore / uc[4];
    if ( (t.stats.idlePop / uc[6]) < max)
      max = t.stats.idlePop / uc[6];
    t.stats.MaxDefTrain = parseInt (max);
    if (t.stats.MaxDefTrain < 0)
      t.stats.MaxDefTrain = 0;
      if (Seed.cityData && Seed.cityData.city[cityId].isPrestigeCity) {
	}else{
    if (matTypeof(uc[8]) == 'object'){
      for (k in uc[8]){
        var b = getCityBuilding (cityId, k.substr(1));
        if (b.maxLevel < uc[8][k][1]){
          t.stats.MaxDefTrain = 0;
          break;
        }
      }
    }
    if (matTypeof(uc[9]) == 'object'){
      for (k in uc[9]){
        if (parseInt(Seed.tech['tch'+k.substr(1)]) < uc[9][k][1]){
          t.stats.MaxDefTrain = 0;
          break;
        }
      }
    }
}
    var spaceEach = parseIntNan(uW.fortstats["unt"+ id][5]);
    if (id<60)
      var spaceAvail = t.stats.wallSpace - t.stats.wallSpaceUsed - t.stats.wallSpaceQueued;
    else
      var spaceAvail = t.stats.fieldSpace - t.stats.fieldSpaceUsed - t.stats.fieldSpaceQueued;
    if ( t.stats.MaxDefTrain * spaceEach > spaceAvail)
      t.stats.MaxDefTrain = parseIntNan(spaceAvail / spaceEach);

    t.updateTopDef();
  },

  clickDefMaxPS : function (){
    var t = Tabs.Train;
    var slots = parseInt(t.TDinpSlots.value, 10);
    if (slots<1)
      t.TDinpPerSlot.value = 0;
    else
      t.TDinpPerSlot.value = parseInt(t.stats.MaxDefTrain / slots);
  },

  clickDefMaxSlots : function (){
    var t = Tabs.Train;
    t.TDinpSlots.value = t.stats.wallLevel-t.stats.Dqueued;
  },

  clickDefDo : function (){
    var t = Tabs.Train;
    var cityId = t.selectedCity.id;
    var unitId = t.TDselType.value;
    var perSlot = parseInt(t.TDinpPerSlot.value, 10);
    var numSlots = parseInt(t.TDinpSlots.value, 10);

    t.displayCityStats ();
    if (perSlot<1){
      t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err1+'.</font>';
      return;
    }
    if (perSlot*numSlots > t.stats.MaxDefTrain){
      t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err3+' '+ t.stats.MaxDefTrain +')</font>';
      return;
    }
    if (numSlots<1 || numSlots > t.stats.wallLevel-t.stats.Dqueued){
      t.divTrainStatus.innerHTML = '<FONT COLOR=#550000>'+lang.Train.err2+'</font>';
      return;
    }
    var siege = document.getElementById ('siege').value;
    t.setBusy(true);
    var que = [];
    for (var i=0; i<numSlots; i++)
      que.push (['T', unitId, parseInt (perSlot)]);
    t.divTrainStatus.innerHTML = '';
    t.doDefQueue (cityId, siege, que);
  },

  doDefQueue : function (cityId, siege, que, errMsg){
    var t = Tabs.Train;
    try {
      t.displayCityStats();
      if (errMsg){
        t.dispTrainStatus ('<font color=#550000><B>ERREUR : '+ errMsg +'</b></font><BR>');
        t.setBusy(false);
        return;
      }
      var cmd = que.shift();
      if (!cmd){
        t.dispTrainStatus ('<B>'+lang.Train.err4+'</b><BR>');
        t.setBusy(false);
        return;
      }
      if (cmd[0] == 'T'){
        t.dispTrainStatus ('Construction '+ cmd[2] +' '+  fortNamesShort[cmd[1]] +'<BR>');
          doDefTrain ( cityId, siege, cmd[1], cmd[2],
          function(errMsg){
            setTimeout(function (){Tabs.Train.doDefQueue(cityId, siege, que, errMsg);}, (Math.random()*3500)+500);
          } );
      }
    } catch (err) {
      t.dispTrainStatus ('<font color=#550000>PROGRAMME ERREUR : '+ err.message +'</font><BR>');
      t.setBusy(false);
    }
  },
  setBusy : function (tf){
    var t = Tabs.Train;
    t.TDbutDo.disabled = tf;
    t.TTbutDo.disabled = tf;
  },
  fixQueTimes : function (q){
    var now = unixTime();
    if (q[0][2] > now)
      q[0][2] = now;
    for (var i=0; i<q.length; i++){
      if (q[i+1]!=null && q[i+1][2]!=q[i][3])
        q[i][3] = q[i+1][2];
    }
  },
  displayCityStats : function (){
    var t = Tabs.Train;
    var cityId = t.selectedCity.id;
    t.stats.food = parseInt (Seed.resources['city'+cityId].rec1[0]/3600);
    t.stats.wood = parseInt (Seed.resources['city'+cityId].rec2[0]/3600);
    t.stats.stone = parseInt (Seed.resources['city'+cityId].rec3[0]/3600);
    t.stats.ore = parseInt (Seed.resources['city'+cityId].rec4[0]/3600);
    t.stats.gold = Seed.citystats['city'+cityId].gold[0];
    if (Options.maxIdlePop)
       t.stats.idlePop = parseInt(Seed.citystats['city'+cityId].pop[0]);
     else
       t.stats.idlePop = parseInt(Seed.citystats['city'+cityId].pop[0]) - parseInt(Seed.citystats['city'+cityId].pop[3]);
    t.stats.barracks = getCityBuilding (cityId, 13, 0).count;
    t.stats.barracks2 = 0;
    if (Seed.cityData.city[cityId].isPrestigeCity) {
	  var atype = Seed.cityData.city[cityId].prestigeInfo.prestigeType;
	  if (atype == 1) {
       t.stats.barracks2 = getCityBuilding(cityId, 22, 0).count;
      }else if (atype == 2) {
	    t.stats.barracks2 = getCityBuilding(cityId, 24, 0).count;
       }else if (atype == 3) {
	    t.stats.barracks2 = getCityBuilding(cityId, 26, 0).count;
	    } else {
        t.stats.barracks2 = 0;
      }
   }
    cost = uW.unitcost['unt'+t.TTselType.value];
    nbunit=t.TTinpPerSlot.value*t.TTinpSlots.value;
    var a=1;
    var gumble= t.BOGamble.value;
    if (gumble==0) a=1;
	if (gumble==1) a=2;
	if (gumble==2) a=4;
    consoFood = cost[1] * a * nbunit;
    style34001="";conso34001=0;
    if (t.TTselType.value==16) conso34001=nbunit;
    if (conso34001>parseInt(uW.ksoItems[34001].count)) style34001='style="color:#E30;font-weight:bold;"';
    styleFood="";stylePop="";styleWood="";styleOre="";styleStone="";
        if (consoFood>t.stats.food) styleFood='style="color:#E30;font-weight:bold;"';
        consoOre = cost[4] * a * nbunit;
        if (consoOre>t.stats.ore) styleOre='style="color:#E30;font-weight:bold;"';
        consoStone = cost[3] * a * nbunit;
        if (consoStone>t.stats.stone) styleStone='style="color:#E30;font-weight:bold;"';
        consoWood = cost[2] * a * nbunit;
        if (consoWood>t.stats.wood) styleWood='style="color:#E30;font-weight:bold;"';

    consoPop = parseInt(cost[6]) * nbunit;

   if (consoPop>t.stats.idlePop) stylePop='style="color:#E30;font-weight:bold;"';
   var m = '<TABLE class=ptTab width=100%><TR align=center>';
   var r=0;
   for (y in uW.unitcost) {
	 m+="<TD width=8%><B>"+uW.unitcost[y][0].substring(0,5)+":</b></td>"
  }
 m+="</tr><TR align=center>";
 var r=0;
 for (y in uW.unitcost) {
	 r++;
  m += '<TD width=8%><span title="'+uW.g_js_strings.commonstr.dismiss+'" onclick="BoRenvoyer('+r+','+cityId+');">'+UniteKMG(parseIntNan(Seed.units['city'+cityId]['unt'+r]))+'</span></td>';
 }
 m+='<tr></table>';
 m += '<TABLE class=ptTab width=100%><TR align=center>\
        <td width=15%>&nbsp;</td><td><b>'+uW.ksoItems[34001].name+'</b></td><TD width=14%><B>'+uW.g_js_strings.commonstr.gold+'</b></td><TD width=15%><B>'+uW.g_js_strings.commonstr.food+'</b></td><TD width=14%><B>'+uW.g_js_strings.commonstr.wood+'</b></td><TD width=14%><B>'+uW.g_js_strings.commonstr.stone+'</b></td><TD width=14%><B>'+uW.g_js_strings.commonstr.ore+'</b></td><TD width=14%><B>'+uW.g_js_strings.showPopTooltip.idlepop+'</b></td></tr>\
      <TR align=center><td><b>'+uW.g_js_strings.commonstr.inventory+'</b></td><TD><SPAN>'+addCommasInt(uW.ksoItems[34001].count)+'</span></td><TD><SPAN>'+ UniteKMG(t.stats.gold) +'</span></td><TD><SPAN id=ptttr_food>'+ UniteKMG(t.stats.food) +'</span></td>\
      <TD><SPAN id=ptttr_wood>'+ UniteKMG(t.stats.wood) +'</span></td><TD><SPAN id=ptttr_stone>'+ UniteKMG(t.stats.stone) +'</span></td><TD><SPAN id=ptttr_ore>'+ UniteKMG(t.stats.ore) +'</span></td>\
         <TD><SPAN>'+ addCommasInt(t.stats.idlePop) +'</span></td></tr>\
        <tr align=center><td width=15%><b>'+uW.g_js_strings.commonstr.required+'</b></td><td '+style34001+'>'+addCommasInt(conso34001)+'</td><td></td><td '+styleFood+'>'+addCommasInt(consoFood)+'</td><td '+styleWood+'>'+addCommasInt(consoWood)+'</td><td '+styleStone+'>'+addCommasInt(consoStone)+'</td><td '+styleOre+'>'+addCommasInt(consoOre)+'</td>\
        <TD '+stylePop+'>'+ addCommasInt(consoPop)+'</td></tr>\
       </table>';
       document.getElementById ('divSTtop').innerHTML = m;
       var e=parseInt((t.TDinpPerSlot.value*t.TDinpSlots.value),10);
       if (e>0) {
          d=t.TDselType.value;
          var a=uW.modal_walls_traintime(d,e)
          var reduction=0
          var tut = ById('siege').value;
          if (tut==26) reduction=parseInt(a*0.3);
          var reducStr=timestr(reduction,1);
          ById('BOmodal_barracks_deftime').innerHTML=uW.g_js_strings.modal_barracks_trainingtab.esttime+" : <b>" + timestr(a,1) +"</b>";
          if (reduction>0) {
           var totalred = a - reduction;
           ById('BOmodal_barracks_deftime').innerHTML=uW.g_js_strings.modal_barracks_trainingtab.esttime+" : <b>" + timestr(totalred,1) +"</b>";
           ById('BOmodal_barracks_deftime').title=uW.g_js_strings.modal_barracks_trainingtab.esttime+" : " + timestr(a,1) +" - Boost : " + reducStr + "";
          }
         }
    var f=parseInt(nbunit,10);
    var d=t.TTselType.value;


 if(f>0){
    var c=+(uW.unitcost["unt"+d][7])*f,e,l={},h=Seed.buildings["city"+cityId],k={},m=Seed.knights["city"+cityId],a,g=Seed.leaders["city"+cityId];
    l.barracks=0;l.workshop=0;l.stable=0;l.tech=0;l.knight=0;l.ultimate=0;
jQuery.each(h,function(p,o){
o.id=+(o[0]);o.level=+(o[1]);var n=(parseInt(d)==13 || parseInt(d) == 14 || parseInt(d) == 15);o.isDruid=(parseInt(o[2])>=100&&parseInt(o[2])<=105);
if((o.id===13  || o.id === 22  || o.id === 24 || o.id === 26)&&o.level>0){	if((n&&o.isDruid)||(!n&&!o.isDruid)){	l.barracks+=(o.level+9)	}}
if(o.id===16&&o.level>0){	if(+(d)>=9&&+(d)<13){l.workshop=o.level}}
if(o.id===17&&o.level>l.stable){if(+(d)>=7&&+(d)<13){l.stable=o.level}}
});
e=l.barracks/10;
c=Math.max(1,Math.ceil(c/e));
e=1;
if(m){
	a=m["knt"+g.combatKnightId];
    if(a){l.knight=(+(a.combatBoostExpireUnixtime)-uW.unixtime()>0)?(a.combat*1.25):a.combat}
    else{l.knight=0}
}

if(Seed.tech){l.tech=Seed.tech.tch5}
l.ultimate=l.workshop+l.stable+l.tech;
e=e*(1+(0.1*l.ultimate)+(0.005*l.knight));

var j=EffetTronePrc(77).percent;
e=e*(1+(j/100));

if(uW.cm.WorldSettings.isOn("GUARDIAN_MARCH_EFFECT")){
	 var SPD={0:0,1:5,2:5,3:10,4:10,5:15,6:15,7:20,8:25,9:35,10:70,11:130,12:250};
          var b=0,y=false,v=false,w=0;
          var mm=Seed.guardian;
          for (var ii in mm) {
           var ww = mm[ii];
           if (ww.cityId==cityId) {
            if (ww.type== "stone") y=true;
            if (ww.guardianCount==4) v=true;
            var level=0;
            if (ww.cityGuardianLevels.stone!=undefined) level = ww.cityGuardianLevels.stone;
            w = SPD[level] / 100;
            var yy=0;
            var ww=(uW.cm.ThroneController.getBoundedEffect(106)/100);
            var bx = 0;
            if (y && v) {bx = 1.5;yy=ww;}
            if (y && !v) {bx = 1;yy=ww;}
            if (!y && v) bx = 0.5;
            if (!y && !v) bx = 0;
            b = (w * bx) + yy;
            e=e*(1+b);
           }
      }


 }
m=Math.max(1,Math.ceil(c/e));
if(uW.cm.PrestigeModel.isPrestige(cityId)){
	var a=uW.cm.PrestigeModel.getPrestigeLevel(cityId);
	if(a>0){
		 var z=uW.cm.WorldSettings.getSetting("ASCENSION_BARRACKS_BOOST"),k=uW.JSON.parse(z),o=k.values[a-1][1],i=parseFloat(o);
		 m=Math.ceil(m*i);
	}
}
var r=uW.cm.BlessingSystemModel.isBlessingActive(uW.cm.BlessingSystemModel.getBlessing().DEATH_FROM_AFAR,cityId);
if(d==6&&r){m=Math.ceil(m-(m*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().DEATH_FROM_AFAR,cityId,{})))}
m = Math.ceil(m - (m * uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().EXPEDITED_SENTENCING, cityId, {traintime: true,unitid: d})));
m=Math.ceil(m-(m*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().TO_THE_FRONT_LINES,cityId,{unitid:d})));
m=Math.ceil(m-(m*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().PRIORITIZED_CONSTRUCTION,cityId,{unittype:d})));

var reduction=0
var tut = document.getElementById ('tutelage').value;
if (tut==36) reduction=parseInt(m*0.3,10);
if (tut==37) reduction=parseInt(m*0.5,10);
if (tut==38) reduction=parseInt(m*0.7,10);
var reducStr=timestr(reduction,1);
var aa=1,now = unixTime(),estimfin = new Date();
estimfin.setTime((now+m) * 1000);
ById('BOmodal_barracks_traintime').innerHTML=uW.g_js_strings.modal_barracks_trainingtab.esttime+" : <b>" + timestr(m,1) +"</b><br>"+lang.Train.estimfin+": "+estimfin.toLocaleString()+"";
var gumble= t.BOGamble.value;
if (gumble==0) aa=1;
     if (gumble==1) aa=2;
     if (gumble==2) aa=4;
     if (aa>1 && reduction==0) {
      if (aa==2) {
       var r1=parseInt(m*0.05,10);
       var r2=parseInt(m*0.15,10);
       var n1 = m - r1;
       var n2 = m - r2;
      }
      if (aa==4) {
       var r1=parseInt(m*0.10,10);
       var r2=parseInt(m*0.25,10);
       var n1 = m - r1;
       var n2 = m - r2;
      }
      var now = unixTime();
      var estimfin1 = new Date();
      estimfin1.setTime((now+n2) * 1000);
      var estimfin2 = new Date();
      estimfin2.setTime((now+n1) * 1000);
      ById('BOmodal_barracks_traintime').innerHTML=uW.g_js_strings.modal_barracks_trainingtab.esttime+" <b><font color=red>" + timestr(n2,1) +"</font> et <font color=red>" + timestr(n1,1) +"</font></b><br>"+lang.Train.estimfin+" "+estimfin1.toLocaleString()+"<br>et "+estimfin2.toLocaleString()+"";
     }
     if (reduction>0 && aa==1) {
       var totalred = m - reduction;
       var now = unixTime();
       var estimfin = new Date();
       estimfin.setTime((now+totalred) * 1000);
       ById('BOmodal_barracks_traintime').innerHTML=uW.g_js_strings.modal_barracks_trainingtab.esttime+" : <b><font color=red>" + timestr(totalred,1) +"</font></b><br>"+lang.Train.estimfin+": "+estimfin.toLocaleString()+"";
       ById('BOmodal_barracks_traintime').title=uW.g_js_strings.modal_barracks_trainingtab.esttime+" : " + timestr(m,1) +" - Boost : " + reducStr + "";
     }
     if (reduction>0 && aa>1) {
            var totalred = m - reduction;
             if (aa==2) {
	           var r1=parseInt(totalred*0.05,10);
	           var r2=parseInt(totalred*0.15,10);
	           var n1 = totalred - r1;
	           var n2 = totalred - r2;
	          }
	          if (aa==4) {
	           var r1=parseInt(totalred*0.10,10);
	           var r2=parseInt(totalred*0.25,10);
	           var n1 = totalred - r1;
	           var n2 = totalred - r2;
	          }

	          var now = unixTime();
		        var estimfin1 = new Date();
		        estimfin1.setTime((now+n2) * 1000);
		        var estimfin2 = new Date();
      estimfin2.setTime((now+n1) * 1000);
 ById('BOmodal_barracks_traintime').innerHTML=uW.g_js_strings.modal_barracks_trainingtab.esttime+" <b><font color=red>" + timestr(n2,1) +"</font> et <font color=red>" + timestr(n1,1) +"</font></b><br>"+lang.Train.estimfin+" "+estimfin1.toLocaleString()+"<br>et "+estimfin2.toLocaleString()+"";
     }
    }
    var totTime = 0;
    var totTime2 = 0;
    var q = Seed.queue_unt['city'+cityId];
    var c = Cities.byID[cityId].idx;
    t.stats.queued = q.length;
    t.stats.queued2 = 0;
    var qs = q.toString();
    var now = unixTime();
    t.lastQueString = qs;
    t.stats.queued = 0;
    t.stats.queued2 = 0;
    m = '<TABLE align=center class=ptTab>';
    m2 = '<TABLE align=center class=ptTab>';
    if (q!=null && q.length>0 ){
        //t.fixQueTimes (q);
        first = true;
        first2 = true;
        var ci=0,ca=0;
        for (var i=0; i<q.length; i++){
		 if (q[i][7]) {
			// ascension
			t.stats.queued2++;
			start2 = q[i][2];
			          end2 = q[i][3];
			          if (first2)
			            actual2 = end2 - now;
			          else
			            actual2 = end2 - lastEnd2;
			          if (actual2 < 0)
			            actual2 = 0;
			            param1=i; //
			            param2=cityId; // id de la ville
			            param3=q[i][0]; // Type de trouoe
			            param4=q[i][1]; // Qte troupe
			            param5=end2; // debut
			            param6=start2; // fin
			            param7=actual2; // duree
			          m2 += '<TR align=right><td width=35 align=center>'+(ca+1)+'&nbsp;<a onclick="BOcancelTraining('+param1+','+param2+','+param3+','+param4+','+param5+','+param6+','+param7+');return false;" href="javascript:void(0);"><img src="'+CANCELBTN+'" border=0 title="Annuler la formation"></a></td><TD>'+ parseIntNan(q[i][1]) +' </td><TD align=left> '+ uW.unitcost['unt'+q[i][0]][0].replace('de Ravitaillement','');
			          if (first)
			            m2 += '</td><TD>&nbsp;<img src="http://cdn1.iconfinder.com/data/icons/ledicons/wait.png" onclick=citysel_click(document.getElementById(\'citysel_'+ (c+1)+'\'));modal_speedup("trn",'+param3+','+param3+',"Training",'+param6+');return false;> &nbsp; '+  timestr(end2-start2, true) +'</td><TD> (<SPAN id=ptttfq>'+ timestr(actual2, true) +'</span>)';
			          else
			            m2 += '</td><TD> &nbsp; '+  timestr(actual2, true) +'</td></tr>';
			          lastEnd2 = end2;
          first2 = false;
          totTime2 = totTime2 + actual2;
          ca++;
		 } else {
			  t.stats.queued++;
          start = q[i][2];
          end = q[i][3];
          if (first)
            actual = end - now;
          else
            actual = end - lastEnd;
          if (actual < 0)
            actual = 0;
            param1=i; //
            param2=cityId; // id de la ville
            param3=q[i][0]; // Type de trouoe
            param4=q[i][1]; // Qte troupe
            param5=end; // debut
            param6=start; // fin
            param7=actual; // duree
          m += '<TR align=right><td width=35 align=center>'+(ci+1)+'&nbsp;<a onclick="BOcancelTraining('+param1+','+param2+','+param3+','+param4+','+param5+','+param6+','+param7+');return false;" href="javascript:void(0);"><img src="'+CANCELBTN+'" border=0 title="Annuler la formation"></a></td><TD>'+ parseIntNan(q[i][1]) +' </td><TD align=left> '+ unsafeWindow.unitcost['unt'+q[i][0]][0].replace('de Ravitaillement','');
          if (first)
            m += '</td><TD>&nbsp;<img src="http://cdn1.iconfinder.com/data/icons/ledicons/wait.png" onclick=citysel_click(document.getElementById(\'citysel_'+ (c+1)+'\'));modal_speedup("trn",'+param3+','+param3+',"Training",'+param6+');return false;> &nbsp; '+  timestr(end-start, true) +'</td><TD> (<SPAN id=ptttfq>'+ timestr(actual, true) +'</span>)';
          else
            m += '</td><TD> &nbsp; '+  timestr(actual, true) +'</td></tr>';
          lastEnd = end;
          first = false;
          totTime = totTime + actual;
          ci++;
	     }

         }
      }
    m += '</table>';
    m2 += '</table>';
    ById ('divSTleft').innerHTML = m;
    ById ('divSTleft2').innerHTML = m2;
    m = t.stats.barracks +' ' + uW.buildingcost.bdg13[0];
    if (t.stats.queued > 0)
      m += ', '+ t.stats.queued +' slots';
    if (totTime > 0)
      m += ', '+ uW.timestr(totTime);
    ById ('statTTtot').innerHTML = m;
    // ascension
    m = t.stats.barracks2 + ' ';
    if (atype == 1) m+=uW.buildingcost.bdg22[0];
    if (atype == 2) m+=uW.buildingcost.bdg24[0];
    if (atype == 3) m+=uW.buildingcost.bdg26[0];;
	if (t.stats.queued2 > 0)
	      m += ', '+ t.stats.queued2 +' slots';
	if (totTime2 > 0)
	      m += ', '+ uW.timestr(totTime2);
    ById ('statTTtot2').innerHTML = m;
    getWallInfo (cityId, t.stats);
    var totTime = 0;
    var q = Seed.queue_fort['city'+cityId];
    var qs = q.toString();
    if (q!=null && q.length>0)
      totTime = q[q.length-1][3] - now;
    if ( qs == t.lastDQueString){
      if (q!=null && q.length>0){
        var cur = q[0][3] - now;
        if (cur < 1)
          q.shift();
        document.getElementById ('pttdfq').innerHTML = timestr(cur, true);
      }
    } else {
      t.lastDQueString = qs;
      t.stats.Dqueued = 0;
      t.stats.wallSpaceQueued = 0;
      t.stats.fieldSpaceQueued = 0;
      m = '<TABLE align=center class=ptTab>';
      if (q!=null && q.length > 0 ){
        t.fixQueTimes (q);
        t.stats.Dqueued = q.length;
        first = true;
        for (i=0; i<q.length; i++){
          if (q[i][0] < 60)
            t.stats.wallSpaceQueued += parseIntNan(uW.fortstats["unt"+ q[i][0]][5]) * parseIntNan(q[i][1]);
          else
            t.stats.fieldSpaceQueued += parseIntNan(uW.fortstats["unt"+ q[i][0]][5]) * parseIntNan(q[i][1]);
          start = q[i][2];
          end = q[i][3];
          if (first)
            actual = end - now;
          else
            actual = end - lastEnd;
          if (actual < 0)
            actual = 0;
          q[i][7]=cityId;
          m += '<TR align=right><TD><a onclick="BOcancelFort('+ q[i][0]+','+q[i][1]+','+q[i][2]+','+q[i][3]+','+q[i][5]+','+q[i][6]+','+q[i][7] +','+ i +');return false;" href="javascript:void(0);"><img src="'+CANCELBTN+'" border=0 title="Annuler la fortification"></a></td><TD>'+ q[i][1] +'</td><TD align=left> '+ fortNamesShort[q[i][0]];
          if (first)
            m += '</td><TD> &nbsp; '+  timestr(end-start, true) +'</td><TD> (<SPAN id=pttdfq>'+ timestr(actual, true) +'</span>)';
          else
            m += '</td><TD> &nbsp; '+  timestr(actual, true) +'</td></tr>';
          lastEnd = end;
          first = false;
        }
      }
      m += '</table>';
      ById ('divSTright').innerHTML = m;
    }
    m = t.stats.Dqueued +' slots';
    if (totTime > 0)
      m += ', '+ uW.timestr(totTime);
    ById ('statDTtot').innerHTML = m;
  },
  dispTrainStatus : function (msg){
    var t = Tabs.Train;
    if (t.divTrainStatus)
      t.divTrainStatus.innerHTML = msg + t.divTrainStatus.innerHTML;
  },
  CancelActionall: function(cityId, num, fintraitement,banzai) {
   var t = Tabs.Train;
   var q = Seed.queue_unt['city'+cityId];
   if (!q[num]|| num==0 || num<fintraitement) {
	    t.dispTrainStatus ('<font color=#550000><B>'+lang.Train.err5+'</b></font><BR>');
	    if (ById ('BOCancelAllTrain'))
                  ById ('BOCancelAllTrain').style.display='block';
        t.displayCityStats();
	    return;
   }
   if (q[num][7]) {
	   t.CancelActionall(cityId, num-1, fintraitement,banzai);
	   return;
   }
   var now = unixTime();
   start = q[num][2];
   end = q[num][3];
   actual = end - now;
   if (actual < 0)
          actual = 0;
   var param2=cityId; // id de la ville
   var param3=q[num][0]; // Type de trouoe
   var param4=q[num][1]; // Qte troupe
   var param5=end; // debut
   var param6=start; // fin
   var param7=actual; // duree
   var params = uW.Object.clone(uW.g_ajaxparams);
   params.cityId = param2;
   params.requestType ="CANCEL_TRAINING";
   params.numtrptrn = param4;
   params.trnETA= param5;
   params.trnNeeded = param7;
   params.trnTmp = param6;
   params.typetrn= param3;
   new MyAjaxRequest(uW.g_ajaxpath + "ajax/cancelTraining.php" + uW.g_ajaxsuffix, {
             method: "post",
             parameters: params,
           onSuccess: function (rslt) {
            var t = Tabs.Train;
            if (rslt.ok) {
                 if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};

   	       var k=0;for(var j=0;j<uW.seed.queue_unt["city"+param2].length;j++){
			   var isprestige=uW.seed.queue_unt["city"+param2][j][7];
   	        if(j>num&&isprestige===false){
   	         uW.seed.queue_unt["city"+param2][j][2]=parseInt(rslt.dateTraining[k]["start"]);
   	         uW.seed.queue_unt["city"+param2][j][3]=parseInt(rslt.dateTraining[k]["end"]);
   	         k++;
   	         }
   	        }
   	        uW.seed.queue_unt["city"+param2].splice(num,1);
   	        for(var i=1;i<5;i++){
   	         var totalReturn=parseInt(uW.unitcost["unt"+param3][i])*parseInt(param4)*3600/2;
   	         uW.seed.resources["city"+param2]["rec"+i][0]=parseInt(uW.seed.resources["city"+param2]["rec"+i][0])+totalReturn;
   	        }
	        var numnew = num - 1;
	        if (numnew<fintraitement) {
	         t.dispTrainStatus ('<font color=#550000><B>'+lang.Train.err5+'</b></font><BR>');
                 document.getElementById ('BOCancelAllTrain').style.display='block';
	         t.displayCityStats();
	        } else {
	          if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
	          setTimeout(function (){
	            t.CancelActionall(cityId, numnew, fintraitement,banzai);
	            }, (Math.random()*300)+500);
                }

            } else {
             t.dispTrainStatus ("<font color=#550000><B>"+lang.Train.err6+"</b></font><BR>");
             t.displayCityStats();
             if (ById ('BOCancelAllTrain'))document.getElementById ('BOCancelAllTrain').style.display='block';
            }
           },
           onFailure: function (rslt) {
            var t = Tabs.Train;
            t.dispTrainStatus ("<font color=#550000><B>"+lang.Train.err6+"</b></font><BR>");
            t.displayCityStats();
            if (ById ('BOCancelAllTrain')) document.getElementById ('BOCancelAllTrain').style.display='block';
           }
    });
    setTimeout(uW.update_seed_ajax, 250);

  },
  CancelAllTraining : function() {
   var t = Tabs.Train;
   var cityId = t.selectedCity.id;
   var q = Seed.queue_unt['city'+cityId];
   if (q.length>0) {
    var b=prompt(lang.Train.cancel1+" "+(q.length)+")", 2);
    if (parseInt(b)<=q.length && parseInt(b)>0) {
     t.dispTrainStatus ('<font color=#550000><B>'+lang.Train.cancel2+'</b></font><BR>');
     if (ById ('BOCancelAllTrain')) document.getElementById ('BOCancelAllTrain').style.display='none';
     obj = ById('autoFormationtoggle');
     TrainOptions.Running = false;
     if (obj) obj.value = lang.autoForm.buttonlabel+" = OFF";
     if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+' - OFF', 'pbformtab');
     saveTrainingOptions();
     t.CancelActionall(cityId, q.length-1, b-1, false);

    }
   }
  },
  cancelTrainingBO : function (p1,p2,p3,p4,p5,p6,p7) {
   var t = Tabs.Train;
   var params = uW.Object.clone(uW.g_ajaxparams);
     params.cityId = p2;
     params.requestType ="CANCEL_TRAINING";
     params.numtrptrn = p4;
     params.trnETA= p5;
     params.trnNeeded = p7;
     params.trnTmp = p6;
     params.typetrn= p3

  new MyAjaxRequest(uW.g_ajaxpath + "ajax/cancelTraining.php" + uW.g_ajaxsuffix, {
          method: "post",
          parameters: params,
        onSuccess: function (rslt) {
         var t = Tabs.Train;
         if (rslt.ok) {
              if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};

	       var k=0;
	       var isPrestigeQueue=uW.seed.queue_unt["city"+p2][p1][7];
	       for(var j=0;j<uW.seed.queue_unt["city"+p2].length;j++){

	        if(j>p1&&isPrestigeQueue===uW.seed.queue_unt["city"+p2][j][7]){
	         uW.seed.queue_unt["city"+p2][j][2]=parseInt(rslt.dateTraining[k]["start"]);
	         uW.seed.queue_unt["city"+p2][j][3]=parseInt(rslt.dateTraining[k]["end"]);
	         k++;
	         }
	        }
	        uW.seed.queue_unt["city"+p2].splice(p1,1);
	        for(var i=1;i<5;i++){
	         var totalReturn=parseInt(uW.unitcost["unt"+p3][i])*parseInt(p4)*3600/2;
	         uW.seed.resources["city"+p2]["rec"+i][0]=parseInt(uW.seed.resources["city"+p2]["rec"+i][0])+totalReturn;
	        }

          t.dispTrainStatus ('<font color=#550000><B>'+lang.Train.err5+'</b></font><BR>');
          t.displayCityStats();
         } else {
          t.dispTrainStatus ("<font color=#550000><B>"+lang.Train.err7+"</b></font><BR>");
          t.displayCityStats();
         }
        },
        onFailure: function (rslt) {
         var t = Tabs.Train;
         t.dispTrainStatus ("<font color=#550000><B>"+lang.Train.err7+"</b></font><BR>");
         t.displayCityStats();
        }
    });

    setTimeout(uW.update_seed_ajax, 250);
  },
 butcancelFort : function (typefrt, numtrpfrt, frtTmp, frtETA, frtNeeded, frtid, cityId, queueId){
   var t = Tabs.Train;
   var params = uW.Object.clone(uW.g_ajaxparams);
   params.pf =0;
   params.requestType = "CANCEL_FORTIFICATIONS";
   params.cityId = cityId;
   params.typefrt = typefrt;
   params.numtrpfrt =  numtrpfrt;
   params.frtETA = frtETA;
   params.frtTmp = frtTmp;
   params.frtNeeded = frtNeeded;
   params.frtid = frtid;
   new AjaxRequest(uW.g_ajaxpath + "ajax/cancelFortifications.php" + uW.g_ajaxsuffix, {
       method: "post",
       parameters: params,
       onSuccess: function (message) {
       var rslt=eval("("+message.responseText+")");
       var t = Tabs.Train;
       if (rslt.ok) {
 			var k=0;
 			for(var j=0;j<Seed.queue_fort["city"+cityId].length;j++){
 				if(j>queueId){
 					Seed.queue_fort["city"+cityId][j][2]=parseInt(rslt.dateFortifications[k]["start"]);
 					Seed.queue_fort["city"+cityId][j][3]=parseInt(rslt.dateFortifications[k]["end"]);
 					k++;
 				}
 			}
			uW.update_seed(rslt.updateSeed);
 			Seed.queue_fort["city"+cityId].splice(queueId,1);
 			for(var i=1;i<5;i++){
 				var totalReturn=parseInt(uW.fortcost["frt"+typefrt][i])*parseInt(numtrpfrt)*3600/2;
 				Seed.resources["city"+cityId]["rec"+i][0]=parseInt(Seed.resources["city"+cityId]["rec"+i][0])+totalReturn;
 			}
 		  t.dispTrainStatus ('<font color=#550000><B>'+lang.Train.err5+'</b></font><BR>');
         	  t.displayCityStats();
 		} else {

		  t.dispTrainStatus ("<font color=#550000><B>"+lang.Train.err7+"</b></font><BR>");
                  t.displayCityStats();
 		}

       },
       onFailure: function () {
       var t = Tabs.Train;
       		  t.dispTrainStatus ("<font color=#550000><B>"+lang.Train.err7+"</b></font><BR>");
                  t.displayCityStats();
       },
   });
 },
 doQueue : function (cityId, tut, gam, que, errMsg){
    var t = Tabs.Train;
    try {
      t.displayCityStats();
      if (errMsg){
        t.dispTrainStatus ('<font color=#550000><B>ERREUR : '+ errMsg +'</b></font><BR>');
        t.setBusy(false);
        return;
      }
      var cmd = que.shift();
      if (!cmd){
        t.dispTrainStatus ('<B>'+lang.Train.err8+'</b><BR>');
        t.setBusy(false);
        return;
      }
      if (cmd[0] == 'T'){
        t.dispTrainStatus ('Formation '+ cmd[2] +' '+  uW.unitcost['unt'+cmd[1]][0] +' dans '+ Cities.byID[cityId].name +' ('+ que.length +' slot(s) restant(s))<BR>');
        doTrain (cityId, tut, gam, cmd[1], cmd[2],
          function(errMsg){
	           setTimeout(function (){Tabs.Train.doQueue(cityId, tut, gam, que, errMsg);}, (Math.random()*1000)+1000 );
          }
        );
      }
    } catch (err) {
      t.dispTrainStatus ('<font color=#550000>PROGRAME ERREUR : '+ err.message +'</font><BR>');
      t.setBusy(false);
    }
  },
}

Tabs.PopControl = {
  tabOrder : 10,
  tabDisabled : false,
  tabLabel : uW.g_js_strings.commonstr.population,
  myDiv : null,
  timer : null,
  timer_del : null,
  timer_cycle : null,
	del_count : 0,
	cycle_running : false,
	busy : false,
	cycle_step : 0,tcp:null,

  logtable : null,
   logmaxEntries: 10,
   loglast10 : [],
   poptab_troop_dismiss : 1,
   last_ran : 'train',

  init : function (div)
  	{
		var t = Tabs.PopControl;
		t.myDiv = div;
		var selbut=0;

		var m = '<DIV class=boStat>'+lang.population.popControlHead+'</div>';

		m += '<table border=0 width="100%" class="pdxTab">';
		m += '<tr align=center>';
		m += '<td align=left><input type=submit class=pbButton id=pophelp_button value="'+lang.General.help+'"></td>';
		m += '<td align=center>'+lang.population.popControlPickCity+' <span id=popcity></span></td>';
		m += '<td align=center><i>'+lang.population.popControlCycleGain+'</i> <b><span id=poptab_cycle_pop></span></b></td>';
		m += '<td align=center> Troops to dismiss: <select id=poptab_troop_dismiss><option value=1>ST</option><option value=2>MM</option><option value=3>Scout</option><option value=4>Pike</option><option value=5>Sword</option><option value=6>Archer</option></select>';
		m += '</tr>';
		m += '</table>';

		m += '<DIV class=boStat>'+lang.population.popControlHeadRequirements+'</div>';
		m += '<table border="0" width="100%" class="pdxTab">';
		m += '<tr>';
		m += '<td title="'+lang.population.popControlReqCurrentFood+'"><img src='+gameurl+'img/food_30.png> &nbsp<span id=poptab_cur_food></span></td>';
		m += '<td title="'+lang.population.popControlReqCurrentWood+'"><img src='+gameurl+'img/wood_30.png> &nbsp<span id=poptab_cur_wood></span></td>';
		m += '<td title="'+lang.population.popControlReqCurrentOre+'"><img src='+gameurl+'img/iron_30.png> &nbsp&nbsp<span id=poptab_cur_ore></span></td>';
		m += '<td title="'+lang.population.popControlReqCurrentMM+'"><img src='+gameurl+'img/units/unit_2_30.jpg?6545> <span id=poptab_cur_mm></span></td>';
		m += '</tr>';
		m += '<tr>';
		m += '<td style="border:1px solid #FF0000;" title="'+lang.population.popControlReqNeedFood+'"><img src='+gameurl+'img/food_30.png> &nbsp<span id=poptab_needed_food></span></td>';
		m += '<td style="border:1px solid #FF0000;" title="'+lang.population.popControlReqNeedWood+'"><img src='+gameurl+'img/wood_30.png> &nbsp<span id=poptab_needed_wood></span></td>';
		m += '<td style="border:1px solid #FF0000;" title="'+lang.population.popControlReqNeedOre+'"><img src='+gameurl+'img/iron_30.png> &nbsp&nbsp<span id=poptab_needed_ore></span></td>';
		m += '<td style="border:1px solid #FF0000;"  title="'+lang.population.popControlReqNeedMM+'"><img src='+gameurl+'img/units/unit_2_30.jpg?6545> <span id=poptab_needed_mm></span></td>';
		m += '</tr>';
		m += '</table>';

		m += '<DIV class=boStat>'+lang.population.popControlHeadCityStatus+'</div>';
		m += '<table border="0" width="100%" class="pdxTab">';
		m += '<tr align=center>';
		m += '<td>'+lang.population.popControlMaxIdlePop+' <span id=poptab_max_idle_pop></span></td>';
		m += '<td>'+lang.population.popControlSlotsUsed+' <span id=poptab_slots_used></span><br></td>';
		m += '<td>'+lang.population.popControlOfBarracks+' <span id=poptab_barracks></span></td>';
		// m += '<td> </td>';
		m += '</tr>';
		m += '<tr align=center>';
		m += '<td>'+lang.population.popControlCurrentIdlePop+' <span id=poptab_cur_idle_pop></span></td>';
		m += '<td>'+lang.population.popControlSlotsFree+' <span id=poptab_slots_free></span></td>';
		m += '<td>'+lang.population.popControlOfCottages+' <span id=poptab_cottages></span></td>';
		// m += '<td> </td>';
		m += '</tr>';
		m += '</table>';

		m += '<DIV class=boStat>'+lang.population.popControlHeadCommands+'</div>';
		m += '<table border="0" width="100%" class="pdxTab">';
		m += '<tr align=center>';
		m += '<td><input type="submit" id="poptab_dismiss_mm" value="'+lang.population.popControlButtonDissmissMM+'" disabled></td>';
		m += '<td><input type="submit" id="poptab_queue_st" value="'+lang.population.popControlButtonQueueSupplyTrp+'" disabled></td>';
		m += '<td><input type="submit" id="poptab_del_queues" value="'+lang.population.popControlButtonDelAllQueues+'" disabled></td>';
		m += '<td><input type="submit" id="poptab_run_cycle" value="'+lang.population.popControlButtonRunCycle+'" disabled></td>';
		// m += '<td><input type="submit" id="poptab_test" value="Test"></td>';
		m += '</tr>';
		m += '</table>';

		m += '<DIV class=boStat>'+lang.population.popControlHeadStatusLog+'</div>';

		m += '<DIV style="max-height:250px; overflow-y:auto">';
		m += '<TABLE cellpadding=0 cellspacing=0 id=poptab_log class=pdxTabLined>';
		m += '<TR><TD></td><TD width=95%></td>';
		m += '</table></div>';

		t.myDiv.innerHTML = m;

		t.logtable = ById('poptab_log');
		var a = JSON2.parse(GM_getValue ('poptab_log_'+getServerId(), '[]'));
		if (matTypeof(a) == 'array')
				{
			t.loglast10 = a;
			for (var i=0; i<t.loglast10.length; i++)
			t.addlogrow (t.loglast10[i].msg, t.loglast10[i].ts);
			}		window.addEventListener('unload', t.onUnload, false);
		t.tcp = new CdispCityPicker ('popcityselect', ById('popcity'), true, null, selbut);
		ById('pophelp_button').addEventListener		('click', function(){	t.helpPop(this);							} , false);
		ById('popcity').addEventListener						('click', function(){	t.show_city	(t.tcp.city.id);	} , false);
		ById('poptab_dismiss_mm').addEventListener	('click', function(){	t.dismiss_mm(t.tcp.city.id);	} , false);
		ById('poptab_queue_st').addEventListener		('click', function(){	t.queue_st	(t.tcp.city.id);	} , false);
		ById('poptab_del_queues').addEventListener	('click', function(){	t.del_queues_start(t.tcp.city.id);	} , false);
		ById('poptab_run_cycle').addEventListener	('click', function(){	t.run_cycle	(t.tcp.city.id);	} , false);
		ById('poptab_troop_dismiss').addEventListener('change', function(){t.poptab_troop_dismiss = ById('poptab_troop_dismiss').value;} , false);

  	},
	disable_btns : function ()
		{
		var t = Tabs.PopControl;
		t.busy = true;
		ById('poptab_del_queues').disabled = true;
		ById('poptab_queue_st').disabled = true;
		ById('poptab_dismiss_mm').disabled = true;
		ById('poptab_run_cycle').disabled = true;
		},

	onUnload : function ()
		{
		var t = Tabs.PopControl;
		GM_setValue ('poptab_log_'+getServerId(), JSON2.stringify(t.loglast99));
		},

	addlogrow : function (msg, ts)
		{
		var t = Tabs.PopControl;
		if (t.logtable.rows.length >= t.logmaxEntries)	t.logtable.deleteRow(t.logmaxEntries-1);
		var row = t.logtable.insertRow(0);
		row.vAlign = 'top';
		row.insertCell(0).innerHTML = ts;
		row.insertCell(1).innerHTML = msg;
		},

	log : function (msg)
		{
		var t = Tabs.PopControl;
		var ts = new Date().toTimeString().substring (0,8);
		for (postcity in Seed.cities) if (Seed.cities[postcity][0] == t.tcp.city.id) logcity = Seed.cities[postcity][1];
		msg = logcity + ": " + msg;
		t.addlogrow (msg, ts);
		while (t.loglast10.length >= 10)
		t.loglast10.shift();
		t.loglast10.push ({msg:msg, ts:ts});
		},

  hide : function (){         // called whenever the main window is hidden, or another tab is selected
    var t = Tabs.PopControl;
    clearTimeout (t.timer);
  },

  show : function (){         // called whenever this tab is shown
    var t = Tabs.PopControl;
    clearTimeout (t.timer);
    t.timer = setTimeout (t.show, 2000);
	t.show_city(t.tcp.city.id);
  },

	helpPop : function ()
		{
		var helpText = "";

		helpText += lang.population.popControlHelpPop;

		helpText += 'DISMISS MM BUTTON<BR><li>' + dismissBtn_help1 + '</li>';
		helpText += '<li>' + dismissBtn_help2 + '</li><BR>';

		helpText += 'QUEUE SUPPLY TROOP BUTTON<BR><li>' + queueBtn_help1 + '</li>';
		helpText += '<li>' + queueBtn_help2 + '</li><BR>';

		helpText += 'DELETE QUEUE BUTTON<BR><li>' + deleteBtn_help1 + '</li>';
		helpText += '<li>' + deleteBtn_help2 + '</li>';
		helpText += '<li>' + deleteBtn_help3 + '</li><BR>';

		helpText += 'RUN CYCLE BUTTON<BR><li>' + runcycleBtn_help1 + '</li>';
		helpText += '<li>' + runcycleBtn_help2 + '</li>';
		helpText += '<li>' + runcycleBtn_help3 + '</li><BR>';

		helpText += '</UL><BR>';

		var pop = new CPopup ('BOpopcontrol_Help', 0, 0, 740, 600, true);
		pop.centerMe (mainPop.getMainDiv());
		pop.getMainDiv().innerHTML = helpText;
		pop.getTopDiv().innerHTML = '<DIV class="popupBanner">'+lang.population.popControlHeadHelpPop+'</div>';
		pop.show (true);
		},

	show_city : function (cityId)
		{
		var t = Tabs.PopControl;

		t.st_food = 50;
		t.st_wood = 150;
		//t.st_stone = 0;
		t.st_ore = 10;

		var green = '#03F003';
		var red =   '#F0303';

		t.max_idle_pop = (parseInt(Seed.citystats['city'+cityId].pop[1])).toFixed(0);
		t.cur_idle_pop = (parseInt(Seed.citystats['city'+cityId].pop[0])).toFixed(0);
		ById('poptab_max_idle_pop').innerHTML	= t.max_idle_pop;
		ById('poptab_cur_idle_pop').innerHTML	= t.cur_idle_pop;

		t.barracks = parseInt(getCityBuilding(cityId, 13).count);
		t.cottages = parseInt(getCityBuilding(cityId, 5).count);
		//t.slots_used = parseInt(Seed.queue_unt['city'+cityId].length);
		t.slots_used = 0;
			  for (k in Seed.queue_unt['city'+cityId])
		        if(Seed.queue_unt['city'+cityId][k][7] == false)
         			 t.slots_used += 1;

		t.slots_free = parseInt(t.barracks - t.slots_used);
		ById('poptab_barracks').innerHTML = t.barracks;
		ById('poptab_cottages').innerHTML = t.cottages;
		ById('poptab_slots_used').innerHTML = t.slots_used;
		ById('poptab_slots_free').innerHTML = t.slots_free;

		t.cycle_pop = (parseInt(t.barracks) * parseInt(t.max_idle_pop)) + (parseInt(t.max_idle_pop) * 2);
		ById('poptab_cycle_pop').innerHTML	= addCommas( t.cycle_pop / 2 );

		t.cur_food = parseInt(Seed.resources['city'+cityId].rec1[0]/3600);
		t.cur_wood = parseInt(Seed.resources['city'+cityId].rec2[0]/3600);
		//t.cur_stone = parseInt(Seed.resources['city'+cityId].rec3[0]/3600);
		t.cur_ore = parseInt(Seed.resources['city'+cityId].rec4[0]/3600);

		ById('poptab_cur_food').innerHTML = addCommas (t.cur_food);
		ById('poptab_cur_wood').innerHTML = addCommas (t.cur_wood);
		//ById('poptab_cur_stone').innerHTML = addCommas (t.cur_stone);
		ById('poptab_cur_ore').innerHTML = addCommas (t.cur_ore);

		t.needed_food = parseInt(t.cycle_pop) * parseInt(t.st_food);
		t.needed_wood = parseInt(t.cycle_pop) * parseInt(t.st_wood);
		//t.needed_stone = 0;//parseInt(t.cycle_pop) * parseInt(t.st_Stone);
		t.needed_ore = parseInt(t.cycle_pop) * parseInt(t.st_ore);

		ById('poptab_needed_food').innerHTML = addCommas (t.needed_food);
		ById('poptab_needed_wood').innerHTML = addCommas (t.needed_wood);
		//ById('poptab_needed_stone').innerHTML = addCommas (t.needed_stone);
		ById('poptab_needed_ore').innerHTML = addCommas (t.needed_ore);

		ById('poptab_needed_food').style.color = (t.needed_food  > t.cur_food?'red':'green');
		ById('poptab_cur_food').style.color = (t.needed_food  > t.cur_food?'red':'green');
		ById('poptab_needed_wood').style.color  = (t.needed_wood  > t.cur_wood?'red':'green');
		ById('poptab_cur_wood').style.color = (t.needed_wood  > t.cur_wood?'red':'green');
		ById('poptab_needed_ore').style.color = (t.needed_ore  > t.cur_ore?'red':'green');
		ById('poptab_cur_ore').style.color = (t.needed_ore  > t.cur_ore?'red':'green');

		t.needed_mm = t.cycle_pop;
		t.cur_mm = parseInt(Seed.units['city'+cityId]['unt' + t.poptab_troop_dismiss]);
		ById('poptab_needed_mm').innerHTML = addCommas(t.needed_mm);
		ById('poptab_cur_mm').innerHTML = addCommas(t.cur_mm);

		ById('poptab_needed_mm').style.color = (t.needed_mm  > t.cur_mm?'red':'green')
		ById('poptab_cur_mm').style.color = (t.needed_mm  > t.cur_mm?'red':'green')

		dismissBtn_help1 = lang.population.popControldismissBtn_help1;
		dismissBtn_help2 = lang.population.popControldismissBtn_help2;
		need_to_dismiss = parseInt(t.max_idle_pop - t.cur_idle_pop);
		dismissBtn = ById('poptab_dismiss_mm');
		if(parseInt(need_to_dismiss) > 0 && parseInt(need_to_dismiss) <= parseInt(t.cur_mm) && !t.busy && !t.cycle_running)
			{
			dismissBtn.disabled = false;
			dismissBtn.value = ""+lang.population.popControlButtonDissmissMM1+" " + addCommas(need_to_dismiss) + " "+lang.population.popControlButtonDissmissMM2+"";
			}
		else
			{
			dismissBtn.disabled = true;
			dismissBtn.value = ""+lang.population.popControlButtonDissmissMM+"";
			}

		queueBtn_help1 = lang.population.popControlqueueBtn_help1;
		queueBtn_help2 = lang.population.popControlqueueBtn_help2;
		unitId = 1;
		var res_ok = 0;
		for (var i = 1; i < 5; i++)
			{
			var res_need = parseInt(uW.unitcost["unt" + unitId][i]) * 3600 * parseInt(t.cur_idle_pop);
			var res_have = parseInt(uW.seed.resources["city" + cityId]["rec" + i][0]);
			if(parseInt(res_need) > parseInt(res_have))	{	res_ok++;	}
			}
		queueBtn = ById('poptab_queue_st');
		if(parseInt(t.slots_free) > 0 && parseInt(t.cur_idle_pop) >= parseInt(t.max_idle_pop) && parseInt(res_ok)==0 && !t.busy && !t.cycle_running)
			{
			queueBtn.disabled = false;
			queueBtn.value = ""+lang.population.popControlButtonQueueSupplyTrp1+" " + addCommas(t.cur_idle_pop) + " "+lang.population.popControlButtonQueueSupplyTrp2+"";
			}
		else
			{
			queueBtn.disabled = true;
			queueBtn.value = ""+lang.population.popControlButtonQueueSupplyTrp+"";
			}

		deleteBtn_help1 = lang.population.popControldeleteBtn_help1;
		deleteBtn_help2 = lang.population.popControldeleteBtn_help2;
		//deleteBtn_help3 = "** Due to a bug, you should refresh your game before using this button! **";
		deleteBtn_help3 = lang.population.popControldeleteBtn_help3;
		deletebtn = ById('poptab_del_queues');
		if(Seed.queue_unt['city'+cityId].length > 0 && !t.busy && !t.cycle_running)
			{
			deletebtn.disabled = false;
			deletebtn.value = " "+lang.population.popControlButtonDelAllQueues1+" " + Seed.queue_unt['city'+cityId].length + " "+lang.population.popControlButtonDelAllQueues2+"";
			}
		else
			{
			deletebtn.disabled = true;
			deletebtn.value = ""+lang.population.popControlButtonDelAllQueues+"";
			}

		runcycleBtn_help1 = lang.population.popControlruncycleBtn_help1;
		runcycleBtn_help2 = lang.population.popControlruncycleBtn_help2;
		//runcycleBtn_help3 = "------ This button is disabled for now. -----";
		runcycleBtn_help3 = lang.population.popControlruncycleBtn_help3;
		res_ok = 0;
		t.cycle_pop_continue = (parseInt(t.slots_free) * parseInt(t.max_idle_pop)) + (parseInt(t.max_idle_pop) * 2);
		for (var i = 1; i < 5; i++)
			{
			var res_need = parseInt(uW.unitcost["unt" + unitId][i]) * 3600 * parseInt(t.cycle_pop_continue);
			var res_have = parseInt(uW.seed.resources["city" + cityId]["rec" + i][0]);
			if(parseInt(res_need) > parseInt(res_have))	{	res_ok++;	}
			}
		runcycleBtn = ById('poptab_run_cycle');
		//if(parseInt(t.cur_idle_pop) >= parseInt(t.max_idle_pop) && parseInt(res_ok)==0 && !t.busy && !t.cycle_running)
		t.needed_mm_continue = t.cycle_pop_continue;
		if(parseInt(t.needed_mm) <= parseInt(t.cur_mm) && parseInt(res_ok)==0 && !t.busy && !t.cycle_running)
			{
			runcycleBtn.disabled = false;
			}
		else
			{
			runcycleBtn.disabled = true;
			}

		},

	run_cycle : function (cityId)
		{
		// Temp disable auto train for this city & auto reassign & auto transport & auto refresh
		// log all that

		var t = Tabs.PopControl;
		clearTimeout (t.timer);
		clearTimeout (t.timer_cycle);
		t.disable_btns();
		if(!t.cycle_running)
			{
			t.log(""+lang.population.popControlLogStartBuildPop+" " + t.cur_idle_pop);
			t.cycle_running = true;
			t.cycle_step = 1;
			}

		//t.actionlog("1");
		t.max_idle_pop = (parseInt(Seed.citystats['city'+cityId].pop[1])).toFixed(0);
		t.cur_idle_pop = (parseInt(Seed.citystats['city'+cityId].pop[0])).toFixed(0);
		//num = parseInt(t.max_idle_pop) - parseInt(t.cur_idle_pop);
		if(parseInt(t.cur_idle_pop) < parseInt(t.max_idle_pop))	// Need to Dismiss MM
			{
					if (t.cycle_running && t.last_ran == 'train') {
						t.dismiss_mm(cityId);
						t.last_ran = 'dismiss';
					} else {
						t.timer_cycle = setTimeout (function() {t.run_cycle(cityId)}, 1500);
			}
			//t.actionlog("2");
			}
		else if(parseInt(t.slots_free) > 0 && parseInt(t.cur_idle_pop) >= parseInt(t.max_idle_pop)) // Need to queue supply troops
			{
				if (t.cycle_running)	{
							t.queue_st(cityId);
							t.last_ran = 'train';
			}
			//t.actionlog("3");
			}
		else if(parseInt(t.slots_free) == 0)	// Delete all the queues
			{
			//t.actionlog("4");
			t.cycle_running = false;
			setTimeout(uW.update_seed_ajax, 250);
			t.del_queues_start(t.tcp.city.id);
			t.timer = setTimeout (t.show, 1000);
			return;
			}
		else
			{
			t.log(""+lang.population.popControlLogWaiting+"");	// Wait
			}
		//t.actionlog("5");
		setTimeout(uW.update_seed_ajax, 250);
		t.timer_cycle = setTimeout (function() {t.run_cycle(cityId)}, 1500);
		},

	dismiss_mm : function (cityId)
		{
		var t = Tabs.PopControl;
		t.disable_btns();
		unitId = t.poptab_troop_dismiss;
		t.max_idle_pop = (parseInt(Seed.citystats['city'+cityId].pop[1])).toFixed(0);
		t.cur_idle_pop = (parseInt(Seed.citystats['city'+cityId].pop[0])).toFixed(0);
		num = parseInt(t.max_idle_pop) - parseInt(t.cur_idle_pop);
		if (t.cur_mm < num) num = t.cur_mm;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.cid = cityId;
		params.type = unitId;
		params.quant = num;
		new MyAjaxRequest(uW.g_ajaxpath + "ajax/dismissUnits.php" + uW.g_ajaxsuffix,
			{
			method: "post",
			parameters: params,
			onSuccess: function(rslt)
				{
				if (rslt.ok)
					{
					t.log(lang.population.popControlButtonDissmissMM1+" "+ addCommas(num) +" " + lang.population.popControlLogFailDissmiss2);
					Seed.units['city'+cityId]['unt'+unitId] -= num;
					if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
					t.busy = false;
					t.show_city(cityId);
					}
				else
					{
					t.log(""+lang.population.popControlLogFailDissmiss+" "+ addCommas(num) +" "+lang.population.popControlLogFailDissmiss2+"");
					t.busy = false;
					}
				},
			});
		setTimeout(uW.update_seed_ajax, 250);
		},

	queue_st : function (cityId)
		{
		var t = Tabs.PopControl;
		t.disable_btns();

		unitId = 1;
		num = t.cur_idle_pop;
		var time = uW.modal_barracks_traintime(unitId, num);
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.cid = cityId;
		params.type = unitId;
		params.quant = num;
		params.gambleId = 0;
		new MyAjaxRequest(uW.g_ajaxpath + "ajax/train.php" + uW.g_ajaxsuffix,
			{
			method: "post",
			parameters: params,
			onSuccess: function(rslt)
				{
				if (rslt.ok){
					t.log(""+lang.population.popControlLogTrain+" "+ addCommas(num) +" "+lang.population.popControlLogTrain2+"");
					if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
					for (var i = 1; i < 5; i++)
						{
						var resourceLost = parseInt(uW.unitcost["unt" + unitId][i]) * 3600 * parseInt(num);
						if(rslt.gamble) resourceLost = resourceLost*rslt.gamble[i];
						uW.seed.resources["city" + cityId]["rec" + i][0] = parseInt(uW.seed.resources["city" + cityId]["rec" + i][0]) - resourceLost;
						}
					uW.seed.citystats["city" + cityId].gold[0] = parseInt(uW.seed.citystats["city" + cityId].gold[0]) - parseInt(uW.unitcost["unt" + unitId][5]) * parseInt(num);
					uW.seed.citystats["city" + cityId].pop[0] = parseInt(uW.seed.citystats["city" + cityId].pop[0]) - parseInt(uW.unitcost["unt" + unitId][6]) * parseInt(num);
					uW.seed.queue_unt["city" + cityId].push([unitId, num, rslt.initTS, parseInt(rslt.initTS) + time, 0, rslt.ticksNeeded, null]);
					t.busy = false;
					t.show_city(cityId);
			}else{
					t.log(""+lang.population.popControlLogFailTrain+" "+ addCommas(num) +" "+lang.population.popControlLogFailTrain2+"");
					t.busy = false;
					}
				},
			});
		setTimeout(uW.update_seed_ajax, 250);
		},


	del_queues_start : function (cityId)
		{
		var t = Tabs.PopControl;
		t.disable_btns();

		t.del_count = Seed.queue_unt['city'+cityId].length;
		t.log(""+lang.population.popControlLogAttemptDel+" " + t.del_count + " "+lang.population.popControlLogAttemptDel2+"");
		t.del_queues(cityId);
		},

 	del_queues : function (cityId)
		{
		var t = Tabs.PopControl;
		clearTimeout (t.timer_del);
		var q = Seed.queue_unt['city'+cityId];
		var qs = q.toString();
		if(q.length > 0 || t.del_count > 0)
			{
			t.del_count -= 1;
			typetrn =		q[0][0];
			numtrptrn =	q[0][1];
			trnTmp =		q[0][2];
			trnETA = 		q[0][3];
			trnNeeded =	q[0][5];
			trainingId = 0;
			t.delete_queue_slot(typetrn, numtrptrn, trnTmp, trnETA, trnNeeded, cityId, trainingId)
			t.delete_queue_slot(typetrn, numtrptrn, trnTmp, parseInt(trnETA)-1, trnNeeded, cityId, trainingId)	//?!
						}
		else
			{
			t.log(""+lang.population.popControlLogNoQueDel+"");
			t.del_count = 0;
			t.busy = false;
			return;
			}
		setTimeout(uW.update_seed_ajax, 250);
		t.timer_del = setTimeout (function() {t.del_queues(cityId)}, 1500);
	},
	delete_queue_slot : function (typetrn, numtrptrn, trnTmp, trnETA, trnNeeded, cityId, trainingId)
		{
		var t = Tabs.PopControl;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.pf =0;
		params.requestType = "CANCEL_TRAINING";
		params.cityId = cityId;
		params.typetrn = typetrn;
		params.numtrptrn = numtrptrn;
		params.trnETA = trnETA;
		params.trnTmp = trnTmp;
		params.trnNeeded = trnNeeded;
		new AjaxRequest(uW.g_ajaxpath + "ajax/cancelTraining.php" + uW.g_ajaxsuffix,
			{
			method: "post",
			parameters: params,
			onSuccess: function (message)
				{
				var rslt=eval("("+message.responseText+")");
				if (rslt.updateSeed) { try {uW.update_seed(rslt.updateSeed);} catch (e) {} }
				if (rslt.ok)
					{
					t.log("Deleted queue of "+ addCommas(numtrptrn) +" "+ troops[typetrn]);
					var k=0;
					for(var j=0;j<Seed.queue_unt["city"+cityId].length;j++)
						{
						if(j>trainingId)
							{
							Seed.queue_unt["city"+cityId][j][2]=parseInt(rslt.dateTraining[k]["start"]);
							Seed.queue_unt["city"+cityId][j][3]=parseInt(rslt.dateTraining[k]["end"]);
							k++;
							}
						}
					Seed.queue_unt["city"+cityId].splice(trainingId,1);
					for(var i=1;i<5;i++)
						{
						var totalReturn=parseInt(uW.unitcost["unt"+typetrn][i])*parseInt(numtrptrn)*3600/2;
						Seed.resources["city"+cityId]["rec"+i][0]=parseInt(Seed.resources["city"+cityId]["rec"+i][0])+totalReturn;
						}
					}
				else
					{
					}
				},
			onFailure: function ()
				{
				},
			});
		},
}
/*************** WILDS TAB *********************/
var wildNames={0:"Marais",10:"Prairie",11:"Lac",20:"Bois",30:"Collines",40:"Montagne",50:"Plaine"};
var mercNames={0:"Aucun",1:"Novices",2:"Intermediaire",3:"Veterans"}
Tabs.Wilds = {
  tabOrder : 9,
  tabLabel: lang.BoiteLabelWild,
  cont : null,
  state : null,
  upGoldTimer : null,
  wildList : [],
  buildList : {},

  show : function (){
   var t = Tabs.Wilds;
   t.init();
  },

  hide : function (){
    var t = Tabs.Wilds;
    clearTimeout (t.upGoldTimer);
  },
  abandon : function (cid,tid,x,y){
      var t = Tabs.Wilds;
      var params = uW.Object.clone(uW.g_ajaxparams);
      		var cityID = cid;
      		var tileid = tid;
      		params.tid=tid;
      		params.cid=cid;
      		params.x=x;
        		params.y=y;
        		new AjaxRequest(uW.g_ajaxpath + "ajax/abandonWilderness.php" + uW.g_ajaxsuffix, {
      			method: "post",
        		    parameters: params,
        		    loading: true,
        		    onSuccess:function(transport){
      				var rslt=eval("("+transport.responseText+")");
      				if (rslt.ok) {
      					t.error_code = 0;
      					if (rslt.returningMarches) {
      						var cities = Object.keys(rslt.returningMarches);
      						for (var i = 0; i < cities.length; i++) {
      							for (var j = 0; j < rslt.returningMarches[cities[i]].length; j++) {
      				                var cid = cities[i].split("c")[1];
      				                var mid = rslt.returningMarches[cities[i]][j];
      				                var march = Seed.queue_atkp["city" + cid]["m" + mid];
      								if (march) {
      									var marchtime = Math.abs(parseInt(march.destinationUnixTime) - parseInt(march.marchUnixTime));
      				                    var ut = uW.unixtime();
      				                    Seed.queue_atkp["city" + cid]["m" + mid].destinationUnixTime = ut;
      				                    Seed.queue_atkp["city" + cid]["m" + mid].marchUnixTime = ut - marchtime;
      				                    Seed.queue_atkp["city" + cid]["m" + mid].returnUnixTime = ut + marchtime;
      				                    Seed.queue_atkp["city" + cid]["m" + mid].marchStatus = 8
      				                }
      				            }
      				        }
      				        t.init();
      				    }
      					if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
      				    if (Object.keys(Seed.wilderness["city" + cityID]).length == 1) {
      						Seed.wilderness["city" + cityID] = []
        		         	} else	{
      						delete Seed.wilderness["city"+cityID]["t"+tileid];
        		         	}
      				} else {
      				 t.init();
      					if (rslt.error_code != 401) {
      						t.error_code = rslt.error_code;

                     		}
        		        }
        		    },
        		    onFailure: function () {}
  		});

  },
  init : function (div){
    var t = Tabs.Wilds;

    uW.ptButMaxTraps = t.e_butMaxTraps;
    uW.ptInpWildTraps = t.e_inpTraps;
    uW.ptButWildSet = t.e_butWildSet;
    uW.ptButWildShow = t.init;
    uW.boAbandon = t.abandon;
    clearTimeout (t.upGoldTimer);
    if (t.state == null){
      t.cont = div;
      t.cont.innerHTML = '<DIV id=wildContent style="maxheight:'+(Options.HauteurBoite-25)+'px; height:'+(Options.HauteurBoite-25)+'px; overflow-y:auto">';
      t.state = 1;
    }

    m = '<TABLE cellspacing=0 cellpadding=0 class=ptTabPad align=center width=99%>';
    for (var c=0; c<Cities.numCities; c++){
      var city = Cities.cities[c];
      t.wildList[c] = [];
      var totWilds = 0;
      var datw = Seed.wilderness['city'+ city.id];
      if (datw!=null && matTypeof(datw)=='object')
      for (k in datw)
        ++totWilds;
      var nivcastle = parseInt(Seed.buildings['city'+ city.id].pos0[1]);
      var castle = nivcastle;
      if (nivcastle==11) castle=12;
      if (nivcastle==12) castle=14;
      if (totWilds < castle)  {
        var totWildsstring = '<SPAN style="font-color:red"><B>'+ totWilds +'/'+ castle +'</b></span>';
      }else{
          var totWildsstring = totWilds +'/'+ castle;
      }
      m += '<TR><TD colspan=21><DIV class=boStat>'+ city.name +' &nbsp; ('+ city.x +','+ city.y +') - '+totWildsstring+'</div></td></tr>';
      var row = 0;
      var sortem = [];
      var cWilds = Seed.wilderness['city'+city.id];
      if (matTypeof(cWilds) != 'array') {
        m += '<TR style="font-weight:bold;" align=right><TD align=left>'+uW.g_js_strings.commonstr.wilderness+'</td><TD></td><TD align=left>Coord</td><td>Dist</td><TD>'+uW.g_js_strings.commonstr.traps+'</td><TD align=left>Merc</td>\
         <TD width=15></td><TD colspan=3 class=entry>'+ htmlTitleLine(' '+uW.g_js_strings.modaltitles.wildernessdefense.toUpperCase()+' ') +'</td></tr>';
        for (var k in Seed.wilderness['city'+city.id])
          sortem.push (Seed.wilderness['city'+city.id][k]);
        sortem.sort (function (a,b){
          var x; if ((x = b.tileLevel-a.tileLevel)!=0)
            return x;
          return a.tileType-b.tileType;
        });
        for (i=0; i<sortem.length; i++){
          var wild = sortem[i];
          var wildDef = Seed.wildDef['t'+wild.tileId];
          if (wildDef==undefined || !wildDef)
            wildDef = {fort60Count:0, mercLevel:0};
          var maxTraps = parseInt(wild.tileLevel)*100;
          var maxBuild = maxTraps - parseInt(wildDef.fort60Count);
           var distancedelaville = distance (city.x, city.y, wild.xCoord, wild.yCoord);
          t.wildList[c][i] = [wild.tileId, maxBuild];
          m += '<TR align=right><TD align=left><a onclick="boAbandon('+city.id+','+wild.tileId+','+ wild.xCoord +','+ wild.yCoord +');"><img src="'+CANCELBTN+'" border=0 title="'+uW.g_js_strings.commonstr.abandon+'"></a>&nbsp;'+ wildNames[wild.tileType] +'</td>\
            <TD>'+ wild.tileLevel +'</td><TD align=center>\
             <a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ wild.xCoord +','+ wild.yCoord +')</a></td><td><b>'+distancedelaville+'</td>\
            <TD align=right><B>'+ wildDef.fort60Count +'</b></td><TD align=center><B>'+ mercNames[wildDef.mercLevel] +'</b></td>\
            <TD></td><TD align=left class=ptentry><B>Ajout Pi&egrave;ges :</b> <INPUT onchange="ptInpWildTraps(this)" id=ptwt_'+ c +'_'+ i
              + (maxBuild==0?' DISABLED ':'')+' style="margin:0px; padding:0px" type=text size=3 maxlength=4></td>'
          if (wildDef.fort60Count < maxTraps)
            m += '<TD class=ptentry style="padding:0px">'+ strButton14('Max', 'id=ptwx_'+ c +'_'+ i +' onclick="ptButMaxTraps(this)"') +'</td>';
          else
            m += '<TD class=ptentry></td>';
          m += '<TD class=ptentry> &nbsp; &nbsp; <B>Mercs:</b> ' + htmlSelector(mercNames, wildDef.mercLevel, 'id=ptwm_'+ c +'_'+ i) +' &nbsp; &nbsp; </td></tr>';
        }
        m += '<TR><TD colspan=7></td><TD class=ptentry align=center colspan=3><TABLE><TR><TD width=40% align=left>Co&ucirc;t Or : <SPAN id=ptwgc_'+ c +'>0</span></td>\
            <TD width=10%>'+ strButton20(uW.g_js_strings.commonstr.upgrade.toUpperCase(), 'onclick="ptButWildSet('+ c +')"') +'<TD width=40% align=right><SPAN id=ptwgt_'+ c +'></span></td></td></tr></table></td></tr>';
      } else {
        m+= '<TR><TD colspan=10> &nbsp; </td></tr>';
      }
    }
    ById('wildContent').innerHTML = m + '</table></div>';
    t.updateGold ();
  },

  e_butWildSet : function (c){
    var t = Tabs.Wilds;
    var totTraps = 0;
    var cid = Cities.cities[c].id;
    t.buildList = {cityId:cid, list:[]};

    for (var w=0; w<t.wildList[c].length; w++){
      var wild = Seed.wilderness['city'+cid]['t'+t.wildList[c][w][0]];
      var wildDef = Seed.wildDef['t'+t.wildList[c][w][0]];
      if (wildDef==undefined || !wildDef)
        wildDef = {fort60Count:0, mercLevel:0};

      var numTraps = parseInt(ById('ptwt_'+ c +'_'+ w).value, 10);
      if (isNaN(numTraps))
        numTraps = 0;
      totTraps += numTraps;
      if (numTraps > 0)
        t.buildList.list.push (['T', wild.tileId, numTraps]);
      var mercId=ById('ptwm_'+ c +'_'+ w).value;
      if (wildDef.mercLevel != mercId)
        t.buildList.list.push (['M', wild.tileId, mercId, wildDef.mercLevel]);
    }

    var totCost = totTraps * 200;
    if (totCost > parseInt(Seed.citystats['city'+cid].gold[0])){
      ById('ptwgc_'+ c).innerHTML = '<SPAN class=boldRed>'+ addCommasInt(totCost) +'</span>';
      return;
    }
    if (t.buildList.list.length == 0)
      return;
    t.setCurtain (true);
    var popDiv = t.setPopup (true);
    popDiv.innerHTML = '<TABLE class=ptTab width=100% height=100%><TR><TD>\
          <DIV class=boStat>Configuration des d&eacute;fenses des terres sauvages (TS)</div>\
          <DIV id=ptWildBuildDiv class=ptDiv style="padding:10px; height:225px; max-height:225px; overflow-y:auto"></div>\
          </td></tr><TR><TD align=center>'+ strButton20(uW.g_js_strings.commonstr.cancel.toUpperCase(), 'id=ptWildCancel') +'</td></tr></table>';
    ById('ptWildCancel').addEventListener('click', t.e_buildCancel, false);
    t.processQue(null);
  },

  e_buildCancel : function (){
    var t = Tabs.Wilds;
    t.setCurtain(false);
    t.setPopup(false);
    t.init();
  },

  processQue : function (errMsg){
    var t = Tabs.Wilds;
    var what = t.buildList.list.shift();
    var div = ById('ptWildBuildDiv');
    if (what==null || errMsg){
      if (errMsg)
        div.innerHTML += '<BR><SPAN style="white-space:normal;" class=boldRed>ERREUR : '+ errMsg +'</span>';
      else
        div.innerHTML += lang.wild.done+'<BR>';
      ById('ptWildCancel').firstChild.innerHTML = lang.wild.close;
      return;
    }
    if (div.innerHTML != '')
      div.innerHTML += lang.wild.done+'<BR>';
    var wild = Seed.wilderness['city'+ t.buildList.cityId]['t'+what[1]];
    if (what[0] == 'T'){
      div.innerHTML += lang.wild.build+''+ what[2] +' pi&egrave;ges sur '+ Cities.byID[t.buildList.cityId].name +'\' sur Terres au '+ wild.xCoord +','+ wild.yCoord +' ... ';
      t.postBuyTraps (t.buildList.cityId, what[1], what[2], t.processQue);
    } else {
      div.innerHTML += lang.wild.merc+' -'+ mercNames[what[2]] +'- sur '+ Cities.byID[t.buildList.cityId].name +'\' sur Terres au '+ wild.xCoord +','+ wild.yCoord +' ... ';
      t.postHireMercs (t.buildList.cityId, what[1], what[2], what[3], t.processQue);
    }
  },

  setPopup : function (onoff){
    var t = Tabs.Wilds;
    if (onoff){
      var div = document.createElement('div');
      div.id = 'ptWildPop';
      div.style.backgroundColor = '#fff';
      div.style.zindex = mainPop.getLayer()+2;
      div.style.opacity = '1';
      div.style.border = '3px outset red';
      div.style.width = '550px';
      div.style.height = '300px';
      div.style.display = 'block';
      div.style.position = 'absolute';
      div.style.top = '100px';
      div.style.left = '100px';
      t.cont.appendChild (div);
      return div;
    } else {
      t.cont.removeChild (ById('ptWildPop'));
    }
  },

  setCurtain : function (onoff){
    var t = Tabs.Wilds;
    if (onoff){
      var off = getAbsoluteOffsets (t.cont);
      var curtain = document.createElement('div');
      curtain.id = 'ptWildCurtain';
      curtain.style.zindex = mainPop.getLayer()+1;
      curtain.style.backgroundColor = "#000000";
      curtain.style.opacity = '0.5';
      curtain.style.width = t.cont.clientWidth +'px';
      curtain.style.height = t.cont.clientHeight +'px';
      curtain.style.display = 'block';
      curtain.style.position = 'absolute';
      curtain.style.top = off.top + 'px';
      curtain.style.left = off.left + 'px';
      t.cont.appendChild (curtain);
    } else {
      t.cont.removeChild (ById('ptWildCurtain'));
    }
  },

  e_butMaxTraps : function (e){
    var t = Tabs.Wilds;
    var c = e.id.substr(5,1);
    var w = e.id.substr(7);
    var inp = ById('ptwt_'+ c +'_'+ w);
    inp.value = t.wildList[c][w][1];
    t.e_inpTraps (inp);
  },

  e_inpTraps : function (e){
    var t = Tabs.Wilds;
    var c = e.id.substr(5,1);
    var w = e.id.substr (7);
    var tot = 0;
    for (var i=0; i<t.wildList[c].length; i++) {
      var val = parseInt(ById('ptwt_'+ c +'_'+ i).value, 10);
      if (isNaN(val))
        val = 0;
      tot += val;
    }
    ById('ptwgc_'+ c).innerHTML = addCommasInt(tot * 200);
    if (isNaN(e.value) || e.value<0 || e.value>t.wildList[c][w][1]){
      e.value = '';
      e.style.backgroundColor = '#ffaaaa';
    } else
      e.style.backgroundColor = null;
  },

  updateGold : function (){
    var t = Tabs.Wilds;
    for (var c=0; c<Cities.numCities; c++){
      var e = ById('ptwgt_'+ c +'');
      if (e)
        e.innerHTML = addCommasInt(Seed.citystats['city'+Cities.cities[c].id].gold[0]);
    }
  },

  postBuyTraps : function (cid, tid, quant, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.cid = cid;
    params.tid = tid;
    params.quant = quant;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/buyWildTraps.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (rslt.ok){
         if (!Seed.wildDef["t"+ tid])
          Seed.wildDef["t"+ tid] = {tileId:tid, fort60Count:0, mercLevel:0};
          Seed.wildDef["t"+ tid].fort60Count = parseInt(Seed.wildDef["t"+ tid].fort60Count) + parseInt(quant);
         }
         if (notify)
          notify (rslt.errorMsg);
      },
      onFailure: function () {
        if (notify)
          notify ('AJAX ERROR');
      },
    });
  },

  postHireMercs : function (cid, tid, newLevel, oldLevel, notify){

    var params = uW.Object.clone(uW.g_ajaxparams);
    params.cid = cid;
    params.tid = tid;
    params.lv = newLevel;
    params.olv = oldLevel;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/hireWildMerc.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (rslt.ok){
          if (!Seed.wildDef["t"+ tid])
            Seed.wildDef["t"+ tid] = {tileId:tid, fort60Count:0, mercLevel:0};
          Seed.wildDef["t"+ tid].mercLevel = newLevel;
        }
        if (notify)
          notify (rslt.errorMsg);
      },
      onFailure: function () {
        if (notify)
          notify ('AJAX ERROR');
      },
    });
  },
}

/*********** AUTO CONSTRUCTION *********/
var quickAddBuildings = {
		   all:"All",
		   barracks:"Barracks",
		   cottages:"Cottages",
}
Tabs.build = {
    tabOrder: 11,
    tabLabel: uW.g_js_strings.commonstr.build,
    myDiv: null,
    timer: null,
    buildTab: null,
    koc_buildslot: null,
    currentBuildMode: null,
	loaded_bQ: [],
	lbQ: [],
	buildingSelect:'all',
    UASlowDown : 0,
	build0:false,	build1:false,	build2:false,	build3:false,	build4:false,	build5:false,	build6:false,	build7:false,
    init: function(div){
        var t = Tabs.build;
        t.myDiv = div;
        t.koc_buildslot = uW.buildslot;
        t.currentBuildMode = "build";
	    if (Options.BORac_Bui) AddSubTabLink(lang.build.buttonlabel, t.toggleStateRunning, 'pbbuildtab');
        for (var i = 0; i < Cities.cities.length; i++) {
            t["bQ_" + Cities.cities[i].id] = JSON2.parse(GM_getValue('bQ_' + getServerId() + '_' + Cities.cities[i].id, '[]'));
			if (typeof t["bQ_" + Cities.cities[i].id] == 'undefined' || (t["bQ_" + Cities.cities[i].id]) == "") {
				t["bQ_" + Cities.cities[i].id] = [];
			}

        }
        var m = '<DIV id=pbBuildDivF class=boStat>'+lang.build.title+'</div><TABLE id=pbbuildfunctions width=100% height=0% class=pbTab><TR>';
        if (Options.buildStates.running == false) {
            m += '<TD><INPUT id=pbBuildRunning type=submit value="'+lang.build.biglabel+' = OFF"></td>';
	       if (Options.BORac_Bui) updatebotbutton(lang.build.buttonlabel+' - OFF', 'pbbuildtab');
        }
        else {
            m += '<TD><INPUT id=pbBuildRunning type=submit value="'+lang.build.biglabel+' = ON"></td>';
	       if (Options.BORac_Bui) updatebotbutton(lang.build.buttonlabel+' - ON', 'pbbuildtab');
        }
	m += '<TD><INPUT id=pbBuildMode type=submit value="'+lang.build.modebuild+' = OFF"></td>';
			m += '<TD>Build Type: <SELECT id="pbBuildType">\
				<OPTION value=build>'+uW.g_js_strings.commonstr.next+'</option>\
				<OPTION value=max>'+uW.g_js_strings.commonstr.maximum+'</option>\
				<OPTION value=destruct>'+uW.g_js_strings.commonstr.destroy+'</option>\
				<OPTION value=destructnow>'+uW.g_js_strings.commonstr.destroy+' Now !</option>\
				<OPTION value=buildmine>Level 1 Now !</option>\
				</select><br>Level 1 Now : <select id=BOTypeBat><option value=5>'+uW.buildingcost.bdg5[0]+'</option><option value=13>'+uW.buildingcost.bdg13[0]+'</option><option value=21>'+uW.buildingcost.bdg21[0]+'</option><option value=1>'+uW.buildingcost.bdg1[0]+'</option><option value=2>'+uW.buildingcost.bdg2[0]+'</option><option value=3>'+uW.buildingcost.bdg3[0]+'</option><option value=4>'+uW.buildingcost.bdg4[0]+'</option></select></td>';
		m += '<TD><INPUT id=pbHelpRequest type=checkbox '+ (Options.buildStates.help?' CHECKED':'') +'\></td><TD>'+uW.g_js_strings.modaltitles.helprequest+'</td>';
		m += '</tr></table></div>';
        m += '<DIV id=pbBuildDivQ class=boStat>'+lang.build.biglabel+'</div><TABLE id=pbbuildqueues width=100% height=0% class=ptentry><TR>';
		for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD colspan=2><CENTER><B>' + Cities.cities[i].name + '</b></center></td>';
        }
		m += '</tr><TR>';
        for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD colspan=2><CENTER><INPUT id=pbbuild_' + Cities.cities[i].id + ' type=submit value="'+uW.g_js_strings.commonstr.view+'"></center></td>';
        }
        m += '</tr><TR>';
        for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD colspan=2><CENTER><INPUT id=pbCancelAll_' + Cities.cities[i].id + ' type=submit value="'+uW.g_js_strings.modaltitles.deleteall+'"></center></td>';
        }
        m += '</tr><TR>';
		for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD colspan=2><CENTER><DIV id=divBuildingCity_' + Cities.cities[i].id + '></div></center></td>';
        }
        m += '</tr><TR>';
        for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD colspan=2><CENTER><DIV id=divCurrentBuildCity_' + Cities.cities[i].id + '></div></center></td>';
        }
        m += '</tr><TR>';
        for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD colspan=2><CENTER><DIV id=divTimeLeftCity_' + Cities.cities[i].id + '></div></center></td>';
        }
        m += '</tr><TR>';
        for (var i = 0; i < Cities.cities.length; i++) {
            m += '<TD align=right width=2%>Fil:</td><TD id=pbbuildcount_' + Cities.cities[i].id + '>' + t["bQ_" + Cities.cities[i].id].length + '</td>';

        }
        m += '</tr><TR>';
        for (var i = 0; i < Cities.cities.length; i++) {
            t['totalTime_' + Cities.cities[i].id] = 0;
            cbQ = t["bQ_" + Cities.cities[i].id];
            if (typeof cbQ != 'undefined') {
                for (var j = 0; j < cbQ.length; j++) {
                    t['totalTime_' + Cities.cities[i].id] = parseInt(t['totalTime_' + Cities.cities[i].id]) + parseInt(cbQ[j].buildingTime);
                }
                timestring = timestr(t['totalTime_' + Cities.cities[i].id]);
            }
            m += '<TD align=right width=2%>Tt:</td><TD id=pbbuildtotal_' + Cities.cities[i].id + '>' + timestring + '</td>';
        }
        m += '</tr><TR>';
         m += '</tr></table><SPAN class=boldRed id=pbbuildError></span>';
         m+='<br>' + pubdusite;
        t.myDiv.innerHTML = m;

        for (var i = 0; i < Cities.cities.length; i++) {
            var cityId = Cities.cities[i].id;
            var btnName = 'pbbuild_' + cityId;
            addQueueEventListener(cityId, btnName);
            var btn2Name = 'pbCancelAll_' + cityId;
            CancelAllEventListener(cityId, btn2Name);
			t.showBuildQueue(cityId, false);
        }
        setTimeout(function() { t.e_autoBuild(0);  }, 2000);

		ById('pbBuildType').addEventListener('change', function(){t.setBuildMode(this.value);}, false);
		ById('pbBuildRunning').addEventListener('click', function(){
            t.toggleStateRunning(this);
        }, false);
		ById('pbBuildMode').addEventListener('click', function(){
            t.toggleStateMode(this);
        }, false);
		ById('pbHelpRequest').addEventListener ('change', function (){
        Options.buildStates.help = ById('pbHelpRequest').checked;
        t.saveBuildStates();
        }, false);

		window.addEventListener('unload', t.onUnload, false);

        function addQueueEventListener(cityId, name){
            ById(name).addEventListener('click', function(){
                t.showBuildQueue(cityId, true);
            }, false);
        }

        function CancelAllEventListener(cityId, name){
            ById(name).addEventListener('click', function(){
            	t["bQ_" + cityId] = [];
            	t['totalTime_' + cityId] = 0;
            	ById('pbbuildcount_' + cityId).innerHTML = 0;
            	ById('pbbuildtotal_' + cityId).innerHTML = timestr(0);
            }, false);
        }


    },
      paintBusyDivs: function () {
	        var t = Tabs.build;
	        var now = unixTime();
	        for (var i = 0; i < Cities.cities.length; i++) {
	            var cityId = Cities.cities[i].id;
	            if (!ById('divBuildingCity_' + cityId)) return;
	            var isBusy = false;
	            var qcon = Seed.queue_con["city" + cityId];
	            if (matTypeof(qcon) == 'array' && qcon.length > 0) {
	                if (parseInt(qcon[0][4]) > now) {
	                    isBusy = true;
	                }
	            }
	            if (isBusy) {
	                var timeLeft = Seed.queue_con["city" + cityId][0][4] - now
	                if (Seed.queue_con["city" + cityId][0][1] == 0) {
	                    if (ById('divBuildingCity_' + cityId)) ById('divBuildingCity_' + cityId).innerHTML = uW.g_js_strings.commonstr.destroy + '...';
	                } else {
	                    if (ById('divBuildingCity_' + cityId)) ById('divBuildingCity_' + cityId).innerHTML = uW.g_js_strings.commonstr.building + '...';
	                }
	                if (ById('divCurrentBuildCity_' + cityId)) ById('divCurrentBuildCity_' + cityId).innerHTML = uW.buildingcost["bdg" + Seed.queue_con["city" + cityId][0][0]][0] + ' Lvl ' + Seed.queue_con["city" + cityId][0][1];
	                if (ById('divTimeLeftCity_' + cityId)) ById('divTimeLeftCity_' + cityId).innerHTML = timestr(timeLeft);
	            } else {
	                if (ById('divBuildingCity_' + cityId)) ById('divBuildingCity_' + cityId).innerHTML = '';
	                if (ById('divCurrentBuildCity_' + cityId)) ById('divCurrentBuildCity_' + cityId).innerHTML = '';
	                if (ById('divTimeLeftCity_' + cityId)) ById('divTimeLeftCity_' + cityId).innerHTML = '';
	            }
	        }
    },
	setBuildMode: function (type) {
	    var t = Tabs.build;
		t.currentBuildMode = type;
		},
    e_autoBuild: function(cityIdT){
      var t = Tabs.build;
      var ilya=0;
      for (var i = 0; i < Cities.cities.length; i++) {
	           var cityId = Cities.cities[i].id;
	           ilya+=t["bQ_" + cityId].length;
	         }
	         if (ilya < 1) {
	           t.toggleStateRunning();
	           return;
       }
       var buildInterval = 4000 + t.UASlowDown;
	   ById('pbbuildError').innerHTML = '';
	   if (Options.buildStates.running == true) {
	            var now = unixTime()-5;
	   			var itime = 1000;
	               for (var i = 0; i < Cities.cities.length; i++) {
	   				itime += 2000;
	                   var cityId = Cities.cities[i].id;
	                   var isBusy = false;
	                   var qcon = Seed.queue_con["city" + cityId];
	                   if(t['build'+Cities.byID[cityId].idx] == true)continue;//so we don't get overloaded with slowed down requests
	                   if (matTypeof(qcon) == 'array' && qcon.length > 0) {
	                    if (parseInt(qcon[0][4]) > now) isBusy = true;
	                     else {
	                     	if(qcon[0][1] == 0) {
	                     		delete Seed.buildings["city" + cityId]['pos'+qcon[0][7]];

	                  	   } else {
	   								Seed.buildings["city" + cityId]['pos'+qcon[0][7]] = [qcon[0][0],qcon[0][1],qcon[0][7],qcon[0][2]];

	   							};
	   							qcon.shift();
	   							uW.modal_build_show_state();
							    if (cityId == uW.currentcityid) uW.update_bdg();
	   						};
	                   }
	                   if (isBusy) {
	                   } else {
	                       if (t["bQ_" + cityId].length > 0) {
	                           //var bQi = t["bQ_" + cityId][0];
	                           t['build'+Cities.byID[cityId].idx] = true;
	                           //t.doOneSlowdown(bQi,itime);
	                           t.doOneSlowdown(cityId,itime);
	                       }
	                   }
	               }
	           }
	           setTimeout(t.e_autoBuild, buildInterval); //should be at least 10
	       },

	       doOneSlowdown : function (cityId,itime){
	           var t = Tabs.build;
	   		setTimeout(function(){t.doOne(cityId)},itime);
	   	},

    doOne : function (cityId){
		var t = Tabs.build;
		var bQi = t["bQ_" + cityId][0];
		if(!bQi)return;
		var currentcityid = parseInt(bQi.cityId);
		t['build'+Cities.byID[currentcityid].idx] = false;
		var cityName = t.getCityNameById(currentcityid);
		var time = parseInt(bQi.buildingTime);
		var mult = parseInt(bQi.buildingMult);
		var attempt = parseInt(bQi.buildingAttempt);
		var mode = bQi.buildingMode;
		var bypasscheck = false;
		var citpos = parseInt(bQi.buildingPos);
        var qcon = Seed.queue_con["city" + bQi.cityId];
		if (matTypeof(qcon) == 'array' && qcon.length > 0) return;
		if ((Seed.buildings['city' + currentcityid]["pos" + citpos] == undefined)) {
			bypasscheck = true;
			if (currentcityid == uW.currentcityid) document.getElementById('slot_'+ citpos).className="blank";
		}
        if (!bypasscheck) {
			var l_bdgid = parseInt(bQi.buildingType);
			var bdgid = parseInt(Seed.buildings['city' + currentcityid]["pos" + citpos][0]);
			var l_curlvl = parseInt(bQi.buildingLevel);
			var curlvl = parseInt(Seed.buildings['city' + currentcityid]["pos" + citpos][1]);
			var l_bid = parseInt(bQi.buildingId);
			var bid = parseInt(Seed.buildings["city" + currentcityid]["pos" + citpos][3]);

			if (curlvl > 8 && mode == 'build') {
				t.cancelQueueElement(0, currentcityid, time, false);
				if (Options.LogsAutoCons)actionLog("AutoCons","Queue item deleted: Building Level equals 9 or higher!!!");
				return;
			};
			if (isNaN(curlvl)) {
				t.cancelQueueElement(0, currentcityid, time, false);
				if (Options.LogsAutoCons)actionLog("AutoCons","Found no correct value for current building!!!!");
				return;
			}
			if (l_bdgid != bdgid) {
				t.cancelQueueElement(0, currentcityid, time, false);
				if (Options.LogsAutoCons)actionLog("AutoCons","Building Type does not match!!!!");
				return;
			}
			if (l_bid != bid) {
				t.cancelQueueElement(0, currentcityid, time, false);
				if (Options.LogsAutoCons)actionLog("AutoCons","Building ID does not match!!!!");
				return;
			}
			if (l_curlvl < curlvl) {
					t.cancelQueueElement(0, currentcityid, time, false);
					if (Options.LogsAutoCons)actionLog("AutoCons","Queue item deleted: Buildinglevel is equal or higher!!!");
					return;
			}
			if (l_curlvl > curlvl && mode == 'build') {
					t.requeueQueueElement(bQi);
					return;
			}
	     } else {
            var l_bdgid = parseInt(bQi.buildingType);
            var bdgid = l_bdgid;
            var l_curlvl = parseInt(bQi.buildingLevel);
            var curlvl = l_curlvl;
            var l_bid = parseInt(bQi.buildingId);
            var bid = l_bid;
        }
			if (mode == 'destruct') {
				var params = uW.Object.clone(uW.g_ajaxparams);
				params.cid = currentcityid;
				params.bid = "";
				params.pos = citpos;
				params.lv = curlvl - 1;
				if (curlvl >= 1) {
					params.bid = bid;
				}
				params.type = bdgid;
				params.pay_for_an_additional_queue=0;
                params.permission=0;
				new MyAjaxRequest(uW.g_ajaxpath + "ajax/destruct.php" + uW.g_ajaxsuffix, {
					method: "post",
					parameters: params,
					onSuccess: function(rslt){
						if (rslt.ok) {
							Seed.queue_con["city" + currentcityid].push([bdgid, 0, parseInt(rslt.buildingId), uW.unixtime(), uW.unixtime() + rslt.timeNeeded, 0, rslt.timeNeeded, citpos]);

							if (params.cid == uW.currentcityid) uW.update_bdg();
							t.cancelQueueElement(0, currentcityid, time, false);
						} else {
							var errmsg = uW.printLocalError(rslt.error_code || null, rslt.msg || null, rslt.feedback || null);
							if (Options.LogsAutoCons)actionLog("AutoCons",cityName + " : " + rslt.error_code + ":" +errmsg);
							var a = null;
							var g = Number(rslt.error_code);
							var g_server = uW.g_server;
							switch (g) {
							case 0:
								a = "Unexpected Error.";
								break;
							case 2:
								uW.buildingcost["bdg666"] = ["Wallet Gremlins", 0, 0, 0, 0, 0, 0, 0, [], [], ""];
								Seed.queue_con["city" + currentcityid].push([666, 666, 666, uW.unixtime(), uW.unixtime() + 5*60, 0, 5*60, 999]);
								a = "Construction is already starting.";
								break;
							case 3:
								break;
							case 8:
								a = "Excess traffic.";
								uW.cm.GATracker("Error", a + " (" + g + ")", g_server);
								break;
							case 102:
								t.cancelQueueElement(0, currentcityid, time, false);
								break;
							case 103:
								t.cancelQueueElement(0, currentcityid, time, false);
								break;
							default:
								a = "Something has gone wrong.";
								uW.cm.GATracker("Error", a + " (" + g + ")", g_server);
								t.requeueQueueElement(bQi);
								ById('pbbuildError').innerHTML = Cities.byID[currentcityid].name + ': ' + errmsg + " Item was requeued. Check for retry count.";
								break;
							};
							if(rslt.user_action) {
															t.UASlowDown += 1000;
							};

						}
					},
					onFailure: function(){
						ById('pbbuildError').innerHTML = lang.build.err1;
						if (Options.LogsAutoCons)actionLog("AutoCons",cityName + " : " + lang.build.err1);
					}
				},true)
			}
			if (mode == 'build') {
				var invalid = false;
				var chk = BOcheckreq("bdg", bdgid, curlvl, 0, currentcityid);
				for (var c = 0; c < chk[3].length; c++) {
					if (chk[3][c] == 0) {
					invalid = true;
					}
				}
				if (invalid == false) {
					var params = uW.Object.clone(uW.g_ajaxparams);
					params.cid = currentcityid;
					params.bid = "";
					params.pos = citpos;
					params.lv = curlvl + 1;
					if (params.lv > 9){
						t.cancelQueueElement(0, currentcityid, time, false);
					   if (Options.LogsAutoCons)actionLog("AutoCons", Cities.byID[currentcityid].name +" -Queue item deleted: Tryed to build level 10+ building! Please report if this happens!!!");
						return;
					}
					if (params.lv > 1) {
						params.bid = bid;
					}
					params.type = bdgid;
					params.pay_for_an_additional_queue=0;
                params.permission=0;
					if ((Seed.resources["city" + currentcityid].rec1[0] >= parseInt(uW.buildingcost["bdg" + bdgid][1]) * mult * 3600) &&
					   (Seed.resources["city" + currentcityid].rec2[0] >= parseInt(uW.buildingcost["bdg" + bdgid][2]) * mult * 3600) &&
					  (Seed.resources["city" + currentcityid].rec3[0] >= parseInt(uW.buildingcost["bdg" + bdgid][3]) * mult * 3600) &&
					  (Seed.resources["city" + currentcityid].rec4[0] >= parseInt(uW.buildingcost["bdg" + bdgid][4]) * mult * 3600) &&
					 (Seed.citystats["city" + currentcityid].gold[0] >= parseInt(uW.buildingcost["bdg" + bdgid][5]) * mult)) {
					      new AjaxRequest(uW.g_ajaxpath + "ajax/construct.php" + uW.g_ajaxsuffix, {
              	method: "post",
						parameters: params,
						onSuccess: function(transport){
                        	var rslt = eval("(" + transport.responseText + ")");
							if (rslt.ok) {
								Seed.resources["city" + currentcityid].rec1[0] -= parseInt(uW.buildingcost["bdg" + bdgid][1]) * mult * 3600;
								Seed.resources["city" + currentcityid].rec2[0] -= parseInt(uW.buildingcost["bdg" + bdgid][2]) * mult * 3600;
								Seed.resources["city" + currentcityid].rec3[0] -= parseInt(uW.buildingcost["bdg" + bdgid][3]) * mult * 3600;
								Seed.resources["city" + currentcityid].rec4[0] -= parseInt(uW.buildingcost["bdg" + bdgid][4]) * mult * 3600;
								Seed.citystats["city" + currentcityid].gold[0] -= parseInt(uW.buildingcost["bdg" + bdgid][5]) * mult;
								Seed.queue_con["city" + currentcityid].push([bdgid, curlvl + 1, parseInt(rslt.buildingId), uW.unixtime(),  uW.unixtime() + rslt.timeNeeded, 0, rslt.timeNeeded, citpos]);
								if (params.cid == uW.currentcityid)
									uW.update_bdg();
								if (Options.buildStates.help && parseIntNan(rslt.timeNeeded) > 59)
								 		t.bot_gethelp(params.bid, currentcityid, time, 1);
								t.cancelQueueElement(0, currentcityid, time, false);
							} else {
							if (rslt.user_action) {
							   if (rslt.user_action!="backOffWaitTime") {
								if (Options.LogsAutoCons)actionLog("AutoCons","<b><font color=red>Detection Captcha  !!!</font></b>");
								new CdialogCancelContinue('<SPAN class=boldRed>CAPTCHA ALERT ! AUTOBUILD !</span>', null, null, mainPop.getMainDiv());
							   }

							} else {

								var errmsg = uW.printLocalError(rslt.error_code || null, rslt.msg || null, rslt.feedback || null);
								var a = null;
								var g = Number(rslt.error_code);
								var g_server = uW.g_server;
								switch (g) {
									case 0:
										a = "Unexpected Error.";
										break;
									case 2:
										uW.buildingcost["bdg666"] = ["Wallet Gremlins", 0, 0, 0, 0, 0, 0, 0, [], [], ""];//comical wallet gremlin placeholder
										Seed.queue_con["city" + currentcityid].push([666, 666, 666, uW.unixtime(), uW.unixtime() + 5*60, 0, 5*60, 999]);
										a = "Construction is already starting.";
										break;
									case 3:
										break;
									case 8:
										a = "Excess traffic.";
										uW.cm.GATracker("Error", a + " (" + g + ")", g_server);
										break;
									case 102:
										if (Options.LogsAutoCons)actionLog("AutoCons", Cities.byID[currentcityid].name +" - Another building already exists on the same spot lets delete our queued building");
										t.cancelQueueElement(0, currentcityid, time, false);
										break;
									case 103:
										if (Options.LogsAutoCons)actionLog("AutoCons", Cities.byID[currentcityid].name +" - building has already the target level => just  delete");
										t.cancelQueueElement(0, currentcityid, time, false);
										break;
									default:
										a = "Something has gone wrong.";
										uW.cm.GATracker("Error", a + " (" + g + ")", g_server);
										t.requeueQueueElement(bQi);
										ById('pbbuildError').innerHTML = Cities.byID[currentcityid].name + ': ' + errmsg + " Item was requeued. Check for retry count.";
										break;
								};
								if(rslt.user_action) {
																	t.UASlowDown += 1000;
								};

							}

							}
					},
				onFailure: function(){
							ById('pbbuildError').innerHTML = "Connection Error while building! Please try later again";
							if (Options.LogsAutoCons)actionLog("AutoCons", Cities.byID[currentcityid].name +' : Connection Error while building! Please try later again');
				}
			},true);
	   } else {
		// t.requeueQueueElement(bQi);
		// ById('pbbuildError').innerHTML =lang.build.err2;
		// if (Options.LogsAutoCons)actionLog("AutoCons", Cities.byID[currentcityid].name +' : <font color=red>'+lang.build.err2+'</font>');
	   }
      }
     }
	},
	countbizarre:0,
	requeueQueueElement: function (bQi) {
	    var t = Tabs.build;
		var cityId = bQi.cityId;
		var buildingPos = parseInt(bQi.buildingPos);
		var buildingId = parseInt(bQi.buildingId);
		var buildingLevel = parseInt(bQi.buildingLevel);
		var buildingType = parseInt(bQi.buildingType);
		var buildingTime = parseInt(bQi.buildingTime);
		var buildingMult = parseInt(bQi.buildingMult);
		var buildingAttempts = parseInt(bQi.buildingAttempts);
		var buildingMode = bQi.buildingMode;
		if(buildingAttempts < 10)
		 t.addQueueItem(cityId, buildingPos, buildingType, buildingId, buildingTime, buildingLevel, buildingAttempts + 1, buildingMult, buildingMode);
		t.cancelQueueElement(0, cityId, buildingTime, false);
	},
    show: function(){
		var t = Tabs.build;
    },
    bot_buildslot: function(c, a){
        var t = Tabs.build;
		var cityId = t.getCurrentCityId();
        var buildingPos   = c.id.split("_")[1];
        if (t.currentBuildMode != "buildmine") {
        	var buildingType  = parseInt(Seed.buildings['city' + cityId]["pos" + buildingPos][0]);
        	var buildingLevel = parseInt(Seed.buildings['city' + cityId]["pos" + buildingPos][1]);
		var buildingId    = parseInt(Seed.buildings['city' + cityId]["pos" + buildingPos][3]);
  		var buildingAttempts = 0;
		var loaded_bQ = t["bQ_" + cityId];
		if (typeof Seed.queue_con['city' + cityId][0] != 'undefined') {
			var current_construction_pos = Seed.queue_con['city' + cityId][0][2];
		} else {
			var current_construction_pos = "";
		}
		if (loaded_bQ.length == 0 && current_construction_pos != "" ) {
			if (current_construction_pos != 'NaN' && current_construction_pos == buildingId) {
				buildingLevel += 1;
			}
		} else {
			if (current_construction_pos != "" && current_construction_pos == buildingId) {
				buildingLevel += 1;
			}
			for (var i = 0; i < loaded_bQ.length; i++) {
				var loadedCity = loaded_bQ[i].cityId;
				var loadedSlot = loaded_bQ[i].buildingPos;
				if (loadedSlot == buildingPos && loadedCity == cityId) {
					buildingLevel += 1;
				}
				if (loaded_bQ[i].buildingMode == 'destruct' && loadedSlot == buildingPos && loadedCity == cityId) {
					t.modalmessage(lang.build.err3);
					return;
				}
			}
		}
		}
        if (t.currentBuildMode == "build") {
	       if (buildingLevel >= 9) {
                t.modalmessage(lang.build.err4);
                return;
            }
            var buildingMode = "build";
			var result = t.calculateQueueValues(cityId, buildingLevel, buildingType, buildingMode);
			var buildingMult = result[0];
			var buildingTime = result[1];
			var queueId = loaded_bQ.length;
			t.addQueueItem(cityId, buildingPos, buildingType, buildingId, buildingTime, buildingLevel, buildingAttempts, buildingMult, buildingMode);
			t._addTab(queueId, cityId, buildingType, buildingTime, buildingLevel, buildingAttempts, buildingMode);
        }
        if (t.currentBuildMode == "max") {
            var buildingMode = "build";
			for (var bL = buildingLevel; bL <9; bL++) {
				var queueId = loaded_bQ.length;
				var result = t.calculateQueueValues(cityId, bL, buildingType, buildingMode);
				var buildingMult = result[0];
				var buildingTime = result[1];
				queueId = queueId ;
				t.addQueueItem(cityId, buildingPos, buildingType, buildingId, buildingTime, bL, buildingAttempts, buildingMult, buildingMode);
				t._addTab(queueId, cityId, buildingType, buildingTime, bL, buildingAttempts, buildingMode);
			}
        }
        if (t.currentBuildMode == "destruct") {
            var buildingMode = "destruct";
            if(buildingLevel > 9)
            	return;
			var result = t.calculateQueueValues(cityId, buildingLevel, buildingType, buildingMode);
			var buildingMult = result[0];
			var buildingTime = result[1];
			var queueId = loaded_bQ.length;
			t.addQueueItem(cityId, buildingPos, buildingType, buildingId, buildingTime, buildingLevel, buildingAttempts, buildingMult, buildingMode);
			t._addTab(queueId, cityId, buildingType, buildingTime, buildingLevel, buildingAttempts, buildingMode);
        }
         if (t.currentBuildMode == "destructnow") {
		   var params = uW.Object.clone(uW.g_ajaxparams);
				params.cityId = cityId;
				params.buildingId = buildingId;
				params.pos = buildingPos;
				params.requestType = "DESTROY_BUILDING_DRAGON_STOMP_MEDAL";
				new MyAjaxRequest(uW.g_ajaxpath + "ajax/destroyBuilding.php" + uW.g_ajaxsuffix, {
					method: "post",
					parameters: params,
					onSuccess: function(rslt){
						if (rslt.ok) {
							uW.seed.items.i9=Number(uW.seed.items.i9)-1;
							uW.ksoItems[9].subtract();
							delete Seed.buildings["city"+cityId]["pos"+buildingPos];
							uW.citysel_click(ById("citysel_"+(Cities.byID[cityId].idx+1)));
						} else {
							var errmsg = uW.printLocalError(rslt.error_code || null, rslt.msg || null, rslt.feedback || null);
							ById('pbbuildError').innerHTML = errmsg;
						}
					},
					onFailure: function(){
						ById('pbbuildError').innerHTML = lang.build.err1;
					}
				})
     }
     if (t.currentBuildMode == "buildmine") {
			    var buildingLevel = 0;
			    var buildingId = 0;
			    var buildingType = ById("BOTypeBat").value;
			    var aide=0;
			    if (ById("pbHelpRequest").checked) aide=1;
               if (Seed.buildings['city' + cityId]["pos" + buildingPos]) {
				   var buildingType  = parseInt(Seed.buildings['city' + cityId]["pos" + buildingPos][0]);
				   var buildingLevel = parseInt(Seed.buildings['city' + cityId]["pos" + buildingPos][1]);
		           var buildingId    = parseInt(Seed.buildings['city' + cityId]["pos" + buildingPos][3]);
			   }
              uW.build(buildingType,buildingLevel,buildingPos,aide);
	        }
    },
	calculateQueueValues: function (cityId, buildingLevel, buildingType, buildingMode) {
	    var t = Tabs.build;
		var now = unixTime();
		var MaxBuild = uW.cm.thronestats.boosts.ConstructionSpeed.Max;
		var constructionBoost = Math.min(uW.cm.ThroneController.effectBonus(78), MaxBuild);
		if (buildingMode == 'build') {
			var buildingMult = Math.pow(2, buildingLevel);
        }
		if (buildingMode == 'destruct') {
			var buildingMult = Math.pow(2, buildingLevel - 2);
		}

		var knights = Seed.knights["city" + cityId];
		if (knights) {
			var polKniId = parseInt(Seed.leaders['city' + cityId].politicsKnightId);
			if (polKniId) {
				var polValue = parseInt(Seed.knights['city' + cityId]['knt' + polKniId].politics);
				var polBoost = parseInt(Seed.knights['city' + cityId]['knt' + polKniId].politicsBoostExpireUnixtime);
				if ((polBoost - now) > 0) {
					polValue = parseInt(polValue * 1.25);
				}
			} else {
				polValue = 0;
			}
		} else {
			polValue = 0;
		}
        var buildingTime = uW.buildingcost["bdg" + buildingType][7] * buildingMult;
        if (parseInt(buildingType) < 6 && parseInt(buildingType) > 0 && buildingMult == 1) {
            buildingTime = 15;
        }
	if (buildingMode == 'build') {
			buildingTime = parseInt(buildingTime / (1 + 0.005 * polValue + 0.1 * parseInt(Seed.tech.tch16)));
			 if (constructionBoost > 0) buildingTime = Math.round(buildingTime / (1 + (constructionBoost / 100)));
    }
	if (buildingMode == 'destruct') {
			buildingTime = parseInt(buildingTime / (1 + 0.005 * polValue + 0.1 * parseInt(Seed.tech.tch16)));
			if (buildingTime % 1 > 0) {
				buildingTime = parseInt(buildingTime);
			}
		}
	 var result = new Array(buildingMult, buildingTime);
	 return result;
	},
	bot_gethelp: function (f, currentcityid, time, retry) {
	  var t = Tabs.build;
	  var city = t.getCityNameById(currentcityid);
	  var params = uW.Object.clone(uW.g_ajaxparams);
	  if (retry>3) return;  //dont want to get stuck in a loop of failures
	  params.bid = f;
	  params.ctrl = 'AskForHelp';
	  params.action = 'getHelpData';
	  new MyAjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
		  method: "post",
		  parameters: params,
		  onSuccess: function (rslt) {
			var a=rslt.data;
			var f = uW.Object.keys(a)[0];
			var memoire = ById('mod_comm_input').value;
			if (a[f].b) {
					var b = a[f].b;
					var d = uW.Object.keys(uW.seed.queue_con);
					for (var c = 0; c < d.length; c++) {
						if (uW.seed.queue_con[d[c]].length > 0) {
							if (uW.seed.queue_con[d[c]][0][2] == b) {
								if (uW.Object.isArray(uW.seed.updateHelpConstruct)) {
									uW.seed.updateHelpConstruct = {}
								}
								uW.seed.updateHelpConstruct[d[c]] = a;
								break
							}
						}
					}
					uW.postToAllianceChat(0, b);
					ById('mod_comm_input').value = memoire;
				} else {
					if (a[f].t) {
						var e = a[f].t;
						var d = uW.Object.keys(seed.queue_tch);
						for (var c = 0; c < d.length; c++) {
							if (uW.seed.queue_tch[d[c]].length > 0) {
								if (uW.seed.queue_tch[d[c]][0][0] == e) {
									if (uW.Object.isArray(uW.seed.updateHelpResearch)) {
										uW.seed.updateHelpResearch = {}
									}
									uW.seed.updateHelpResearch[d[c]] = a;
									break
								}
							}
						}
						uW.postToAllianceChat(1, e);
						ById('mod_comm_input').value = memoire;
					}
				}
		  },
		  onFailure: function (rslt) {
			 t.bot_gethelp(f, currentcityid, time, retry+1);
			return;
		  },
		  });
   if (time > 240) {
	  var a = Seed.queue_con["city" + currentcityid];
	  var e = 0;
	  var d = 0;
	  for (var c = 0; c < a.length; c++) {
		if (parseInt(a[c][2]) == parseInt(f)) {
		  e = parseInt(a[c][0]);
		  d = parseInt(a[c][1]);
		  break;
		}
	  }
	  var b = new Array();
	  b.push(["REPLACE_LeVeLbUiLdInG", d]);
	  b.push(["REPLACE_BuIlDiNgNaMe", uW.buildingcost["bdg" + e][0]]);
	  b.push(["REPLACE_LeVeLiD", d]);
	  b.push(["REPLACE_AsSeTiD", f]);
	  var g = function(h, i) {
		uW.continuation_95(h, i);
		if (!h) {
		  var j = d > 1 ? uW.cm.SpeedUpType.upgrade : uW.cm.SpeedUpType.build;
		  uW.cm.ClientSideCookieManager.setCookie(j, false)
		}
	  };
	  uW.common_postToProfile("95", b);
     }
	},
	addQueueItem: function (cityId, buildingPos, buildingType, buildingId, buildingTime, buildingLevel, buildingAttempts, buildingMult, buildingMode) {
	var t = Tabs.build;
		var lbQ = t["bQ_" + cityId];
		lbQ.push({
            cityId: 			cityId,
            buildingPos:		buildingPos,
            buildingType: 		buildingType,
			buildingId: 		buildingId,
            buildingTime: 		buildingTime,
            buildingLevel: 		buildingLevel,
            buildingAttempts: 	buildingAttempts,
			buildingMult: 		buildingMult,
            buildingMode: 		buildingMode
        });
	    t.modifyTotalTime(cityId, 'increase', buildingTime);
	},
    modalmessage: function(message){
	    var t = Tabs.build;
        var timeout = 10000;
        var content = lang.build.autoclose+"<br><br>"
        content += message;
        uW.Modal.showAlert(content);
        setTimeout(function() {
          uW.Modal.hideModal();
        }, timeout);
    },
	modifyTotalTime: function (cityId, type, buildingTime) {
	    var t = Tabs.build;
		var element = ById('pbbuildcount_' + cityId);
		var currentCount = parseInt(element.innerHTML);
		if (type == "increase") {
			t['totalTime_' + cityId] = t['totalTime_' + cityId] + buildingTime;
			var currentCount = currentCount + 1;
		}
		if (type == "decrease") {
			t['totalTime_' + cityId] = t['totalTime_' + cityId] - buildingTime;
			var currentCount = currentCount - 1;
		}
		element.innerHTML = currentCount;
		ById('pbbuildtotal_' + cityId).innerHTML = timestr(t['totalTime_' + cityId]);
	},
    hide: function(){
        var t = Tabs.build;
    },
    onUnload: function(){
        var t = Tabs.build;
        t.saveBuildStates();
    },
    _addTab: function(queueId, cityId, buildingType, buildingTime, buildingLevel, buildingAttempts, buildingMode){
		var t = Tabs.build;
        var row = ById('pbCityQueueContent').insertRow(0);
        row.vAlign = 'top';
        row.insertCell(0).innerHTML = queueId;
        if (buildingMode == "destruct") {
            row.insertCell(1).innerHTML = '<img src="'+gameurl+'img/bonus_att.png">';
        }
        else {
            row.insertCell(1).innerHTML = '<img src="'+gameurl+'img/bonus_prod.png">';
        }
        row.insertCell(2).innerHTML = uW.buildingcost['bdg' + buildingType][0];
        row.insertCell(3).innerHTML = timestr(buildingTime);
		if (buildingMode == "destruct") {
			row.insertCell(4).innerHTML = 0;
        } else {
			row.insertCell(4).innerHTML = buildingLevel + 1;
		}
		row.insertCell(5).innerHTML = buildingAttempts;
        row.insertCell(6).innerHTML = '<a class="button20" id="queuecancel_' + queueId + '"><span>'+uW.g_js_strings.commonstr.cancel+'</span></a>';
        ById('queuecancel_' + queueId).addEventListener('click', function(){
            t.cancelQueueElement(queueId, cityId, buildingTime, true);
        }, false);
    },
    cancelQueueElement: function(queueId, cityId, buildingTime, showQueue){
        var t = Tabs.build;
        var queueId = parseInt(queueId);
        t["bQ_" + cityId].splice(queueId, 1);
        t.modifyTotalTime(cityId, 'decrease', buildingTime);

        if (showQueue == true) {
            t.showBuildQueue(cityId, false);
        }
    },
    showBuildQueue: function(cityId, focus){
	    var t = Tabs.build;
	    clearTimeout (t.timer);
        var popBuildQueue = null;
        var cityName = t.getCityNameById(cityId);
        if (t.popBuildQueue == null) {
            t.popBuildQueue = new CPopup('pbbuild_' + cityId, 0, 0, 350, 500, true, function() {clearTimeout (t.timer);});
        }
        var m = '<DIV style="max-height:460px; height:460px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbTabPad" id="pbCityQueueContent">';
        t.popBuildQueue.getMainDiv().innerHTML = '</table></div>' + m;
        t.popBuildQueue.getTopDiv().innerHTML = '<TD width="200px"><B>'+lang.build.queue+ ' ' + cityName + '</b></td><TD><INPUT id=pbOptimizeByTime type=submit value="'+lang.build.optimize+'"></td>';
        t.popBuildQueue.centerMe (mainPop.getMainDiv());

        t.paintBuildQueue(cityId);
        if (focus)
          t.popBuildQueue.show(true);
		ById('pbOptimizeByTime').addEventListener('click', function(){t.clearBuildQueue();t.paintBuildQueue(cityId, true);}, false);
		t.timer = setTimeout (function() {t.showBuildQueue(cityId, false)}, 45000);
	},
    paintBuildQueue: function(cityId, optimize){
        var t = Tabs.build;
        var lbQ = t["bQ_" + cityId];
		if (optimize == true) {
			lbQ.sort(function(a,b){return a.buildingTime - b.buildingTime});
		}
		t["bQ_" + cityId] = lbQ;
		for (var i = 0; i < lbQ.length; i++) {
			var queueId = i;
			t._addTab(queueId, lbQ[i].cityId, lbQ[i].buildingType, lbQ[i].buildingTime, lbQ[i].buildingLevel, lbQ[i].buildingAttempts, lbQ[i].buildingMode);
        }
    },
    clearBuildQueue: function() {
	    var t = Tabs.build;
		var table = ById('pbCityQueueContent');
		var rows = table.rows;
		while(rows.length)
			table.deleteRow(rows.length-1);
	},
    getCurrentCityId: function(){
        if (!uW.currentcityid)
            return null;
        return uW.currentcityid;
    },
    saveBuildStates: function(){
        var t = Tabs.build;
        for (var i = 0; i < Cities.cities.length; i++) {
            GM_setValue('bQ_' + getServerId() + '_' + Cities.cities[i].id, JSON2.stringify((t["bQ_" + Cities.cities[i].id])));
        }
        saveOptions();
    },

    toggleStateRunning: function(obj){
		var t = Tabs.build;
		obj = ById('pbBuildRunning');
        if (Options.buildStates.running == true) {
            Options.buildStates.running = false;
            t.saveBuildStates();
            if (obj) obj.value = lang.build.biglabel+" = OFF";
	      if (Options.BORac_Bui) updatebotbutton(lang.build.buttonlabel+' - OFF', 'pbbuildtab');
        }
        else {
            Options.buildStates.running = true;
            t.saveBuildStates();
            if (obj) obj.value = lang.build.biglabel+" = ON";
	    if (Options.BORac_Bui) updatebotbutton(lang.build.buttonlabel+' - ON', 'pbbuildtab');
	    t.e_autoBuild(0);
        }
    },
    toggleStateMode: function(obj){
		var t = Tabs.build;
		obj = ById('pbBuildMode');
            if (obj.value == lang.build.modebuild+' = OFF') {
			uW.buildslot = t.bot_buildslot;
            obj.value = lang.build.modebuild+" = ON";

        }      else {
			uW.buildslot = t.koc_buildslot;
			obj.value = lang.build.modebuild+" = OFF";
        }
    },
	getCityNameById: function (cityId) {
    return Cities.byID[cityId].name;
	},
}
/**************************** CHEVALIERS *********************/
Tabs.Knights = {
 tabOrder: 9,
  tabLabel: uW.g_js_strings.commonstr.knight,
  cont : null,
  state : null,
  displayTimer : null,
  action : 0,
  alphabet : new Array("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"),
  caracteres : 8,
  generateur : '',
  generate : function()
  {
   var t = Tabs.Knights;
   var longueur = t.alphabet.length;
   t.generateur='';
   for(i = 0; i < t.caracteres; i++)  {
    y = Math.floor(Math.random()*2);
    x = Math.floor(Math.random()*longueur);
    res = t.alphabet[x];
  	if(y == 0)
  	{
  	res2 = res.toUpperCase();
  	}
  	else
  	{
  	res2 = res.toLowerCase();
  	}
    t.generateur = t.generateur+res2;
   }
  },
  show : function (){
    var t = Tabs.Knights;
    t.showDiv();
  },
  hide : function (){
    var t = Tabs.Knights;
    clearTimeout (t.displayTimer);
  },
  addKnights:function(cpt,max,currentcityid) {
	var t = Tabs.Knights;
	if (cpt>max-1) return;
	t.generate();
	var params=uW.Object.clone(uW.g_ajaxparams);
		params.pid=Cities.byID[currentcityid].provId;
		params.kname=t.generateur;
		params.cid=currentcityid;
	new uW.Ajax.Request(uW.g_ajaxpath+"ajax/hireSpecialKnight.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,onSuccess:function(transport) {
		var rslt=eval("("+transport.responseText+")");
		 if(rslt.ok){
			 var kn=rslt.knightInfo;
			 kn.knightName=t.generateur;
			 if(Seed.knights["city"+currentcityid]===undefined)Seed.knights["city"+currentcityid]={};
		     var kc=Seed.knights["city"+currentcityid];
		     kc["knt"+kn.knightId]=kn;
			 setTimeout(function() { t.addKnights((cpt+1),max,currentcityid); },500);
		 }
		},
	});

  },
  init : function (div){
    var t = Tabs.Knights;
    uW.ptAssignSkill = t.clickedAssignPoints;
    uW.ptAssignTunes = t.clickedAssignTune;
    uW.BOhireSpecialKnight = t.addKnights;
    uW.BOFireKnigth = t.renvoyer;
    t.cont=div;
    clearTimeout (t.displayTimer);
    if (t.state == null){
      t.cont.innerHTML = '<STYLE>table.ptTabPad tr.ptwpad {background-color:#ffffff; padding-left:5px}</style>\
            <DIV id=ptknightdiv style="max-height:'+(Options.HauteurBoite-25)+'px; height:'+(Options.HauteurBoite-25)+'px; overflow-y:auto">';
      t.state = 1;
    }
    t.showDiv();
   },
   renvoyer: function(cid, kid) {
	       var t = Tabs.Knights;
	       var params = uW.Object.clone(uW.g_ajaxparams);
	           params.cid = cid;
	           params.kid = kid;
	       new MyAjaxRequest(uW.g_ajaxpath + "ajax/fireKnight.php" + uW.g_ajaxsuffix, {
	         method: "post",
	         parameters: params,
	         onSuccess: function (rslt) {
 				delete Seed.knights['city'+cid]['knt'+kid];
 				if (rslt.updateSeed)
        			uW.update_seed(rslt.updateSeed);


        		setTimeout(uW.update_seed_ajax, 250);
        		t.showDiv();
	         },
	         onFailure: function () {
	         },
    });
   },
     saveTabs:function(tab) {


      ById(tab).style.display=(ById(tab).style.display=='none')?'block':'none';
      Options[tab]=ById(tab).style.display;
      saveOptions();

  },
   showDiv: function() {
    var t = Tabs.Knights;
    uW.BOSaveKTab = t.saveTabs;
    function _dispKnight (roleId, knight, numcid){
      var rid = roleId;
      if (roleId==null)
        rid = 1;
      var sty='';
      if (row++ % 2)
        sty = ' ';
       if (knight == null) {
		 m = '<TR '+ sty +'valign=top align=right><TD> --- </td><TD align=left>';
         m += '--------</td><TD colspan=5></td><TD class=ptentry colspan=5></td><TD colspan=2></td></tr>';
      } else {

        var level = parseInt(Math.sqrt(parseInt(knight.experience) / 75)) + 1;
        var unpoints = level - parseInt(knight.skillPointsApplied);
        var salary = (parseInt(knight.skillPointsApplied) + 1) * 20;
        totSalary += salary;
        var ass = '';
        if (knight.knightStatus == 10){
          ass = '<TD class=ptentry align=left colspan=4>'+uW.g_js_strings.commonstr.marching+'</td>';
          	 m = '<TR '+ sty +'valign=top align=right><TD></td><TD align=left>';

        } else {
				 m = '<TR '+ sty +'valign=top align=right><TD> <img src="'+CANCELBTN+'" border=0 onclick="BOFireKnigth('+cid+','+knight.knightId+')"></td><TD align=left>';

          if (unpoints > 0){
            unpoints = '<SPAN class="boldRed">'+ unpoints +'</span>';
            for (var i=0; i<4; i++){
            var sty = 'padding-left:1px;';
            if (i == rid) {
              sty += 'font-weight:bold;color:#116654';
              if (t.action==1) {
	          t.clickedAssignPoints(null, cid,knight.knightId,i);
              }
              if (t.action==2) {
	      	          t.clickedAssignPoints(null, cid,knight.knightId,1);
              }
            }
            if (knight[knightRoles[i][1]]<300) {
               ass += '<TD class=ptentry align=left style="'+ sty +'" ><A style="'+ sty +'" onclick="ptAssignSkill(this,' + cid +','+ knight.knightId +','+ i +')">['+ knightRoles[i][2] +'] &nbsp;</a></td>';
		    }else{
			   ass += '<TD class=ptentry align=left style="'+ sty +'" >[---] &nbsp;</td>';
			}
           }
          }
          else
            ass = '<TD class=ptentry colspan=4>&nbsp;</td>';
        }
        var now = unixTime();
        var skills = [];
        for (var i=0; i<4; i++){
          if (i == rid) {
            var point = knight[knightRoles[i][1]];
            skills[i] = '<B>'+ point +'</b>';
            if (i==1 && knight.combatBoostExpireUnixtime > now) {
		point *= 1.25;
		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.combatBoostExpireUnixtime - now)+'"><B>'+ parseInt(point) +'</b></span></font>';
            }
             if (i==0 && knight.politicsBoostExpireUnixtime > now) {
	    		point *= 1.25;
	    		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.politicsBoostExpireUnixtime - now)+'"><B>'+ parseInt(point) +'</b></span></font>';
            }
             if (i==3 && knight.resourcefulnessBoostExpireUnixtime > now) {
	    		point *= 1.25;
	    		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.resourcefulnessBoostExpireUnixtime - now)+'"><B>'+ parseInt(point) +'</b></span></font>';
            }
             if (i==2 && knight.intelligenceBoostExpireUnixtime > now) {
	    		point *= 1.25;
	    		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.intelligenceBoostExpireUnixtime - now)+'"><B>'+ parseInt(point) +'</b></span></font>';
            }
           } else {
              var point = knight[knightRoles[i][1]];
	      skills[i] = ''+ point +'';
	                 if (i==1 && knight.combatBoostExpireUnixtime > now) {
	     		point *= 1.25;
	     		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.combatBoostExpireUnixtime - now)+'">'+ parseInt(point) +'</span></font>';
	                 }
	                  if (i==0 && knight.politicsBoostExpireUnixtime > now) {
	     	    		point *= 1.25;
	     	    		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.politicsBoostExpireUnixtime - now)+'">'+ parseInt(point) +'</span></font>';
	                 }
	                  if (i==3 && knight.resourcefulnessBoostExpireUnixtime > now) {
	     	    		point *= 1.25;
	     	    		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.resourcefulnessBoostExpireUnixtime - now)+'">'+ parseInt(point) +'</span></font>';
	                 }
	                  if (i==2 && knight.intelligenceBoostExpireUnixtime > now) {
	     	    		point *= 1.25;
	     	    		skills[i] = '<font color=red><span title="Boost 25 %  '+timestr(knight.intelligenceBoostExpireUnixtime - now)+'">'+ parseInt(point) +'</span></font>';
            		 }
           }
        }
        var item211="0";
        var item221="0";
        var item231="0";
        var item241="0";
        if (Seed.items.i211) item211='<a onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){ boost_modal(1,'+ knight.knightId +');return false;}, 500);">'+Seed.items.i211+'</a>';
        if (Seed.items.i221) item221='<a onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){ boost_modal(2,'+ knight.knightId +');return false;}, 500);">'+Seed.items.i221+'</a>';
        if (Seed.items.i231) item231='<a onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){ boost_modal(3,'+ knight.knightId +');return false;}, 500);">'+Seed.items.i231+'</a>';
        if (Seed.items.i241) item241='<a onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){ boost_modal(4,'+ knight.knightId +');return false;}, 500);">'+Seed.items.i241+'</a>';
        m += '<a title="Assigner un role" onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){ assign_role_modal('+ knight.knightId +');return false;}, 500);">' + knight.knightName.substring(0,20) + '</a></td><TD><a title="Augmenter EXP" onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){  xpBoost_modal('+ knight.knightId +');return false; }, 500);" href="javascript:void(0)">'+ level +'</a></td>\
              <TD>'+ skills[0] +' ('+item211+')</td><TD>'+ skills[1] +' ('+item221+')</td><TD>'+ skills[2] +' ('+item231+')</td><TD>' + skills[3]
          +' ('+item241+')</td><TD class=ptentry>'+ unpoints +'</td>'+ ass +'<td><a onclick="citysel_click(document.getElementById(\'citysel_'+ (numcid+1)+'\'));setTimeout (function (){ loyalBoost_modal('+ knight.knightId +');return false;}, 500);" colspan=2>'+knight.loyalty+'</a><img onclick="ptAssignTunes(' + cid +','+ knight.knightId +');" src="'+gameurl+'img/gold_16.png" title="Booster la loyaute a 5% avec l\'or"></td><TD>'+ addCommas(salary) +'</td></tr>';
      }
      return m;
    }

    var totSalary = 0;
    var m = '<TABLE cellspacing=0 align=center width=95% class=ptTabPad><TR><td colspan=15><DIV class=boStat>'+lang.Knights.title+' - <input style="height:20px;font-size:9px;" type=button value="Attribution par defaut" id="BOchebut"><input style="height:20px;font-size:9px;" type=button value="Attribution en combat" id="BOchebut1"></div></td></tr>';
    for (var c=0; c<Cities.numCities; c++) {
      var city = Cities.cities[c];
      var cid = Cities.cities[c].id;
      m += '<TABLE width=95% cellspacing=0 align=center class=ptTabPad><tr><TD colspan=15><DIV class=boStat><span onclick=BOSaveKTab("BOKv'+cid+'");>'+ Cities.cities[c].name +'</span> &nbsp; ('+ city.x +','+ city.y +') &nbsp;<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAtJJREFUOI2NkUtoVHcUh7//nX/m3jGJyYQYvbFJjMzYhUooPqrxgWmV0i58QESEJIS0EsQIXUQUFFHsRrMQBJUuChoVLNJ2NmptKLX4iKi1sVU0YTJ2HM1MHhMnM8nkZu7ce13YDK6CB87mfPw+DucIPqQ6KMDNVlSqyfCCSQLsZxxAfEB4pa/SF2hc2qBXeiqITEbo/PdiNBgJbqWd+8qM4UMUeuZ4Al/W1OkZK0LzghZMK8JXNXW6p9QT4DCFckZBEfUur9CfhW9RapiwBPpDN4l78pBeoVNE/cwCFX96NE1X87Pc6NLmIADyvAAN/8yCDIOUgP9nwQILurY7fHFFEJaAF4gTywnOHW0VRnqiTf+oanF+YeHZjc0HHhPgqv0tRwZdFGsS4kNRYm6IAVaWBL9wLXfEyfREU5lefkq61dYpw7jxw8EWyW1CdLEvpTBW9GM+7VuWUn5GxxhXkvzGPm4Tym3g91XXrFj3GbKghKGX/XMtIzkfCPM956vuaqmN62svN51oIfRfmNR3J47feT7aCdi5DRb5KifABiuLt6ggVVVVPvY/Mjt27X7yzc5G5i1czKer13CwreUVkAHICbQ8pSObHExkk1GmUiMXara1J6bZJyuXPZ3ldl3Pjg+RGg47Pb1/359mOUHZ2q+T8bTzNBgMEh0ze95/hn9VA2+GY78moyHu3fmDRw+61WkmAHp34ivIo1VZvr1twFS16viDoBzsPelAZ2LPjVqX1Bo04/XnCFd595+/kxg37m7Y0XbT/erWMflXPRvyJV2z3UjlnyvMfif2OYLTU7gOuLMTZXleXSX9EqHASCTEmCFqPZpa68wqHlY8kr1SQVo2ZJ332gbTtCqsgT7VtBzAwbFtBoYSmIrKlGFgO0qdHJ7kIiA0Fx9bDiWWjUsqGIogls7ycKAv8sg7L7MCs7JCCPI37T5uOIoaed4f646/SP30FpH1I9fBUIlSAAAAAElFTkSuQmCC" onclick="BOhireSpecialKnight(0,10,'+cid+');" title="Add 10 new Knights"></div></td></tr></table>\
          <div id=BOKv'+cid+' style="display:'+Options["BOKv"+cid]+';"><TABLE cellspacing=0 align=center class=ptTabPad><TBODY><TR style="font-weight:bold" align=right><TD width=30>X</td><TD width=140 align=center>'+uW.g_js_strings.commonstr.nametx+'</td><TD width=22>Niv</td><TD width=25>Pol</td><TD width=25>Com</td>\
          <TD width=25>Int</td><TD width=25>Res</td><TD width=75 align=center colspan=5>-- '+uW.g_js_strings.modaltitles.assignskills+' --</td><td witdh=25 colspan=1>Loy</td><TD width=40 align=right> '+uW.g_js_strings.commonstr.salary+' </td></tr>';
      totSalary = 0;
      var did = {};
      var row = 0;
      for (var i=0; i<knightRoles.length; i++){
        var leader = Seed.leaders['city'+cid][knightRoles[i][1]+'KnightId'];
        if (leader == 0)
          m += _dispKnight (i, null, c);
        else {
          m += _dispKnight (i, Seed.knights['city'+cid]['knt'+leader], c);
          did['knt'+leader] = true;
        }
      }
      var list = [];
      for (k in Seed.knights['city'+cid]){
        if (!did[k])
          list.push (Seed.knights['city'+cid][k]);
      }
      list.sort (function (a,b){return parseInt(b.combat)-parseInt(a.combat)});
      for (i=0; i<list.length; i++)
        m += _dispKnight (null, list[i], c);
       m += '<TR align=right><TD colspan=13><B>'+uW.g_js_strings.commonstr.salary+' Total :</b></td><TD>'+ addCommas(totSalary) +'</td></tr></TBODY></table></div>';
    }
    ById('ptknightdiv').innerHTML = m +'</table></div>';


    t.action = 0;
    but = ById('BOchebut');
    but.addEventListener ('click', function (){
      t.action=1;
      t.showDiv();
    }, false);
    but = ById('BOchebut1');
    but.addEventListener ('click', function (){
          t.action=2;
          t.showDiv();
    }, false);
    t.displayTimer = setTimeout (t.showDiv, 20000);
  },

  clickedAssignTune: function(cid, kid) {
    var t = Tabs.Knights;
    var params = uW.Object.clone(uW.g_ajaxparams);
        params.cid = cid;
        params.kid = kid;
      params.rid=0;
      params.standalone=0;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/rewardKnight.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
       if (rslt.ok) {
         var knight = Seed.knights["city" + cid]["knt" + kid];
         knight.loyalty = parseInt(knight.loyalty) + 5;
      	 t.showDiv();
        }
      },
      onFailure: function () {
      },
    });
  },
  clickedAssignPoints : function (e, cid, kid, rid){
    var t = Tabs.Knights;
    clearTimeout (t.displayTimer);

    var knight = Seed.knights['city'+cid]['knt'+kid];
    if (knight.knightStatus == 10 && e!=null){
      var row = e.parentNode.parentNode;
      row.childNodes[7].innerHTML = uW.g_js_strings.commonstr.marching;
      return;
    }
    sk = [];
    var unassigned = parseInt(Math.sqrt(parseInt(knight.experience)/75)) + 1  - parseInt(knight.skillPointsApplied);


    for (var i=0; i<4; i++){
      sk[i] = parseInt(knight[knightRoles[i][1]]);
      if (i == rid) {
        if ((sk[i]+unassigned)>=300) {
          unassigned=300-sk[i];
          sk[i]=300;

        }else{
          sk[i] += unassigned;
        }
      }
    }
    if (unassigned==0) return;
    if (e!=null) {
     var row = e.parentNode.parentNode;
     for (i=row.cells.length-1; i>=1; i--)
      row.deleteCell (i);
     var newCell=row.insertCell(-1);
     newCell.colSpan = 12;
     newCell.align= 'left';
     newCell.style.padding='1px 5px 1px 10px';
     var div = document.createElement ('div');
     div.style.backgroundColor = '#ffffff';
     div.style.textAlign = 'center';
     div.style.border = '1px solid';
     div.style.width = '98%';
     div.style.whiteSpace = 'normal';
     newCell.appendChild (div);
     div.innerHTML = lang.Knights.assigned+' '+ unassigned +' '+lang.Knights.ass2+' '+ knightRoles[rid][1] +' ... ';
    }
    t.postSkillPoints (cid, kid, sk[0], sk[1], sk[2], sk[3], function (r){t.postDone(r, div)});
  },

  postDone : function (rslt, div){
    var t = Tabs.Knights;
    clearTimeout (t.displayTimer);
    if (rslt.ok){
      if (div) div.innerHTML += '<B>'+lang.Knights.done+'</b>';
      t.displayTimer = setTimeout (t.showDiv, 500);
    } else {
      if (div) div.innerHTML += '<BR><SPAN class=boldRed>ERREUR : '+ rslt.errorMsg +'</span>';
      t.displayTimer = setTimeout (t.showDiv, 10000);
    }
  },

  postSkillPoints : function (cid, kid, pol, com, int, res, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.cid = cid;
    params.kid = kid;
    params.p = pol;
    params.c = com;
    params.i = int;
    params.r = res;

    new MyAjaxRequest(uW.g_ajaxpath + "ajax/skillupKnight.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (rslt.ok) {
          var knight = Seed.knights["city" + cid]["knt" + kid];
          var up = pol + com + int + res - knight.politics - knight.combat - knight.intelligence - knight.resourcefulness;
          knight.politics = pol;
          knight.combat = com;
          knight.intelligence = int;
          knight.resourcefulness = res;
          knight.skillPointsApplied = (parseInt(knight.skillPointsApplied) + up).toString();
        }
        if (notify)
          notify (rslt);
      },
      onFailure: function () {
        if (notify)
          notify (rslt);
      },
    });
  },
};

/******************* AUTO CRAFTING ************/
Tabs.AutoCraft = {
 tabOrder: 14,
 tabLabel: 'AutoCraft',
 myDiv: null, timer: null, timer1:null,
 toutles  : TrainOptions.CraftIntervallMin,
 crafting: [],   craftinfo : {},
 myDiv: null,    timer: null,    timerStat: null,    numcity :-1,
 init: function(div){
        var t = Tabs.AutoCraft;
        t.myDiv = div;
        t.crafting = {running: TrainOptions.CraftingRunning,};
        t.timer1 = setTimeout(t.UseSpeedup, 9000);
        if (Options.BORac_Cra) AddSubTabLink('Craft', t.toggleStateRunning, 'bocrafttab');
        var m = '<DIV id=pbBuildDivF class=boStat>'+lang.autoCraft.title+'</div>';
        m+="<TABLE class=pbTab cellpadding=0 cellspacing=0><TR  align=center><TD width=55 align=center>&nbsp;</td>";
        for(i=0; i<Cities.numCities; i++) {
            cityID = 'city'+ Cities.cities[i].id;
            m += "<TD width=81><SPAN class=oohfancy>"+ Cities.cities[i].name.substring(0,10) +"</SPAN></td>";

       }
       m+="<td rowspan=6><input type=checkbox id=BOCraftThroneCheck "+ (TrainOptions.throneCheck?'CHECKED':'') +"> " + lang.autoCraft.OnlyThroneSet;
	m += " <SELECT id=BOCraftThroneSet>";
		for (i=1;i<=Seed.throne.slotNum;i++){
			m += '<option value="'+i+'">'+i+'</option>';
		}
		m +='</select></td>';
       m+="</tr><tr><td width=143>";
       if (t.crafting.running == false) {
	   	            m += '<INPUT id=BOCraftRunning type=submit value="AutoCraft = OFF"></td>';
	   	            if (Options.BORac_Cra) updatebotbutton("Craft - OFF", 'bocrafttab');
	   }else {
	   	            m += '<INPUT id=BOCraftRunning type=submit value="AutoCraft = ON"></td>';
	   	            if (Options.BORac_Cra) updatebotbutton("Craft - ON", 'bocrafttab');
	   	            t.timer=setTimeout(t.Start,1000);
       }
       for (var cityId in Cities.byID)
			m+='<td><center><INPUT type=submit id=BOcraftbut_'+ cityId +' value=""></td>';

       m+="</table>";
       m+='<span id="BOCraftStat"></span><DIV id=pbBuildDivQ class=boStat>'+lang.autoCraft.title2+'</div><div style="height:' + (Options.HauteurBoite-200) +'px;max-height:' + (Options.HauteurBoite-200) +'px;overflow-y:auto"><TABLE width=100% height=0% class=ptTab><TR>';

        m += "<td colspan=2><b>"+uW.g_js_strings.commonstr.items+"</td><td><b>"+uW.g_js_strings.commonstr.inventory+"</td><td><b>"+uW.g_js_strings.commonstr.city+"</td><td><b>"+uW.g_js_strings.commonstr.quantity+"</td><td colspan=2><b>"+uW.g_js_strings.commonstr.items+"</td><td><b>"+uW.g_js_strings.commonstr.inventory+"</td><td><b>"+uW.g_js_strings.commonstr.city+"</td><td><b>"+uW.g_js_strings.commonstr.quantity+"</td></tr>";
        m+="<tr><tr>";
        var count=0;
        for(var i=0; i < uW.recipelist[1].length; i++){
				if (uW.recipelist[1][i]) {
			var h = parseInt(uW.recipelist[1][i].output_item_id);
			t.craftinfo[h] = {};
			t.craftinfo[h].recipe_id = uW.recipelist[1][i].recipe_id;
			t.craftinfo[h].category = uW.recipelist[1][i].category;
			t.craftinfo[h].input = uW.recipelist[1][i].input;
			t.craftinfo[h].requirements = uW.recipelist[1][i].requirements;
			var ok=1,titlee=t.craftinfo[h].input.resources[1] + " ether - ";
			for(var d in uW.recipelist[1][i].input.items) {
			   if (uW.itemlist["i"+d])
	  				titlee+= "" + uW.recipelist[1][i].input.items[d] + " " + uW.itemlist["i"+d].name+" - ";
	 		   if(parseIntNan(Seed.items["i"+d]) < parseIntNan(uW.recipelist[1][i].input.items[d]))
		        ok=0;
		    }
		   m += '<td ><center><img src="'+gameurl+'img/items/70/'+ h + '.jpg" width=25></td><td><span title="'+titlee+'">'+uW.itemlist["i"+h].name+'</span></center></td><td><span class=boldGreen id="BOCraft_stock_'+h+'">'+parseIntNan(Seed.items["i"+h])+'</span></td>';
		   m += "<td>";
		   if (!TrainOptions.CraftingNbC[h]) TrainOptions.CraftingNbC[h] = {0:"y", 1:"y", 2:"y", 3:"y", 4:"y", 5:"y", 6:"y", 7:"y"};
		   			for(j=0; j<Cities.numCities; j++) {
		   				if (TrainOptions.CraftingNbC[h][j] == "y") {
		   					m += "<input type=submit id='KsCraft_nbc_"+j+"_"+h+"' style='width:14px;height:14px; margin:1px;text-align:center; background-color: green; color:white; font-size:9px;font-family:arial;font-weight:bold;border-radius:0;' value='"+(j+1)+"'>";
		   				} else {
		   					m += "<input type=submit id='KsCraft_nbc_"+j+"_"+h+"' style='width:14px;height:14px; margin:1px;text-align:center; background-color: red; color:white; font-size:9px;font-family:arial;font-weight:bold;border-radius:0;' value='"+(j+1)+"'>";
		   				}
		   			}
			m += "</td>";

		if (ok==1)
			 m += "<td><input type=text size=3 id='BOCraft_nb_"+h+"' value='"+ parseIntNan(TrainOptions.CraftingNb[h]) +"'></td>";
		else
	 		 m += "<td><input type=text style=' background-color:red' size=3 id='BOCraft_nb_"+h+"' value='"+ parseIntNan(TrainOptions.CraftingNb[h]) +"'></td>";
 		if ((count+1)%2 == 0) m += "</tr><tr>";
        count++;
      }
  }
for(var i=0; i < uW.recipelist[3].length; i++){

	if (uW.recipelist[3][i]) {
var h = parseIntNan(uW.recipelist[3][i].output_item_id);

t.craftinfo[h] = {};
t.craftinfo[h].recipe_id = uW.recipelist[3][i].recipe_id;
t.craftinfo[h].category = uW.recipelist[3][i].category;
t.craftinfo[h].input = uW.recipelist[3][i].input;
t.craftinfo[h].requirements = uW.recipelist[3][i].requirements;
var ok=1,titlee=t.craftinfo[h].input.resources[1] + " ether -";
for(var d in uW.recipelist[3][i].input.items) {
	 if (uW.itemlist["i"+d])
	  titlee+= "" + uW.recipelist[3][i].input.items[d] + " " + uW.itemlist["i"+d].name+" - ";
	if(parseIntNan(uW.ksoItems[d].count) < parseIntNan(uW.recipelist[3][i].input.items[d]))
	  ok=0;
}
m += '<td ><center><img src="'+gameurl+'img/items/70/'+ h + '.jpg" width=25></center></td><td><span title="'+titlee+'">'+uW.itemlist["i"+h].name+'</span></td><td><span class=boldGreen>'+parseIntNan(uW.ksoItems[h].count)+'</span></td>';
if (!TrainOptions.CraftingNbC[h]) TrainOptions.CraftingNbC[h] = {0:"y", 1:"y", 2:"y", 3:"y", 4:"y", 5:"y", 6:"y", 7:"y"};
m += "<td>";
			for(j=0; j<Cities.numCities; j++) {
				if (TrainOptions.CraftingNbC[h][j] == "y") {
					m += "<input type=submit id='KsCraft_nbc_"+j+"_"+h+"' style='width:14px;height:14px; margin:1px;text-align:center; background-color: green; color:white; font-size:9px;font-family:arial;font-weight:bold;border-radius:0;' value='"+(j+1)+"'>";
				} else {
					m += "<input type=submit id='KsCraft_nbc_"+j+"_"+h+"' style='width:14px;height:14px; margin:1px;text-align:center; background-color: red; color:white; font-size:9px;font-family:arial;font-weight:bold;border-radius:0;' value='"+(j+1)+"'>";
				}
			}
			m += "</td>";


if (ok==1)
	 m += "<td><input type=text size=3 id='BOCraft_nb_"+h+"' value='"+ parseIntNan(TrainOptions.CraftingNb[h]) +"'></td>";
	else
	  m += "<td><input type=text style=' background-color::red' size=3 id='BOCraft_nb_"+h+"' value='"+ parseIntNan(TrainOptions.CraftingNb[h]) +"'></td>";
         if ((count+1)%2 == 0) m += "</tr><tr>";
         count++;
 	}
}
m+="<tr><td colspan=8><input type=checkbox id=BOCraftUseSpeedup "+ (Options.CraftUseSpeedups?'CHECKED':'') +"> Utiliser les sabliers : <input type=checkbox id=BOCraftSpeedup1 "+ (Options.speed1?'CHECKED':'') +"><img src='"+gameurl+"img/items/70/1.jpg' width=25>&nbsp;<input type=checkbox id=BOCraftSpeedup2 "+ (Options.speed2?'CHECKED':'') +"><img src='"+gameurl+"img/items/70/2.jpg' width=25></tr>";
  m+="</table></div>";
  t.myDiv.innerHTML = m;
  ById("BOCraftRunning").addEventListener ('click', function (){t.toggleStateRunning(this)}, false);
  ById("BOCraftUseSpeedup").addEventListener ('click', function (){ Options.CraftUseSpeedups=ById("BOCraftUseSpeedup").checked;saveOptions(); if (Options.CraftUseSpeedups) t.UseSpeedup(); }, false);
  ById("BOCraftSpeedup1").addEventListener ('click', function (){ Options.speed1=ById("BOCraftSpeedup1").checked;saveOptions(); }, false);
  ById("BOCraftSpeedup2").addEventListener ('click', function (){ Options.speed2=ById("BOCraftSpeedup2").checked;saveOptions(); }, false);
  ById("BOCraftThroneCheck").addEventListener ('click', function(e){ TrainOptions.throneCheck = e.target.checked;t.saveCraftState();}, false);
  ById("BOCraftThroneSet").value = TrainOptions.throneSet;
  ById("BOCraftThroneSet").addEventListener ('change',function(e){TrainOptions.throneSet = this.value;t.saveCraftState();}, false);
  for(var h in t.craftinfo) {
   		for(j=0; j<Cities.numCities; j++) {
			 if (ById("KsCraft_nbc_"+j+"_"+h))
   				ById("KsCraft_nbc_"+j+"_"+h).addEventListener ('click', function (){
   					var item = ById(this.id);
   					var info = this.id.split("_");
   					var h = info[3];
   					var j = info[2];
   					if (!TrainOptions.CraftingNbC[h][j]) TrainOptions.CraftingNbC[h][j] = "y";
   					if (TrainOptions.CraftingNbC[h][j] == "y") {
   						TrainOptions.CraftingNbC[h][j] = "n";
   						item.style.backgroundColor = "red";
   					} else {
   						TrainOptions.CraftingNbC[h][j] = "y";
   						item.style.backgroundColor = "green";
   					}
   					t.saveCraftState();
   				}, false);
   			}
		}
  function addListener (but, i){  but.addEventListener('click', function() {t.butToggleCraftMode(i);});      }
  for (var cityId in Cities.byID){
          	  var but = ById('BOcraftbut_'+ cityId);
          	  addListener (but, cityId);
           	  t.displayCraftMode(cityId);
  }
  if (window.attachEvent)
      window.attachEvent('onunload', t.onUnload);
  else if (window.addEventListener)
      window.addEventListener('unload', t.onUnload, false);

  },
  butToggleCraftMode : function (cityId){
        var t = Tabs.AutoCraft;
        var mode = 0;
        if (Options.CraftCity[cityId]==0)
          mode = 1;
        Options.CraftCity[cityId]=mode;
        saveOptions();
        t.displayCraftMode(cityId);
   },
   displayCraftMode : function (cityId){
        var t = Tabs.AutoCraft;
        var but = ById('BOcraftbut_'+ cityId);
        if (!Options.CraftCity[cityId]){
          but.className = 'BODefButOff';
          but.value = 'ON';
        } else {
          but.className = 'BODefButOn';
          but.value = 'OFF';
        }
  },
  updateStat: function() {
   var t = Tabs.AutoCraft;
   var rownum = 0;
   function _row (name, row, noTotal, typee){
         if (rownum++ % 2)
           style = '';
         else
           style = ' style = "background: #e8e8e8"';
         var tot = 0;
         var m = [];
         m.push ('<TR style="background: #fff" align=right');
         m.push (style);
         m.push ('><TD');
         m.push (style);
         m.push ('><B>');
         m.push (name);
         m.push ('</td>');
         if (noTotal){
           m.push ('<TD');
           m.push (style);
           m.push ('>&nbsp;</td>');
         } else {
           for (i=0; i<row.length; i++)
             tot += row[i];
           m.push ('<TD style="background: #ffc">');
            if (tot<0) {
             m.push ("<SPAN class=boldRed>"+addCommas(tot)+"</span>");
            } else {
             m.push (addCommas(tot));
            }
           m.push ('</td>');
         }
         for (i=0; i<row.length; i++){
           m.push ('<TD');
           m.push (style);
           m.push ('>');
           if (row[i]<5000) {
	                m.push ("<SPAN class=boldRed>"+addCommas(row[i])+"</span>");
	   } else {
	                m.push (addCommas(row[i]));
           }
           m.push ('</td>');
         }

         m.push ('</tr>');
         return m.join('');
       }

   clearTimeout(t.timerStat);
   var str="<TABLE class=pbTab cellpadding=0 cellspacing=0><TR  align=center><TD width=55 align=center></td><TD width=88 style='background: #ffc; font-size:150%' align=center><SPAN class=oohfancy>"+lang.autoCraft.tot+"</SPAN></td>";
   for(i=0; i<Cities.numCities; i++) {
            cityID = 'city'+ Cities.cities[i].id;

            str += "<TD width=81><SPAN class=oohfancy>"+ Cities.cities[i].name.substring(0,10) +"</SPAN></td>";

   }
   rows = [];
   var now = unixTime();
   rows[0] = [];
   for(i=0; i<Cities.numCities; i++) {
          cityID = 'city'+ Cities.cities[i].id;
          rows[0][i] = parseInt(Seed.citystats[cityID].gold[0]);
        }
        for (r=1; r<6; r++){
          rows[r] = [];
          for(i=0; i<Cities.numCities; i++) {
            cityID = 'city'+ Cities.cities[i].id;
            if (r==5)
             rows[r][i] = parseInt(Seed.resources[cityID]['rec'+r][0]);
            else
             rows[r][i] = parseInt(Seed.resources[cityID]['rec'+r][0] / 3600);

          }

      }
      str += _row ('<img height=18 src='+gameurl+'img/aetherstone_30.png>', rows[5], false, 0);
      str +='<tr style="background: #e8e8e8" align=right><td><img height=20 src='+gameurl+'img/items/70/3.jpg title="Crafting"></b></td><td>&nbsp;</td>';
                for(i=0; i<Cities.numCities; i++) {
                 var totTime = 0;
                 if (Seed.queue_craft["city" + Cities.cities[i].id].length > 0) {
                  var q=Seed.queue_craft["city" + Cities.cities[i].id][0];
                  var totTime = 0;
                  totTime = q.craftingEtaUnixTime - now;
                  if (totTime < 0)
                    totTime = 0;
                  if (getCityBuilding(Cities.cities[i].id,20).count>0 && totTime == 0)
                    affuichage = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';
                  else
                    affuichage = timestr(totTime);

                  str +="<td><span onclick='BOCrafting("+Cities.cities[i].id+");'>"+ affuichage + "</span></td>";

                 } else {
                 affuichage = timestr(totTime);
                 if (getCityBuilding(Cities.cities[i].id,20).count>0)
                    affuichage = '<SPAN class=boldRed><B>'+ timestr(totTime) +'</b></span>';

                 str +="<td><span onclick='BOCrafting("+Cities.cities[i].id+");'>"+affuichage+"</span></td>";
                 }
                }

         		str +="</tr>";

		str +='<tr style="background: #e8e8e8" align=right><td>&nbsp;</td><td>&nbsp;</td>';
		for(i=0; i<Cities.numCities; i++) {
			if (Seed.queue_craft["city" + Cities.cities[i].id].length > 0) {
				var q=Seed.queue_craft["city" + Cities.cities[i].id][0];
				uW.jQuery.each(uW.recipelist, function (c, i) {
				                uW.jQuery.each(i, function (m, j) {
                    if (Number(j.recipe_id) == Number(q.recipeId)) {
						h = j.output_item_id;
					}
				});
			});
				var totTime = 0;
				totTime = q.craftingEtaUnixTime - now;
				if (totTime < 0) totTime = 0;
				if (totTime == 0) {
					str +="<td>&nbsp;</td>";
				} else {
					str +="<td align=right><img title='"+uW.itemlist["i"+h].name+"' width='20' src='"+gameurl+"img/items/70/"+ h + ".jpg'></td>";
				}
			} else {
				str +="<td>&nbsp;</td>";
			}
		 }
         str +="</tr></table>";
         ById("BOCraftStat").innerHTML=str;
         t.timerStat = setTimeout(function() { t.updateStat(); }, 3000);
  },
  updateCraftnb : function() {
   var t = Tabs.AutoCraft;
   for(var h in t.craftinfo) {
     if (t.craftinfo[h]) {
      if (ById("BOCraft_nb_" +h)) ById("BOCraft_nb_"+h).value=parseIntNan(TrainOptions.CraftingNb[h]) ;
   	 }
   }
  },
  SpeedCity: 0,
  UseSpeedup: function() {
  		var t = Tabs.AutoCraft;
  		clearTimeout(t.timer1);
  		try {
  		var now = unixTime();
  		if (t.crafting.running  == false) {
  			return;
  		}
  		if (Options.CraftUseSpeedups == false) {
					return;
		}
  		if (t.SpeedCity >= Cities.cities.length) t.SpeedCity = 0;
  		var cityId = Cities.cities[t.SpeedCity].id;
  		t.SpeedCity++;
  		var time = 0;
  		var cid = 0;
  		var qcon = Seed.queue_craft["city" + cityId];
  		if (matTypeof(qcon)=='array' && qcon.length > 0) {
  			if (parseIntNan(qcon[0].craftingEtaUnixTime) > now + 15) {
  				time = 	parseIntNan(qcon[0].craftingEtaUnixTime) - now;
  				cid = qcon[0].craftingId;
  			}	else {
				// t.timer=setTimeout(t.Start,200);
  				t.timer1=setTimeout(t.UseSpeedup, 500);
  				return;
  			}
  		} else {
			//t.timer=setTimeout(t.Start,200);
  			t.timer1=setTimeout(t.UseSpeedup, 500);
  			return;
  		}

  		var item = 0;
  		if (time >= 280800 && parseInt(Seed.items.i10) > 0 && Options.speed10) item = 10; //4 jours
  		else if (time >= 151200 && time < 280800 && parseInt(Seed.items.i8) > 0 && Options.speed8) item = 8; //2,5 jours
  		else if (time >= 70200 && time < 151200 && parseInt(Seed.items.i7) > 0 && Options.speed7) item = 7; //24 heure
  		else if (time >= 41400 && time < 70200 && parseInt(Seed.items.i6) > 0 && Options.speed6) item = 6; //15 heure
  		else if (time >= 18900 && time < 41400 && parseInt(Seed.items.i5) > 0 && Options.speed5) item = 5; //8 heure
  		else if (time >= 6300 && time < 18900 && parseInt(Seed.items.i4) > 0 && Options.speed4) item = 4; //2,5 heure
  		else if (time >= 3600 && time < 6300 && parseInt(Seed.items.i3) > 0 && Options.speed3) item = 3; //1 heure
  		else if (time >= 500 && time < 3600 && parseInt(Seed.items.i2) > 0 && Options.speed2) item = 2; //15 Minute
  		else if (time < 500 && time > 25 && parseInt(Seed.items.i1) > 0 && Options.speed1) item = 1; //1 Minute
  		if (item == 0) {
			//actionLog("AutoCraft","pas d item");
  			t.timer1=setTimeout(t.UseSpeedup, 10000);
  			return;
  		}
  		var params = uW.Object.clone(uW.g_ajaxparams);
  		params.ctrl = 'Crafting';
  		params.action = 'speedup';
  		params.cityId = cityId;
  		params.itemId = item;
  		params.craftingId = cid;

  		new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  			method: "post",
  			parameters: params,
  			onSuccess: function (transport) {
  				var rslt=eval("("+transport.responseText+")");
  				if (rslt.updateSeed) { try {uW.update_seed(rslt.updateSeed);} catch (e) {} }
   					Seed.items["i" + item] = parseInt(Seed.items["i" + item]) - 1;
  					uW.ksoItems[item].subtract();
  					var qloc = 0;
  					for (var i = 0; i < Seed.queue_craft["city" + cityId].length; i++) {
  						if (parseInt(Seed.queue_craft["city" + cityId][i].craftingId) == parseInt(cid)) {
  							qloc = i;
  							break;
  						}
  					}
  					var timered = 0;
  					var timeredarr = [60, 900, 3600, 9000, 28800, 54000, 86400, 216000, 0, 345600];
  					var utstart = parseInt(Seed.queue_craft["city" + cityId][qloc].craftingUnixTime);
  					var uteta = parseInt(Seed.queue_craft["city" + cityId][qloc].craftingEtaUnixTime);
  					timered = timeredarr[parseInt(item) - 1];
  					Seed.queue_craft["city" + cityId][qloc].craftingUnixTime = utstart - timered;
  					Seed.queue_craft["city" + cityId][qloc].craftingEtaUnixTime = uteta - timered;
  					if (cityId == uW.currentcityid) uW.update_queue();
  					actionLog("AutoCraft",Cities.byID[cityId].name + " - Utilisation speedup "+uW.itemlist['i'+item].name +" " );

  			},
  		});

  		} catch (ex) {
  			alert(ex.name +': '+ ex.message + " @"+ ex.lineNumber);
  		}
  		t.timer1=setTimeout(t.UseSpeedup, 5000);
	},
  saveCraftState : function() {
   var t = Tabs.AutoCraft;
   TrainOptions.CraftingRunning =  t.crafting.running;
   TrainOptions.CraftingNb = {};
   for(var h in t.craftinfo) {
	  if (t.craftinfo[h]) {
       if (ById("BOCraft_nb_" +h)) TrainOptions.CraftingNb[h] = parseIntNan(ById("BOCraft_nb_"+h).value);
      }
   }
   saveTrainingOptions();
  },
  toggleStateRunning: function(obj){
  	var t = Tabs.AutoCraft;
  	obj = ById('BOCraftRunning');
    if (t.crafting.running == true) {
              t.crafting.running = false;
              t.saveCraftState();
              if (obj) obj.value = "AutoCraft = OFF";
              clearTimeout(t.timer);
  	      if (Options.BORac_Cra) updatebotbutton('Craft - OFF', 'bocrafttab');
          }
          else {
              t.crafting.running = true;
              t.saveCraftState();
              if (obj) obj.value = "AutoCraft = ON";
              clearTimeout(t.timer);
              t.Start();
  	          if (Options.BORac_Cra) updatebotbutton('Craft - ON', 'bocrafttab');
  	          t.timer1=setTimeout(t.UseSpeedup, 9000);
          }
          t.updateCraftnb();
    },
    Start: function() {
     var t = Tabs.AutoCraft;
     if(!TrainOptions.CraftingRunning) {
      clearTimeout(t.timer);
      return;
     }
     var waiting=-1;
     t.saveCraftState();
     for(var i=0; i<Cities.numCities; i++) {
	  var cityId=Cities.cities[i].id;
	  var ret=getCityBuilding(cityId,20).count;
	  var level=getCityBuilding(cityId,20).maxLevel;
	  var tableau = [];
	  for(var d in TrainOptions.CraftingNb) {
	   if (parseIntNan(TrainOptions.CraftingNb[d])>0 && TrainOptions.CraftingNbC[d][i] == "y" && (!TrainOptions.throneCheck || (TrainOptions.throneCheck && Seed.throne.activeSlot==TrainOptions.throneSet))) {
	     if (parseIntNan(Seed.resources["city" + cityId]['rec5'][0])>=parseIntNan(t.craftinfo[d].input.resources[1]) && parseIntNan(t.craftinfo[d].requirements.building)<=level) {
		if(t.craftinfo[d].input.items == ""){
		 tableau.push (d);
		}else {
		 for(var zzz in t.craftinfo[d].input.items) {
		  if (parseIntNan(uW.ksoItems[zzz].count) >= parseIntNan(t.craftinfo[d].input.items[zzz])) {
		   tableau.push (d);
	      }
	     }
        }}
       }
      }
	  if (tableau.length!=0) {
      if (ret>0) {
	   if (!Options.CraftCity[cityId]) {
		var z=Seed.queue_craft["city" + cityId];
		 while (z.length >1)
		 {
		         z.splice(0,1);
      	 }
		if (z.length > 0) {
		 var totTime = 0,q=z[z.length-1], now = unixTime();
	     totTime = q.craftingEtaUnixTime - now;
	     if (totTime > -1) {
	       if (waiting > totTime || waiting==-1) {
	       waiting = totTime;
	       t.numcity=i;
	       }
	     } else {
			waiting=0;
	        t.numcity=i;
	        z.splice(0,1);
	       break
	     }
	    } else {
	      waiting=0;
	      t.numcity=i;
	      break;
	    }
       }
      }
      }
	 }
	 clearTimeout(t.timer);

	 if (waiting==-1) {
	  t.tentative++;
	  actionLog("autoCraft","-1 secondes - Ville numero " + (t.numcity+1) +" - tentatives : "+t.tentative);
	  if (t.tentative>5) {
		  actionLog("autoCraft","<font color=red><b>Coupure de l'autoCRAFT ! </b></font>");
       t.crafting.running = false;
	   obj = ById('BOCraftRunning');
	   if (obj) obj.value = "AutoCraft = OFF";
	   if (Options.BORac_Cra) setTimeout(function(){updatebotbutton("Craft - OFF", 'bocrafttab');},200);
	   t.saveCraftState();
       return;
      }else{
		    t.timer=setTimeout(t.Start, 5000);
	  }
	 return;
     }
     var itemId = tableau[Math.floor(Math.random()*tableau.length)];
     t.saveCraftState();
     t.tentative=0;
	if (waiting==0) {
	 var c=t.numcity;
     var recipeId = t.craftinfo[itemId].recipe_id;
     var category = t.craftinfo[itemId].category;
     t.CraftingItem(cityId, itemId, recipeId, category);
    }else {
	   //t.timer=setTimeout(t.Start, (waiting+1)*1000);
	   t.timer=setTimeout(t.Start, 5000);
	}
 },
 tentative:0,
 CraftingItem: function (currentcity, itemId, recipeId,category) {
      var t = Tabs.AutoCraft;
      var params = uW.Object.clone(uW.g_ajaxparams);
          params.action="craft";
          params.ctrl="Crafting";
          params.cityId=currentcity;
          params.insurance=false;
     	  params.itemId=itemId;
     	  params.recipeId=recipeId;
     	  params.categoryId=category;
      new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, { method: "post", parameters: params,loading: true,
          onSuccess: function (transport) {
              var o=eval("("+transport.responseText+")");
              if(o.ok===true){
               var idRecipe=0;
               var k=uW.kocRecipes[category];
               for (oo in k) {
                if (k[oo].output==itemId) {
                 idRecipe=oo;
                 break;
                }
               }
               if (o.status=="error") {
 		        t.timer=setTimeout(t.Start,5000);
               } else if(o.status=="failure"){
				 Seed.resources["city" + currentcity]['rec5'][0] = parseIntNan(Seed.resources["city" + currentcity]['rec5'][0]) - parseIntNan(k[idRecipe].input.resources[1]);
                 jQuery.each(k[idRecipe].input.items, function (s, r) {
			            uW.ksoItems[s].subtract(r);
			            if (ById("BOCraft_stock_"+s)) ById("BOCraft_stock_"+s).innerHTML=parseIntNan(uW.ksoItems[s].count);
		         });
                 if (k[idRecipe].consolation) {
                  uW.ksoItems[k[idRecipe].consolation].add();
                  if (ById("BOCraft_stock_"+k[idRecipe].consolation)) ById("BOCraft_stock_"+k[idRecipe].consolation).innerHTML=parseIntNan(uW.ksoItems[k[idRecipe].consolation].count);
                 }
       	         t.timer=setTimeout(t.Start,5000);
     	       } else if (o.status=="success"){
				  Seed.resources["city" + currentcity]['rec5'][0] = parseIntNan(Seed.resources["city" + currentcity]['rec5'][0]) - parseIntNan(k[idRecipe].input.resources[1]);
     	          jQuery.each(k[idRecipe].input.items, function (s, r) {
	       	            uW.ksoItems[s].subtract(r);
		       	            if (ById("BOCraft_stock_"+s)) ById("BOCraft_stock_"+s).innerHTML=parseIntNan(uW.ksoItems[s].count);

	           	 });
    		     Seed.queue_craft["city"+currentcity]=[];
         	     var n={};
         	n.recipeId=recipeId;
         	n.craftingUnixTime=o.time.startTime;
         	n.craftingEtaUnixTime=o.time.endTime;
         	n.craftingId=o.craftingId;
         	n.categoryId=category;
         	n.recipeIndex=null;
         	uW.seed.queue_craft["city"+currentcity].push(n);
         	TrainOptions.CraftingNb[itemId] =  TrainOptions.CraftingNb[itemId]-1;
		    saveTrainingOptions();
     	    t.updateCraftnb();
         	t.timer=setTimeout(function() { t.Start(); },1000);
               }
              } else {
               t.timer=setTimeout(t.Start,1000);
              }
            },
            onFailure: function () {  t.timer=setTimeout(t.Start,1000);  }
       });
 },
    show : function (){
        var t = Tabs.AutoCraft;
        clearTimeout(t.timerStat);
        t.updateStat();
    },
    hide: function(){
          var t = Tabs.AutoCraft;
          clearTimeout(t.timerStat);
      },
      onUnload: function(){
          var t = Tabs.AutoCraft;
      t.saveCraftState();
    },
};


/*********************************** Options  ***********************************/
Tabs.Options = {
  tabOrder: 30,
  tabLabel: 'Options',
  cont : null,
  state : null,
  fixAvailable : {},
  towerMarches: [],
  soundRepeatTimer : null,
  soundStopTimer : null,
  secondTimer : null,incomming:false,
  soundPlaying : false,
  changeonce:false,
  show : function (){
    var t = Tabs.Options;
  },
  eachSecond : function (){
  var t = Tabs.Options;
  Options.alertConfig.raidautoswitch = {};
  if (Options.alertConfig.lastAttack===undefined) Options.alertConfig.lastAttack=0;
  for (var cityId in Cities.byID){
	  if (Cities.byID[cityID])
       Options.alertConfig.raidautoswitch[cityId] = false;
  }
  var now = unixTime();
  t.incomming = false;
  if (matTypeof(Seed.queue_atkinc) != 'array'){

  for (var k in Seed.queue_atkinc){ // check each incoming march

  var m = Seed.queue_atkinc[k];
  if ((m.marchType==3 || m.marchType==4) && parseIntNan(m.arrivalTime)>now){
    t.incomming = true;
   if (m.departureTime > Options.alertConfig.lastAttack){
    Options.alertConfig.RecentActivity=true;
    setTimeout(function(){Options.alertConfig.lastAttack = m.departureTime;saveOptions()},500);
    t.newIncoming (m);
    if (DashboardOptions.showDashboardAttack && !ById('Dash_div')) {
		DashboardOptions.showDashboard = true;
		Dashboard.init();
		if (Options.BORac_DashBoard)updatebotbutton("Dashboard - ON", 'bodashboardrac');
		Dashboard.ShowTroops();
	}
   }

   if (Options.alertConfig.raid){
    Options.alertConfig.raidautoswitch[m.toCityId] = true;
   }
   /*if (Options.alertConfig.HDefpreset) {
   	Tabs.Overview.butToggleGuardian(m.toCityId,"wood",null);
   }*/
  }
  }
  }

  if (t.incomming && Options.alertSound.enabled){
     if (ById('botowertab'))
		ById('botowertab').style.display="block";

  }

  if (Options.alertSound.alarmActive && (!t.incomming || now > Options.alertSound.expireTime)){
	   t.incomming=false;
  if (ById('botowertab'))
     ById('botowertab').style.display="none";
     t.stopSoundAlerts();

  }
  t.towerMarches = [];
  if (Options.alertConfig.Atkpreset && Options.Atkpreset && Options.Atkpreset!=Seed.throne.activeSlot && t.incomming && !t.changeonce) {
  			Options.AtkRtpreset = Seed.throne.activeSlot;
  			t.changeonce=true;
  			t.changePreset(Options.Atkpreset);
  			saveOptions();
  }
  if (Options.alertConfig.RecentActivity && Options.alertConfig.AtkReturnpreset && Options.alertConfig.Atkpreset && !t.incomming) {
	  var switchtime = parseIntNan(Options.alertConfig.lastAttack)+300;
  	  if (switchtime < now) {
	  	t.changePreset(Options.AtkRtpreset);
	  	Options.alertConfig.RecentActivity = false;
	  	t.changeonce=false;
	  	saveOptions();
	  }
   }

},
changePreset:function(preset) {
  var t = Tabs.Options;
  var params = uW.Object.clone(uW.g_ajaxparams);
	params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
	params.action = 'setPreset';
	params.presetId = preset;
	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {method: "post",parameters: params,loading: true,
	onSuccess: function (transport) {
	var rslt = eval("(" + transport.responseText + ")");
	if(rslt.ok){
	 button = '<li id="throneInventoryPreset' + preset + '" class="active">'+preset+'</li>';
	 uW.cm.ThroneView.clickActivePreset(button);
	 setPresetWidget(preset);
	}
	}
	});
},
  e_soundFinished : function (chan){
    var t = Tabs.Options;
    if (!Options.alertSound.alarmActive){
      ById('boSoundStop').disabled = true;
    }
  },
  e_soundFileLoaded : function (){
	    var t = Tabs.Options;
        if (t.mss.err)
          ById('boLoadStat').innerHTML = 'Error !';
        else
          ById('boLoadStat').innerHTML = 'Load';
   },
   playSound : function (doRepeats){
         var t = Tabs.Options;
         ById('boSoundStop').disabled = false;
         clearTimeout (t.soundStopTimer);
         clearTimeout (t.soundRepeatTimer);
         t.mss.play();
         t.soundStopTimer = setTimeout (function(){t.mss.stop(); t.e_soundFinished()}, Options.alertSound.playLength*1000);
         if (doRepeats && Options.alertSound.repeat)
           t.soundRepeatTimer = setTimeout (function (){t.playSound(true)}, Options.alertSound.repeatDelay*60000);
         else
           Options.alertSound.alarmActive = false;
    },
  stopSoundAlerts : function (){
    var t = Tabs.Options;
	t.mss.stop (1);
    clearTimeout (t.soundStopTimer);
    clearTimeout (t.soundRepeatTimer);
    ById('boSoundStop').disabled = true;
    Options.alertSound.alarmActive = false;
    Options.alertSound.expireTime = 0;
    if (ById('botowertab'))
           ById('botowertab').style.display="none";
  },
  soundTheAlert : function (){
      var t = Tabs.Options;
      Options.alertSound.alarmActive = true;
      t.playSound(true);
  },
 newIncoming : function (m){
	var t = Tabs.Options;
	var totTroops = 0;
	for (k in m.unts)totTroops += m.unts[k];
	if (parseIntNan(Options.alertConfig.hq)>0) {
	  		 if (parseInt(m.toCityId)==parseInt(Options.alertConfig.hq)) {
	  		  if (parseInt(totTroops) < Options.alertConfig.minTroops) return;
	  		 }
	  		 if (parseInt(m.toCityId)!=parseInt(Options.alertConfig.hq)) {
	  		 if (parseInt(totTroops) < Options.alertConfig.minTroops2) return;
	  		 }
	  } else {
	  		 if (parseInt(totTroops) < Options.alertConfig.minTroops)
	  			return;
	  }
	t.postToChat (m, false, 0);
},

sendalert : function (m){
	var t = Tabs.Options;
	var now = unixTime();

	if (Options.alertSound.enabled && Options.UIDEx!=m.pid){
 		t.soundTheAlert();
	    if (m.arrivalTime > Options.alertSound.expireTime)
 		 Options.alertSound.expireTime = m.arrivalTime;


	}
	if (Options.alertConfig.raid){
		Tabs.Raid.StopCityRaids(m.toCityId);
		Options.alertConfig.raidautoswitch[m.toCityId] = true;
	}

	if (Options.alertConfig.autofo && Options.AttackRunning){
		     Options.AttackRunning = false;
	         if (Options.BORac_Dar) updatebotbutton(lang.autofo.button+' - OFF', 'pbautofstab');
		     saveOptions();
	}
	if (Options.alertConfig.autots && Options.crestRunning){
		  	     Options.crestRunning = false;
		  	     if (Options.BORac_Ts) updatebotbutton(lang.crest.button+' - OFF', 'pbautotstab');

		  	     saveOptions();
	}
	if (Options.alertConfig.autoform && TrainOptions.Running){
		  		  	     TrainOptions.Running = false;
		  		         clearTimeout(Tabs.autoFormation.timer);
		  		         if (Options.BORac_Tra) updatebotbutton(lang.autoForm.buttonlabel+' - OFF', 'pbformtab');
		  		  	     saveTrainingOptions();
	}
	if (Options.alertConfig.appro && Tabs.TranspAuto.reapproState.running){
		    Tabs.TranspAuto.reapproState.running = false;
		    if (Options.BORac_App) updatebotbutton(lang.transport.labAppro+' - OFF', 'boreapprotab');
	}
},
postToChat: function(z, force,cityid){
   var t = Tabs.Options;
   if (cityid!=0) {
	 var m = Seed.queue_atkinc["m"+z];
   }else {
     var m = z;
   }

   var postOptions = Options.alertConfig;
   var k=Seed.throne.slotEquip[Seed.throne.activeSlot],i=Seed.throne.inventory,e,faction;
   var B=0, w={}, x, C;
   for (var K in k) {
     var F = uW.kocThroneItems[k[K]];
     if (F) {
               x=0;
               for (var M in F.effects) {
               x++;
               if (F.quality >= x) {
                B++;
                I = uW.cm.thronestats.effects[F.effects[M].id];
                z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier];
                C = + z.base + (F.level * F.level + F.level) * + z.growth * 0.5;
                C = Math.ceil(C);
                if (!F.isBroken) {
                   if (!w[F.effects[M].id]) {
                     w[F.effects[M].id] = {};
                     w[F.effects[M].id].nameitem="";
                   }
                   if (!w[F.effects[M].id].percent) {
                     w[F.effects[M].id].percent = C;
                   } else {
                    w[F.effects[M].id].percent += C;
                   }
                   w[F.effects[M].id].name = I[1];
                   w[F.effects[M].id].nameitem += "(" + ThroneItemName(F) + ")<br>";
                }
               }
               }
               }
           }
   var tot = [];
   for (i = 0; i < 13; i++)
	tot[i] = 0;

   if (m.marchType == null)
		return;

	if (m.marchType == 3) {
		if (!Options.alertConfig.scouting && !force) return;
		atkType = lang.TowerAlerts.atkType;
	} else {
		if (m.marchType == 4) {
				atkType = lang.TowerAlerts.atkType1;
		} else {
				return;
		}
	}
	var target, atkType, who;
	var city = Cities.byID[m.toCityId];
	if (city.tileId == m.toTileId) {
			target = lang.TowerAlerts.targetcity+' ' + city.name + ' # ' + city.x + ',' + city.y+' #';
				if (postOptions.marechal) {
						var now = unixTime();
						marshallCombatScore = 0;
						var s = Seed.knights['city'+m.toCityId];
						if (s) {
							s = s["knt" + Seed.leaders['city'+m.toCityId].combatKnightId];
							if (s){
								marshallCombatScore = s.combat;
							}
				                 }
				           target += ' ('+lang.TowerAlerts.marshallCombat+' ' + parseInt(marshallCombatScore) + ') ';
	                }
	        }else {
			if (!Options.alertConfig.wilds && !force)
				return;
			target = lang.TowerAlerts.target1;
			for (k in Seed.wilderness['city' + m.toCityId]) {
				if (Seed.wilderness['city' + m.toCityId][k].tileId == m.toTileId) {
					target += ' ' + Seed.wilderness['city' + m.toCityId][k].xCoord + ',' + Seed.wilderness['city' + m.toCityId][k].yCoord+' ';
					break;
				}
			}
		}

		if (Options.alertConfig.defBoost) {
		 var c=uW.unixtime();
		 var boost="";
		 if (parseInt(Seed.playerEffects.defExpire)>c)
		 {
		  var f=parseInt(Seed.playerEffects.defExpire)-c;
		  boost = "def 20%";
		 }
		 if (parseInt(Seed.playerEffects.def2Expire)>c) {
		  var f=parseInt(Seed.playerEffects.defExpire)-c;
		  boost = "def 50%";
		 }
		 target += boost;
		}
		if (Options.alertConfig.TroneRange || Options.alertConfig.TroneRangeDebuff || Options.alertConfig.TroneCombatSpeed || Options.alertConfig.TroneLife || Options.alertConfig.TroneLoadDebuff) {
		 target += ". "+lang.TowerAlerts.throne+" ";
		 if (postOptions.TroneRange) {
		  if (w[5])
		    target+= w[5].percent + " % range ";
		  else
		    target+= "0 % range ";
		 }
		 if (Options.alertConfig.TroneRangeDebuff) {
		 		  if (w[21])
		 		    target+= w[21].percent + " % range debuff ";
		 		  else
		 		    target+= "0 % range debuff ";
		 }
		  if (Options.alertConfig.TroneCombatSpeed) {
		 		  if (w[4])
		 		    target+= w[4].percent + " % speed ";
		 		  else
		 		    target+= "0 % speed ";
		 }
		  if (Options.alertConfig.TroneLife) {
		 		  if (w[3])
		 		    target+= w[3].percent + " % life ";
		 		  else
		 		    target+= "0 % life ";
		 }
		 if (Options.alertConfig.TroneLoadDebuff) {
			 if (w[22])
			 		 		    target+= w[22].percent + " % load debuff";
			 		 		  else
		 		    target+= "0 % load debuff ";
		 }

		}
		var attackermight = '';
		var allianceId = '';
		if (Seed.players['u' + m.pid]) {
			who = Seed.players['u' + m.pid].n;
			attackermight = parseInt(Seed.players['u' + m.pid].m);
            allianceId = Seed.players['u' + m.pid].a;
		} else {
			if (m.players && m.players['u' + m.pid]) {
				who = m.players['u' + m.pid].n;
				attackermight = parseInt(m.players['u' + m.pid].m);
                	         allianceId = m.players['u' + m.pid].a;
			} else {
				who = '??';
			}
		}
		if (m.fromXCoord)
			who += ' '+lang.TowerAlerts.at+' ' + m.fromXCoord + ',' + m.fromYCoord + ' ';
		if (m.knt) {
		  if (m.knt['cbt']!=undefined && m.knt['cbt']!=null) who += ' '+uW.g_js_strings.commonstr.knight+' ' + m.knt['cbt'];
		}
		var diplomacy = getDiplomacy(allianceId);
		var arrivingDatetime = new Date();
		arrivingDatetime.setTime(m.arrivalTime * 1000);
		var msg = '';
		var subject = '';

		msg = lang.TowerAlerts.Type+' ' + atkType + '. ';
		if (!postOptions.MonQG && parseIntNan(postOptions.hq)>0) {
		 var mavilleId=Cities.byID[postOptions.hq];
		 if (mavilleId)
		   msg += ' '+lang.TowerAlerts.hq+': ' + mavilleId.x + ','+mavilleId.y+' ';

		}
		if (postOptions.empennage) {
		 msg += lang.TowerAlerts.emp+' ' + parseInt(Seed.tech['tch13']) + '. ';
		}

		msg += lang.TowerAlerts.target+' ' + target + '. ';
		msg += uW.g_js_strings.commonstr.attacker + ' : ' + who + ' (' + addCommas(attackermight).replace(',',' ').replace(',',' ') + ', ' + diplomacy + ').';
		msg +=' ** '+lang.TowerAlerts.arrival+' ** : ';
		var totTroops = 0;
		var fchar = ""; //Filter[Options.fchar];
		for (k in m.unts) {
			var uid = parseInt(k.substr(1));
			var UNTCOUNT = parseIntNan(m.unts[k]);
			msg += UNTCOUNT +' '+ uW.unitcost['unt'+uid][0] +', ';
			totTroops += UNTCOUNT;
		}
		if (parseIntNan(postOptions.hq)>0) {
		 if (parseInt(m.toCityId)==parseInt(postOptions.hq)) {
		  if ((totTroops < postOptions.minTroops)) return;
		 }
		 if (parseInt(m.toCityId)!=parseInt(postOptions.hq)) {
		 if ((totTroops < postOptions.minTroops2)) return;
		 }
		} else {
		 if ((totTroops < postOptions.minTroops) && !force)
			return;
		}
		msg = msg.slice(0, -2);

		msg += ' ('+lang.TowerAlerts.arrival2+' ' + uW.timestr(parseInt(m.arrivalTime - unixTime())) + ' '+lang.TowerAlerts.arrival3+' ' + arrivingDatetime.toLocaleTimeString() +').' ;
		var msgpart1='';
		if (parseInt(Seed.citystats["city" + m.toCityId].gate) == 0 && Options.alertConfig.defence==true)
	        {
		   msg += ' ** '+lang.TowerAlerts.sanctuary+' ** ';
		}
		if (parseInt(Seed.citystats["city" + m.toCityId].gate) == 1 && Options.alertConfig.defence==true)
		{
		  msg += ' ** '+lang.TowerAlerts.defence+' ** ';
        	}
        if(m.marchStatus != 9) {
		if (city.tileId == m.toTileId) {
			var emb = getCityBuilding(m.toCityId, 8);
			if (emb.count <= 0) {
			 msg += ' '+lang.TowerAlerts.noambassy;
			 var msgpart1 = msg;
			 msg ='';
			} else {
				var availSlots = emb.maxLevel;
				for (k in Seed.queue_atkinc) {
					if (Seed.queue_atkinc[k].marchType==2 && Seed.queue_atkinc[k].toCityId==m.toCityId && Cities.byID[Seed.queue_atkinc[k].fromCityId]==null){
						--availSlots;
					}
				}
				msg += ' '+lang.TowerAlerts.myambassy+' (' + availSlots + '/' + emb.maxLevel + ')';
				var msgpart1 = msg;
				msg ='';
				if (postOptions.embassy) {
					var rownum = 0;
					enc = {};
					numSlots = 0;
					if (matTypeof(Seed.queue_atkinc) != 'array') {
						for (k in Seed.queue_atkinc) {
							march = Seed.queue_atkinc[k];
							if (march.marchType == 2) {
								++numSlots;
								city = march.toCityId;
								from = march.fromPlayerId;

								if (!enc[city])
									enc[city] = {};
								if (!enc[city][from])
									enc[city][from] = [];
								s = [];
								s[99] = march.destinationUnixTime;
								s[0] = parseInt(march.knightCombat);
									var i=0;
									for (y in uW.unitcost) {
									i++;
 									s[i] = parseInt(march['unit' + i + 'Count']);
								}
								enc[city][from].push(s);
							}
						}
					}
					dest = m.toCityId;
					var embassyOccupied = false;
					if (enc[dest]) {
						embassyOccupied = true;
						msg += ' ** '+lang.TowerAlerts.ambassy+' **: ';
						for (p in enc[dest]) {
							try {
								if (Seed.players['u' +p]) {
									player = Seed.players['u' + p].n;
								} else {
									if (m.players && m.players['u' + p]) {
										player = m.players['u' + p].n;
									} else {
										player = '???';
									}
								}
							}
							catch (err) {
								player = '???';
							}
							for (j = 0; j < enc[dest][p].length; j++) {
								knight = '';

								if (enc[dest][p][j][0] > 0)
									knight = ' (' + enc[dest][p][j][0] + ')';
								var slot = j + 1;
								arrivedans = uW.timestr(parseInt(enc[dest][p][j][99]-unixTime()));
								if ((enc[dest][p][j][99]-unixTime()) <=0)
								 msg += '[slot' + slot + ': ' + player + knight + '->';
								else
								 msg += '[marching ' +arrivedans+ ': ' + player + knight + '->';
									var i=0;
									for (y in uW.unitcost) {
									i++;
									num = enc[dest][p][j][i];
									if (num > 0)
										msg += '' + addCommas(num).replace(',',' ').replace(',',' ') + ' ' + uW.unitcost['unt'+i][0].substring(0,4) + ', ';
									tot[i] += num;
								}
								msg += ']';
							}//for (j=0; j<enc[dest][p].length; j++)
						}//for (p in enc[dest])
					}//if (enc[dest])

				}// if (postOptions.embassy)
			}//if (emb.count > 0)
	    	}
	    }
		var msgpart2 = msg;
		msg ='';
		if (postOptions.mytroops) {
		msg += ' ** '+lang.TowerAlerts.troops+' ** : ';
		cityID = 'city' + m.toCityId;
		var r=0;
		for (y in uW.unitcost) {
			r++;
			num = parseInt(Seed.units[cityID]['unt' + r]);
			tot[r] += num;
			if (num > 0)
				msg += '' + addCommas(num).replace(',',' ').replace(',',' ') + ' ' + uW.unitcost[y][0].substring(0,4) + ', ';
		}
		msg += '.';
		}
		var msgpart3 = msg;
		msg ='';
		if (embassyOccupied) {
			msg += ' ** '+lang.TowerAlerts.total+' ** : ';
			var r=0;
			for (y in uW.unitcost) {
				r++;
				num = parseInt(tot[r]);
				if (num > 0)
					msg += '' + addCommas(num).replace(',',' ').replace(',',' ') + ' ' + uW.unitcost[y][0].substring(0,4) + ', ';
			}
			msg += '.';
		}
		var msgpart4 = msg;
		msg='';
		if (postOptions.food) {
			var rp = getResourceProduction (m.toCityId);
      		var foodIncome = rp[1];
			var food = parseInt(Seed.resources['city'+ m.toCityId]['rec'+1][0] / 3600);
			var timeLeft = parseInt(Seed.resources["city" + m.toCityId]['rec1'][0]) / 3600 / (0-foodIncome) * 3600;
			var timeLeftShort  = timestrShort(timeLeft);
			msg += ' ** '+lang.TowerAlerts.food+'  **:';
			msg += ' '+addCommas(food).replace(',',' ').replace(',',' ').replace(',',' ') + ' (' +addCommas(foodIncome).replace(',',' ').replace(',',' ').replace(',',' ')+') -> '+lang.TowerAlerts.timerem+' '+timeLeftShort+'. ';
		}
		var msgpart5 =msg;
		msg ='';
		if (Options.alertConfig.defense) {
		 msg += ' ** '+lang.TowerAlerts.defense+' **:';
          	 for (k in uW.fortcost){
			var fortiName = uW.fortcost[k][0].substring(0,6);
			var fortiVal = parseInt(Seed.fortifications['city' + m.toCityId]['fort'+k.substring(3)]);
			msg += fortiVal +' '+fortiName+', ';
   		 }
   		}
		var msgpart6 = msg;
		var msgpart7 = '';
		var msgpart8 = ' '+ postOptions.aPrefix + ' ';;
		msg = msgpart1 + msgpart2 + msgpart3 + msgpart4 + msgpart5 + msgpart6 + msgpart7 + msgpart8;
		new t.sendalert(m);
	    if (!Options.alertConfig.aChat) return;
		if (postOptions.sendasWhisper) 	sendChat("/" + Seed.player.name + ' ' + msg);
		if (postOptions.sendtoAlly) sendChat("/a " + msg);
		if (postOptions.sendEmail) {
			var subject = uW.domainName + '-'+Seed.player.name +' >> ' +target + ' est en train ' + atkType + ' par ' + who + ' dans '+ arrivingDatetime;
			var email = postOptions.emailAddress;
			var error = false;
			if (email=="") error = true;
			if (subject=="") error = true;
			if (msgpart1=="") error = true;
			if (!error) sendEmail(Seed.player.name, "", email, subject, msg.replace("#",""));
	       }

 },

 timeret:null,
  hide : function (){
    var t = Tabs.Options;
  },
  togOpt : function (checkboxId, optionName, callEnable, callIsAvailable){
    var t = Tabs.Options;
    var checkbox = ById(checkboxId);

    if (callIsAvailable && callIsAvailable()==false){
      checkbox.disabled = true;
      return;
    }
    if (Options[optionName])
      checkbox.checked = true;
    checkbox.addEventListener ('change', new eventToggle(checkboxId, optionName, callEnable).handler, false);
    function eventToggle (checkboxId, optionName, callOnChange){
      this.handler = handler;
      var optName = optionName;
      var callback = callOnChange;
      function handler(event){
        Options[optionName] = this.checked;
        saveOptions();
        if (callback != null)
          callback (this.checked);
      }
    }
  },
  saveTabs:function(tab) {


   ById(tab).style.display=(ById(tab).style.display=='none')?'block':'none';
   Options[tab]=ById(tab).style.display;
   saveOptions();

  },
  NewTab: function() {
   var t = Tabs.Options;
   if (ById("ptBoitePerso"))
      ById("ptBoitePerso").parentNode.removeChild(ById("ptBoitePerso"));
   if (ById("ptBoitePerso2"))
      ById("ptBoitePerso2").parentNode.removeChild(ById("ptBoitePerso2"));
   if (ById("ptBoitePerso3"))
	       ById("ptBoitePerso3").parentNode.removeChild(ById("ptBoitePerso3"));

   if (Options.NewButton) {
	 if (Options.NewButtonSelect!='') {
	 if (!Tabs[Options.NewButtonSelect]) return;

     if (Tabs[Options.NewButtonSelect].tabLabel != null)
    	var labelk=Tabs[Options.NewButtonSelect].tabLabel.substring(0,7);
      else
       var labelk=Options.NewButtonSelect;
     var b = createTopButton (labelk);
     b.className='tab';
     b.id = 'ptBoitePerso';
     var tabs=ById('BOAbout');
     tabs.appendChild(b);
     b.addEventListener('click',function() {
      eventHideShow();
      tabManager.e_clickedTab2 ('pbtc'+ Options.NewButtonSelect)
     }, false);
     } else {
     if (ById("ptBoitePerso"))
      ById("ptBoitePerso").parentNode.removeChild(ById("ptBoitePerso"));
     }
     // rac 2
     if (Options.NewButtonSelect2!='') {
	      if (Tabs[Options.NewButtonSelect2].tabLabel != null)
	     	var labelk=Tabs[Options.NewButtonSelect2].tabLabel.substring(0,7);
	      else
	        var labelk=Options.NewButtonSelect2;
	      var b = createTopButton (labelk);
	      b.className='tab';
	      b.id = 'ptBoitePerso2';
	      var tabs=ById('BOAbout');
	      tabs.appendChild(b);
	      b.addEventListener('click',function() {
	       eventHideShow();
	       tabManager.e_clickedTab2 ('pbtc'+ Options.NewButtonSelect2)
	      }, false);
	} else {
	      if (ById("ptBoitePerso2"))
	       ById("ptBoitePerso2").parentNode.removeChild(ById("ptBoitePerso2"));
     }
     //rac 3
     if (Options.NewButtonSelect3!='') {
	      if (Tabs[Options.NewButtonSelect3].tabLabel != null)
	     	var labelk=Tabs[Options.NewButtonSelect3].tabLabel.substring(0,7);
	      else
	        var labelk=Options.NewButtonSelect3;
	      var b = createTopButton (labelk);
	      b.className='tab';
	      b.id = 'ptBoitePerso3';
	      var tabs=ById('BOAbout');
	      tabs.appendChild(b);
	      b.addEventListener('click',function() {
	       eventHideShow();
	       tabManager.e_clickedTab2 ('pbtc'+ Options.NewButtonSelect3)
	      }, false);
	 } else {
	      if (ById("ptBoitePerso3"))
	       ById("ptBoitePerso3").parentNode.removeChild(ById("ptBoitePerso3"));
     }
   }
  },
  namePreset: function() {
	var popPreset = null;
	popPreset = new CPopup('BOpopPreset', 50, 150, 400, 300, true);
 	popPreset.getTopDiv().innerHTML = '<DIV align=center><B>'+lang.Options.namePreset+'</B></DIV>';
	var m="<div class=boStat2>"+lang.Options.namePreset+"</div><DIV style='max-height:230px; height:230px; overflow-y:auto'><table width=100%><tr><td>Num</td><td>"+lang.General.name+"</tr>";
	for (i=1;i<=Seed.throne.slotNum;i++){
				m+="<tr><td><b>" + i + "</td><td><input type=text size=8 maxlength=8 value='"+ThroneOptions.presetname[i]+"' id='BOPresetName_"+i+"'></tr>";
	}
	m+="</table><br><input type=button id=BOsavePr value='"+uW.g_js_strings.commonstr.save+"'></div>";
	popPreset.getMainDiv().innerHTML = m;
	popPreset.show (true);
	ById('BOsavePr').addEventListener ('click', function() {
	 for (var i=1;i<=Seed.throne.slotNum;i++){
	  			  ThroneOptions.presetname[i]=ById("BOPresetName_"+i).value;
	 }
	 saveThroneOptions();
	 popPreset.show (false);
    }, false);
 },
 init : function (div){
    var t = Tabs.Options;
    t.cont = div;

    uW.BOsaveTabs = t.saveTabs;
    if (Options.DeleteTimerMinute===undefined) Options.DeleteTimerMinute=5;
    if (Options.NewTabURL==undefined) Options.NewTabURL=sitesupport;
    if (Options.NewButtonSelect==undefined) Options.NewTabURL='';
    if (parseIntNan(Options.HauteurBoite)<700) Options.HauteurBoite=700;
    setTimeout(function() {
     if (Options.BORac_Reset) {
			AddSubTabLink("Refresh", function(){Options.pbEveryEnable=!Options.pbEveryEnable;saveOptions();RefreshEvery.setEnable(Options.pbEveryEnable);}, 'boautorefresh');
			if (Options.pbEveryEnable)
			  updatebotbutton("Refresh - ON", 'boautorefresh');
			else
			  updatebotbutton("Refresh - OFF", 'boautorefresh');
	    }
   setTimeout(function() {
	if (Options.BORac_DashBoard) {
		AddSubTabLink("Dashboard", function() {
		//alert(DashboardOptions.showDashboard);
			if (DashboardOptions.showDashboard) DashboardOptions.showDashboard=false;
			else DashboardOptions.showDashboard=true

			saveDashboardOptions();

			if (DashboardOptions.showDashboard) {
						Dashboard.init();
						if (DashboardOptions.ShowThrone) Dashboard.ShowTrPresets();
						Dashboard.ShowTroops();
						updatebotbutton("Dashboard - ON", 'bodashboardrac');
			}else {
						if (ById('Dash_div')) ById('Dash_div').parentNode.removeChild(ById('Dash_div'));
						updatebotbutton("Dashboard - OFF", 'bodashboardrac');
			}
		},'bodashboardrac');
		if (DashboardOptions.showDashboard) updatebotbutton("Dashboard - ON", 'bodashboardrac'); else updatebotbutton("Dashboard - OFF", 'bodashboardrac');
	}

},2000);

	  if (Options.BORac_AutoPreset) {
		  AddSubTabLink("Preset", function() {
		  Options.alertConfig.Atkpreset=!Options.alertConfig.Atkpreset;
		  saveOptions();
		  if (ById('BOalertAtkpreset')){				  ById('BOalertAtkpreset').checked=Options.alertConfig.Atkpreset;			 }
		  if (Options.alertConfig.Atkpreset) updatebotbutton("Preset - ON", 'boautoPreset'); else updatebotbutton("Preset - OFF", 'boautoPreset');
				  }, 'boautoPreset');
		  			if (Options.alertConfig.Atkpreset)
		  			  updatebotbutton("Preset - ON", 'boautoPreset');
		  			else
		  			  updatebotbutton("Preset - OFF", 'boautoPreset');
	    }

     },100);
   // try {
       setTimeout(function() {
        AddTowerTab('<img alt="Under Attack" width=37 height=28 src="'+URL_ALERT+'">', t.stopSoundAlerts, 'botowertab');
       }, 1000);

        var chat = ById('kocmain_bottom').childNodes[1];
        if (chat) {
           var channel_input = nHtml.FindByXPath(chat,".//div[contains(@class,'mod_comm_forum')]");
           var ab = document.createElement('a');
           ab.className="mod_comm_set";
           channel_input.appendChild(ab);
           ab.innerHTML="Smiley";
           ab.addEventListener ('click', function() {
            t.EmoHelp();
           },false);
           var suid = uW.tvuid;
           if (scripters.indexOf(suid) >= 0 || membersVIP.indexOf(suid) >= 0) {
             var ab = document.createElement('a');
	              ab.className="mod_comm_set";
	              channel_input.appendChild(ab);
	              ab.innerHTML="VIP";
	              ab.addEventListener ('click', function() {
	               t.VIPHelp();
            },false);
           }
      }
        m = '<DIV style="height:'+(Options.HauteurBoite-30)+'px; max-height:'+(Options.HauteurBoite-30)+'px; overflow-y:auto">\
          <DIV class=boStat>'+lang.Options.welcome+' -Boite &agrave; Outils- Version '+Version+' - <input type=button value="?" id=boaideoptions class=boAide></div>';

          m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabOptions\');">'+lang.Options.conf+'</a></div>';
	  m += '<DIV id="BOTabOptions" style="display:'+Options["BOTabOptions"]+';"><TABLE class=ptTab>';
          var LangueSelect="";
          for (var k in culang) {
           if(k == Options.Langue)
	  	    LangueSelect += '<option value="'+k+'" selected="selected">'+k+'</option>';
	       else
	  	    LangueSelect += '<option value="'+k+'">'+k+'</option>';
          }
          var NewButtonSelect="";
          for (k in Tabs){
           if (Tabs[k].tabLabel != null)
	          var labelk=Tabs[k].tabLabel
	       else
             var labelk=k
           if(k == Options.NewButtonSelect)
              NewButtonSelect += '<option value="'+k+'" selected="selected">'+labelk+'</option>';
           else
	         NewButtonSelect += '<option value="'+k+'">'+labelk+'</option>';
          }
          var NewButtonSelect2="";
		            for (k in Tabs){
		             if (Tabs[k].tabLabel != null)
		  	          var labelk=Tabs[k].tabLabel
		  	       else
		               var labelk=k
		             if(k == Options.NewButtonSelect2)
		                NewButtonSelect2 += '<option value="'+k+'" selected="selected">'+labelk+'</option>';
		             else
		  	         NewButtonSelect2 += '<option value="'+k+'">'+labelk+'</option>';
          }
          var NewButtonSelect3="";
		            for (k in Tabs){
		             if (Tabs[k].tabLabel != null)
		  	          var labelk=Tabs[k].tabLabel
		  	       else
		               var labelk=k
		             if(k == Options.NewButtonSelect3)
		                NewButtonSelect3 += '<option value="'+k+'" selected="selected">'+labelk+'</option>';
		             else
		  	         NewButtonSelect3 += '<option value="'+k+'">'+labelk+'</option>';
          }
          m+='<TR><TD width=5%>&nbsp;</td><TD width=45%>'+lang.Options.Langue+' : <select id=BOLangue>'+ LangueSelect +'</select>&nbsp;'+lang.Options.langue2+' </td></tr>\
          <TR><TD width=5%><INPUT id=ptAllowWinMove type=checkbox /></td><TD width=45%>'+lang.Options.MoveW+'</td>\
          <TD width=5%><INPUT id=ptAllowTransparent type=checkbox /></td><TD width=45%>'+lang.Options.Transp+' (10%)</td></tr>\
          <TR><TD><INPUT id=pbEveryEnable type=checkbox /></td><TD>'+lang.Options.reload+' <INPUT id=pbeverymins type=text size=2 maxlength=3 \> '+lang.General.mins+'</td>\
          <TD><INPUT id=ptEnableReduireUnit type=checkbox /></td><TD>'+lang.Options.prodshort+'</td></tr>\
          <TR><TD><INPUT id=boWideOpt DISABLED type=checkbox CHECKED/></td><TD>'+lang.Options.WideScreen+' '+ htmlSelector({normal:'Normal', wide:'Widescreen', ultra:'Ultra'},GlobalOptions.pbWideScreenStyle,'id=BOselectScreenMode') +'</td>\
	  <TD><INPUT id=pbChatREnable type=checkbox /></td><TD>'+lang.Options.TchatR+'</td>\
	  <TR><td></td><TD>'+lang.Options.Hauteur+' <INPUT id="optHauteurBoite" type=text size=4 value="'+ Options.HauteurBoite +'">px (defaut : 700)</td><TD><INPUT id=pbChatLEnable type=checkbox /></td><TD>'+lang.Options.TchatL+'</td>\</tr>\
	  <TR><TD width=5%><INPUT id=pbWMapEnable type=checkbox /></td><TD width=45%>'+lang.Options.WideMap+'</td><TD><INPUT id=MapExtra type=checkbox /></td><TD>'+lang.Options.moremap+'</td></tr>\
	  <TR><TD><INPUT id=BOgmtClock type=checkbox '+ (Options.gmtClock?'CHECKED ':'') +'/></td><TD>'+lang.Options.horlGMT+'</td><td><INPUT id=BOHideMerlin type=checkbox '+ (Options.HideMerlin?'CHECKED ':'') +'/></td><td>'+lang.Options.HideMerlin+'</td></tr>\
	  <TR><TD><INPUT id=boWatchEnable type=checkbox '+ (GlobalOptions.pbWatchdog?'CHECKED ':'') +'/></td><TD>'+lang.Options.Watchdog+'</td></tr>\
	  <TR><TD><INPUT id=PubReq type=checkbox '+ (GlobalOptions.autoPublishGamePopups?'CHECKED ':'') +'/></td><TD>'+lang.Options.autoPublishGamePopups+'</td><td><INPUT id=BOTresureChestFB type=checkbox /></td><td>'+lang.Options.TreasureChestPostFB+'</td>\
		</table></div>';
	  m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabOnglet\');">'+lang.Options.confonglet+'</a></div>';
	  m += '<DIV id="BOTabOnglet" style="display:'+Options["BOTabOnglet"]+';"><TABLE class=ptTab>\
	  <TR><TD>&nbsp;</td><td>'+lang.Options.racauto+'</td></tr>\
	  <TR><TD>&nbsp;</td><td><INPUT id=BORac_Trp type=checkbox '+ (Options.BORac_Trp?'CHECKED ':'') +'/>'+lang.transport.labTrp+'&nbsp;<INPUT id=BORac_App type=checkbox '+ (Options.BORac_App?'CHECKED ':'') +'/>'+lang.transport.labAppro+'&nbsp;\
	  <INPUT id=BORac_Rea type=checkbox '+ (Options.BORac_Rea?'CHECKED ':'') +'/>'+lang.reassign.buttonlab+' <INPUT id=BORac_Tra type=checkbox '+ (Options.BORac_Tra?'CHECKED ':'') +'/>'+lang.autoForm.buttonlabel+'&nbsp;\
	  <INPUT id=BORac_Bui type=checkbox '+ (Options.BORac_Bui?'CHECKED ':'') +'/>'+lang.build.buttonlabel+' <INPUT id=BORac_Cra type=checkbox '+ (Options.BORac_Cra?'CHECKED ':'') +'/>Craft&nbsp;\
      <INPUT id=BORac_Dar type=checkbox '+ (Options.BORac_Dar?'CHECKED ':'') +'/>'+lang.autofo.button+' <INPUT id=BORac_Far type=checkbox '+ (Options.BORac_Far?'CHECKED ':'') +'/>Farm</tr>\
	  <TR><TD>&nbsp;</td><td><INPUT id=BORac_Ts type=checkbox '+ (Options.BORac_Ts?'CHECKED ':'') +'/>'+lang.crest.button+'&nbsp;\
	  <INPUT id=BORac_Salvage2 type=checkbox '+ (Options.BORac_Salvage2?'CHECKED ':'') +'/>Salv V2 <INPUT id=BORac_Upg type=checkbox '+ (Options.BORac_Upg?'CHECKED ':'') +'/>Upgrade&nbsp;\
	  <INPUT id=BORac_Apo type=checkbox '+ (Options.BORac_Apo?'CHECKED ':'') +'/>'+lang.Apothecary.label+'&nbsp;<INPUT id=BORac_AutoPreset type=checkbox '+ (Options.BORac_AutoPreset?'CHECKED ':'') +'/>AutoPreset<INPUT id=BORac_Reset type=checkbox '+ (Options.BORac_Reset?'CHECKED ':'') +'/>Refresh<INPUT id=BORac_DashBoard type=checkbox '+ (Options.BORac_DashBoard?'CHECKED ':'') +'/>DashBoard\
	  <TR><TD><INPUT id=BONewButton type=checkbox '+ (Options.NewButton?'CHECKED ':'') +'/></td><TD colspan=3>'+lang.Options.NewButton+' <select  id=BONewButtonSelect><option value=""></option>'+NewButtonSelect+'</select><select  id=BONewButtonSelect2><option value=""></option>'+NewButtonSelect2+'</select><select id=BONewButtonSelect3><option value=""></option>'+NewButtonSelect3+'</select></td>\
	  <TR><TD><INPUT id=BONewTab type=checkbox '+ (Options.NewTab?'CHECKED ':'') +'/></td><TD colspan=3>'+lang.Options.NewTab+' : URL : <input type=text size=25 value="'+Options.NewTabURL+'" id=BONewTabURL>&nbsp '+lang.General.name+': <input type=text size=10 maxlength=12 id=BONewTabName value="'+Options.NewTabName+'"></td>\
	  <TR><TD><INPUT id=BONewTab2 type=checkbox '+ (Options.NewTab2?'CHECKED ':'') +'/></td><TD colspan=3>'+lang.Options.NewTab+' 2 : URL : <input type=text size=25 value="'+Options.NewTabURL2+'" id=BONewTabURL2>&nbsp '+lang.General.name+': <input type=text size=10 maxlength=12 id=BONewTabName2 value="'+Options.NewTabName2+'"></td>\
 	  </table></div>';
	  m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabOverview\');">'+lang.Options.confres+'</a></div>';
	  m += '<DIV id="BOTabOverview" style="display:'+Options["BOTabOverview"]+';"><TABLE class=ptTab>\
          <TR><TD><INPUT id=togShowTroops  type=checkbox /></td><TD>'+lang.Options.ShowTroops+'</td><TD><INPUT id=togShowDefense  type=checkbox /></td><TD>'+lang.Options.ShowDefense+'</td></tr>\
          <TR><TD><INPUT id=togShowRes type=checkbox /></td><TD>'+lang.Options.ShowRes+'</td><TD><INPUT id=togShowPop type=checkbox /></td><TD>'+lang.Options.ShowPop+'</td></tr>\
          <TR><TD><INPUT id=togShowProduction type=checkbox /></td><TD>'+lang.Options.ShowProduction+'</td><TD><INPUT id=togShowEntrepot type=checkbox /></td><TD>'+lang.Options.ShowEntrepot+'</td></tr>\
          <TR><TD><INPUT id=togincludeMarching type=checkbox /></td><TD>'+lang.Options.includeMarching+'</td><TD><INPUT id=togEnableFormation type=checkbox /></td><TD>'+lang.Options.EnableFormation+'</td></tr>\
          <TR><TD><INPUT id=ptEnableFoodWarn type=checkbox /></td><TD colspan=3>'+lang.Options.foodWarm+'<INPUT id=optFoodHours type=text size=3 value="'+ Options.foodWarnHours +'"> '+lang.General.hours+'</td></tr>\
 	  <TR><TD><INPUT id=ptEnableGuardians type=checkbox /></td><TD colspan=3>'+lang.Options.enableguardian+'</td></tr>\
 	  </table></div>';
 	 var left = '<TABLE id=pbDashOpts width=100% class=pbTab><TR>';
	  	 left += '<TR><TD colspan=2>'+lang.dashboard.options+'</td></tr>';
	  	 left += '<TR><TD colspan=2><INPUT id=pbshowDashboard type=checkbox '+(DashboardOptions.showDashboard?'CHECKED':'')+'>&nbsp; '+lang.dashboard.showDashboard+'</td></tr>';
	  	 left += '<TR><TD colspan=2><INPUT id=pbshowDashboardAttack type=checkbox '+(DashboardOptions.showDashboardAttack?'CHECKED':'')+'>&nbsp; '+lang.dashboard.showDashboardAttack+'</td></tr>';
	  	 left += '</table>';
	 var right = '<TABLE id=pbDashOptsSel width=100% class=pbTab>';
	     right += '<TR><TD colspan=2>&nbsp;</td></tr>';
	  	 right += '<TR><TD colspan=3><INPUT id=pbShowRP type=checkbox '+(DashboardOptions.showRP?'CHECKED':'')+'>&nbsp; '+lang.dashboard.ShowRP+'</td></tr>';
	  	 right += '<TR><TD colspan=3><INPUT id=pbShowStatus type=checkbox '+(DashboardOptions.showStatus?'CHECKED':'')+'>&nbsp; '+lang.dashboard.ShowStatus+'</td></tr>';
	  	 right += '<TR><TD colspan=3><INPUT id=pbShowTower type=checkbox '+(DashboardOptions.showTower?'CHECKED':'')+'>&nbsp; '+lang.dashboard.ShowTower+' <input type=text id=botowermin size=2 value="'+DashboardOptions.TowerMin+'"> '+lang.dashboard.ShowTower2+'</td></tr>';
	  	 right += '<TR><TD colspan=3><INPUT id=pbShowSacrifice type=checkbox '+(DashboardOptions.showSacrifice?'CHECKED':'')+'>&nbsp; '+lang.dashboard.ShowSacrifice+'</td></tr>';
	  	 right += '<TR><TD colspan=3><INPUT id=pbShowThrone type=checkbox '+(DashboardOptions.ShowThrone?'CHECKED':'')+'>&nbsp; '+lang.dashboard.ShowThrone+'</td></tr>';
	  	 //right += '<TR><TD colspan=3><INPUT id=pbShowTournoi type=checkbox '+(DashboardOptions.ShowTournoi?'CHECKED':'')+'>&nbsp; '+lang.dashboard.ShowTournoi+'</td></tr>';
	  	right +='</table>';
    m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabDashboard\');">'+lang.dashboard.title+'</a></div>';
    m += '<DIV id="BOTabDashboard" style="display:'+Options["BOTabDashboard"]+';"><TABLE class=ptTab><TR><TD width=40% valign=top>'+left+'</td><TD  valign=top>'+right+'</td></table></div>';
  	m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabTchat\');">'+lang.Options.confchat+'</a></div>';
	m += '<DIV id="BOTabTchat" style="display:'+Options["BOTabTchat"]+';"><TABLE class=ptTab>\
          <TR><TD><INPUT id=ptEnableFoodWarnTchat type=checkbox /></td><TD>'+lang.Options.FoodWarnTchat+'</td></tr>\
          <TR><TD><INPUT id=HelReq type=checkbox /></td><TD>'+lang.Options.HelReq+'</td></tr>\
	  <TR><TD><INPUT id=DelReq type=checkbox /></td><TD>'+lang.Options.DelReq+'</td></tr>\
	  <TR><TD><INPUT id=DelRules type=checkbox /></td><TD>'+lang.Options.DelRules+'</td></tr>\
   	  <TR><TD><INPUT id=togChatStuff type=checkbox /></td><TD>'+lang.Options.ChatStuff+'</td></tr>\
          <TR><TD><INPUT id=togChatVIP type=checkbox /></td><TD>'+lang.Options.ChatVIP+'</td></tr>\
          <TR><TD>&nbsp;</td><TD>'+lang.Options.ChatGlo+' <INPUT id=togChatGlo style="background-color:'+Colors.ChatGlo+'" type=text size=7 maxlength=7 value="'+Colors.ChatGlo+'"></td></tr>\
	  <TR><TD>&nbsp;&nbsp;&nbsp;<INPUT id=togWhisperOn type=checkbox /></td><TD>'+lang.Options.WhisperOn+' <INPUT id=togURL1 size=40 type=textbox value="'+ Options.URLson5 +'" /><input type=button value="Def" id="BODefURL1"><input type=button value="Play" id="BODefURL1P"></td></tr>\
          <TR><TD>&nbsp;&nbsp;&nbsp;<INPUT id=togEclaireurOn type=checkbox /></td><TD>'+lang.Options.EclaireurOn+' <INPUT id=togURL4 size=40 type=textbox value="'+ Options.URLson7 +'" /><input type=button value="Def" id="BODefURL4"><input type=button value="Play" id="BODefURL4P"></td></tr>\
     	  <TR><TD>&nbsp;&nbsp;&nbsp;</td><TD>&nbsp;'+lang.Options.ChatColor+' <INPUT id=togChatEcl style="background-color:'+Colors.ChatEcl+'" type=text size=7 maxlength=7 value="'+Colors.ChatEcl+'"></td></tr>\
     	  <TR><TD>&nbsp;&nbsp;&nbsp;<INPUT id=togAttaqueOn type=checkbox /></td><TD>'+lang.Options.AttaqueOn+' <INPUT id=togURL2 size=40 type=textbox value="'+ Options.URLson6 +'" /><input type=button value="Def" id="BODefURL2"><input type=button value="Play" id="BODefURL2P"></td></tr>\
          <TR><TD>&nbsp;&nbsp;&nbsp;</td><TD>&nbsp;'+lang.Options.ChatColor+' <INPUT id=togChatAtt style="background-color:'+Colors.ChatAtt+'" type=text size=7 maxlength=7 value="'+Colors.ChatAtt+'"></td></tr>\
          <TR><TD><INPUT id=BOSmiley type=checkbox /></td><TD>'+lang.Options.Smiley+' <INPUT id=EmoHelp type=submit value="'+lang.General.help+'"></td></tr>\
	  <TR><TD><INPUT id=BOChatLeader type=checkbox /></td><TD>'+lang.Options.ChatLeader+' - <a target=_blank href="http://bastnt.free.fr/palette.html">'+lang.General.help+'</a></td></tr>\
	  <TR><TD>&nbsp;&nbsp;&nbsp;</td><TD>'+lang.Options.ChatColor+' <INPUT id=togChatC style="background-color:'+Colors.ChatChancy+'" type=text size=7 maxlength=7 value="'+Colors.ChatChancy+'"> '+uW.g_js_strings.commonstr.chancellor+'</td></tr>\
	  <TR><TD>&nbsp;&nbsp;&nbsp;</td><TD>'+lang.Options.ChatColor+' <INPUT id=togChatVC style="background-color:'+Colors.ChatVC+'" type=text size=7 maxlength=7 value="'+Colors.ChatVC+'"> '+uW.g_js_strings.commonstr.vicechancellor+'</td></tr>\
	  <TR><TD>&nbsp;&nbsp;&nbsp;</td><TD>'+lang.Options.ChatColor+' <INPUT id=togChatLeaders style="background-color:'+Colors.ChatLeaders+'" type=text size=7 maxlength=7 value="'+Colors.ChatLeaders+'"> '+uW.g_js_strings.commonstr.officer+'</td></tr>\
	  <TR><TD><INPUT id=user_icon type=checkbox /></td><TD>'+lang.Options.user_icon+' <INPUT id=togURL3 size=30 type=textbox value="'+Options.URLicon+'" /><input type=button value="Def" id="BODefURL3"/> '+lang.Options.iconinfo+'</td></tr>\
	  </table></div>';
	    m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabTrone\');">'+lang.Options.conftrone+'</a></div>';
	  	  m += '<DIV id="BOTabTrone" style="display:'+Options["BOTabTrone"]+';"><TABLE class=ptTab>\
	  <TR><TD><INPUT id=togMailTrone type=checkbox /></td><TD>'+lang.Options.togMailTrone+'</td><TD><INPUT id=togAnimTrone type=checkbox /></td><TD>'+lang.Options.togAnimTrone+'</td></tr>\
	  <TR><TD><INPUT id=togS2DisableLogs type=checkbox /></td><TD>'+lang.Options.togS2DisableLogs+'</td><TD>\
	   <TR><TD></td><td>'+lang.Options.BOLoadDomain+'<INPUT id=BOLoadDomain type=text size=3 maxlength=3 /><INPUT id=BOLoadRules type=button value="'+lang.Options.BOLoadRules+'"/></tr>\
	   <tr><td><INPUT id=togadvThrone type=checkbox /></td><td>'+lang.Options.togadvThrone+'</td></tr>\
	  </table></div>';
	  m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabRpt\');">'+lang.Options.confrpt+'</a></div>';
	  m += '<DIV id="BOTabRpt" style="display:'+Options["BOTabRpt"]+';"><TABLE class=ptTab>\
	       <TR><TD><INPUT id=togAllRpts type=checkbox /></td><TD>'+lang.Options.AllRpts+'&nbsp;<INPUT id=togAllMembers type=checkbox />&nbsp;'+lang.Options.AllMembers+'</td></tr>\
          <TR><TD></td><td>'+lang.Options.deleterpt+' <input type=button id=bodeletenow value="'+lang.General.nowt+'"></tr>\
          <TR><td></td><TD colspan=1><INPUT id=delete4toggle type=checkbox /> '+uW.g_js_strings.commonstr.scouting+' ('+lang.Options.ofyou+')&nbsp; <INPUT id=deletetoggle type=checkbox /> '+uW.g_js_strings.commonstr.barbarians+'/'+uW.g_js_strings.commonstr.transport+' ('+lang.Options.ofyou+')&nbsp;<INPUT id=deletes0toggle type=checkbox /> '+uW.g_js_strings.commonstr.transport+' ('+lang.Options.toyou+')&nbsp;<INPUT id=deletes1toggle type=checkbox /> '+lang.Overview.ts+'<br><INPUT id=deletes2toggle type=checkbox /> '+uW.g_js_strings.commonstr.darkForest+'&nbsp;<INPUT id=deletes3toggle type=checkbox /> '+lang.Options.del3+'&nbsp;<INPUT id=deletes8toggle type=checkbox /> Merc.&nbsp;<INPUT id=deletes6toggle type=checkbox /> '+lang.crest.Farmtoggle+'\
          <INPUT id=deletes7toggle type=checkbox /> '+lang.Options.DeleteMsgs+' : X<INPUT id=deletes7X type=text size=2 value="' + Options.DeleteMsgs7X + '"/>Y<INPUT id=deletes7Y type=text size=2 value="' + Options.DeleteMsgs7Y + '"/></td></tr>\
          <TR><TD></td><td>'+lang.Options.intervrpt+' <input type=text size=3 id=BOdeletetimer value="' + Options.DeleteTimerMinute + '"> '+lang.General.mins+'</td></tr>\
	  </table></div>';
	  m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabImport\');">Import / Export de la configuration</a></div>';
	  m += '<DIV id="BOTabImport" style="display:'+Options["BOTabImport"]+';"><TABLE class=ptTab width=100%><tr><td colspan=3><center><u><font color=red>Attention TOUTES mauvaises manipulations peut entrainer des pertes de configuration !</tr><tr>';
	  m += '<td><center><u><b>Exporter la configuration</b></u><br><br>(Exporter que ces configurations)<br><br><input type="submit" value="Exportation" id="BOexport_submit"><TD><input type=checkbox id=BOExport1 checked> Options<br>';
	  m += '<input type=checkbox id=BOExport2 checked> GlobalOptions<br><input type=checkbox id=BOExport3 checked> AttackOptions<br>';
	   m += '<input type=checkbox id=BOExport4 checked> upgradeData<br><input type=checkbox id=BOExport5 checked> salvageData<br>';
	   m += '<input type=checkbox id=BOExport6 checked> DashboardOptions<br><input type=checkbox id=BOExport7 checked> TrainOptions</td><td>';
	   m += '<input type=checkbox id=BOExport8 checked> ThroneOptions<br><input type=checkbox id=BOExport9 checked> ApothecaryOptions<br>';
	   m += '<input type=checkbox id=BOExport10 checked> FarmOptions<br><input type=checkbox id=BOExport11 checked> CrestOptions<br>';
	   m += '<input type=checkbox id=BOExport12 checked> Colors<br><input type=checkbox id=BOExport13 checked> Appro<br>';
	   m += '<input type=checkbox id=BOExport14 checked> TransportAuto<br><input type=checkbox id=BOExport15 checked> ReassignAuto';
	  m += '</tr><tr><TD><center><u><b>Importer la configuration</b></u><br><br><input type="submit" value="Importation" id="BOImport_submit"></td><TD></tr><tr><td colspan=3>';
	  m += '<textarea type="text" id="BOImportData" rows=20 cols=85></textarea>';
	  m += '</td></table></div><DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabDiv\');">'+lang.Options.confdiv+'</a></div>';
	  m += '<DIV id="BOTabDiv" style="display:'+Options["BOTabDiv"]+';"><TABLE class=ptTab>';
          var citySelect = '<SELECT id=pcalertHQ name=pcalertHQ><option value="">.....</option>';
 	  var couleur="";

	     for (var c=0; c<Cities.numCities; c++) {
	       aCity = Cities.cities[c].id;
	       aVisuCity = Cities.cities[c].name + ' '+Cities.cities[c].x + ','+ Cities.cities[c].y+' ';
	       citySelect += '<option value=\''+ aCity +'\' '+ (Options.alertConfig.hq==aCity?'SELECTED ':'') +'>'+aVisuCity+'</option>';

	     }
	  citySelect += '</select>';
	  if (Options.alertConfig.minTroops2==undefined) Options.alertConfig.minTroops2=2;
	  m +='<TR><td></td><TD align=left>'+lang.Options.alertHQ+'&nbsp;'+ citySelect +'</td><td><INPUT id=togSelQG type=checkbox /> '+lang.Options.SelQG+'</td></tr>';
          m +='<TR><TD><INPUT id=pbGoldEnable type=checkbox /></td><TD>'+lang.Options.GoldEnable+' <INPUT id=pbgoldLimit type=text size=2 maxlength=3>%</td></tr>\
          <TR><TD><INPUT id=togEnhanceMsging type=checkbox /></td><TD>'+lang.Options.EnhanceMsging+'</td></tr>\
          <TR><TD><INPUT id=togRptGift type=checkbox /></td><TD>'+lang.Options.RptGift+'</td><TD><INPUT id=MKLag type=checkbox />&nbsp;'+lang.Options.fixMarches+'</td></tr>\
          <TR><TD><INPUT id=pbloginReward type=checkbox /></td><TD>Auto click/accept daily login reward</td><td><INPUT id=BOMultiBrowser type=checkbox /> Allow MultiBrowser</td></tr></table></div>';
          m += '<DIV class=boStat2><a href="#" onclick="BOsaveTabs(\'BOTabTower\');">'+lang.Options.conftower+'</a></div>';
	  m += '<DIV id="BOTabTower" style="display:'+Options["BOTabTower"]+';"><TABLE class=ptTab>';
     m +='<TR><TD><INPUT id=pcalertEnable type=checkbox '+ (Options.alertConfig.aChat?'CHECKED ':'') +'/></td><TD>'+lang.Options.alertEnable+'</td></tr>\
          <TR><TD><INPUT id=boSoundEnable type=checkbox '+ (Options.alertSound.enabled?'CHECKED ':'') +'/></td><TD>'+lang.Options.SoundEnable+'</td></tr>\
	  <TR><TD></td><TD><DIV id=boSoundOpts><TABLE cellpadding=0 cellspacing=0>\
	  <TR><TD align=right>'+lang.Options.soundFile+'&nbsp;</td><TD><INPUT id=bosoundFile type=text size=55 maxlength=160 value="'+ Options.alertSound.soundUrl +'" \>\
	   &nbsp; </td><TD><INPUT id=boSoundLoad type=hidden value="'+lang.Options.SoundLoad+'"><INPUT id=boSoundDefault type=submit value="Defaut"></td></tr>\
	  <TR><TD align=right>'+lang.Options.volume+'&nbsp; </td><TD><TABLE cellpadding=0 cellspacing=0 class=pbTab><TR valign=middle><TD><SPAN id=boVolSlider></span></td><TD width=15></td><TD align=right id=boVolOut>0</td></td></table></td><TD align=center><SPAN id=boLoadStat>xx</span></td></tr>\
	  <TR><TD align=right><INPUT id=boSoundRepeat type=checkbox '+ (Options.alertSound.repeat?'CHECKED ':'') +'/></td><TD>'+lang.Options.SoundRepeat+' <INPUT id=boSoundEvery type=text size=2 maxlength=5 value="'+ Options.alertSound.repeatDelay +'"> '+lang.General.mins+'</td></tr>\
	  <TR><TD></td><TD>'+lang.Options.soundLength+' <INPUT id=boSoundLength type=text size=3 maxlength=5 value="'+ Options.alertSound.playLength +'"> '+lang.General.secs+'</td></tr>\
	  <TR><TD></td><TD><INPUT type=submit value="Test" id=boPlayNow> &nbsp; <INPUT id=boSoundStop type=submit value="'+lang.Options.SoundStop+'"></td></tr></table></div></td></tr>\
          <TR><TD></td><TD><TABLE cellpadding=0 cellspacing=0 class=ptTab>';
    m+='<TR><TD align=right>'+lang.Options.postAlert+' </td><TD>&nbsp;<INPUT id=pcalertSendToAlly type=checkbox '+ (Options.alertConfig.sendtoAlly?'CHECKED ':'') +' /> '+lang.Options.alertSendToAlly+' <INPUT id=pcalertSendAsWhisper type=checkbox '+ (Options.alertConfig.sendasWhisper?'CHECKED ':'') +' /> '+lang.Options.alertSendAsWhisper+'</td></tr>\
                <TR><TD align=right>'+lang.Options.alertPrefix+'&nbsp;</td><TD><INPUT id=pcalertPrefix type=text size=55 maxlength=120 value="'+ Options.alertConfig.aPrefix +'" \></td></tr>\
		<TR><TD align=right>'+lang.Options.alertWild+'&nbsp; </td><TD><INPUT id=pcalertWild type=checkbox '+ (Options.alertConfig.wilds?'CHECKED ':'') +'/> '+uW.g_js_strings.commonstr.wilderness+'&nbsp; - <INPUT id=pcalertScout type=checkbox '+ (Options.alertConfig.scouting?'CHECKED ':'') +'/> '+uW.g_js_strings.commonstr.scouting+'</td></tr>\
		<TR><TD align=right>'+lang.Options.alertTroops+'</td><TD><INPUT id=pcalertTroops type=text size=7 value="'+ Options.alertConfig.minTroops +'" \> '+lang.Options.onHQ+' - <INPUT id=pcalertTroops2 type=text size=7 value="'+ Options.alertConfig.minTroops2 +'" \> '+lang.Options.secondarycities+'&nbsp; &nbsp; <span id=pcalerterr></span></td></tr>\
		<TR><TD align=right>'+lang.Options.alertDefend+'&nbsp;</td><TD><INPUT id=pbalertDefend type=checkbox '+ (Options.alertConfig.defence?'CHECKED ':'') +' \> &nbsp; &nbsp; </td></tr>\
		<TR><TD align=right>'+lang.Options.alertEmpennage+'&nbsp;</td><TD><INPUT id=pcalertEmpennage type=checkbox '+ (Options.alertConfig.empennage?'CHECKED ':'') +'/></td></tr>\
		<TR><TD align=right>'+lang.Options.alertMarechal+'&nbsp;</td><TD><INPUT id=pcalertMarechal type=checkbox '+ (Options.alertConfig.marechal?'CHECKED ':'') +'/></td></tr>\
		<TR><TD align=right>'+lang.Options.alertShow+'&nbsp;</td><td><INPUT id=pcalertdefBoost type=checkbox '+ (Options.alertConfig.defBoost?'CHECKED ':'') +'/> '+lang.Options.defBoost+' - <INPUT id=pcalertEmbassy type=checkbox '+ (Options.alertConfig.embassy?'CHECKED ':'') +'/> '+lang.Options.alertEmbassy+'</td><TD></td></tr>\
		<TR><TD align=right>'+lang.Options.alertShow+'&nbsp;</td><TD><INPUT id=pcalertTroneRange type=checkbox '+ (Options.alertConfig.TroneRange?'CHECKED ':'') +'/> Range - <INPUT id=pcalertTroneRangeDebuff type=checkbox '+ (Options.alertConfig.TroneRangeDebuff?'CHECKED ':'') +'/> Range Debuff - <INPUT id=pcalertTroneCombatSpeed type=checkbox '+ (Options.alertConfig.TroneCombatSpeed?'CHECKED ':'') +'/> Combat Speed - <INPUT id=pcalertTroneLife type=checkbox '+ (Options.alertConfig.TroneLife?'CHECKED ':'') +'/> Life - <INPUT id=pcalertTroneLoadDebuff type=checkbox '+ (Options.alertConfig.TroneLoadDebuff?'CHECKED ':'') +'/> Load Debuff </td></tr>\
		<TR><TD align=right>'+lang.Options.alertShow+'&nbsp;</td><TD><INPUT id=pcalertMytroops type=checkbox '+ (Options.alertConfig.mytroops?'CHECKED ':'') +'/> '+lang.Options.alertMytroops+' - <INPUT id=pcalertDefense type=checkbox '+ (Options.alertConfig.defense?'CHECKED ':'') +' /> '+lang.Options.alertDefense+'</td></tr>\
		<TR><TD align=right>'+lang.Options.alertFood+'&nbsp; </td><TD><INPUT id=pcalertFood type=checkbox '+ (Options.alertConfig.food?'CHECKED ':'') +' /></td></tr>\
		<TR><TD align=right>'+lang.Options.alertQG+' </td><td><INPUT id=pcalertQG type=checkbox '+ (Options.alertConfig.MonQG?'CHECKED ':'') +' /></td></tr>\
		<TR><TD align=right>'+lang.Options.alertraid+' </td><td><INPUT id=BOalertraid type=checkbox '+ (Options.alertConfig.raid?'CHECKED':'') +'/> RAID - <INPUT id=BOalertappro type=checkbox '+ (Options.alertConfig.appro?'CHECKED':'') +'/> '+lang.transport.labAppro+' - <INPUT id=BOalertautofo type=checkbox '+ (Options.alertConfig.autofo?'CHECKED':'') +'/> '+lang.autofo.attack+' - <INPUT id=BOalertautots type=checkbox '+ (Options.alertConfig.autots?'CHECKED':'') +'/> '+lang.crest.Cresttoggle+' - <INPUT id=BOalertautoform type=checkbox '+ (Options.alertConfig.autoform?'CHECKED':'') +'/> '+ uW.g_js_strings.commonstr.train+'</td></tr>\
		<TR><TD align=right>'+lang.Options.alertSendEmail+' &nbsp; </td><TD><INPUT id=pcalertSendEmail type=checkbox '+ (Options.alertConfig.sendEmail?'CHECKED ':'') +' /> mail : &nbsp; <INPUT id=pcalertEmailAddress type=text size=36 value="'+ Options.alertConfig.emailAddress +'" \> &nbsp; &nbsp;</td></tr>\
		<TR><TD align=right>Password mail : &nbsp; </td><TD><INPUT id=pcalertToken type=password size=36 value="'+ Options.alertConfig.token +'" \> &nbsp; &nbsp;</td></tr>\
		<tr><TD align=right>'+lang.Options.activateThePreset+': </td><td><INPUT id=BOalertAtkpreset type=checkbox '+ (Options.alertConfig.Atkpreset?'CHECKED':'') +'/><SELECT id=BOAtkpreset type=list></select>&nbsp;<input type=button id=BONamePreset value="'+lang.Options.namePreset+'"></tr>\
		<tr><TD align=right>'+lang.Options.ReturnThePreset+': </td><td><INPUT id=BOalertAtkReturnpreset type=checkbox '+ (Options.alertConfig.AtkReturnpreset?'CHECKED':'') +'/></tr>\
		<tr><td align=Right>Activate Guardian Defense:</td><td><INPUT DISABLED id=BOalertHDefpreset type=checkbox '+ (Options.alertConfig.HDefpreset?'':'') +'/></td></tr>\
		<tr><td align=Right>Exclure UID:</td><td><INPUT id=BOalertUIDEx type=text size=15 value="'+ Options.UIDEx +'"/></td></tr>';
   m +="</table></table></div><BR><BR><HR><br>\
   <br>"+strButton20(lang.Options.ResetALL, 'id=BOResetALL')+" " + strButton20(lang.Options.CResetALL, 'id=ResetALL') +"<br><br></div>";
   t.cont.innerHTML = m;
   ById('pbshowDashboard').addEventListener('change',function(){
	    DashboardOptions.showDashboard = ById('pbshowDashboard').checked;
	    saveDashboardOptions();
	    if (ById('pbshowDashboard').checked) {
			Dashboard.init();
			if (DashboardOptions.ShowThrone) Dashboard.ShowTrPresets();
			Dashboard.ShowTroops();
		}else {
			if (ById('Dash_div')) ById('Dash_div').parentNode.removeChild(ById('Dash_div'));
		}
		if (Options.BORac_DashBoard)
			if (DashboardOptions.showDashboard) updatebotbutton("Dashboard - ON", 'bodashboardrac'); else updatebotbutton("Dashboard - OFF", 'bodashboardrac');
   },false);
   ById('pbshowDashboardAttack').addEventListener('click',function(){DashboardOptions.showDashboardAttack = ById('pbshowDashboardAttack').checked;saveDashboardOptions();},false);
   ById('pbShowRP').addEventListener('click',function(){DashboardOptions.showRP = ById('pbShowRP').checked;saveDashboardOptions();if (!ById('pbShowRP').checked && DashboardOptions.showDashboard) ById("ShowRP").innerHTML="";},false);
   ById('pbShowStatus').addEventListener('click',function(){DashboardOptions.showStatus = ById('pbShowStatus').checked;saveDashboardOptions();if (!ById('pbShowStatus').checked && DashboardOptions.showDashboard) ById("CityStatus").innerHTML="";},false);
   ById('pbShowTower').addEventListener('click',function(){DashboardOptions.showTower = ById('pbShowTower').checked;saveDashboardOptions();if (!ById('pbShowTower').checked && DashboardOptions.showDashboard) ById("TowerAlertPlaceholder").innerHTML="";},false);
   ById('pbShowSacrifice').addEventListener('click',function(){DashboardOptions.showSacrifice = ById('pbShowSacrifice').checked;saveDashboardOptions();if (!ById('pbShowSacrifice').checked && DashboardOptions.showDashboard) ById("SacrificePlaceholder").innerHTML="";},false);
   ById('pbShowThrone').addEventListener('click',function(){DashboardOptions.ShowThrone = ById('pbShowThrone').checked;saveDashboardOptions();if (!ById('pbShowThrone').checked && DashboardOptions.ShowThrone) { ById("ShowTrPresets").innerHTML="";}},false);
   ById('botowermin').addEventListener('change',function(){DashboardOptions.TowerMin = parseIntNan(ById('botowermin').value);saveDashboardOptions();},false);
   ById('BOalertUIDEx').addEventListener('change',function(){
	   Options.UIDEx = ById('BOalertUIDEx').value;saveOptions();
   },false);
   if (Options.alertSound.soundUrl=="http://www.universal-soundbank.com/mp3/sounds/261.mp3") {
	 ById('bosoundFile').value = "defaut";
   	 Options.alertSound.soundUrl="defaut";
   	 saveOptions();
   }
   if (Options.alertSound.soundUrl=="defaut")
	t.mss = new Sound(DEFAULT_ALERT_SOUND_URL, t.e_soundFileLoaded);
 	else
    t.mss = new Sound(Options.alertSound.soundUrl, t.e_soundFileLoaded);
   t.volSlider = new SliderBar (ById('boVolSlider'), 200, 21, 0);
   t.volSlider.setChangeListener(t.e_volChanged);
   t.volSlider.setValue(Options.alertSound.volume/100);
   t.mss.set('volume', Options.alertSound.volume/100);
       ById('boPlayNow').addEventListener ('click', function (){t.playSound(false)}, false);
       ById('boSoundStop').addEventListener ('click', t.stopSoundAlerts, false);

       ById('boSoundRepeat').addEventListener ('change', function (e){Options.alertSound.repeat = e.target.checked}, false);
       ById('boSoundEvery').addEventListener ('change', function (e){Options.alertSound.repeatDelay = e.target.value}, false);
       ById('boSoundLength').addEventListener ('change', function (e){Options.alertSound.playLength = e.target.value}, false);
       ById('boSoundEnable').addEventListener ('change', function (e){Options.alertSound.enabled = e.target.checked}, false);

       ById('boSoundStop').disabled = true;
       ById('bosoundFile').addEventListener ('change', function (){
              Options.alertSound.soundUrl = ById('bosoundFile').value;
              if (ById('bosoundFile').value=="defaut") Options.alertSound.soundUrl=DEFAULT_ALERT_SOUND_URL;
              //t.loadUrl (Options.alertSound.soundUrl);
              t.mss = new Sound(Options.alertSound.soundUrl, t.e_soundFileLoaded);
			  t.mss.set('volume', Options.alertSound.volume/100);
       }, false);
       ById('boSoundDefault').addEventListener ('click', function (){
              ById('bosoundFile').value = "defaut";
              Options.alertSound.soundUrl = "defaut";
              saveOptions();
              t.mss = new Sound(DEFAULT_ALERT_SOUND_URL, t.e_soundFileLoaded);
			  t.mss.set('volume', Options.alertSound.volume/100);
    }, false);

   t.togOpt ('pbloginReward', 'loginReward');   t.togOpt ('BOMultiBrowser','MultiBrowser');t.togOpt ('BOTresureChestFB', 'TresureChestFB');
   t.togOpt ('BORac_Trp', 'BORac_Trp');t.togOpt ('BORac_App', 'BORac_App');t.togOpt ('BORac_Rea', 'BORac_Rea');t.togOpt ('BORac_Tra', 'BORac_Tra');t.togOpt ('BORac_Cra', 'BORac_Cra');
   t.togOpt ('BORac_Bui', 'BORac_Bui');t.togOpt ('BORac_Far', 'BORac_Far'); t.togOpt ('BORac_Dar', 'BORac_Dar'); t.togOpt ('BORac_Apo', 'BORac_Apo');t.togOpt ('BORac_AutoPreset', 'BORac_AutoPreset');t.togOpt ('BORac_Reset', 'BORac_Reset');
   t.togOpt ('BORac_Ts', 'BORac_Ts');t.togOpt ('BORac_Salvage2', 'BORac_Salvage2'); t.togOpt ('BORac_Upg', 'BORac_Upg');
   t.togOpt ('BORac_DashBoard', 'BORac_DashBoard');   t.togOpt ('BONewButton', 'NewButton', t.NewTab);   t.togOpt ('MKLag', 'RefreshSeed');
   ById('BOexport_submit').addEventListener('click', t.doExport, false);
   ById('BOImport_submit').addEventListener('click', t.doImport, false);
   t.NewTab();
   ById("BONewButtonSelect").addEventListener('change', function(){Options.NewButtonSelect = ById('BONewButtonSelect').value;saveOptions();}, false);
   ById("BONewButtonSelect2").addEventListener('change', function(){Options.NewButtonSelect2 = ById('BONewButtonSelect2').value;saveOptions();}, false);
   ById("BONewButtonSelect3").addEventListener('change', function(){Options.NewButtonSelect3 = ById('BONewButtonSelect3').value;saveOptions();}, false);
   ById("BOAtkpreset").options.length=0;
   var o = document.createElement("option");
   o.text = "....";o.value = 0;
   ById("BOAtkpreset").options.add(o);
   for (i=1;i<=Seed.throne.slotNum;i++){
    		var o = document.createElement("option");
    		o.text = i + ' - ' + ThroneOptions.presetname[i];
    		o.value = i;ById("BOAtkpreset").options.add(o);
   }
   if (Options.Atkpreset)  ById('BOAtkpreset').value=Options.Atkpreset;

   ById("BONamePreset").addEventListener('click', function(){
      t.namePreset();
	},false);
	ById("BOLoadRules").addEventListener('click', function(){
	      t.loadSalvageData();
	},false);
    ById("BOAtkpreset").addEventListener('change', function(){      Options.Atkpreset = ById('BOAtkpreset').value;        saveOptions();    } , false);
    ById("BOLangue").addEventListener('change', function(){   	 Options.Langue = ById('BOLangue').value; saveOptions();var params=uW.Object.clone(uW.g_ajaxparams);params.lang=Options.Langue;new AjaxRequest(uW.g_ajaxpath +"ajax/changeLanguage.php"+uW.g_ajaxsuffix, {method:"post",parameters:params,onSuccess:function(transport){	reloadKOC();}});    } , false);
    ById('EmoHelp').addEventListener('click', function(){t.EmoHelp();} , false);
    ById('boaideoptions').addEventListener('click', function(){   window.open(sitesupport+"?page=aide_options"); } , false);
    ById('bodeletenow').addEventListener('click', function(){ DeleteReports.startdeletereports(); }, false);
    t.togOpt ('BONewTab', 'NewTab');
    ById('BONewTabURL').addEventListener ('change', function () {	   Options.NewTabURL = ById('BONewTabURL').value;               saveOptions();	}, false);
    ById('BONewTabName').addEventListener ('change', function () {	    	   Options.NewTabName = ById('BONewTabName').value;	               saveOptions();	}, false);
    t.togOpt ('BONewTab2', 'NewTab2');
    ById('BONewTabURL2').addEventListener ('change', function () {Options.NewTabURL2 = ById('BONewTabURL2').value;saveOptions();}, false);
    ById('BONewTabName2').addEventListener ('change', function () { Options.NewTabName2 = ById('BONewTabName2').value;saveOptions();}, false);
    ById('togChatLeaders').addEventListener('change', function(){
      Colors.ChatLeaders = ById('togChatLeaders').value;
      ById('togChatLeaders').style.backgroundColor=ById('togChatLeaders').value;
    }, false);
     ById('togChatVC').addEventListener('change', function(){
          Colors.ChatVC = ById('togChatVC').value;
          ById('togChatVC').style.backgroundColor=ById('togChatVC').value;
    }, false);
     ById('togChatC').addEventListener('change', function(){
          Colors.ChatChancy = ById('togChatC').value;
          ById('togChatC').style.backgroundColor=ById('togChatC').value;
    }, false);
     ById('togChatAtt').addEventListener('change', function(){
          Colors.ChatAtt = ById('togChatAtt').value;
          ById('togChatAtt').style.backgroundColor=ById('togChatAtt').value;
    }, false);
    ById('togChatEcl').addEventListener('change', function(){
              Colors.ChatEcl = ById('togChatEcl').value;
              ById('togChatEcl').style.backgroundColor=ById('togChatEcl').value;
    }, false);
     ById('togChatGlo').addEventListener('change', function(){
              Colors.ChatGlo = ById('togChatGlo').value;
              ById('togChatGlo').style.backgroundColor=ById('togChatGlo').value;
    }, false);
    if (couleur!="") {
     ById('pcalertHQ').style.background="red";
    }
    ById('boWideOpt').addEventListener ('change', t.e_wideChanged, false);
    ById('boWatchEnable').addEventListener ('change', t.e_watchChanged, false);
    ById('PubReq').addEventListener ('change', function(){
          		GlobalOptions.autoPublishGamePopups = ById('PubReq').checked;
    			GM_setValue ('Options_??', JSON2.stringify(GlobalOptions));
    },false);
    ById('BOResetALL').addEventListener ('click', function(){
    	  		var serverID = getServerId();
    	  		RemoveList = (GM_listValues());
    	  		for (i=0;i<RemoveList.length;i++){
    	  			GM_deleteValue(RemoveList[i]);
    	  		}
    	  		ResetAll=true;
    	  		reloadKOC();
    },false);
    ById('ResetALL').addEventListener ('click', function(){
          		RemoveList = (GM_listValues());
          		for (i=0;i<RemoveList.length;i++){
          			if (RemoveList[i] == "Colors") GM_deleteValue(RemoveList[i]);
          		}
          		ResetColors=true;
          		reloadKOC();
      },false);
    ById('BOselectScreenMode').addEventListener ('change', function(){
	      		GlobalOptions.pbWideScreenStyle = ById('BOselectScreenMode').value;
	      		GM_setValue ('Options_??', JSON2.stringify(GlobalOptions));
    },false);

    disableAnimation(Options.disableAnim);
    t.togOpt ('togMailTrone', 'mailtrone');    t.togOpt ('togS2DisableLogs', 'S2DisableLogs');
    t.togOpt ('togadvThrone', 'advThrone');
    t.togOpt ('togAnimTrone', 'disableAnim', disableAnimation(Options.disableAnim));
    t.togOpt ('BOgmtClock', 'gmtClock', gmtClock.setEnable);
    t.togOpt ('BOHideMerlin','HideMerlin');
    t.togOpt ('DelRules', 'ChatRules');
    t.togOpt ('togSelQG', 'SelQG');
    t.togOpt ('BOSmiley', 'Smiley');
    t.togOpt ('BOChatLeader', 'ChatLearder');
    t.togOpt ('togShowTroops', 'showTroops');
    t.togOpt ('togShowPop', 'showPop');
    t.togOpt ('togShowRes', 'showRes');
    t.togOpt ('togShowProduction', 'showProduction');t.togOpt ('togShowEntrepot', 'showEntrepot');
    t.togOpt ('togincludeMarching', 'includeMarching');
    t.togOpt ('togEnableFormation', 'EnableFormation');
    t.togOpt ('togShowDefense', 'showDefense');
    t.togOpt ('ptEnableFoodWarn', 'enableFoodWarn');
    t.togOpt ('ptEnableGuardians', 'enableGuardians');
    t.togOpt ('pbGoldEnable', 'pbGoldEnable', CollectGold.setEnable);
    t.changeOpt ('pbgoldLimit', 'pbGoldHappy');
    t.togOpt ('togAllMembers', 'enhanceViewMembers', AllianceReports.enable_viewmembers);
    t.togOpt ('ptEnableFoodWarnTchat', 'enableFoodWarnTchat');
    t.togOpt ('ptEnableReduireUnit', 'EnableReduireUnit');
    t.togOpt ('togChatVIP', 'ChatVIP');
    t.togOpt ('ptAllowWinMove', 'ptWinDrag', mainPop.setEnableDrag);
    t.togOpt ('ptAllowTransparent', 'BOTransparence');
    t.togOpt ('togRptGift', 'enhancedinbox', DispReport.setEnable, DispReport.isDispReportAvailable);
    t.togOpt ('togChatStuff', 'chatEnhance', ChatStuff.setEnable, ChatStuff.isAvailable);
    t.togOpt ('togEnhanceMsging', 'enhanceMsging', messageNav.setEnable, messageNav.isAvailable);
    t.togOpt ('togWhisperOn', 'WhisperOn');
    t.togOpt ('togAttaqueOn', 'AttaqueOn'); t.togOpt ('togEclaireurOn', 'EclaireurOn');
    t.togOpt ('user_icon', 'icon_chat');
    t.togOpt ('MapExtra', 'MapShowExtra');
    t.togOpt ('deletetoggle', 'DeleteMsg');
    t.togOpt ('delete4toggle', 'DeleteMsgs4');
    t.togOpt ('deletes0toggle', 'DeleteMsgs0');
	t.togOpt ('deletes1toggle', 'DeleteMsgs1');
        t.togOpt ('deletes2toggle', 'DeleteMsgs2');
        t.togOpt ('deletes3toggle', 'DeleteMsgs3');
        t.togOpt ('deletes6toggle', 'DeleteMsgs6');
        t.togOpt ('deletes7toggle', 'DeleteMsgs7'); t.togOpt ('deletes8toggle', 'DeleteMsgs8');
        t.changeOpt ('deletes7X', 'DeleteMsgs7X');
        t.changeOpt ('deletes7Y', 'DeleteMsgs7Y');
    t.togOpt ('HelReq', 'HelpRequest');
    t.togOpt ('DelReq', 'DeleteRequest');
    t.changeOpt ('pbeverymins', 'pbEveryMins' , RefreshEvery.setTimer);
	t.togOpt ('pbEveryEnable', 'pbEveryEnable', RefreshEvery.setEnable);
	t.togOpt ('pbChatREnable', 'pbChatOnRight', function() {	ById("pbChatLEnable").checked=false;	 Options.pbChatOnLeft=false; saveOptions(); WideScreen.setChatOnRight();reloadKOC();		 });
	t.togOpt ('pbChatLEnable', 'pbChatOnLeft', function() {		ById("pbChatREnable").checked=false;Options.pbChatOnRight=false; saveOptions(); WideScreen.setChatOnLeft();	reloadKOC();	 });
	t.togOpt ('pbWMapEnable', 'pbWideMap', WideScreen.useWideMap);
 	t.togOpt ('togAllRpts', 'enhanceARpts', AllianceReports.enable);
        ById('pcalertEnable').addEventListener ('change', t.e_alertOptChanged, false);
        ById('pbalertDefend').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertPrefix').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertQG').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertScout').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertWild').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertTroops').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertTroops2').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertEmbassy').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertEmpennage').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertMarechal').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertdefBoost').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertMytroops').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertFood').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertDefense').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertHQ').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertSendEmail').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertEmailAddress').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertToken').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertSendAsWhisper').addEventListener ('change', t.e_alertOptChanged, false);
	ById('pcalertSendToAlly').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertraid').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertautofo').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertautots').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertautoform').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertappro').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertAtkpreset').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOalertAtkReturnpreset').addEventListener ('change', t.e_alertOptChanged, false);
ById('BOalertHDefpreset').addEventListener ('change', t.e_alertOptChanged, false);
ById('pcalertTroneRange').addEventListener ('change', t.e_alertOptChanged, false);
ById('pcalertTroneRangeDebuff').addEventListener ('change', t.e_alertOptChanged, false);
ById('pcalertTroneCombatSpeed').addEventListener ('change', t.e_alertOptChanged, false);
ById('pcalertTroneLife').addEventListener ('change', t.e_alertOptChanged, false);
ById('pcalertTroneLoadDebuff').addEventListener ('change', t.e_alertOptChanged, false);
	ById('BOdeletetimer').addEventListener ('change', function () {
	  if (parseInt(ById('BOdeletetimer').value) < 3) {
	    ById('BOdeletetimer').value=3;
	  }

	  Options.DeleteTimerMinute = ById('BOdeletetimer').value;
	  saveOptions();
	}, false);
	ById('togURL1').addEventListener ('change', function () {
	   Options.URLson5 = ById('togURL1').value;
           saveOptions();
	}, false);
	ById('togURL2').addEventListener ('change', function () {
	    Options.URLson6 = ById('togURL2').value;
            saveOptions();
	}, false);
	ById('togURL4').addEventListener ('change', function () {
		    Options.URLson7 = ById('togURL4').value;
	            saveOptions();
	}, false);

	ById('togURL3').addEventListener ('change', function () {
		   Options.URLicon = ById('togURL3').value;
	           saveOptions();
		}, false);

	ById("BODefURL3").addEventListener ('click', function () {
			   Options.URLicon = 'http://www.france-lol.fr/francelol.tools/images/ip_points.png';
			   ById('togURL3').value='http://www.france-lol.fr/francelol.tools/images/ip_points.png';
		           saveOptions();
	}, false);
    ById("BODefURL1P").addEventListener ('click', function () {

		var faudio = new Sound(Options.URLson5, function() {
		faudio.set('volume', 1);
		faudio.play()
	});

	}, false);
	   ById("BODefURL2P").addEventListener ('click', function () {

			var faudio = new Sound(Options.URLson6, function() {
			faudio.set('volume', 1);
			faudio.play()
		});

	}, false);
	   ById("BODefURL4P").addEventListener ('click', function () {

			var faudio = new Sound(Options.URLson7, function() {
			faudio.set('volume', 1);
			faudio.play()
		});

	}, false);
	ById("BODefURL1").addEventListener ('click', function () {
	   Options.URLson5 = 'http://koc-bao.com/sounds/chucho.ogg';
	   ById('togURL1').value='http://koc-bao.com/sounds/chucho.ogg';
           saveOptions();
	}, false);
	ById("BODefURL2").addEventListener ('click', function () {
		   Options.URLson6 = 'http://koc-bao.com/sounds/allianceattack.ogg';
		   ById('togURL2').value='http://koc-bao.com/sounds/allianceattack.ogg';
	           saveOptions();
	}, false);
	ById("BODefURL4").addEventListener ('click', function () {
			   Options.URLson7 = 'http://koc-bao.com/sounds/alliancescout.ogg';
			   ById('togURL4').value='http://koc-bao.com/sounds/alliancescout.ogg';
		           saveOptions();
	}, false);

	ById('optHauteurBoite').addEventListener ('change', function () {
	     var x = ById('optHauteurBoite').value;
	    if (isNaN(x) || x<600 || x>1000){
	     ById('optHauteurBoite').value = 700;
	    }
	    Options.HauteurBoite = x;
	    saveOptions();
          }, false);

        ById('optFoodHours').addEventListener ('change', function () {
            var x = ById('optFoodHours').value;
            if (isNaN(x) || x<0.01 || x>99999){
              ById('optFoodHours').value = Options.foodWarnHours;
              return;
            }
            if (Options.foodWarnHours>12) Options.foodWarnHours=12;
            Options.foodWarnHours = x;
            saveOptions();
          }, false);

        var checkbox = ById('togEnhanceMsging');
         if (Options.enhanceMsging)
           checkbox.checked = true;
         checkbox.addEventListener ('change', function (){messageNav.setEnable(ById('togEnhanceMsging').checked)}, false);

    if (parseIntNan(Options.alertConfig.hq)<=0) {
		// detection du HQ !
		var popAlert = null;
		popAlert = new CPopup('BOPopAlert', 50, 150, 400, 200, true);
		popAlert.getTopDiv().innerHTML = '<DIV align=center><h2><B>ATTENTION</B></h2></DIV>';
		var m="<div class=boStat2>VOUS N'AVEZ PAS PARAMETRE VOTRE VILLE FORTE (QG)</div>";
        var citySelect = '<SELECT id=BOalertHQ name=BOalertHQ><option value="">.....</option>';
		var couleur="";
        for (var c=0; c<Cities.numCities; c++) {
			       aCity = Cities.cities[c].id;
			       aVisuCity = Cities.cities[c].name + ' '+Cities.cities[c].x + ','+ Cities.cities[c].y+' ';
			       citySelect += '<option value=\''+ aCity +'\' '+ (Options.alertConfig.hq==aCity?'SELECTED ':'') +'>'+aVisuCity+'</option>';

		}
	    citySelect += '</select>';
		m+='<center><br><br>'+lang.Options.alertHQ+'&nbsp;'+ citySelect +'<br><br>';
		popAlert.getMainDiv().innerHTML = m;
		popAlert.show (true);
		ById('BOalertHQ').addEventListener ('change', function() {
		 Options.alertConfig.hq=ById('BOalertHQ').options[ById('BOalertHQ').selectedIndex].value;
		 saveOptions();
       }, false);
	}
   },
   	Data: {
		Options: {},
		GlobalOptions: {},
		AttackOptions: {},
		upgradeData: {},
		DashboardOptions: {},

		TrainOptions: {},
		ThroneOptions: {},

		ApothecaryOptions: {},

   		CrestOptions: {},

   		Colors: {},

   		FarmOptions: {},

   	},
   	doExport: function (){
	         var t = Tabs.Options;
	         var serverID = getServerId();
	         t.Data = {};
	         if (ById("BOExport1").checked)t.Data.Options = Options;
	         if (ById("BOExport2").checked)t.Data.GlobalOptions = GlobalOptions;
	         if (ById("BOExport3").checked)t.Data.AttackOptions = AttackOptions;

	         if (ById("BOExport4").checked)t.Data.upgradeData = upgradeData;
	         if (ById("BOExport5").checked)t.Data.salvageData = salvageData;
	         if (ById("BOExport6").checked)t.Data.DashboardOptions = DashboardOptions;
	         if (ById("BOExport7").checked)t.Data.TrainOptions = TrainOptions;

	         if (ById("BOExport8").checked)t.Data.ThroneOptions = ThroneOptions;
	         if (ById("BOExport9").checked)t.Data.ApothecaryOptions = ApothecaryOptions;
	         if (ById("BOExport10").checked) t.Data.FarmOptions = FarmOptions;

	         if (ById("BOExport11").checked)t.Data.CrestOptions = CrestData;
	         if (ById("BOExport12").checked)t.Data.Colors = Colors;

			 if (ById("BOExport13").checked)t.Data.reapproState = Tabs.TranspAuto.reapproState;
			 if (ById("BOExport14").checked)t.Data.tradeRoutes = Tabs.TranspAuto.tradeRoutes;
			 if (ById("BOExport14").checked)t.Data.traderState = Tabs.TranspAuto.traderState;
			 if (ById("BOExport15").checked)t.Data.reassignRoutes = Tabs.Reassign.reassignRoutes;
			 if (ById("BOExport15").checked)t.Data.reassignState = Tabs.Reassign.reassignState;


	         ById('BOImportData').value = JSON2.stringify(t.Data);
	         ById('BOImportData').select();
    },
   	doImport: function (){
         var t = Tabs.Options;
         var serverID = getServerId();
         t.Data = { Options: {},GlobalOptions: {},AttackOptions: {},upgradeData: {},DashboardOptions: {},TrainOptions: {},ThroneOptions: {},ApothecaryOptions: {},CrestOptions: {},Colors: {},FarmOptions: {},};
         var Data = JSON2.parse(ById('BOImportData').value);
         if (Data.Options) {
			 Options = Data.Options;
        	 saveOptions();
		 }
         if (Data.GlobalOptions)  {
			GlobalOptions = Data.GlobalOptions;
        	GM_setValue ('Options_??', JSON2.stringify(GlobalOptions));
		 }
		if (Data.AttackOptions) {
			AttackOptions = Data.AttackOptions;
			saveAttackOptions ();
		}
		if (Data.upgradeData) {
			upgradeData = Data.upgradeData;
	    	saveUpgradeData ();
		}
		if (Data.salvageData) {
			salvageData = Data.salvageData;
			saveSalvageData ();
		}
		if (Data.reapproState) {
			Tabs.TranspAuto.reapproState = Data.reapproState;
			Tabs.TranspAuto.saveReapproState();
		}
		if (Data.tradeRoutes) {
			Tabs.TranspAuto.tradeRoutes = Data.tradeRoutes;
			Tabs.TranspAuto.saveTradeRoutes();
		}
		if (Data.traderState) {
			Tabs.TranspAuto.traderState = Data.traderState;
			Tabs.TranspAuto.saveTraderState();
		}
		if (Data.reassignRoutes) {
			Tabs.Reassign.reassignRoutes = Data.reassignRoutes;
			Tabs.Reassign.saveReassignRoutes();
		}
		if (Data.reassignState) {
			Tabs.Reassign.reassignState = Data.reassignState;
			Tabs.Reassign.saveReassignState();
		}
		if (Data.DashboardOptions) {
			DashboardOptions = Data.DashboardOptions;
			saveDashboardOptions ();
		}
		if (Data.TrainOptions) {
			TrainOptions = Data.TrainOptions;
			saveTrainingOptions();
		}
		if (Data.ThroneOptions) {
			ThroneOptions = Data.ThroneOptions;
			saveThroneOptions();
		}
		if (Data.ApothecaryOptions) {
			ApothecaryOptions = Data.ApothecaryOptions;
			saveApothecaryOptions ();
		}
		if (Data.FarmOptions) {
		 	FarmOptions = Data.FarmOptions;
		 	saveFarmOptions();
		}
		if (Data.Colors) {
			Colors = Data.Colors;
			saveColors ()
		}
		if (Data.CrestOptions) {
			CrestData = Data.CrestOptions;
			saveCrestData();
		}

        reloadKOC();
       },

   loadSalvageData: function(){
      var domainId=$("#BOLoadDomain").val();
      s = GM_getValue ('SalvageDataMM2_'+ domainId);
      if (s==null) {
           alert("Unable to find data from domain: " + domainId);
           return;
      }
      if (s != null){
           opts = JSON2.parse (s);
           for (k in opts){
               if (matTypeof(opts[k]) == 'object')
                   for (kk in opts[k])
                       salvageData[k][kk] = opts[k][kk];
               else
                   salvageData[k] = opts[k];
           }
       }
       for (k in salvageData.ruleSet)
       {
           var r = salvageData.ruleSet[k];
           var rule = new Rule(r.type, r.faction, r.conditions);
           for (j in rule.conditions)
           {
               rule.conditions[j].checkCondition = checkCondition;
           }
           salvageData.ruleSet[k] = rule;
       }
       // turn off and Reload
       salvageData.salvageActive = false;
       //clearInterval(Tabs.Throne.sTimer);
       saveSalvageData();
       alert('Salvage settings loaded from domain ' + domainId);
       reloadKOC();
   },
   EmoClick: function(what) {
     ById ("mod_comm_input").value += " " + what + " ";
   },
   EmoHelp : function (){
   	var t = Tabs.Options;
       	uW.BOEmoClick = t.EmoClick;
           var helpText = '<DIV style="max-height:430px; height:430px; overflow-y:auto">';
           helpText += '<TABLE width=98% cellspacing=0 cellpadding=2 border=0 bordercolor=black class=ptTab><tr>';
           var row=0;
           for (k in Smileys) {
            helpText += '<TR><TD><img class=emoicon src=\"'+Smileys[k]+'\" onclick="BOEmoClick(\''+k+'\')"></td><TD><font size=1>'+k+'</td></tr>';
           }
           helpText += '</table></div>';

       var inputtext=ById('mod_comm_input');
       var pop = new CPopup ('EmoHelp', 0, 0, 115, 475, true);
       pop.getMainDiv().innerHTML = helpText;
       pop.getTopDiv().innerHTML = '<CENTER><B><i>Smileys</b></center>';
       pop.show (true);

        ById("EmoHelp_outer").style.top = (getOffset(inputtext).top+30) +'px';
       ById("EmoHelp_outer").style.left = (getOffset(inputtext).left+230) +'px';
  },
  VIPHelp : function (){
     	var t = Tabs.Options;
     		uW.BOEmoClick = t.EmoClick;
        var helpText = '<DIV style="max-height:230px; height:230px; overflow-y:auto">';
        helpText += '<TABLE width=98% cellspacing=0 cellpadding=2 border=0 bordercolor=black class=ptTab><tr>';
        var row=0;
        for (k in SmileysVIP) {
              helpText += '<TR><TD><img class=emoicon src=\"'+SmileysVIP[k][0]+'\" onclick="BOEmoClick(\''+k+'\')"></td><TD><font size=1>'+k+'</td></tr>';
        }
        helpText += '</table></div>';

         var inputtext=ById('mod_comm_input');
         var pop = new CPopup ('VIPHelp', 0, 0, 115, 270, true);
         pop.getMainDiv().innerHTML = helpText;
         pop.getTopDiv().innerHTML = '<CENTER><B><i>Smileys</b></center>';
         pop.show (true);

          ById("VIPHelp_outer").style.top = (getOffset(inputtext).top+30) +'px';
         ById("VIPHelp_outer").style.left = (getOffset(inputtext).left+230) +'px';
  },
   e_wideChanged : function (){
       GlobalOptions.pbWideScreen = true;
       GM_setValue ('Options_??', JSON2.stringify(GlobalOptions));
   },
   hide : function (){
   },
    e_volChanged : function (val){
      var t = Tabs.Options;
      ById('boVolOut').innerHTML = parseInt(val*100);
      Options.alertSound.volume = parseInt(val*100);
      t.mss.set('volume', Options.alertSound.volume/100);
    },
    togOpt : function (checkboxId, optionName, callOnChange){
      var t = Tabs.Options;
      var checkbox = ById(checkboxId);
      if (Options[optionName])
        checkbox.checked = true;
      checkbox.addEventListener ('change', eventHandler, false);
      function eventHandler (){
        Options[optionName] = this.checked;
        saveOptions();
        if (callOnChange)
          callOnChange (this.checked);

      }
    },
    changeOpt : function (valueId, optionName, callOnChange){
      var t = Tabs.Options;
      var e = ById(valueId);
      e.value = Options[optionName];
      e.addEventListener ('change', eventHandler, false);
      function eventHandler (){
        Options[optionName] = this.value;
        saveOptions();
        if (callOnChange)
          callOnChange (this.value);
      }
    },
    e_watchChanged : function (){
      GlobalOptions.pbWatchdog = ById('boWatchEnable').checked;
      GM_setValue ('Options_??', JSON2.stringify(GlobalOptions));
    },
    e_alertOptChanged : function (){
      	Options.alertConfig.aChat = ById('pcalertEnable').checked;
      	Options.alertConfig.aPrefix=ById('pcalertPrefix').value;
      	Options.alertConfig.scouting=ById('pcalertScout').checked;
      	Options.alertConfig.wilds=ById('pcalertWild').checked;
      	Options.alertConfig.MonQG=ById('pcalertQG').checked;
 	Options.alertConfig.embassy=ById('pcalertEmbassy').checked;
 	Options.alertConfig.empennage=ById('pcalertEmpennage').checked;
 	Options.alertConfig.marechal=ById('pcalertMarechal').checked;
 	Options.alertConfig.defBoost=ById('pcalertdefBoost').checked;
  	Options.alertConfig.mytroops=ById('pcalertMytroops').checked;
  	Options.alertConfig.food=ById('pcalertFood').checked;
  	Options.alertConfig.defense=ById('pcalertDefense').checked;
  	Options.alertConfig.defence=ById('pbalertDefend').checked;
    	Options.alertConfig.hq=ById('pcalertHQ').options[ById('pcalertHQ').selectedIndex].value;
  	Options.alertConfig.sendEmail=ById('pcalertSendEmail').checked;
  	Options.alertConfig.emailAddress=ById('pcalertEmailAddress').value;
  	Options.alertConfig.token=ById('pcalertToken').value;
  	Options.alertConfig.sendasWhisper=ById('pcalertSendAsWhisper').checked;
  	Options.alertConfig.sendtoAlly=ById('pcalertSendToAlly').checked;
        Options.alertConfig.raid=ById('BOalertraid').checked;
        Options.alertConfig.appro=ById('BOalertappro').checked;
        Options.alertConfig.autofo=ById('BOalertautofo').checked;
        Options.alertConfig.autots=ById('BOalertautots').checked;
        Options.alertConfig.autoform=ById('BOalertautoform').checked;
        Options.alertConfig.TroneRange=ById('pcalertTroneRange').checked;
        Options.alertConfig.TroneRangeDebuff=ById('pcalertTroneRangeDebuff').checked;
        Options.alertConfig.TroneCombatSpeed=ById('pcalertTroneCombatSpeed').checked;
        Options.alertConfig.TroneLife=ById('pcalertTroneLife').checked;
        Options.alertConfig.TroneLoadDebuff=ById('pcalertTroneLoadDebuff').checked;
        Options.alertConfig.Atkpreset=ById('BOalertAtkpreset').checked;
        Options.alertConfig.AtkReturnpreset=ById('BOalertAtkReturnpreset').checked;
        if (Options.alertConfig.Atkpreset)
				  			  updatebotbutton("Preset - ON", 'boautoPreset');
				  			else
		  			  updatebotbutton("Preset - OFF", 'boautoPreset');
        Options.alertConfig.HDefpreset=ById("BOalertHDefpreset").checked;
      var mt = parseInt(ById('pcalertTroops').value);
      if (mt<1 || mt>1000000){
        ById('pcalertTroops').value = Options.alertConfig.minTroops;
        ById('pcalerterr').innerHTML = '<font color=#600000><B>INVALID</b></font>';
        setTimeout (function (){ById('pcalerterr').innerHTML =''}, 2000);
        return;
      }
      Options.alertConfig.minTroops = mt;
            var mt = parseInt(ById('pcalertTroops2').value);
      if (mt<1 || mt>1000000){
        ById('pcalertTroops2').value = Options.alertConfig.minTroops2;
        ById('pcalerterr').innerHTML = '<font color=#600000><B>INVALID</b></font>';
        setTimeout (function (){ById('pcalerterr').innerHTML =''}, 2000);
        return;
      }
      Options.alertConfig.minTroops2 = mt;
      saveOptions();
  },
}


var DispReport = {
  	  init : function (){
  	    var t = DispReport;
  	    t.modal_InboxFunc = new CalterUwFunc ('modal_messages_listshow', [['msghtml.join("");', 'msghtml.join("");dispInbox_hook(rslt,boxType,msghtml);']]);
  	    uW.dispInbox_hook = t.ModalInboxHook;
  	    t.modal_InboxFunc.setEnable (Options.enhancedinbox);
  	  },
  	  setEnable : function (tf){
  	    var t = DispReport;
 	    t.modal_InboxFunc.setEnable (tf);
 	  },
  	  isDispReportAvailable : function (){
  	    var t = DispReport;
  	    return t.modal_InboxFunc.isAvailable();
  	  },
 	  ModalInboxHook : function (rslt,boxType,msghtml){
 	    var t = DispReport;
  	    if(boxType == 'inbox'){
  			msgBody = ById('modal_msg_list').parentNode.childNodes[0];
  			if (!ById("BODelete")) {
  			var a = document.createElement('a');
 				a.className='buttonDown20';
 				a.id="BODelete";
 				a.innerHTML='<span>'+lang.General.delGift+'</span>';
 				a.style.float = 'left';
 				a.style.left = '60px';
  				a.addEventListener('click', function() {

  				  t.checkinbox();
  				 }, false);
  			var div = document.createElement('div');
  			div.appendChild(a);
  			msgBody.appendChild(div);
  			}
  			if (!ById("BODelete2")) {
			  			var a = document.createElement('a');
			 				a.className='buttonDown20';
			 				a.id="BODelete2";
			 				a.innerHTML='<span>'+lang.General.delRpt+'</span>';
			 				a.style.float = 'left';
			 				a.style.left = '60px';
			  				a.addEventListener('click', function() {
							  ById("BODelete2").style.display="none";
			  				  DeleteReports.startdeletereports();
			  				  setTimeout(function() { uW.Messages.listReports();ById("BODelete2").style.display="block"; },5000);
			  				 }, false);
			  			var div = document.createElement('div');
			  			div.appendChild(a);
			  			msgBody.appendChild(div);
  			}
  			if (!ById("BODelete3")) {
						  			var a = document.createElement('a');
						 				a.className='buttonDown20';
						 				a.id="BODelete3";
						 				a.innerHTML='<span>'+lang.General.delUpgrade+'</span>';
						 				a.style.float = 'left';
						 				a.style.left = '60px';
						  				a.addEventListener('click', function() {
										   t.checkinbox2();
						  				 }, false);
						  			var div = document.createElement('div');
						  			div.appendChild(a);
						  			msgBody.appendChild(div);
  			}
 		}
  	  },
  	  checkinbox : function(){
  	    var t = DispReport;
  	    var body = ById('tbl_messages');
  	    var trs=body.getElementsByTagName('tr');
  	    var reports = [];
  		for(var i=0; i<trs.length; i++){
  			var tds = trs[i].getElementsByTagName('td');
  			for(var j=0; j<tds.length; j++){
  				if(tds[j].className == 'chkcol'){
 					var checkbox = tds[j];
  				}
  				if(tds[j].className == 'nmcol'){
 					var sender = tds[j];
 				}
  				if(tds[j].className == 'subjcol'){
  					var subject = tds[j];
  				}
 			}
  			reports.push({checkbox:checkbox,sender:sender,subject:subject});
  		}
 		t.parseGiftReport(reports);
 	  },
 	  parseGiftReport : function(rpts){
 	    var t = DispReport;
 	    for(var i=0; i<rpts.length; i++){
  			if((rpts[i].subject.innerHTML.indexOf('Nouveaux Cadeaux') >= 0 || rpts[i].subject.innerHTML.indexOf('New Gift Received!') >= 0 || rpts[i].subject.innerHTML.indexOf('Neues Geschenk erhalten!') >= 0 ||	rpts[i].subject.innerHTML.indexOf('Nuovo Regalo ricevuto') >= 0 || rpts[i].subject.innerHTML.indexOf('Nuovo Regalo ricevuto')) && rpts[i].sender.innerHTML.indexOf('Kingdoms Of Camelot') >= 0){
 				rpts[i].checkbox.firstChild.checked = true;
 			}
 		}
 	   uW.messages_action("delete","tbl_messages");
 	  },
 	  checkinbox2 : function(){
	    	    var t = DispReport;

	    	    var body = ById('tbl_messages');
	    	    var trs=body.getElementsByTagName('tr');
	    	    var reports = [];
	    		for(var i=0; i<trs.length; i++){
	    			var tds = trs[i].getElementsByTagName('td');
	    			for(var j=0; j<tds.length; j++){
	    				if(tds[j].className == 'chkcol'){
	   					var checkbox = tds[j];
	    				}
	    				if(tds[j].className == 'nmcol'){
	   					var sender = tds[j];
	   				}
	    				if(tds[j].className == 'subjcol'){
	    					var subject = tds[j];
	    				}
	   			}
	    			reports.push({checkbox:checkbox,sender:sender,subject:subject});
	    		}
	   		t.parseGiftReport2(reports);
	   	  },
	   	  parseGiftReport2 : function(rpts){
	   	    var t = DispReport;
	   	    for(var i=0; i<rpts.length; i++){
	    			if (rpts[i].subject.innerHTML.indexOf(lang.AUTOTRONE.upgrade.mptitleupgrade) >= 0 || rpts[i].subject.innerHTML.indexOf(lang.AUTOTRONE.upgrade.mptitleenhance) >= 0){
	   				  rpts[i].checkbox.firstChild.checked = true;
	   			}
	   		}
	   	   uW.messages_action("delete","tbl_messages");
 	  },
  	}

Tabs.about = {
  tabOrder : 100,
  tabLabel : "SUPPORT",
  tabDisabled : false,
  myDiv : null,
  timer : null,

  init : function (div){
    var t = Tabs.about;
    t.myDiv = div;

    var  m = '<DIV style="height:'+(Options.HauteurBoite-30)+'px; max-height:'+(Options.HauteurBoite-30)+'px; overflow-y:auto"> <DIV class=boStat>'+lang.Options.welcome+' -Boite &agrave; Outils- Version '+Version+' </DIV><br>';
    m=m+'<font size=2><SPAN class=oohfancy><font size=6>BeWorld</font></span><br><bR>'+lang.Options.credits+'<br><hr><br><u><b>Le site <a href=http://www.koc-bao.com/ target=_blank>BAO-KOC.com</a> &agrave; votre service !</b></u><br><br>';
    m=m+"- Pensez &agrave; visiter la rubrique FAQ du forum.<br>- un groupe <a href=https://www.facebook.com/groups/142657062507166/ target=_blank>facebook</a> est &agrave votre disposition egalement.<br><hr><br><u><b>Les options de la boite a outils :</b></u><br><br>";
    m=m+"- Avatar personnalis&eacute; visible par tous : <a href=http://www.koc-bao.com/phpBB3/viewtopic.php?f=16&t=1265 target=_blanc>Plus d'information ici</a><br><br>";
    m=m+"- R&eacute;ception par Email vos alertes (attaques entrantes), TESTEZ MAINTENANT ! : <a href=http://www.koc-bao.com/phpBB3/viewtopic.php?f=16&t=1555 target=_blank>Plus d'information ici</a><br><br>";
    m=m+'<br><hr><br><center><font size=3><b><u>Supportez le developpement de la boite : </u></b>(Faites un don, meme 1 euro ^^)<br><i>Visitez mon site et cliquez sur les publicit&eacute;s &eacute;galement pour me supporter.<br><br><center><form method="post" target="_blank" action="https://www.paypal.com/cgi-bin/webscr">\
<input type="hidden" value="_s-xclick" name="cmd"><input type="hidden" value="H6DTPUY7972Z6" name="hosted_button_id">\
<input type="image" border="0" alt="PayPal - la solution de paiement en ligne la plus simple et la plus s?curis?e !" name="submit" style="border:0px;" src="https://www.paypalobjects.com/fr_FR/FR/i/btn/btn_donate_LG.gif">\
<img width="1" height="1" border="0" src="https://www.paypalobjects.com/fr_FR/i/scr/pixel.gif" alt=""></form></font></center>';
    m=m+'</div>';
    t.myDiv.innerHTML = m;
  },
  hide : function (){
  },

  show : function (){
    var t = Tabs.about;

  },
}
Tabs.perso = {
  tabOrder : 98,
  tabLabel : Options.NewTabName,
  tabDisabled : !Options.NewTab,
  myDiv : null,
  timer : null,

  init : function (div){
    var t = Tabs.perso;
    t.myDiv = div;
    var monsite="";
    var num=Math.random();
    if (num>0.90) { monsite="http://www.koc-bao.com";}
    t.myDiv.innerHTML = '<CENTER><iframe src="'+monsite+'" width="950" height="'+(Options.HauteurBoite-30)+'" id="BOFrame" border=0></iframe><BR></center>';
  },

  hide : function (){
  },

  show : function (){
    var t = Tabs.perso;
   $("#BOFrame").attr("src", Options.NewTabURL);
  },
}
Tabs.perso2 = {
  tabOrder : 99,
  tabLabel : Options.NewTabName2,
  tabDisabled : !Options.NewTab2,
  myDiv : null,
  timer : null,

  init : function (div){
    var t = Tabs.perso;
    t.myDiv = div;
    t.myDiv.innerHTML = '<CENTER><iframe src="" width="950" height="'+(Options.HauteurBoite-30)+'" id="BOFrame2" border=0 ></iframe><BR></center>';

  },

  hide : function (){
  },

  show : function (){
    var t = Tabs.perso;
    $("#BOFrame2").attr("src", Options.NewTabURL2);
  },
}
/********************************* Auto Dark Forest ***********************************/
Tabs.autoFO = {
  tabLabel: lang.BoiteLabelFO,
  tabOrder : 12,
  tabDisabled : false,  myDiv : null,  MapAjax : new CMapAjax(),
  popFirst : true,  opt : {},  nextattack : null,  searchRunning : false,  tilesSearched : 0,  tilesFound : 0,
  curX : 0, curY : 0,  lastX : 0,  firstX : 0,  firstY : 0,  lastY : 0,  rallypointlevel:0,
  knt:{},  barbArray:{},  lookup:1,  city:0,  deleting:false,
  init : function (div){
    var t = Tabs.autoFO;
    t.myDiv = div;
    if (Options.BORac_Dar) AddSubTabLink(lang.autofo.button, t.toggleBarbState, 'pbautofstab');
    var m = '<DIV id=pbTowrtDivF class=boStat>'+lang.autofo.title+' - <input type=button value="?" id=boaideautofo class=boAide></div><TABLE width=100% height=0% class=pbTab><TR align="center">';
	if (Options.AttackRunning == false) {
	       m += '<TD><INPUT id=AttSearch type=button  class=pbButton  value="'+lang.autofo.attack+' = OFF"></td>';
	       if (Options.BORac_Dar) updatebotbutton(lang.autofo.button+" - OFF", 'pbautofstab');
	   } else {
	       m += '<TD><INPUT id=AttSearch type=button  class=pbButton value="'+lang.autofo.attack+' = ON"></td>';
	       if (Options.BORac_Dar) updatebotbutton(lang.autofo.button+" - ON", 'pbautofstab');
	   }
	  m += '<TD><INPUT id=BODFShow type=button class=pbButton value="Show FO/DF">&nbsp</td>';
	  m += '<TD><INPUT id=Options type=button  class=pbButton  value="'+lang.autofo.options+'"></td>';
	  m += '</tr></table></div>';
	  m += '<DIV id=pbTraderDivD class=boStat>'+lang.autofo.title2+'</div>';
	  m += '<TABLE id=pbbarbstats width=100% height=0% class=pbTab><TR align="left"><TR>';
	  for(i=0;i<Seed.cities.length;i++){
	  		m += '<TD>' + Seed.cities[i][1] +'</td>';
	  }
	  m+='</tr><TR>';
	  for(i=0;i<Seed.cities.length;i++){
	  		m += '<TD><DIV><span id='+ 'pdtotalcity' + i +'></span></div></td>';
	  }
	  m+='</tr><TR>';
	  for(i=0;i<Seed.cities.length;i++){
	  		m += '<TD><DIV><span id='+ 'pddatacity' + i +'></span></div></td>';
	  }
	  m+='</tr><TR>'
	   for(i=0;i<Seed.cities.length;i++){
	  		m += '<TD><DIV><span id='+ 'pddataarray' + i +'></span></div></td>';
	 }
	 m+='</tr></table><TABLE id=pbbarbstats width=100% height=0% class=pbTab><TR align="center"><TR>';
	 for (i=0;i<=7;i++) {
	 	m+='<TD><DIV><span id='+ 'pberror' + i +'></span></div></td>';
     }
     m+='</tr></table>';
     m += '<DIV id=pbTraderDivD class=boStat>'+lang.autofo.title3+'</div>';
     m += '<TABLE width=100% height=0% class=ptTab><TR align="center"><td></td>';
     for (w=1;w<=10;w++) m += '<TD>'+lang.autofo.lvl+':'+w+'';
     for(i=0;i<Seed.cities.length;i++){
        m += '<TR><TD>' + Seed.cities[i][1] +'</td>';
        for (w=1;w<=10;w++){
           m += '<TD class=pblevelopt align="center"><INPUT id=pbcity'+i+'level'+w+' type=checkbox unchecked=true></td>';
        }
     }


  m+='</table>';
   m+= '<DIV id=pbTraderDivD class=boStat>'+lang.autofo.pbTraderDivD+'</div><TABLE><TR>';
  	m+='<TD></td>';
  	 var r=0;
  	 for (y in uW.unitcost) {
  		r++;
  		if (r>17) break;
  		m+='<TD align=center><img height=20 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg></td>';
  	 }
  	 m+='<TD align=center>Min '+lang.autofo.dist+'</td><TD>Max '+lang.autofo.dist+'</td>';
  	 for(i=0;i<10;i++){
  	 	m += '<TR><TD>'+lang.autofo.lvl+' '+(i+1)+'</td>';
  	 	var j=0;
  			for (y in uW.unitcost) {
  				j++;
  				if (j>17) break;
  	 		m += '<TD><INPUT id="level'+i+'troop'+j+'" type=text size=4 maxlength=6 value="'+parseIntNan(AttackOptions.Troops[i+1][j])+'" /></td>';
  	 	}
  		m+='<TD align=left><INPUT id=Mindist'+i+' type=text size=2 maxlength=3 value="'+parseIntNan(AttackOptions.MinDistance[i+1])+'"</td>';
  	 	m+='<TD align=right><INPUT id=dist'+i+' type=text size=2 maxlength=3 value="'+parseIntNan(AttackOptions.Distance[i+1])+'"</td>';
  	 	m+='</tr>';
  	 }
	 m+='</table>';


  m+='<br>' + pubdusite;
  t.myDiv.innerHTML = m;
  t.checkBarbData();
  for(i=0;i<Seed.cities.length;i++){
		var element = 'pdtotalcity'+i;
		if (t.barbArray[i+1] == undefined) ById(element).innerHTML = lang.autofo.nodata;
		else ById(element).innerHTML =  'Forets:' + t.barbArray[i+1].length;
    }
  for(i=0;i<Seed.cities.length;i++){
		for (w=1;w<=10;w++){
			ById('pbcity'+i+'level'+w).checked = AttackOptions.Levels[i+1][w];
		}
    }
   ById('AttSearch').addEventListener('click', function(){t.toggleBarbState(this)} , false);
   ById('BODFShow').addEventListener('click', function(){t.ShowDFArray()} , false);
   ById('boaideautofo').addEventListener('click', function(){
	 window.open(sitesupport+"?page=aide_autofo");
	} , false);

	ById('Options').addEventListener('click', t.barbOptions , false);
    var element_class = document.getElementsByClassName('pblevelopt');
    for (k=0;k<element_class.length;k++){
    	element_class[k].addEventListener('click', t.saveLevelOptions , false);
    }
   },

  saveLevelOptions : function(){
	  var t = Tabs.autoFO;
		for(i=0;i<Seed.cities.length;i++){
			AttackOptions.Levels[i+1][0]=false;
			for (w=1;w<=10;w++){
				var ele = ById('pbcity'+i+'level'+w);
				AttackOptions.Levels[i+1][w]=ele.checked;
				if (ele.checked)
					AttackOptions.Levels[i+1][0]=true;
			}
		}
		t.saveTroops();
   },
  ShowDFArray: function(){
		var t = Tabs.autoFO;
		var m = '<TABLE id=pbDF width=80% height=0% class=pbTab>';
		for (var i=1;i<=Seed.cities.length;i++) {
		 if (t.barbArray[i]) {
			if (t.barbArray[i].length>0){
				m+= '<TR><TD colspan=5 style=\'background: #335577;\' align=center><B><FONT color=white>' + Seed.cities[i][1] +': </font></b></td></tr>';
				for (var k in t.barbArray[i]) {
				  if (t.barbArray[i][k].dist) {
					if (t.barbArray[i][k].level>=1 && t.barbArray[i][k].level<=3) var Tlevel = 1;
					if (t.barbArray[i][k].level>=4 && t.barbArray[i][k].level<=6) var Tlevel = 4;
					if (t.barbArray[i][k].level>=7) var Tlevel = 7;
					m+='<TR><TD><a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">(' + t.barbArray[i][k].x +','+t.barbArray[i][k].y+ ')</a></td><TD width=50px><img width=50px src="'+gameurl+'img/buildings/boss_lvl'+Tlevel+'.png"></td><TD>Lvl.: '+t.barbArray[i][k].level+'</td><TD>Dist.: '+t.barbArray[i][k].dist+'</td></tr>';
			   	  }
			    }
			} }
		}
	    var pop = new CPopup ('DFArray', 0, 0, 510, 430, true);
	    pop.centerMe (mainPop.getMainDiv());
	    pop.getMainDiv().innerHTML = '<DIV style="width:500px;max-width:500px;height:390px;max-height:390px;overflow:auto">' +m+ '</div>';
	    pop.getTopDiv().innerHTML = '<CENTER><B>DF\'s Found</center>';
	    pop.show (true);

	},
  barbOptions: function(){
  	 var t = Tabs.autoFO;
  	 if(t.barboptions == null)
	 t.barboptions = new CPopup ('pbbarboptions', 0,0, 375,350, true);
  	 t.barboptions.centerMe (mainPop.getMainDiv());
	 t.barboptions.getTopDiv().innerHTML = '<CENTER><b>'+lang.autofo.barboptions+' '+getServerId()+'</b></CENTER>';
  	var y = '<DIV style="max-height:400px; overflow-y:auto;"><DIV class=boStat>'+lang.autofo.barb1+'</div><TABLE width=100%>';
	   y +='<TR><TD style="margin-top:5px; text-align:center;"><INPUT id=pbresetbarbs tclass=pbButton type=submit value="'+lang.General.delete+'"></td>';
	   y +='<TD style="margin-top:5px; text-align:center;"><INPUT id=pbpaintbarbs class=pbButton  type=submit value="'+lang.General.edit+'"></td>';
	   y += '<TD><SELECT id=pbcity type=list></td></tr></table>';
	   y +='<TD style="margin-top:5px; text-align:center;"><DIV class=boStat> OPTIONS </div></td><TABLE>';
     y +='<TR><TD>'+lang.autofo.pbsendint+' <INPUT id=pbsendint type=text size=4 maxlength=4 value='+ AttackOptions.SendInterval +' \> '+lang.General.secs+'</td></tr>';
     y +='<TR><TD>'+lang.autofo.pbmaxdist+' <INPUT id=pbmaxdist type=text size=4 maxlength=4 value='+ AttackOptions.MaxDistance +' \></td></tr>';
     y +='<TR><TD>'+lang.autofo.rallyclip+' <INPUT id=rallyclip type=text size=1 maxlength=2 value="'+AttackOptions.RallyClip+'" \> '+lang.autofo.rallyclip1+'</td></tr>';
     y +='<TR><TD><INPUT id=pbreport type=checkbox '+(AttackOptions.UpdateEnabled?'CHECKED':'')+'\> '+lang.autofo.pbreport+' <INPUT id=pbmsgint type=text size=3 maxlength=3 value='+AttackOptions.UpdateInterval+' \> '+lang.General.mins+'</td></tr>';
     y +='<TR><TD>'+lang.autofo.barbstopsearch+' <INPUT id=barbstopsearch type=text size=4 value='+AttackOptions.stopsearch+' \> '+lang.autofo.barbstopsearch1+'</td></tr>';
     y +='<TR><TD>'+lang.autofo.pbmethod+' '+htmlSelector({distance:lang.autofo.pbmethod1, level:lang.autofo.pbmethod2, lowlevel:lang.autofo.pbmethod3}, AttackOptions.Method, 'id=pbmethod')+'</td></tr>';
     var yy = htmlSelector({0:lang.autofo.barbknight1, 1:lang.autofo.barbknight2, 2:lang.autofo.barbknightLowPol, 3:lang.autofo.barbknightHighPol, 4:lang.autofo.barbknightLowInt, 5:lang.autofo.barbknightHighInt, 6:lang.autofo.barbknightLowRes, 7:lang.autofo.barbknightHighRes, 8:lang.autofo.barbknightLowSum, 9:lang.autofo.barbknightHighSum}, AttackOptions.knightselector, 'id=barbknight');
	 y +='<TR><TD>'+lang.autofo.barbknight+' '+yy+'</td></tr>';
     y+='<tr><td>'+lang.autofo.reset+' <input type=button value="'+lang.autofo.raz+'" id=BO_FO_razCompteur class=pbButton></table></td></tr></table>';
	   t.barboptions.getMainDiv().innerHTML = y;
	   t.barboptions.show(true);

	ById('BO_FO_razCompteur').addEventListener('click', function(){
	 AttackOptions.BarbsFailedTraffic=0;
	 AttackOptions.BarbsFailedKnight=0;
	 AttackOptions.BarbsFailedVaria=0;
	 AttackOptions.BarbsFailedMarais=0;
	 AttackOptions.BarbsFailedRP=0;
	 AttackOptions.BarbsFailedBog=0;
	 AttackOptions.BarbsTried=0;
	 for (var city=0;city<Seed.cities.length;city++)
	  AttackOptions.BarbsDone[city]=0;

	 saveAttackOptions();
	},false);
	ById('pbcity').options.length=0;
	for (i=0;i<Seed.cities.length;i++){
		var o = document.createElement("option");
		o.text = Seed.cities[i][1]
		o.value = i+1;
		ById("pbcity").options.add(o);
	}

	ById('pbpaintbarbs').addEventListener('click', function(){
	   t.showBarbs(ById("pbcity").value,Seed.cities[ById("pbcity").value -1][1]);
        },false);
	ById('pbresetbarbs').addEventListener('click', t.deletebarbs,false);
	ById('pbmethod').addEventListener('change', function(){
		AttackOptions.Method=ById('pbmethod').value;
		saveAttackOptions();
		t.checkBarbData();
	},false);
	ById('barbknight').addEventListener('change', function(){
		AttackOptions.knightselector=ById('barbknight').value;
		saveAttackOptions();
	},false);
	ById('pbreport').addEventListener('change', function(){
		AttackOptions.UpdateEnabled=ById('pbreport').checked;
		saveAttackOptions();
	},false);
	ById('pbmsgint').addEventListener('change', function(){
	        if (parseInt(ById('pbmsgint').value)<15) ById('pbmsgint').value=15;
		AttackOptions.UpdateInterval=parseInt(ById('pbmsgint').value);
		saveAttackOptions();
	},false);
    ById('pbsendint').addEventListener('change', function(){
		if(parseInt(ById('pbsendint').value) <5)
			ById('pbsendint').value = 5;
		AttackOptions.SendInterval=parseInt(ById('pbsendint').value);
		saveAttackOptions();
	},false);
    ById('pbmaxdist').addEventListener('change', function(){
		if(parseInt(ById('pbmaxdist').value) > 150)
			ById('pbmaxdist').value = 150;
		AttackOptions.MaxDistance=parseInt(ById('pbmaxdist').value);
		saveAttackOptions();
	},false);
    ById('rallyclip').addEventListener('change', function(){
		AttackOptions.RallyClip=parseInt(ById('rallyclip').value);
		saveAttackOptions();
	},false);
    ById('barbstopsearch').addEventListener('change', function(){
		ById('barbstopsearch').value = parseInt(ById('barbstopsearch').value)>0?ById('barbstopsearch').value:1
		AttackOptions.stopsearch=parseInt(ById('barbstopsearch').value);
		saveAttackOptions();
	},false);
  },

    showBarbs: function (citynumber,cityname) {
		var t = Tabs.autoFO;
		var popTradeRoutes = null;
		t.popTradeRoutes = new CPopup('pbShowBarbs', 0, 0, 500, 500, true, function() {clearTimeout (1000);});
		var m = '<DIV style="max-height:460px; height:460px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbShowBarbs" id="pbBars">';
		t.popTradeRoutes.getMainDiv().innerHTML = '</table></div>' + m;
		t.popTradeRoutes.getTopDiv().innerHTML = '<TD><B>'+lang.autofo.popTradeRoutes+' '+cityname+'</td>';
		t.popTradeRoutes.centerMe (mainPop.getMainDiv());
		t.paintBarbs(citynumber,cityname);
		t._addTabHeader(citynumber,cityname);
		t.popTradeRoutes.show(true)	;
	 },
  	paintBarbs: function(i,cityname){
	        var t = Tabs.autoFO;
				for (k=(t.barbArray[i].length-1);k>=0;k--){t._addTab(i,cityname,k+1,t.barbArray[i][k]['x'], t.barbArray[i][k]['y'],t.barbArray[i][k]['dist'], t.barbArray[i][k]['level']);}
	    },

  _addTab: function(citynumber,cityname,queueId,X,Y,dist,level){
	 var t = Tabs.autoFO;
	 var row = ById('pbBars').insertRow(0);
	 row.vAlign = 'top';
	 row.insertCell(0).innerHTML = queueId;
	 row.insertCell(1).innerHTML = '<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+X+','+Y+')</a>';
	 row.insertCell(2).innerHTML = '';
	 row.insertCell(3).innerHTML = dist;
	 row.insertCell(4).innerHTML = level;
	 row.insertCell(5).innerHTML = '<a class="button20" id="barbdel_' + queueId + '"><span>'+lang.General.delete+'</span></a>';
	 ById('barbdel_' + queueId).addEventListener('click', function(){
		t.deleteBarbElement(citynumber,queueId,cityname, true);
	 }, false);
  },

  _addTabHeader: function(citynumber,cityname) {
	 var t = Tabs.autoFO;
	 var row = ById('pbBars').insertRow(0);
	 row.vAlign = 'top';
	 row.insertCell(0).innerHTML = "Order";
	 row.insertCell(1).innerHTML = "Coords";
	 row.insertCell(2).innerHTML = "";
	 row.insertCell(3).innerHTML = "Dist.";
	 row.insertCell(4).innerHTML = "Lvl";
	 row.insertCell(5).innerHTML = '<a class="button20" id="barbdelAll"><span>'+lang.General.delete+'</span></a>';
	 ById('barbdelAll').addEventListener('click', function(){
		t.deleteBarbsCity(citynumber,cityname);
	 }, false);
  },

  deleteBarbElement: function(citynumber,queueId,cityname,showFlag){
      var t = Tabs.autoFO;
      var queueId = parseInt(queueId);
      var myarray = t.barbArray[citynumber];
      if (myarray) {
        myarray.splice((queueId-1), 1);
        GM_setValue('DF_' + Seed.player.name + '_city_' + citynumber + '_' + getServerId(), JSON2.stringify(myarray));
        t.checkBarbData();
        if (showFlag) t.showBarbs(citynumber,cityname);
      }
  },
  deleteBarbsCity: function(citynumber,cityname){
      var t = Tabs.autoFO;
      var queueId = parseInt(queueId);
	  AttackOptions.Update[citynumber][1] = 0;
      GM_deleteValue('DF_' + Seed.player.name + '_city_' + citynumber + '_' + getServerId())
      t.checkBarbData();
      t.showBarbs(citynumber,cityname);
  },
  saveTroops: function(){
    for(i=0;i<10;i++){
  	 	var w=0;
		for (y in uW.unitcost) {
			w++;
 	 		if (ById('level'+i+'troop'+w)) AttackOptions.Troops[i+1][w] = parseIntNan(ById('level'+i+'troop'+w).value);
		}
	if(parseIntNan(ById('dist'+i).value) > AttackOptions.MaxDistance)
	 ById('dist'+i).value = AttackOptions.MaxDistance;
	AttackOptions.MinDistance[i+1] = parseIntNan(ById('Mindist'+i).value);
  	AttackOptions.Distance[i+1] = parseIntNan(ById('dist'+i).value);
	}
	saveAttackOptions();
  },

   deletebarbs: function(){
	   var t = Tabs.autoFO;
	for (i=1;i<=Seed.cities.length;i++){
		AttackOptions.Update[i][1] = 0;
		GM_deleteValue('DF_' + Seed.player.name + '_city_' + i + '_' + getServerId());
		t.barbArray[i] = [];
		GM_setValue('DF_' + Seed.player.name + '_city_' + i + '_' + getServerId(), JSON2.stringify(t.barbArray[i]));

	}
	saveAttackOptions();
   },

  checkBarbData: function(){
  	var t = Tabs.autoFO;
  	var valider=0;
	if(!Options.AttackRunning) return;
	for(i=0;i<Seed.cities.length;i++){
		if (AttackOptions.Levels[i+1][0]) valider=1
	}
	if (valider==0) {
	  actionLog("AutoFO","Erreur : aucun niveau de parametre");
	  		Options.AttackRunning = false;
	  		obj = ById('AttSearch');
	  		if (obj) obj.value = lang.autofo.attack+" = OFF";
	  	    if (Options.BORac_Dar) updatebotbutton(lang.autofo.button+' - OFF', 'pbautofstab');
	  		saveAttackOptions();saveOptions();
	  		clearTimeout(t.nextattack);
		t.nextattack = null;
	  return;
	}


	  for (i=1;i<=Seed.cities.length;i++){

		if (!AttackOptions.Levels[i][0]) continue;
		t.barbArray[i] = [];
	  	var myarray = JSON2.parse(GM_getValue('DF_' + Seed.player.name + '_city_' + i + '_' + getServerId(),"[]"));

		if ((myarray == undefined || myarray.length == 0) && t.searchRunning==false) {
	  		t.lookup=i;
			if(parseInt(AttackOptions.Update[t.lookup][1]) >= parseInt(AttackOptions.stopsearch)) continue; //Skip if search results are empty more than X times
			t.searchRunning = true;
	  		t.opt.startX = parseInt(Seed.cities[(i-1)][2]);
	  		t.opt.startY = parseInt(Seed.cities[(i-1)][3]);
	  		t.clickedSearch();
			//break;
	  	}
		if (myarray){
			if(AttackOptions.Method == 'distance') t.barbArray[i] = myarray.sort(function sortBarbs(a,b) {a = a['dist'];b = b['dist'];return a == b ? 0 : (a < b ? -1 : 1);});
			if(AttackOptions.Method == 'level') t.barbArray[i] = myarray.sort(function sortBarbs(a,b) {a = a['level']+a['dist'];b = b['level']+b['dist'];return a == b ? 0 : (a > b ? -1 : 1);});
			if(AttackOptions.Method == 'lowlevel') t.barbArray[i] = myarray.sort(function sortBarbs(a,b) {a = a['level']+a['dist'];b = b['level']+b['dist'];return a == b ? 0 : (a < b ? -1 : 1);});
	  		GM_setValue('DF_' + Seed.player.name + '_city_' + i + '_' + getServerId(), JSON2.stringify(t.barbArray[i]));
	  	}
		AttackOptions.Update[i][1] = 0;
		saveAttackOptions();
	  }

	  t.nextattack = setTimeout(t.getnextCity, parseInt((Math.random()*1000)+1000));
  },

  toggleBarbState: function(obj){
	var t = Tabs.autoFO;
	obj = ById('AttSearch');
	t.saveTroops();
	if (parseInt(AttackOptions.UpdateInterval)<15) AttackOptions.UpdateInterval=15;
	if (Options.AttackRunning == true) {
		Options.AttackRunning = false;
		obj.value = lang.autofo.attack+" = OFF";
	    if (Options.BORac_Dar) updatebotbutton(lang.autofo.button+' - OFF', 'pbautofstab');
		saveAttackOptions();saveOptions();
		clearTimeout(t.nextattack);
		t.nextattack = null;
	} else {
		Options.AttackRunning = true;
		obj.value = lang.autofo.attack+" = ON";
		if (Options.BORac_Dar) updatebotbutton(lang.autofo.button+' - ON', 'pbautofstab');
		saveAttackOptions();saveOptions();
		t.checkBarbData();
		t.nextattack = setTimeout(t.getnextCity, 1000);
	}
  },

  barbing : function(){
     var t = Tabs.autoFO;
     var city = t.city;
     citynumber = Seed.cities[city-1][0];
     cityID = 'city' + citynumber;
     t.rallypointlevel = March.RallyPoint(citynumber).maxSlots;
     t.getAtkKnight(citynumber);
	 var slots=0;
	 if (Seed.queue_atkp[cityID] != undefined){
	       for(var k in Seed.queue_atkp[cityID])
		    slots++;
		   if(Seed.queue_atkp[cityID].toSource() == "[]")
			slots = 0;
	} else
			slots=0;
	var element1 = 'pddatacity'+(city-1);
    ById(element1).innerHTML = 'Env: ' + AttackOptions.BarbsDone[city];
    var element2 = 'pddataarray'+(city-1);
    ById(element2).innerHTML =  'PR: (' + slots + '/' + t.rallypointlevel +')';

	if ((t.rallypointlevel-AttackOptions.RallyClip) <= slots) {
	    actionLog("AutoFO",Cities.cities[city-1].name+" - " +lang.autofo.error1);
	    return;
	}

	if (t.knt.toSource() == "[]") {
	    actionLog("AutoFO", Cities.cities[city-1].name+" - " +lang.autofo.error2);
	    return;
	   }
	   var kid = t.knt[0].ID;

	   if(t.barbArray[city].length > 0)
		var barbinfo = t.barbArray[city].shift();
		else if(parseInt(AttackOptions.Update[city][1])==0){
		if(!t.searchRunning)t.checkBarbData();
		return;
	   } else {
		return;
	  }
       var check=0;
       var barblevel = parseInt(barbinfo.level);
	 if (AttackOptions.Levels[city][barbinfo.level])
			check=1;


        var xcoord = barbinfo['x'];
        var ycoord = barbinfo['y'];
        if (barbinfo.dist < AttackOptions.MinDistance[barblevel] || barbinfo.dist > AttackOptions.Distance[barblevel]){
			check=0;
			GM_setValue('DF_' + Seed.player.name + '_city_' + city + '_' + getServerId(), JSON2.stringify(t.barbArray[city]));
			return;
		}

      // check troop levels in city
      var trps = AttackOptions.Troops[barblevel];
      var num_troops = 0;
      var r=0;
	  for (y in uW.unitcost) {
			r++;
	        if (parseIntNan(trps[r]) > Seed.units[cityID]['unt'+r]) check = 0;

	        num_troops += parseIntNan(trps[r]);
      }
      if (num_troops == 0) check = 0;

      if (parseIntNan(num_troops) > parseIntNan(March.getMaxSize(Seed.cities[city-1][0],0,0)) ) {
    	actionLog("AutoFO","Erreur taille de marche : " + parseIntNan(num_troops) + " sur " + March.getMaxSize(Seed.cities[city-1][0],0,0) + "");
		return;
	  }
      if (check == 0){
		t.barbArray[city].push(barbinfo);
		GM_setValue('DF_' + Seed.player.name + '_city_' + city + '_' + getServerId(), JSON2.stringify(t.barbArray[city]));
		actionLog("AutoFO","Erreur sur troupes niveau "+parseInt(barblevel));
		return;
	   }

	var element = 'pdtotalcity'+(city-1);
	if (t.barbArray[city] == undefined) ById(element).innerHTML = lang.autofo.nodata;
	else ById(element).innerHTML =  lang.autofo.button+':' + t.barbArray[city].length;

    var xcoord = barbinfo['x'];
    var ycoord = barbinfo['y'];


    t.doBarb(citynumber,city,xcoord,ycoord,barblevel,kid,trps);
    saveAttackOptions();
  },

  getnextCity: function(){
	var t = Tabs.autoFO;
	clearTimeout(t.nextattack);
	if (!Options.AttackRunning) return false;

	var city = t.city+1;
	if (city>Seed.cities.length){
		city=1;
	}
	t.city = city;
	if(AttackOptions.UpdateEnabled){
		var now = unixTime();
		if(now > parseInt(AttackOptions.Update[city][0] + (AttackOptions.UpdateInterval*60))){
			AttackOptions.Update[city][1]=0;
			t.barbArray[city] = [];
			GM_setValue('DF_' + Seed.player.name + '_city_' + city + '_' + getServerId(), JSON2.stringify(t.barbArray[city]));
		}
	}

	if(AttackOptions.Levels[city][0]) {
		t.barbing();
		t.nextattack = setTimeout(t.getnextCity, parseInt(AttackOptions.SendInterval)*1000);
	} else {
		t.getnextCity();
	}
  },
  getAtkKnight : function(cityID){
     var t = Tabs.autoFO;
     t.knt = new Array();
	for (k in Seed.knights['city'+cityID]){
			if (Seed.knights['city'+cityID][k]["knightStatus"] == 1 &&
					Seed.leaders['city'+cityID]["resourcefulnessKnightId"] != Seed.knights['city'+cityID][k]["knightId"] &&
					Seed.leaders['city'+cityID]["politicsKnightId"] != Seed.knights['city'+cityID][k]["knightId"] &&
					Seed.leaders['city'+cityID]["combatKnightId"] != Seed.knights['city'+cityID][k]["knightId"] &&
					Seed.leaders['city'+cityID]["intelligenceKnightId"] != Seed.knights['city'+cityID][k]["knightId"]){
				t.knt.push ({
					Name:   Seed.knights['city'+cityID][k]["knightName"],
					ID:		Seed.knights['city'+cityID][k]["knightId"],
					Combat:	parseIntNan(Seed.knights['city'+cityID][k]["combat"]),
					Politics:	parseIntNan(Seed.knights['city'+cityID][k]["politics"]),
					Intelligence:	parseIntNan(Seed.knights['city'+cityID][k]["intelligence"]),
					Resourcefulness:	parseIntNan(Seed.knights['city'+cityID][k]["resourcefulness"]),
					Experience: parseIntNan(Seed.knights['city'+cityID][k]["experience"]),
				});
			}
		}
		t.knt = t.knt.sort(function sort(a,b) {
			var ac = a['Combat'];
			var bc = b['Combat'];
			var ap = a['Politics'];
			var bp = b['Politics'];
			var ai = a['Intelligence'];
			var bi = b['Intelligence'];
			var ar = a['Resourcefulness'];
			var br = b['Resourcefulness'];
			var as = a['Experience'];
			var bs = b['Experience'];
			var type = parseIntNan(AttackOptions.knightselector);
			switch(type) {
				case 0:
					var erg = ac == bc ? 0 : (ac < bc ? -1 : 1);
					break;
				case 1:
					var erg = ac == bc ? 0 : (ac > bc ? -1 : 1);
					break;
				case 2:
					var erg = ap == bp ? 0 : (ap < bp ? -1 : 1);
					break;
				case 3:
					var erg = ap == bp ? 0 : (ap > bp ? -1 : 1);
					break;
				case 4:
					var erg = ai == bi ? 0 : (ai < bi ? -1 : 1);
					break;
				case 5:
					var erg = ai == bi ? 0 : (ai > bi ? -1 : 1);
					break;
				case 6:
					var erg = ar == br ? 0 : (ar < br ? -1 : 1);
					break;
				case 7:
					var erg = ar == br ? 0 : (ar > br ? -1 : 1);
					break;
				case 8:
					var erg = as == bs ? 0 : (as < bs ? -1 : 1);
					break;
				case 9:
					var erg = as == bs ? 0 : (as > bs ? -1 : 1);
					break;
			}
			return erg;
		});
	},
  doBarb: function(cityID,counter,xcoord,ycoord,level,kid,trps){
  	var t = Tabs.autoFO;
  		var dtime = new Date()
     var params = uW.Object.clone(uW.g_ajaxparams);
     params.cid=cityID;
  		params.type=4;
  	    params.kid=kid;
  		params.xcoord = xcoord;
  		params.ycoord = ycoord;
		var r=0;
		for (y in uW.unitcost) {
		 r++;
		 if(parseInt(trps[r]) > Seed.units['city'+cityID]['unt'+r]){
		 				//ById('dferrorlog').innerHTML = '<FONT color=red>'+dtime.toLocaleString()+' '+Cities.byID[cityID].name+' dark forest failed: Not doing march, not enough units </FONT>';
		 				return;
		};
		 if(parseIntNan(trps[r]) > 0)
				params['u'+r]=trps[r];
       }

  		AttackOptions.BarbsTried++;
  		ById('pberror0').innerHTML = 'Tentative :'+ AttackOptions.BarbsTried;
  		var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
  		new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
  		         method: "post",
  		         parameters: params,
  		         loading: true,
  		         onSuccess: function (transport) {
					  profiler.stop();
  		            try {
				   var rslt = eval("(" + transport.responseText + ")");
				   if (rslt.ok) {
					 var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
					 var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
					 var ut = uW.unixtime();
					 var unitsarr = [];
            	 for (j in uW.unitcost) unitsarr.push(0);
					 var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];
					 for(i = 1; i <= unitsarr.length; i++){
						if(params["u"+i]){
						unitsarr[i] = params["u"+i];
						}
					 }
					 var currentcityid = params.cid;
					 uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
					 uW.update_seed(rslt.updateSeed)
					 if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
					 var slots=0;
					 for(var k in Seed.queue_atkp['city'+cityID])
					  slots++;
					 if(Seed.queue_atkp['city'+cityID].toSource() == "[]")
					  slots = 0;
					 AttackOptions.BarbsDone[counter]++;
					 var element1 = 'pddatacity'+(counter-1);
					 ById(element1).innerHTML = 'Env: ' + AttackOptions.BarbsDone[counter];
					 var element2 = 'pddataarray'+(counter-1);
					 ById(element2).innerHTML =  'PR: (' + slots + '/' + t.rallypointlevel +')';
					 var now = new Date().getTime()/1000.0;
					 now = now.toFixed(0);
					 GM_setValue('DF_' + Seed.player.name + '_city_' + counter + '_' + getServerId(), JSON2.stringify(t.barbArray[counter]));
					 saveAttackOptions();
				   } else {
					 if (rslt.error_code != 8 && rslt.error_code != 213 && rslt.error_code == 210) AttackOptions.BarbsFailedVaria++;
					 if (rslt.error_code == 213)AttackOptions.BarbsFailedKnight++;
					 if (rslt.error_code == 210) AttackOptions.BarbsFailedRP++;
					 if (rslt.error_code == 4) actionLog('AutoFO','not enough units to attack darkforest');
					 if (rslt.error_code == 8) {
					 						 AttackOptions.BarbsFailedTraffic++;
					 						 t.doBarb(cityID,counter,xcoord,ycoord,level,kid,trps);
					 						 return;
					 }
					 if (rslt.user_action) {
					 	actionLog("AutoFO","<b><font color=red>Alert : "+rslt.user_action+"</font></b>");
						AttackOptions.BarbsFailedVaria++;
					}
					 if (rslt.error_code == 104) {
					   AttackOptions.BarbsFailedBog++;
					   actionLog("AutoFO","<b><font color=red>Code 104</font></b>");
					   GM_setValue('DF_' + Seed.player.name + '_city_' + counter + '_' + getServerId(), JSON2.stringify(t.barbArray[counter]));
					   new t.barbing();
					   saveAttackOptions();
					 }
					 ById('pberror2').innerHTML = 'Erreur Traffic :' + AttackOptions.BarbsFailedTraffic;
					 ById('pberror3').innerHTML = 'Erreur PR : '+ AttackOptions.BarbsFailedRP;
					 ById('pberror4').innerHTML = 'Erreur Chev :' + AttackOptions.BarbsFailedKnight;
					 ById('pberror5').innerHTML = 'Autre :' + AttackOptions.BarbsFailedVaria;
					 ById('pberror6').innerHTML = 'Bug :' + AttackOptions.BarbsFailedBog;
					 }
			    } catch(err) {
			   	AttackOptions.BarbsFailedVaria++;
			   	saveAttackOptions();
			   }
  		         },
  		         onFailure: function () {profiler.stop();}
  		 });
  	 saveAttackOptions();
  },

  sendreport: function(){
	  var t = Tabs.autoFO;
	  var total = 0;
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.emailTo = Seed.player.name;
    params.subject = "Barb Overview";
    var message = 'Barbing Stats: (Sent/Total)' + '%0A';
    for (x=1;x<=Seed.cities.length;x++){
    	message+= Seed.cities[x-1][1] + ': (' + AttackOptions.BarbsDone[x] + '/' + t.barbArray[x].length +')' + '%0A';
    }
    message += '%0A'+ 'Excess traffic errors: ' + AttackOptions.BarbsFailedTraffic +'%0A';
    message += 'Rallypoint errors: ' + AttackOptions.BarbsFailedRP +'%0A';
    message += 'Knight errors: ' + AttackOptions.BarbsFailedKnight +'%0A';
    message += 'Other errors: ' + AttackOptions.BarbsFailedVaria +'%0A';
    message += 'Actual sent attacks: ' + (AttackOptions.BarbsTried - AttackOptions.BarbsFailedTraffic - AttackOptions.BarbsFailedRP - AttackOptions.BarbsFailedKnight -  AttackOptions.BarbsFailedVaria) +'%0A';
    message += '%0A'+'%0A' + 'Food Gain (for '+AttackOptions.MsgInterval+' hour of barbing)' +'%0A';
    for (q=1;q<=Seed.cities.length;q++){
    	var cityID = 'city' + Seed.cities[q-1][0];
    	var gain = parseInt(Seed.resources[cityID]['rec1'][0] / 3600) - AttackOptions.Foodstatus[q];
    	message+= Seed.cities[q-1][1] + ': Start: ' + addCommas(AttackOptions.Foodstatus[q]) + ' End :' + addCommas(parseInt(Seed.resources[cityID]['rec1'][0] / 3600)) + ' Gain: ';
    	message += addCommas(gain)  + '%0A';
		total += gain;
    }
	message += '%0A Total food gain : '+addCommas(total)+'%0A';
    params.message = message;
    params.requestType = "COMPOSED_MAIL";
    new AjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
        method: "post",
        parameters: params,
        onSuccess: function (message) {
            var rslt = eval("(" + message.responseText + ")");
            if (rslt.ok) {
            } else {
            }
        },
        onFailure: function () {
        },
    });
  },

  clickedSearch : function (){
    var t = Tabs.autoFO;

    t.opt.maxDistance = parseInt(AttackOptions.MaxDistance);
    t.opt.searchDistance = (t.opt.maxDistance*2);
    if(t.opt.maxDistance > 15){
     t.opt.searchDistance = 15;
    }
    t.opt.searchShape = 'circle';
    t.mapDat = [];
    t.firstX =  t.opt.startX - t.opt.maxDistance;
    t.lastX = t.opt.startX + t.opt.maxDistance;
    t.firstY =  t.opt.startY - t.opt.maxDistance;
    t.lastY = t.opt.startY + t.opt.maxDistance;
    t.tilesSearched = 0;
    t.tilesFound = 0;
    t.curX = t.firstX;
    t.curY = t.firstY;
    var xxx = t.MapAjax.normalize(t.curX);
    var yyy = t.MapAjax.normalize(t.curY);
    var element = 'pddatacity'+(t.lookup-1);
    ById(element).innerHTML = uW.g_js_strings.commonstr.loadingddd+' : '+ xxx +','+ yyy;

    t.timerMap=setTimeout (function(){t.MapAjax.request (xxx, yyy, t.opt.searchDistance, t.mapCallback)}, MAP_DELAY);
  },
  timerMap:null,
  mapCallback : function (left, top, width, rslt){
    var t = Tabs.autoFO;
     if (!t.searchRunning)
      return;
    if (!rslt.ok){
      t.stopSearch ('ERROR: '+ rslt.errorMsg);
      return;
    }
    if (!Options.AttackRunning) {

     for (i=1;i<=Seed.cities.length;i++){
    		AttackOptions.Update[i][1] = 0;
    		GM_deleteValue('DF_' + Seed.player.name + '_city_' + i + '_' + getServerId())
     }
     var element = 'pddatacity'+(t.lookup-1);
     ById(element).innerHTML = lang.autofo.cancel;
     t.searchRunning = false;
     saveAttackOptions();
     return;
    }
    map = rslt.data;

	var cityID = 'city' + Seed.cities[t.lookup-1][0];
	var tiles = [];
    for(x in Seed.queue_atkp[cityID]) {
		tiles.push(Seed.queue_atkp[cityID][x].toTileId);
	}

    for (k in map){
	  if (map[k].tileType==54 && AttackOptions.Levels[t.lookup][map[k].tileLevel]){
	     var dist = distance (t.opt.startX, t.opt.startY, map[k].xCoord, map[k].yCoord);
		 if(dist <= parseInt(AttackOptions.MaxDistance))
		   if(tiles.indexOf(map[k].tileId) == -1)
		     t.mapDat.push ({time:0,x:map[k].xCoord,y:map[k].yCoord,dist:dist,level:map[k].tileLevel});
	  }
    }

    t.tilesSearched += (20*20);

    t.curX += 20;
    if (t.curX > t.lastX){
      t.curX = t.firstX;
      t.curY += 20;
      if (t.curY > t.lastY){
		t.stopSearch(lang.autofo.found+' ' + t.mapDat.length);
        return;
      }
    }
    var x = t.MapAjax.normalize(t.curX);
    var y = t.MapAjax.normalize(t.curY);
    var element0 = 'pdtotalcity'+(t.lookup-1);
	if (t.mapDat.length < 1) ById(element0).innerHTML = 'No Data';
        else ById(element0).innerHTML =  'FO:' + t.mapDat.length;
    var element = 'pddatacity'+(t.lookup-1);
    ById(element).innerHTML = uW.g_js_strings.commonstr.loadingddd+' : '+ x +','+ y;
    t.timerMap=setTimeout (function(){t.MapAjax.request (x, y, 20, t.mapCallback)}, MAP_DELAY);
  },

  stopSearch : function (msg){
    var t = Tabs.autoFO;
	var element = 'pddatacity'+(t.lookup-1);
        ById(element).innerHTML = msg;
	GM_setValue('DF_' + Seed.player.name + '_city_' + t.lookup + '_' + getServerId(), JSON2.stringify(t.mapDat));
	AttackOptions.Update[t.lookup][0] = unixTime();
	AttackOptions.Update[t.lookup][1]++;
        t.searchRunning = false;
	saveAttackOptions();
	t.checkBarbData();
	return;
  },
  hide : function (){
	  var t = Tabs.autoFO;
 	  t.saveTroops();
  },
  show : function (){  },
};

Tabs.Raid = {
  tabDisabled : false,
  tabLabel: 'Raid',
  tabOrder : 20,
  myDiv : null,
  rallypointlevel:null,
  knt:{},
  Troops:{},
  city:0,
  raidtimer:null,
  rslt:{},
  save:{},
  stopping:false,
  resuming:false,
  deleting:false,
  stopprogress:0,
  stopcount:0,
  activecount:0,
  count:0,
  timerLookup:null,
  timerPaint:null,
  timerReport:null,
  init : function (div){
    var t = Tabs.Raid;
    t.myDiv = div;
	t.raidtimer = setTimeout(t.checkRaids, 6000);
	var m = '<DIV class=boStat>'+lang.RAID.conf+'</div><TABLE width=100% height=0% class=pbTab><TR align="center">\
	    <td colspan=2><INPUT id=pbraidtab type=submit value="'+lang.RAID.stop+'" class="tab"><INPUT id=pbraidtabRes type=submit value="'+lang.RAID.resume+'" class="tab" >\
	    <INPUT id=pbraidtabDel type=submit value="'+lang.RAID.delete+'" class="tab"></td>\
	    <TR align="center">';
	    m += '<TD><INPUT id=pbRaidStart type=submit value="Auto Reset = '+ (Options.RaidRunning?'ON':'OFF') +'" ></td>';
	    m += '<TD><INPUT id=pbsendraidreport type=checkbox '+ (Options.foodreport?'CHECKED':'') +'\> '+lang.RAID.sendReport+' ';
	    m += '<INPUT id=pbsendreportint value='+ Options.MsgInterval +' type=text size=3 \> '+lang.General.hours+' </td>';
	    m += '</tr></table></div>';
	    m += '<DIV class=boStat>'+lang.RAID.marches+'</div><TABLE width=100% height=0% class=pbTab><TR align="center">';
	    m += '<TD><DIV style="margin-bottom:10px;"><span id=ptRaidCity></span></div></td></tr>';
	    m+='<TR><TD><DIV style="margin-bottom:10px;"><span id=ptRaidTimer></span></div></td></tr></table>';
	    m += '<DIV id=PaintRaids></div>';
	    m += '<DIV class=boStat>'+lang.RAID.memory+'</div><TABLE width=100% height=0% class=pbTab><TR align="center">';
	    m += '<DIV id=SavedRaids></div>';
	     m+='<br>' + pubdusite;
	t.myDiv.innerHTML = m;
	if (Options.foodreport) {
	 t.timerReport=setInterval(t.sendreport, 1*60*1000);
	 }

	t.from = new CdispCityPicker ('ptRaidpicker', ById('ptRaidCity'), true, t.clickCitySelect, 0);
	ById('pbRaidStart').addEventListener('click', t.toggleRaidState, false);
	ById('pbsendraidreport').addEventListener('change', function(){
		Options.foodreport = ById('pbsendraidreport').checked;
		if (Options.foodreport) {
		   clearInterval(t.timerReport);
		   t.timerReport=setInterval(t.sendreport, 1*60*1000);
		 } else {
		  clearInterval(t.timerReport);
		 }
		saveOptions();
	}, false);
	ById('pbsendreportint').addEventListener('change', function(){
		Options.MsgInterval = parseInt(ById('pbsendreportint').value);
		saveOptions();
	}, false);

	ById('pbraidtab').addEventListener('click', t.StopAllRaids, false);
	ById('pbraidtabRes').addEventListener('click', t.ResumeAllRaids, false);
	ById('pbraidtabDel').addEventListener('click', t.DeleteAllRaids, false);


	var serverID = getServerId();
	t.save = GM_getValue ('SavedRaids_'+serverID);
	if (t.save != undefined) t.save = JSON2.parse (t.save);


  },

  lookup : function (){
      	var t = Tabs.Raid;
      	t.activecount=0;
      	t.stopcount=0;
      	for (c=0; c< Seed.cities.length;c++) {
      			cityID = 'city' + Seed.cities[c][0];
   				for (b in Seed.queue_atkp[cityID]){
   					destinationUnixTime = Seed.queue_atkp[cityID][b]['destinationUnixTime'];
   					MarchStatus = Seed.queue_atkp[cityID][b]['marchStatus'];
   					MarchType = Seed.queue_atkp[cityID][b]['marchType'];
   					botMarchStatus = Seed.queue_atkp[cityID][b]['botMarchStatus'];
   					if (MarchType == 9 &&  MarchStatus == 3 || MarchStatus==10) t.stopcount++;
   					else if (MarchType == 9) t.activecount++;

   				}
   		}

   		if (t.resuming == false && t.stopping == false && t.deleting == false && t.activecount != 0)
				if (ById('pbraidtab')) ById('pbraidtab').value = lang.RAID.stop+' ('+ t.activecount + ')'
			   	else if (t.resuming == false && t.stopping == false && t.deleting == false)
					if (ById('pbraidtab')) ById('pbraidtab').value = lang.RAID.stop+' ('+ t.activecount + ')'
		   		if (t.resuming == false && t.resuming == false && t.deleting == false && t.stopcount !=0)
					if (ById('pbraidtabRes')) ById('pbraidtabRes').value = lang.RAID.resume+' ('+ t.stopcount + ')'
		   		else if (t.resuming == false && t.stopping == false && t.deleting == false)
					if (ById('pbraidtabRes')) ById('pbraidtabRes').value = lang.RAID.resume+' ('+ t.stopcount + ')'
		   		if (t.resuming == false && t.stopping == false && t.deleting == false && t.stopcount !=0)
					if (ById('pbraidtabDel')) ById('pbraidtabDel').value = lang.RAID.delete+' ('+ t.stopcount + ')'
		   		else if (t.resuming == false && t.stopping == false && t.deleting == false)
			if (ById('pbraidtabDel')) ById('pbraidtabDel').value = lang.RAID.delete+' ('+ t.stopcount + ')'
  },

  paint : function ()	{
  	var t = Tabs.Raid;

  	var botMarchStat = {0:'Inactive',
  						1:'Raiding',
  						2:'Returning',
  						3:'Stopped',
  						4:'Resting',
  						5:'Unknown',
  						7:'Situation Changed',
  						8:'Returning',
  						9:'Aborting'};
  	var botStat = {0:'Undefined',
  						1:'Marching',
  						2:'Returning',
  						3:'Stopped',
  						4:'Insufficient Troops',
  						5:'Max Raids Exceeded',
  						7:'Timed out',
  						8:'Resting'};
  	var o = '';
  	if (t.rslt.settings != undefined) o+= '<FONT size=2px><B>'+lang.RAID.timer+' : '+ timestr( 86400 - ( unixTime() - t.rslt.settings.lastUpdated )) +'</b></font>';
  	ById('ptRaidTimer').innerHTML = o;

  	var z ='<TABLE class=pbTab><TR><TD width=60px align=center><A onclick="pbStopAll('+t.cityId+')">STOP</a></td><TD width=70px>'+lang.General.time+'</td><TD width=85px>'+uW.g_js_strings.commonstr.coordinates+'</td><TD width=50px>'+uW.g_js_strings.commonstr.level+'</td><TD width=50px>&nbsp;</td><TD width=50px>&nbsp;</td></TR>';
  	if (t.rslt['queue'] != ""){
  		for (y in t.rslt['queue']) {
  			if (t.rslt['queue'][y]['botMarches'] != undefined) {
  				for (k in Seed.queue_atkp['city' + t.cityId]){
  					if (Seed.queue_atkp['city' + t.cityId][k]['marchId'] == t.rslt['queue'][y]['botMarches']['marchId']) {
  						botMarchStatus = Seed.queue_atkp['city' + t.cityId][k]['botMarchStatus'];
  						MarchStatus = Seed.queue_atkp['city' + t.cityId][k]['marchStatus'];
  						restPeriod = (Seed.queue_atkp['city' + t.cityId][k]['restPeriod']/60);
  						destinationUnixTime = Seed.queue_atkp['city' + t.cityId][k]['destinationUnixTime'];
  						returnUnixTime = Seed.queue_atkp['city' + t.cityId][k]['returnUnixTime']
  						now = unixTime();
  						z+='<TR>';
  						if (MarchStatus == 1) z+='<TD align=center><img src='+gameurl+'img/attacking.jpg></td>';
  						if (MarchStatus == 8 && (destinationUnixTime - now) <= 0 && botMarchStatus !=3 && returnUnixTime > now) z+='<TD align=center><img src='+gameurl+'img/returning.jpg></td>';
  						if (MarchStatus == 3) z+='<TD align=center><img src='+gameurl+'img/autoAttack/raid_stopped_desat.png></td>';
  						if (MarchStatus == 4 || (returnUnixTime < now  && botMarchStatus !=3)) z+='<TD align=center><img src='+gameurl+'img/autoAttack/raid_resting.png></td>';

  						if (destinationUnixTime >= now) z+='<TD>'+ timestr(Seed.queue_atkp['city' + t.cityId][k]['destinationUnixTime'] - unixTime())+'</td>';
  						if (destinationUnixTime <= now) {
  							if ((destinationUnixTime - now) <= 0 && returnUnixTime > now) z+='<TD>'+ timestr(returnUnixTime - now)+'</td>';
  							if (returnUnixTime <= now) z+='<TD>'+ timestr(now - returnUnixTime)+'</td>';
  						}
  					}
  				}
  				z+="<TD><a href='javascript:void(0)' onclick='cm.utils.CoordinateLinkController.onClick(event)' class='coordinateLink'>("+ t.rslt['queue'][y]['botMarches']['toXCoord'] +","+ t.rslt['queue'][y]['botMarches']['toYCoord']+")</a></td>";
  				z+='<TD align=center>'+ t.rslt['queue'][y]['botMarches']['toTileLevel'] +'</td>';
  				if (botMarchStatus == 3) z+='<TD><A onclick="pbEditRaid('+ y +')">'+lang.General.edit+'</a></td>';
	  				else z+='<TD><FONT COLOR= "CCCCCC">'+lang.General.edit+'</font></td>';
  				if (botMarchStatus == 3) z+='<TD align=center><A onclick="pbDeleteRaid('+ t.rslt['queue'][y]['botMarches']['marchId']+')">'+lang.General.delete+'</a></td>';
  				else z+='<TD align=center><FONT COLOR= "CCCCCC">'+lang.General.delete+'</font></td>';
  				z +='<TD width=25px></td><TD>'+lang.General.timeremi+' '+ timestr(restPeriod) +'</td>';
  				z+='</tr>';
  			}
  		}
  	}
  	z+='</table>';
  	if (t.rslt['queue'] == "") z ='<TABLE class=pbTab><TR><TD>'+lang.RAID.nothing+'</td></TR>';
  	ById('PaintRaids').innerHTML = z;

  	var check = true;
  		if (t.save != ""){
  			var a ='<TABLE class=pbTab><TR><TD width=60px></td><TD width=70px></td><TD width=85px>'+uW.g_js_strings.commonstr.coordinates+'</td><TD width=50px>'+uW.g_js_strings.commonstr.level+'</td><TD width=50px></td><TD width=50px></td></tr>';
  			for (y in t.save){
  				if (t.save[y] != undefined && t.cityId == t.save[y]['cityId']){
  					a +='<TR><TD align=center><A onclick="pbDeleteSavedRaid('+ t.save[y]['marchId'] +')">X</a></td>';
  					a +="<TD></td><TD><FONT COLOR='#CC0000'><a href='javascript:void(0)' onclick='cm.utils.CoordinateLinkController.onClick(event)' class='coordinateLink'>("+t.save[y]['toXCoord']+","+t.save[y]['toYCoord']+")</a></font></td>";
  					a +='<TD align=center>'+t.save[y]['toTileLevel']+'</td>';
  					a +='<TD><A onclick="pbEditSavedRaid('+ y +')">'+lang.General.edit+'</a></td>';
  					a +='<TD align=center><A onclick="pbAddRaid('+ t.save[y]['marchId']+')">'+lang.General.add+'</a></td></tr>';
  					check = false;
  				}
  			}
  			m+='</table>';
  		}

  	if (check) a ='<TABLE class=pbTab><TR><TD>'+lang.RAID.nothingmemory+'</td></TR>';

  	ById('SavedRaids').innerHTML = a;

  	uW.pbDeleteRaid = t.DeleteRaid;
  	uW.pbEditRaid = t.EditRaid;
  	uW.pbAddRaid = t.AddRaid;
  	uW.pbDeleteSavedRaid = t.DeleteSavedRaid;
  	uW.pbEditSavedRaid = t.EditSavedRaid;
  	uW.pbStopAll = t.StopCityRaids;
  },

  DeleteSavedRaid : function (Id){
    	  var t = Tabs.Raid;
    	  for (yy=0;yy<t.save.length;yy++){
    	  	if (t.save[yy]['marchId'] == Id){
    	  		  t.save.splice (yy,1);
    	  	}
    	  }
    	  var serverID = getServerId();
    	  setTimeout (function (){GM_setValue ('SavedRaids_'+serverID, JSON2.stringify(t.save));}, 0);
    	  t.paint();
    },

  EditSavedRaid : function (y){
      var t = Tabs.Raid;
	  var pop = new CPopup ('pbEditRaid', 0,0, 750,350, true);
	  if (t.popFirst){
	    pop.centerMe (mainPop.getMainDiv());
	    t.popFirst = false;
	  }
	  pop.getTopDiv().innerHTML = '<CENTER><B>Edition du Raid</b></center>';
	  cityId =  t.save[y]['cityId'];

		  var m = '<BR><TABLE id=pbRaidAdd height=0% class=pbTab><TR align="center">';
		  m+='<TR></tr><TR><TD width=25px>X= <INPUT id=toXCoord type=text size=3 maxlength=3 value='+t.save[y]['toXCoord']+'></td>';
		  m+='<TD width=10px></td><TD widht=25px>Y= <INPUT id=toYCoord type=text size=3 maxlength=3 value='+ t.save[y]['toYCoord'] +'></td>';
		  m+='<TD width=25px></td><TD>Round Trip : '+ timestr((t.save[y]['returnUnixTime'] - t.save[y]['destinationUnixTime'])*2)+ '</td></tr></table>';

		  m += '<BR><TABLE id=pbRaidAdd width=100% height=0% class=pbTab><TR align="center">';
		  m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_1_50.jpg?6545"></td>';
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt1']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_2_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt2']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_3_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt3']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_4_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt4']) +'</td></tr>'
		  m += '<TR><TD><INPUT id=Unit1 type=text size=6 maxlength=6 value="'+ t.save[y]['unit1Count']+'"></td>';
		  m += '<TD><INPUT id=Unit2 type=text size=6 maxlength=6 value="'+ t.save[y]['unit2Count']+'"></td>';
		  m += '<TD><INPUT id=Unit3 type=text size=6 maxlength=6 value="'+ t.save[y]['unit3Count']+'"></td>';
		  m += '<TD><INPUT id=Unit4 type=text size=6 maxlength=6 value="'+ t.save[y]['unit4Count']+'"></td></tr>';

		  m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_5_50.jpg?6545"></td>';
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt5']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_6_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt6']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_7_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt7']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_8_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt8']) +'</td></tr>'
		  m += '<TR><TD><INPUT id=Unit5 type=text size=6 maxlength=6 value="'+ t.save[y]['unit5Count']+'"></td>';
		  m += '<TD><INPUT id=Unit6 type=text size=6 maxlength=6 value="'+ t.save[y]['unit6Count']+'"></td>';
		  m += '<TD><INPUT id=Unit7 type=text size=6 maxlength=6 value="'+ t.save[y]['unit7Count']+'"></td>';
		  m += '<TD><INPUT id=Unit8 type=text size=6 maxlength=6 value="'+ t.save[y]['unit8Count']+'"></td></tr>';

		  m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_9_50.jpg?6545"></td>';
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt9']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_10_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt10']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_11_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt11']) +'</td>'
		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_12_50.jpg?6545"></td>'
		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt12']) +'</td></tr>'
		  m += '<TR><TD><INPUT id=Unit9 type=text size=6 maxlength=6 value="'+ t.save[y]['unit9Count']+'"></td>';
		  m += '<TD><INPUT id=Unit10 type=text size=6 maxlength=6 value="'+ t.save[y]['unit10Count']+'"></td>';
		  m += '<TD><INPUT id=Unit11 type=text size=6 maxlength=6 value="'+ t.save[y]['unit11Count']+'"></td>';
		  m += '<TD><INPUT id=Unit12 type=text size=6 maxlength=6 value="'+ t.save[y]['unit12Count']+'"></td></tr></table>';

		  m += '<BR><CENTER><SELECT id=AddKnights type=list></select></center>';
		  m+= '<BR><CENTER>'+ strButton20('Save', 'id=pbSaveRaid') +'</center>';

	  pop.getMainDiv().innerHTML = m;

	  t.getKnights(cityId);

	  ById ('AddKnights').value =  t.save[y]['knightId'];
	  ById ('pbSaveRaid').addEventListener ('click', function(){
	  			t.save[y]['knightId'] = parseInt(ById ('AddKnights').value);
	  			t.save[y]['toXCoord'] = parseInt(ById ('toXCoord').value);
	  			t.save[y]['toYCoord'] = parseInt(ById ('toYCoord').value);
	  			t.save[y]['unit1Count'] = parseInt(ById ('Unit1').value);
	  			t.save[y]['unit2Count'] = parseInt(ById ('Unit2').value);
	  			t.save[y]['unit3Count'] = parseInt(ById ('Unit3').value);
	  			t.save[y]['unit4Count'] = parseInt(ById ('Unit4').value);
	  			t.save[y]['unit5Count'] = parseInt(ById ('Unit5').value);
	  			t.save[y]['unit6Count'] = parseInt(ById ('Unit6').value);
	  			t.save[y]['unit7Count'] = parseInt(ById ('Unit7').value);
	  			t.save[y]['unit8Count'] = parseInt(ById ('Unit8').value);
	  			t.save[y]['unit9Count'] = parseInt(ById ('Unit9').value);
	  			t.save[y]['unit10Count'] = parseInt(ById ('Unit10').value);
	  			t.save[y]['unit11Count'] = parseInt(ById ('Unit11').value);
	  			t.save[y]['unit12Count'] = parseInt(ById ('Unit12').value);
	  			var serverID = getServerId();
	  			setTimeout (function (){GM_setValue ('SavedRaids_'+serverID, JSON2.stringify(t.save));}, 0);
	  			pop.show (false);
	  }, false);

	  pop.show (true);
    },

  EditRaid : function (y){
  	  var t = Tabs.Raid;
  	  var pop = new CPopup ('pbEditRaid', 0,0, 750,350, true);
  	  if (t.popFirst){
  	    pop.centerMe (mainPop.getMainDiv());
  	    t.popFirst = false;
  	  }
  	  pop.getTopDiv().innerHTML = '<CENTER><B>Edit Raid</b></center>';
  	  cityId = t.rslt['queue'][y]['botMarches']['cityId'];

  		  var m = '<BR><TABLE id=pbRaidAdd height=0% class=pbTab><TR align="center">';
  		  m+='<TR></tr><TR><TD width=25px>X= <INPUT id=toXCoord type=text size=3 maxlength=3 value='+t.rslt['queue'][y]['botMarches']['toXCoord']+'></td>';
  		  m+='<TD width=10px></td><TD widht=25px>Y= <INPUT id=toYCoord type=text size=3 maxlength=3 value='+ t.rslt['queue'][y]['botMarches']['toYCoord'] +'></td>';
  		  m+='<TD width=25px></td><TD>Round Trip: '+ timestr((t.rslt['queue'][y]['botMarches']['returnUnixTime'] - t.rslt['queue'][y]['botMarches']['destinationUnixTime'])*2)+ '</td></tr></table>';

  		  m += '<BR><TABLE id=pbRaidAdd width=100% height=0% class=pbTab><TR align="center">';
  		  m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_1_50.jpg?6545"></td>';
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt1']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_2_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt2']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_3_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt3']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_4_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt4']) +'</td></tr>'
  		  m += '<TR><TD><INPUT id=Unit1 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit1Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit2 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit2Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit3 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit3Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit4 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit4Count']+'"></td></tr>';

  		  m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_5_50.jpg?6545"></td>';
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt5']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_6_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt6']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_7_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt7']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_8_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt8']) +'</td></tr>'
  		  m += '<TR><TD><INPUT id=Unit5 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit5Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit6 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit6Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit7 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit7Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit8 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit8Count']+'"></td></tr>';

  		  m += '<TR><TD rowspan="2"><img src="'+gameurl+'img/units/unit_9_50.jpg?6545"></td>';
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt9']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_10_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt10']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_11_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt11']) +'</td>'
  		  m += '<TD rowspan="2"><img src="'+gameurl+'img/units/unit_12_50.jpg?6545"></td>'
  		  m += '<TD>'+ addCommas(Seed.units['city'+cityId]['unt12']) +'</td></tr>'
  		  m += '<TR><TD><INPUT id=Unit9 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit9Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit10 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit10Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit11 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit11Count']+'"></td>';
  		  m += '<TD><INPUT id=Unit12 type=text size=6 maxlength=6 value="'+ t.rslt['queue'][y]['botMarches']['unit12Count']+'"></td></tr></table>';

  		  m += '<BR><CENTER><SELECT id=AddKnights type=list></select></center>';
  		  m+= '<BR><CENTER>'+ strButton20('Save', 'id=pbRaidSave') +'</center>';

  	  pop.getMainDiv().innerHTML = m;

  	  t.getKnights(cityId);

  	  ById ('AddKnights').value =  t.rslt['queue'][y]['botMarches']['knightId'];
  	  ById ('pbRaidSave').addEventListener ('click', function(){
  	  	var params = uW.Object.clone(uW.g_ajaxparams);

  	  	params.pf = 0;
  	      params.ctrl = 'BotManager';
  	  	params.action = 'editMarch';
  	  	params.settings = {};
  	  	params.settings.cityId = t.rslt['queue'][y]['botMarches']['fromCityId'];
  	  	params.queue = {0:{botMarches:{botMarchStatus:1,botState:1},cityMarches:{}}};
  	  	params.queue[0].cityMarches.knightId = parseInt(ById ('AddKnights').value);
  	  	params.queue[0].cityMarches.toXCoord =  parseInt(ById ('toXCoord').value);
  	  	params.queue[0].cityMarches.toYCoord =  parseInt(ById ('toYCoord').value);
  	  	params.queue[0].cityMarches.unit0Count = 0; //ById ('Unit0').value;
  	  	params.queue[0].cityMarches.unit1Count =  parseInt(ById ('Unit1').value);
  	  	params.queue[0].cityMarches.unit2Count = parseInt(ById ('Unit2').value);
  	  	params.queue[0].cityMarches.unit3Count = parseInt(ById ('Unit3').value);
  	  	params.queue[0].cityMarches.unit4Count = parseInt(ById ('Unit4').value);
  	  	params.queue[0].cityMarches.unit5Count = parseInt(ById ('Unit5').value);
  	  	params.queue[0].cityMarches.unit6Count = parseInt(ById ('Unit6').value);
  	  	params.queue[0].cityMarches.unit7Count = parseInt(ById ('Unit7').value);
  	  	params.queue[0].cityMarches.unit8Count = parseInt(ById ('Unit8').value);
  	  	params.queue[0].cityMarches.unit9Count = parseInt(ById ('Unit9').value);
  	  	params.queue[0].cityMarches.unit10Count = parseInt(ById ('Unit10').value);
  	  	params.queue[0].cityMarches.unit11Count = parseInt(ById ('Unit11').value);
  	  	params.queue[0].cityMarches.unit12Count = parseInt(ById ('Unit12').value);
  	  	params.queue[0].cityMarches.marchId =  t.rslt['queue'][y]['botMarches']['marchId'];

  	  	 new AjaxRequest2(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  				  		method: "post",
  				         parameters: params,
  						 loading: true,
  						 onSuccess: function(transport){
  							var rslt = eval("(" + transport.responseText + ")");
  		                      if (rslt.ok) {
  		                      		pop.show (false);
  									uW.cityinfo_army();
  		                          setTimeout(uW.update_seed_ajax, 250);
  		                          setTimeout(t.GetRaids, (750),Seed.cities[i][0]);
  								}
  						 },
  				 });
  	  	}, false);

  	  pop.show (true);
  },

  DeleteRaid : function (Id){
  	var t = Tabs.Raid;
  	var params = uW.Object.clone(uW.g_ajaxparams);

  	for (y in t.rslt['queue']) {
  		if (t.rslt['queue'][y]['botMarches'] != undefined) {
	  		if (t.rslt['queue'][y]['botMarches']['marchId'] == Id) {
	  				marchId = t.rslt['queue'][y]['botMarches']['marchId'];
	  				cityId = t.rslt['queue'][y]['botMarches']['cityId'];
	  				knightId = t.rslt['queue'][y]['botMarches']['knightId'];
	  				toTileLevel = t.rslt['queue'][y]['botMarches']['toTileLevel'];
	  				returnUnixTime = t.rslt['queue'][y]['botMarches']['returnUnixTime'];
	  				destinationUnixTime = t.rslt['queue'][y]['botMarches']['destinationUnixTime'];
	  				toXCoord = t.rslt['queue'][y]['botMarches']['toXCoord'];
	  				toYCoord = t.rslt['queue'][y]['botMarches']['toYCoord'];
	  				var units = {};
	  				var r=0;
		  		    for (y in uW.unitcost) {	   r++;units[r] = t.rslt['queue'][y]['botMarches']['unit'+r+'Count'];}
	  		}
	  	}
  	}

  	params.pf = 0;
  	params.ctrl = 'BotManager';
  	params.action = 'deleteMarch';
  	params.marchId = marchId;
  	params.settings = {};
  	params.settings.cityId = cityId;

    new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  	         method: "post",
  	         parameters: params,
  			 loading: true,
  			 onSuccess: function(transport){
  				var rslt = eval("(" + transport.responseText + ")");
  	              if (rslt.ok) {
  	              	  var serverID = getServerId();
  	              	  t.save = GM_getValue ('SavedRaids_'+serverID);
  	              	  if (t.save == undefined) t.save =new Array();
					  else t.save = JSON2.parse (t.save);

  	              	  t.save.push ({
  	              	  	marchId:		marchId,
  	              	  	cityId:   		cityId,
  	              	  	knightId:		knightId,
  	              	  	toTileLevel:	toTileLevel,
  	              	  	returnUnixTime:	destinationUnixTime,
  	              	  	returnUnixTime:	returnUnixTime,
  	              	  	toXCoord:		toXCoord,
  	              	  	toYCoord:		toYCoord,
  	              	  	unit1Count: 	units[1],
  	              	  	unit2Count: 	units[2],
  	              	  	unit3Count: 	units[3],
  	              	  	unit4Count: 	units[4],
  	              	  	unit5Count: 	units[5],
  	              	  	unit6Count: 	units[6],
  	              	  	unit7Count: 	units[7],
  	              	  	unit8Count: 	units[8],
  	              	  	unit9Count: 	units[9],
  	              	  	unit10Count: 	units[10],
  	              	  	unit11Count: 	units[11],
  	              	  	unit12Count: 	units[12],
  	              	  });
  	              	  var troops = Seed.units["city" + cityId];
                      for (var u = 1; u <= 12; ++u) {
                          var troop_number = parseInt(rslt["unit" + u + "Return"]);
                          if (isNaN(troop_number)) {
                              troop_number = parseInt(Seed.units["city" + cityId]["unt" + u]);
                          } else troop_number = parseInt(rslt["unit" + u + "Return"]) + parseInt(Seed.units["city" + cityId]["unt" + u]);
                          troops["unt" + u] = troop_number;
                      }
                      for (u in Seed.queue_atkp['city' + cityId]){
                      	if (Seed.queue_atkp['city' + cityId][u]['marchId'] == marchId){
							Seed.queue_atkp['city' + cityId][u] = "";
                      		uW.seed.queue_atkp['city' + cityId] = Seed.queue_atkp['city' + cityId];
                      	}
                      }

                      for (u in Seed.knights['city' + cityId]){
                      	if (Seed.knights['city' + cityId][u]['knightId'] == knightId){
                      		Seed.knights['city' + cityId][u]["knightStatus"] = 1;
                      		uW.seed.knights['city' + cityId] = Seed.knights['city' + cityId];
                      	}
                      }

  	              	  GM_setValue ('SavedRaids_'+serverID, JSON2.stringify(t.save));
  	              	  t.save = null;
                      uW.cityinfo_army();
  	                  setTimeout(uW.update_seed_ajax, 250);
  	                  t.GetRaids(cityId);
  					}
  			 },
  	 });
},
StopCityRaids : function (cityId){
    	var t = Tabs.Raid;
    	var params = uW.Object.clone(uW.g_ajaxparams);
	   	params.pf = 0;
    	params.ctrl = 'BotManager';
    	params.action = 'stopAll';
    	params.settings = {};
  	    params.settings.cityId = cityId;
    	new AjaxRequest2(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {method: "post",parameters: params,loading: true,onSuccess: function(transport){},});
    	setTimeout(t.GetRaids, (750), cityId);
},
StopAllRaids : function (){
      	var t = Tabs.Raid;
      	if (t.stopping == true || t.resuming == true || t.deleting == true) return;
      	if (t.activecount == 0) return;
	    t.stopping = true;
	      	for (i=0;i<Seed.cities.length;i++){
		      	setTimeout(t.DoAllStop, (i*1500),i);
		     }
   },

   ResumeAllRaids : function (){
       	var t = Tabs.Raid;
       	if (t.stopping == true || t.resuming == true || t.deleting == true) return;
       	if (t.stopcount == 0) return;
       	t.resuming = true;
   			for (i=0;i<Seed.cities.length;i++){
   			    setTimeout(t.DoAllResume, (i*1500),i);
   			}
    },


   DeleteAllRaids : function (){
       	var t = Tabs.Raid;
       	if (t.stopping == true || t.resuming == true || t.deleting == true) return;
       	if (t.stopcount == 0) return;
       	t.deleting = true;
       	count=0;
       	t.count = t.stopcount;
	for (d=0; d< Seed.cities.length;d++) {
	   cityID = 'city' + Seed.cities[d][0];
							for (e in Seed.queue_atkp[cityID]){
								destinationUnixTime = Seed.queue_atkp[cityID][e]['destinationUnixTime'];
								MarchStatus = Seed.queue_atkp[cityID][e]['marchStatus'];
								MarchType = Seed.queue_atkp[cityID][e]['marchType'];
								if (MarchType == 9 && (botMarchStatus == 3 || MarchStatus == 3)) {
									count++;
									setTimeout(t.DoAllDelete, (count*1250), (Seed.queue_atkp[cityID][e]['marchId']),d,count);
								}
							}
				}
  },
  DoAllStop: function(i) {
    var t = Tabs.Raid;
    var params = uW.Object.clone(uW.g_ajaxparams);
  	params.pf = 0;
  	params.ctrl = 'BotManager';
  	params.action = 'stopAll';
  	params.settings = {};
  	params.settings.cityId = Seed.cities[i][0];
    new AjaxRequest2(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  			  		method: "post",
  			         parameters: params,
  					 loading: true,
  					 onSuccess: function(transport){
  						var rslt = eval("(" + transport.responseText + ")");
  		                  if (rslt.ok) {
  		                  		t.stopprogress = t.stopprogress + (100/Seed.cities.length);

  		                  		if (ById("pbraidtab")) ById("pbraidtab").value='Stopping: '+ t.stopprogress.toFixed(0) + '%';
  		                  		if (t.stopprogress.toFixed(0) == 100) {
  		                  			 t.stopprogress = 0;
  		                  			 setTimeout(
  		                  			 function(){
  		                  			  if (ById("pbraidtab")) ById("pbraidtab").value=lang.RAID.stop+' ('+ t.activecount + ')';
  		                  			  t.stopping = false;

  		                  			 }, (5000));

  		                  		}
  						  }
  						  else {
  						  		if (rslt.msg == "The system is busy, please try again later") setTimeout (t.DoAllStop, (2000),i);
  						  		else {
  					 	  			t.stopprogress = t.stopprogress + (100/Seed.cities.length);
  					 	  		        if (ById("pbraidtab")) ById("pbraidtab").value='Stopping: '+ t.stopprogress.toFixed(0) + '%';

  					 	  			if (t.stopprogress.toFixed(0) == 100) {
  					 	  				 t.stopprogress = 0;
  					 	  				 setTimeout(function(){
  					 	  				 if (ById("pbraidtab")) ById("pbraidtab").value=lang.RAID.stop+' ('+ t.activecount + ')';
  					 	  				 t.stopping = false;
  					 	  				 }, (5000));

  					 	  			}
  					 	  		}
  					 	  }
  					 },
    });
  },

  DoAllResume: function(i) {
    var t = Tabs.Raid;
    var params = uW.Object.clone(uW.g_ajaxparams);
  	params.pf = 0;
  	params.ctrl = 'BotManager';
  	params.action = 'resumeAll';
  	params.settings = {};
    params.settings.cityId = Seed.cities[i][0];
    new AjaxRequest2(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  			  		method: "post",
  			         parameters: params,
  					 loading: true,
  					 onSuccess: function(transport){
  						var rslt = eval("(" + transport.responseText + ")");
  		                  if (rslt.ok) {
  		                  		t.stopprogress = t.stopprogress + (100/Seed.cities.length);
  		                  		if (ById("pbraidtabRes")) ById("pbraidtabRes").value='Resuming: '+ t.stopprogress.toFixed(0) + '%';
  		                  		if (t.stopprogress.toFixed(0) == 100) {
  		                  			 t.stopprogress = 0;
  		                  			 setTimeout(function(){

  		                  			 if (ById("pbraidtabRes")) ById("pbraidtabRes").value='Resume Raids ('+ t.stopcount + ')';

  		                  			 t.resuming = false;
  		                  			 }, (5000));
  		                  		}
  						  } else {
  						  		if (rslt.msg == "The system is busy, please try again later") setTimeout (t.DoAllResume, (2000),i);
  						  		else {
  					 	  			t.stopprogress = t.stopprogress + (100/Seed.cities.length);
  					 	  			if (ById("pbraidtabRes")) ById("pbraidtabRes").value='Resuming: '+ t.stopprogress.toFixed(0) + '%';
  					 	  			if (t.stopprogress.toFixed(0) == 100) {
  					 	  				 t.stopprogress = 0;
  					 	  				 setTimeout(function(){
  					 	  				 if (ById("pbraidtabRes")) ById("pbraidtabRes").value='Resume Raids ('+ t.stopcount + ')';
  					 	  				 t.resuming = false;}, (5000));
  					 	  			}
  					 	  		}
  					 	  }
  					 },
    });
  },

  DoAllDelete : function (Id,city,count){
    	var t = Tabs.Raid;
    	var params = uW.Object.clone(uW.g_ajaxparams);
    	cityID = 'city'+ Seed.cities[city][0];
    	for (f in Seed.queue_atkp[cityID]){
    		if (Seed.queue_atkp[cityID][f]['marchId'] == Id) {
    				marchId = Seed.queue_atkp[cityID][f]['marchId'];
    				cityId = Seed.queue_atkp[cityID][f]['cityId'];
    				knightId = Seed.queue_atkp[cityID][f]['knightId'];
    				toTileLevel = Seed.queue_atkp[cityID][f]['toTileLevel'];
    				returnUnixTime = Seed.queue_atkp[cityID][f]['returnUnixTime'];
    				destinationUnixTime = Seed.queue_atkp[cityID][f]['destinationUnixTime'];
    				toXCoord = Seed.queue_atkp[cityID][f]['toXCoord'];
    				toYCoord = Seed.queue_atkp[cityID][f]['toYCoord'];
    				var units = {};
    				 var r=0;
		  		   	  for (y in uW.unitcost) {
			   			r++;
			   			units[r] = Seed.queue_atkp[cityID][f]['unit'+r+'Count'];
					}
    		}
    	}

    	params.pf = 0;
    	params.ctrl = 'BotManager';
    	params.action = 'deleteMarch';
    	params.marchId = marchId;
    	params.settings = {};
    	params.settings.cityId = cityId;

      new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
    	         method: "post",
    	         parameters: params,
    			 loading: true,
    			 onSuccess: function(transport){
    				var rslt = eval("(" + transport.responseText + ")");
    	              if (rslt != "") {
    	              	  var serverID = getServerId();
    	              	  t.save = GM_getValue ('SavedRaids_'+serverID, "[]");
    	              	  if (t.save != undefined) t.save = JSON2.parse (t.save);
    	              	  if (t.save == undefined) t.save =new Array();

    	              	  t.save.push ({
    	              	  	marchId:		marchId,
    	              	  	cityId:   		cityId,
    	              	  	knightId:		knightId,
    	              	  	toTileLevel:	toTileLevel,
    	              	  	returnUnixTime:	destinationUnixTime,
    	              	  	returnUnixTime:	returnUnixTime,
    	              	  	toXCoord:		toXCoord,
    	              	  	toYCoord:		toYCoord,
    	              	  	unit1Count: 	units[1],
    	              	  	unit2Count: 	units[2],
    	              	  	unit3Count: 	units[3],
    	              	  	unit4Count: 	units[4],
    	              	  	unit5Count: 	units[5],
    	              	  	unit6Count: 	units[6],
    	              	  	unit7Count: 	units[7],
    	              	  	unit8Count: 	units[8],
    	              	  	unit9Count: 	units[9],
    	              	  	unit10Count: 	units[10],
    	              	  	unit11Count: 	units[11],
    	              	  	unit12Count: 	units[12],
    	              	  });

    	              	  var troops = Seed.units["city" + cityId];
    	              	  for (var u = 1; u <= 12; ++u) {
    	              	      var troop_number = parseInt(rslt["unit" + u + "Return"]);
    	              	      if (isNaN(troop_number)) {
    	              	          troop_number = parseInt(Seed.units["city" + cityId]["unt" + u]);
    	              	      } else troop_number = parseInt(rslt["unit" + u + "Return"]) + parseInt(Seed.units["city" + cityId]["unt" + u]);
    	              	      troops["unt" + u] = troop_number;
    	              	  }

    	              	  setTimeout (function (){GM_setValue ('SavedRaids_'+serverID, JSON2.stringify(t.save));}, 0);
                          uW.cityinfo_army();
    	                  setTimeout(uW.update_seed_ajax, 250);
    					}
    			 },
    	 });
  		  	 t.stopprogress = count * (100/t.count);
 		  	 if (ById("pbraidtabRes")) ById("pbraidtabDel").value='Deleting: '+ t.stopprogress.toFixed(0) + '%';
  		  	 if (t.stopprogress.toFixed(0) == 100) {
  		  	 	 t.stopprogress = 0;
  		  	 	 t.GetRaids(cityId);
  	}

},
AddRaid : function (Id){
    	var t = Tabs.Raid;
    	var params = uW.Object.clone(uW.g_ajaxparams);
    	update = {};

    	params.pf = 0;
    	params.ctrl = 'BotManager';
    	params.action = 'saveMarch';
    	params.settings = {};
    	params.queue = {0:{botMarches:{botMarchStatus:1,botState:1},cityMarches:{}}};

    	for (y in t.save){
    		if (t.save[y]['marchId'] == Id){
	    		params.settings.cityId = t.save[y]['cityId'];
	    		params.queue[0].cityMarches.knightId = t.save[y]['knightId'];
	    		params.queue[0].cityMarches.toXCoord = t.save[y]['toXCoord'];
	    		params.queue[0].cityMarches.toYCoord = t.save[y]['toYCoord'];
	    		params.queue[0].cityMarches.unit0Count = 0;
	    		params.queue[0].cityMarches.unit1Count = t.save[y]['unit1Count'];
	    		params.queue[0].cityMarches.unit2Count = t.save[y]['unit2Count'];
	    		params.queue[0].cityMarches.unit3Count = t.save[y]['unit3Count'];
	    		params.queue[0].cityMarches.unit4Count = t.save[y]['unit4Count'];
	    		params.queue[0].cityMarches.unit5Count = t.save[y]['unit5Count'];
	    		params.queue[0].cityMarches.unit6Count = t.save[y]['unit6Count'];
	    		params.queue[0].cityMarches.unit7Count = t.save[y]['unit7Count'];
	    		params.queue[0].cityMarches.unit8Count = t.save[y]['unit8Count'];
	    		params.queue[0].cityMarches.unit9Count = t.save[y]['unit9Count'];
	    		params.queue[0].cityMarches.unit10Count = t.save[y]['unit10Count'];
	    		params.queue[0].cityMarches.unit11Count = t.save[y]['unit12Count'];
	    		params.queue[0].cityMarches.unit12Count = t.save[y]['unit12Count'];
    		}
    	}

    	 new AjaxRequest2(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
    		  		method: "post",
    		         parameters: params,
    				 loading: true,
    				 onSuccess: function(transport){
    					var rslt = eval("(" + transport.responseText + ")");
    	                  if (rslt.ok) {
								t.GetRaids(params.settings.cityId);
      					        uW.cityinfo_army();
      	                  		setTimeout(uW.update_seed_ajax, 250);
      	                  		for (yy=0;yy<t.save.length;yy++){
      	                  			if (t.save[yy]['marchId'] == Id){
      	                  				  t.save.splice (yy,1);
      	                  			}
      	                  		}
      	                  		var serverID = getServerId();
      	                  		setTimeout (function (){GM_setValue ('SavedRaids_'+serverID, JSON2.stringify(t.save));}, 0);
      	                  		t.paint();
    					 } else {
  				 		  	  alert('Error: '+ rslt.msg);
    					 }
    				 },
    		 });
    },


  getKnights : function(cityId){
         var t = Tabs.Raid;
         var knt = new Array();
         var status ="";
         for (k in Seed.knights['city' + cityId]){
         		if ( Seed.leaders['city' + cityId]["resourcefulnessKnightId"] != Seed.knights['city' + cityId][k]["knightId"] && Seed.leaders['city' + cityId]["politicsKnightId"] != Seed.knights['city' + cityId][k]["knightId"] && Seed.leaders['city' + cityId]["combatKnightId"] != Seed.knights['city' + cityId][k]["knightId"] && Seed.leaders['city' + cityId]["intelligenceKnightId"] != Seed.knights['city' + cityId][k]["knightId"]){
         		   if (Seed.knights['city' + cityId][k]["knightStatus"] == 1 ) status = "Free";
         		   else status = "Marching";
         			knt.push ({
         				Name:   Seed.knights['city' + cityId][k]["knightName"],
         				Combat:	parseInt(Seed.knights['city' + cityId][k]["combat"]),
         				ID:		Seed.knights['city' + cityId][k]["knightId"],
         				Status: status,
         			});
         		}
         }
         knt = knt.sort(function sort(a,b) {a = a['Combat'];b = b['Combat'];return a == b ? 0 : (a > b ? -1 : 1);});
         ById('AddKnights').options.length=0;
  		var o = document.createElement("option");
  		o.text = '--Choose a Knight--';
  		o.value = 0;
  		ById("AddKnights").options.add(o);
         for (k in knt){
      			if (knt[k]["Name"] !=undefined){
  	    			var o = document.createElement("option");
  	    			o.text = (knt[k]["Name"] + ' (' + knt[k]["Combat"] +') (' + knt[k]["Status"] +')');
  	    			o.value = knt[k]["ID"];
  	    			ById("AddKnights").options.add(o);
      			}
      	}
      },


  clickCitySelect : function (city){
  	var t = Tabs.Raid;
  	t.cityId = city['id'];
  	t.GetRaids(t.cityId);
  },

  checkRaids : function (){
	var t = Tabs.Raid;
	var now = unixTime();
	if(!Options.RaidRunning) return;
	if ( (now - Options.RaidReset) > 7200 ) {
		Options.RaidReset = now;
		saveOptions();
		for (g=0;g<Seed.cities.length;g++){
				t.citiesdone = "";
				setTimeout(t.resetRaids, (1500*g), Seed.cities[g][0],Seed.cities[g][1]);
		}
	}
	t.raidtimer = setTimeout(t.checkRaids, 60*60*1000); // toute les heures !
  },

  GetRaids : function(cityId){
  		var t = Tabs.Raid;
  		var params = uW.Object.clone(uW.g_ajaxparams);

  		params.pf = 0;
  		params.ctrl = 'BotManager';
  		params.action = 'getMarches';
  		params.settings = {};
  		params.settings.cityId = cityId;


   		new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  		         method: "post",
  		         parameters: params,
  				 loading: true,
  				 onSuccess: function(transport){
  					var rslt = eval("(" + transport.responseText + ")");

                        if (rslt.ok) {
                        	t.rslt = rslt;

  							uW.cityinfo_army();
  							setTimeout(uW.update_seed_ajax, 250);
  							t.paint();
  						}
  				 },
  		 });
  },

  resetRaids : function(cityId,cityName){
  		var t = Tabs.Raid;
  		var params = uW.Object.clone(uW.g_ajaxparams);

  		params.pf = 0;
  		params.ctrl = 'BotManager';
  		params.action = 'resetRaidTimer';
		params.settings = {};
  		params.settings.cityId = cityId;


   		new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch.php" + uW.g_ajaxsuffix, {
  		         method: "post",
  		         parameters: params,
				 loading: true,
				 onSuccess: function(transport){
					var rslt = eval("(" + transport.responseText + ")");
                        if (rslt.ok) {
                          actionLog("RAID","Minuteur RAID remis a zero sur "+cityName);
			  uW.cityinfo_army();
                            setTimeout(uW.update_seed_ajax, 250);
                            t.citiesdone += cityName + ' ';
						}
				 },
  		 });
  },
  sendreport: function(){
	  var t = Tabs.Raid;
	  if(!Options.foodreport) return;
	  var now = new Date().getTime()/1000.0;
      now = now.toFixed(0);
      if (now < (parseInt(Options.LastReport)+(Options.MsgInterval*60*60))) return;

	var total = 0;
    var message = 'Raid Stats: %0A';
    message += '%0A Food Gain (for '+ Options.MsgInterval +' hour of raiding) %0A';
    for (q=1;q<=Seed.cities.length;q++){
    	var cityID = 'city' + Seed.cities[q-1][0];
    	var gain = parseInt(Seed.resources[cityID]['rec1'][0] / 3600) - Options.Foodstatus[q];
    	message+= Seed.cities[q-1][1] + ': Start: ' + addCommas(Options.Foodstatus[q]) + ' End :' + addCommas(parseInt(Seed.resources[cityID]['rec1'][0] / 3600)) + ' Gain: ';
    	message += addCommas(gain)  + '%0A';
		total += gain;
		Options.Foodstatus[q] = parseInt(Seed.resources[cityID]['rec1'][0] / 3600);
    }
	message += '%0A Total food gain : '+addCommas(total)+'%0A';

    var params = uW.Object.clone(uW.g_ajaxparams);
    params.emailTo = Seed.player.name;
    params.subject = "Raid Overview";
    params.message = message;
    params.requestType = "COMPOSED_MAIL";
    new AjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
        method: "post",
        parameters: params,
        onSuccess: function (message) {
            var rslt = eval("(" + message.responseText + ")");
            if (rslt.ok) {
            } else {
            }
        },
        onFailure: function () {
        },
    });

    Options.LastReport = now;
    saveOptions();
  },

  toggleRaidState : function (){
  	var t = Tabs.Raid;
  	if(Options.RaidRunning){
  		Options.RaidRunning = false;
  		t.raidtimer = null;
  		ById('pbRaidStart').value = 'Auto Reset = OFF';
  	} else {
  		Options.RaidRunning = true;
  		t.raidtimer = setTimeout(t.checkRaids, 5000);
  		ById('pbRaidStart').value = 'Auto Reset = ON';
  	}
  	saveOptions();
  },


  hide : function (){
   var t = Tabs.Raid;
   clearInterval(t.timerPaint);
   clearInterval(t.timerLookup);
  },

  show : function (){
   var t = Tabs.Raid;
   clearInterval(t.timerPaint);
   clearInterval(t.timerLookup);
   t.timerPaint = setInterval (t.paint,2000);
   t.timerLookup = setInterval(t.lookup, 3500);
  },
 };

uW.ptGotoMap = function (x, y){
  setTimeout (function (){
    ById('mapXCoor').value = x;
    ById('mapYCoor').value = y;
    uW.reCenterMapWithCoor();
    var a = ById("mod_views").getElementsByTagName("a");
    for (var b = 0; b < a.length; b++) {
        a[b].className = ""
    }
    ById('mod_views_map').className = "sel";
    ById("maparea_city").style.display = 'none';
    ById("maparea_fields").style.display = 'none';
    ById("maparea_map").style.display = 'block';
    uW.tutorialClear()
  }, 0);
};

function clickWinBO(win,obj,evtName) {
	var evt = win.document.createEvent("MouseEvents");
	evt.initMouseEvent(evtName, true, true, win, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
	return !obj.dispatchEvent(evt);
}
  function searchDOM (node, condition, maxLevel, doMult){
    var found = [];
    eval ('var compFunc = function (node) { return ('+ condition +') }');
    doOne(node, 1);
    if(!doMult){
      if (found.length==0)
        return null;
      return found[0];
    }
    return found;
    function doOne (node, curLevel){
      try {
        if (compFunc(node))
          found.push(node);
      } catch (e){
      }
      if (!doMult && found.length>0)
        return;
      if (++curLevel<maxLevel && node.childNodes!=undefined)
        for (var c=0; c<node.childNodes.length; c++)
          doOne (node.childNodes[c], curLevel);
    }
  }

function CwaitForElement (id, timeout, notify){
  this.check = check;
  this.end = new Date().getTime() + timeout;
  var t = this;
  this.check();
  function check(){
    if (ById (id))
      notify (true);
    else if (new Date().getTime() > t.end)
      notify (false);
    else
      setTimeout (t.check, 250);
  }
}

function ThroneItemName(e) {
  if (e.unique>0) {
   return uW.g_js_strings.throneRoom["unique_"+e.type+e.unique].replace("'"," ") +" +"+e.level;
  } else
   return e.createPrefix()+" "+e.type+" "+e.faction+" +"+e.level;
}
function CdialogCancelContinue (msg, canNotify, contNotify, centerElement,title){
  var pop = new CPopup ('ptcancont', 10, 10, 400,210, true, canNotify);
  if (centerElement)
    pop.centerMe(centerElement);

  if (title)
   pop.getTopDiv().innerHTML = '<b><CENTER>'+title+'</center></b>';
  else
   pop.getTopDiv().innerHTML = '<CENTER>ATTENTION</center>';
  pop.getMainDiv().innerHTML = '<div style="overflow-y:auto;max-height:160px;"><TABLE class=ptTab align=center style="height: 100%"><TR align=center height=90%><TD>'+ msg +'</td></tr>\
      <TR align=center><TD><INPUT id=ptok type=submit value="OK" \> &nbsp; &nbsp; </td></tr></table></div>';
  ById('ptok').addEventListener ('click', function (){pop.destroy(false); if (canNotify) canNotify();}, false);
  pop.show(true);
}

function saveAttackOptions (){
  var serverID = getServerId();
  setTimeout (function (){GM_setValue ('AttackOptions_'+serverID, JSON2.stringify(AttackOptions));}, 0);
}
function readAttackOptions (){
  var serverID = getServerId();
  s = GM_getValue ('AttackOptions_'+serverID);
  if (s != null){
    opts = JSON2.parse (s);
    for (k in opts){
      if (matTypeof(opts[k]) == 'object')
        for (kk in opts[k])
          AttackOptions[k][kk] = opts[k][kk];
      else
        AttackOptions[k] = opts[k];
    }
  }
}
function saveThroneOptions() {
    var serverID = getServerId();
    setTimeout(function () {
        GM_setValue('ThroneOptions_' + serverID, JSON2.stringify(ThroneOptions));
    }, 0);
}

function readThroneOptions() {
    var serverID = getServerId();
    s = GM_getValue('ThroneOptions_' + serverID);
    if (s != null) {
        opts = JSON2.parse(s);
        for (k in opts) {
            if (matTypeof(opts[k]) == 'object') for (kk in opts[k])
            ThroneOptions[k][kk] = opts[k][kk];
            else ThroneOptions[k] = opts[k];
        }
    }
}
function saveFarmOptions() {
    var serverID = getServerId();
    setTimeout(function () {
        GM_setValue('FarmOptions_' + serverID, JSON2.stringify(FarmOptions));
    }, 0);
}
function readFarmOptions() {
    var serverID = getServerId();
    s = GM_getValue('FarmOptions_' + serverID);
    if (s != null) {
        opts = JSON2.parse(s);
        for (k in opts) {
            if (matTypeof(opts[k]) == 'object') for (kk in opts[k])
            FarmOptions[k][kk] = opts[k][kk];
            else FarmOptions[k] = opts[k];
        }
    }
}
function readDashboardOptions (){
  var serverID = getServerId();
  s = GM_getValue ('DashboardOptions_'+serverID);
  if (s != null){
    opts = JSON2.parse (s);
    for (k in opts){
      if (matTypeof(opts[k]) == 'object')
        for (kk in opts[k])
          DashboardOptions[k][kk] = opts[k][kk];
      else
        DashboardOptions[k] = opts[k];
    }
  }
}
function saveApothecaryOptions (){
  var serverID = getServerId();
  setTimeout (function (){GM_setValue ('ApothecaryOptions_' + Seed.player.name + '_' +serverID, JSON2.stringify(ApothecaryOptions));}, 0);
}
function readApothecaryOptions (){
  var serverID = getServerId();
  s = GM_getValue ('ApothecaryOptions_'+Seed.player.name+'_'+serverID, '[]');
  if (s != null){
    opts = JSON2.parse (s);
    for (k in opts){
      if (matTypeof(opts[k]) == 'object')
        for (kk in opts[k])
          ApothecaryOptions[k][kk] = opts[k][kk];
      else
        ApothecaryOptions[k] = opts[k];
    }
  }
}

/*******************   KOC Map interface ****************/
// 0:bog, 10:grassland, 11:lake, 20:woods, 30:hills, 40:mountain, 50:plain, 51:city / barb, 53:misted city
function CMapAjax (){
  this.normalize = normalize;
  this.request = request;

  function request (left, top, width, notify){
    var left = parseInt(left / 5) * 5;
    var top = parseInt(top / 5) * 5;
    var width = parseInt((width+4) / 5) * 5;

    var blockString = generateBlockList(left, top, width);
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.blocks = blockString;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/fetchMapTiles.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        notify(left, top, width, rslt);
      },
      onFailure: function (rslt) {
        notify(left, top, width, rslt);
      }
    });
    function generateBlockList (left, top, width) {
      var width5 = parseInt(width / 5);
      var bl = [];
      for (x=0; x<width5; x++){
        var xx = left + (x*5);
        if (xx > 745)
          xx -= 750;
        for (y=0; y<width5; y++){
          var yy = top + (y*5);
          if (yy > 745)
            yy -= 750;
          bl.push ('bl_'+ xx +'_bt_'+ yy);
        }
      }
      return bl.join("%2C");
    }
  }

  function normalize  (x){
    if ( x >= 750)
      x -= 750;
    else if (x < 0)
      x += 750;
    return parseInt (x/5) * 5;
  }
}

function inspect(obj, maxLevels, level, doFunctions){
  var str = '', type, msg;
  if(level == null)  level = 0;
  if(maxLevels == null) maxLevels = 1;
  if(maxLevels < 1)
      return 'Inspect Error: Levels number must be > 0';
  if(obj == null)
    return 'ERROR: Object is NULL\n';
  var indent = '';
  for (var i=0; i<level; i++)
    indent += '  ';
  for(property in obj) {

    try {
        type =  matTypeof(obj[property]);
        if (doFunctions==true && (type == 'function')){
          str += indent + '(' + type + ') ' + property + "[FUNCTION]\n   " + ( (obj[property]==null)?(': null'):('')) +' = '+ obj[property] +"\n";
        } else if (type != 'function') {
          str += indent + '(' + type + ') ' + property + ( (obj[property]==null)?(': null'):('')) +' = '+ obj[property] +"\n";
        }
        if((type=='object' || type=='array') && (obj[property] != null) && (level+1 < maxLevels))
          str += inspect(obj[property], maxLevels, level+1, doFunctions);
    }
    catch(err) {
      if(typeof(err) == 'string') msg = err;
      else if(err.message)        msg = err.message;
      else if(err.description)    msg = err.description;
      else                        msg = 'Unknown';
      str += '(Error) ' + property + ': ' + msg +"\n";
    }
  }
  str += "\n";
  return str;
}

var messageNav = {
   mmFunc : null,   MapFunc :null,
   mmsFunc : null,
   init : function (){
     t = messageNav;
     var z = new CalterUwFunc("showCityTooltip",[[/showTooltip/,'a += "<div>"+g_js_strings.guardian[seed.guardian[j].type+"_fullName"]+"</div>";showTooltip']]);
	 z.setEnable(true);
     t.MapFunc = new CalterUwFunc ('modal_maptile', [[/}\s*$/, ';setTimeout(function() { BOMdal_hook(j,k,m,a,h,f,o); },0); }']]);
     t.mmFunc = new CalterUwFunc ('modal_messages', [[/}\s*$/, ';setTimeout(messageNav_hook,0);}']]);
     t.mmsFunc = new CalterUwFunc ('modal_messages_send', [[/{\s*var params/i, '{\nif (modal_messages_send_hook()) return;\nvar params']]);
     uW.messageNav_hook = t.hook;
     uW.BOMdal_hook = t.testons;
     uW.modal_messages_send_hook = t.msgSendHook;
     uW.boshowattack = t.showAttack;
	 uW.boshowtransport = t.boshowtransport;
     t.mmFunc.setEnable (true);
     t.mmsFunc.setEnable (true);
     t.MapFunc.setEnable (true);
   },
  setEnable : function (tf){
  },
  boshowtransport: function(x,y) {
       if (!Options.pbWinIsOpen)
        nHtml.Click(ById("ptBoite"));
        setTimeout(function(){
          nHtml.Click(ById("pbtcTranspAuto").firstChild.firstChild);
            setTimeout(function() {
  	      Tabs.TranspAuto.destinationCityx.value = x;
  	      Tabs.TranspAuto.destinationCityy.value = y;
  	      Tabs.TranspAuto.estimerRes();
        }, 100);
      }, 100);
  },
  showAttack:function(x,y) {
	     if (Options.ptWin2IsOpen){
	       nHtml.Click(ById("sppAttaque"));
	     } else {
	       nHtml.Click(ById("ptBoite2"));
	       nHtml.Click(ById("sppAttaque"));
	     }
   setTimeout(function() {
	   ById("RAAtypetrpx").value=x;
	   ById("RAAtypetrpy").value=y;
	   myBO.Attaque.rechercheDEST();
	   myBO.Attaque.estimerRes();
   }, 100);
  },
  isAvailable : function (){
    t = messageNav;
    return t.mmFunc.isAvailable();
  },
  testons :function(uid,x,y,a,h,f,o) {
    var div = ById('contextMenu');
   if (uid!=null && uid!=0 && uid!="0")
     $("#contextMenu").prepend('<div class=buttons><li><a class="buttonv2 red h20" href="javascript:void(0);" onclick=boshowthrone('+uid+',"'+f+'","Calc");>'+uW.g_js_strings.commonstr.throneroom+'</a></li></div>');
  	$("#contextMenu").prepend('<div class=buttons><li><a class="buttonv2 blue h20" href="javascript:void(0);" onclick="boshowtransport('+x+','+y+');">>> '+uW.g_js_strings.commonstr.transport+'<<</a></li></div>');
  	$("#contextMenu").prepend('<div class=buttons><li><a class="buttonv2 blue h20" href="javascript:void(0);" onclick="boshowattack('+x+','+y+');">>> '+lang.Attaque.attack+' <<</a></li></div>');
  	$("#contextMenu").prepend('<div class=buttons><li><a class="buttonv2 blue h20" href="javascript:void(0);" onclick="PTscout('+x+','+y+');">>> '+uW.g_js_strings.commonstr.scout+' <<</a></li></div>');
      var scr = document.createElement('div');
      scr.innerHTML = '<center><br><a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+x+','+y+')</a>'+uW.provincenames['p'+a]+'<br>';
      if (uid!=null && uid!=0 && uid!="0") {
		 scr.innerHTML += "<hr><span style='font-size:10px'>UID:<span onclick=\"if (document.getElementById('allPlayName'))document.getElementById('allPlayName').value="+uid+";\">" + uid +"</span></span>";
	  }
      scr.className = "maptilewrap";
      div.appendChild(scr);
       if (uid!=null && uid!=0 && uid!="0") {
      var params = uW.Object.clone(uW.g_ajaxparams);
      params.checkArr = uid;
      new MyAjaxRequest(uW.g_ajaxpath + "ajax/getOnline.php" + uW.g_ajaxsuffix, {
        method: "post",
        parameters: params,
      onSuccess: function (rslt) {
         var p = rslt.data;
	     if (p[uid] == true) {
	         m = '<br><span style="color:green;font-weight:bold;font-size:10px"><b>'+uW.g_js_strings.commonstr.online+'</b></span>';
	         scr.innerHTML += m;
	     } else {
	          m = '<br></b> <span style="color:red;text-decoration:line-through;font-weight:bold;font-size:9px"><b>'+uW.g_js_strings.commonstr.online+'</b></span>';
	          scr.innerHTML += m;
		 }
	        var params = uW.Object.clone(uW.g_ajaxparams);
      params.pid = uid;
      new MyAjaxRequest(uW.g_ajaxpath + "ajax/viewCourt.php" + uW.g_ajaxsuffix, {
        method: "post",
        parameters: params,
      onSuccess: function (rslt) {
         if (rslt.ok) {
		   if (!p[uid]) {
            scr.innerHTML += '<br><span style="color:green;font-size:9px"><b>'+rslt.playerInfo.lastLogin+'</b></span>';
	   	   }
		  var g=uW.g_js_strings.commonstr,h={1:g.normal,2:uW.g_js_strings.MapObject.begprotect,3:g.truce,4:g.vacation};
		  scr.innerHTML += '<br><span style="font-size:9px">'+h[rslt.playerInfo.warStatus]+'';
		  if (rslt.playerInfo.warStatus==3)
			   scr.innerHTML += ' >>> ' + getDuration(rslt.playerInfo.truceExpireTimestamp,8);
 		  scr.innerHTML+="</span>";
         }

         },onFailure: function (rslt) {},

         });

    },onFailure: function (rslt) {},
    });
   }
  },
  hook : function (){
   if (!Options.enhanceMsging)
      return;
    var div = ById('modal_msg_view_actions');
    div = ById('modal_msg_write_to').parentNode;
    div.innerHTML = '<TABLE><TR><TD class=xtab><b>A :</b> <INPUT type=text id=modal_msg_write_to></td>\
    <TD class=xtab></td></tr>\
    <tr><td></td><td></td></tr></table>\
    <table><tr><TD colspan=2><SPAN id=pt2fwdbut></span></td></tr></table>';
    ById('pt2fwdbut').innerHTML="Cc : <INPUT type=text id=message_cc>";
  },
  eventForward : function (){
    ById('modal_msg_write_subj').value = "TR: " + ById('modal_msg_view_subj').innerHTML.toString().stripTags();
    ById('modal_msg_write_to').value = '';
    var from = ById('modal_msg_view_from').children[0].innerHTML;
    var body = ById('modal_msg_view_body').innerHTML.replace(/\n/g, '').replace(/<br>/gi, '\n').stripTags().replace (/back$/i, '');
    ById('modal_msg_write_txt').value = '[Message original de '+ from +']\n'+ body;
    uW.modal_messages_compose();
  },
  msgSendHook : function (){
    if (!Options.enhanceMsging)
      return;
    var to = ById("modal_msg_write_to").value.trim();
      var chaine = ById("message_cc").value;
      if (chaine!="") {
      var tableau = chaine.split(";")
      if (tableau.length==0) tableau[0]=chaine;
      for (var i = 0; i < tableau.length; i++) {
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.emailTo = tableau[i] ;
        params.subject = "CC: "+ById("modal_msg_write_subj").value;
        params.message = ById("modal_msg_write_txt").value;
        params.requestType	 = 'COMPOSED_MAIL';
        new MyAjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
         method: "post",
         parameters: params,
         onSuccess: function (rslt) {
              if (rslt.ok) ById('message_cc').value = "";
         },
       });
      }
    }
  },
}

var AttackDialog = {
  init : function (){
    var t = AttackDialog;
    t.modal_attackFunc = new CalterUwFunc ('modal_attack', [[/}\s*$/, ';attackDialog_hook();}']]);
    uW.attackDialog_hook = t.modalAttackHook;
    t.modal_attackFunc.setEnable (true);
  },
  setEnable : function (){
  },
  isKnightSelectAvailable : function (){
    var t = AttackDialog;
    return t.modal_attackFunc.isAvailable();
  },
  isAttackCityPickerAvailable : function (){
    var t = AttackDialog;
    return t.modal_attackFunc.isAvailable();
  },

  modalAttackHook : function (){
    var t = AttackDialog;
    if (Options.fixKnightSelect || Options.attackCityPicker){
      for (var i=1; i<6; i++)
        ById('modal_attack_tab_'+ i).addEventListener('click', t.e_changeMarchType, false);
    }
    if (Options.attackCityPicker){
      setTimeout (t.initCityPicker, 0);
    }
  },

  initCityPicker : function (){
    var t = AttackDialog;
    var div = ById('modal_attack_target_numflag'); // as of KofC version 96;
    var mySpan;
    if (div) {
      div.parentNode.innerHTML += ' &nbsp; <SPAN id=modal_attack_citybuts></span>';
    } else {
      var span = ById('modal_attack_target_coords');   // KofC version 116+;
      span.parentNode.parentNode.firstChild.innerHTML += ' &nbsp; <SPAN id=modal_attack_citybuts></span>';
    }
    new CdispCityPicker ('ptatp', ById('modal_attack_citybuts'), false, t.e_CityButton);
    var cityIdx = Cities.byID[uW.currentcityid].idx;
    thisCityBut = ById('ptatp_'+ cityIdx);
    thisCityBut.style.opacity = '0.5';
    thisCityBut.disabled = true;
    if (ById('modal_attack_tab_4').className=='selected' || ById('modal_attack_tab_3').className=='selected')   // don't do for attack or scout
      ById('modal_attack_citybuts').style.display = 'none';
  },

  e_CityButton : function (city){
    ById('modal_attack_target_coords_x').value = city.x;
    ById('modal_attack_target_coords_y').value = city.y;
    uW.modal_attack_update_time();
  },

  e_changeMarchType : function (evt){
    var t = AttackDialog;
    var marchType = parseInt(evt.target.id.substr(17));
    if (Options.attackCityPicker){
      if (marchType==3 || marchType==4)
        ById('modal_attack_citybuts').style.display = 'none';
      else
        ById('modal_attack_citybuts').style.display = 'inline';
    }
    if (Options.fixKnightSelect){
      var knightVal = 0;
      var selector = ById('modal_attack_knight');
      if (selector.length>1 && (marchType==4 || marchType==2))   // if 'attack' or 'reinforce'
        knightVal = 1;
      selector.selectedIndex = knightVal;
    }
  },
}

var AllianceReports = {
  checkPeriod : 300,
  allianceNames : [],
  saveArfunc : uW.allianceReports,
  init : function (){
    t = AllianceReports;
    t.enable (Options.enhanceARpts);
    t.marvFunc = new CalterUwFunc ('modal_alliance_report_view', [['getReportDisplay', 'getReportDisplay_hook2']]);
    uW.avatars2 = avatars2;
    t.memListFunc = new CalterUwFunc ('membersInfo', [['commonstr.might','commonstr.might + "</td><td class=colcities>" + g_js_strings.commonstr.cities + "</td><td class=colava>Avatar</td><td class=collast>" + g_js_strings.membersInfo.lastonline'],['memberInfo[key].prestige\)', 'memberInfo[key].prestige)+ "</td>");memhtml.push("<td class=colcities>" + memberInfo[key].cities + "</td><td class=colava><img width=35 src=" + memberInfo[key].avatarurl + "></td>");memhtml.push("<td class=collast>" + memberInfo[key].lastLogin']]);
    t.getInfoForAnUserFunc = new CalterUwFunc ('getInfoForAnUser', [['(!cm.ProfileController.disabled)','(!avatars2[uid])'],['userInfo[0].avatarurl','(avatars2[userInfo[0].userId]?avatars2[userInfo[0].userId][1]:userInfo[0].avatarurl)']]);
    uW.getReportDisplay_hook2 = t.getReportDisplayHook;
    uW.getmembersInfo_hook = t.getMembersInfoHook;
    t.marvFunc.setEnable (true);
    t.getInfoForAnUserFunc.setEnable (true);
    t.enable_viewmembers(Options.enhanceViewMembers);
  },
  getReportDisplayHook : function (a, b){
    var x = '';
    try {
      x = uW.getReportDisplay(a,b);
    } catch (e){
      x = 'Error formatting report: '+ e;
    }
    return x;
  },
  enable_viewmembers : function (tf){
   t = AllianceReports;
   t.memListFunc.setEnable (tf);
  },
  enable : function (tf){
    t = AllianceReports;
    if (tf)
      uW.allianceReports = t.myAllianceReports;
    else
      uW.allianceReports = t.saveArfunc;
  },
  myAllianceReports : function (pageNum){
    var params = uW.Object.clone(uW.g_ajaxparams);
    if (pageNum)
      params.pageNo = pageNum;
    params.group = "a";
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/listReports.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        displayReports (rslt.arReports, rslt.arPlayerNames, rslt.arAllianceNames, rslt.arCityNames, rslt.totalPages);
      },
      onFailure: function (rslt) {
      },
    }, false);

    function displayReports (ar, playerNames, allianceNames, cityNames, totalPages){
      var msg = new Array();
      var myAllianceId = getMyAlliance()[0];
      msg.push ("<STYLE>.msgviewtable tbody .myCol div {margin-left:5px; overflow:hidden; white-space:nowrap; color:#000}\
            .msgviewtable tbody .myHostile div {font-weight:600; color:#600}\
            .msgviewtable tbody .myGray div {color:#666}\
            .msgviewtable tbody .myRein div {color:#050}\
            .msgviewtable tbody .myWarn div {font-weight:600; color:#442200}\
            </style>");
      msg.push("<div class='modal_msg_reports'>");
      var rptkeys = uW.Object.keys(ar);
      if (matTypeof(ar) != 'array') {
        if (Options.allowAlterAR)
          msg.push("<div id='modal_alliance_reports_tablediv' class='modal_msg_list'><table width=675 cellpadding='0' cellspacing='0' class='msgviewtable reportviewtable alliancetable'>");
        else
          msg.push("<div id='modal_alliance_reports_tabledivNKA' class='modal_msg_list'><table width=675 cellpadding='0' cellspacing='0' class='msgviewtable reportviewtable alliancetable'>");
        msg.push("<thead><tr><td width=105>Date</td><td width=40>Type</td><td width=150>"+uW.g_js_strings.commonstr.attacker+"</td><td>"+uW.g_js_strings.commonstr.target+"</td><td>Voir</td><td colspan=2>Dist. ville</tr></thead><tbody>");
        for (var i = 0; i < rptkeys.length; i++) {
          var rpt = ar[rptkeys[i]];
          var colClass = '"myCol"';
          rpt.marchType = parseInt(rpt.marchType);
          rpt.side0AllianceId = parseInt(rpt.side0AllianceId);
          var targetDiplomacy = getDiplomacy (rpt.side0AllianceId);
          if (rpt.marchType == 2){
            colClass = '"myCol myRein"';
          } else if (rpt.side1AllianceId != myAllianceId){
            colClass = '"myCol myHostile"';
          } else {
            if (parseInt(rpt.side0TileType) < 50){          // if wild
              if (parseInt(rpt.side0PlayerId) == 0)
                colClass = '"myCol myGray"';
              else
                colClass = '"myCol myWarn"';
            } else if (parseInt(rpt.side0PlayerId) == 0) {   // barb
              colClass = '"myCol myGray"';
            } else {
              if (targetDiplomacy == 'amicale')
                colClass = '"myCol myWarn"';
            }
          }
          msg.push ('<tr valign=top');
          if (i%2 == 0)
            msg.push(" class=stripe");
          msg.push("><TD class="+ colClass +"><div>");
          msg.push(uW.formatDateByUnixTime(rpt.reportUnixTime));
          msg.push ('<BR><a onclick=ptChatReportClicked('+rpt.reportId +',0,999)>Rpt #'+ rpt.reportId +'</a>');
          msg.push("</div></td><TD class="+ colClass  +"><div>");
          if (rpt.marchType == 1)
            msg.push (uW.g_js_strings.commonstr.transport);
          else if (rpt.marchType == 3)
            msg.push (uW.g_js_strings.commonstr.scout);
          else if (rpt.marchType == 2)
            msg.push ('Renf');
          else
            msg.push (uW.g_js_strings.commonstr.attack);
          msg.push ("</div></td><TD class="+ colClass +"><div>");
          if (parseInt(rpt.side1PlayerId) != 0)
            msg.push('<a onclick=getInfoForAnUser("'+parseInt(rpt.side1PlayerId)+'");>'+playerNames["p" + rpt.side1PlayerId]+"</a>");
          else
          msg.push ('?Unknown?');
          msg.push ('&nbsp;<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side1XCoord +','+ rpt.side1YCoord +')</a><bR>');
          if (rpt.side1AllianceId != myAllianceId){
            msg.push (allianceNames['a'+rpt.side1AllianceId]);
            msg.push (' (');
            msg.push (getDiplomacy(rpt.side1AllianceId));
            msg.push (')');
          } else {
            msg.push ('<BR>');
          }
          msg.push ('</div></td>');
          msg.push ("<TD class="+ colClass  +"><DIV>");
          var type = parseInt(rpt.side0TileType);
          if (type < 50){                              // pour la TS
            msg.push(uW.g_mapObject.types[type].toString().capitalize());
            msg.push(" Lvl " + rpt.side0TileLevel)
            if (parseInt(rpt.side0PlayerId) != 0) {   // IF OWNED, show owner ...
              	msg.push (' [');
  		msg.push ('<a onclick=getInfoForAnUser("'+parseInt(rpt.side0PlayerId)+'");>' + playerNames["p" + rpt.side0PlayerId]+'</a>');
              	msg.push ('] ');
            }
          } else {
            if (parseInt(rpt.side0PlayerId) == 0) {   //  barb
              msg.push(uW.g_js_strings.commonstr.barbariancamp);
              msg.push(" Lvl " + rpt.side0TileLevel)
            } else {        // city
              msg.push ('<a onclick=getInfoForAnUser("'+ rpt.side0PlayerId+'");>' + playerNames["p" + rpt.side0PlayerId]+'</a>');
              msg.push (' - ');
              msg.push (cityNames['c'+ rpt.side0CityId]);
            }
          }
          msg.push ('&nbsp;<a href="javascript:void(0)" onclick="cm.utils.CoordinateLinkController.onClick(event)" class="coordinateLink">('+ rpt.side0XCoord +','+ rpt.side0YCoord +')</a>');
          if (rpt.side0AllianceId!=0 && rpt.side0AllianceId!=myAllianceId){
            msg.push ('<BR>');
            msg.push (allianceNames['a'+rpt.side0AllianceId]);
            msg.push (' (');
            msg.push (targetDiplomacy);
            msg.push (')');
          }
          if (Options.allowAlterAR)
            msg.push("</div></td><TD class="+ colClass  +"><div><a onclick=' modal_alliance_report_view(\"");   // ONCLICK ???
          else
            msg.push("</div></td><TD class="+ colClass  +"><div><a onclick=' ById(\"modal_alliance_reports_tabledivNKA\").id=\"modal_alliance_reports_tablediv\"; modal_alliance_report_view(\"");   // ONCLICK ???
          msg.push(rpt.reportId);
          msg.push('",');
          if (parseInt(rpt.side1AllianceId) == parseInt(Seed.allianceDiplomacies.allianceId))
            msg.push(1);
          else
            msg.push(0);
          msg.push(",");
          msg.push(rpt.side0TileType);
          msg.push(",");
          msg.push(rpt.side0TileLevel);
          msg.push(",");
          msg.push(rpt.side0PlayerId);
          msg.push(',"');
          if (parseInt(rpt.side0PlayerId) != 0)
            msg.push(playerNames["p" + rpt.side0PlayerId]);
          else
            msg.push(uW.g_js_strings.commonstr.enemy);
          msg.push('","');
          if (parseInt(rpt.side0PlayerId) != 0)
            msg.push(playerNames["g" + rpt.side0PlayerId]);
          else
            msg.push(0)
          msg.push('","');
          if (parseInt(rpt.side1PlayerId) > 0)
            msg.push(playerNames["p" + rpt.side1PlayerId]);
          msg.push('","');
          if (parseInt(rpt.side1PlayerId) != 0)
            msg.push(playerNames["g" + rpt.side1PlayerId]);
          msg.push('",');
          msg.push(rpt.marchType);
          msg.push(",");
          msg.push(rpt.side0XCoord);
          msg.push(",");
          msg.push(rpt.side0YCoord);
          msg.push(",");
          msg.push(rpt.reportUnixTime);
          msg.push(",");
          if (parseInt(rpt.reportStatus) == 2)
            msg.push(1);
          else
            msg.push(0);
          if (rpt.side1XCoord) {
            msg.push(",");
            msg.push(rpt.side1XCoord);
            msg.push(",");
            msg.push(rpt.side1YCoord)
          } else {
            msg.push(",,");
          }
          msg.push(");return false;'><img border=0 src='"+SEARCHBTN+"'></a></div></td></tr>");
        }
        msg.push("</tbody></table></div>");
      }
      msg.push("</div><div id='modal_report_list_pagination'></div>");
      ById('allianceContent').innerHTML = msg.join("");
      if (pageNum) {
        uW.ctrlPagination("modal_report_list_pagination", totalPages, "allianceReports", pageNum)
      } else {
        uW.ctrlPagination("modal_report_list_pagination", totalPages, "allianceReports")
      }
    }
  },
}

/************************ Food Alerts  *************************/
var FoodAlerts = {
  init : function (){
   var f = FoodAlerts;
  },
  e_eachMinute : function (){
    var f = FoodAlerts;
    var now = unixTime();
    row = [];
    //actionLog("Pommes", parseIntNan(Options.FoodAlertChecked + 1200) +" < " + now +" -"+Options.enableFoodWarnTchat);
    if (parseIntNan(Options.FoodAlertChecked + 1200) < now && Options.enableFoodWarnTchat)  {
      for(i=0; i < Cities.numCities; i++) {
		var rp = getResourceProduction (Cities.cities[i].id);
		var foodleft = parseInt(Seed.resources["city" + Cities.cities[i].id]['rec1'][0])/3600;
		var usage = rp[1];
        row[i] = rp[1];
		var timeLeft = parseInt(Seed.resources["city" + Cities.cities[i].id]['rec1'][0]) / 3600 / (0-usage) * 3600;
		var msg = '';
        if (usage<0){
          if (timeLeft<(Options.foodWarnHours*3600)) {
                msg += lang.FoodAlerts.msg1 + ' ' + Cities.cities[i].name.substring(0,10) + ' # ' +
                       Cities.cities[i].x +','+ Cities.cities[i].y + ' # ';
                msg += lang.FoodAlerts.msg2 + ' '+addCommasWhole(foodleft).replace(',',' ').replace(',',' ').replace(',',' ').replace(',',' ')+' ('+timestrShort(timeLeft)+') '+lang.FoodAlerts.msg3+' '+addCommas(usage).replace(',',' ').replace(',',' ').replace(',',' ').replace(',',' ')+'/h';
                sendChat ("/a " + msg);
           }
        }
      }
      Options.FoodAlertChecked = now;
	  saveOptions();
     }
  },
}

function sendEmail (username, token, email, subject, msg){
 var query = "?user="+username+"&token="+Options.alertConfig.token+"&email="+email+"&subject="+subject+"&msg1="+msg;
 query=query.replace(/#/g,'%23');
 new MyAjaxRequest("http://ddflux.cluster014.ovh.net/bao/email.php" + query, {
	      method: "POST",
	      onSuccess: function (rslt) {},
	      onFailure: function () {},
    });
}
function getResourceProduction (cityId){
  var ret = [0,0,0,0,0];
  for (var i=1; i<5; i++){
    ret[i] = uW.cm.Resources.getProduction(i,cityId);
  }
  return ret;
}

function IsNumeric(input)
{
   return (input - 0) == input && input.length > 0;
}

function parseIntNan (n){
  x = parseInt(n, 10);
  if (isNaN(x))
    return 0;
  return x;
}
function parseIntCommas (n){
  n = n.split(',');
  n = n.join('');
  x = parseInt(n, 10);
  if (isNaN(x))
    return 0;
  return x;
}
function parseIntZero (n){
  n = n.trim();
  if (n == '')
    return 0;
  return parseInt(n, 10);
}

/*******************   KOC Map interface ****************/
Map = {
/***
 0: bog
10: grassland
11: lake
20: woods
30: hills
40: mountain
50: plain
51: city / barb
53: misted city
***/
  generateBlockList : function(left, top, width) {
    var width5 = parseInt(width / 5);
    var bl = [];
    for (x=0; x<width5; x++){
      xx = left + (x*5);
      if (xx > 745)
        xx -= 750;
      for (y=0; y<width5; y++){
        yy = top + (y*5);
        if (yy > 745)
          yy -= 750;
        bl.push ('bl_'+ xx +'_bt_'+ yy);
      }
    }
    return bl.join(",");
  },
  callback : null,
  request : function (left, top, width, cb) {
    left = parseInt(left / 5) * 5;
    top = parseInt(top / 5) * 5;
    width = parseInt((width+4) / 5) * 5;
    var blockString = this.generateBlockList(left, top, width);
    Map.callback = cb;
    if (uW.SANDBOX)
      return RequestMAPTEST(left, top, width, callback);
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.blocks = blockString;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/fetchMapTiles.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        Map.callback(left, top, width, rslt);
      },
      onFailure: function (rslt) {
        Map.callback(left, top, width, rslt);
      }
    });
  },
};

var RepairAuto = {
 timer : null,
 repairtimer: null,
 init: function (){
     if (!Options.salvageconfig.Repairrunning) return;

     RepairAuto.setEnable();
  },
 setEnable: function (){
     var t = RepairAuto;
     clearTimeout (t.repairtimer);
     t.tableau=[];
     t.repairtimer = setTimeout (t.count, 1*1000);
 },
 count:function() {
  var t = RepairAuto;
  var lignauto = Seed.throne.rowNum * 5, i=uW.kocThroneItems;
  var nbl=0;
  t.tableau=[];
  clearTimeout (t.repairtimer);
  if (!Options.salvageconfig.Repairrunning) return;

  var final = new Array();
  for (var K in i) {
	  e=uW.kocThroneItems[i[K].id];
	  if (e.isBroken)
		final.push({id:e.id,level:e.level});
  }
  final=final.sort(function sort(a,b) {a = a['level'];b = b['level'];return a == b ? 0 : (a > b ? -1 : 1);});

 //actionLog("Repair", final[0].id+"-"+final[0].level);

  for (var z in final) {
     e=uW.kocThroneItems[final[z].id];
     if (e) {
	  if (e.isBroken && nbl<=lignauto) {
	   if (Seed.queue_throne) {
	    if (Seed.queue_throne.itemId!=e.id)
	       t.tableau.push(e.id);
	   } else {
	       t.tableau.push(e.id);
	  }
	}
   }
  }
  var timeLeft=-1;
  if (Seed.queue_throne) {
         if (Seed.queue_throne.end)
            timeLeft = Seed.queue_throne.end - uW.unixtime();
  }
  if (t.tableau.length>0 && timeLeft<0) {
     //var itemId = t.tableau[Math.floor(Math.random()*t.tableau.length)]; // 1 au pif ^^
     var itemId = t.tableau[0];
     actionLog("AutoRepair", "Lancement du " + ThroneItemName(uW.kocThroneItems[itemId]) + " - il y a " + t.tableau.length + " a reparer");
     t.repair(itemId);
  } else {
   if (timeLeft>0) {
     actionLog("AutoRepair", "Reparation deja en cours... attente "+timeLeft+" s +5");
    t.repairtimer = setTimeout (t.count, (timeLeft+5)*1000);
   } else {
    actionLog("AutoRepair", "Rien a reparer... attente 5 minutes");
    t.repairtimer = setTimeout (t.count, (5*60)*1000);
   }
  }


 },
 repairId:0,
 repariend:null,
 countRepair:0,
 clearRepair:function() {
   var t = RepairAuto;
     if (t.repairId != 0)
   	      {
   	    		 uW.kocThroneItems[t.repairId].isBroken = false;
   		     uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
   		     t.repairId = 0;
   	      }
 },
 repair: function(id) {
    var t = RepairAuto;
    clearTimeout (t.repairtimer);
    if (!Options.salvageconfig.Repairrunning) return;
    if (uW.kocThroneItems[id]) {
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.action="timeRepair";
        params.ctrl="throneRoom\\ThroneRoomServiceAjax";
        params.throneRoomItemId=id;
        uW.ajax.Request(uW.g_ajaxpath+"ajax/_dispatch53.php"+uW.g_ajaxsuffix,{method:"post",parameters:params,loading:true,
         onSuccess:function(transport) {
          var m = eval("(" + transport.responseText + ")");
          if (m.ok === true){
           Seed.queue_throne.start = uW.unixtime();
           Seed.queue_throne.end = m.eta;
           Seed.queue_throne.itemId = id;
           t.repairId = id;
	   t.repairend = m.eta;
	   uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
	   var x = m.eta - unixTime();
	   setTimeout(t.clearRepair, (x+1)*1000);
           t.countRepair=0;
           duree= Seed.queue_throne.end - Seed.queue_throne.start + 5;
           actionLog("AutoRepair", "Reparation ok de " + ThroneItemName(uW.kocThroneItems[id]) + " duree : " +duree +"s");
            t.repairtimer = setTimeout (t.count, (duree)*1000);
           } else {
            t.countRepair++;
            actionLog("AutoRepair", "<font color=red>Reparation erreur </font> de " + ThroneItemName(uW.kocThroneItems[id]));
            if (t.countRepair>5) {
              t.countRepair=0;
              t.repairtimer = setTimeout (t.count, (2*60)*1000);
            } else {
              setTimeout(function() { t.repair(id); },2000);
            }

           }
         }
    });

   } else {
     actionLog("AutoRepair", "Reparation ID inexistant");
     t.repairtimer = setTimeout (t.count, (2*60)*1000);
   }
  },
}
/*********************************** Throne Tab ***********************************/

Tabs.Throne = {
  tabOrder : 19,
  tabLabel : lang.AUTOTRONE.label,
  cont : null,
  curTabBut : null,
  curTabName : null,
  SelId:null,
  log:[],
  SalvageLog:[],
  timersalvage:null,
  setActionTimer:null,
  SalvageArray:[],
  SalvageRunning:false,
  LastDeleted:0,
  panelType: "upgrade",panelNextLevel : 2,panelId: -1,
  EquipType: ["ALL","Advisor","Chair","Table","Windows","Banner","Trophy","Candelabrum","Hero"],

  init : function (div){
    var t = Tabs.Throne;
    t.cont = div;
    uW.BOTRclickNext    = Tabs.Throne.showNext;
    uW.cm.FETemplates.Throne.thronePanel = uW.cm.FETemplates.Throne.thronePanel.replace(
	            '<div id="nextStatContainer" class="nextStat"><span> Next </span>',
	    '<div id="nextStatContainer" class="nextStat" onclick="BOTRclickNext()"><span> Next *Click Me* </span>');

    var a = JSON2.parse(GM_getValue ('ThroneHistory_'+getServerId(), '[]'));
    if (matTypeof(a) == 'array') t.log = a;
    var a = JSON2.parse(GM_getValue ('ThroneSalvageHistory_'+getServerId(), '[]'));
    if (matTypeof(a) == 'array') t.SalvageLog = a;

    if (Options.BORac_Salvage2) AddSubTabLink('Salv V2', t.S2togglePower, 'BOautosalvageV2');
    if (Options.BORac_Upg) AddSubTabLink('Upgrade', t.toggleThroneState, 'BOautoupgradetab');

    if (salvageData.salvageActive) {
     if (Options.BORac_Salvage2) updatebotbutton("Salv V2 - ON", 'BOautosalvageV2');
      t.timersalvage=setTimeout(t.S2start, 2000);
    } else {
     if (Options.BORac_Salvage2) updatebotbutton("Salv V2 - OFF", 'BOautosalvageV2');
    }


    if (ThroneOptions.Active == true) {
    	if (Options.BORac_Upg) updatebotbutton("Upgrade - ON", 'BOautoupgradetab');
      		}else{
  			if (Options.BORac_Upg) updatebotbutton("Upgrade - OFF", 'BOautoupgradetab');

    }
    var main = '<TABLE align=center><TR><TD><INPUT class=pbSubtab ID=ptmrchSubS2l type=submit value="'+lang.AUTOTRONE.Autosalvage+' V2"></td>';
    main +='<TD><INPUT class=pbSubtab ID=ptmrchSubUE type=submit value="'+lang.AUTOTRONE.Upgrade+'"></td></td>';
	main +='<TD><INPUT class=pbSubtab ID=ptmrchSubST type=submit value="'+lang.AUTOTRONE.Stats+'"></td><TD><INPUT class=pbSubtab ID=ptmrchSubOR type=submit value="'+lang.AUTOTRONE.equip.equip+'"></td><TD><INPUT class=pbSubtab ID=ptmrchSubPR type=submit value="Preset"></td><TD><INPUT class=pbSubtab ID=ptmrchSubTC type=submit value="Caps"></td></tr></table><HR class=ptThin>';
    main +='<DIV id=ThroneOutput style="width:760px;margin-top:4px;  max-height:'+(Options.HauteurBoite-85)+'px; height:'+(Options.HauteurBoite-85)+'px; overflow-y:auto"></div>';

    t.cont.innerHTML = main;
    t.Overv = ById('ThroneOutput');

    ById('ptmrchSubS2l').addEventListener('click', e_butSubtab, false);
    ById('ptmrchSubUE').addEventListener('click', e_butSubtab, false);
    ById('ptmrchSubST').addEventListener('click', e_butSubtab, false);
    ById('ptmrchSubOR').addEventListener('click', e_butSubtab, false);
	ById('ptmrchSubTC').addEventListener('click', e_butSubtab, false);
	ById('ptmrchSubPR').addEventListener('click', e_butSubtab, false);
    setTimeout(function() {

    changeSubtab (ById(Options.curMarchTab));

    },1000);

    function e_butSubtab (evt){
      changeSubtab (evt.target);
    }

    function changeSubtab (but){
      if (but == t.curTabBut)
        return;
      if (t.curTabBut){
        t.curTabBut.className='pbSubtab';
        t.curTabBut.disabled=false;
      }
      t.curTabBut = but;
      but.className='pbSubtab pbSubtabSel';
      but.disabled=true;
      t.curTabName = but.id.substr(9);
      Options.curMarchTab = but.id;
      saveOptions();

      t.show ();
    }
    t.checkUpgradeInfo(true);
 },
 Caps : function (){
 	 var t = Tabs.Throne;
 	 var m = '<DIV class=boStat><b>Throne Room Caps</b></div><TABLE border=2px align=center>';
 	 m += '<TR><TD width="150px"><B>Boost Name</b></td><TD width="50px"><B>Max</b></td><TD><B>Min</b></td><TD style="border:0;width:50px"></td><TD width="150px"><B>Boost Name</b></td><TD width="50px"><B>Max</b></td><TD width="50px"><B>Min</b></td></tr><TR>';
 	 var counter =0;
 	 for (k in uW.cm.thronestats.boosts){
 	  counter++;
 	  var boost = uW.cm.thronestats.boosts[k];
 	  m += '<TD>'+ boost.BoostName + '</td><TD>'+ boost.Max +'<SPAN id=maxPerc_'+k+'></div></td><TD>' + boost.Min + '<SPAN id=minPerc_'+k+'></div>';
 	  if (counter % 2 == 0){
 	 	 	m += '<TR>';
 	  }else {
 	 	 	m += '</td><TD style="border:0">';
 	  }
 	 }
 	 m += '</table><br><DIV class=boStat><b>'+lang.AUTOTRONE.stats.viewThroneStats+'</b></div>';


 	 function calc(ue, item, level, H) {
 			var C = {
 				"0": 0,
 				"1VL": 0.005,
 				"2VL": 0.0175,
 				"3VL": 0.035,
 				"4VL": 0.0575,
 				"5VL": 0.085,
 				"1L": 0.1175,
 				"2L": 0.155,
 				"3L": 0.1975,
 				"1ML": 0.245,
 				"2ML": 0.2975,
 				"3ML": 0.355,
 				"1M": 0.4175,
 				"2M": 0.485,
 				"3M": 0.5575,
 				"1MH": 0.635,
 				"2MH": 0.7175,
 				"1H": 0.805,
 				"2H": 0.8975,
 				"1EH": 0.9725,
 				"2EH": 1
 			};
 			var z = C[uW.cm.thronestats[ue][level]["Base"]];
 			var A = 1;
 			if (uW.cm.WorldSettings.getSettingAsObject("TR_BUFF_ITEM_MODIFIERS")[H]) {
 				A = +uW.cm.WorldSettings.getSettingAsObject("TR_BUFF_ITEM_MODIFIERS")[H]["Chance"] || 1;
 			}
 			var y = 0;
 			if (H && H > 0) {
 				y += A - 1;
 			}
 			y += uW.cm.HeatUpModel.getModifierPercentage() + Seed.tech.tch17 / 100;
 			y = (z * y) / (1 - z);
 			var min = Math.min(y, 1);
 			min = Math.round(min * 10000) / 100;
 			return min;
 		}
 		var e = [
 			uW.g_js_strings.throneRoom.common,
 			uW.g_js_strings.throneRoom.uncommon,
 			uW.g_js_strings.throneRoom.rare,
 			uW.g_js_strings.throneRoom.epic,
 			uW.g_js_strings.throneRoom.wondrous,
 		];
 		var z = [{
 			id: 0,
 			name: uW.g_js_strings.throneRoom.buff_none,
 		}, uW.ksoItems["20001"], uW.ksoItems["20002"], uW.ksoItems["20003"],
 		uW.ksoItems["20004"]];
 		var n = [{id: 0,name: uW.g_js_strings.throneRoom.buff_none,}, uW.ksoItems["20001"], uW.ksoItems["20002"], uW.ksoItems["20005"], uW.ksoItems["20006"], uW.ksoItems["20019"]];
 		m += '<TABLE class=pbTab>';
 		m += "<tr>";
 		m += '<td colspan=3><b style="color:maroon;">'+lang.AUTOTRONE.stats.viewThroneStatsAdd+'</b></td>';
 		m += "</tr>";
 		m += "<tr>";
 		m += '<td>'+uW.techcost.tch17[0]+':&nbsp;&nbsp;</td>';
 		m += '<td>'+Seed.tech.tch17 / 100+'%</td>';
 		m += '<td>(max 0.12%)</td>';
 		m += "</tr>";
 		m += "<tr>";
 		m += '<td>'+uW.g_js_strings.throneRoom.activity_bonus+':&nbsp;&nbsp;</td>';
 		m += '<td>'+(Math.round(uW.cm.HeatUpModel.getModifierPercentage() * 100) / 100)+'%</td>';
 		m += '<td>(max 0.15%)</td>';
 		m += "</tr>";
 		m += '</table>';
 		m += '<br><br>';
 		m += '<TABLE width="100%" class=pbTab>';
 		m += "<tr>";
 		m += '<td colspan=13><b style="color:maroon;">'+lang.AUTOTRONE.stats.viewThroneStatsUpgrade+'</b></td>';
 		m += "</tr>";
 		m += "<tr>";
 		m += '<td>&nbsp;</td>';
 		for (var i = 1; i<14; i++) m+= '<td style="text-align:center;"><b>+'+i+'</b></td>';
 		for (var buff = 0; buff < n.length; buff++) {
 			m += "<tr>";
 			m += '<td>'+n[buff].name+'</td>';
 			for (var i = 1; i<14; i++) {
 				m+= '<td style="text-align:center;">'+calc("upgrade",buff, i, n[buff].id)+'%</td>';
 			}
 			m += "</tr>";
 		}
 		m +='</table>';
 		m +='<br><br>';
 		m += '<TABLE width="100%" class=pbTab>';
 		m += "<tr>";
 		m += '<td colspan=13><b style="color:maroon;">'+lang.AUTOTRONE.stats.viewThroneStatsEnhance+'</b></td>';
 		m += "</tr>";
 		m += "<tr>";
 		m += '<td>&nbsp;</td>';
 		for (var i = 0; i<5; i++) m+= '<td style="text-align:center;"><b>'+e[i]+'</b></td>';
 		for (var buff = 0; buff < z.length; buff++) {
 			m += "<tr>";
 			m += '<td>'+z[buff].name+'</td>';
 			for (var i = 0; i<5; i++) {
 				m+= '<td style="text-align:center;">'+calc("enhance",buff, i+1, z[buff].id)+'%</td>';
 			}
 			m += "</tr>";
 		}
 		m +='</table>';
 		m +='<br><br>';
 		m +='<div style="text-align:center;"><input type="submit" value="'+lang.AUTOTRONE.stats.viewThroneStatsCalc+'" id="pbThroneStatsCalc"></div>';

 t.Overv.innerHTML = m;
  	 for (k in uW.cm.thronestats.boosts){
  	 	 	var boost = uW.cm.thronestats.boosts[k];
  	 	 	if (boost.CapType == "percent"){
  	 	 	 ById('maxPerc_'+k).innerHTML = '%';
  	 	 	 if (boost.Min != "none"){
  	 	 	  ById('minPerc_'+k).innerHTML = '%';
  	 	 	 }
 	    }
 	 }
 		ById("pbThroneStatsCalc").addEventListener ('click', function (){
 			t.Caps();
 		}, false);

	},
 SalvageV2: function (){
      var t = Tabs.Throne;
  var m = '<Div><DIV id=trSalvage class=boStat><b>'+lang.AUTOTRONE.autosalvage2.title+'</b> - <input type=button value="?" id=boaidesalvage class=boAide></div>';
             m += "<div id='BOInfoArea'>";
             m += '</div>';
             m += '<TABLE id=tBOupgrader width =100% height=0% class=ptTab style="padding-left: 20px;">';
             if (salvageData.salvageActive == false) {
                 m += '<tr><TD><div><INPUT id=BOSalvagerPower type=submit value="Salvager = OFF"/>&nbsp;<INPUT id=ShowSalvageHistory type=submit value="'+lang.AUTOTRONE.history+'"></div></td>';
             } else {
                 m += '<tr><TD><div><INPUT id=BOSalvagerPower type=submit value="Salvager = ON"/>&nbsp;<INPUT id=ShowSalvageHistory type=submit value="'+lang.AUTOTRONE.history+'"></div></td>';
             }
             m += '<td><b> '+lang.AUTOTRONE.autosalvage2.BOSalvageCity+' </b></td>';
             m += "<td><div id='BOSalvageCity'></td><td></td></tr>";
             m += '<td>'+lang.AUTOTRONE.autosalvage2.BOSaveNum+' <INPUT id=BOSaveNum type=text size=3 maxlength=3 value="' + salvageData.throneSaveNum+ '"/> items</td><td><INPUT id=BOUpgradeP1 type=checkbox '+ (salvageData.UpgradeP1?' CHECKED':'') +'/>'+lang.AUTOTRONE.autosalvage2.UpgradeP1+'</td>';
             m += '<td><div><INPUT id=BOSalAnyCity type=checkbox '+ (salvageData.anyCity?' CHECKED':'') +'/> '+lang.AUTOTRONE.autosalvage2.BOSalAnyCity+'</div></td>';
		     m += '<tr><td><input type=checkbox id=BOSTripleSalvage '+ (ThroneOptions.SalvageTriple?'CHECKED ':'') +'> '+lang.AUTOTRONE.autosalvage.BOSTripleSalvage+'<td>'+lang.AUTOTRONE.autosalvage2.BOMaxStone+' <INPUT id=BOMaxStone type=text size=7 maxlength=7 value="' + salvageData.maxStones+ '"/><TD>'+lang.AUTOTRONE.autosalvage2.BOOverflow+' <select id=BOOverflow><option value="order">'+lang.AUTOTRONE.autosalvage2.BOOverflow1+'</option><option value="lowest">'+lang.AUTOTRONE.autosalvage2.BOOverflow2+'</option>  </select>';
             m += "</tr><tr><td colspan=3>"+lang.AUTOTRONE.autosalvage.alert+"</table><hr>";
             m += "<div id='BORulesCreate' class='BORuleCreate'>";
             m += '<TABLE width=100% class=trTabPad style="padding-left: 10px;">';
             m += '<tr><td>  <b>'+lang.AUTOTRONE.autosalvage2.rulestitle+' </b> </td>';
             m += '<td alight="left"><div><span>'+uW.g_js_strings.commonstr.faction+': <select id="BOFactionType">';
             m += '  <option value="any">'+lang.AUTOTRONE.autosalvage2.any+'</option>';
             m += '  <option value="fey">Fey</option>';
             m += '  <option value="briton">Briton</option>';
             m += '  <option value="druid">Druid</option>';
             m += '</select></span></div></td>';
             m += '<td alight="left"><div><span>'+lang.AUTOTRONE.autosalvage2.BOCardType+' <select id="BOCardType">';
             m += '  <option value="any">'+lang.AUTOTRONE.autosalvage2.any+'</option>';
             m += '  <option value="chair">'+uW.g_js_strings.throneRoom.chair+'</option>';
             m += '  <option value="table">'+uW.g_js_strings.throneRoom.table+'</option>';
             m += '  <option value="window">'+uW.g_js_strings.throneRoom.window+'</option>';
             m += '  <option value="banner">'+uW.g_js_strings.throneRoom.banner+'</option>';
             m += '  <option value="advisor">'+uW.g_js_strings.throneRoom.advisor+'</option>';
             m += '  <option value="trophy">'+uW.g_js_strings.throneRoom.trophy+'</option>';
             m += '  <option value="candelabrum">'+uW.g_js_strings.throneRoom.candelabrum+'</option>';
              m += '  <option value="hero">'+uW.g_js_strings.throneRoom.hero+'</option>';
             m += '</select></span></div></td>';
             m += '<td align="right"><INPUT id=BOAddRule type=submit value="'+lang.AUTOTRONE.autosalvage2.BOAddRule+'"/></td>';
             m += '</tr></table>';
             m += '<TABLE  class=trTabPad width=100% id="BOConditionTable"  style="padding-left: 5px;">';
             m += '<tr><td align=left colspan=1><INPUT id=BOAddRow type=submit value="'+lang.AUTOTRONE.autosalvage2.BOAddRow+'"/></td>';
             m += '<td></td><td></td><td></td><td></td><td></td></tr>';
             m += '</table>';
             m += '</div><hr/>';
             m += '<div id="BOSalvStatus" style="text-align: center;" >'+lang.AUTOTRONE.autosalvage2.BOSalvStatus+' </div><hr/>';
             m += '<div class=BORulePane>';
             m += '<div align=center  class=boStat> <b> '+lang.AUTOTRONE.autosalvage2.explainRules+' </b></div>';
             m += "<div id='BORuleDisplay' style=' max-height:"+(Options.HauteurBoite-400)+"px; height:"+(Options.HauteurBoite-400)+"px; overflow-x: auto; overflow-y:scroll;'>";
             m += '</div></div>';
             t.Overv.innerHTML = m;
             new CdispCityPicker ('BOcitysel', ById('BOSalvageCity'), true, t.e_CityButton, upgradeData.sCityNum);
		    ById('ShowSalvageHistory').addEventListener('click', function(){t.PaintSalvageHistory()} , false);
			 $('#BOSalAnyCity').change( function(){ salvageData.anyCity = ById('BOSalAnyCity').checked; saveSalvageData(); });
			 $("#BOMaxStone").change ( function() { salvageData.maxStones = $("#BOMaxStone").val();saveSalvageData();});
			 ById("BOUpgradeP1").addEventListener('click', function(e){
						salvageData.UpgradeP1=ById("BOUpgradeP1").checked;
						saveSalvageData();
	 		 },false);
           	 ById ('BOSaveNum').addEventListener ('change', function() {
				 salvageData.throneSaveNum = parseInt($("#BOSaveNum").val());
				 if (upgradeData.retryInterval < 0) salvageData.throneSaveNum = 0;
				 saveSalvageData();
				}, false);
				ById("BOSTripleSalvage").addEventListener('click', function(e){
						ThroneOptions.SalvageTriple=ById("BOSTripleSalvage").checked;
						saveThroneOptions();
	  },false);
             $("#BOOverflow").val(salvageData.overflow);
             $("#BOOverflow").change( function() { salvageData.overflow = $("#BOOverflow").val(); saveSalvageData();});
             ById ('BOAddRow').addEventListener ('click', function() {t.S2createRow();}, false);
             ById ('BOAddRule').addEventListener ('click', function() {t.S2createRule();}, false);
   		     ById('boaidesalvage').addEventListener('click', function(){
 	       	   window.open(sitesupport+"?page=aide_autosalvage");
    		 } , false);
    		 t.S2createRow();
             t.S2buildRuleDisplay();
 },
 rowNum:0,
 S2createRow : function()
         {
              var t = Tabs.Throne;
             var table = ById('BOConditionTable');
             var rowCount = table.rows.length;
             var row = table.insertRow(rowCount-1);
             var rowId = "BOr" + t.rowNum;
             t.rowNum++;
             row.id = rowId;

             var h  = "<td> <select id='" + rowId + "sel1'> <option value='true'> </option> <option value='false'>"+lang.AUTOTRONE.autosalvage2.row1+"</option></select></td>";
             h += "<td> <select id='" + rowId + "sel2'>";
             h += "  <option value='1'>1x</option>";
             h += "  <option value='2'>2x</option>";
             h += "  <option value='3'>3x</option>";
             h += "  <option value='4'>4x</option>";
             h += "  <option value='5'>5x</option>";
             h += "</select></td>";
             h += "<td> <select id='" + rowId + "sel3'>";
             h += "</select></td>";
             h += "<td> <select style='display:none' id='" + rowId + "sel4'>";
             h += "  <option value='e'>"+lang.AUTOTRONE.autosalvage2.Either+"</option>";
             h += "  <option value='b'>Buff</option>";
             h += "  <option value='d'>Debuff</option>";
             h += "</select></td>";

             h += "<td> "+lang.AUTOTRONE.autosalvage2.slots+" ";
             h += "  <input type=checkbox value='1' checked=true id='" + rowId + "slot1'/>1";
             h += "  <input type=checkbox value='2' checked=true id='" + rowId + "slot2'/>2";
             h += "  <input type=checkbox value='3' checked=true id='" + rowId + "slot3'/>3";
             h += "  <input type=checkbox value='4' checked=true id='" + rowId + "slot4'/>4";
             h += "  <input type=checkbox value='5' checked=true id='" + rowId + "slot5'/>5";
             h += "</td>";

             row.innerHTML = h;

             var effects = [];

             for (e in uW.cm.thronestats.effects)
             {
                 var effectName = uW.cm.thronestats.effects[e][1];//.split(" Debuff")[0];
                 //if (effects.indexOf(effectName) < 0)
                 effects.push(effectName);
             }

             var select = ById(rowId + "sel3");
             for(index in effects) {
                 if (typeof(effects[index])=="string")
                   select.options.add(new Option(effects[index], effects[index]));
             }

             var c = row.insertCell(5);
             var btn = document.createElement("input");
             btn.type = "submit";
             btn.value = "X";
             btn.onclick = function () { t.S2removeRow(row);};
             c.appendChild(btn);
        },
     pickCity : function () {
            var t = Tabs.Throne;
            var cid = upgradeData.sCityNum;
            if (!Seed.cities[cid]) {
             upgradeData.sCityNum=0;
             cid=0;
		    }
 			if ( Seed.resources["city" + Seed.cities[cid][0]]["rec5"][0] <= salvageData.maxStones) return cid;
            var ind = -1,lowest = Math.round(uW.cm.WorldSettings.getSetting("DARK_FOREST_AETHERSTONE_CAP")*(1+EffetTronePrc(88).percent/100));
            if (salvageData.anyCity)   {
			 for (i= 0; i < Seed.cities.length; i++)  {
               if (salvageData.overflow == "lowest")  {
			        if (Seed.resources["city" + Seed.cities[i][0]]["rec5"][0] < lowest ) {
						 ind = i;
						 if (Seed.cities[ind]) lowest = Seed.resources["city" + Seed.cities[ind][0]]["rec5"][0];
				    }
			   }else{
			        if ( Seed.resources["city" + Seed.cities[i][0]]["rec5"][0] <= salvageData.maxStones) return i;
               }
			 }
           }
           return ind;
        },
         S2createRule : function()
	        {
	            var t = Tabs.Throne;
	            t.S2readRows();
	            t.S2buildRuleDisplay();
        },
        S2buildRuleDisplay : function ()
	        {
	            var t = Tabs.Throne;
	            var rd = ById('BORuleDisplay');

	            var m = '<TABLE width=90% class=trTab>';

	            for (i =0; i < salvageData.ruleSet.length; i++)
	            {
	                var rule = salvageData.ruleSet[i];

	                m += '<tr>';
	                m += "<td width=90%><div class='BORule'>";

	                m += "Type: " + rule.type;
	                m += " Faction: " + rule.faction;

	                for (ii = 0; ii < rule.conditions.length; ii++)
	                {
	                    var condition = rule.conditions[ii];

	                    if (ii ==0 )
	                        m += "<br> Item";
	                    else
	                        m += "<br> <u>"+lang.AUTOTRONE.autosalvage2.and+"</u>";

	                    if (condition.mustHave != "false")
	                        m += " "+lang.AUTOTRONE.autosalvage2.musthave+" ";
	                    else
	                        m += " "+lang.AUTOTRONE.autosalvage2.mustnothave+" ";

	                    m += condition.number + "x ";
	                    m += condition.effect + " ";
	                    m += " "+lang.AUTOTRONE.autosalvage2.inslot+" ";
	                    for (j = 0; j < condition.slots.length; j++)
	                    {
	                        if (condition.slots[j] ) m += (j+1) + " ";
	                    }
	                }
	                m += "</div></td>";
	                m += '<td width=10%><div class="boremove" id="BODelRule' + i + '" title="'+lang.AUTOTRONE.autosalvage2.BODelRule+'"></div></td>';
	                m += '</tr>';
	            }
	            rd.innerHTML = m;
	            for (var j=0; j < salvageData.ruleSet.length; j++)
	            {
	                ById('BODelRule' +j).v1 = j;
	                ById('BODelRule' +j).addEventListener ('click', function() { t.S2deleteRule(this.v1)}, false);
	            }
	            ById('BOSalvagerPower').addEventListener('click', function(){t.S2togglePower()} , false);
	},
        S2togglePower: function(){
	            var t = Tabs.Throne;
	            var btn = ById('BOSalvagerPower');
	            if (salvageData.salvageActive == true) {
	                salvageData.salvageActive = false;
	                if (btn) btn.value = "Salvager = OFF";
	                if (Options.BORac_Salvage2) updatebotbutton("Salv V2 - OFF", 'BOautosalvageV2');
	                //clearInterval(t.sTimer);
	                t.delItems = [];
	            } else {
	                salvageData.salvageActive = true;
	                if (btn) btn.value = "Salvager = ON";
	                if (Options.BORac_Salvage2) updatebotbutton("Salv V2 - ON", 'BOautosalvageV2');
	                //t.S2start();
	            }
	            saveSalvageData();
        },
          S2start : function(){
	            var t = Tabs.Throne;
        },
         S2deleteRule : function(i)
        {
            var t = Tabs.Throne;
            salvageData.ruleSet.splice(i,1);
            saveSalvageData();
            t.S2buildRuleDisplay();
        },
        S2readRows : function()
	        {
	            var t = Tabs.Throne;
	            var table = ById('BOConditionTable');
	            var rowCount = table.rows.length;

	            var cType = ById('BOCardType').value;
	            var faction = ById('BOFactionType').value;

	            var conditions = [];
	            for (i=0; i < table.rows.length; i++)
	            {
	                var row = table.rows[i];
	                if (row.id)
	                {
	                    var s1 = ById(row.id + "sel1");
	                    var s2 = ById(row.id + "sel2");
	                    var s3 = ById(row.id + "sel3");
	                    var s4 = ById(row.id + "sel4");

	                    var slots = [];
	                    for (j =1; j <= 5; j++)
	                    {
	                        var ch = ById(row.id + "slot" + j);
	                        slots.push(ch.checked);
	                    }

	                    var c = new Condition(s1.value, s2.value, s3.value, s4.value, slots );
	                    conditions.push(c);
	                }
	            }
	            var rule1 = new Rule(cType, faction, conditions);
	            t.addRule(rule1);
	        },

	        S2removeRow : function(row)
	        {
	            var table = ById('BOConditionTable');

	            for (i=0; i < table.rows.length  ; i++ )
	            {
	                if (table.rows[i] == row)
	                {
	                    table.deleteRow(i);
	                    break;
	                }
	            }
	        },
	        addRule : function(rule)
	        {
	            salvageData.ruleSet.push(rule);
	            saveSalvageData();
	        },
	        e_CityButton : function (city, x, y){
	            var t = Tabs.Throne;
	            upgradeData.sCityNum = city.idx;
	            saveUpgradeData();
	        },
   S2doSalvage : function() {
            var t = Tabs.Throne;
            //uW.update_seed_ajax();


            var num_items = uW.Object.keys(uW.kocThroneItems).length;
			            if (num_items > 120)
			                $("a.buttonv2.throne").css('color', 'red');
			            else
                $("a.buttonv2.throne").css('color', 'black');


            if(!salvageData.salvageActive) {
                return;
            }

            if (t.deleting == true) return;
            t.deleting = true;

            t.setStatus(lang.AUTOTRONE.autosalvage2.status1);

            t.delItems = t.S2buildList(false);

            if (t.delItems.length > 0) {
                if (salvageData.UpgradeP1) {
				   t.S2doUpgrade();

			    } else
                 t.S2doDelete();

            } else {
                t.deleting = false;
                t.setStatus(lang.AUTOTRONE.autosalvage2.status2);
            }
 },
 S2buildList : function(test){
            var t = Tabs.Throne;
            var throneSaveNum = salvageData.throneSaveNum;
            var countItem = 0;
            var retList = [];
            for (k in uW.kocThroneItems) {
                var throne_item = uW.kocThroneItems[k];
                if (throne_item) {
                countItem++;
                if (throne_item.level !=0 &&  !salvageData.UpgradeP1) continue;
                if (throne_item.level >1 &&  salvageData.UpgradeP1) continue;
                if (test != true)
                {
                    if (throne_item.isEquipped) continue;
                    if (throne_item.isBroken) continue;
                }
                if ( countItem <= throneSaveNum) continue;
                if (throne_item.quality >= 5) continue;
                if (t.applyRules(throne_item.id)) continue;

                Upgrading=true;
                for (k in ThroneOptions.Items) {
                 if (ThroneOptions.Items[k]["id"] == throne_item.id) Upgrading = false;
                }
                if (Upgrading)
                 retList.push(throne_item.id);
			    }
            }
            return retList;
        },

        setStatus : function(msg)
        {
            if (ById('BOSalvStatus'))
               ById('BOSalvStatus').innerHTML = msg;
            if (Options.LogsSalvage) actionLog("AutoSalvage",msg);
        },
        applyRules : function(id) {
            var t = Tabs.Throne;
            for (r in salvageData.ruleSet)
            {
                var rule = salvageData.ruleSet[r];
                if ( rule.applyRule(id)) return true;
            }
            return false;
        },
        S2doUpgrade:function() {
			if(!salvageData.salvageActive) {
			                return;
            }
            var t = Tabs.Throne;
            var s = uW.kocThroneItems[t.delItems[0]];
            if (!s)
              return;
            if (s.quality>1 || s.level==1)  { // supprime que les simples et inabituel
            	t.S2doDelete();
				return;
			}
 	    var cityid = 0;
 	    var ind = -1,highter = 10000;
 	    for (var i= 0; i < Seed.cities.length; i++)  {
			 if (parseInt(Seed.resources["city" + Seed.cities[i][0]]["rec5"][0]) > highter ) {
			     ind = i;
			     cityid = Seed.cities[ind][0];
			     highter = Seed.resources["city" + Seed.cities[ind][0]]["rec5"][0];
		     }
		}
		if(cityid == 0 && highter > 10000){
			t.setStatus(lang.AUTOTRONE.upgrade.notenough +" UPGRADE +1 !!");
			t.S2doDelete();
			return;
		}
        var id = t.delItems[0];
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
			params.action = 'upgradeLevel';
			params.buffItemId = 0;
			params.throneRoomItemId = t.delItems[0];
			params.payment="aetherstone";
			params.cityId = cityid;
			new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {  method: "post", parameters: params, loading: true,
			    onSuccess: function (transport) {
                    var m = eval("(" + transport.responseText + ")");
                    var t = Tabs.Throne;
                     if (m.ok === true){
						 var s = uW.kocThroneItems[t.delItems[0]];
						 if (s) {
						 if (m.gems > 0) {
							 //alert("Attention : autosalvage +1 a depense "+m.gems+" GEMS !!! Ville numero "+ind+" avant lancement il y avait "+highter+" ether en stock...");
							 t.setStatus("Attention : autosalvage +1 a depense "+m.gems+" GEMS !!! Ville numero "+ind+" avant lancement il y avait "+highter+" ether en stock...");
							 setTimeout(uW.update_seed_ajax, 250);
					     }
					     Seed.resources["city"+cityid]["rec5"][0]=Seed.resources["city"+cityid]["rec5"][0]-m.aetherstones;
	               		 if (m.success) {
	                		 s.quality = m.item.quality;s.level = m.item.level;s.name = s.createName();
	               		 } else {
	               		   s.quality = m.item.quality;s.level = m.item.level;s.name = s.createName();
	               		   if (m.break) {
	                  		s.brokenType = "level";
	                 	 	s.isBroken = true;
	                 		s.name = s.createName();
	                 	   }
	                     }
					 }
	                     uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
	                     t.S2doDelete();


					 } else {
						t.S2doDelete();
					 }


				},onFailure: function () {
					var t = Tabs.Throne;
					t.S2doDelete();
				}
			});
		},
        S2doDelete: function(){
            if(!salvageData.salvageActive) {
                return;
            }
            var t = Tabs.Throne;
            var id = t.delItems[0];
            var params = uW.Object.clone(uW.g_ajaxparams);
            var num_city = t.pickCity();
            if ( num_city < 0)
            {
                t.setStatus(lang.AUTOTRONE.autosalvage2.status3);
                num_city = upgradeData.sCityNum;
            }
            var item = uW.kocThroneItems[id];
            if (item)
              t.setStatus(lang.AUTOTRONE.autosalvage2.status4+' ' + item.name);

            params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
            params.action = 'salvage';
            params.itemId = id;
            params.cityId = Seed.cities[num_city][0];
            new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
                method: "post",
                parameters: params,
                loading: true,
                onSuccess: function (transport) {
					try {
                    var rslt = eval("(" + transport.responseText + ")");
                    var throne_item = uW.kocThroneItems[id];
                    if(rslt.ok) {
                        y = uW.kocThroneItems[params.itemId];
						z = uW.cm.thronestats.effects;
					    if (!Options.S2DisableLogs)
					      t.addToSalvageLog(ThroneItemName(y),rslt.aetherstones,z[y.effects["slot1"].id][1],z[y.effects["slot2"].id][1],z[y.effects["slot3"].id]["1"],z[y.effects["slot4"].id]["1"],z[y.effects["slot5"].id][1]);
                        salvageData.numSalvagedItems++;
                        saveSalvageData();
                        var tmp = uW.currentcityid;
                        uW.currentcityid = Seed.cities[num_city][0];
                        if (throne_item) throne_item.salvage();
                        uW.currentcityid = tmp;
                    }
                    else
                    {
                        if (throne_item) t.setStatus(lang.AUTOTRONE.autosalvage2.status5+' ' + throne_item.name);
                        uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
                        //uW.update_seed_ajax(true, function() {uW.cm.ThroneView.renderInventory(uW.kocThroneItems);});
                    }
                    var idx = t.delItems.indexOf(id);
                    if (idx >=0)
                    {
                        t.delItems.splice(idx,1);
                    }
                    if (t.delItems.length > 0) {
						 if (salvageData.UpgradeP1) {
						   setTimeout (t.S2doUpgrade, 1500);
						 } else
                 		   setTimeout (t.S2doDelete, 2000);
                    } else {
                        t.deleting = false;
                        t.setStatus(lang.AUTOTRONE.autosalvage2.status6);
                        return;
                    }
			    	} catch (e) {
					     t.deleting = false;
                   }
                },
                onFailure: function () {
                    t.delIems = [];
                    t.deleting = false;
                    uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
                    return;
                },
            });
        },
addToSalvageLog:function(itemn,stones,effet1,effet2,effet3,effet4,effet5) {
	var t = Tabs.Throne;
	var now = new Date();
	var now2 = new Date().getTime()/1000.0;
		D = t.addZero(now.getDate());
		M = t.addZero(now.getMonth()+1);
		Y = t.addZero(now.getFullYear());
		h = t.addZero(now.getHours());
		m = t.addZero(now.getMinutes());
		var time =  D +"/"+ M +"/"+ Y +"  "+ h + ":" + m;
		t.SalvageLog.push ({time:time,timeu:now2,stones:stones,itemn:itemn,effet1:effet1,effet2:effet2,effet3:effet3,effet4:effet4,effet5:effet5});
	var lng=t.SalvageLog.length-200;
	if (lng<1) lng=1;
	if (t.SalvageLog.length > 200) t.SalvageLog.splice(0,lng);
	GM_setValue ('ThroneSalvageHistory_'+getServerId(), JSON2.stringify(t.SalvageLog));
},

PaintSalvageHistory : function() {
	var t = Tabs.Throne;
	var popHistory = null;
	popHistory = new CPopup('pbSalvageShowHistory', 0, 0, 1000, 510, true, function() {clearTimeout (1000);});
	var m = '<DIV style="max-height:300px; height:300px; overflow-y:auto;"><TABLE align=center cellpadding=0 cellspacing=0 width=99% id="BOBars">';
	popHistory.getMainDiv().innerHTML = m + '</table></div><DIV style="max-height:160px; height:160px; overflow-y:auto;" id=BoBarsSt></div>';
	popHistory.getTopDiv().innerHTML = '<center><B>'+lang.AUTOTRONE.autosalvage.popHistory+'</<center>';
	var stoness=0,timet=0,diff=0,cc=0;
	var stat=[],statc=[],nbitem=0;
	for (i=0;i<t.SalvageLog.length;i++){
		if (i==0) timet=t.SalvageLog[i].timeu;
		diff=parseIntNan(t.SalvageLog[i].timeu-timet);
		var row = ById('BOBars').insertRow(0);
		row.vAlign = 'top';
		row.style.color = "black";
		row.insertCell(0).innerHTML = t.SalvageLog[i].time;
		row.insertCell(1).innerHTML = t.SalvageLog[i].stones;
		row.insertCell(2).innerHTML = t.SalvageLog[i].itemn;
		row.insertCell(3).innerHTML = t.SalvageLog[i].effet1;
		row.insertCell(4).innerHTML = t.SalvageLog[i].effet2;
		row.insertCell(5).innerHTML = t.SalvageLog[i].effet3;
		row.insertCell(6).innerHTML = t.SalvageLog[i].effet4;
		row.insertCell(7).innerHTML = t.SalvageLog[i].effet5;
		stoness=stoness+t.SalvageLog[i].stones;
		nbitem++;
		if (diff>60*60) {
		 timet=t.SalvageLog[i].timeu;
		 stat[cc]=stoness;
		 statc[cc]=nbitem;
		 cc++;
		 stoness=0;
		 nbitem=0;
		}
	}

	var row = ById('BOBars').insertRow(0);
	row.vAlign = 'top';row.align = 'center';
	row.style.color = "black";
	var cell1 = row.insertCell(0);
	cell1.width="120px";
	cell1.innerHTML = lang.AUTOTRONE.autosalvage.popCell0;
	var cell2 = row.insertCell(1);
	cell2.width="50px";
	cell2.innerHTML = "<img height=18 src='+gameurl+'img/aetherstone_30.png>";
	row.insertCell(2).innerHTML = lang.AUTOTRONE.autosalvage.popCell2;
	row.insertCell(3).innerHTML = "1";
	row.insertCell(4).innerHTML = "2";
	row.insertCell(5).innerHTML = "3";
	row.insertCell(6).innerHTML = "4";
	row.insertCell(7).innerHTML = "5";

	var zz="";
	zz+="<input type=button value='Reset' id='BoBarsRz'><input type=button value='Refresh' id='BoBarsRef'>";
	var za="<br><TABLE align=center cellpadding=0 cellspacing=0 width=99%><tr  bgcolor=#eee><td bgcolor=#eee>&nbsp;</td><td colspan=50  bgcolor=#eee>Statistiques par heure (300 items en historique)</tr>";
	za+="<tr><td>Nb Item</td>";
	for (var ll=0;ll<statc.length;ll++) {
		za+="<td>"+addCommas(statc[ll])+"</td>";
	}
	za+="</tr><tr><td>Ether</td>";
	for (var ll=0;ll<stat.length;ll++) {
			za+="<td>"+addCommas(stat[ll])+"</td>";
	}
	za+="</table>";
	ById("BoBarsSt").innerHTML=za+"<br>"+zz;

	$("#BoBarsRz").click(function() {
		t.SalvageLog=[];
		GM_setValue ('ThroneSalvageHistory_'+getServerId(), JSON2.stringify(t.SalvageLog));
		t.PaintSalvageHistory();
	});
	$("#BoBarsRef").click(function() {
		t.PaintSalvageHistory();
	});
    //setTimeout(t.PaintSalvageHistory, 10000);
	popHistory.show(true);
},
Upgrade_Enhance :function (){
    var t = Tabs.Throne;
    //try {
      var m = '<DIV id=pbTowrtDivF class=boStat>'+lang.AUTOTRONE.upgrade.title+'</div><TABLE width=100% height=0% class=pbTab><TR align="center">';
	       if (ThroneOptions.Active == false) {
	             m += '<TD><INPUT id=Enable type=submit value="Upgrade = OFF">';
	       } else {
	            m += '<TD><INPUT id=Enable type=submit value="Upgrade = ON">';
	      }
	      m+='<br><input type=checkbox id=BOAutoOff '+(ThroneOptions.AutoOff?'CHECKED':'')+'> '+lang.AUTOTRONE.upgrade.AutoOff+'</td>';
	      if (Options.salvageconfig.Repairrunning == true) {
		               m += '<TD><INPUT id=BOTroneRepairEnable type=submit value="Repair = On"></td>';
		   }   else {
		                 m += '<TD><INPUT id=BOTroneRepairEnable type=submit value="Repair = Off"></td>';
         }
      m += '<td><input type=checkbox id=BOuse20001 '+(ThroneOptions.Use20001?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20001.name+'" src="'+gameurl+'img/items/70/20001.jpg">\
      <input type=checkbox id=BOuse20002 '+(ThroneOptions.Use20002?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20002.name+'" src="'+gameurl+'img/items/70/20002.jpg">\
      <input type=checkbox id=BOuse20005 '+(ThroneOptions.Use20005?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20005.name+'" src="'+gameurl+'img/items/70/20005.jpg">\
      <input type=checkbox id=BOuse20006 '+(ThroneOptions.Use20006?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20006.name+'" src="'+gameurl+'img/items/70/20006.jpg">\
      <input type=checkbox id=BOuse20004 '+(ThroneOptions.Use20004?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20004.name+'" src="'+gameurl+'img/items/70/20004.jpg">\
      <br><input type=checkbox id=BOuse20012 '+(ThroneOptions.Use20012?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20012.name+'" src="'+gameurl+'img/items/70/20012.jpg">\
      <input type=checkbox id=BOuse20013 '+(ThroneOptions.Use20013?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20013.name+'" src="'+gameurl+'img/items/70/20013.jpg">\
      <input type=checkbox id=BOuse20014 '+(ThroneOptions.Use20014?'CHECKED':'')+'><img width=25 title="'+uW.itemlist.i20014.name+'" src="'+gameurl+'img/items/70/20014.jpg">\</td><TD><INPUT id=ShowHistory type=submit value="'+lang.AUTOTRONE.history+'"></td>';
      m+= '</table><DIV id=pbTowrtDivF class=boStat>'+lang.AUTOTRONE.upgrade.title2+'</div><TABLE class=ptTab><br/>';
	  m+='<TR><TD>'+lang.AUTOTRONE.upgrade.items+'</td><TD><SELECT id=BOThroneTypeItems type=list><option value="">'+uW.g_js_strings.commonstr.type+'...</option><option value="advisor">'+uW.g_js_strings.throneRoom.advisor+'</option><option value="banner">'+uW.g_js_strings.throneRoom.banner+'</option><option value="chair">'+uW.g_js_strings.throneRoom.chair+'</option><option value="table">'+uW.g_js_strings.throneRoom.table+'</option><option value="window">'+uW.g_js_strings.throneRoom.window+'</option><option value="trophy">'+uW.g_js_strings.throneRoom.trophy+'</option><option value="candelabrum">'+uW.g_js_strings.throneRoom.candelabrum+'</option><option value="hero">'+uW.g_js_strings.throneRoom.hero+'</option></select>&nbsp;&nbsp;<SELECT id=BOThroneFamItems type=list><option value="">'+lang.AUTOTRONE.autosalvage.col2+'...</option>';
	  var liste1 = uW.cm.thronestats.boosts;
	  for (k in liste1){
	   if (liste1[k] !=undefined ){
	    m+="<option value='"+k+"'>"+liste1[k].BoostName+"</option>";
	   }
	  }
	  m+='</select><bR><SELECT id=ThroneItems type=list>';
       var nb=0,couleur=0;
	  		for (i in uW.kocThroneItems){
	  		nb++
	  			var styleee="background-color:#FFF";
	  			if (uW.kocThroneItems[i].isEquipped) {
	  			 styleee="background-color:#DC9999";
	  			 if (nb==1) couleur=1;
	  			}

	  		if (nb<=(parseInt(Seed.throne.rowNum)*5))
	  			m+="<option style='"+styleee+"' value="+uW.kocThroneItems[i]["id"]+">#"+nb+" "+ThroneItemName(uW.kocThroneItems[i])+"</option>";
	}
	  m+='</select></td>';
      m+='<TD><INPUT id=addEnhance type=submit value="Enhance"></td>';
	  m+='<TD><INPUT id=addUpgrade type=submit value="Upgrade"></td>';
	  m+='<TD rowspan=2><DIV id=ShowHoover></div></td>';
	  m+='</tr><tr><td colspan=2>'+lang.AUTOTRONE.upgrade.bonexttries+' <input size=3 type=text value="'+ThroneOptions.nexttries+'" id=bonexttries><br>'+lang.AUTOTRONE.upgrade.bonexttries1+'</td></tr></table><br/>';
	  m+= '<DIV id=pbTowrtDivF class=boStat>'+lang.AUTOTRONE.upgrade.title3+'</div>';
	  m+= '<div><DIV id=ShowStatus style="float:left;width:350px"></div>';
	  m+= '<DIV id=ShowTries style="float:right;width:350px"></div></div><br/><br/><br>';
	  m+= '<DIV id=ShowStones style="float:left;"></div><br/>';
	  m+= '<br/><DIV id=ShowInfo style="float:left;"></div><br/>';
      m+= '<DIV id=pbTowrtDivF class=boStat>'+lang.AUTOTRONE.upgrade.title4+'</div>';
	  m+= '<br/><DIV id=ShowQueueDiv style="max-height:'+(Options.HauteurBoite-450)+'px; height:'+(Options.HauteurBoite-450)+'px;overflow-y: auto;"></div>';
	  t.Overv.innerHTML = m;
        if (couleur==1) ById("ThroneItems").style.backgroundColor="#DC9999"

     ById('BOThroneFamItems') .addEventListener ('change', function (){
		 ById('ThroneItems').innerHTML="";
		 var nb=0,couleur=0,ttt="";
		 for (i in uW.kocThroneItems){
				nb++;
				var ok=0;
				for (var u in uW.kocThroneItems[i].effects) {
					for (l=0;l<uW.cm.thronestats.effects[uW.kocThroneItems[i].effects[u].id]["2"].length;l++){
						   	type = uW.cm.thronestats.effects[uW.kocThroneItems[i].effects[u].id]["2"][l];
						   	logit(type + ' ' +ById('BOThroneFamItems').value);
						   	if (type==ById('BOThroneFamItems').value) {
						   	 ok=1
						   	}
	    			 }
				}


						if (ById('BOThroneFamItems').value!="" && ok==0)
						 continue;
					    var styleee="background-color:#FFF";
						if (uW.kocThroneItems[i].isEquipped) {
						  	styleee="background-color:#DC9999";
						  	if (nb==1) couleur=1;
						}
					    if (nb<=(parseInt(Seed.throne.rowNum)*5))
						  ttt+="<option style='"+styleee+"' value="+uW.kocThroneItems[i]["id"]+">#"+nb+" "+ThroneItemName(uW.kocThroneItems[i])+"</option>";
					}
			ById('ThroneItems').innerHTML=ttt;
	 },false);
     ById('BOThroneTypeItems').addEventListener ('change', function (){
			ById('ThroneItems').innerHTML="";
			 var nb=0,couleur=0,ttt="";
			 for (i in uW.kocThroneItems){
				nb++;
				if (ById('BOThroneTypeItems').value!="" &&  ById('BOThroneTypeItems').value!=uW.kocThroneItems[i].type)
				 continue;
			    var styleee="background-color:#FFF";
				if (uW.kocThroneItems[i].isEquipped) {
				  	styleee="background-color:#DC9999";
				  	if (nb==1) couleur=1;
				}
			    if (nb<=(parseInt(Seed.throne.rowNum)*5))
				  ttt+="<option style='"+styleee+"' value="+uW.kocThroneItems[i]["id"]+">#"+nb+" "+ThroneItemName(uW.kocThroneItems[i])+"</option>";
			}
			ById('ThroneItems').innerHTML=ttt;
	 },false);
	ById('bonexttries').addEventListener ('change', function (){
	 ThroneOptions.nexttries = parseIntNan(ById('bonexttries').value);
	 ById('bonexttries').value=ThroneOptions.nexttries;
	 saveThroneOptions();
	},false);
	ById('addEnhance').addEventListener ('click', function (){t.addToQueue(ById('ThroneItems').value,"Enhance");},false);
	ById('addUpgrade').addEventListener ('click', function (){t.addToQueue(ById('ThroneItems').value,"Upgrade");},false);
	ById("BOAutoOff").addEventListener ('click', function (){ ThroneOptions.AutoOff=ById("BOAutoOff").checked;saveThroneOptions();	},false);
	ById("BOuse20006").addEventListener ('click', function (){ ThroneOptions.Use20006=ById("BOuse20006").checked;saveThroneOptions();	},false);
	ById("BOuse20005").addEventListener ('click', function (){ ThroneOptions.Use20005=ById("BOuse20005").checked;saveThroneOptions();	},false);
	ById("BOuse20001").addEventListener ('click', function (){ ThroneOptions.Use20001=ById("BOuse20001").checked; saveThroneOptions();	},false);
	ById("BOuse20002").addEventListener ('click', function (){ ThroneOptions.Use20002=ById("BOuse20002").checked; saveThroneOptions();	},false);
	ById("BOuse20004").addEventListener ('click', function (){ ThroneOptions.Use20004=ById("BOuse20004").checked;saveThroneOptions();	},false);
	ById("BOuse20012").addEventListener ('click', function (){ ThroneOptions.Use20012=ById("BOuse20012").checked;saveThroneOptions();	},false);
	ById("BOuse20013").addEventListener ('click', function (){ ThroneOptions.Use20013=ById("BOuse20013").checked;saveThroneOptions();	},false);
	ById("BOuse20014").addEventListener ('click', function (){ ThroneOptions.Use20014=ById("BOuse20014").checked;saveThroneOptions();	},false);
	ById('ThroneItems').addEventListener ('change', function (){t.paintHoover();},false);
    ById('BOTroneRepairEnable').addEventListener ('click', function(){t.toggleRepairon(this);}, false);
  	ById('Enable').addEventListener('click', function(){t.toggleThroneState()} , false);
  	ById('ShowHistory').addEventListener('click', function(){t.PaintHistory()} , false);
	if (ThroneOptions.Items.length ==0 && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.noitem;
	else {
      if (ThroneOptions.Active && Seed.queue_throne.end == undefined && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.waiting;
      if (!ThroneOptions.Active && Seed.queue_throne.end == undefined && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.off;
    }
   if (ThroneOptions.Tries > 0) ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.retry+"" + ThroneOptions.Tries + "<br />"+lang.AUTOTRONE.upgrade.good+" " + ThroneOptions.Good + "  "+lang.AUTOTRONE.upgrade.bad+" " + ThroneOptions.Bad;
		else ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.retry+" --";

	if (ThroneOptions.Items.length>0) { // && ThroneOptions.Tries > 0) {
	   t.PaintQueue();
	   t.paintInfo();
	 }
	t.paintStones();
	t.paintHoover();
   setInterval(t.paintStones,30000);
},
doPreset : function (preset){
 	if (ById("BOMsgOrg"))ById("BOMsgOrg").innerHTML="Patientez..";
	var t = Tabs.Throne;
	var params = uW.Object.clone(uW.g_ajaxparams);
	params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
	params.action = 'setPreset';
	params.presetId = preset;

  	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
		method: "post",
		parameters: params,
		loading: true,
		onSuccess: function (transport) {
			var rslt = eval("(" + transport.responseText + ")");
				if(rslt.ok){
					button = '<li id="throneInventoryPreset' + preset + '" class="active">'+preset+'</li>';
					uW.cm.ThroneView.clickActivePreset(button);
				  	if (ById("BOMsgOrg")) ById("BOMsgOrg").innerHTML="OK";
					if (ById("BOMsgOrg")) t.Organize();
					setPresetWidget(preset)	;
			   } else {
			     if (ById("BOMsgOrg")) ById("BOMsgOrg").innerHTML="Erreur";
			     if (ById("BOMsgOrg")) ById ('PresetList').value = Seed.throne.activeSlot;
       			     t.selectPreset(Seed.throne.activeSlot);
			   }
		},
		onFailure: function () {
		   return;
		},
	});

},
itemLists : [],
itemTypes : { chair: 0, table: 1, window: 2, banner: 3, advisor: 4, trophy:5, candelabrum:6, hero:7},
selectedItems : [],
filter:'',
ofactions: ['briton', 'fey', 'druid'],
Organize:function() {
 var t = Tabs.Throne;

 var m = '<DIV class=boStat>'+lang.AUTOTRONE.equip.title2+'</div>';
 m += '<TABLE  width=98% class=trTabPad2><tr align="center"><td><a id=BOPresetNam href="javascript:void(0);">'+lang.AUTOTRONE.equip.preset2+'</a>&nbsp;<select id="PresetList">';
 for (k= 1; k <= Seed.throne.slotNum; k++)
 	{
          m += '<option value="'+k+'">'+ k +' - '+ThroneOptions.presetname[k]+'</option>';
	}
       m += '</select>&nbsp;<span id=BOMsgOrg></span></td>';
       if (Options.alertConfig.Atkpreset) {
       m+='<td width=50%>'+lang.AUTOTRONE.equip.preset3+' : <b>'+Options.Atkpreset+'</b></td></tr>';
       }

       m +='<tr align="center"><td colspan=1 align=center id=factionFilterRow>'+lang.AUTOTRONE.equip.filter1+'<select id="BOFilterLO"><option value=""></option>';

        var liste1 = uW.cm.thronestats.boosts;
	   	     for (k in liste1){
	   	         if (liste1[k] !=undefined ){
					 if (t.filter==k)
					  m += '<option selected value="'+k+'">'+ liste1[k].BoostName+'</option>';
					 else
	   	               m += '<option value="'+k+'">'+ liste1[k].BoostName+'</option>';
		   	         }
	     }

       m +='</select><br> Factions: ';
	               for (var f=0; f<t.ofactions.length; f++) {
	                  var faction = t.ofactions[f];
	                  m += '<INPUT id=BOtrFaction'+ faction + ' type=checkbox  CHECKED >' + faction.capitalize() + '</input> ';
	               }

	               m +='</td><td colspan=1 align=center id=levelFilterRow> Levels: ';

	               for (level = 0; level <=13; level++)
	               {
	                  m += '<INPUT id=BOtrLevel'+level + ' type=checkbox CHECKED >' + level + '</input> ';
	               }

	               m += '</td></tr>';

       m += '</table>';
       m += "<div id='BOScrollDiv' style='position: static; min-width:715px; max-width:905px;max-height:"+(Options.HauteurBoite-155)+"px; height:"+(Options.HauteurBoite-155)+"px; overflow-x: auto; overflow-y: auto;'>";
       m += "<div id='BOTableDiv' style='width: 100%;'>";
       m += '<TABLE id=BODisplayTable awidth=100% height=0% class=trTab>';
       m += "<tr align=center valign=top><th width=14%>"+uW.g_js_strings.throneRoom.chair+"</th><th width=14%>"+uW.g_js_strings.throneRoom.table+"</th><th width=14%>"+uW.g_js_strings.throneRoom.window+"</th>\
             <th width=14%>"+uW.g_js_strings.throneRoom.banner+"</th><th width=14%>"+uW.g_js_strings.throneRoom.advisor+"</th><th width=14%>"+uW.g_js_strings.throneRoom.trophy+"</th><th width=14%>"+uW.g_js_strings.throneRoom.candelabrum+"</th><th width=14%>"+uW.g_js_strings.throneRoom.hero+"</th></tr>";
       m += '</table></div>';
       m += '</div>';
       m += '</div>';
       t.Overv.innerHTML = m;
       t.fillLists();
       setTimeout(function(){t.paintTable();},400);
       ById ('PresetList').addEventListener ('change', function( ) {
         t.doPreset(this.value);
       }, false);
       ById('BOFilterLO').addEventListener ('change', function( ) {
		   t.filter=this.value;
		   t.fillLists();
		   setTimeout(function(){t.paintTable();},400);
		   setTimeout(function(){t.selectPreset(Seed.throne.activeSlot);},750);
	   }, false);
	   ById("BOPresetNam").addEventListener ('click', function( ) {
		    Tabs.Options.namePreset();
	   }, false);
       uW.BOSelectCard = t.selectCard;
       ById('PresetList').value = Seed.throne.activeSlot;
        setTimeout(function(){t.selectPreset(Seed.throne.activeSlot);},750);
       $("#factionFilterRow input").change( function() {
		   t.fillLists();
		   setTimeout(function(){t.paintTable();},400);
		   setTimeout(function(){t.selectPreset(Seed.throne.activeSlot);},750);
		});
	   $("#levelFilterRow input").change( function() {
		   t.fillLists();
		   setTimeout(function(){t.paintTable();},400);
		   setTimeout(function(){t.selectPreset(Seed.throne.activeSlot);},750);
		});


},
showNext : function () {
            var t = Tabs.Throne;
            if (t.panelId < 0) return;
            var X = uW.kocThroneItems[t.panelId];
            var V = "next";
            var P = t.panelType;

            var bump = t.panelNextLevel;

            if (P == "enhance")
            {
                if ( (X.quality + bump ) > 5)
                {
                    bump = 5 - X.quality;
                }
            }
            else if ( (X.level + bump) > 13)
            {
                bump =  13 - X.level;
            }

            var R = [],
            Q, Y, S, U, N = {},
            T, W;
            if (V == "next") {
                if (P == "enhance") {
                    X.quality += bump;
                    $("#nextStatContainer span").html('<span> ' + X.createPrefix() + ' </span>');
                } else {
                    if (P == "upgrade") {
                        X.level += bump;
                        $("#nextStatContainer span").html('<span> Level ' + X.level + ' </span>');
                    }
                }
            }
            $.each(X.effects, function (Z, aa) {
                Q = +(Z.split("slot")[1]);
                Y = uW.cm.thronestats.effects[aa.id];
                if (uW.cm.thronestats.tiers[aa.id][aa.tier]) S = uW.cm.thronestats.tiers[aa.id][aa.tier];
                else  S = uW.cm.thronestats.tiers[aa.id][aa.tier-1];
                U = +(S.base) + ((X.level * X.level + X.level) * +(S.growth) / 2);
                U = U.toFixed(2);
                N[aa.id] = {};
                N[aa.id].percent = U;
                N[aa.id].name = Y[1];
                if (Q % 2 == 0) {
                    T = "even"
                } else {
                    T = "odd"
                }
                if (Q <= X.quality) {
                    if (U > 1) {
                        R.push("<li class='" + T + "'>" + Y[1] + " +" + U + "%</li>")
                    } else {
                        R.push("<li class='" + T + "'>" + Y[1] + " " + U + "%</li>")
                    }
                } else {
                    R.push("<li class='disabled " + T + "'>" + Y[1] + " + " + U + "%</li>")
                }
            });
            if (V == "next") {
                if (P == "enhance") {
                    X.quality -= bump
                } else {
                    if (P == "upgrade") {
                        X.level -= bump;
                    }
                }
            }
            if (V === "next") {
                if (uW.cm.ThronePanelController.isLastLevel(X, P)) {
                    W = $("<div/>").addClass("lock").attr("id", "lockedStatIcon");
                    $("#nextStatContainer").append(W)
                } else {
                    $("#lockedStatIcon").remove()
                }
            }
            t.panelNextLevel++;
            $("#thronePanelStat2").html(R.join(""));
        },
buildCard : function(I){
     var t = Tabs.Throne;
     var D = [];
     var w=uW.cm.thronestats.mightByQuality;
     var z=uW.cm.thronestats.mightByLevel;
     if (I == null)
     {
	    D.push("<div>");
	    D.push("</div>");
	    return D.join("");
     }
     D.push("<div class='trCardDisp' id='trCardItem" + I.id + "' style='border: 1px solid white; clear: both;  overflow: visible; position: relative; left: 0px; top: 0px; -moz-transform: scale(" + TABLE_SCALE + ", "+ TABLE_SCALE + "); -moz-transform-origin: 0% 0%;  -webkit-transform: scale(" + TABLE_SCALE + ", "+ TABLE_SCALE + ");  -webkit-transform-origin: 0% 0%;);'>");
	 if (I.isBroken) D.push(" <div class='cardOverlay semi_transparent rot45'> Broken </div>");
     D.push(" <div class='trCard' style='white-space: normal; padding: 0px;' onclick='BOSelectCard(" + I.id + ");'>  ");
     D.push("<div class='section' style='overflow: visible;'>");
     D.push(" <div class='title "+I.createPrefix().toLowerCase()+"' style='text-transform: capitalize;'> ");
     D.push(I.name);
     D.push(" </div> ");
     D.push(" <div class='description'> ");
     D.push(" <div class='portrait "+I.faction+" "+I.type+"'> </div> ");
     D.push("<ul>");
     D.push("<li>"+uW.g_js_strings.commonstr.faction+": "+I.faction+"</li>");
     D.push("<li>"+uW.g_js_strings.commonstr.quality+": "+I.createPrefix()+"</li>");
     D.push("<li>"+uW.g_js_strings.commonstr.type+": "+I.type+"</li>");
     D.push("<li>"+uW.g_js_strings.commonstr.level+": "+I.level+"</li>");
     D.push("<li>"+uW.g_js_strings.commonstr.might+": "+(w[I.quality].Might+z[I.level].Might)+"</li>");
     D.push("</ul>");
     D.push(" </div> ");
     D.push(" <ul> ");

     for (M in I.effects)
     {
       var N = I.effects[M];
       effect=uW.cm.thronestats.effects[N.id];
       if (uW.cm.thronestats.tiers[N.id][N.tier])tier=uW.cm.thronestats.tiers[N.id][N.tier];
       else tier=uW.cm.thronestats.tiers[N.id][N.tier-1];
       percent=+(tier.base+((I.level*I.level+I.level)*tier.growth*0.5));
       percent=(percent>0)?"+"+percent:+percent;
       percent=Math.ceil(percent);
       css=(M%2===0)?"even":"odd";
       B=+(M.split("slot")[1]);
       if(B<=I.quality){
          D.push(" <li class='effect "+css+"'> "+percent+"% "+effect[1]+" </li> ");
       }else{
          D.push(" <li class='effect disabled "+css+"'> "+percent+"% "+effect[1]+" </li> ");
       }
     }
     D.push(" </ul> ");
     D.push(" </div> ");
     D.push(" </ul> ")
     D.push(" </div> ");
     D.push(" </div> ");
     return D.join("");

   },
 paintTable : function() {
	 var t = Tabs.Throne;
	 var m = "";
       var mm;
       var tab = ById('BODisplayTable');
       var ii = Math.max(t.itemLists['chair'].length, t.itemLists['table'].length, t.itemLists['window'].length, t.itemLists['banner'].length, t.itemLists['advisor'].length, t.itemLists['trophy'].length, t.itemLists['candelabrum'].length, t.itemLists['hero'].length);
       m += "<tr align=center valign=top><th width=14%>Chairs</th><th width=14%>Tables</th><th width=14%>Windows</th><th width=14%>Banners</th><th width=14%>Advisors</th><th width=14%>Trophy</th><th width=14%>Candelabrums</th><th witdh=14%>Hero</th></tr>";
	   for (var k= 0; k < ii ; k++) {
		   mm = '<TR align=left valign=top style="height: auto;">';
	   for (i in t.itemTypes) { var item = t.itemLists[i][k]; var id="BOcard"; if (item != null) { id += item.id; }
	   mm +=   '<TD class="tdcard" style="overflow: visible;  width:auto; height: 150px; border: 4px solid white;" id="' + id +'" >';
	   mm += t.buildCard(t.itemLists[i][k]);
	   mm += '</TD>'; }
	   mm += '</TR>'; m+= mm; }
	   tab.innerHTML = m;
	   var d = ById ('BOTableDiv');
	   var t = ById ('BODisplayTable');
		var nodes = t.getElementsByTagName('td');
	   for (n=0; n < nodes.length; n++){
                var d2 = nodes[n].childNodes[0];
                var h = d2.offsetHeight;
                var w = d2.offsetWidth;
                d2.style.height = (TABLE_SCALE * h) + "px";
                d2.style.width  = (TABLE_SCALE * w) + "px";
       }
	   $("td.tdcard").on("mouseenter", "*", function (A) {
		   A.stopPropagation();
		   var theId = $(this).parents("td.tdcard").attr("id").split("card")[1];

                if (!theId || theId == 0) {
                    return;
                }

                if (uW.kocThroneItems[theId])
                {
                    uW.cm.ThroneView.hoverItem(A, this, uW.kocThroneItems[theId]);
                    $("#kofcNewTooltipDiv").css('position', 'absolute');
                    $("#kofcNewTooltipDiv").css('left', A.pageX-50 +'px');
                    $("#kofcNewTooltipDiv").css('top',  A.pageY+50 + 'px');
                }
                else
                {
                    $("#kofcNewTooltipDiv").remove();
                    setTimeout( function () {Tabs.Throne.show();}, 200);
                }
            });
   },
   selectPreset : function (p)
   {
	   var t = Tabs.Throne;
	   t.clearCards();
	   var equipedItems = Seed.throne.slotEquip[p];
	   if (equipedItems != null)
	   {
         for (ll =0; ll < equipedItems.length; ll++)
         {
	       t.selectCard2(equipedItems[ll]);
         }
       }
   },
   fillLists : function ()
      {
   	   var t = Tabs.Throne;

   	   for (i in t.itemTypes)
   	   {
   	      t.itemLists[i] = new Array;
   	   }

   	   for (k in uW.kocThroneItems) {
            var throne_item = uW.kocThroneItems[k];

            var faction = throne_item.faction;
			var level = throne_item.level;
			if (!($('#BOtrFaction'+faction).attr('checked') == 'checked')) continue;
			if (!($('#BOtrLevel'+level).attr('checked') == 'checked')) continue;

            var ok=0;
            if (!throne_item.isBroken) {
				if (t.filter=='')
				 ok=1;
				 else {
				  for (var u in throne_item.effects) {
					 for (l=0;l<uW.cm.thronestats.effects[throne_item.effects[u].id]["2"].length;l++){
	   				   type = uW.cm.thronestats.effects[throne_item.effects[u].id]["2"][l];
	   				   if (type==t.filter) {
						  ok=1;
					   }
				    }
				 }
		     }
	       }
	       if (ok==1)
	         t.itemLists[throne_item.type].push(throne_item);

          }
      },
     selectCard2 : function(itemId)       {
         	   var t = Tabs.Throne;
         	   var item = uW.kocThroneItems[itemId];
         	   var td;

         	   if (t.selectedItems[item.type] != null)
         	   {
                    td = ById( "BOcard" + t.selectedItems[item.type]);
                    if (td)
         	       {
         		      td.style.borderColor = "white";
         	       }
         	   }

         	   t.selectedItems[item.type] = itemId;
         	   td = ById( "BOcard"+itemId);
         	   if (td)
         	   {

         		   if (Seed.throne.activeSlot==ById('PresetList').value) {

         		    td.style.borderColor = "green";
         	   }
         	  }
   	 },
       selectCard : function(itemId)  {
   	   var t = Tabs.Throne;
   	   var item = uW.kocThroneItems[itemId];
   	   var td, td2=null;

   	   if (t.selectedItems[item.type] != null)
   	   {
              td2 = ById( "BOcard" + t.selectedItems[item.type]);

   	   }

   	   t.selectedItems[item.type] = itemId;
   	   td = ById( "BOcard"+itemId);
   	   if (td)
   	   {

   		   if (Seed.throne.activeSlot==ById('PresetList').value) {
	 		    if (td.style.borderColor == "green")
			 t.doUnequip(itemId, ById('PresetList').value, td);

		    else
   		     t.doEquip(itemId, ById('PresetList').value, td);

   		   }
   	   }
   	   if (td2)
	      	       {
	      		      td2.style.borderColor = "white";
   	   }
},
clearCards : function()
      {
   	  var t = Tabs.Throne;
   	   for (k in t.selectedItems)
   	   {
   		   var td = ById( "BOcard" + t.selectedItems[k]);
              if (td)
   	       {
   		      td.style.borderColor = "white";
   	       }
   	   }
   	   t.selectedItems = [];
},
calcMightNoBroked:function()
{
	var H=Seed.throne.rowNum,D=H*5,A=0,G=uW.kocThroneItems,F=0,B=uW.cm.thronestats.mightByQuality,E=uW.cm.thronestats.mightByLevel;

	$.each(G,function(J,I){
		++A;
		if(A>D){return false}
		if (!I.isBroken) {
		 F+=B[I.quality].Might;
		 F+=E[I.level].Might
		}
	});

	return F;
},
Stats :function (numslot){
    var t = Tabs.Throne;
   // try {
	 var tt="";
	for (var k= 1; k <= Seed.throne.slotNum; k++)
		 	{
		          tt += '<option '+(numslot==k?"SELECTED":"")+' value="'+k+'">'+ k +' - '+ThroneOptions.presetname[k]+'</option>';
	}

    m = '<DIV class=boStat><b>'+lang.AUTOTRONE.stats.title+'</b></div><center><table border=0 width=75%><tr><td>'+lang.AUTOTRONE.stats.power+'<br><b>'+addCommas(uW.cm.ThroneController.calcMight())+'</b><br>'+addCommas(t.calcMightNoBroked())+'</td>\
    <td colspan=2 style="text-align:right">'+pubdusite+'</td></tr></table><table><tr><td><b><center>'+lang.AUTOTRONE.equip.preset2+'<br>('+ThroneOptions.presetname[Seed.throne.activeSlot]+')</center></td><td><enter><b>Comparer : <select id="BOListPStat">'+tt+'</select></td></tr><tr><td align=top><table align=top>';
    var k=Seed.throne.slotEquip[Seed.throne.activeSlot],i=Seed.throne.inventory,e,faction;
      var B=0, w={}, x, C;



           for (var K in k) {
            var F = uW.kocThroneItems[k[K]];
            if (F) {
            x=0;

            for (var M in F.effects) {
            x++;
            if (F.quality >= x) {
             B++;
             I = uW.cm.thronestats.effects[F.effects[M].id];
             if (uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier]) z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier];
             else z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier-1];
             C = + z.base + (F.level * F.level + F.level) * + z.growth * 0.5;
             //C = Math.ceil(C);
             if (!F.isBroken) {
                if (!w[F.effects[M].id]) {
                  w[F.effects[M].id] = {};
                  w[F.effects[M].id].nameitem="";
                }
                if (!w[F.effects[M].id].percent) {
                  w[F.effects[M].id].percent = C;
                } else {
                 w[F.effects[M].id].percent += C;
                }
                w[F.effects[M].id].name = I[1];
                w[F.effects[M].id].nameitem += "(" + ThroneItemName(F) + ") ";
                w[F.effects[M].id].name2 = I[2];
             }
            }
            }
            }
           }
        B = 0;
        var final = new Array();
		for (var K in w) {
		 		  final.push({id:K,name:w[K].name,name2:w[K].nameitem,name3:w[K].name2,percent:w[K].percent});
		}
	    final=final.sort(function sort(a,b) {a = a['name3'];b = b['name3'];return a == b ? 0 : (a < b ? -1 : 1);});
	    for (var K in final) {
			   if (final[K].percent>0 || final[K].percent<0) {
			    var Current =  Math.round(final[K].percent*100)/100;
			    G="<tr><td align=right><b>"+ Current + " %</b></td><td align=left><span title='"+final[K].name2+"'>" + final[K].name + "</td></tr>";
			    m+=G;
		        }
	    }

 	var u =  Seed.throne.slotEquip[Seed.throne.activeSlot];
		var z = uW.cm.ThroneController.hasFactionBonus(u);
 	if (z.hazBonus) {
	        switch (z.faction) {
	          case "briton":
	            B = 94;
	            F = uW.cm.ThroneController.effectBonus(B);
	            break;
	          case "fey":
	            B = 95;
	            F = uW.cm.ThroneController.effectBonus(B);
	            break;
	          case "druid":
	            B = 96;
	            F = uW.cm.ThroneController.effectBonus(B);
	            break;
	          default:;
        	}
 	  m+="<tr><td align=right><b>" + F + "%</td><td align=left>"+uW.g_js_strings.throneRoom["faction_bonus_" + z.faction] + "</tr>";
 	}
 	var cText = "";
 	var title=uW.g_js_strings.commonstr.throneroom + ' (' + ThroneOptions.presetname[numslot]+') ';
      m+="</table></td><td align=top><table align=top>";
         var k=Seed.throne.slotEquip[numslot],i=Seed.throne.inventory,e,faction;
	         var B=0, w={}, x, C;
	              for (var K in k) {
	               var F = uW.kocThroneItems[k[K]];
	               if (F) {
	               x=0;

	               for (var M in F.effects) {
	               x++;
	               if (F.quality >= x) {
	                B++;
	                I = uW.cm.thronestats.effects[F.effects[M].id];
	                if (uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier]) z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier];
	                else z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier-1];
	                C = + z.base + (F.level * F.level + F.level) * + z.growth * 0.5;
	                //C = Math.ceil(C);
	                if (!F.isBroken) {
	                   if (!w[F.effects[M].id]) {
	                     w[F.effects[M].id] = {};
	                     w[F.effects[M].id].nameitem="";
	                   }
	                   if (!w[F.effects[M].id].percent) {
	                     w[F.effects[M].id].percent = C;
	                   } else {
	                    w[F.effects[M].id].percent += C;
	                   }
	                   w[F.effects[M].id].name = I[1];
	                   w[F.effects[M].id].nameitem += "(" + ThroneItemName(F) + ") ";
	                   w[F.effects[M].id].name2 = I[2];
	                }
	               }
	               }
	               }
	              }
	            B = 0;
				        var final = new Array();
						for (var K in w) {
						 		  final.push({id:K,name:w[K].name,name2:w[K].nameitem,name3:w[K].name2,percent:w[K].percent});
						}
					    final=final.sort(function sort(a,b) {a = a['name3'];b = b['name3'];return a == b ? 0 : (a < b ? -1 : 1);});
					    for (var K in final) {
							   if (final[K].percent>0 || final[K].percent<0) {
							    var Current =  Math.round(final[K].percent*100)/100;
							    G="<tr><td align=right><b>"+ Current + " %</b></td><td align=left><span title='"+final[K].name2+"'>" + final[K].name + "</td></tr>";
							    m+=G;
							    HisContent = Current + " % " +  final[K].name;
	   		  					cText +=  HisContent + "||";
						        }
	    }

	    	var u =  Seed.throne.slotEquip[numslot];
	   		var z = uW.cm.ThroneController.hasFactionBonus(u);
	    	if (z.hazBonus) {
	   	        switch (z.faction) {
	   	          case "briton":
	   	            B = 94;
	   	            F = uW.cm.ThroneController.effectBonus(B);
	   	            break;
	   	          case "fey":
	   	            B = 95;
	   	            F = uW.cm.ThroneController.effectBonus(B);
	   	            break;
	   	          case "druid":
	   	            B = 96;
	   	            F = uW.cm.ThroneController.effectBonus(B);
	   	            break;
	   	          default:;
	           	}
	    	  m+="<tr><td align=right><b>" + F + "%</td><td align=left>"+uW.g_js_strings.throneRoom["faction_bonus_" + z.faction] + "</tr>";

 	}
cText = cText.replace(/\|\|\s*$/, "");
      cText = title + "|| "+ cText;

        m+="<tr><td align=center colspan=2><input type=button  class=pbButton id=BOposttochatst value='Post to chat'></td></tr></table></tr></table>";
      t.Overv.innerHTML = m;

 ById ('BOListPStat').addEventListener ('change', function( ) {
         t.Stats(this.value);
       }, false);
         ById("BOposttochatst").addEventListener('click', function(){

	   		 sendChat ("/a "+  cText);

	  },false);
},

togOpt : function (checkboxId, optionName, callOnChange){
    var t = Tabs.Throne;
    var checkbox = ById(checkboxId);
    if (Options[optionName])
      checkbox.checked = true;
    checkbox.addEventListener ('change', eventHandler, false);
    function eventHandler (){
      Options[optionName] = this.checked;
      saveOptions();
      if (callOnChange)
        callOnChange (this.checked);
    }
},

changeOpt : function (valueId, optionName, callOnChange){
    var t = Tabs.Throne;
    var e = ById(valueId);
    e.value = Options[optionName];
    e.addEventListener ('change', eventHandler, false);
    function eventHandler (){
      Options[optionName] = this.value;
      saveOptions();
      if (callOnChange)
        callOnChange (this.value);
    }
},

toggleThroneState: function(){
	var t = Tabs.Throne;
	 if (Options.salvageconfig.Repairrunning ==true) {
		       alert(lang.AUTOTRONE.repair.err1);
		       return;
    	 }
	if (ThroneOptions.Active == true) {
		    ThroneOptions.Active = false;
		    if(ById("Enable")) ById('Enable').value = "Upgrade = OFF";
		    if (Options.BORac_Upg) updatebotbutton("Upgrade - OFF", 'BOautoupgradetab');
		    saveThroneOptions();
            if (Seed.queue_throne.end == undefined && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.off;
	} else {
		    ThroneOptions.Active = true;
		    if(ById("Enable")) ById('Enable').value = "Upgrade = ON";
		    if (Options.BORac_Upg) updatebotbutton("Upgrade - ON", 'BOautoupgradetab');
		    saveThroneOptions();
            if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.waiting;
	}
},

_addTab: function(id,name,qualityfrom,qualityto,levelfrom,levelto,action,active,cost){

	 	var t = Tabs.Throne;
	    var a="";
	    var b="";
	    switch (qualityfrom) {
        		case 0:a = uW.g_js_strings.throneRoom.simple;break;
        		case 1:a = uW.g_js_strings.throneRoom.common;break;
        		case 2:a = uW.g_js_strings.throneRoom.uncommon;break;
       			 case 3:a = uW.g_js_strings.throneRoom.rare;break;
        		case 4:a = uW.g_js_strings.throneRoom.epic;break;
        		case 5:a = uW.g_js_strings.throneRoom.wondrous;break;
        		default:a = uW.g_js_strings.throneRoom.simple;break;
        }
        switch (qualityto) {
        		case 0:b = uW.g_js_strings.throneRoom.simple;break;
        		case 1:b = uW.g_js_strings.throneRoom.common;break;
        		case 2:b = uW.g_js_strings.throneRoom.uncommon;break;
       			case 3:b = uW.g_js_strings.throneRoom.rare;break;
       			case 4:b = uW.g_js_strings.throneRoom.epic;break;
        		case 5:b = uW.g_js_strings.throneRoom.wondrous;break;
        		default:b = uW.g_js_strings.throneRoom.simple;break;
        }
        if (ById('ShowQueue')) {
	     var row = ById('ShowQueue').insertRow(0);
	     row.vAlign = 'top';
	     row.style.color = "black";
	     if (id==0) row.style.color = "green";
	     row.insertCell(0).innerHTML = '<div class="bodown" style="float:left;" id="queueDown_' + id + '"></div><div class="boup" style="float:right;" id="queueUp_' + id + '"></div>'; //id+1;
	     // voir les effets actuelles en cliquant sur le nom
	     namef=name;
	     var y = uW.kocThroneItems[ThroneOptions.Items[id].id];
	     if (y) {
			 namef="<span id='queueDetail_" + id + "'>" + name + "</span><span id='queueDetail2_" + id + "' style='display:none'><TABLE width=100% height=0% align='left' class=pbTab>";
			 for (i=1;i<=5;i++) {
			 			   idzz = y["effects"]["slot"+i]["id"];
			 			   tier = parseInt(y["effects"]["slot"+i]["tier"]);
			 			   level = y["level"];
			 			   if (uW.cm.thronestats.tiers[idzz][tier]) p = uW.cm.thronestats.tiers[idzz][tier];
			 			   else p = uW.cm.thronestats.tiers[idzz][tier-1];
			 			   Current = p.base + ((level * level + level) * p.growth * 0.5);
			 			   level++;
			 			   Next = p.base + ((level * level + level) * p.growth * 0.5);;
			 			   var quality = parseInt(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]["quality"]);
				 		   if (i<=quality) namef+='<TR><TD align=left><FONT size=1 color=black>' + Current + "% " + uW.cm.thronestats["effects"][idzz]["1"] + '</font></td></tr>';
			 					   else namef+='<TR><TD align=left><FONT size=1 color=black>' + Current + "% " + uW.cm.thronestats["effects"][idzz]["1"] + '</font></td></tr>';

		    }
		    namef+="</table></span>";

		 }
		 row.insertCell(1).innerHTML = namef;
	     if (action == "Enhance") {
				row.insertCell(2).innerHTML = a + " -> " + b;
	   	 		row.insertCell(3).innerHTML = levelfrom;
	     }
	     if (action == "Upgrade") {
				row.insertCell(2).innerHTML = a;
	   	 		row.insertCell(3).innerHTML = levelfrom + " -> " + levelto;
	     }
	     row.insertCell(4).innerHTML = action;
		 row.insertCell(5).innerHTML = cost;
	     row.insertCell(6).innerHTML = '<div class="boremove" id="queueDelete_' + id + '"></div>';

		 if (ById('queueDetail_' + id)) {
			  ById('queueDetail_' + id).addEventListener('click', function(){
				 if ( ById('queueDetail2_' + id).style.display=='none') {
					 ById('queueDetail2_' + id).style.display='block';
				 }else{
					  ById('queueDetail2_' + id).style.display='none';
				 }
			  },false);

	     }
	      ById('queueUp_' + id).addEventListener('click', function(){

			            var t = Tabs.Throne;
			            var index = id;
			            if (index<1) return;
			            var q = ThroneOptions.Items.splice(index,1);
                        ThroneOptions.Items.splice(index-1,0,q[0]);
		                ThroneOptions.Tries = 0;
		 	            ThroneOptions.Good = 0;
		 	            ThroneOptions.Bad = 0;
		                saveThroneOptions();
		 			    t.PaintQueue();

             },false);
         ById('queueDown_' + id).addEventListener('click', function(){
			  var t = Tabs.Throne;
               var index = id;
               if (index > (ThroneOptions.Items.length - 2)) return;
               var q = ThroneOptions.Items.splice(index,1);
               ThroneOptions.Items.splice(index+1,0,q[0]);
               ThroneOptions.Tries = 0;
	           ThroneOptions.Good = 0;
	           ThroneOptions.Bad = 0;
               saveThroneOptions();
			   t.PaintQueue();
             },false);
            ById('queueDelete_' + id).addEventListener('click', function(){
			if (ThroneOptions.Items.length ==0 && ThroneOptions.Active && ById('ShowStatus')) {
			   ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.nothing;
			 }
			if (!ThroneOptions.Active && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.off;
			ThroneOptions.Items.splice (id,1);
			saveThroneOptions();
			t.checkUpgradeInfo(false);
      		t.PaintQueue();
      		if (ThroneOptions.Items.length>0) t.paintInfo();
      		 // else ById('ShowInfo').innerHTML = "";
        }, false);

        }
},
 _addTabHeader: function() {
	 var t = Tabs.Throne;
	 if (ById('ShowQueue')) {
	     var row = ById('ShowQueue').insertRow(0);
	     row.vAlign = 'top';
	     row.style.color = "black";
	     row.insertCell(0).innerHTML = "&nbsp;";
	     row.insertCell(0).style.width="55px";
	     row.insertCell(1).innerHTML = uW.g_js_strings.commonstr.nametx;
	     row.insertCell(2).innerHTML = lang.AUTOTRONE.quality;
	     row.insertCell(3).innerHTML = lang.AUTOTRONE.level;
	     row.insertCell(4).innerHTML = uW.g_js_strings.commonstr.actions;
	     row.insertCell(5).innerHTML = uW.g_js_strings.commonstr.cost;
	     row.insertCell(6).innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
	   }
	  },

PaintHistory : function() {
	var t = Tabs.Throne;
	var popHistory = null;
	popHistory = new CPopup('pbShowHistory', 0, 0, 1100, 500, true, function() {clearTimeout (1000);});
	var m = '<DIV style="max-height:460px; height:460px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbShowBarbs" id="pbBars">';
	popHistory.getMainDiv().innerHTML = '</table></div>' + m;
	popHistory.getTopDiv().innerHTML = '<TD><B>'+lang.AUTOTRONE.upgrade.popHistory+'</B></td>';
	for (i=0;i<t.log.length;i++){
		var row = ById('pbBars').insertRow(0);
		row.vAlign = 'top';
		row.style.color = "black";
		row.insertCell(0).innerHTML = t.log[i].time;
		row.insertCell(1).innerHTML = t.log[i].name;
		row.insertCell(2).innerHTML = t.log[i].action;
		row.insertCell(3).innerHTML = t.log[i].tries;
		row.insertCell(4).innerHTML = t.log[i].good;
		row.insertCell(5).innerHTML = t.log[i].bad;
	}
	var row = ById('pbBars').insertRow(0);
	row.vAlign = 'top';
	row.style.color = "black";
	row.insertCell(0).innerHTML = lang.AUTOTRONE.upgrade.popCell0;
	row.insertCell(1).innerHTML = lang.AUTOTRONE.upgrade.popCell1;
        row.insertCell(2).innerHTML = lang.AUTOTRONE.upgrade.popCell2;
        row.insertCell(3).innerHTML = lang.AUTOTRONE.upgrade.popCell3;
        row.insertCell(4).innerHTML = lang.AUTOTRONE.upgrade.popCell4;
	row.insertCell(5).innerHTML = lang.AUTOTRONE.upgrade.popCell5;
	popHistory.show(true)	;
},
addToQueue : function (id,action){
		var t= Tabs.Throne;
		if (ById('ShowHoover')) ById('ShowHoover').innerHTML = "";
	 	ThroneOptions.Items.push ({id:id,action:action,name:ThroneItemName(uW.kocThroneItems[id]),qualityfrom:0,qualityto:0,levelfrom:0,levelto:0,cost:0,active:false});
	    saveThroneOptions();
        t.checkUpgradeInfo(false);

	if (ThroneOptions.Active && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.letsgo;
        if (!ThroneOptions.Active && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.off;
  },

  checkUpgradeInfo : function (firstRun){
	var t= Tabs.Throne;
    var countUpgrade = 0;
	var countEnhance = 0;
    var levelfrom = 0;
	var levelto =0;
	var qualityfrom = 0;
	var qualityto = 0;
	if (ThroneOptions.Items.length == 0) {
		 ThroneOptions.Active = false;
		 		    if(ById("Enable")) ById('Enable').value = "Upgrade = OFF";
		 		    if (Options.BORac_Upg) updatebotbutton("Upgrade - OFF", 'BOautoupgradetab');
		 		    saveThroneOptions();
		            // clearTimeout(t.setActionTimer);
            if (Seed.queue_throne.end == undefined && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.off;
		 return;
}
    for (k=0;k<ThroneOptions.Items.length;k++){
		countUpgrade = 0;
		countEnhance = 0;
		if (uW.kocThroneItems[ThroneOptions.Items[k]["id"]] != undefined) {
				if (k>0) for (l=0;l<k;l++) {
		          	if (ThroneOptions.Items[l]["id"] == ThroneOptions.Items[k]["id"] && ThroneOptions.Items[l]["action"] == "Upgrade") {countUpgrade++;}
					if (ThroneOptions.Items[l]["id"] == ThroneOptions.Items[k]["id"] && ThroneOptions.Items[l]["action"] == "Enhance") {countEnhance++;}
		      	}
				if (ThroneOptions.Items[k]["action"] == "Upgrade") {
					ThroneOptions.Items[k]["levelfrom"] = parseInt(uW.kocThroneItems[ThroneOptions.Items[k]["id"]]["level"]) + countUpgrade;
					ThroneOptions.Items[k]["levelto"] = parseInt(ThroneOptions.Items[k]["levelfrom"]) +1;
					ThroneOptions.Items[k]["qualityfrom"] = parseInt(uW.kocThroneItems[ThroneOptions.Items[k]["id"]]["quality"]) + countEnhance;
					if (ThroneOptions.Items[k]["levelto"]>13 && !firstRun) {ThroneOptions.Items.splice (k,1);saveThroneOptions();return;}
				}
				if (ThroneOptions.Items[k]["action"] == "Enhance") {
					ThroneOptions.Items[k]["qualityfrom"] = parseInt(uW.kocThroneItems[ThroneOptions.Items[k]["id"]]["quality"]) + countEnhance;
					ThroneOptions.Items[k]["qualityto"] = parseInt(ThroneOptions.Items[k]["qualityfrom"]) +1;
					ThroneOptions.Items[k]["levelfrom"] = parseInt(uW.kocThroneItems[ThroneOptions.Items[k]["id"]]["level"]) + countUpgrade;
					if (ThroneOptions.Items[k]["qualityto"]>5 && !firstRun) {
					    ThroneOptions.Items.splice (k,1);
					    t.PaintQueue();
					    t.paintInfo();
    					saveThroneOptions();
					    return;
					 }
				}
				if (ThroneOptions.Items[k]["action"] == "Enhance") var lvl = parseInt(ThroneOptions.Items[k]["qualityfrom"]) +1;
				if (ThroneOptions.Items[k]["action"] == "Upgrade") var lvl = parseInt(ThroneOptions.Items[k]["levelfrom"]) +1;
				costAction = ThroneOptions.Items[k]["action"].toLowerCase();
				if (uW.cm.thronestats[costAction][lvl] != undefined) ThroneOptions.Items[k]["cost"] = uW.cm.thronestats[costAction][lvl].Stones;
				else ThroneOptions.Items.splice (k,1);
		} else ThroneOptions.Items.splice (k,1);
    }
    t.paintHoover();
    t.PaintQueue();
    t.paintInfo();
    saveThroneOptions();
  },
  PaintQueue : function (){
		var t= Tabs.Throne;
		if (ById('ShowQueueDiv')) ById('ShowQueueDiv').innerHTML = '<TABLE id=ShowQueue class=pbStat align="center" width=90%></table>';
		for (k=(ThroneOptions.Items.length-1);k>=0;k--){
			if (ThroneOptions.Items[k]) {
		    	if (typeof(uW.kocThroneItems[ThroneOptions.Items[k]["id"]]) == 'object') t._addTab(k,ThroneOptions.Items[k]["name"],ThroneOptions.Items[k]["qualityfrom"],ThroneOptions.Items[k]["qualityto"],ThroneOptions.Items[k]["levelfrom"],ThroneOptions.Items[k]["levelto"],ThroneOptions.Items[k]["action"],ThroneOptions.Items[k]["active"],ThroneOptions.Items[k]["cost"]);
		    	else ThroneOptions.Items.splice (k,1);
		    }else{

			ThroneOptions.Items=[];

		}
		}
		t._addTabHeader();
  },

  doAction : function (){
        var t= Tabs.Throne;
        clearTimeout(t.setActionTimer);
        var now = new Date().getTime()/1000.0;
        if (!ThroneOptions.Active) return;


		if (ThroneOptions.Items.length==0) {
                 if ( ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.noitem;
                 return;
        }
        ThroneOptions.Items["0"]["active"] = true;
        t.PaintQueue();
        if (uW.kocThroneItems[ThroneOptions.Items["0"]["id"]].isBroken == true && Seed.queue_throne.end == undefined){
		          uW.kocThroneItems[ThroneOptions.Items["0"]["id"]].isBroken = false;
		          uW.kocThroneItems[ThroneOptions.Items["0"]["id"]].brokenType = "";
          		  t.doRepair();
			    return;
        }
        if (ThroneOptions.Tries>ThroneOptions.nexttries) {
	      var action=ThroneOptions.Items["0"].action;
		  var tid=ThroneOptions.Items["0"].id;
		  ThroneOptions.Tries = 0;
		  ThroneOptions.Good = 0;
		  ThroneOptions.Bad = 0;
		  ThroneOptions.Items.splice (0,1);
          t.addToQueue(tid,action);
		  return;
        }

        if ((uW.kocThroneItems[ThroneOptions.Items["0"]["id"]].isBroken == false && Seed.queue_throne.end == undefined) || (uW.kocThroneItems[ThroneOptions.Items["0"]["id"]].isBroken == false && Seed.queue_throne.itemId != ThroneOptions.Items["0"]["id"])){
			if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.trying+" " + ThroneOptions.Items["0"]["action"] + "...";
            if (ThroneOptions.Items["0"]["action"] == "Upgrade") t.doUpgrade();
            if (ThroneOptions.Items["0"]["action"] == "Enhance") t.doEnhance();
        }


  },


  doEnhance : function() {
	var t = Tabs.Throne;
	if (typeof(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]) == 'object') {
				var y = uW.kocThroneItems[ThroneOptions.Items["0"]["id"]];
	} else return;
	var cityid = 0;
	 var ind = -1,highter = parseInt(ThroneOptions.Items["0"]["cost"])*2;
		for (var i = 0; i < Seed.cities.length; i++)  {
						 if (parseInt(Seed.resources["city" + Seed.cities[i][0]]["rec5"][0]) > highter ) {
						     ind = i; cityid = Seed.cities[i][0];
						     highter = parseInt(Seed.resources["city" + Seed.cities[ind][0]]["rec5"][0]);
		}
	}
	if(cityid == 0){
		   if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.notenough+" enhance ! ";
		   return;
	}
	var params = uW.Object.clone(uW.g_ajaxparams);
	params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
	params.action = 'upgradeQuality';
	params.throneRoomItemId = ThroneOptions.Items["0"]["id"];
	params.buffItemId = 0;
	params.payment = "aetherstone";
	params.cityId = cityid;
    params.buffItemId = 0;
	var obk = 0;
	if (ThroneOptions.Use20001 && uW.ksoItems[20001].count > 0) {
		params.buffItemId =20001;obk = 20001;
	}
	if (ThroneOptions.Use20002 && uW.ksoItems[20002].count > 0) {
		params.buffItemId =20002 ;obk = 20002 ;
	}
	if (ThroneOptions.Use20004 && uW.ksoItems[20004].count > 0) {
			params.buffItemId =20004 ;obk = 20004 ;
	}
  	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			loading: true,
			onSuccess: function (transport) {
				var rslt = eval("(" + transport.responseText + ")");
				var t = Tabs.Throne;
				if(rslt.ok){
				    var gems=0;
				    if (obk != 0) {
				       uW.ksoItems[obk].subtract();
				       actionLog("AutoTrone","Utilisation Rune sur " + y.name + " ("+uW.ksoItems[obk].count+")");
				    }
				    if (rslt.gems > 0)
				    {
					    if (ById('ShowStatus')) ById('ShowStatus').innerHTML = 'Upgrader accidentally spent gems!  Turning upgrader off!!';
					    ThroneOptions.Active = false;
					    //clearTimeout(t.setActionTimer);
					    if(ById("Enable")) ById('Enable').value = "Upgrade = OFF";
					    if (Options.BORac_Upg) updatebotbutton("Upgrade - OFF", 'BOautoupgradetab');
					    gems=rslt.gems;
					    actionLog("AutoTrone","<b>ATTENTION UTILSATION DE GEMS !!!!!!");
					    saveThroneOptions();
				    }
				 Seed.resources["city" + cityid]["rec5"][0] -= rslt.aetherstones;
				 y.level = rslt.item.level;
	        	 y.quality = rslt.item.quality
				 y.status = rslt.item.status;
				 if (rslt.success){
				   y.name = y.createName();
				   ThroneOptions.Good++;
				   ThroneOptions.Tries++;
				   var action = ThroneOptions.Items["0"]["action"];
				   if (gems>0) {
				   					    action+="<br>gems : "+gems;
				   }
				   t.addToLog(ThroneOptions.Items["0"]["id"],action,ThroneOptions.Tries,ThroneOptions.Good,ThroneOptions.Bad);
				   ThroneOptions.Tries = 0;
				   ThroneOptions.Good = 0;
				   ThroneOptions.Bad = 0;
				   ThroneOptions.Items.splice (0,1);
				   saveThroneOptions();
				   if (Options.mailtrone) {
				    var params = uW.Object.clone(uW.g_ajaxparams);
			   	    params.emailTo = Seed.player.name;
			   	    params.subject = lang.AUTOTRONE.upgrade.mptitleenhance + ': '+ ThroneItemName(y);
			   	    if (gems>0)
				   	 params.subject = lang.AUTOTRONE.upgrade.mptitleenhance +": "+ ThroneItemName(y) + " GEMS:"+gems;
				     else
			   		params.subject = lang.AUTOTRONE.upgrade.mptitleenhance +": "+ ThroneItemName(y);
			   	    var effft="",x=0,s = y;
			   	    for (var u in s.effects) {
			   			      L = s.effects[u];
			   			      effect = uW.cm.thronestats.effects[L.id];
			   				  if (uW.cm.thronestats.tiers[L.id][L.tier]) tier = uW.cm.thronestats.tiers[L.id][L.tier];
			   				  else tier = uW.cm.thronestats.tiers[L.id][L.tier-1];
			   				  var percent = + tier.base + (s.level * s.level + s.level) * + tier.growth * 0.5;
			   				  percent = percent > 0 ? "+" + percent : + percent;
			   				  percent = Math.ceil(percent);
			   			          effft += percent + "% " + effect[1] + " %0A";
			            }
			            params.message = effft;
			   	    params.requestType = "COMPOSED_MAIL";;
			   	    new MyAjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {method: "post",parameters: params,onSuccess: function (rslt) {
			   	    if(Options.alertConfig.emailAddress!="") sendEmail(Seed.player.name,"",Options.alertConfig.emailAddress,uW.domainName + '-'+Seed.player.name +' >> ' +params.subject,effft);
			   	    },onFailure: function () {},});
			   	   }
    			   if (ById('ShowTries')) ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.waiting + " --";
				  }else{
					   if (rslt.error_code==256) Seed.throne.inventory[params.throneRoomItemId].status = 3;
					   y.isBroken = true;
					   y.brokenType = "quality";
					   y.name = y.createName();
					   ThroneOptions.Tries++;
					   ThroneOptions.Good++;
					   if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.fail + ' Enhance :( <br />Item: ' + ThroneItemName(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]) +"<br />" + lang.AUTOTRONE.repair.repairing;
					   if (ById('ShowTries')) ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.waiting +"" + ThroneOptions.Tries + "<br />"+ lang.AUTOTRONE.upgrade.good +" " + ThroneOptions.Good + "  "+ lang.AUTOTRONE.upgrade.bad +"" + ThroneOptions.Bad;
				    }
				    uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
            		t.checkUpgradeInfo(false);
	          		t.PaintQueue();
				    saveThroneOptions();
				    if (gems>0)reloadKOC();
				} else {
				    if(rslt.error_code==256) {
				     y.isBroken = true;
				     y.brokenType = "quality";
				     y.name = y.createName();
				     uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
				     ThroneOptions.Tries++;
				     saveThroneOptions();
				     t.doRepair();
				     return;
				    }
				    ThroneOptions.Bad++;
				    saveThroneOptions();
				}
				return;
			},
			onFailure: function () {
			   return;
			},
		});
	},
	doUpgrade : function() {
		var t = Tabs.Throne;

		if (typeof(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]) == 'object') {
				var y = uW.kocThroneItems[ThroneOptions.Items["0"]["id"]];
		} else return;
		var cityid = 0;
 	    var ind = -1,highter = parseInt(ThroneOptions.Items["0"]["cost"])*2;
		 	    for (var i= 0; i < Seed.cities.length; i++)  {
					 if (parseInt(Seed.resources["city" + Seed.cities[i][0]]["rec5"][0]) > highter ) {
					     ind = i; cityid = Seed.cities[i][0];
					     highter = parseInt(Seed.resources["city" + Seed.cities[ind][0]]["rec5"][0]);
				}
		}
		if(cityid == 0 && highter < parseInt(ThroneOptions.Items["0"]["cost"])*2){
		   if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.notenough +" UPGRADE !!";
		   return;
		}
		if (ThroneOptions.AutoOff && ThroneOptions.Use20005 && uW.ksoItems[20005].count < 1) {
			if(ById("Enable")) ById('Enable').value = "Upgrade = OFF";
			if (Options.BORac_Upg) updatebotbutton("Upgrade - OFF", 'BOautoupgradetab');
			saveThroneOptions();
			return;
		}
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
		params.action = 'upgradeLevel';
		params.throneRoomItemId = ThroneOptions.Items["0"]["id"];
		params.payment = "aetherstone";
		params.cityId = cityid;
  		params.buffItemId = 0;
		var obk = 0;
	 	if (ThroneOptions.Use20001 && parseInt(uW.ksoItems[20001].count) > 0) {
			params.buffItemId = 20001; obk = 20001;
		}
	    if (ThroneOptions.Use20002 && parseInt(uW.ksoItems[20002].count) > 0) {
			params.buffItemId = 20002; obk =20002;
	    }
		if (ThroneOptions.Use20005 && parseInt(uW.ksoItems[20005].count) > 0) {
			params.buffItemId = 20005;obk = 20005;
		}
		if (ThroneOptions.Use20006 && parseInt(uW.ksoItems[20006].count) > 0) {
			params.buffItemId = 20006; obk = 20006;
		}
		if (y.level+1 == 3 && ThroneOptions.Use20012 && Seed.items.i20012 && parseInt(uW.ksoItems[20012].count) > 0) {
			params.buffItemId = 20012; obk = 20012;
		}
		if (y.level+1 == 5 && ThroneOptions.Use20013 && Seed.items.i20013 && parseInt(uW.ksoItems[20013].count) > 0) {
			params.buffItemId = 20013; obk = 20013;
		}
		if (y.level+1 == 7 && ThroneOptions.Use20014 && Seed.items.i20014 && parseInt(uW.ksoItems[20014].count) > 0) {
			params.buffItemId = 20014; obk = 20014;
		}
      	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, { method: "post", parameters: params, loading: true, onSuccess: function (transport) {
      	  var rslt = eval("(" + transport.responseText + ")");
      	  if(rslt.ok){
			if (obk != 0) { actionLog("AutoTrone", uW.ksoItems[obk].name +" sur " + y.name+ " (reste "+uW.ksoItems[obk].count+")");
			uW.ksoItems[obk].subtract(); }
			var gems=0;
			if (rslt.gems > 0) {
			if (ById('ShowStatus')) ById('ShowStatus').innerHTML = 'Upgrader accidentally spent gems!  Turning upgrader off!!';
			ThroneOptions.Active = false;
			//clearTimeout(t.setActionTimer);
			if(ById("Enable")) ById('Enable').value = "Upgrade = OFF";
			if (Options.BORac_Upg) updatebotbutton("Upgrade - OFF", 'BOautoupgradetab');
			gems=rslt.gems;


				    }
					Seed.resources["city" +cityid]["rec5"][0] -= rslt.aetherstones;
					//setTimeout(uW.update_seed_ajax, 250);
					if (rslt.success)
					{
					   y.level = rslt.item.level;
					   ThroneOptions.Tries++;
					   ThroneOptions.Good++;
					   y.quality = rslt.item.quality;
					   y.name = y.createName();
					   var action = ThroneOptions.Items["0"]["action"];
					   if (gems>0) {
					    action+="<br>gems : "+gems;
					   }
					   t.addToLog(ThroneOptions.Items["0"]["id"],action,ThroneOptions.Tries,ThroneOptions.Good,ThroneOptions.Bad);
					   ThroneOptions.Tries = 0;
					   ThroneOptions.Good = 0;
					   ThroneOptions.Bad = 0;
					   saveThroneOptions();

             		   		ThroneOptions.Items.splice (0,1);
             		   		if (Options.mailtrone) {
             		   		var params = uW.Object.clone(uW.g_ajaxparams);
			   		  params.emailTo = Seed.player.name;
			   			   			     if (gems>0)
			   			   			      params.subject = lang.AUTOTRONE.upgrade.mptitleupgrade +": "+ ThroneItemName(y) + " GEMS:"+gems;
			   			   			     else
			   			   			      params.subject = lang.AUTOTRONE.upgrade.mptitleupgrade +": "+ ThroneItemName(y);
			   			   			     var effft="";
			   			   			     var x=0;
			   			   			     s = y;
			   			   			     for (var u in s.effects) {
			   			   			      L = s.effects[u];
			   			   			      effect = uW.cm.thronestats.effects[L.id];
			   			   				  if (uW.cm.thronestats.tiers[L.id][L.tier]) tier = uW.cm.thronestats.tiers[L.id][L.tier];
			   			   				  else tier = uW.cm.thronestats.tiers[L.id][L.tier-1];
			   			   				  var percent = + tier.base + (s.level * s.level + s.level) * + tier.growth * 0.5;
			   			   				  percent = percent > 0 ? "+" + percent : + percent;
			   			   				  percent = Math.ceil(percent);

			   			   			          effft += percent + "% " + effect[1] + " %0A";

			   			           		     }
			   			   			     params.message = effft;
			   			   			     params.requestType = "COMPOSED_MAIL";;
			   			   			     new MyAjaxRequest(uW.g_ajaxpath + "ajax/getEmail.php" + uW.g_ajaxsuffix, {
			   			   			         method: "post",parameters: params,
			   			   			         onSuccess: function (rslt) {
			   			   			          if(Options.alertConfig.emailAddress!="") sendEmail(Seed.player.name,"",Options.alertConfig.emailAddress,uW.domainName + '-'+Seed.player.name +' >> ' +params.subject,effft);
			   			   			         }, onFailure: function () { },});
    			    			}
    			    			if (ById('ShowTries'))ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.retry + "--";
    			    			if (gems>0) {
    			    			 reloadKOC();
    			    			}
				    }
				    else
				    {
					 if (rslt.break) {
					   y.isBroken = true;
					   y.brokenType = "level";
					   setTimeout(t.doRepair, 1000);
				     }
					   y.status = rslt.item.status;
                       y.name = y.createName();
					   ThroneOptions.Tries++;
					   ThroneOptions.Good++;
					   saveThroneOptions();
					   if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.fail + ' Upgrade :( <br />Item: ' + ThroneItemName(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]) +"<br />" + lang.AUTOTRONE.upgrade.repairing;
					   if (ById('ShowTries')) ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.retry + " " + ThroneOptions.Tries + "<br />"+lang.AUTOTRONE.upgrade.good + " " + ThroneOptions.Good + "   "+lang.AUTOTRONE.upgrade.bad + " " + ThroneOptions.Bad;
				    }
				    uW.cm.ThroneView.renderInventory(uW.kocThroneItems);

						t.checkUpgradeInfo(false);
		          		t.PaintQueue();

						saveThroneOptions();
				} else {
					uW.kocThroneItems[ThroneOptions.Items["0"]["id"]].isBroken = true;
                   	ThroneOptions.Bad++;
					saveThroneOptions();
				}
			    return;
			},
			onFailure: function () {
			   return;
			},
		});
	},
    doRepair : function() {
		var t = Tabs.Throne;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
		params.action = 'timeRepair';
		params.throneRoomItemId = ThroneOptions.Items["0"]["id"];
      	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			loading: true,
			onSuccess: function (transport) {
				var rslt = eval("(" + transport.responseText + ")");
					if(rslt.ok){
              				ThroneOptions.RepairEnd = rslt.eta;
              				var now = new Date().getTime()/1000.0;
              				var t = Tabs.Throne;

				 	 Seed.queue_throne.itemId= ThroneOptions.Items["0"]["id"];
		             		Seed.queue_throne.start=unixTime();
					 Seed.queue_throne.end= rslt.eta;
					 t.repairId = ThroneOptions.Items["0"]["id"];
					 t.repairEnd = rslt.eta;
					 uW.cm.ThroneView.renderInventory(uW.kocThroneItems);
					 var x = rslt.eta - unixTime();
					//ThroneOptions.Good++;
					saveThroneOptions();
					t.repairTimerUpdate();
				   } else {
				   		//ThroneOptions.Good++;
						saveThroneOptions();
				   }
				   return;
			},
			onFailure: function () {
			   return;
			},
		});
	},
  doEquip : function(n,preset, td) {
  		var t = Tabs.Throne;
  		if (typeof(uW.kocThroneItems[n]) == 'object') {
  				var y = uW.kocThroneItems[n];
  		} else return;
  		if (ById("BOMsgOrg")) ById("BOMsgOrg").innerHTML="Plz Wait...";
  		if (!preset) preset=Seed.throne.activeSlot;
  		var params = uW.Object.clone(uW.g_ajaxparams);
  		params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
  		params.action = 'equipItem';
  		params.itemId = y.id;
  		params.presetId = preset;

        	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
  			method: "post",
  			parameters: params,
  			loading: true,
  			onSuccess: function (transport) {
  				var rslt = eval("(" + transport.responseText + ")");
  					if(rslt.ok){
  							uW.cm.ThroneView.clickItemEquip(y);
  							if (ById("BOMsgOrg")) ById("BOMsgOrg").innerHTML="OK";
  							if (td) td.style.borderColor = "green";
  							if (ById("ShowTrPresets"))
								setTimeout(Dashboard.ShowTrPresets,2000)


  				   } else{
  				    if (ById("BOMsgOrg"))ById("BOMsgOrg").innerHTML="Error";
  				   }
  			},
  			onFailure: function () {
  			   ById("BOMsgOrg").innerHTML="Error";
   			   return;
  			},
  		});
  	},

    doUnequip : function(n,preset, td) {
  		var t = Tabs.Throne;
  		if (typeof(uW.kocThroneItems[n]) == 'object') {
  				var y = uW.kocThroneItems[n];
  		} else return;
		ById("BOMsgOrg").innerHTML="Plz Wait...";
  		var params = uW.Object.clone(uW.g_ajaxparams);
  		params.ctrl = 'throneRoom\\ThroneRoomServiceAjax';
  		params.action = 'unequipItem';
  		params.itemId = y.id;
  		params.presetId = preset;

        	new AjaxRequest(uW.g_ajaxpath + "ajax/_dispatch53.php" + uW.g_ajaxsuffix, {
  			method: "post",
  			parameters: params,
  			loading: true,
  			onSuccess: function (transport) {
  				var rslt = eval("(" + transport.responseText + ")");
  					if(rslt.ok){
  							uW.cm.ThroneView.clickItemUnequip(y);
  							ById("BOMsgOrg").innerHTML="OK";
  							td.style.borderColor = "white";
  							if (ById("ShowTrPresets"))
								setTimeout(Dashboard.ShowTrPresets,2000)
  				     } else{
				     				    ById("BOMsgOrg").innerHTML="Error";
  				   }
  			},
  			onFailure: function () {
				ById("BOMsgOrg").innerHTML="Error";
  			   return;
  			},
  		});
  	},

  repairTimerUpdate :function (){
		var t = Tabs.Throne;
        if (ThroneOptions.Items.length == 0) return;
		var now = new Date().getTime()/1000.0;
        var diff = 0;
		if (Seed.queue_throne.end == undefined) return;
		else diff = Seed.queue_throne.end - now;
        if (diff <0){
            if (ThroneOptions.Active && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.waiting;
            if (!ThroneOptions.Active && ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.off;
            uW.kocThroneItems[Seed.queue_throne.itemId].isBroken = false;
            Seed.queue_throne = "";
            return;
        } else {
              if (ById('ShowStatus')) ById('ShowStatus').innerHTML = lang.AUTOTRONE.upgrade.repairing+ ' ' + ThroneItemName(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]) + "<br/>"+lang.AUTOTRONE.upgrade.timeleft+" " + timestr(diff)+ " ("+ timestr(Seed.queue_throne.end - Seed.queue_throne.start) + ")";
              if (ById('ShowTries')) ById('ShowTries').innerHTML = lang.AUTOTRONE.upgrade.retry+ ' ' + ThroneOptions.Tries + "<br />"+lang.AUTOTRONE.upgrade.good+" " + ThroneOptions.Good + " "+lang.AUTOTRONE.upgrade.bad+" " + ThroneOptions.Bad;
	}
  },
  paintInfo : function (){
		var t = Tabs.Throne;
		if (!ThroneOptions.Items["0"]) { ThroneOptions.Items=[];return;}
		 if (typeof(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]) == 'number') {
				var y = uW.kocThroneItems[ThroneOptions.Items["0"]["id"]];
		 } else return;
		  var id =0;
		  var tier=0;
		  var Current=0;
		  var Next=0;
		  m="<TABLE width=80% height=0% align='center' class=pbTab><TR><TD><B>"+lang.AUTOTRONE.upgrade.paintCol1+"</b></td><TD><B>"+lang.AUTOTRONE.upgrade.paintCol2+"</b></td>";
		  for (i=1;i<=5;i++) {
			   id = y["effects"]["slot"+i]["id"];
			   tier = parseInt(y["effects"]["slot"+i]["tier"]);
			   level = y["level"];
			   if (uW.cm.thronestats.tiers[id][tier]) p = uW.cm.thronestats.tiers[id][tier];
			   else p = uW.cm.thronestats.tiers[id][tier-1];
			   Current = p.base + ((level * level + level) * p.growth * 0.5);
			   level++;
			   Next = p.base + ((level * level + level) * p.growth * 0.5);
			   var quality = parseInt(uW.kocThroneItems[ThroneOptions.Items["0"]["id"]]["quality"]);
			   if (ThroneOptions.Items["0"]["action"] == "Enhance") {
					   if (i<=quality) m+='<TR><TD><FONT color=green>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td>';
					   else m+='<TR><TD><FONT color=red>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td>';
					   if (i<=(quality+1)) m+='<TD><FONT color=green>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td></tr>';
					   else m+='<TD><FONT color=red>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td></tr>';
			   }
			   if (ThroneOptions.Items["0"]["action"] == "Upgrade") {
					   if (i<=quality) m+='<TR><TD><FONT color=green>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td>';
					   else m+='<TR><TD><FONT color=red>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td>';
					   if (i<=quality) m+='<TD><FONT color=green>' + Next + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td></tr>';
					   else m+='<TD><FONT color=red>' + Next + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td></tr>';
			 }
		}
		m+="</table>"
		ById('ShowInfo').innerHTML = m;

  },
  Preset :function (){
      var t = Tabs.Throne;
      var what="";
      try {
       	var m = "<DIV id=pbTowrtDivF class=boStat>PRESETS</div><DIV id=PresetCont style=' max-height:"+(Options.HauteurBoite-95)+"px; height:"+(Options.HauteurBoite-95)+"px; overflow-x: auto; overflow-y:scroll;'></div>";
      	t.Overv.innerHTML = m;
      	t.PaintPresets();
      } catch (e) {
       	t.Overv.innerHTML = '<PRE>'+ e.name +' : '+ e.message +'</pre>';
      }
},
PaintPresets : function (){
    var t = Tabs.Throne;
    var m= '<TABLE id=pbCompareStats width=100% height=100% class=pbTab>';

     	for (var i=1;i<=8;i++) {
     		m+='<TR><TD colspan=3>&nbsp</td></tr><TR><TD rowspan=7 width=220><a class="button20" id=Button'+i+'><span>'+i+'</span></a><INPUT type=text id=PresetName'+i+' sizz=8 maxlength=8 value="'+ ThroneOptions.BOPresetName[i] +'"><br>';
     		m+='<button id=BOResetB'+i+'>Reset</button></td>';
     		for (j=1;j<t.EquipType.length;j++) {
     			what1 = t.EquipType[j];
     			id1 = ThroneOptions.Presets[i][what1.toLowerCase()];
     			if (what1 == "Chair") what1 = uW.g_js_strings.throneRoom.chair;
     			if (what1 == "Windows") what1 = uW.g_js_strings.throneRoom.window;
     			if (what1 == "Table") what1 = uW.g_js_strings.throneRoom.table;
     			if (what1 == "Trophy") what1 = uW.g_js_strings.throneRoom.trophy;
     			if (what1 == "Advisor") what1 = uW.g_js_strings.throneRoom.advisor;
     			if (what1 == "Candelabrum") what1 = uW.g_js_strings.throneRoom.candelabrum;
     			if (what1 == "Hero") what1 = uW.g_js_strings.throneRoom.hero;
     			if (what1 == "Banner") what1 = uW.g_js_strings.throneRoom.banner;
     			if (uW.kocThroneItems[id1] != undefined) name1 = ThroneItemName(uW.kocThroneItems[id1]);
     				else name1 = "";
     			if (j%2>0) m+='<TR>';
     			if (uW.kocThroneItems[id1] != undefined && uW.kocThroneItems[id1].isEquipped) m+='<TD>' + what1 + ': <B>' + name1 + '</b></td>';
     				else  m+='<TD>' + what1 + ': ' + name1 + '</td>';
     			if (j%2==0) m+='</tr>';
     		}
     		m+='</tr><TR><TD>&nbsp</td></tr>';
     	}
     	ById('PresetCont').innerHTML = m;
     	for (i=1;i<=8;i++) {
    		ById('PresetName'+i).addEventListener('change',function (){
    			for (j=1;j<=8;j++) ThroneOptions.BOPresetName[j] = ById('PresetName'+j).value;
    			saveThroneOptions();
    			if (ById("ShowTrPresets")) setTimeout(Dashboard.ShowTrPresets,2000)
    		},false);
    		ById('Button'+i).addEventListener('click',function (){
    			var what = this.id.substr(6);
    			t.EquipPreset(what);
    		},false);
    		ById('BOResetB'+i).addEventListener('click',function (){
			    			var what = this.id.substr(8);
			    			ThroneOptions.Presets[what]={};
			    			saveThroneOptions();
			    			t.PaintPresets();

    		},false);
    	}
},
EquipPreset : function (what){
    var t = Tabs.Throne;
    var counter= 0;
    for (d=1;d<=8;d++) {
    	var type = t.EquipType[d].toLowerCase();
    	id = ThroneOptions.Presets[what][type];
    	if (uW.kocThroneItems[id] != undefined && !uW.kocThroneItems[id].isEquipped) {
    		counter++;
    		setTimeout(t.doEquip,(5250*(counter-1)),id,Seed.throne.activeSlot);
    	}
    }
	var msg="";
	if (ById("PresetCont") != undefined) ById("PresetCont").innerHTML= msg;
	if (ById("ShowTrPresets") != undefined) ById("ShowTrPresets").innerHTML= msg;
	time = Math.round(counter * 5.25);
	//Tabs.AutoTrain.changeTime = time;
	for (c=0;c<=time;c++){
		msg = '<DIV align="center"><FONT size="8"><B>'+lang.dashboard.waiting+' : ' + (time - c) + '</b></font></div>';
		setTimeout(t.TimeLeft,c*1000,msg);

	}
	if (ById("PresetCont") != undefined) setTimeout(t.PaintPresets,time*1000);
	if (ById("ShowTrPresets")) 	setTimeout(Dashboard.ShowTrPresets,time*1000);
	if (ById("BOTroneAether")) setTimeout(myBO.Trone.show,time*1000);
},
TimeLeft : function(msg) {
	var t = Tabs.Throne;
	if (ById('DIV2') != undefined) ById('DIV2').innerHTML = msg;
	if (ById('PresetCont') != undefined) ById('PresetCont').innerHTML = msg;
	if (ById('ShowTrPresets') != undefined) ById('ShowTrPresets').innerHTML = msg;
},
paintHoover : function (){
	var t = Tabs.Throne;
	if (!ById('ThroneItems')) return;
	var z = ById('ThroneItems').value;
  	var y = uW.kocThroneItems[z];
  	if (!y) {
		t.Upgrade_Enhance();
		return;
	}
	var id =0;
	var tier=0;
	var Current=0;
	m="<TABLE width=80% height=0% align='center' class=pbTab>";
	for (i=1;i<=5;i++) {
		id = y["effects"]["slot"+i]["id"];
		tier = parseInt(y["effects"]["slot"+i]["tier"]);
		level = y["level"];
		if (uW.cm.thronestats.tiers[id][tier]) p = uW.cm.thronestats.tiers[id][tier];
		else  p = uW.cm.thronestats.tiers[id][tier-1];
		Current = p.base + ((level * level + level) * p.growth * 0.5);
		Current = Math.round(Current*100)/100;
		var quality = y.quality
		if (i<=quality) m+='<TR><TD><FONT color=green>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td></tr>';
		else m+='<TR><TD><FONT color=red>' + Current + "% " + uW.cm.thronestats["effects"][id]["1"] + '</font></td></tr>';
	}
	m+="</table>"
	ById('ShowHoover').innerHTML = m;

},

paintStones : function (){
	var t = Tabs.Throne;
	m="<TABLE width=90% height=0% class=pbTab><TR><TD><img height=18 src="+gameurl+"img/aetherstone_30.png></td>";
	for (i=0;i<Seed.cities.length;i++) m+='<TD>' + Seed.cities[i]["1"] + '</td>';
	m+="<td align=center width=25><img height=18 src='"+gameurl+"img/items/70/20002.jpg'></td><td align=center width=25><img height=18 src='"+gameurl+"img/items/70/20005.jpg'></td><td align=center width=25><img height=18 src='"+gameurl+"img/items/70/20006.jpg'></td></tr><TR><TD></td>"
	for (i=0;i<Seed.cities.length;i++) m+='<TD>' + addCommas(Seed.resources["city"+Seed.cities[i]["0"]]["rec5"][0]) + '</td>';
	m+="<td align=center>"+uW.ksoItems[20002].count+"</tD><td align=center>"+uW.ksoItems[20005].count+"</tD><td align=center>"+uW.ksoItems[20006].count+"</tD></tr></table>"
	if (ById('ShowStones')) ById('ShowStones').innerHTML = m;
},

addToLog : function (id,action,tries,good,bad){
	var t = Tabs.Throne;
	var now = new Date();
	var time = now.getDate() +"/"+ (now.getMonth()+1) +"/"+ now.getFullYear() +"  "+ now.getUTCHours() + ":" + now.getMinutes();
	var name = uW.kocThroneItems[id]["name"];
	t.log.push ({time:time,name:name,action:action,tries:tries,good:good,bad:bad});
	if (t.log.length > 50) t.log.splice(0,1);
	GM_setValue ('ThroneHistory_'+getServerId(), JSON2.stringify(t.log));
},

addZero : function (i){
if (i<10)
  {
  i="0" + i;
  }
return i;
},

hide : function (){
},

show : function (){
    var t = Tabs.Throne;
    if (t.curTabName == 'S2l') {
    	ById("ThroneOutput").style.width="760px";t.SalvageV2();
    } else if (t.curTabName == 'UE') {
    	ById("ThroneOutput").style.width="760px";t.Upgrade_Enhance();
    } else if (t.curTabName == 'OR'){
        ById("ThroneOutput").style.width="900px";t.Organize();
   	} else if (t.curTabName == 'ST'){
    	t.Stats(1);ById("ThroneOutput").style.width="760px";
    } else if (t.curTabName == 'TC'){
	 	t.Caps();ById("ThroneOutput").style.width="760px";
	} else if (t.curTabName == 'PR'){
	 	t.Preset();ById("ThroneOutput").style.width="760px";
	}
},
toggleRepairon: function(obj){
     if (ThroneOptions.Active) {
       alert(lang.AUTOTRONE.repair.err2);
      return;
     }
         var t = Tabs.Throne;
          obj = ById('BOTroneRepairEnable');
          if (Options.salvageconfig.Repairrunning == true) {
           Options.salvageconfig.Repairrunning = false;
           if (obj) obj.value = lang.AUTOTRONE.repair.repairoff;
          }
          else {
           Options.salvageconfig.Repairrunning = true;
           if (obj) obj.value = lang.AUTOTRONE.repair.repairon;

           RepairAuto.init();
          }
          saveOptions ();
   },
}

/******************* Apothecary Tab **********************/
Tabs.Apothecary = {
  tabOrder : 20,
  tabDisabled : false,
  tabLabel : lang.BoiteLabelApothecary,
  cities : [],
  pop : null,
  pop2 : null,
  myDiv : null,
  timer : null,
  cancelTrainingBO : function (p1,p2,p3,p4,p5,p6,p7) {
     var t = Tabs.Apothecary;
     var params = uW.Object.clone(uW.g_ajaxparams);
       params.cityId = p2;
       params.apothecary ="true";
       params.requestType ="CANCEL_TRAINING";
       params.numtrptrn = p4;
       params.trnETA= p5;
       params.trnNeeded = p7;
       params.trnTmp = p6;
       params.typetrn= p3

    new MyAjaxRequest(uW.g_ajaxpath + "ajax/cancelTraining.php" + uW.g_ajaxsuffix, {
            method: "post",
            parameters: params,
          onSuccess: function (rslt) {
           var t = Tabs.Apothecary;
           if (rslt.ok) {
  	        uW.seed.queue_revive["city"+p2].splice(p1,1);
           }
          },
          onFailure: function (rslt) {
           var t = Tabs.Apothecary;
          }
      });
  },
  init : function (div){
    var t = Tabs.Apothecary;
    t.myDiv = div;
    uW.BOAPO = t.display_action;
    uW.BOcancelTraining2 = t.cancelTrainingBO;
    setTimeout(function() {
	  if (Options.BORac_Apo) {
		AddSubTabLink(lang.Apothecary.label, t.e_toggleswitch, 'boautohealtab');
		if (ApothecaryOptions.Active == false)
		  updatebotbutton(lang.Apothecary.label+" - OFF", 'boautohealtab');
		else
		  updatebotbutton(lang.Apothecary.label+" - ON", 'boautohealtab');
	    }
    },100);
    var m = '<DIV class=boStat >'+lang.Apothecary.label+'</div><table width=100% height=0% class=pbTab><tr align=center >';
    m += '<td><input type=submit id=pbapothecary_power value="'+lang.Apothecary.power+' = '+(ApothecaryOptions.Active?'ON':'OFF')+'" /></td>\
          <td><input type=submit id=pbapothecary_show value="'+lang.Apothecary.show+'" /></td></tr></table>';
	m += '<DIV class=boStat id=pbapothecary_options >'+lang.Apothecary.options+'</div><table></tr>\
	      <td>'+lang.Apothecary.gold+' <INPUT type=text id="pbapothecary_gold" size=6 value='+ApothecaryOptions.goldkeep+' /></td>\
		  <td colspan=4><span id="pbapothecary_citysel"></span></td></tr><tr>\
		  <td>'+uW.g_js_strings.commonstr.troops+' : <SELECT id="pbapothecary_troops"><option value=0>--Select--</options>';
	for (y in uW.unitcost)
		m += '<option value="'+y.substr(3)+'">'+uW.unitcost[y][0]+'</option>';
    m += '</select></td>\
		  <td>Min.: <INPUT id=pbapothecary_min type=text size=4 \></td>\
		  <td><INPUT type=checkbox id=pbapothecary_maxcheck /> Max.: <INPUT id=pbapothecary_max type=text size=4 DISABLED \></td>\
		  <td><INPUT type=submit id=pbapothecary_save value="'+lang.Apothecary.add+'" /></td>';
	m += '</tr></table><br>';

	m +="<DIV class=boStat>"+lang.Apothecary.stat+"</div><br><span id=boapostat></span>";
    div.innerHTML = m;

     for (var cid in Cities.byID){
    		var city = 'city'+cid;
    		var x = Cities.byID[cid].idx;
    		t.cities[x] = (getCityBuilding(cid, 21).count>0)?false: true;
			if(t.cities[x])
	        t.cities[x] = (getCityBuilding(cid, 23).count>0)?false: true;
    	}
	t.citysel = new CdispCityPicker('BOapo_sel', ById("pbapothecary_citysel"), true, null, 0, t.cities);

    ById("pbapothecary_gold").addEventListener('change', function(){
		ApothecaryOptions.goldkeep = parseIntNan(this.value);
	},false);
    ById("pbapothecary_maxcheck").addEventListener('click', function(){
		ById("pbapothecary_max").disabled = !(ById("pbapothecary_maxcheck").checked);
	},false);
    ById("pbapothecary_save").addEventListener('click', function(){
		t.e_addqueue();
	},false);
	ById("pbapothecary_power").addEventListener('click', function(){
		t.e_toggleswitch(this);
	},false);
	ById("pbapothecary_show").addEventListener('click', function(){
		t.e_displayarray();
	},false);
	t.displayStat();
  },
  displayStat: function() {
   var t = Tabs.Apothecary;
   var m="<table width=98% align=center  class=pbTab><tr><td>&nbsp;</td>";
	 for(var i=0; i<Cities.numCities; i++) {
    	  var cityID = 'city'+ Cities.cities[i].id;
    	         m += "<TD width=80><SPAN class=oohfancy>"+ Cities.cities[i].name.substring(0,10) +"</SPAN></td>";

    	  }
    	  m+="</tr>";
    	  var unitwounded = Seed.woundedUnits;
	   var r=0;
	  for (y in uW.unitcost) {
			   r++;
	      m+='<tr><td><img height=18 title="'+uW.unitcost[y][0]+'" src='+gameurl+'img/units/unit_'+r+'_30.jpg></td>';

	   for(i=0; i<Cities.numCities; i++) {
	     if (unitwounded) {
	      var a=unitwounded["city"+Cities.cities[i].id];
	      if (a) {
	       var nbunit=parseIntNan(a["unt"+r]);
	      }
	     }
	     m+="<td>"+addCommas(nbunit)+"</td>";
	   }
	   m+="</tr>";
	 }
	 m +='<TR><TD style="font-size:6px"><BR></td></tr><tr><td><img src="'+URL_HOSPITAL+'"> #1</b></td>';
	 for(i=0; i<Cities.numCities; i++) {
	              var totTime = 0;
	              var ah=Seed.queue_revive["city" + Cities.cities[i].id];
	              var l=0;
	              if (ah) {
	               for(var an=0;an<Math.min(ah.length,1);an++){
	                  var P=uW.unixtime();
	                  l=parseInt(ah[an][3])-P;
	               }
	               var totTime = 0;
	               totTime = parseIntNan(l);
	               if (totTime < 0)
	                 totTime = 0;
	                 affuichage = timestr(totTime);

	               m +="<td><span>"+ affuichage + "</span></td>";

	              } else {
	              affuichage = timestr(totTime);

	              m +="<td><span>"+affuichage+"</span></td>";
	              }
	             }
             m +="</tr>";
              m += '<TR><TD style="font-size:6px"><BR>';
             for(i=0; i<Cities.numCities; i++) {
              var ah=Seed.queue_revive["city" + Cities.cities[i].id][0];
              m +='</td><td>';
              if (ah) {

	       	                  var P=uW.unixtime();
	       	                  l=parseInt(ah[3])-P;

	       	               var totTime = 0;
	       	               totTime = parseIntNan(l);
	       	               if (totTime < 0)
	                 totTime = 0;
	                 if (totTime>0)
              	m+='<span><a onclick="BOcancelTraining2(0,'+Cities.cities[i].id+','+ah[0]+','+ah[1]+','+ah[3]+','+ah[2]+','+ah[5]+',false);return false;" href="#" class="button20" id="button_training_cancel"><span>'+uW.g_js_strings.commonstr.cancel+'</span></a></span>';
              }
             }
         m +='<TR><TD style="font-size:6px"><BR></td></tr><tr><td><img src="'+URL_HOSPITAL+'"> #2</b></td>';
	             for(i=0; i<Cities.numCities; i++) {
	              var totTime = 0;
	              var ah=Seed.queue_revive2["city" + Cities.cities[i].id];
	              var l=0;
	              if (ah) {
	               for(var an=0;an<Math.min(ah.length,1);an++){
	                  var P=uW.unixtime();
	                  l=parseInt(ah[an][3])-P;
	               }
	               var totTime = 0;
	               totTime = parseIntNan(l);
	               if (totTime < 0)
	                 totTime = 0;
	                 affuichage = timestr(totTime);

	               m +="<td><span>"+ affuichage + "</span></td>";

	              } else {
	              affuichage = timestr(totTime);

	              m +="<td><span>"+affuichage+"</span></td>";
	              }
	             }
	m+="</tr></table>";
     ById("boapostat").innerHTML=m;
  },

  e_addqueue : function (){
    var t = Tabs.Apothecary;
    var city = t.citysel.city.idx;
	var troopsel = ById("pbapothecary_troops").value;
	var min = parseIntNan(ById("pbapothecary_min").value);
	var max = parseIntNan(ById("pbapothecary_max").value);
	var max_sel = ById("pbapothecary_maxcheck").checked;
	try {
		if((troopsel < 1 || min < 1) || (max_sel && max < 1) || (max_sel && (max < min)))
			throw "Incomplete/Invalid Input!";
		ApothecaryOptions.city[city].push({troop:troopsel,min:min,max:max,max_sel:max_sel});
		saveApothecaryOptions();
		ById('pbapothecary_options').style.background ='#99FF99';
		setTimeout(function(){ (ById('pbapothecary_options').style.background =''); }, 1000);
	} catch (e){
		ById('pbapothecary_options').style.background ='#FF0000';
		setTimeout(function(){ (ById('pbapothecary_options').style.background =''); }, 1000);
	}
  },

  e_displayarray : function(){
    var t = Tabs.Apothecary;
    if(t.pop == null)
	t.pop = new CPopup('pbapothecary_pop',20,20,400,500,true,function(){t.pop.destroy(); t.pop = null;});
	t.pop.getTopDiv().innerHTML = '<DIV><center>'+lang.Apothecary.detail+'</center></div>';
	var m = '<div style="max-height:380px; height:380px; overflow-y:auto"><table><tr>';
	for (var city in ApothecaryOptions.city){
		if(!Cities.cities[city] || ApothecaryOptions.city[city].length < 1) continue;
		m += '<td colspan=2><b>'+Cities.cities[city].name+'</b></td>\
			  <td>Minimum</td><td>Maximum</td><tr>';
		for(var i=0; i<ApothecaryOptions.city[city].length; i++){
			var info = ApothecaryOptions.city[city][i];
			m += '<td>'+(i+1)+'</td><td>'+uW.unitcost['unt'+info.troop][0]+'</td>\
				  <td>'+info.min+'</td><td>'+info.max+'</td><td>'+strButton20('Edit','title=" edit " onclick="BOAPO(this,'+i+','+city+')"')+'</td><td>'+strButton20('Delete','title=" delete " onclick="BOAPO(this,'+i+','+city+')"')+'</td>';
			m += '</tr><tr>';
		}
		m += '</tr><tr>';
	}
	t.pop.getMainDiv().innerHTML = m + "</table></div>";

	t.pop.show(true);
  },

  display_action : function(obj,id,city){
    var t = Tabs.Apothecary;
	var evt = null;
	if(obj.title.indexOf("edit") > 0)
		evt = "edit";
	if(obj.title.indexOf("delete") > 0)
		evt = "delete";
	if(evt == null || id == null) return;
	if(evt == "delete"){
		ApothecaryOptions.city[city].splice(id,1);
	}
	if(evt == "edit"){
		t.display_edit(id,city);
	}
	saveApothecaryOptions();
	t.e_displayarray();
  },

  display_edit : function(id, city){
	var t = Tabs.Apothecary;
    if(t.pop2 == null)
		t.pop2 = new CPopup('pbapodisp_pop',50,40,300,150,true,function(){t.pop2.destroy(); t.pop2 = null;});
	var m = '<table><tr><td><b>'+Cities.cities[city].name+'</b></td></tr>';
	var info = ApothecaryOptions.city[city][id];
	m += '<tr><td>'+uW.g_js_strings.commonstr.troops+' : </td><td>'+uW.unitcost['unt'+info.troop][0]+'</td></tr>\
		  <tr><td>Minimum: </td><td><INPUT id=pbapodisp_min type=text size=4 value="'+info.min+'" \>\
		  <tr><td><INPUT type=checkbox id=pbapodisp_maxcheck '+(info.max_sel?'CHECKED':'')+' /> Maximum: </td><td><INPUT id=pbapodisp_max type=text size=4 value="'+info.max+'" '+(info.max_sel?'':'DISABLED')+' \></td></tr>\
		  <tr><td><INPUT type=submit id=pbapodisp_save value='+uW.g_js_strings.commonstr.save+' /></td></tr>';
	t.pop2.getMainDiv().innerHTML = m;
	t.pop2.show(true);
	ById('pbapodisp_save').addEventListener('click', function(){
		var min = parseIntNan(ById("pbapodisp_min").value);
		var max = parseIntNan(ById("pbapodisp_max").value);
		var max_sel = ById("pbapodisp_maxcheck").checked;
		if(min < 1 || (max_sel && max < 1) || (max_sel && (max < min))){
			alert("Invalid/Incorrect input!");
			return;
		}
		info.min = min;
		info.max = max;
		info.max_sel = max_sel;
		saveApothecaryOptions();
		t.pop2.show(false);
		t.e_displayarray();
	},false);
  },

  loop : function(){
    var t = Tabs.Apothecary;
    //clearTimeout(t.timer);
    if(!ApothecaryOptions.Active) return;
    for (var city in ApothecaryOptions.city){
		if(!Cities.cities[city] || ApothecaryOptions.city[city].length < 1) continue;
		if(t.cities[city]) continue; //Skip if Apothecary doesn't exist
		if(Seed.queue_revive['city'+Cities.cities[city].id].length > 0) continue;
		if(Seed.citystats["city" + Cities.cities[city].id].gold[0] < parseInt(ApothecaryOptions.goldkeep)) continue;
		for(var i=0; i<ApothecaryOptions.city[city].length; i++){
			var info = ApothecaryOptions.city[city][i];
			var cid = Cities.cities[city].id;
			var amt = 0;
			if(Seed.woundedUnits['city'+cid]['unt'+info.troop] < info.min) continue;
			if(Seed.woundedUnits['city'+cid]['unt'+info.troop] > info.max && info.max_sel){
				amt = info.max;
			} else {
				amt = Seed.woundedUnits['city'+cid]['unt'+info.troop];
			}
			if(cid > 0 && info.troop > 0 && amt > 0){
				t.do_revive(cid,info.troop,amt);
				break;
			}
		}
	}
	//t.timer = setTimeout(t.loop, 10000);
  },

  e_toggleswitch : function(obj){
    var t = Tabs.Apothecary;
    var obj = ById("pbapothecary_power");
	if(ApothecaryOptions.Active){
		if (obj) obj.value = lang.Apothecary.power+" = OFF";
		ApothecaryOptions.Active = false;
        if (Options.BORac_Apo) updatebotbutton(lang.Apothecary.label+" - OFF", 'boautohealtab');
		//clearTimeout(t.timer);
	} else {
		if (obj) obj.value = lang.Apothecary.power+" = ON";
		ApothecaryOptions.Active = true;
		if (Options.BORac_Apo) updatebotbutton(lang.Apothecary.label+" - ON", 'boautohealtab');
		//t.timer = setTimeout(t.loop,5000);
	}
	saveApothecaryOptions();
  },

  do_revive : function(currentcityid,unitId,num,notify){
    var t = Tabs.Apothecary;
	var params = uW.Object.clone(uW.g_ajaxparams);
	params.cid = currentcityid;
    params.type = unitId;
    params.quant = num;
    params.apothecary = true;
	var time = uW.cm.RevivalModel.getRevivalStats(unitId, num).time;
    var profiler = new uW.cm.Profiler("ResponseTime", "train.php");
	new MyAjaxRequest(uW.g_ajaxpath + "ajax/train.php" + uW.g_ajaxsuffix, {
		method: "post",
		parameters: params,
		onSuccess: function(rslt) {
		  profiler.stop();
		  if (rslt.ok) {
			for (var i = 1; i < 5; i++) {
				var resourceLost = parseInt(uW.unitcost["unt" + unitId][i]) * 3600 * parseInt(num);
				if(rslt.gamble) resourceLost = resourceLost*rslt.gamble[i];
				uW.seed.resources["city" + currentcityid]["rec" + i][0] = parseInt(uW.seed.resources["city" + currentcityid]["rec" + i][0]) - resourceLost;
			}
			if (!rslt.initTS) {
				rslt.initTS = unixTime() - 1;
			}
			Seed.queue_revive["city" + currentcityid].push([unitId, num, rslt.initTS, parseInt(rslt.initTS) + time, 0, time, null]);
			var cost = uW.cm.RevivalModel.getRevivalStats(unitId, num).cost;
			Seed.citystats["city" + currentcityid].gold[0] -= parseInt(cost);
			uW.update_gold();
			uW.cm.WoundedModel.sub(unitId, num);
		  } else {

		  }
		},onFailure: function () {profiler.stop();}
	});
  },

  hide : function (){
    var t = Tabs.Apothecary;
    clearInterval(t.timerStat);
  },

  show : function (){
    var t = Tabs.Apothecary;
    clearInterval(t.displayStat);
    t.timerStat = setInterval(t.displayStat,10000);
  },
}

Tabs.farm = {
	tabLabel: lang.BoiteLabelFarm,
	tabOrder : 18,
	myDiv : null,
	MapAjax : new CMapAjax(),
	popFirst : true,
	opt : {},
	nextattack : null,
	updateSeedTimer: null,
	searchRunning : false,
	tilesSearched : 0,
	tilesFound : 0,
	curX : 0,
	curY : 0,
	lastX : 0,
	firstX : 0,
	firstY : 0,
	lastY : 0,
	rallypointlevel:0,
	knt:{},
	helpArray:{},
	FarmArray:{},
	marchArray:[],
	lookup:1,
	city:0,
	deleteRPT:null,
	timerll:null,
	DipArray: ["friendly","hostile","friendlyToThem","friendlyToYou","neutral","unallied"],
	interval: ["Continuously","1 Hour","2 Hours","3 Hours","6 Hours","12 Hours","24 Hours"],

	init : function (div){
		var t = Tabs.farm;
		t.myDiv = div;

		if (Options.BORac_Far) AddSubTabLink('Farm', t.toggleBarbState, 'BOautoFarm');

		if(typeof(Seed.allianceDiplomacies)=='undefined'){
			t.myDiv.innerHTML ='<BR><CENTER><i><b>'+lang.autoFarm.playerMustInAlliance+'</i></b></center>';
			return;
		}


		var m = '<DIV id=pbFarmTab class=boStat>'+lang.autoFarm.farmHead+'</div><TABLE id=pbFarmOptions width=100% height=0% class=ptTab><TR align="center">';
		if (FarmOptions.Running == false) {
			m += '<TD><INPUT id=FarmAttSearch type=submit value="'+lang.autoFarm.farmButton+' = OFF"></td>';
			if (Options.BORac_Far) updatebotbutton("Farm - OFF", 'BOautoFarm');
			t.checkMarches();
		} else {
			m += '<TD><INPUT id=FarmAttSearch type=submit value="'+lang.autoFarm.farmButton+' = ON"></td>';
			if (Options.BORac_Far) updatebotbutton("Farm - ON", 'BOautoFarm');
			t.timerll=setInterval( t.checkMarches ,5000);
		}
		m +='<TD title="'+lang.autoFarm.farmShowNote+'"><INPUT id=pbpaintFarms type=submit value="'+lang.autoFarm.farmShow+'">';
		m += '<SELECT id=pbFarmcity type=list></select></td></tr></table>';
		m += '</tr></table></div>';

		m += '<DIV id=pbTraderDivD class=boStat>'+lang.autoFarm.farmHeadStats+'</div>';

		m += '<TABLE id=pbfarmstats width=95% height=0% class=ptTab><TR align="left"><TR>';
		for(i=0;i<Seed.cities.length;i++){
			m += '<TD>' + Seed.cities[i][1] +'</td>';
		}
		m+='</tr><TR>';
		for(i=0;i<Seed.cities.length;i++){
			m += '<TD><DIV><span id='+ 'pdtotalFarm' + i +'></span></div></td>';
		}
		m+='</tr><TR>';
		for(i=0;i<Seed.cities.length;i++){
			m += '<TD><DIV><span id='+ 'pddataFarm' + i +'></span></div></td>';
		}
		m+='</tr><TR>'
		for(i=0;i<Seed.cities.length;i++){
			m += '<TD><DIV><span id='+ 'pddataFarmarray' + i +'></span></div></td>';
		}
		m+='</tr></table>';

		m+='<DIV id=FarmCheck></div>';

		m += '<DIV id=pbTraderDivD class=boStat>'+lang.autoFarm.farmHeadOptions+'</div>';
		m += '<TABLE id=pbfarmstats width=90% height=0% class=ptTab>';
		m += '<TR><TD width=180>'+lang.autoFarm.farmKeepRP+' </td><TD><INPUT id=FarmRallyClip type=text size=2 maxlength=2 value=' + FarmOptions.RallyClip +'> '+lang.autoFarm.farmKeepRP2+'</td><td><input id=FarmAsc type=checkbox '+(FarmOptions.Asc?'CHECKED':'')+'> '+lang.autoFarm.FarmAsc+'</td></tr>';
		m += '<TR><TD>'+lang.autoFarm.farmIntervall+'</td><TD><SELECT id=FarmInterval type=list></td></tr>';
		m += '<TR><TD>'+lang.autoFarm.farmSearchDist+'</td><TD><INPUT type=text id=FarmRadius size=3 maxlength=3 value='+ FarmOptions.MaxDistance +'><INPUT id=FarmSearch type=submit value="'+lang.autoFarm.farmSearch+'"></td><tr>';
		m += '<TR><TD>'+uW.g_js_strings.commonstr.might+':</td>';
		m += '<TD width=50>'+lang.autoFarm.shortMin+': <INPUT type=text id=FarmMinMight size=8 maxlength=8 value='+ FarmOptions.MinMight +'></td>';
		m += '<TD>'+lang.autoFarm.shortMax+': <INPUT type=text id=FarmMaxMight size=9 maxlength=9 value='+ FarmOptions.MaxMight +'></td></tr>';
		m += '<TR><TD>'+lang.autoFarm.farmInactivePlayer+' </td>';
		m += '<TD><INPUT type=text id=FarmInactive size=3 value='+ FarmOptions.Inactive +'> '+lang.autoFarm.farmInactivePlayer2+'&nbsp;<INPUT type=text id=FarmInactiveMax size=3 value='+ FarmOptions.InactiveMax +'> '+lang.autoFarm.farmInactivePlayer3+'</td></table>';

	       m += '<TABLE id=pbfarmstats width=90% height=0% class=ptTab><TR align="left"><TR><TD width=100>'+lang.autoFarm.mainCity+':</td>';
		for (i=1;i<=Seed.cities.length;i++) {
			m+='<TD class=pbCityEn><INPUT id=CityEnable'+ i +'  type=checkbox '+(FarmOptions.CityEnable[i]?'CHECKED':'')+'>'+ Seed.cities[i-1][1] +'</td>';
		}
		m += '</tr></table><TABLE id=pbfarmstats width=90% height=0% class=ptTab><TR align="left"><TD width=100>'+lang.autoFarm.farmCityLevel+'</td>';
		for (i=1;i<=12;i++) {
			m+='<TD class=pbCityOpt><INPUT id=CityLevel'+ i +'  type=checkbox '+(FarmOptions.CityLevel[i]?'CHECKED':'')+'>'+ i +'</td>';
		}
		m += '</tr></table><TABLE id=pbfarmstats width=90% height=0% class=ptTab><TR align="left"><TR><TD width=100>'+lang.autoFarm.farmDip+'</td>';
		for (i=0;i<t.DipArray.length;i++) {
			m+='<TD class=pbDipOpt><INPUT id=Diplomacy'+ t.DipArray[i] +'  type=checkbox '+(FarmOptions.Diplomacy[t.DipArray[i]]?'CHECKED':'')+'>'+ t.DipArray[i] +'</td>';
		}
		m+='</tr></table>';

		m += '<DIV id=pbTraderDivD class=boStat>'+lang.autoFarm.farmHeadTroops+'</div>';
		m += '<TABLE id=pbaddreasignroute width=100% height=0% class=ptTab><TR align="center">';
		m += '<TR><TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_1_30.jpg"></td>';
		m += '<TD>'+uW.unitcost['unt1'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_2_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt2'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_3_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt3'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_4_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt4'][0]+'</td></tr>'
		m += '<TR><TD  class=pbTroopOpt><INPUT id=FarmTroop1  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[1] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop2  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[2] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop3  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[3] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop4  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[4] +'\></td></tr>';
		m += '<TR><TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_5_30.jpg"></td>';
		m += '<TD>'+uW.unitcost['unt5'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_6_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt6'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_7_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt7'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_8_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt8'][0]+'</td></tr>'
		m += '<TR><TD  class=pbTroopOpt><INPUT id=FarmTroop5  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[5] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop6  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[6] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop7  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[7] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop8  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[8] +'\></td></tr>';
		m += '<TR><TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_9_30.jpg"></td>';
		m += '<TD>'+uW.unitcost['unt9'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_10_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt10'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_11_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt11'][0]+'</td>'
		m += '<TD rowspan="2"><img height=18 src="'+gameurl+'img/units/unit_12_30.jpg"></td>'
		m += '<TD>'+uW.unitcost['unt12'][0]+'</td></tr>'
		m += '<TR><TD  class=pbTroopOpt><INPUT id=FarmTroop9  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[9] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop10  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[10] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop11  type=text size=10 maxlength=10 value='+ FarmOptions.Troops[11] +'\></td>';
		m += '<TD  class=pbTroopOpt><INPUT id=FarmTroop12 type=text size=10 maxlength=10 value='+ FarmOptions.Troops[12] +'\></td></tr></table>';

		t.myDiv.innerHTML = m;
		t.checkFarmData();
		if(t.nextattack == null) t.nextattack = setInterval(t.getnextCity, FarmOptions.SendInterval*1000);
		ById('pbFarmcity').options.length=0;
		for (i=0;i<Seed.cities.length;i++){
			var o = document.createElement("option");
			o.text = Seed.cities[i][1]
			o.value = i+1;
			ById("pbFarmcity").options.add(o);
		}
		ById('FarmInterval').options.length=0;
		for (i=0;i<t.interval.length;i++){
			var o = document.createElement("option");
			o.text = t.interval[i];
			o.value = i;
			ById("FarmInterval").options.add(o);
		}
		ById('FarmInterval').value = FarmOptions.Interval;
		for(i=0;i<Seed.cities.length;i++){
			var elem = 'pdtotalFarm'+i;
			if (t.FarmArray[i+1] == undefined) ById(elem).innerHTML = '<i>'+lang.autoFarm.farmNoData+'</i>';
			else ById(elem).innerHTML =  ''+lang.autoFarm.farmFarms+' ' + t.FarmArray[i+1].length +'/'+ t.helpArray[i+1].length;
		}
		ById('FarmInterval').addEventListener('change', function(){
			FarmOptions.Interval = ById('FarmInterval').value;
			saveFarmOptions();
		} , false);
		ById('FarmRallyClip').addEventListener('change', function(){
			FarmOptions.RallyClip = ById('FarmRallyClip').value;
			saveFarmOptions();
		} , false);
		ById('FarmAsc').addEventListener('click', function(){
					FarmOptions.Asc = ById('FarmAsc').checked;
					saveFarmOptions();
		} , false);
		ById('FarmRadius').addEventListener('change', function(){
			FarmOptions.MaxDistance = parseInt(ById('FarmRadius').value);
			saveFarmOptions();
		} , false);
		ById('FarmAttSearch').addEventListener('click', function(){t.toggleBarbState(this)} , false);
		ById('FarmSearch').addEventListener('click', function(){
			for (i=1;i<=Seed.cities.length;i++) GM_deleteValue('Farms_' + Seed.player.name + '_city_' + i + '_' + getServerId());
			for(i=0;i<Seed.cities.length;i++){
				var elem = 'pdtotalFarm'+i;
				ById(elem).innerHTML = '<i>'+lang.autoFarm.farmNoData+'</i>';
			}
			t.checkFarmData();
		} , false);
		ById('pbpaintFarms').addEventListener('click', function(){t.showFarms(ById("pbFarmcity").value,Seed.cities[ById("pbFarmcity").value -1][1]);},false);
		ById('FarmMinMight').addEventListener('change', function(){
			FarmOptions.MinMight = parseInt(ById('FarmMinMight').value);
			t.FilterFarms();
			saveFarmOptions();
		} , false);
		ById('FarmMaxMight').addEventListener('change', function(){
			FarmOptions.MaxMight = parseInt(ById('FarmMaxMight').value);
			t.FilterFarms();
			saveFarmOptions();
		} , false);
		ById('FarmInactive').addEventListener('change', function(){
			FarmOptions.Inactive = parseInt(ById('FarmInactive').value);
			t.FilterFarms();
			saveFarmOptions();
		} , false);
		ById('FarmInactiveMax').addEventListener('change', function(){
			FarmOptions.InactiveMax = parseInt(ById('FarmInactiveMax').value);
			t.FilterFarms();
			saveFarmOptions();
		} , false);

		var element = document.getElementsByClassName('pbTroopOpt');
		for (k=0;k<element.length;k++){
			element[k].addEventListener('change', function(){
				for (i=1;i<=10;i++){
					FarmOptions.Troops[i] = ById('FarmTroop' + i).value;
					saveFarmOptions();
				}
			}, false);
		}

		element = document.getElementsByClassName('pbCityOpt');
		for (k=0;k<element.length;k++){
			element[k].addEventListener('change', function(){
				for (i=1;i<=12;i++){
					FarmOptions.CityLevel[i] = ById('CityLevel' + i).checked;
					saveFarmOptions();
				}
				t.FilterFarms();
			}, false);
		}

		element = document.getElementsByClassName('pbCityEn');
		for (k=0;k<element.length;k++){
			element[k].addEventListener('change', function(){
				for (i=1;i<=Seed.cities.length;i++){
					FarmOptions.CityEnable[i] = ById('CityEnable' + i).checked;
					saveFarmOptions();
				}
				t.FilterFarms();
			}, false);
		}

		element = document.getElementsByClassName('pbDipOpt');
		for (k=0;k<element.length;k++){
			element[k].addEventListener('change', function(){
				for (i=0;i<t.DipArray.length;i++){
					FarmOptions.Diplomacy[t.DipArray[i]] = ById('Diplomacy' + t.DipArray[i]).checked;
					saveFarmOptions();
				}
				t.FilterFarms();
			}, false);

		}


	},


	checkMarches: function () {
		var t = Tabs.farm;
		for (i=0;i<FarmOptions.FarmMarches.length;i++){
			var cityId = "city"+ FarmOptions.FarmMarches[i]["cityId"];
			var city = FarmOptions.FarmMarches[i]["city"];
			var marchId = "m" + FarmOptions.FarmMarches[i]["marchId"];
			if (Seed.queue_atkp[cityId][marchId] !=undefined){
				if (Seed.queue_atkp[cityId][marchId].marchStatus == 8  && Seed.queue_atkp[cityId][marchId].hasUpdated) {
					FarmOptions.Checks++;
					saveFarmOptions();
					ById('FarmCheck').innerHTML = "Attacks: " + FarmOptions.Attacks + " - Checks:" + FarmOptions.Checks;
					for(u=1;u<=12;u++) if (parseInt(Seed.queue_atkp[cityId][marchId]["unit"+u+"Return"]) < parseInt(Seed.queue_atkp[cityId][marchId]["unit"+u+"Count"])){
						t.FarmArray[FarmOptions.FarmMarches[i]["city"]][FarmOptions.FarmMarches[i]["number"]]["lost"] = true;
						t.FarmArray[FarmOptions.FarmMarches[i]["city"]][FarmOptions.FarmMarches[i]["number"]]["enabled"] = false;
					}
					for (a=0;a<t.helpArray[FarmOptions.FarmMarches[i]["city"]].length;a++){
						for (b=0;b<t.FarmArray[FarmOptions.FarmMarches[i]["city"]].length;b++){
							if (parseInt(t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['x']) == parseInt(t.helpArray[FarmOptions.FarmMarches[i]["city"]][b]['x']) && parseInt(t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['y']) == parseInt(t.helpArray[FarmOptions.FarmMarches[i]["city"]][b]['y'])){
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['gold'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['gold'];
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['resource1'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['resource1'];
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['resource2'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['resource2'];
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['resource3'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['resource3'];
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['resource4'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['resource4'];
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['empty'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['empty'];
								t.helpArray[FarmOptions.FarmMarches[i]["city"]][a]['lost'] = t.FarmArray[FarmOptions.FarmMarches[i]["city"]][b]['lost'];
							}
						}
					}
					GM_setValue('Farms_' + Seed.player.name + '_city_' + FarmOptions.FarmMarches[i]["city"] + '_' + getServerId(), JSON2.stringify(t.helpArray[FarmOptions.FarmMarches[i]["city"]]));
					FarmOptions.FarmMarches.splice(i,1);
					saveFarmOptions();
				}
			} else {
				FarmOptions.FarmMarches.splice(i,1);
				saveFarmOptions();
			}
		}
	},

	checkInactives : function (citynumber,city,FarmNumber,xcoord,ycoord,kid,uid,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12){
		var t = Tabs.farm;
		var now = new Date().getTime()/1000.0;
		var hours = (now - t.FarmArray[city][FarmOptions.FarmNumber[city]]['LastCheck']) / 3600;
		if (t.FarmArray[city][FarmOptions.FarmNumber[city]]['DaysInactive'] == "?" || hours > 6){
			var params = uW.Object.clone(uW.g_ajaxparams);
			params.pid = uid;
			new AjaxRequest(uW.g_ajaxpath + "ajax/viewCourt.php" + uW.g_ajaxsuffix, {
				method: "post",
				parameters: params,
				onSuccess: function (transport) {
					var rslt = eval("(" + transport.responseText + ")");
					var lastLogin = rslt.playerInfo.lastLogin;
					var fullDate = lastLogin.substr(0,4) +", "+ lastLogin.substr(5,2) +", "+ lastLogin.substr(8,2) ;
					var time = new Date (fullDate).getTime()/1000;
					var days = Math.floor((now - time) / 86400);
					t.FarmArray[city][FarmOptions.FarmNumber[city]]['DaysInactive'] = days;
					for (i=0;i<t.helpArray[city].length;i++){
						if (xcoord == parseInt(t.helpArray[city][i]['x']) && ycoord == parseInt(t.helpArray[city][i]['y'])){
							t.helpArray[city][i]['DaysInactive'] = days;
							t.helpArray[city][i]['LastCheck'] = now;
						}
					}
					GM_setValue('Farms_' + Seed.player.name + '_city_' + city + '_' + getServerId(), JSON2.stringify(t.helpArray[city]));
					if (days >= FarmOptions.Inactive && days <= FarmOptions.InactiveMax) {
						t.doBarb(citynumber,city,FarmNumber,xcoord,ycoord,kid,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12);
					} else 	{
						FarmOptions.FarmNumber[city]++;
						saveFarmOptions();
						t.barbing();
					}
				},
				onFailure: function (rslt) {
					notify (rslt);
				},
			});
		} else {
			if (t.FarmArray[city][FarmOptions.FarmNumber[city]]['DaysInactive'] >= FarmOptions.Inactive && t.FarmArray[city][FarmOptions.FarmNumber[city]]['DaysInactive'] <= FarmOptions.InactiveMax) {
				t.doBarb(citynumber,city,FarmNumber,xcoord,ycoord,kid,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12);
			} 	else{
				FarmOptions.FarmNumber[city]++;
				saveFarmOptions();
				t.barbing();
			}
		}
	},

	showFarms: function (citynumber,cityname) {
		var t = Tabs.farm;
		var popTradeRoutes = null;
		t.popTradeRoutes = new CPopup('pbShowFarms', 0, 0, 1100, 485, true, function() {clearTimeout (1000);});
		var m = '<DIV style="max-height:440px; overflow-y:auto"><TABLE align=center cellpadding=0 cellspacing=0 width=100% class="pbShowBarbs" id="pbBars">';
		t.popTradeRoutes.getMainDiv().innerHTML = '</table></div>' + m;
		t.popTradeRoutes.getTopDiv().innerHTML = '<div class="popupBanner">'+lang.autoFarm.farmFarms+' '+cityname+'</div>';
		t.paintFarms(citynumber,cityname);
		t._addTabHeader(citynumber,cityname);
		t.popTradeRoutes.show(true)	;
	},


	ToggleFarms: function(citynumber) {
		var t = Tabs.farm;
		var id=0;
		var element_class = document.getElementsByClassName('Farm');
		for (d = 1; d <= t.FarmArray[citynumber].length; d++) {
			id = d-1;
			var ele = ById('FarmToggle' + d);
			if (ele.checked) {
				t.FarmArray[citynumber][id].enabled = true;
				t.FarmArray[citynumber][id].lost = false;
				t.FarmArray[citynumber][id].empty = 0;
			}
			else t.FarmArray[citynumber][id].enabled = false;
		}
		for (i=0;i<t.helpArray[citynumber].length;i++){
			for (j=0;j<t.FarmArray[citynumber].length;j++){
				if (parseInt(t.FarmArray[citynumber][j]['x']) == parseInt(t.helpArray[citynumber][i]['x']) && parseInt(t.FarmArray[citynumber][j]['y']) == parseInt(t.helpArray[citynumber][i]['y'])) t.helpArray[citynumber][i].enabled = t.FarmArray[citynumber][j].enabled;
			}
		}
		GM_setValue('Farms_' + Seed.player.name + '_city_' + citynumber + '_' + getServerId(), JSON2.stringify(t.helpArray[citynumber]));
	},

	paintFarms: function(i,cityname){
		var t = Tabs.farm;
		if (t.FarmArray[i] ) {
		 for (k=(t.FarmArray[i].length-1);k>=0;k--){

		  t._addTab(i,cityname,k+1,t.FarmArray[i][k]['enabled'], t.FarmArray[i][k]['x'], t.FarmArray[i][k]['y'],t.FarmArray[i][k]['dist'], t.FarmArray[i][k]['level'],t.FarmArray[i][k]['AllianceName'], t.FarmArray[i][k]['Diplomacy'], t.FarmArray[i][k]['PlayerName'], t.FarmArray[i][k]['cityName'],t.FarmArray[i][k]['might'], t.FarmArray[i][k]['cityNumber'], t.FarmArray[i][k]['attacked'],t.FarmArray[i][k]['DaysInactive'],t.FarmArray[i][k]['lost'],t.FarmArray[i][k]['empty'],t.FarmArray[i][k]['gold'],t.FarmArray[i][k]['resource1'],t.FarmArray[i][k]['resource2'],t.FarmArray[i][k]['resource3'],t.FarmArray[i][k]['resource4']);

		 }

		}
	},


	_addTab: function(citynumber,cityname,queueId,status,X,Y,dist,level,AllianceName,diplomacy,playerName,cityName,might,cityNumber,attacked,DaysInactive,lost,empty,gold,rec1,rec2,rec3,rec4){
		var t = Tabs.farm;
		var row = ById('pbBars').insertRow(0);
		row.vAlign = 'top';
		if (lost) row.style.color = "red";
		if (!lost && empty == 0) row.style.color = "black";
		if (DaysInactive  >= FarmOptions.Inactive && DaysInactive <=  FarmOptions.InactiveMax) row.style.color = "orange";
		row.insertCell(0).innerHTML = queueId;
		row.insertCell(1).innerHTML = "<a href='javascript:void(0)' onclick='cm.utils.CoordinateLinkController.onClick(event)' class='coordinateLink'>("+X+","+Y+")</a>";
		row.insertCell(2).innerHTML = dist;
		row.insertCell(3).innerHTML = level;
		row.insertCell(4).innerHTML = AllianceName;
		row.insertCell(5).innerHTML = diplomacy;
		row.insertCell(6).innerHTML = playerName;
		row.insertCell(7).innerHTML = cityName;
		row.insertCell(8).innerHTML = addCommas(might);
		row.insertCell(9).innerHTML = DaysInactive;
		row.insertCell(10).innerHTML = attacked;
		row.insertCell(11).innerHTML = '<INPUT class=Farm id="FarmToggle' + queueId + '" type=checkbox>';

		var element_class = document.getElementsByClassName('Farm');
		for (c = 0; c < element_class.length; c++) {
			element_class[c].checked = t.FarmArray[citynumber][c].enabled;
			element_class[c].addEventListener('click', function(){t.ToggleFarms(citynumber)}, false);
		}
	},

	_addTabHeader: function(citynumber,cityname) {
		var t = Tabs.farm;
		var row = ById('pbBars').insertRow(0);
		row.vAlign = 'top';
		row.insertCell(0).innerHTML = "Id";
		row.insertCell(1).innerHTML = ""+lang.autoFarm.shortCoordinate+"";
		row.insertCell(2).innerHTML = ""+lang.autoFarm.shortDistance+"";
		row.insertCell(3).innerHTML = ""+uW.g_js_strings.commonstr.level+"";
		row.insertCell(4).innerHTML = ""+lang.autoFarm.farmAllianceName+"";
		row.insertCell(5).innerHTML = ""+lang.autoFarm.mainDiplo+"";
		row.insertCell(6).innerHTML = ""+lang.autoFarm.mainPlayer+"";
		row.insertCell(7).innerHTML = ""+lang.autoFarm.mainCity+"";
		row.insertCell(8).innerHTML = ""+uW.g_js_strings.commonstr.might+"";
		row.insertCell(9).innerHTML = ""+lang.autoFarm.farmInactive+"";
		row.insertCell(10).innerHTML = ""+lang.autoFarm.farmAttacks+"";
	},
	isMyself: function(userID){
		if(!Seed.players["u"+userID])
			return false;
		if(Seed.players["u"+userID].n == Seed.player.name)
			return true;
		else
			return false;
		return false;
	},

	checkFarmData: function(){
		var t = Tabs.farm;
		if(!FarmOptions.Running)return;
		for (i=1;i<=Seed.cities.length;i++){
			t.helpArray[i] = [];
			var myarray = (GM_getValue('Farms_' + Seed.player.name + '_city_' + i + '_' + getServerId()));
			if (myarray == undefined && !t.searchRunning && FarmOptions.CityEnable[i]) {
				t.searchRunning = true;
				t.lookup=i;
				t.opt.startX=parseInt(Seed.cities[(i-1)][2]);
				t.opt.startY=parseInt(Seed.cities[(i-1)][3]);
				t.clickedSearch();
			}
			if (myarray != undefined){
				myarray = JSON2.parse(myarray);
				t.helpArray[i] = myarray.sort(function sortBarbs(a,b) {a = a['dist'];b = b['dist'];return a == b ? 0 : (a < b ? -1 : 1);});
				GM_setValue('Farms_' + Seed.player.name + '_city_' + i + '_' + getServerId(), JSON2.stringify(t.helpArray[i]));
			}
		}
		t.FilterFarms();
	},

	FilterFarms: function() {
		try{
			var t = Tabs.farm;
			if (t.searchRunning) return;
			t.FarmArray = new Array();
			t.FarmArray["1"] = new Array();
			t.FarmArray["2"] = new Array();
			t.FarmArray["3"] = new Array();
			t.FarmArray["4"] = new Array();
			t.FarmArray["5"] = new Array();
			t.FarmArray["6"] = new Array();
			t.FarmArray["7"] = new Array();
			t.FarmArray["8"] = new Array();
			for (u=1;u<=Seed.cities.length;u++){



				for (i=0;i<t.helpArray[u].length;i++){
					var checkLvl = false;
					var checkMight = false;
					var checkDip = false;
					var checkAlliance = false;
					var AllianceName = "";
					for (j=1;j<=12;j++) if (FarmOptions.CityLevel[j] && t.helpArray[u][i].level == j) checkLvl=true;
					if (/*Seed.allianceDiplomacies!=undefinied &&*/ Seed.allianceDiplomacies.allianceName != undefined) AllianceName = Seed.allianceDiplomacies.allianceName;
					if (t.helpArray[u][i].AllianceName != AllianceName) checkAlliance = true;
					if (t.helpArray[u][i].might >= FarmOptions.MinMight && t.helpArray[u][i].might <= FarmOptions.MaxMight) checkMight = true;
					for (j in FarmOptions.Diplomacy) if (FarmOptions.Diplomacy[j] && t.helpArray[u][i].Diplomacy == j) checkDip=true;
					if (checkLvl && checkMight && checkDip && checkAlliance) t.FarmArray[u].push (t.helpArray[u][i]);
				}
				var elem = 'pdtotalFarm'+(u-1);
				if (t.FarmArray[u] == undefined) ById(elem).innerHTML = '<i>'+lang.autoFarm.farmNoData+'</i>';
				else
				 ById(elem).innerHTML =  ''+lang.autoFarm.farmFarms+' ' + t.FarmArray[u].length +'/'+ t.helpArray[u].length;
			 }

		} catch(e){
			GM_log(e.message);
		}
	},



	SortDist: function(a,b) {
		a = parseFloat(a['dist']);
		b = parseFloat(b['dist']);
		return (a < b )? -1 : ((a > b ? 1 : 0));
	},

	toggleBarbState: function(){
		var t = Tabs.farm;
		var obj=ById("FarmAttSearch");
		if (FarmOptions.Running == true) {
			FarmOptions.Running = false;
			if (obj) obj.value = lang.autoFarm.farmButton+' = OFF';
			if (Options.BORac_Far) updatebotbutton("Farm - OFF", 'BOautoFarm');
			saveFarmOptions();
			t.nextattack = null;
			t.updateSeedTimer = null;
			clearInterval(t.timerll);
		} else {
			FarmOptions.Running = true;
			if (obj) obj.value = lang.autoFarm.farmButton+' = ON';
			if (Options.BORac_Far) updatebotbutton("Farm - ON", 'BOautoFarm');
			saveFarmOptions();
			t.checkFarmData();
			t.timerll=setInterval( t.checkMarches ,2000);

			t.nextattack = setInterval(t.getnextCity,(FarmOptions.SendInterval*1000));
		}
	},

	barbing : function(){
		var t = Tabs.farm;
		var city = t.city;
		var u1 = FarmOptions.Troops[1];
		var u2 = FarmOptions.Troops[2];
		var u3 = FarmOptions.Troops[3];
		var u4 = FarmOptions.Troops[4];
		var u5 = FarmOptions.Troops[5];
		var u6 = FarmOptions.Troops[6];
		var u7 = FarmOptions.Troops[7];
		var u8 = FarmOptions.Troops[8];
		var u9 = FarmOptions.Troops[9];
		var u10 = FarmOptions.Troops[10];
		var u11 = FarmOptions.Troops[11];
		var u12 = FarmOptions.Troops[12];
		var now = new Date().getTime()/1000.0;
		now = now.toFixed(0);
		citynumber = Seed.cities[city-1][0];
		cityID = 'city' + citynumber;
		t.rallypointlevel = March.RallyPoint(citynumber).maxSlots;
		t.getAtkKnight(cityID);
		var slots=0;
		if (Seed.queue_atkp[cityID] != undefined){
			for(var k in Seed.queue_atkp[cityID])
				slots++;
			if(Seed.queue_atkp[cityID].toSource() == "[]")
				slots = 0;
		}
		else slots=0;
		var element2 = 'pddataFarmarray'+(city-1);
		if (ById(element2)) ById(element2).innerHTML =  ''+lang.autoFarm.mainSRallyPoint+': (' + slots + '/' + t.rallypointlevel +')';
		if (!FarmOptions.CityEnable[city]) return;
		if ((t.rallypointlevel-FarmOptions.RallyClip) <= slots) return;
		if (t.knt.toSource() == "[]") return;
		if (u1 > parseInt(Seed.units[cityID]['unt1']) || u2 > parseInt(Seed.units[cityID]['unt2']) || u3 > parseInt(Seed.units[cityID]['unt3']) || u4 > parseInt(Seed.units[cityID]['unt4']) || u5 > parseInt(Seed.units[cityID]['unt5']) || u6 > parseInt(Seed.units[cityID]['unt6']) || u7 > parseInt(Seed.units[cityID]['unt7']) || u8 > parseInt(Seed.units[cityID]['unt8']) || u9 > parseInt(Seed.units[cityID]['unt9']) || u10 > parseInt(Seed.units[cityID]['unt10']) || u11 > parseInt(Seed.units[cityID]['unt11']) || u12 > parseInt(Seed.units[cityID]['unt12'])) return;
		if (FarmOptions.FarmNumber[city]>=t.FarmArray[city].length) {
		 FarmOptions.FarmNumber[city]=0;
		 return;
		 }
		var kid = t.knt[0].ID, interval = 0;
		switch(FarmOptions.Interval){
			case "1":interval = 1;break;
			case "2":interval = 2;break;
			case "3":interval = 3;break;
			case "4":interval = 6;break;
			case "5":interval = 12;break;
			case "6":interval = 24;break;
		}

		var check=0;
		while (check == 0){
			check=1;

			for (i=1;i<=12;i++){
				if (FarmOptions.Troops[i] > parseInt(Seed.units[cityID]['unt'+i])) check=0;
			}
			if (FarmOptions.Troops[1] == 0 && FarmOptions.Troops[2] == 0 && FarmOptions.Troops[3] == 0 && FarmOptions.Troops[4] == 0 && FarmOptions.Troops[5] == 0 && FarmOptions.Troops[6] == 0 && FarmOptions.Troops[7] == 0 && FarmOptions.Troops[8] == 0 && FarmOptions.Troops[9] == 0 &&FarmOptions.Troops[10] == 0 && FarmOptions.Troops[11] == 0 && FarmOptions.Troops[12] == 0) check=0;
			if (!t.FarmArray[city][FarmOptions.FarmNumber[city]]['enabled']) check=0;
			if (now < (parseInt(t.FarmArray[city][FarmOptions.FarmNumber[city]]['time']) + (3600 * interval))) check=0;



			if (check ==0) FarmOptions.FarmNumber[city]++;
			if (FarmOptions.FarmNumber[city]>=t.FarmArray[city].length) {
				FarmOptions.FarmNumber[city]=0;
				break;
			}
		}
		if (check == 0) return;

		var xcoord = t.FarmArray[city][FarmOptions.FarmNumber[city]]['x'];
		var ycoord = t.FarmArray[city][FarmOptions.FarmNumber[city]]['y'];
		var uid = t.FarmArray[city][FarmOptions.FarmNumber[city]]['UserId'];
		saveFarmOptions();
		if ((t.rallypointlevel - FarmOptions.RallyClip) > slots) {
		 t.checkInactives(citynumber,city,FarmOptions.FarmNumber[city],xcoord,ycoord,kid,uid,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12);
		}
	},

	getnextCity: function(){
		var t = Tabs.farm;
		if (!FarmOptions.Running) return;
		if(t.searchRunning) return;
		var city = t.city+1;
		if (city>Seed.cities.length){
			city=1;
		}
		t.city = city;
		t.barbing();
	},
	getAtkKnight : function(cityID){
		var t = Tabs.farm;
		t.knt = new Array();
		for (k in Seed.knights[cityID]){
			if (Seed.knights[cityID][k]["knightStatus"] == 1 && Seed.leaders[cityID]["resourcefulnessKnightId"] != Seed.knights[cityID][k]["knightId"] && Seed.leaders[cityID]["politicsKnightId"] != Seed.knights[cityID][k]["knightId"] && Seed.leaders[cityID]["combatKnightId"] != Seed.knights[cityID][k]["knightId"] && Seed.leaders[cityID]["intelligenceKnightId"] != Seed.knights[cityID][k]["knightId"]){
				t.knt.push ({
					Name:   Seed.knights[cityID][k]["knightName"],
					Combat:	Seed.knights[cityID][k]["combat"],
					ID:		Seed.knights[cityID][k]["knightId"],
				});
			}
		}
		t.knt = t.knt.sort(function sort(a,b) {a = a['Combat'];b = b['Combat'];return a == b ? 0 : (a > b ? -1 : 1);});
	},

	doBarb: function(cityID,counter,number,xcoord,ycoord,kid,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,tt){
		var t = Tabs.farm;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.cid=cityID;
		params.type=4;
		params.kid=kid;
		params.xcoord = xcoord;
		params.ycoord = ycoord;
		if (u1>0) params.u1=u1;
		if (u2>0)params.u2=u2;
		if (u3>0)params.u3=u3;
		if (u4>0)params.u4=u4;
		if (u5>0)params.u5=u5;
		if (u6>0)params.u6=u6;
		if (u7>0)params.u7=u7;
		if (u8>0)params.u8=u8;
		if (u9>0)params.u9=u9;
		if (u10>0)params.u10=u10;
		if (u11>0)params.u11=u11;
		if (u12>0)params.u12=u12;
		params.gold =0;
		params.r1=0;
		params.r2=0;
		params.r3=0;
		params.r4=0;
		params.r5=0;
		if (tt)
          params.tt = tt;
        var profiler = new uW.cm.Profiler("ResponseTime", "march.php");
		new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			loading: true,
			onSuccess: function (transport) {
				profiler.stop();
				var rslt = eval("(" + transport.responseText + ")");
				if (rslt.ok) {
					var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
					var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
					var ut = uW.unixtime();
					var unitsarr = [];
            	   for (j in uW.unitcost) unitsarr.push(0);
					var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];
					for(i = 1; i <= unitsarr.length; i++)if(params["u"+i])unitsarr[i] = params["u"+i];
					var currentcityid = params.cid;
					uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, currentcityid, true,ut+rtimediff);
					if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
					var slots=0;
					for(var k in Seed.queue_atkp['city'+cityID]) slots++;
					if(Seed.queue_atkp['city'+cityID].toSource() == "[]") slots = 0;
					var element1 = 'pddataFarmarray'+(counter-1);
					if (ById(element1))
					  ById(element1).innerHTML =  'RP: (' + slots + '/' + t.rallypointlevel +')';
					var now = new Date().getTime()/1000.0;
					now = now.toFixed(0);
					t.FarmArray[counter][number]['time'] = now;
					t.FarmArray[counter][number]['attacked']++;
					FarmOptions.FarmMarches.push ({city:counter,cityId:cityID,marchId:rslt.marchId,number:number});
					FarmOptions.FarmNumber[counter]++;
					FarmOptions.Attacks++;
					saveFarmOptions();
					if (ById('FarmCheck') )
					  ById('FarmCheck').innerHTML = ""+lang.autoFarm.farmAttacks+": " + FarmOptions.Attacks + " - "+lang.autoFarm.farmChecks+": " + FarmOptions.Checks;
					for (i=0;i<t.helpArray[counter].length;i++){
						for (j=0;j<t.FarmArray[counter].length;j++){
							if (parseInt(t.FarmArray[counter][j]['x']) == parseInt(t.helpArray[counter][i]['x']) && parseInt(t.FarmArray[counter][j]['y']) == parseInt(t.helpArray[counter][i]['y'])){
								t.helpArray[counter][i]['time'] = t.FarmArray[counter][j]['time'];
								t.helpArray[counter][i]['attacked'] = t.FarmArray[counter][j]['attacked'];
							}
						}
					}
					GM_setValue('Farms_' + Seed.player.name + '_city_' + counter + '_' + getServerId(), JSON2.stringify(t.helpArray[counter]));
				} else {
					if (rslt.user_action)
					 	actionLog("AutoFarm","<b><font color=red>Alert : "+rslt.user_action+"</font></b>");
					if (rslt.user_action == "backOffWaitTime") {

												if(rslt.tt)
												var tt = rslt.tt;
												var wait = 1;
												if(rslt.wait_time)
						 						wait = rslt.wait_time;
												setTimeout (function(){t.doBarb(cityID,counter,number,xcoord,ycoord,kid,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,tt);}, wait*1000);
												return;
					    }

				}

			},
			onFailure: function () {profiler.stop();}
		});
		saveFarmOptions();
	},

	clickedSearch : function (){
		var t = Tabs.farm;
		t.opt.searchType = 0;
		t.opt.maxDistance = FarmOptions.MaxDistance;
		t.opt.searchShape = 'circle';
		t.mapDat = [];
		t.firstX =  t.opt.startX - t.opt.maxDistance;
		t.lastX = t.opt.startX + t.opt.maxDistance;
		t.firstY =  t.opt.startY - t.opt.maxDistance;
		t.lastY = t.opt.startY + t.opt.maxDistance;
		t.tilesSearched = 0;
		t.tilesFound = 0;
		t.curX = t.firstX;
		t.curY = t.firstY;
		var xxx = t.MapAjax.normalize(t.curX);
		var yyy = t.MapAjax.normalize(t.curY);
		var element = 'pddataFarm'+(t.lookup-1);
		ById(element).innerHTML = ''+lang.autoFarm.farmSearchAt+' '+ xxx +','+ yyy;

		setTimeout (function(){t.MapAjax.request (xxx, yyy, 20, t.mapCallback)}, MAP_DELAY);
	},

	mapCallback : function (left, top, width, rslt){
		var t = Tabs.farm;
		if (!t.searchRunning)
			return;
		if (!rslt.ok){
			t.stopSearch (''+lang.autoFarm.mainError+': '+ rslt.errorMsg);
			return;
		}
		map = rslt.data;
		for (k in map){
			var dist = distance (t.opt.startX, t.opt.startY, map[k].xCoord, map[k].yCoord);
			var who = "u" + map[k].tileUserId;
			if (rslt.userInfo === undefined) continue;
			if (rslt.userInfo[who] === undefined) continue;
			var AllianceName = "";
			if (map[k].cityName == null && !map[k].misted) continue;
			if (t.isMyself(map[k].tileUserId)) continue;
			if (map[k].tileType!= 51) continue;
			if (map[k].isPrestige && !FarmOptions.Asc) continue;


			var Diplomacy = "neutral";
			for (DipStatus in t.DipArray) {
				var AllianceId = 0;
				if (rslt.userInfo[who] != undefined) AllianceId = "a" + rslt.userInfo[who].a;
				for (alliance in Seed.allianceDiplomacies[t.DipArray[DipStatus]]) if (Seed.allianceDiplomacies[t.DipArray[DipStatus]][AllianceId] != undefined) Diplomacy = t.DipArray[DipStatus];
			}
			if (rslt.allianceNames[AllianceId] != undefined) AllianceName = rslt.allianceNames[AllianceId];
			if (Diplomacy == "neutral" && AllianceName =="") Diplomacy = "unallied";

			t.mapDat.push ({time:0,empty:0,lost:false,enabled:'true',attacked:0,DaysInactive:"?",LastCheck:0,Diplomacy:Diplomacy,UserId:map[k].tileUserId,AllianceName:AllianceName,x:map[k].xCoord,y:map[k].yCoord,dist:dist,level:map[k].tileLevel,PlayerName:rslt.userInfo[who].n,cityName:map[k].cityName,might:rslt.userInfo[who].m,cityNumber:map[k].cityNum,tileId:map[k].tileId});
		}
		t.tilesSearched += (20*20);

		t.curX += 20;
		if (t.curX > t.lastX){
			t.curX = t.firstX;
			t.curY += 20;
			if (t.curY > t.lastY){
				var element = 'pdtotalFarm'+(t.lookup-1);
				ById(element).innerHTML = ''+lang.autoFarm.farmFound+' ' + t.mapDat.length;
				var element = 'pddataFarm'+(t.lookup-1);
				ById(element).innerHTML = "";
				GM_setValue('Farms_' + Seed.player.name + '_city_' + t.lookup + '_' + getServerId(), JSON2.stringify(t.mapDat));
				t.searchRunning = false;
				for (y=1;y<=8;y++) FarmOptions.FarmNumber[y] = 0;
				t.checkFarmData();
				return;
			}
		}
		var x = t.MapAjax.normalize(t.curX);
		var y = t.MapAjax.normalize(t.curY);
		var element = 'pddataFarm'+(t.lookup-1);
		ById(element).innerHTML = ''+lang.autoFarm.farmSearchAt+' '+ x +','+ y;
		setTimeout (function(){t.MapAjax.request (x, y, 20, t.mapCallback)}, MAP_DELAY);
	},

	stopSearch : function (msg){
		var t = Tabs.farm;
		var element = 'pddataFarm'+(t.lookup-1);
		ById(element).innerHTML = msg;
		t.searchRunning = false;
	},

	hide : function (){

	},

	show : function (){

	},

};

function getWallInfo (cityId, objOut){
	objOut.wallSpaceUsed = 0;
	objOut.fieldSpaceUsed = 0;
	objOut.wallLevel = 0;
	objOut.wallSpace = 0;
	objOut.fieldSpace = 0;
	objOut.Crossbows = 0;
	objOut.CrossbowsTraining = 0;
	objOut.Trebuchet = 0;
	objOut.TrebuchetTraining = 0;
	objOut.Caltrops = 0;
	objOut.CaltropsTraining = 0;
	objOut.SpikedBarrier = 0;
	objOut.SpikedBarrierTraining = 0;
	objOut.Trap = 0;
	objOut.TrapTraining = 0;
	objOut.slotsBusy = 0;
	var b = Seed.buildings["city" + cityId];
	if (b.pos1==null)
		return;
	objOut.wallLevel = parseInt(b.pos1[1]);
	var spots = 0;
	for (var i=1; i<(objOut.wallLevel+1); i++)
		spots += (i * 500);
	objOut.wallSpace = spots;
	objOut.fieldSpace = spots;

	var fort = Seed.fortifications["city" + cityId];
	for (k in fort){
		var id = parseInt(k.substr(4));
		if (id == 53)
			objOut.Crossbows = parseInt(fort[k]);
		else if (id == 55)
			objOut.Trebuchet = parseInt(fort[k]);
		else if (id == 60)
			objOut.Trap = parseInt(fort[k]);
		else if (id == 61)
			objOut.Caltrops = parseInt(fort[k]);
		else if (id == 62)
			objOut.SpikedBarrier = parseInt(fort[k]);
		if (id<60)
			objOut.wallSpaceUsed += parseInt(uW.fortstats["unt"+ id][5]) * parseInt(fort[k]);
		else
			objOut.fieldSpaceUsed += parseInt(uW.fortstats["unt"+ id][5]) * parseInt(fort[k]);
	}
	var q = Seed.queue_fort["city"+cityId];
	if (q && q.length>0) {
		for (qi=0; qi<q.length; qi++) {
			objOut.slotsBusy++;
			if (q[qi][0]==53)
				objOut.CrossbowsTraining += parseInt(q[qi][1]);
			if (q[qi][0]==55)
				objOut.TrebuchetTraining += parseInt(q[qi][1]);
			if (q[qi][0]==60)
				objOut.TrapTraining += parseInt(q[qi][1]);
			if (q[qi][0]==61)
				objOut.CaltropsTraining += parseInt(q[qi][1]);
			if (q[qi][0]==62)
				objOut.SpikedBarrierTraining += parseInt(q[qi][1]);
		}
	}
}


function addScript (scriptText){
	var scr = document.createElement('script');
	scr.innerHTML = scriptText;
	document.body.appendChild(scr);
}
addScript ('uwuwuwFunc = function (text){ eval (text);  }');


function distance (d, f, c, e) {
  var a = 750;
  var g = a / 2;
  var b = Math.abs(c - d);
  if (b > g)
    b = a - b;
  var h = Math.abs(e - f);
  if (h > g)
    h = a - h;
  return Math.round(100 * Math.sqrt(b * b + h * h)) / 100;
};

function setTabStyle (e, selected){
  if (selected){
    e.className = 'matTabSel';
  } else {
    e.className = 'matTabNotSel';
  }
}
function clickedTab2 (e){
  who2 = e.target.id.substring(3);
  newObj2 = myBO[who2];
   if (myBO[currentName2]==undefined) {
       currentName2 = 'Attaque';
    }
  currentObj2 = myBO[currentName2];
  if (currentName2 != who2){
    setTabStyle (ById ('ab'+currentName2), false);
    setTabStyle (ById ('ab'+who2), true);
    if (currentObj2){
      currentObj2.hide ();
      currentObj2.getContent().style.display = 'none';
    }
    currentName2 = who2;
    Options.currentTab2 = currentName2;
    cont = newObj2.getContent();
    newObj2.getContent().style.display = 'block';
  }
  newObj2.show();
}

function mouseMainTab (me){   // right-click on main button resets window location
  if (me.button == 2){
    var c = getClientCoords (ById('main_engagement_tabs'));
    mainPop.setLocation ({x: c.x+4, y: c.y+c.height});
  }
}

function eventHideShow (){
  if (mainPop.toggleHide(mainPop)){
    tabManager.showTab();
    Options.pbWinIsOpen = true;
  } else {
    tabManager.hideTab();
    Options.pbWinIsOpen = false;
  }
  saveOptions();
}

function hideMe (){
  mainPop.show (false);
  tabManager.hideTab();
  Options.pbWinIsOpen = false;
  saveOptions();
}

function showMe (){
  mainPop.show (true);
  tabManager.showTab();
  Options.pbWinIsOpen = true;
  saveOptions();
}


function mouseMainTab2 (me){
  if (me.button == 2){
    var c = getClientCoords (ById('main_engagement_tabs'));
    mainPop2.setLocation ({x: c.x+4, y: c.y+c.height});
  }
}

function eventHideShow2 (){
  if (mainPop2.toggleHide(mainPop2)){
    if (myBO[currentName2]==undefined) {
         currentName2 = 'Attaque';
    }
    myBO[currentName2].show();
    Options.ptWin2IsOpen = true;
  } else {
   if (myBO[currentName2]==undefined) {
       currentName2 = 'Attaque';
    }
    myBO[currentName2].hide();
    Options.ptWin2IsOpen = false;
  }
  saveOptions();
}

function reloadKOC (){
  var serverId = getServerId();
  if(serverId == '??') {window.location.reload(true);return false;}
  var addl='';
  if (Options.Langue) {
   addl="&lang="+Options.Langue;
  }
  var goto = window.location.protocol+'//apps.facebook.com/kingdomsofcamelot/?s='+serverId+''+addl;
  if(document.URL.match(/standalone=1/i)){
 	goto = window.location.protocol+'//www.kabam.com/kingdoms-of-camelot/play?s='+serverId+''+addl;
  }
  var t = '<FORM target="_top" action="'+ goto +'" method=post><INPUT id=xxpbButReload type=submit value=RELOAD><INPUT type=hidden name=s value="'+ serverId +'"</form>';
  var e = document.createElement ('div');
  e.innerHTML = t;
  document.body.appendChild (e);
  setTimeout (function (){ById('xxpbButReload').click();}, 0);

}

function getResearchLevels () {
	for (var t=1; t < 17; t++) {
		if (t != 7) {
			researchLevels[t] = {};
			researchLevels[t].Id = t;
			researchLevels[t].Name = uW.techcost['tch'+t][0].replace (/&#39;/img, '\'');
			researchLevels[t].Level = parseInt(Seed.tech['tch'+t]);
			researchLevels[t].NextLevelETA = 0;
		}
	}
	for (var t=1; t < 7; t++) {

				research2Levels[t] = {};
				research2Levels[t].Id = t;
				research2Levels[t].Name = uW.techcost2['tch'+t][0].replace (/&#39;/img, '\'');
				research2Levels[t].Level = parseInt(Seed.tech2['tch'+t]);
				research2Levels[t].NextLevelETA = 0;

	}
	var q;
	var now = unixTime();
	for(var i=0; i<Cities.numCities; i++) { // each city
		var cityID = 'city'+ Cities.cities[i].id;
		q = Seed.queue_tch[cityID];
		if (q[0] != undefined)
			researchLevels[parseInt(q[0][0])].NextLevelETA = parseInt(q[0][3]) - now;
	}
	var q;
		var now = unixTime();
		for(var i=0; i<Cities.numCities; i++) { // each city
			var cityID = 'city'+ Cities.cities[i].id;
			q = Seed.queue_tch2[cityID];
			if (q[0] != undefined)
				research2Levels[parseInt(q[0][0])].NextLevelETA = parseInt(q[0][3]) - now;
	}
}


function BOmodal_barracks_traintime(n,p,currentcityid){
 if(p<1){return 0}
 var h=+(uW.unitcost["unt"+n][7])*p,c,f={},g=uW.seed.buildings["city"+currentcityid],b={},e=uW.seed.knights["city"+currentcityid],l,q=uW.seed.leaders["city"+currentcityid];
 f.barracks=0;f.workshop=0;f.stable=0;f.tech=0;f.knight=0;f.ultimate=0;
 jQuery.each(g,function(u,t){
	t.id=+(t[0]);t.level=+(t[1]);
	var s=(parseInt(n)==13||parseInt(n)==14||parseInt(n)==15);t.isPrestige=(parseInt(t[2])>=100&&parseInt(t[2])<=105);
if((t.id===13||t.id===22||t.id===24||t.id===26)&&t.level>0){
	if((s&&t.isPrestige)||(!s&&!t.isPrestige)){
		f.barracks+=(t.level+9)
	}
}
if(t.id===16&&t.level>0){
	if(+(n)>=9&&+(n)<13){f.workshop=t.level}
}
if(t.id===17&&t.level>f.stable){if(+(n)>=7&&+(n)<13){f.stable=t.level}}});
c=f.barracks/10;
h=Math.max(1,Math.ceil(h/c));
c=1;
if(e){l=e["knt"+q.combatKnightId];
if(l){f.knight=(+(l.combatBoostExpireUnixtime)-uW.unixtime()>0)?(l.combat*1.25):l.combat}else{f.knight=0}}
if(uW.seed.tech){f.tech=uW.seed.tech.tch5}f.ultimate=f.workshop+f.stable+f.tech;c=c*(1+(0.1*f.ultimate)+(0.005*f.knight));

var d=uW.cm.ThroneController.effectBonus(77);
c=c*(1+(d/100));

if(uW.cm.WorldSettings.isOn("GUARDIAN_MARCH_EFFECT")){
	 var SPD={0:0,1:5,2:5,3:10,4:10,5:15,6:15,7:20,8:25,9:35,10:70,11:130,12:250};
	          var b=0,y=false,v=false,w=0;
	          var mm=Seed.guardian;
	          for (var ii in mm) {
	           var ww = mm[ii];
	            if (ww.cityId==currentcityid) {
	            if (ww.type== "stone") y=true;
	            if (ww.guardianCount==4) v=true;
	            var level=0;
	            if (ww.cityGuardianLevels.stone!=undefined) level = ww.cityGuardianLevels.stone;
	            w = SPD[level] / 100;
	            var yy=0;
                var ww=(uW.cm.ThroneController.getBoundedEffect(106)/100);
	            var bx = 0;
	           if (y && v) {bx = 1.5;yy=ww;}
               if (y && !v) {bx = 1;yy=ww;}
	                if (!y && v) bx = 0.5;
	                if (!y && !v) bx = 0;
	                b = (w * bx) + yy;
	                c=c*(1+b);
	           }
         }
}
h=Math.max(1,Math.ceil(h/c));
if(uW.cm.PrestigeModel.isPrestige(currentcityid)){
	var a=uW.cm.PrestigeModel.getPrestigeLevel(currentcityid);
    if(a>0){var m=uW.cm.WorldSettings.getSetting("ASCENSION_BARRACKS_BOOST"),k=JSON.parse(m),o=k.values[a-1][1],i=parseFloat(o);h=Math.ceil(h*i)}}
var r=uW.cm.BlessingSystemModel.isBlessingActive(uW.cm.BlessingSystemModel.getBlessing().DEATH_FROM_AFAR);

if(n==6&&r){h=Math.ceil(h-(h*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().DEATH_FROM_AFAR,currentcityid,{})))}

h=Math.ceil(h-(h*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().EXPEDITED_SENTENCING,currentcityid,{traintime:true,unitid:n})));
h=Math.ceil(h-(h*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().TO_THE_FRONT_LINES,currentcityid,{unitid:n})));
h=Math.ceil(h-(h*uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().PRIORITIZED_CONSTRUCTION,currentcityid,{unittype:n})));

	if (uW.cm.VipModel.isActive()) {
		var s = uW.cm.VipModel.getBoostValue("benefitTraining");
		h = Math.ceil(h - (h * (s / 100)))
	}

return h
}

function getTroopDefTrainEstimates (cityID,cityId){
	var b = Seed.buildings[cityID];
	city.numBarracks = 0;
	city.numBarracksDruid = 0;
	city.numHouse = 0;
	city.maxBarracks = 0;
	city.maxBarracksDruid = 0,
	city.totLevelsBarracks = 0;
	city.totLevelsBarracksDruid=0;
	city.blacksmithLevel = 0;
	city.stableLevel = 0;
	city.workshopLevel = 0;
	city.wallLevel = 0;
	for (var j=1; j<33; j++){
		if (b['pos'+j]) {
			var bname = parseIntNan(b['pos'+j][0]);
			var blvl = parseIntNan(b['pos'+j][1]);
			if (bname==5) {
				city.numHouse++;
			}
			if (bname==13) {
				city.numBarracks++;
				city.totLevelsBarracks += parseInt(blvl);
				if (blvl>city.maxBarracks) city.maxBarracks=blvl;
			}
			if (bname==16)
				city.blacksmithLevel = blvl;
			if (bname==15)
				city.workshopLevel = blvl;
			if (bname==17)
				city.stableLevel = blvl;
			if (bname==19)
				city.wallLevel = blvl;
		}
	}
    for (var j=100;j<105;j++) {
	 if (b['pos'+j]) {
		var bname = parseIntNan(b['pos'+j][0]);
		var blvl = parseIntNan(b['pos'+j][1]);
	 	if (bname==22 || bname==24) {
	 			city.numBarracksDruid++;
	 			city.totLevelsBarracksDruid += parseInt(blvl);
				if (blvl>city.maxBarracksDruid) city.maxBarracksDruid=blvl;

		}
     }
   }
   	var isPrestige = Seed.cityData.city[cityId].isPrestigeCity;
   	if(isPrestige){
   		city.blacksmithLevel = 12;
   		city.workshopLevel = 12;
   		city.stableLevel = 12;
	}
	var now = unixTime();
	city.marshallCombatScore = 0;
	var s = Seed.knights[cityID];
	if (s) {
		s = s["knt" + Seed.leaders[cityID].combatKnightId];
		if (s){
			city.marshallCombatScore = s.combat;
			if (s.combatBoostExpireUnixtime > now)
				city.marshallCombatScore *= 1.25;
		}
	}
	city.foremanBasePoliticsScore = 0;
	var s = Seed.knights[cityID];
	if (s) {
		s = s["knt" + Seed.leaders[cityID].politicsKnightId];
		if (s) {
			city.foremanBasePoliticsScore = s.politics;
	 	     if (s.politicsBoostExpireUnixtime > now)
				city.foremanBasePoliticsScore *= 1.25;
	 }
	}
	city.loggingLevel = parseInt(Seed.tech["tch2"]);
	city.geometryLevel = parseInt(Seed.tech["tch5"]);
	city.eagleEyesLevel = parseInt(Seed.tech["tch6"]);
	city.poisonedEdgeLevel = parseInt(Seed.tech["tch8"]);
	city.metalAlloysLevel = parseInt(Seed.tech["tch9"]);
	city.featherweightPowderLevel = parseInt(Seed.tech["tch10"]);
	city.alloyHorseshoesLevel = parseInt(Seed.tech["tch12"]);
	city.fletchingLevel = parseInt(Seed.tech["tch13"]);
	city.giantsStrengthLevel = parseInt(Seed.tech["tch16"]);


    var r=0;
    for (y in uW.unitcost) {
		  r++;
       h = BOmodal_barracks_traintime(r,10000,cityId);

        city["Troop" + r + "Time"]=  h / 10000;


    }
    var pf = city.foremanBasePoliticsScore/200;
	var gsf = city.giantsStrengthLevel/10;
	var dsf = 1+pf+gsf;
    city.Def53Time = ((city.wallLevel > 5 && city.blacksmithLevel > 5 && city.fletchingLevel > 4)?(180/dsf):0);
	city.Def55Time = ((city.wallLevel > 7 && city.blacksmithLevel > 7 && city.fletchingLevel > 6 && city.geometryLevel > 6)?(135/dsf):0);
	city.Def60Time = ((city.wallLevel > 3 && city.blacksmithLevel > 3 && city.poisonedEdgeLevel > 1)?(90/dsf):0);
	city.Def61Time = ((city.wallLevel > 0 && city.metalAlloysLevel > 0)?(30/dsf):0);
	city.Def62Time = ((city.wallLevel > 1 && city.blacksmithLevel > 1 && city.loggingLevel > 1)?(60/dsf):0);
}

function EffetTronePrc(effet) {
  var k=Seed.throne.slotEquip[Seed.throne.activeSlot],i=Seed.throne.inventory,e,faction;
  var B=0, w={}, x, C;
  for (var K in k) {
 	     var F = uW.kocThroneItems[k[K]];
 	     if (F) {
 	               x=0;
 	               for (var M in F.effects) {
 	               x++;
 	               if (F.quality >= x) {
 	                B++;
 	                I = uW.cm.thronestats.effects[F.effects[M].id];
 	                if (uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier]) z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier];
 	                else z = uW.cm.thronestats.tiers[F.effects[M].id][F.effects[M].tier-1];
 	                C = + z.base + (F.level * F.level + F.level) * + z.growth * 0.5;
 	                if (!F.isBroken) {
 	                   if (!w[F.effects[M].id]) {
 	                     w[F.effects[M].id] = {};
 	                     w[F.effects[M].id].nameitem="";
 	                   }
 	                   if (!w[F.effects[M].id].percent) {
 	                     w[F.effects[M].id].percent = C;
 	                   } else {
 	                    w[F.effects[M].id].percent += C;
 	                   }
 	                   w[F.effects[M].id].name = I[1];
 	                }
 	               }
 	               }
 	               }
           }
           if (!w[effet]) {

            w[effet]={};
            w[effet].percent=0;

           }
           if (w[6])
            if (w[6].percent>500) // load
              w[6].percent=500;

           if (w[66])  // March size
            if (w[66].percent>150)
              w[66].percent=150;

            if (w[77])
		      if (w[77].percent>4000) // training
              w[77].percent=4000;

            if (w[78])
		      if (w[78].percent>600) // construction
              w[78].percent=600;

            if (w[67])
			  if (w[67].percent>300) // march speed
              w[67].percent=300;
  return w[effet];
}

function officerId2String (oid){
  if (oid==null)
    return '';
  else if (oid==3)
    return uW.allianceOfficerTypeMapping[3];
  else if (oid==2)
    return uW.allianceOfficerTypeMapping[2];
  else if (oid==1)
    return uW.allianceOfficerTypeMapping[1];
  else if (oid==4)
      return uW.allianceOfficerTypeMapping[4];
 return '';
}
function setCities(){
	var il = uW.itemlist;
	for (var i=1101; i < 1115; i++)
		crestname[i] = il['i'+i].name
  getResearchLevels();
  Cities.numCities = Seed.cities.length;
  Cities.cities = [];
  Cities.byID = {};
  for (i=0; i<Cities.numCities; i++){
    city = {};
    city.idx = i;city.num = i;
    city.id = parseInt(Seed.cities[i][0]);
    city.name = Seed.cities[i][1];
    city.x = parseInt(Seed.cities[i][2]);
    city.y = parseInt(Seed.cities[i][3]);
    city.tileId = parseInt(Seed.cities[i][5]);
    city.provId = parseInt(Seed.cities[i][4]);
    getTroopDefTrainEstimates('city'+ city.id, city.id);
    Cities.cities[i] = city;
    Cities.byID[Seed.cities[i][0]] = city;
  }
}

/************************ Gold Collector ************************/
var CollectGold = {
  timer : null,
  lastCollect : {},

  init : function (){
    var t = CollectGold;
    for (var c=0; c<Cities.numCities; c++)
      t.lastCollect['c'+ Cities.cities[c].id] = 0;
    if (Options.pbGoldEnable)
      t.setEnable (true);
  },

  setEnable : function (tf){
    var t = CollectGold;
    clearTimeout (t.timer);
    if (tf)
      t.tick();
  },

  colCityName : null,
  colHappy : 0,
  tick : function (){
    var t = CollectGold;
    for (var c=0; c<Cities.numCities; c++){
      var city = Cities.cities[c];
      var happy = Seed.citystats['city'+ city.id].pop[2];
      var since = unixTime() - t.lastCollect['c'+city.id];
      if (happy>=Options.pbGoldHappy && since>15*60){
        t.lastCollect['c'+city.id] = unixTime();
        t.colCityName = city.name;
        t.colHappy = happy;
        t.ajaxCollectGold (city, t.e_ajaxDone);
        break;
      }
    }
    clearTimeout (t.timer);
    t.timer = setTimeout (t.tick, 120000);
  },

  e_ajaxDone : function (rslt){
    var t = CollectGold;
  },

  ajaxCollectGold : function (city, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
    params.cid = city.id;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/levyGold.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (notify)
          notify (rslt);
      },
      onFailure: function (rslt) {
        if (notify)
          notify (rslt);
      }
    });
  },
}

var gmtClock = {
  span : null,
  init : function (){
    var t = gmtClock;
    t.setEnable (Options.gmtClock);
  },
  setEnable : function (tf){
    var t = gmtClock;
    if (Options.gmtClock){
          t.span = document.createElement ('span');
          t.span.style.fontWeight = 'bold';
          ById('kochead_time').style.display='none';
          ById('kochead_time').parentNode.appendChild (t.span);
    } else {
      if (t.span!=null) t.span.innerHTML = '';
      ById('kochead_time').style.display='';
    }
  },
  everySecond : function (){
    var t = gmtClock;
    var now = new Date();
    now.setTime(now.getTime() + (now.getTimezoneOffset()*60000));
    t.span.innerHTML = ' '+ now.toLocaleFormat('%H:%M:%S') +'';
  },
}

/************************ Refresh Every X minutes ************************/
var RefreshEvery  = {
  timer : null,
  PaintTimer : null,
  NextRefresh : 0,
  box : null,
  target : null,

  init : function (){
    var t = RefreshEvery;
	t.creatediv();
	if (Options.pbEveryMins < 15)
        Options.pbEveryMins = 15;
    RefreshEvery.setEnable (Options.pbEveryEnable);
  },

  creatediv : function(){
    var t = RefreshEvery;
	t.target = ById('comm_tabs');
	if(t.target == null){
		setTimeout(t.creatediv, 1000);
		return;
	}
	t.box = document.createElement('div');
	t.target.appendChild(t.box);
  },

  setEnable : function (tf){
    var t = RefreshEvery;
    //clearTimeout (t.timer);
    if (ById("pbEveryEnable")) ById("pbEveryEnable").checked=tf;
    if (tf) {
	  if (ById("boautorefresh")) updatebotbutton("Refresh - ON", 'boautorefresh');
      t.NextRefresh = unixTime() + (Options.pbEveryMins*60);
      //t.timer = setTimeout (t.Paint, 500);
    } else {
		if (ById("boautorefresh")) updatebotbutton("Refresh - OFF", 'boautorefresh');
		//t.timer = null;
		t.NextRefresh = 0;
		t.box.innerHTML = '<div style="float:left;margin :2px;color:#141516;text-shadow: 1px 1px 1px #AAA;font-variant:small-caps;font-weight:bold;">&nbsp;&nbsp;&nbsp;&nbsp;'+ getMyAlliance()[1] + ' <span class="boldRed">(</span>' + getServerId() +'<span class="boldRed">)</span></div>';
	}
  },
  doit : function (){
    reloadKOC();
  },
  setTimer : function (){
    var t = RefreshEvery;
    //clearTimeout (t.timer);
    if (Options.pbEveryMins < 15) Options.pbEveryMins = 15;
    RefreshEvery.setEnable (Options.pbEveryEnable);
  },

  Paint : function(){
     var t = RefreshEvery;
	 if (!Options.pbEveryEnable) return;
     var now = unixTime();
     var text = '';
     var Left = parseInt(t.NextRefresh - now);
     if ( Left < 0){
		Left = 0;
		t.doit();
	 }
    if ( Left < 60) text += '<div style="float:left;margin :2px;color:#141516;text-shadow: 1px 1px 1px #AAA;font-variant:small-caps;font-weight:bold;">&nbsp;&nbsp;&nbsp;&nbsp;'+ getMyAlliance()[1].substr(0,12) + ' (<span class="boldRed">' + getServerId() +'</span>) - <span id=BOTaref>'+lang.General.now+'</span> '+lang.General.dans+' <FONT color=red><span id=BOTaTim>'+ timestr(Left) +'</span></font></div> </div>';
	else text += '<div style="float:left;margin :2px;color:#141516;text-shadow: 1px 1px 1px #AAA;font-variant:small-caps;font-weight:bold;">&nbsp;&nbsp;&nbsp;&nbsp;'+ getMyAlliance()[1].substr(0,12) + ' (<span class="boldRed">' + getServerId() +'</span>) - <span id=BOTaref>'+lang.General.now+'</span> '+lang.General.dans+' <span id=BOTaTim>'+ timestr(Left) +'</span></div> </div>';
     t.box.innerHTML = text;
     ById('BOTaref').addEventListener ('click', t.doit, false);
     ById('BOTaTim').addEventListener ('click', function() { t.setEnable(true); }, false);
     //t.timer = setTimeout (t.Paint, 5000);
  },
}

var FairieKiller  = {
  saveFunc : null,
  init : function (tf){
    FairieKiller.saveFunc = uW.Modal.showModalUEP;
    FairieKiller.setEnable (tf);
  },
  setEnable : function (tf){
    if (tf)
      uW.Modal.showModalUEP = eval ('function FairieKiller (a,b,c) {logit("Blocked Faire popup");}');
    else
      uW.Modal.showModalUEP = FairieKiller.saveFunc;
  },
}


function KOCnotFound(secs){
  var div;
  var countdownTimer = null;
  var endSecs = (new Date().getTime()/1000) + secs;
  div = document.createElement('div');
  div.innerHTML = '<DIV style="font-size:18px; background-color:#a00; color:#fff"><CENTER><BR>'+lang.General.kocnotfound+'<BR>\
      Actualisation dans <SPAN id=pbwdsecs></span><BR><INPUT id=pbwdcan type=submit value="'+lang.General.cancelact+'"><BR><BR></div>';
  document.body.insertBefore (div, document.body.firstChild);
  ById('pbwdcan').addEventListener('click', cancel, false);
  countdownTimer = setInterval (countdown, 1000);
  function countdown (){
	  if(ById("mod_maparea")) {
        clearInterval (countdownTimer);
        document.body.removeChild (div);
        return;
	  }
	  if(ById("kocmain")){
		  if(ById("kocmain").style.display!="none"){
			  clearInterval (countdownTimer);
			          document.body.removeChild (div);
        return;
		  }}

    var secsLeft = endSecs - (new Date().getTime()/1000);
    ById('pbwdsecs').innerHTML = timestr(secsLeft);
    if (secsLeft < 0)
      reloadKOC();

  }
  function cancel (){
    clearInterval (countdownTimer);
    document.body.removeChild (div);
  }
}

var WideScreen = {
  chatIsRight : false,
  useWideMap : false,
  rail : null,
  init : function (){
    t = WideScreen;
      t.rail = searchDOM (ById('mod_maparea'), 'node.className=="maparea_rrail"', 10);
      GM_addStyle ('.modalCurtain {width:760px !important} .mod_comm_mmb{z-index:0 !important}');
      try {
        ById('progressBar').parentNode.removeChild(ById('progressBar'));
        ById('crossPromoBarContainer').parentNode.removeChild(ById('crossPromoBarContainer'));
         if (ById("dealSpotSwfStub"))      ById("dealSpotSwfStub").parentNode.removeChild(ById("dealSpotSwfStub"));
      } catch (e) {
      }
  },
  setChatOnRight : function (tf){
      t = WideScreen;
      if (tf == t.chatIsRight)
        return;
      if (tf){
        var chat = ById('kocmain_bottom').childNodes[1];
        if (!chat || chat.className!='mod_comm')
          setTimeout (function (){t.setChatOnRight(tf)}, 1000);
        chat.style.top = '-570px';
        chat.style.left = '760px';
        chat.style.height = '720px';
        chat.style.background = 'url("'+ CHAT_BG_IMAGE_BAK +'")';
      ById('mod_comm_list1').style.height =  '580px';
      ById('mod_comm_list2').style.height = '580px';
      } else {
        var chat = ById('kocmain_bottom').childNodes[1];
        chat.style.top = '0px';
        chat.style.left = '0px';
        chat.style.height = '';
        chat.style.background = '';
        ById('mod_comm_list1').style.height = '287px';
        ById('mod_comm_list2').style.height = '287px';
      }
      t.chatIsRight = tf;
  },
  setChatOnLeft : function (tf){
    t = WideScreen;
    if (tf == t.chatIsRight)
      return;
    if (tf){

		if (ById("main_engagement_tabs")) ById("main_engagement_tabs").style.left = '360px';
		 var chat = ById('kochead');
		if (!chat)
	          setTimeout (function (){t.setChatOnLeft(tf)}, 1000);

      chat.style.position = 'relative';
      chat.style.left = '360px';
      var chat = ById('kocmain');
	  if (!chat)
	          setTimeout (function (){t.setChatOnLeft(tf)}, 1000);
      chat.style.left = '360px';

      var chat = ById('kocmain_bottom').childNodes[1];
      if (!chat || chat.className!='mod_comm')
        setTimeout (function (){t.setChatOnLeft(tf)}, 1000);
      chat.style.top = '-570px';
      chat.style.left = '-360px';
      chat.style.height = ((Options.HauteurBoite-700) + 760) +'px';
		chat.style.background = 'url("'+ CHAT_BG_IMAGE +'") no-repeat';

      ById('mod_comm_list1').style.height = ((Options.HauteurBoite-700) + 620) +'px';
      ById('mod_comm_list2').style.height = ((Options.HauteurBoite-700) + 620) +'px';
      ById('mod_comm_list1').style.backgroundColor=Colors.ChatGlo;
      ById('mod_comm_list2').style.backgroundColor="#feffe3";
      ById('mod_comm_list1').style.margin="0px";
      ById('mod_comm_list2').style.margin="0px";
      ById('mod_comm_list1').style.width="358px";
      ById('mod_comm_list2').style.width="358px";
    } else {
      var chat = ById('kocmain_bottom').childNodes[1];
      chat.style.top = '0px';
      chat.style.left = '0px';
      chat.style.height = '';
      chat.style.background = '';
      ById('mod_comm_list1').style.height = '287px';
      ById('mod_comm_list2').style.height = '287px';
    }
    t.chatIsRight = tf;
  },

  useWideMap : function (tf) {
  	t = WideScreen;
  	if (tf == t.useWideMap)
  		return;
  	if (tf){
      t.rail.style.display = 'none';
      ById('mapwindow').style.height = "436px";
      ById('mapwindow').style.width = "1220px";
      ById('mapwindow').style.zIndex = "50";
  	} else {
      t.rail.style.display = 'block';
      ById('mapwindow').style.height = "439px";
      ById('mapwindow').style.width = "760px";
      ById('mapwindow').style.zIndex = "";
  	}
  },
}

function DoUnsafeWindow(func, execute_by_embed) {
	if(this.isChrome || execute_by_embed) {
		var scr=document.createElement('script');
		scr.innerHTML=func;
		document.body.appendChild(scr);
	} else {
		try {
			eval("unsafeWindow."+func);
		} catch (error) {
			logit("A javascript error has occurred when executing a function via DoUnsafeWindow. Error description: "+error.description);
		}
	}
}
function GetDisplayName(){
	var DisplayName = ById('topnavDisplayName');
	if(DisplayName){
		DisplayName = DisplayName.innerHTML;
	}else{
		DisplayName = null;
	}
	return DisplayName;
}
var ChatPane = {
  timer:null,
  init : function(){
    var t = ChatPane;
  },
  HandleChatPane : function() {
	var DisplayName = GetDisplayName();
	var AllianceChatBox=ById('mod_comm_list2');
	var GlobalChatBox=ById('mod_comm_list1');
	if(AllianceChatBox){
		var chatPosts = document.evaluate(".//div[contains(@class,'chatwrap')]", AllianceChatBox, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null );
		if(chatPosts){
			for (var i = 0; i < chatPosts.snapshotLength; i++) {
				thisPost = chatPosts.snapshotItem(i);
				if(Options.HelpRequest){

					var postAuthor = document.evaluate('.//*[contains(@class,"nm")]', thisPost, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null );
					if(postAuthor.snapshotItem(0)){
						var postAuthorName = postAuthor.snapshotItem(0).innerHTML;

						if(postAuthorName != DisplayName){

							var helpAllianceLinks=document.evaluate(".//a[contains(@onclick,'claimAllianceChatHelp')]", thisPost, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null );
							if(helpAllianceLinks){
								for (var j = 0; j < helpAllianceLinks.snapshotLength; j++) {
									thisLink = helpAllianceLinks.snapshotItem(j);
									var alreadyClicked = thisLink.getAttribute("clicked");
									if(!alreadyClicked){
										thisLink.setAttribute('clicked', 'true');
										var myregexp = /(claimAllianceChatHelp\(.*\);)/;
										var match = myregexp.exec(thisLink.getAttribute("onclick"));

										if (match != null) {
											onclickCode = match[0];
											if(true){
												DoUnsafeWindow(onclickCode);
											}
										}
									}
								}
							}
						}
					}
				}
				if(Options.ChatRules){
				 var myregexp1 = /gles du Chat/i;
				 var myregexp2 = /Chat Rules/i;
				 if (thisPost.innerHTML.match(myregexp1) || thisPost.innerHTML.match(myregexp2)) {
				   thisPost.parentNode.removeChild(thisPost);
				 }
				}
				if(Options.DeleteRequest){
					var helpAllianceLinks=document.evaluate(".//a[contains(@onclick,'claimAllianceChatHelp')]", thisPost, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null );
					if(helpAllianceLinks){
						for (var j = 0; j < helpAllianceLinks.snapshotLength; j++) {
							thisLink = helpAllianceLinks.snapshotItem(j);
							thisLink.parentNode.parentNode.parentNode.parentNode.parentNode.removeChild(thisLink.parentNode.parentNode.parentNode.parentNode);
						}
					}
					var myregexp1 = /Tu es(.*?)#/i;
					var myregexp2 = /Le projet de /i;
					var myregexp3 = /n\'a pas besoin d\'aide./i;
					var myregexp4 = /le maximum d\'aide/i;
					var myregexp5 = /ce projet avec/i;
					var myregerror = /Une erreur inattendue s/i;
					if (thisPost.innerHTML.match(myregerror) || thisPost.innerHTML.match(myregexp1) || thisPost.innerHTML.match(myregexp2) || thisPost.innerHTML.match(myregexp3) || thisPost.innerHTML.match(myregexp4) || thisPost.innerHTML.match(myregexp5)) {
						thisPost.parentNode.removeChild(thisPost);
					}
					var myregexp1 = /You are #/i;
					var myregexp2 = /\'s Kingdom does not need help\./i;
					var myregexp3 = /\'s project has already been completed\./i;
					var myregexp4 = /\'s project has received the maximum amount of help\./i;
					var myregexp5 = /You already helped with (.*?)\'s project\./i;
					if (thisPost.innerHTML.match(myregexp1) || thisPost.innerHTML.match(myregexp2) || thisPost.innerHTML.match(myregexp3) || thisPost.innerHTML.match(myregexp4) || thisPost.innerHTML.match(myregexp5)) {
						thisPost.parentNode.removeChild(thisPost);
					}
					var myregexp1 = /Sei il nr./i;
					var myregexp2 = /dato il tuo aiuto al progetto di/i;
					var myregexp3 = /stato completato/i;
					var myregexp4 = /aiuto massimo possibile/i;
					if (thisPost.innerHTML.match(myregexp1) || thisPost.innerHTML.match(myregexp2) || thisPost.innerHTML.match(myregexp3) || thisPost.innerHTML.match(myregexp4)) {
						thisPost.parentNode.removeChild(thisPost);
					}
				}
			}
		}
	}
	if(Options.DeleteRequest) {
			var gchatPosts = document.evaluate(".//div[contains(@class,'chatwrap')]", GlobalChatBox, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null );
				if(gchatPosts)
					for (var i = 0; i < gchatPosts.snapshotLength; i++) {
						var gthisPost = gchatPosts.snapshotItem(i);
	                    var helpAllianceLinks=document.evaluate(".//a[contains(@onclick,'claimAllianceChatHelp')]", gthisPost, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null );
	                    if(helpAllianceLinks){
	                        for (var j = 0; j < helpAllianceLinks.snapshotLength; j++) {
	                            thisLink = helpAllianceLinks.snapshotItem(j);
	                            thisLink.parentNode.parentNode.parentNode.parentNode.parentNode.removeChild(thisLink.parentNode.parentNode.parentNode.parentNode);
	                        }
	                    }
					}
	}
  },

}

String.prototype.StripQuotes = function() {
	return this.replace(/"/g,'');
}

function entier_1dec (nombre){
	if (parseInt(nombre*10)!=0){
		return parseInt(nombre*10)/10;
	} else {
	return nombre;
	}
}

function DrawLevelIcons() {
	var maptileRe = /modal_maptile.([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)/;
	var mapwindow=ById('mapwindow');
	if(!mapwindow) return;
	var levelIcons=ById('levelIcons');
	if(levelIcons) return;

	var ss=document.evaluate(".//a[contains(@class,'slot')]",mapwindow,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);
	var lvRe=/_([0-9]+)/;
	var idDone=false;
	for(var s=0; s<ss.snapshotLength; s++) {
		var a=ss.snapshotItem(s);
		var onclick=a.getAttribute('id');
		var owner='';
		var tileinfo = uW.g_mapObject.model.getTileActions(onclick)["tileClick"];
		if(tileinfo) {
				var might = parseInt(tileinfo.might);
			 	var alliance = parseIntNan(tileinfo.allianceId);
				var dip = getDiplomacy(alliance);
		owner = tileinfo.username;
	}
				var sp=a.getElementsByTagName('span');
				if(sp.length==0) continue;

				if(!idDone) { a.id='levelIcons'; idDone=true; }
				sp[0].style.color='#cc0';


     if (alliance == 'null' && tileinfo.type=="city") sp[0].style.color='#33CCFF';
     if (dip == 'hostile' && tileinfo.type=="city") sp[0].style.color='#FF0000';
	if (tileinfo.type!="city" && tileinfo.tileuserid!="null") sp[0].style.color='#FF9900';
		if (tileinfo.type!="city" && tileinfo.tileuserid=="null") sp[0].style.color='#CC0033';
 if (tileinfo.username!="null")
		sp[0].innerHTML = ''+owner+'<br /><b>'+tileinfo.level +'</b><br />'+lang.map.might+''+UniteMap(might); //+'<br />Alliance:'+tileinfo.alliance
	 	else
		sp[0].innerHTML = tileinfo.level;

	}

}
function MakeBlocks(getX,getY,radius){
	var blocks = [];
	var xx=0;
	var yy=0;
	for (x=(getX-radius);x<=(getX+radius);x+=5) {
	   for (y=(getY-radius);y<=(getY+radius);y+=5) {
			xx=x;
			yy=y;
			if (x>750) xx-=750;
			if (y>750) yy-=750;
			if (x<0) xx+=750;
			if (y<0) yy+=750;
			blocks.push ("bl_" + xx + "_bt_" + yy);
		}
	}
	return blocks;
}

function MakeProvinceBlocks(getX,getY){
	var blocks = [];
	var xx=0;
	var yy=0;
	for (x=getX;x<=(getX+30);x+=5) {
	   for (y=getY;y<=(getY+30);y+=5) {
			xx=x;
			yy=y;
			blocks.push ("bl_" + xx + "_bt_" + yy);
		}
	}
	return blocks;
}
function CdispCityPicker (id, span, dispName, notify, selbut){
  function CcityButHandler (t){
    var that = t;
    this.clickedCityBut = clickedCityBut;
    function clickedCityBut (e){
      if (that.selected != null)
        that.selected.className = "castleBut castleButNon";
      that.city = Cities.cities[e.target.id.substr(that.prefixLen)];
      if (that.dispName)
        ById(that.id+'cname').innerHTML = that.city.name;
      e.target.className = "castleBut castleButSel";
      that.selected = e.target;
      if (that.coordBoxX){
        that.coordBoxX.value = that.city.x;
        that.coordBoxY.value = that.city.y;
        that.coordBoxX.style.backgroundColor = '#ffffff';
        that.coordBoxY.style.backgroundColor = '#ffffff';
      }
      if (that.notify != null)
        that.notify(that.city, that.city.x, that.city.y);
    }
  }

  function selectBut (idx){
    ById(this.id+'_'+idx).click();
  }

  function bindToXYboxes (eX, eY){
    function CboxHandler (t){
      var that = t;
      this.eventChange = eventChange;
      if (that.city){
        eX.value = that.city.x;
        eY.value = that.city.y;
      }
      function eventChange (){
			var xValue=that.coordBoxX.value.trim();
			var xI=/^\s*([0-9]+)[\s,]+([0-9]+)/.exec(xValue);
			if(xI) {
				that.coordBoxX.value=xI[1]
				that.coordBoxY.value=xI[2]
			}
        var x = parseInt(that.coordBoxX.value, 10);
        var y = parseInt(that.coordBoxY.value, 10);
        if (isNaN(x) || x<0 || x>750){
          that.coordBoxX.style.backgroundColor = '#ff8888';
          return;
        }
        if (isNaN(y) || y<0 || y>750){
          that.coordBoxY.style.backgroundColor = '#ff8888';
          return;
        }
        that.coordBoxX.style.backgroundColor = '#ffffff';
        that.coordBoxY.style.backgroundColor = '#ffffff';
        if (that.notify != null)
          that.notify (null, x, y);
      }
    }
    this.coordBoxX = eX;
    this.coordBoxY = eY;
    var bh = new CboxHandler(this);
    eX.size=2;
    eX.maxLength=10;
    eY.size=2;
    eY.maxLength=3;
    eX.addEventListener('change', bh.eventChange, false);
    eY.addEventListener('change', bh.eventChange, false);
  }

  this.selectBut = selectBut;
  this.bindToXYboxes = bindToXYboxes;
  this.coordBoxX = null;
  this.coordBoxY = null;
  this.id = id;
  this.dispName = dispName;
  this.prefixLen = id.length+1;
  this.notify = notify;
  this.selected = null;
  this.city = null;
  var m = '';
  for (var i=0; i<Cities.cities.length; i++)
    m += '<INPUT class="castleBut castleButNon" id="'+ id +'_'+ i +'" value="'+ (i+1) +'" type=submit \>';
  if (dispName)
    m += ' &nbsp; <SPAN style="display:inline-block; width:85px; font-weight:bold;" id='+ id +'cname' +'></span>';
  span.innerHTML = m;
  var handler = new CcityButHandler(this);
  for (var i=0; i<Cities.cities.length; i++)
    ById (id+'_'+i).addEventListener('click', handler.clickedCityBut, false);
  if (selbut != null)
    this.selectBut(selbut);
}

var pop = null;

function dialogRetry (errMsg, seconds, onRetry, onCancel, errCode){
  seconds = parseInt(seconds);
  if (pop == null) {
   pop = new CPopup ('BOptretry', 0, 0, 400,300, true);

     pop.getTopDiv().innerHTML = '<CENTER><b>Boite &agrave; outils</b></center>';
     pop.getMainDiv().innerHTML = '<CENTER><BR><FONT COLOR=#550000><B>'+lang.General.dialogRetry+'</b></font><BR><BR><DIV id=BOparetryErrMsg></div>\
         <BR><BR><B>'+lang.General.Retry+'<SPAN id=BOparetrySeconds></b></span> '+lang.General.secs+' ...<BR><INPUT id=BOparetryCancel type=submit value="'+uW.g_js_strings.commonstr.cancel+'" \>';
     ById('BOparetryCancel').addEventListener ('click', doCancel, false);

  }
  pop.show(true);
  pop.centerMe(mainPop.getMainDiv());
  if(errCode && uW.g_js_strings.errorcode['err_'+errCode])
		if (ById('BOparetryErrMsg')) ById('BOparetryErrMsg').innerHTML = uW.g_js_strings.errorcode['err_'+errCode];
   else
	ById('BOparetryErrMsg').innerHTML = errMsg;
  if (ById('BOparetrySeconds')) ById('BOparetrySeconds').innerHTML = seconds;
  var rTimer = setTimeout (doRetry, seconds*1000);
  countdown ();

  function countdown (){
     if (ById('BOparetrySeconds')) ById('BOparetrySeconds').innerHTML = seconds--;
    if (seconds > 0)
      cdTimer = setTimeout (countdown, 1000);
  }
  function doCancel(){
    clearTimeout (rTimer);
    clearTimeout (cdTimer);
    pop.destroy();
    onCancel ();
  }
  function doRetry (){
    clearTimeout (rTimer);
    clearTimeout (cdTimer);
    pop.show(false);
    onRetry();
  }
}

function GM_AjaxGet (url, args, notify, label){
  GM_xmlhttpRequest({
    method: "get",
    url: addUrlArgs(url, args),
    onload: function (rslt) {
      notify (rslt.responseText);
    },
    onerror: function () {
      notify (null);
    },
  });
}

var bypassMulti = {
  MultiBrowserBypass : null,

  init : function (){
      t = bypassMulti;
      //t.MultiBrowserBypass = new CalterUwFunc ('update_seed_ajax', [[/if\s*\(typeof\s*isCancelTraining/im,'var l_lastCallTime = 0; var reload_requests = 0; var l_callIntervalMin = 10; if(typeof isCancelTraining'],[/if\s*\(rslt\.error_code\s*==\s*60\)/im,'return; if(rslt.error_code == 60)']]);
      t.MultiBrowserBypass = new CalterUwFunc ('update_seed_ajax', [[/if\s*\(typeof\s*isCancelTraining/im,'var l_lastCallTime = cm.l_lastCallTime; var reload_requests = cm.reload_requests; var l_callIntervalMin = cm.l_callIntervalMin; if(typeof isCancelTraining'],[/if\s*\(rslt\.error_code\s*==\s*60\)/im,'return; if(rslt.error_code == 60)']]);
      t.MultiBrowserBypass.setEnable(Options.MultiBrowser);
  },

  setEnable : function (tf){
	var t = bypassMulti;
	t.MultiBrowserBypass.setEnable (tf);
  },

  isAvailable : function (){
	var t = bypassMulti;
	return t.MultiBrowserBypass.isAvailable();
  },

}


function GM_AjaxPost (url, args, notify, label){
  GM_xmlhttpRequest({
    method: "post",
    url: url,
    data: implodeUrlArgs(args),
    headers: { "Content-Type": "application/x-www-form-urlencoded", 'X-Requested-With': 'XMLHttpRequest', 'X-Prototype-Version': '1.6.1',
               'Accept': 'text/javascript, text/html, application/xml, text/xml, */*' },
    onload: function (rslt) {
      notify (rslt.responseText);
    },
    onerror: function () {
      notify (null);
    },
  });
}
function AjaxRequest (url, opts){
  var headers = {
    'X-Requested-With': 'XMLHttpRequest',
    'X-Prototype-Version': '1.6.1',
    'Accept': 'text/javascript, text/html, application/xml, text/xml, */*'
  };
  var ajax = null;

  if (window.XMLHttpRequest)
    ajax=new XMLHttpRequest();
  else
    ajax=new ActiveXObject("Microsoft.XMLHTTP");

  if (opts.method==null || opts.method=='')
    method = 'GET';
  else
    method = opts.method.toUpperCase();

  if (method == 'POST'){
    headers['Content-type'] = 'application/x-www-form-urlencoded; charset=UTF-8';
  } else if (method == 'GET'){
    addUrlArgs (url, opts.parameters);
  }

  ajax.onreadystatechange = function(){
    if (ajax.readyState==4) {
      if (ajax.status >= 200 && ajax.status < 305)
        if (opts.onSuccess) opts.onSuccess(ajax);
      else
        if (opts.onFailure) opts.onFailure(ajax);
    } else {
      if (opts.onChange) opts.onChange (ajax);
    }
  }
  ajax.open(method, url, true);
  for (var k in headers)
    ajax.setRequestHeader (k, headers[k]);
  if (matTypeof(opts.requestHeaders)=='object')
    for (var k in opts.requestHeaders)
      ajax.setRequestHeader (k, opts.requestHeaders[k]);

  if (method == 'POST'){
    var a = [];
    for (k in opts.parameters){
	  if(matTypeof(opts.parameters[k]) == 'object')
		for(var h in opts.parameters[k])
			a.push (k+'['+h+'] ='+ opts.parameters[k][h] );
	  else
        a.push (k +'='+ opts.parameters[k] );
	}
    ajax.send (a.join ('&'));
  } else               {
    ajax.send();
  }
}
function getOffset( el ) {
    var _x = 0;
    var _y = 0;
    while( el && !isNaN( el.offsetLeft ) && !isNaN( el.offsetTop ) ) {
        _x += el.offsetLeft - el.scrollLeft;
        _y += el.offsetTop - el.scrollTop;
        el = el.offsetParent;
    }
    return { top: _y, left: _x };
}

function implodeUrlArgs (obj){
  var a = [];
  for (var k in obj)
    a.push (k +'='+ encodeURI(obj[k]) );
  return a.join ('&');
}
function addUrlArgs (url, args){
  if (!args)
    return url;
  if (url.indexOf('?') < 0)
    url += '?';
  else if (url.substr(url.length-1) != '&')
    url += '&';
  if (matTypeof(args == 'object'))
    return url + implodeUrlArgs (args);
  return url + args;
}
function AjaxRequest2 (url, opts){
    var headers = {
        'X-Requested-With': 'XMLHttpRequest',
        'X-Prototype-Version': '1.6.1',
        'Accept': 'text/javascript, text/html, application/xml, text/xml, */*'
    };
    var ajax = null;
    if (window.XMLHttpRequest)
      ajax=new XMLHttpRequest();
    else
      ajax=new ActiveXObject("Microsoft.XMLHTTP");
    if (opts.method==null || opts.method=='')
      method = 'GET';
    else
      method = opts.method.toUpperCase();
    if (method == 'POST'){
        headers['Content-type'] = 'application/x-www-form-urlencoded; charset=UTF-8';
    } else if (method == 'GET'){
        addUrlArgs (url, opts.parameters);
    }
    ajax.onreadystatechange = function(){
        if (ajax.readyState==4) {
            if (ajax.status >= 200 && ajax.status < 305)
            if (opts.onSuccess) opts.onSuccess(ajax);
            else
                if (opts.onFailure) opts.onFailure(ajax);
            } else {
                if (opts.onChange) opts.onChange (ajax);
            }
    }
    ajax.open(method, url, true);
    for (var k in headers)
      ajax.setRequestHeader (k, headers[k]);
     if (matTypeof(opts.requestHeaders)=='object')
          for (var k in opts.requestHeaders)
            ajax.setRequestHeader (k, opts.requestHeaders[k]);
    if (method == 'POST'){
        var a = [];
        for (k in opts.parameters){
              if(matTypeof(opts.parameters[k]) == 'object'){
                  for(var h in opts.parameters[k]){
                      if(matTypeof(opts.parameters[k][h]) == 'object'){
                          for(var i in opts.parameters[k][h]){
                              if(matTypeof(opts.parameters[k][h][i]) == 'object'){
                              for(var j in opts.parameters[k][h][i]){
                                  a.push (k+'['+h+']['+i+']['+j+'] ='+ opts.parameters[k][h][i][j] );
                              }
                              } else
                              	a.push (k+'['+h+']['+i+']'+' ='+ opts.parameters[k][h][i]);
                          }
                      } else
                      a.push (k+'['+h+'] ='+ opts.parameters[k][h] );
                  }
              } else
              a.push (k +'='+ opts.parameters[k] );
        }
        ajax.send (a.join ('&'));
    } else {
        ajax.send();
    }
}
function MyAjaxRequest (url, o, noRetry){
  var opts = uW.Object.clone(o);
  var wasSuccess = o.onSuccess;
  var wasFailure = o.onFailure;
  var retry = 0;
  var delay = 3;
  var show=true;
  var silentTimer;
  var noRetry = noRetry===true?true:false;
  opts.onSuccess = mySuccess;
  opts.onFailure = myFailure;
  new AjaxRequest(url, opts);
  return;

  function myRetry(){
    ++retry;
    if (retry>5) {
       actionLog(lang.General.error, "<font color=res>"+lang.General.myRetry+"</font>");
       return false;
       }
    new AjaxRequest(url, opts);

    delay = delay * 1.25;
  }
  function myFailure(){
    var o = {};
    o.ok = false;
    o.errorMsg = "AJAX Communication Failure";
    wasFailure (o);
  }
  function mySuccess (msg){
    var rslt;
   try {
    rslt = JSON2.parse(msg.responseText);
   } catch(e) {

    if (retry<2) {
      rslt = {"ok":false,"error_code":9,"errorMsg":"Failed due to invalid json"}
    } else {
      rslt = {"ok":true,"error_code":9,"data":[]};
    }

    }
    var x;
    if (window.EmulateAjaxError){
      rslt.ok = false;
      rslt.error_code=8;
    }
    if (rslt.ok){
      if (rslt.updateSeed)
        uW.update_seed(rslt.updateSeed);
      wasSuccess (rslt);
      return;
    }

    rslt.errorMsg = uW.printLocalError((rslt.error_code || null), (rslt.msg || null), (rslt.feedback || null));

    if (!noRetry && (rslt.error_code==0 ||rslt.error_code==8 || rslt.error_code==1 || rslt.error_code==3)){
      actionLog(lang.General.error, "<font color=res>"+ msg.responseText +"</font>");
      if (matTypeof(rslt.errorMsg) == 'object') {
	        dialogRetry (inspect(rslt.errorMsg), delay, function(){myRetry()}, function(){wasSuccess (rslt)}, rslt.error_code);
	  		} else {
	  			dialogRetry (rslt.errorMsg, delay, function(){myRetry()}, function(){wasSuccess (rslt)}, rslt.error_code);
		};

    } else if (!noRetry && rslt.error_code==9) {
      silentTimer = setTimeout(silentRetry, delay*100);
    } else {
      wasSuccess (rslt);
    }
  }
  function silentRetry() {
   	    clearTimeout(silentTimer);
   	    myRetry();
   }
}

function getDiplomacy (aid) {
  if (Seed.allianceDiplomacies == null)
    return 'neutre';
  if (Seed.allianceDiplomacies.friendly && Seed.allianceDiplomacies.friendly['a'+aid] != null)
    return 'amicale';
  if (Seed.allianceDiplomacies.hostile && Seed.allianceDiplomacies.hostile['a'+aid] != null)
    return 'hostile';
  if (aid == Seed.allianceDiplomacies.allianceId)
    return 'allie';
  return 'neutre';
};

function getMyAlliance (){
  if (Seed.allianceDiplomacies==null || Seed.allianceDiplomacies.allianceName==null)
    return [0, 'None'];
  else
    return [Seed.allianceDiplomacies.allianceId, Seed.allianceDiplomacies.allianceName];
}
function UniteKMG(nb) {
          if (Math.abs(nb)>1000000000000)
    	    val="<span title='"+addCommas(nb)+"'>" + (nb/1000000000000).toFixed(2) +" T</span>";
    	  else if (Math.abs(nb)>1000000000)
    	    val="<span title='"+addCommas(nb)+"'>" + (nb/1000000000).toFixed(2) +" G</span>";
    	  else if (Math.abs(nb)>1000000)
    	   val="<span title='"+addCommas(nb)+"'>" + (nb/1000000).toFixed(2) +" M</span>";
     	  else if (nb==0)
    	   val="0";
    	  else
	   val=addCommas(nb);

     return val;
}
function UniteMap(nb) {
          if (Math.abs(nb)>1000000000)
    	    val=(nb/1000000000).toFixed(2) +"G";
    	  else if (Math.abs(nb)>1000000)
    	   val=(nb/1000000).toFixed(2) +"M";
     	  else if (nb==0)
    	   val="0";
    	  else
	   val=addCommas(nb);

     return val;
}
function getMarchInfo (){
  var ret = {};
  ret.marchUnits = [];
  ret.returnUnits = [];
  ret.resources = [];
  var r=0;
  for (y in uW.unitcost) {
	r++;
    ret.marchUnits[r] = 0;
    ret.returnUnits[r] = 0;
  }
  for (i=0; i<6; i++){
    ret.resources[i] = 0;
  }
  var now = unixTime();
  for(i=0; i<Cities.numCities; i++) {   // each city
    cityID = 'city'+ Cities.cities[i].id;
    for (k in Seed.queue_atkp[cityID]){   // each march
      march = Seed.queue_atkp[cityID][k];
      if (typeof (march) == 'object'){
         var ii=0;
		 for (y in uW.unitcost) {
		  ii++;
          ret.marchUnits[ii] += parseInt (march['unit'+ ii +'Count']);
          ret.returnUnits[ii] += parseInt (march['unit'+ ii +'Return']);
        }
        for (ii=1; ii<5; ii++){
          ret.resources[ii] += parseInt (march['resource'+ ii]);
        }
         ret.resources[0] += parseInt (march['gold']);
      }
    }
  }
  return ret;
}
function getMarchInfoBOT(cityID){
  var ret = {};
  ret.marchUnits = [];
  ret.returnUnits = [];
  ret.resources = [];
  var r=0;
  for (y in uW.unitcost) {
	r++;
    ret.marchUnits[r] = 0;
    ret.returnUnits[r] = 0;
  }
  for (i=0; i<6; i++){
    ret.resources[i] = 0;
  }

  for (k in Seed.queue_atkp[cityID]){
      march = Seed.queue_atkp[cityID][k];
	  if(march.marchType != 5){
		  if (typeof (march) == 'object'){
			 var ii=0;
			 for (y in uW.unitcost) {
			   ii++;
			  ret.marchUnits[ii] += parseInt (march['unit'+ ii +'Count']);
			  ret.returnUnits[ii] += parseInt (march['unit'+ ii +'Return']);
			}
			for (ii=1; ii<5; ii++){
			  ret.resources[ii] += parseInt (march['resource'+ ii]);
			}
			  ret.resources[0] += parseInt (march['gold']);
		  }
	  }
    }
  return ret;
}
var fortNamesShort = { 53: "Arbaletes",  55: "Trebuchet",  60: "Pieges",  61: "Chausse-trape",  62: "Palissade",}
function getCityBuilding (cityId, buildingId, druid){
  var b = Seed.buildings['city'+cityId];
  var ret = {count:0, maxLevel:0,pos:0,id:0};
  for( var k in b){
  		if(b[k] && b[k][0] == buildingId){
  	 	 	++ret.count;
  	 	 	ret.pos=parseInt(b[k][2]);
			ret.id=parseInt(b[k][3]);
	        ret.cityId=cityId;
  	 	 	if(parseInt(b[k][1]) > ret.maxLevel)
  		ret.maxLevel = parseInt(b[k][1]);
	}
  }
  return ret;
}
function logit (msg){
  var serverID = getServerId();
  var now = new Date();
  GM_log (serverID +' @ '+ now.toTimeString().substring (0,8) +'.' + now.getMilliseconds() +': '+  msg);
}

function saveCrestData (){
  var serverID = getServerId();
  setTimeout (function (){GM_setValue ('CrestData_' + Seed.player.name + '_' +serverID, JSON2.stringify(CrestData));}, 0);
}
function resetCrestData (){
  var serverID = getServerId();
  CrestData=[];
  setTimeout (function (){GM_setValue ('CrestData_' + Seed.player.name + '_' +serverID, JSON2.stringify(CrestData));}, 0);
}
function readCrestData (){
  var serverID = getServerId();
  s = GM_getValue ('CrestData_' + Seed.player.name + '_' +serverID);
  if (s != null) {
    opts = JSON2.parse (s);
	for (var i = 0; i < opts.length; i++) {
		CrestData[i] = new CrestFunc(opts[i]);
	}
  }
}

function saveUpgradeData (){
    var serverID = getServerId();
    setTimeout (function (){GM_setValue ('UpgradeDataMM2_'+serverID, JSON2.stringify(upgradeData));}, 0);
}

function saveSalvageData (){
    var serverID = getServerId();
    setTimeout (function (){GM_setValue ('SalvageDataMM2_'+serverID, JSON2.stringify(salvageData));}, 0);
}
function readUpgradeData (){
    var serverID = getServerId();
    s = GM_getValue ('UpgradeDataMM2_'+serverID);
    if (s != null){
        opts = JSON2.parse (s);
        for (k in opts){
            if (matTypeof(opts[k]) == 'object')
                for (kk in opts[k])
                    upgradeData[k][kk] = opts[k][kk];
            else
                upgradeData[k] = opts[k];
        }
    }
}

function readSalvageData (){
    var serverID = getServerId();
    s = GM_getValue ('SalvageDataMM2_'+serverID);
    if (s != null){
        opts = JSON2.parse (s);
        for (k in opts){
            if (matTypeof(opts[k]) == 'object')
                for (kk in opts[k])
                    salvageData[k][kk] = opts[k][kk];
            else
                salvageData[k] = opts[k];
        }
    }

    // recreate the objects w/ functions
    for (k in salvageData.ruleSet)
    {
        var r = salvageData.ruleSet[k];
        var rule = new Rule(r.type, r.faction, r.conditions);
        for (j in rule.conditions)
        {
            rule.conditions[j].checkCondition = checkCondition;
        }
        salvageData.ruleSet[k] = rule;
    }
}

function readOptions(){var a=getServerId();s=GM_getValue("BOOptions_"+a);if(s!=null){opts=JSON2.parse(s);for(k in opts)Options[k]=opts[k]}}
function saveOptions(){var a=getServerId();GM_setValue("BOOptions_"+a,JSON2.stringify(Options))}
function saveDashboardOptions (){
  var serverID = getServerId();
  setTimeout (function (){GM_setValue ('DashboardOptions_'+serverID, JSON2.stringify(DashboardOptions));}, 0);
}
function saveColors (){var serverID = getServerId();GM_setValue('Colors', JSON2.stringify(Colors));}
function readColors (){
  var serverID = getServerId();
  s = GM_getValue ('Colors');
  if (s != null){
    opts = JSON2.parse (s);
    for (k in opts)
      Colors[k] = opts[k];
  }
}
function createButton (label){
  var a=document.createElement('a');
  a.className='button20';
  a.innerHTML='<span style="color: #ff6">'+ label +'</span>';
  return a;
}
function createTopButton (label){
  var a=document.createElement('a');
  a.className='button25';
  a.innerHTML='<span style="color: #f66">'+ label +'</span>';
  return a;
}
function createBlinkButton (label){
  var a=document.createElement('a');
  a.className='button20';
  a.innerHTML='<span style="color: #fff"><blink>'+ label +'</blink></span>';
  return a;
}

function AddMainTabLink(text, eventListener, mouseListener) {
  var a = createButton ("KOC BAO");
  a.className='tab';
  a.style.marginRight="20px";
  a.id = 'ptBoite';
  var tabs=ById('main_engagement_tabs');

  if(!tabs) {
    tabs=ById('topnav_msg');
    if (tabs)
      tabs=tabs.parentNode;
  }
  if(tabs) {
   eNew2 = document.createElement('div');
   eNew2.id = 'BOAbout';
   eNew2.style.background='#5b5';
   eNew2.className='tabs_engagement';
   eNew2.style.paddingLeft='25px';
   eNew2.style.whiteSpace='nowrap';
   eNew2.style.width='99%';
   tabs.parentNode.insertBefore (eNew2, tabs);
   eNew2.innerHTML="<a id=BoFlag style='float:right;margin-right:10px;'></a><a id=BoBoite class='tab'  style='float:right;margin-right:20px;'><span style='color:#ff6'>SUPPORT BAO</span></a><span style='float:right;margin-right:20px;margin-top:4px;font-size:16px;text-shadow: 1px 1px 1px #AAA; font-variant:small-caps;'><center><b>Boite &agrave; outils "+Version+" - BeWorld</b></center></span>";

   var e = tabs.parentNode;
    var eNew = null;
    for (var i=0; i<e.childNodes.length; i++){
      var ee = e.childNodes[i];

      if (ee.tagName && ee.tagName=='DIV' && ee.className=='tabs_engagement' &&  ee.id!='main_engagement_tabs' &&  ee.id!='BOAbout'){
        eNew = ee;
        break;
      }
    }
    if (eNew == null){
      eNew = document.createElement('div');
      eNew.className='tabs_engagement';
      eNew.style.background='#5a5';
      eNew.style.paddingLeft='25px';
      tabs.parentNode.insertBefore (eNew, tabs);
      eNew.id = 'gmTabs';
      eNew.style.whiteSpace='nowrap';
      eNew.style.width='99%';
    }
    if (eNew2.firstChild){
      eNew2.insertBefore (a, eNew2.firstChild);
    }else{
      eNew2.appendChild(a);
     }


   ById("BoFlag").innerHTML="<img valign=absmiddle src='"+lang.General.flag+"' title='Support FACEBOOK'>";
  ById("BoFlag").addEventListener('click',function() {
      window.open(lang.General.supporturl);
   }, false);
   ById("BoBoite").addEventListener('click',function() {
      window.open("http://forum.koc-bao.com");
   }, false);
    a.addEventListener('click',eventListener, false);
    if (mouseListener != null)
      a.addEventListener('mousedown',mouseListener, true);


     if (tabs) {
       GM_xmlhttpRequest({method:"GET",url:"https://koc-bao.googlecode.com/svn/trunk/104299.user.js",onload:function(a){var b=/\/\/\s*@version\s+(.+)\s*\n/i.exec(a.responseText);
       var c=Version;
       if(b){

		   if(b[1]>c){
       var eNewMAJ=createBlinkButton ("BAO "+b[1]+" dispo !");
       eNewMAJ.className='tab';
       eNewMAJ.id="BOUpdate";
       eNewMAJ.title=lang.General.BOUpdate;
       eNew2.insertBefore(eNewMAJ,eNew2.firstChild);
       eNewMAJ.addEventListener('click',function() {
               window.open('http://www.koc-bao.com');
       }, false);

       }}},onerror:function(a){}})


      }


    return a;
  }
  return null;
}
function AddMainTabLink2(text, eventListener, mouseListener) {
  var b = createButton (lang.StatLabel);
  b.className='tab';
  b.id = 'ptBoite2';

  var tabs=ById('main_engagement_tabs');
  if(!tabs) {
    tabs=ById('topnav_msg');
    if (tabs)
      tabs=tabs.parentNode;
  }
  if(tabs) {

   var e = tabs.parentNode;
    var eNew = null;
    for (var i=0; i<e.childNodes.length; i++){
      var ee = e.childNodes[i];

      if (ee.tagName && ee.tagName=='DIV' && ee.className=='tabs_engagement' &&  ee.id!='main_engagement_tabs' &&  ee.id!='BOAbout'){
        eNew = ee;
        break;
      }
    }
    if (eNew == null){
      eNew = document.createElement('div');
      eNew.className='tabs_engagement';
      eNew.style.background='#ca5';
      tabs.parentNode.insertBefore (eNew, tabs);
      eNew.id = 'gmTabs';
      eNew.style.whiteSpace='nowrap';
      eNew.style.width='735px';
    }
    if (eNew2.firstChild){
      eNew2.insertBefore (b, eNew2.firstChild);
    }else{
      eNew2.appendChild(b);
     }

    b.addEventListener('click',eventListener, false);
    if (mouseListener != null)
      b.addEventListener('mousedown',mouseListener, true);
    return b;
  }
  return null;
}

uW.PTscout = function (x, y){
  setTimeout (function (){
    ById('mapXCoor').value = x;
    ById('mapYCoor').value = y;
    uW.Modal.hideModalAll();
    uW.reCenterMapWithCoor();
    uW.changeview_map(ById('mod_views_map'));
	uW.modal_attack(3,x,y);
	setTimeout (function (){
	  var scouter = ById('modal_attack_unit_ipt3');
	  scouter.value=1;
	  var evt = document.createEvent("KeyboardEvent");
		  if(evt.initKeyboardEvent) {
				evt.initKeyboardEvent("keyup",true,true,null,false,false,false,false,0x10,0);
		  } else {
				evt.initKeyEvent("keyup",true,true,null,false,false,false,false,0x10,0);
		  }
	  scouter.dispatchEvent(evt);
	  uW.modal_attack_do();
	}, 500);
   }, 0);
};

function makeButton20 (label){
  var a = document.createElement('a');
  a.className = "button20 ptButton20";
  var s = document.createElement('span');
  s.innerHTML = label;
  a.appendChild (s);
  return a;
}

function strButton20 (label, tags){
  if (tags == null)
    tags = '';
  return ('<TABLE class=ptNoPad><TR><TD><A class="button20 ptButton20" '+ tags +'><SPAN>'+ label +'</span></a></td></tr></table>' );
}

function strButton14 (label, tags){
  if (tags == null)
    tags = '';
  return ('<A class="button14 ptButton20" '+ tags +'><SPAN>'+ label +'</span></a>' );
}

function cityStatusString (cs){
  if (cs==4)
    return 'Vacances';
  if (cs==3)
    return 'Paix';
  if (cs==2)
    return 'Protection Debutant';
  return 'Normal';
}

function sendChat (msg){
  ById ("mod_comm_input").value = msg;
  uW.Chat.sendChat ();
}
function doDefTrain (cityId, siege, unitId, num, notify){
  var time = uW.modal_walls_traintime(unitId, num);
  var params = uW.Object.clone(uW.g_ajaxparams);
  params.cid = cityId;
  params.type = unitId;
  params.quant = num;
  params.items = siege;
  new MyAjaxRequest(uW.g_ajaxpath + "ajax/fortify.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
        if (rslt.ok) {
          uW.seed.queue_fort["city" + cityId].push([unitId, num, rslt.initTS, parseInt(rslt.initTS) + time, 0, time, rslt.fortifyId]);
          if (notify != null)
            setTimeout (function (){notify(null);}, 500);
        } else {
          if (notify != null)
            setTimeout (function (){notify(rslt.errorMsg);}, 500);
        }
      },
      onFailure: function (rslt) {
        if (notify != null)
          notify(rslt.errorMsg);
      },
  });
}
function doTrain (cityId, tut, gam, unitId, num, notify){
  var time = uW.modal_barracks_traintime(unitId, num);
  if(tut==36){time=parseInt(time*0.7)}else{if(tut==37){time=parseInt(time*0.5)}else{if(tut==38){time=parseInt(time*0.3)}}}
  var params = uW.Object.clone(uW.g_ajaxparams);
  params.cid = cityId;
  params.type = unitId;
  params.quant = num;
  params.items = tut;
  params.gambleId = gam;
  var profiler=new uW.cm.Profiler("ResponseTime","train.php");
  new MyAjaxRequest(uW.g_ajaxpath + "ajax/train.php" + uW.g_ajaxsuffix, {
    method: "post",
    parameters: params,
    onSuccess: function(rslt) {
	  profiler.stop();
      if (rslt.ok) {
	    var MORE_WITH_LESS_FACTOR = uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().MORE_WITH_LESS, cityId, {
		  					unitid: unitId
		});
       var resourceFactors=[],resourceLost;
       if(gam!=null){
         time=rslt.timeNeeded;
	   }
       for(var i=1;i<5;i++){
        if(rslt.gamble){
         resourceFactors.push(rslt.gamble[i.toString()]);
        }else{
        resourceFactors.push(1);
        }
        resourceLost=Math.ceil(parseInt(uW.unitcost["unt"+unitId][i])* MORE_WITH_LESS_FACTOR)*3600*parseInt(num);resourceLost=resourceLost*resourceFactors[i-1];
        uW.seed.resources["city"+cityId]["rec"+i][0]=parseInt(uW.seed.resources["city"+cityId]["rec"+i][0])-resourceLost;
       }
       jQuery.each(uW.unitcost["unt"+unitId][11],function(itemId,itemQuantity){uW.ksoItems[+itemId].subtract(+itemQuantity*num)});
       Seed.citystats["city"+cityId].gold[0]=parseInt(uW.seed.citystats["city"+cityId].gold[0])-parseInt(uW.unitcost["unt"+unitId][5])*parseInt(num);
       Seed.citystats["city"+cityId].pop[0]=parseInt(uW.seed.citystats["city"+cityId].pop[0])-Math.ceil(parseInt(uW.unitcost["unt"+unitId][6])* MORE_WITH_LESS_FACTOR)*parseInt(num);
       var prestige=false;
       if (unitId>12 && unitId!=16) prestige=true;
       uW.seed.queue_unt["city"+cityId].push([unitId,num,rslt.initTS,parseInt(rslt.initTS)+time,0,time,null,prestige]);
       if (tut!=0) uW.seed.items["i"+tut]=Number(uW.seed.items["i"+tut])-1;
       if (notify != null)
          setTimeout (function (){notify(null);}, 100);
      } else {
        if (notify != null){
          setTimeout (function (){notify(rslt.errorMsg);}, 100);
        }
      }
    },
    onFailure: function(rslt) {
		profiler.stop();
      if (notify != null)
        notify(rslt.errorMsg);
    }
  });
}

function getAbsoluteOffsets (e){
  ret = {left:0, top:0};
  while (e.offsetParent){
    if (e.style.position == 'absolute')
      break;
    ret.left += e.offsetLeft;
    ret.top += e.offsetTop;
    e = e.offsetParent;
  }
  return ret;
}

function getClientCoords(e){
  if (e==null)
    return {x:null, y:null, width:null, height:null};
  var x=0, y=0;
  ret = {x:0, y:0, width:e.clientWidth, height:e.clientHeight};
  while (e.offsetParent != null){
    ret.x += e.offsetLeft;
    ret.y += e.offsetTop;
    e = e.offsetParent;
  }
  return ret;
}

function htmlTitleLine (msg){
  return '<TABLE width=100% cellspacing=0><TR><TD style="padding:0px" width=50%><HR></td><TD style="padding:0px">[ '+ msg +' ]</td><TD style="padding:0px" width=50%><HR></td></tr></table>';
}
function toUnicode(theString) {
	var unicodeString = '';
	for (var i=0; i < theString.length; i++) {
	var theUnicode = theString.charCodeAt(i);
	theUnicode = '&#' + theUnicode +';';
	unicodeString += theUnicode;
    }
	return unicodeString;
}
function CPopup (prefix, x, y, width, height, enableDrag, onClose) {
  var pop = WinManager.get(prefix);
  if (pop){
    pop.show (false);
    return pop;
  }
  this.BASE_ZINDEX = 123457;
  this.stmaxh = height;
  this.stmaxw = width;
  this.show = show;
  this.toggleHide = toggleHide;
  this.getTopDiv = getTopDiv;
  this.getMainTopDiv = getMainTopDiv;
  this.getMainDiv = getMainDiv;
  this.getLayer = getLayer;
  this.setLayer = setLayer;
  this.setEnableDrag = setEnableDrag;
  this.getLocation = getLocation;
  this.setLocation = setLocation;
  this.focusMe = focusMe;
  this.isShown = isShown;
  this.unfocusMe = unfocusMe;
  this.centerMe = centerMe;
  this.destroy = destroy;
  this.autoHeight = autoHeight;
  this.autoWidth = autoWidth;
  this.div = document.createElement('div');
  this.prefix = prefix;
  this.onClose = onClose;
  var t = this;
  this.div.className = 'BOCPopup '+ prefix +'_CPopup';
  this.div.style.width = width + 'px';
  this.div.style.maxWidth = width + 'px';

  this.div.id = prefix +'_outer';
  this.div.style.background = "#fff";
  this.div.style.zIndex = this.BASE_ZINDEX;
  this.div.style.display = 'none';
  if (Options.BOTransparence) this.div.style.opacity = '0.9';
  this.div.style.height = height + 'px';
  this.div.style.maxHeight = height + 'px';
  this.div.style.overflowY = 'hidden';
  this.div.style.position = "absolute";
  this.div.style.top = y +'px';
  this.div.style.left = x + 'px';
  topClass = 'BOCPopupTop '+ prefix +'_CPopupTop';
  var m = '<TABLE cellspacing=0 width=100% height=100%><TR id="'+ prefix +'_bar" class="'+ topClass +'"><TD width=99% valign=bottom><SPAN id="'+ prefix +'_top"></span></td>\
      <TD id='+ prefix +'_X align=right valign=middle onmouseover="this.style.cursor=\'pointer\'" style="color:#fff; background:#333; font-weight:bold; font-size:14px; padding:0px 0px">\
      <img style="margin-bottom:0px;" width=35px height=35px src="data:image/png;base64,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%3D%3D" title="Fermer">\
      </td></tr><TR><TD height=100% valign=top class="BOCPopMain '+ prefix +'_CPopMain" colspan=2 id="'+ prefix +'_main"></td></tr></table>';
  document.body.appendChild(this.div);
  this.div.innerHTML = m;
  ById(prefix+'_X').addEventListener ('click', e_XClose, false);
  this.dragger = new CWinDrag (ById(prefix+'_bar'), this.div, enableDrag);

  this.div.addEventListener ('mousedown', e_divClicked, false);
  WinManager.add(prefix, this);
  function e_divClicked (){
    t.focusMe();
  }
  function e_XClose (){
    t.show(false);
    if (t.onClose != null)
      t.onClose();
  }
  function autoHeight (onoff){
     if (onoff) {
       t.div.style.height = '';
       t.div.style.maxHeight ='';
    } else{
       t.div.style.height = t.stmaxh;
       t.div.style.maxHeight = t.stmaxh;
       }
  }
  function autoWidth (onoff){
         if (onoff) {
           t.div.style.width = '';
           if (isChrome) t.div.style.maxWidth = t.stmaxw;
           else t.div.style.maxWidth = '';
        } else{
           t.div.style.width = t.stmaxw;
           t.div.style.maxWidth = t.stmaxw;
           }
  }
  function focusMe (){
    t.setLayer(5);
    for (k in uW.cpopupWins){
      if (k != t.prefix)
        uW.cpopupWins[k].unfocusMe();
    }
  }
  function unfocusMe (){
    t.setLayer(-5);
  }
  function getLocation (){
    return {x: parseInt(this.div.style.left), y: parseInt(this.div.style.top)};
  }
  function setLocation (loc){
    t.div.style.left = loc.x +'px';
    t.div.style.top = loc.y +'px';
  }
  function destroy (){
    document.body.removeChild(t.div);
    WinManager.delete (t.prefix);
  }
  function centerMe (parent){
    if (parent == null){
      var coords = getClientCoords(document.body);
    } else
      var coords = getClientCoords(parent);
    var x = ((coords.width - parseInt(t.div.style.width)) / 2) + coords.x;
    var y = ((coords.height - parseInt(t.div.style.height)) / 2) + coords.y;
    if (x<0)
      x = 0;
    if (y<0)
      y = 0;
    t.div.style.left = x +'px';
    t.div.style.top = y +'px';
  }
  function setEnableDrag (tf){
    t.dragger.setEnable(tf);
  }
  function setLayer(zi){
    t.div.style.zIndex = ''+ (this.BASE_ZINDEX + zi);
  }
  function getLayer(){
    return parseInt(t.div.style.zIndex) - this.BASE_ZINDEX;
  }
  function getTopDiv(){
    return ById(this.prefix+'_top');
  }
  function getMainDiv(){
    return ById(this.prefix+'_main');
  }
  function getMainTopDiv(){
  	return ById(this.prefix+'_top');
  }
  function isShown (){
    return t.div.style.display == 'block';
  }
  function show(tf){
    if (tf){
      t.div.style.display = 'block';
      t.focusMe ();
    } else {
      t.div.style.display = 'none';
    }
    return tf;
  }
  function toggleHide(t){
    if (t.div.style.display == 'block') {
      return t.show (false);
    } else {
      return t.show (true);
    }
  }
}


function CWinDrag (clickableElement, movingDiv, enabled) {
  var t=this;
  this.setEnable = setEnable;
  this.setBoundRect = setBoundRect;
  this.debug = debug;
  this.dispEvent = dispEvent;
  this.lastX = null;
  this.lastY = null;
  this.enabled = true;
  this.moving = false;
  this.theDiv = movingDiv;
  this.body = document.body;
  this.ce = clickableElement;
  this.moveHandler = new CeventMove(this).handler;
  this.outHandler = new CeventOut(this).handler;
  this.upHandler = new CeventUp(this).handler;
  this.downHandler = new CeventDown(this).handler;
  this.clickableRect = null;
  this.boundRect = null;
  this.bounds = null;
  this.enabled = false;
  if (enabled == null)
    enabled = true;
  this.setEnable (enabled);

  function setBoundRect (b){
    this.boundRect = boundRect;
    this.bounds = null;
  }

  function setEnable (enable){
    if (enable == t.enabled)
      return;
    if (enable){
      clickableElement.addEventListener('mousedown',  t.downHandler, false);
      t.body.addEventListener('mouseup', t.upHandler, false);
    } else {
      clickableElement.removeEventListener('mousedown', t.downHandler, false);
      t.body.removeEventListener('mouseup', t.upHandler, false);
    }
    t.enabled = enable;
  }

  function CeventDown (that){
    this.handler = handler;
    var t = that;
    function handler (me){
      if (t.bounds == null){
        t.clickableRect = getClientCoords(clickableElement);
        t.bodyRect = getClientCoords(document.body);
        if (t.boundRect == null)
          t.boundRect = t.clickableRect;
        t.bounds = {top:10-t.clickableRect.height, bot:t.bodyRect.height-25, left:40-t.clickableRect.width, right:t.bodyRect.width-25};
      }
      if (me.button==0 && t.enabled){
        t.body.addEventListener('mousemove', t.moveHandler, true);
        t.body.addEventListener('mouseout', t.outHandler, true);
        t.lastX = me.clientX;
        t.lastY = me.clientY;
        t.moving = true;
      }
    }
  }

  function CeventUp  (that){
    this.handler = handler;
    var t = that;
    function handler (me){
      if (me.button==0 && t.moving)
        _doneMoving(t);
    }
  }

  function _doneMoving (t){
    t.body.removeEventListener('mousemove', t.moveHandler, true);
    t.body.removeEventListener('mouseout', t.outHandler, true);
    t.moving = false;
  }

  function CeventOut  (that){
    this.handler = handler;
    var t = that;
    function handler (me){
      if (me.button==0){
        t.moveHandler (me);
      }
    }
  }

  function CeventMove (that){
    this.handler = handler;
    var t = that;
    function handler (me){
      if (t.enabled && !t.wentOut){
        var newTop = parseInt(t.theDiv.style.top) + me.clientY - t.lastY;
        var newLeft = parseInt(t.theDiv.style.left) + me.clientX - t.lastX;
        if (newTop < t.bounds.top){     // if out-of-bounds...
          newTop = t.bounds.top;
          _doneMoving(t);
        } else if (newLeft < t.bounds.left){
          newLeft = t.bounds.left;
          _doneMoving(t);
        } else if (newLeft > t.bounds.right){
          newLeft = t.bounds.right;
          _doneMoving(t);
        } else if (newTop > t.bounds.bot){
          newTop = t.bounds.bot;
          _doneMoving(t);
        }
        t.theDiv.style.top = newTop + 'px';
        t.theDiv.style.left = newLeft + 'px';
        t.lastX = me.clientX;
        t.lastY = me.clientY;
      }
    }
  }

  function debug  (msg, e){
    logit ("*************** "+ msg +" ****************");
    logit ('clientWidth, Height: '+ e.clientWidth +','+ e.clientHeight);
    logit ('offsetLeft, Top, Width, Height (parent): '+ e.offsetLeft +','+ e.offsetTop +','+ e.offsetWidth +','+ e.offsetHeight +' ('+ e.offsetParent +')');
    logit ('scrollLeft, Top, Width, Height: '+ e.scrollLeft +','+ e.scrollTop +','+ e.scrollWidth +','+ e.scrollHeight);
  }

  function dispEvent (msg, me){
    logit (msg + ' Button:'+ me.button +' Screen:'+ me.screenX +','+ me.screenY +' client:'+  me.clientX +','+ me.clientY +' rTarget: '+ me.relatedTarget);
  }
}


var WinManager = {
  wins : {},
  didHide : [],

  get : function (prefix){
    var t = WinManager;
    return t.wins[prefix];
  },

  add : function (prefix, pop){
    var t = WinManager;
    t.wins[prefix] = pop;
    if (uW.cpopupWins == null)
      uW.cpopupWins = {};
    uW.cpopupWins[prefix] = pop;
  },

  hideAll : function (){
    var t = WinManager;
    t.didHide = [];
    for (k in t.wins){
      if (t.wins[k].isShown()){
        t.didHide.push (t.wins[k]);
        t.wins[k].show (false);
      }
    }
  },
  restoreAll : function (){
    var t = WinManager;
    for (var i=0; i<t.didHide.length; i++)
      t.didHide[i].show (true);
  },

  delete : function (prefix){
    var t = WinManager;
    delete t.wins[prefix];
    delete uW.cpopupWins[prefix];
  }
}

Array.prototype.compare = function(testArr) {
    if (this.length != testArr.length) return false;
    for (var i = 0; i < testArr.length; i++) {
        if (this[i].compare) {
            if (!this[i].compare(testArr[i])) return false;
        }
        if (this[i] !== testArr[i]) return false;
    }
    return true;
}

String.prototype.entityTrans = {  '&agrave;':'\\u00e0', '&eacute;':'\\u00e9', '&':'&amp;', '<':'&lt;',  '>':'&gt;',  '\"':'&quot;', '\'':'&#039', '<':'\\u003c', '/':'\\/', '\\':'\\\\', '\"':'\\\"','{':'&#123;','}':'&#125;'};

String.prototype.htmlEntities = function() {
  var ret = this.toString();
  for (k in this.entityTrans)
     ret  = ret.split(k).join(this.entityTrans[k]);
  return ret;
}
String.prototype.htmlSpecialChars = function() {
  var ret = this.toString();
  for (k in this.entityTrans)
     ret  = ret.split(k).join(this.entityTrans[k]);
  return ret;
}
String.prototype.htmlSpecialCharsDecode = function() {
  var ret = this.toString();
  for (k in this.entityTrans)
     ret = ret.split(this.entityTrans[k]).join(k);
  return ret;
}
String.prototype.stripTags = function(){
  return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi, '');
}

String.prototype.capitalize = function(){
  return this.charAt(0).toUpperCase() + this.substring(1).toLowerCase();
}

function objectName (o){
  var s = o.toString();
  return s.substr(7,s.length-8);
}

function matTypeof (v){
  if (v == undefined)
    return 'undefined';
  if (typeof (v) == 'object'){
    if (!v)
      return 'null';
    else if (v.constructor.toString().indexOf("Array")>=0 && typeof(v.splice)=='function')
      return 'array';
    else return 'object';
  }
  return typeof (v);
}

function addCommasInt(n){
  nStr = parseInt(n) + '';
  var rgx = /(\d+)(\d{3})/;
  while (rgx.test(nStr)) {
    nStr = nStr.replace(rgx, '$1' + ',' + '$2');
  }
  return nStr;
}

function addCommas(nStr){
  nStr += '';
  x = nStr.split('.');
  x1 = x[0];
  x2 = x.length > 1 ? '.' + x[1] : '';
  var rgx = /(\d+)(\d{3})/;
  while (rgx.test(x1)) {
    x1 = x1.replace(rgx, '$1' + ',' + '$2');
  }
  return x1 + x2;
}

function htmlSelector(a,b,c){m=[];m.push("<SELECT");if(c){m.push(" ");m.push(c)}for(k in a){m.push("><OPTION ");if(k==b)m.push("SELECTED ");m.push('value="');m.push(k);m.push('">');m.push(a[k]);m.push("</option>")}m.push("</select>");return m.join("")}
function unixTime(){ return parseInt (new Date().getTime() / 1000) + unsafeWindow.g_timeoff;}
function timestrShort(a){a=parseInt(a);if(a>86400){var b=[];a/=3600;b.push(parseInt(a/24));b.push("d ");b.push(parseInt(a%24));b.push("h ");return b.join("")}else return timestr(a)}
function timestr(a,b){a=parseInt(a);var c=[];var d=a;if(d<61)return d+"s";if(d>86400){c.push(parseInt(d/86400));c.push("d ");d%=86400}if(d>3600||a>3600){c.push(parseInt(d/3600));c.push("h ");d%=3600}c.push(parseInt(d/60));c.push("m");if(b||a<=3600){c.push(" ");c.push(d%60);c.push("s")}return c.join("")}
function getMyAlliance(){if(Seed.allianceDiplomacies==null||Seed.allianceDiplomacies.allianceName==null)return[0,"None"];else return[Seed.allianceDiplomacies.allianceId,Seed.allianceDiplomacies.allianceName]}
function addCommasWhole(a){a+="";x=a.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var b=/(\d+)(\d{3})/;while(b.test(x1)){x1=x1.replace(b,"$1"+","+"$2")}return x1}
function Sound(file, callback) {
	var instance = this;
	instance.element = new Audio();
	instance.loaded = false;
	instance.err = false;
	instance.get = function(property) { return instance.element[property]; };
	instance.set = function(property, value) {
		try {
			if (property == "volume" && value > 1) value = 1;
			if (property == "volume" && value < 0) value = 0;
			instance.element[property] = value;
		} catch (ex) {
			actionLog ("Audio",'Audio <b>set property</b> error: ' + property + ' = ' + value);
		}
	};
	instance.play = function() {
		if (instance.loaded && !instance.err) {
			instance.element.play();
		} else {
			actionLog ("Audio",'Audio <b>play</b> error: Sound file not loaded<br>'+ file.substr(0,50));
		}
	};
	instance.pause = function() {
		instance.element.pause();
	};
	instance.stop = function() {
		if (instance.loaded && !instance.err) {
			instance.element.pause();
			instance.set('currentTime', 0);
		} else {
			actionLog ("Audio",'Audio <b>stop</b> error: Can\'t stop sound. Not loaded?<br>'+ file.substr(0,80));
		}
	};
	instance.load = function(file, callback) {
		instance.loaded = false;
		instance.err = false;
		var loadedHandler = function() {
			instance.loaded = true;
			instance.element.removeEventListener('canplaythrough', loadedHandler);
			if(callback) {
				callback.apply(instance);
			}
		};
		var errorHandler = function() {
			instance.loaded = false;
			instance.err = true;
			actionLog ("Audio",'Audio <b>load</b> error: Can\'t load soundfile.<br>'+ file.substr(0,80));
			instance.element.removeEventListener('error', errorHandler);
			if(callback) {
				callback.apply(instance);
			}
		};
		instance.element.addEventListener('canplaythrough', loadedHandler);
		instance.element.addEventListener('error', errorHandler);
		instance.set('src', file);
		instance.element.load();
	};
	if(file) {
		instance.load(file, callback);
	}
}

function SliderBar (container, width, height, value, classPrefix, margin){
  var self = this;
  this.listener = null;
  if (value==null)
    value = 0;
  if (!margin)
    margin = parseInt(width*.05);
  this.value = value;
  if (width<20) width=20;
  if (height<5) height=5;
  if (classPrefix == null){
    classPrefix = 'slider';
    var noClass = true;
  }
  var sliderHeight = parseInt(height/2);
  var sliderTop = parseInt(height/4);
  this.sliderWidth = width - (margin*2);

  this.div = document.createElement ('div');
  this.div.style.height = height +'px';
  this.div.style.width = width +'px';
  this.div.className = classPrefix +'Cont';
  if (noClass)
    this.div.style.backgroundColor='#ddd';

  this.slider = document.createElement ('div');
  this.slider.setAttribute ('style', 'position:relative;');
  this.slider.style.height = sliderHeight + 'px'
  this.slider.style.top = sliderTop + 'px';
  this.slider.style.width = this.sliderWidth +'px';
  this.slider.style.left = margin +'px';
  this.slider.className = classPrefix +'Bar';
  this.slider.draggable = true;
  if (noClass)
    this.slider.style.backgroundColor='#fff';

  this.sliderL = document.createElement ('div');
  this.sliderL.setAttribute ('style', 'width:100px; height:100%; position:relative; ');
  this.sliderL.className = classPrefix +'Part';
  this.sliderL.draggable = true;
  if (noClass)
    this.sliderL.style.backgroundColor='#0c0';
  this.knob = document.createElement ('div');
  this.knob.setAttribute ('style', 'width:3px; position:relative; left:0px; background-color:#222');
  this.knob.style.height = height +'px';
  this.knob.style.top = (0-sliderTop) +'px';
  this.knob.className = classPrefix +'Knob';
  this.knob.draggable = true;
  this.slider.appendChild(this.sliderL);
  this.sliderL.appendChild (this.knob);
  this.div.appendChild (this.slider);
  container.appendChild (this.div);
  this.div.addEventListener('mousedown',  mouseDown, false);
  this.getValue = function (){    return self.value;  }
  this.setValue = function (val){
    var relX = (val * self.sliderWidth);
    self.sliderL.style.width = relX + 'px';
    self.knob.style.left =  relX + 'px';
    self.value = val;
    if (self.listener)
      self.listener(self.value);
  }
  this.setChangeListener = function (listener){
    self.listener = listener;
  }

  function moveKnob (me){
    var relX = me.clientX - self.divLeft;
    if (relX < 0)
      relX = 0;
    if (relX > self.sliderWidth)
      relX = self.sliderWidth;
    self.knob.style.left = (relX - (self.knob.clientWidth/2) ) +'px';
    self.sliderL.style.width = relX + 'px';
    self.value =  relX / self.sliderWidth;
    if (self.listener)
      self.listener(self.value);
  }
  function doneMoving (){
    self.div.removeEventListener('mousemove', mouseMove, true);
    document.removeEventListener('mouseup', mouseUp, true);
  }
  function mouseUp (me){
    moveKnob (me);
    doneMoving();
  }

  function mouseDown(me){
    var e = self.slider;
    self.divLeft = 0;
    while (e.offsetParent){
      self.divLeft += e.offsetLeft;
      e = e.offsetParent;
    }
    moveKnob (me);
    document.addEventListener('mouseup',  mouseUp, true);
    self.div.addEventListener('mousemove',  mouseMove, true);
  }
  function mouseMove(me){
    moveKnob (me);
  }
}
function AddSubTabLink(text, eventListener, id) {
  var a = createYellowButton (text,'botbutton');
  a.className='tab';
  var tabs=ById('main_engagement_tabs');
  if(!tabs) {
    tabs=ById('topnav_msg');
    if (tabs)
      tabs=tabs.parentNode;
  }
  if (tabs) {
    var e = tabs.parentNode;
    var gmTabs = null;
    for (var i=0; i<e.childNodes.length; i++){
      var ee = e.childNodes[i];
      if (ee.tagName && ee.tagName=='DIV' && ee.className=='tabs_engagement' && ee.id!='main_engagement_tabs' &&  ee.id!='BOAbout'){
        gmTabs = ee;
        break;
      }
    }
    if (gmTabs == null){
      gmTabs = document.createElement('div');
      gmTabs.className='tabs_engagement';
      gmTabs.style.background='#ca5';
      tabs.parentNode.insertBefore (gmTabs, tabs);
      gmTabs.style.whiteSpace='nowrap';
      gmTabs.style.width='735px';
      gmTabs.lang = 'en_PB';
    }
    gmTabs.appendChild(a);
    a.addEventListener('click',eventListener, false);
    if (id != null)
      a.id = id;
    return a;
  }
  return null;
}
function AddTowerTab(text, eventListener, id) {
  var a = createRedButton (text,'botbutton');
  a.className='tab';
  a.title="Attention !!! "+uW.g_js_strings.modaltitles.impatks+" !";
  var tabs=ById('BOAbout');
  if (tabs) {
    tabs.appendChild(a);
    a.addEventListener('click',eventListener, false);
    if (id != null)
      a.id = id;
    return a;
  }
  return null;
}

function estETA(dist, unit, cityID, typemarche) {
 var ret={ETA:0,etaStr:'N/D',friendETA:0,friendEtaStr:'N/D'};
 if (dist <= 0) return ret;
 var troop_type = unit;
 var troop_speed=parseInt(uW.unitstats["unt"+troop_type][3])*(1+0.1*parseInt(Seed.tech.tch11));
 if (uW.cm.unitHorsedBenefit[troop_type]){
    troop_speed=troop_speed*(1+0.05*parseInt(Seed.tech.tch12))
 } else {
	troop_speed*=(1+0.05*(parseInt(Seed.tech2.tch1)||0));
	troop_speed*=uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().BLOOD_LUST,cityID,{speed:true})

 }
 var Speed = troop_speed;
 Speed*=uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().FILL_THE_RANKS,cityID,{marchspeed:true});
 Speed*=uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().REDUCE_FATIGUE,cityID,{});
 var throne67=EffetTronePrc(67).percent;
 var throne68,throne69,throne70,throne71,throne72;throne68=throne69=throne70=throne71=throne72=0;
  if(typemarche==4){
   throne68=EffetTronePrc(68).percent // attaque
  }else{
   if(typemarche==3){ //eclaireur
    throne72=EffetTronePrc(72).percent
   }else{
    if(typemarche==2){ //renforce
     throne69=EffetTronePrc(69).percent
    }else{
     if(typemarche==5){ // reassign
      throne71=EffetTronePrc(71).percent
     }else{
      if(typemarche==1){ // transport
       throne70=EffetTronePrc(70).percent
       }}}}}
 var throneBoost=throne67+throne68+throne69+throne70+throne71+throne72;
 Speed=Speed*(1+(throneBoost*0.01));

 if(uW.cm.WorldSettings.isOn("GUARDIAN_MARCH_EFFECT")){
    var f = {0: 0,1: 1,2: 2,3: 3,4: 4,5: 6,6: 6,7: 7,8: 8,9: 9,10: 10,11: 11,12: 12};
    var b=0,y=false,v=false,w=0;
    var mm=Seed.guardian;
           for (var ii in mm) {
            var ww = mm[ii];
            if (ww.cityId==cityID) {
             if (ww.type== "food") y=true;
             if (ww.guardianCount==4) v=true;
             var level=0;
             if (ww.cityGuardianLevels.food!=undefined) level = ww.cityGuardianLevels.food;
             w = f[level];
             if (y && v) w = w *1.5;
             if (!y && v) w = w*0.5;
             if (!y && !v) w = 0;
            }
       }
   var multiplier=1+(w*0.01);
   Speed=Speed*multiplier;
 }
 var gSpeed = 0;
 var estSec;
 if (Speed>0) {
  gSpeed = Speed/6000;
  estSec = Math.ceil(parseFloat(dist)/gSpeed);
 }
 var e=1;
 if (ById("BOitem_55")) {
  var l_elem=ById("BOitem_55");
  if(l_elem&&l_elem.checked>0){ e=0.75;     }
 }
 if (ById("BOitem_57")) {
  var l_elem=ById("BOitem_57");
  if(l_elem&&l_elem.checked){   e=0.5;   }
 }
 ret.ETA = (parseInt((estSec*e+''))+30);
 if(Seed.playerEffects.returnExpire>uW.unixtime()){
  ret.ETA=parseInt(ret.ETA*0.5);
 }
 ret.etaStr = timestr (ret.ETA,1);
 if (cityID!=0) {
  var building = getCityBuilding (cityID, 18);
  if (building) {
   fSpeed = Speed * (1 + parseInt(building.maxLevel)/2);
   gSpeed = fSpeed/6000;
   estSec = (dist/gSpeed).toFixed(0);
   ret.friendETA = parseInt((estSec*e+''))+30;
   ret.friendEtaStr = timestr ((ret.friendETA+''),1);
  }
 } else {
  ret.friendETA = ret.ETA;
  ret.friendEtaStr = timestr ((ret.friendETA+''),1);
 }
 return ret;
}

function updatebotbutton2(a,b){var c=ById(b);if(c)c.innerHTML='<span style="color: #F71F02">'+a.replace("- ON",butON).replace("- OFF",butOFF)+"</span>"}
function updatebotbutton(a,b){var c=ById(b);if(c)c.innerHTML='<span style="color: #ff6">'+a.replace("- ON",butON).replace("- OFF",butOFF)+"</span>"}
function createRedButton(a,b){var c=document.createElement("a");c.style.display='none';c.id=b;c.innerHTML='<span style="color: #ff6">'+a+"</span>";return c}
function createYellowButton(a,b){
 var c=document.createElement("a");c.className="button20";c.id=b;
 c.innerHTML='<span style="color: #ff6">'+a.replace("- ON",butON).replace("- OFF",butOFF)+'</span>';
 return c
}
var DeleteReports = {
    deleting : false,
    deletes1 : new Array(),
    deletes0 : new Array(),
    init : function(){
		var t = DeleteReports;
		if(!t.deleting && (Options.DeleteMsg || Options.DeleteMsgs0 || Options.DeleteMsgs4 || Options.DeleteMsgs1 || Options.DeleteMsgs2 || Options.DeleteMsgs3 || Options.DeleteMsgs6 || Options.DeleteMsgs7 || Options.DeleteMsgs8)){
		 if (parseIntNan(Options.DeleteTimerMinute)<3) Options.DeleteTimerMinute=3;
		}
    },

    startdeletereports : function(){
		var t = DeleteReports;
		t.deletes1 = new Array();
		t.deletes0 = new Array();
	  	if(!t.deleting && (Options.DeleteMsg || Options.DeleteMsgs0 || Options.DeleteMsgs4 || Options.DeleteMsgs1 || Options.DeleteMsgs2 || Options.DeleteMsgs3 || Options.DeleteMsgs6 || Options.DeleteMsgs7 || Options.DeleteMsgs8)){
	  		t.deleting = true;
	  		t.fetchreport(0, t.checkreports);
	  	}
    },

    fetchreport : function(pageNo, callback){
		var t = DeleteReports;
		var params = uW.Object.clone(uW.g_ajaxparams);
		if(pageNo > 1)
			params.pageNo = pageNo;
		new MyAjaxRequest(uW.g_ajaxpath + "ajax/listReports.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			onSuccess: function (rslt) {
				callback(rslt,pageNo);
			},
				onFailure: function () {
				callback();
			},
		});
    },

    checkreports : function(rslt, pageNo){
		var t = DeleteReports;
		try {
		 if(!rslt.ok){
			return;
		 }

		var reports = rslt.arReports;
		var totalPages = rslt.totalPages;
		for(k in reports){
			if (Options.DeleteMsgs6){
			 for (var i=1;i<=Seed.cities.length;i++){
			 var x=Seed.cities[i-1][2];
			 var y=Seed.cities[i-1][3];
			 if (Tabs.farm.FarmArray[i]) {
			 for (j=0;j<Tabs.farm.FarmArray[i].length;j++){
			   if (reports[k].side1XCoord == x && reports[k].side1YCoord == y && reports[k].side0XCoord == Tabs.farm.FarmArray[i][j]["x"] && reports[k].side0YCoord == Tabs.farm.FarmArray[i][j]["y"])
			    t.deletes1.push(k.substr(2));
			 }
			 }
			 }
			}
			if (Options.DeleteMsgs7) {
			 if (reports[k].reportType==0 && reports[k].marchType==4 && reports[k].side0XCoord==Options.DeleteMsgs7X && reports[k].side0YCoord==Options.DeleteMsgs7Y)
			  t.deletes0.push(k.substr(2));
			}
			if(Options.DeleteMsg){
				if((reports[k].marchType==9 || reports[k].marchType==4) && reports[k].side0PlayerId==0 && reports[k].side0TileType > 50 && reports[k].side0TileType < 55)
					t.deletes1.push(k.substr(2));
				else if(reports[k].marchType==1 && t.isMyself(reports[k].side1PlayerId))
					t.deletes1.push(k.substr(2));
			}
			if (Options.DeleteMsgs0){

				if(reports[k].marchType==1 && !t.isMyself(reports[k].side1PlayerId)) {
					t.deletes0.push(k.substr(2));
				}
			}
			if (Options.DeleteMsgs1){
				if(reports[k].marchType==4 && (reports[k].side0TileType <= 50)&& reports[k].side0PlayerId==0)
					t.deletes1.push(k.substr(2));

 				for(var i = 0; i < CrestData.length; i++) {
					if (reports[k].side0XCoord == CrestData[i].X && reports[k].side0YCoord == CrestData[i].Y) {
					 t.deletes1.push(k.substr(2));
					}
		         }

			}
			if (Options.DeleteMsgs2){
				if(reports[k].side0TileType==54)
					t.deletes1.push(k.substr(2));
			}
			if (Options.DeleteMsgs8){
							if(reports[k].side0TileType==55)
								t.deletes1.push(k.substr(2));
			}
			if (Options.DeleteMsgs3){
				if(reports[k].side0TileType==51 && reports[k].marchType==2 && t.isMyself(reports[k].side0PlayerId))
					t.deletes1.push(k.substr(2));
			}
			if (Options.DeleteMsgs4){
				if(reports[k].side0TileType==51 && reports[k].marchType==3)
					t.deletes1.push(k.substr(2));
			}
		}

		} catch(err) {
		 var reports = [];
		 var totalPages = 0;
		 if (Options.LogsRapport)actionLog("Rapport", "Aucune suppression de rapport necessaire (BUG Rapport)");
		 t.deleting = false;
		 return;
		}

		if ((pageNo+1)==totalPages || parseInt(pageNo+1)>6) {

		if(t.deletes1.length > 0 || t.deletes0.length > 0){
			t.deleteCheckedReports(t.deletes1, t.deletes0);
		} else {
			if (Options.LogsRapport)actionLog("Rapport", "Aucune suppression de rapport necessaire");
			t.deleting = false;
			return;
		}

		} else {
		  setTimeout(function() { t.fetchreport(pageNo+1, t.checkreports); } , 1500);
		}
    },
    deleteCheckedReports : function(deletes1, deletes0){
		var t = DeleteReports;
		var params = uW.Object.clone(uW.g_ajaxparams);
		params.s1rids = deletes1.join(",");
		params.s0rids = deletes0.join(",");
		params.cityrids = '';
		new MyAjaxRequest(uW.g_ajaxpath + "ajax/deleteCheckedReports.php" + uW.g_ajaxsuffix, {
			method: "post",
			parameters: params,
			onSuccess: function (rslt) {
				if(rslt.ok){
					Seed.newReportCount = parseInt(Seed.newReportCount) - parseInt(deletes1.length) - parseInt(deletes0.length);
					uW.messages_notify_bug();
					if (Options.LogsRapport)actionLog("Rapport", "Suppression de "+(parseInt(deletes1.length)+parseInt(deletes0.length))+" Rapports automatiquement");
				} else {
				  if (Options.LogsRapport)actionLog("Rapport", "Erreur Suppression des rapports : "+ rslt.msg);
				}
				t.deleting = false;
			},
			onFailure: function (rslt) {
			 if (Options.LogsRapport)actionLog("Rapport", "Erreur Suppression des rapports : "+ rslt.msg);
			 t.deleting = false;
			},
		});
    },
    isMyself: function(userID){
		var t = DeleteReports;
		if(!Seed.players["u"+userID])
			return false;
		if(Seed.players["u"+userID].n == Seed.player.name)
			return true;
		else
			return false;
		return false;
    },
}

var tabManager = {
  tabList : {},
  currentTab : null,
  init : function (mainDiv){
    var t = tabManager;
    var sorter = [];
    for (k in Tabs){
      if (!Tabs[k].tabDisabled){
        t.tabList[k] = {};
        t.tabList[k].name = k;
        t.tabList[k].obj = Tabs[k];
        if (Tabs[k].tabLabel != null)
          t.tabList[k].label = Tabs[k].tabLabel;
        else
          t.tabList[k].label = k;
        if (Tabs[k].tabOrder != null)
          sorter.push([Tabs[k].tabOrder, t.tabList[k]]);
        else
          sorter.push([1000, t.tabList[k]]);
        t.tabList[k].div = document.createElement('div');
      }
    }

    sorter.sort (function (a,b){return a[0]-b[0]});
    var m = '<TABLE cellspacing=0 cellpadding=0><TR>';
    for (var i=0; i<sorter.length; i++){
     m += '<TD align=center class=BOTabNotSel id=pbtc'+ sorter[i][1].name +'><A><SPAN class="matTab">'+ sorter[i][1].label +'</span></a></td>';
      if (i==8 || i==17) m+='</tr><tr>';
    }
    m+='</tr></table>';
    mainPop.getMainTopDiv().innerHTML = m;

    for (k in t.tabList) {
      if (t.tabList[k].name == Options.currentTab)
        t.currentTab =t.tabList[k] ;
      ById('pbtc'+ k).addEventListener('click', this.e_clickedTab, false);
      var div = t.tabList[k].div;
      div.style.display = 'none';
      div.style.height = '100%';
      mainDiv.appendChild(div);
      try {
        t.tabList[k].obj.init(div);
      } catch (e){

      }
    }

    if (t.currentTab == null)
      t.currentTab = sorter[0][1];
    t.setTabStyle (ById ('pbtc'+ t.currentTab.name), true);
    t.currentTab.div.style.display = 'block';
  },

  hideTab : function (){
    var t = tabManager;
    t.currentTab.obj.hide();
  },

  showTab : function (){
    var t = tabManager;
    t.currentTab.obj.show();
  },

  setTabStyle : function (e, selected){
    if (selected){
      e.className = 'BOTabSel';
    } else {
      e.className = 'BOTabNotSel';
    }
  },
  e_clickedTab : function (e){
    var t = tabManager;
    newTab = t.tabList[e.target.parentNode.parentNode.id.substring(4)];
    if (t.currentTab.name != newTab.name){
      t.setTabStyle (ById ('pbtc'+ t.currentTab.name), false);
      t.setTabStyle (ById ('pbtc'+ newTab.name), true);
      t.currentTab.obj.hide ();
      t.currentTab.div.style.display = 'none';
      t.currentTab = newTab;
      newTab.div.style.display = 'block';
      Options.currentTab = newTab.name;
    }
    newTab.obj.show();
  },
  e_clickedTab2 : function (name){
      var t = tabManager;
      newTab = t.tabList[name.substring(4)];
      if (t.currentTab.name != newTab.name){
        t.setTabStyle (ById ('pbtc'+ t.currentTab.name), false);
        t.setTabStyle (ById ('pbtc'+ newTab.name), true);
        t.currentTab.obj.hide ();
        t.currentTab.div.style.display = 'none';
        t.currentTab = newTab;
        newTab.div.style.display = 'block';
        Options.currentTab = newTab.name;
      }
      newTab.obj.show();
  },
}
if (TESTBAO==-1) return false;
var March = {
  tt : null,
  profiler : null,
  currentrequests : 0,
  queue : [],
  lastattack : null,
  timer : null, waittime:0,
  addMarch : function (params, callback){
  	var t = this;
  	var opts = {params:params, callback:callback};
  	if(t.currentrequests < 5){
  	  	t.sendMarch(opts.params, opts.callback);
  	} else {
  	    t.queue.push(opts);
  	    if (Options.LogsAutoTs)actionLog("AutoTS", "+ 5 request !!");
  		//setTimeout(t.loop, 2000);
  	}
  },
  loop : function (){
	  var t = this;
  	if(t.currentrequests < 5){
  		var opts = t.queue.shift();
  	 	if (opts) t.sendMarch(opts.params, opts.callback);
  	}
  },
  getQueueLength : function (){
  		var t = this;
  	return t.queue.length;
  },
  RallyPoint : function (cityId){
  	var t = this;
  	var ret = {};
  	ret.level = t.getRallyPointLevel(cityId);
  	ret.maxSlots = t.getTotalSlots(cityId);
  	ret.marching = t.getMarchSlots(cityId);
  	ret.emptySlots = t.getEmptySlots(cityId);
  	ret.maxSize = t.getMaxSize(cityId);
  	return ret;
  },
  getRallyPointLevel : function (cityId){
  	 	 	var t = this;
  	 	 	cityId = "city"+cityId;
  	 	 	rallypointlevel = 0;
  	 	 	for (var o in Seed.buildings[cityId]){
  	 	 	var buildingType = parseInt(Seed.buildings[cityId][o][0]);
  	 	 	var buildingLevel = parseInt(Seed.buildings[cityId][o][1]);
  	 	 	if (buildingType == 12) rallypointlevel=parseInt(buildingLevel);
  	 	 	}
  	 	 	return rallypointlevel;
  },
  getTotalSlots : function (cityId){
  	 	 	var t = this;
  	 	 	var ascended = t.getAscendedStats(cityId);
  	 	 	var rallypointlevel = t.getRallyPointLevel(cityId);
  	 	 	if (rallypointlevel==12) rallypointlevel=11;
  	 	 	var slots = rallypointlevel;
  	 	 	if(ascended.isPrestigeCity){
  	 	 	 slots += 3;
  	 	 	}
  	 return slots;
  	},
  	getMarchSlots : function (cityId){
  		var t = this;
  	 	cityId = "city"+cityId;
  	 	var slots=0;
  	 	if (Seed.queue_atkp[cityId] != undefined){
  	 	for(var k in Seed.queue_atkp[cityId]){
  	 	var m = Seed.queue_atkp[cityId][k];
  	 		if(m.marchType == 9) {
		               if(m.botMarchStatus < 3 || m.botMarchStatus > 9)slots++; //If raid is stopped take it as empty slot
		            } else {
		               slots++;
            }
  	 	}
  	 	if (!isChrome) {
  		if(Seed.queue_atkp[cityId].toSource() == "[]")
  		slots = 0;
  	 	} else {
  	 	slots=0;
  		}
	    }
  	 return slots;
  	},
  	getTrainingQueue: function(cityId) {
		var t = this;
		var c=0,d=0, ret={};
		var q = Seed.queue_unt['city'+cityId];
		for (var i=0; i<q.length; i++){
		 if (q[i][7]) {
			d++;
		 } else {
		   c++;
		 }
 		}
		ret.normal = c;
		ret.ascension = d;
		return ret;
   },
   getEmptyQueue: function(cityId, numbat) { // numbat = 13=casenre 22druide/24fey
		var t = this;
	    var barracksTotal = getCityBuilding(cityId, numbat).count;
	    if (numbat==22 || numbat==24 || numbat==26) {
		 availableTrainingSlots = barracksTotal - t.getTrainingQueue(cityId).ascension;
		} else {
	    availableTrainingSlots = barracksTotal - t.getTrainingQueue(cityId).normal;
		}
	    return availableTrainingSlots;
   },
   getEmptySlots : function (cityId){
  	 	var t = this;
  	 	var slots = t.getTotalSlots(cityId);
  	 	slots -= t.getMarchSlots(cityId);
  	 	if(slots < 0)
  		slots = 0;
  	 	return slots;
  	},
  	getMaxSize : function (cityId,i931,i932){
  		var t = this;
  	 	var rallypointlevel = getCityBuilding(cityId, 12).maxLevel;
  		var ascended = t.getAscendedStats(cityId);
  	 	var buff = 1;
  		var max = 0;
  	 	var now = unixTime();
  	 	if (Seed.playerEffects.aurasExpire) {
  	 	 if (Seed.playerEffects.aurasExpire > now) {
  	 	   buff = 1.15;
  		  }
  	 	}
  	 	if (Seed.playerEffects.auras2Expire) {
  	 	if (Seed.playerEffects.auras2Expire > now) {
  	 	buff = 1.3;
  	 	}
  	}
  	if(parseIntNan(i931)>0){  buff+=0.25; }
    if(parseIntNan(i932)>0){  buff+=0.5;  }
    if(ascended.isPrestigeCity){
  	 	var b = ascended.prestigeLevel;
  	 	var r = uW.cm.WorldSettings.getSetting("ASCENSION_RALLYPOINT_BOOST"),
  	 	m = JSON.parse(r),
  	 	u = m.values[b - 1][1],
  	 	k = parseFloat(u);
  		buff *= k;
  	}
  	var tr=EffetTronePrc(66).percent;
  	switch(rallypointlevel){
  	 	case 11:
  	 	max = 150000 * buff;
  	 	break;
  	 	case 12:
  	 	max = 200000 * buff;
  	 	break;
  	 	default:
  	 	max = (rallypointlevel * 10000) * buff;
  	 	break;
  	}
  	max = Math.round(max*(1+tr/100));
	 	max = Math.round(max * uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().FILL_THE_RANKS, cityId, {
					marchsize: true
		}));


	return Math.floor(max+0.0001);
  	//return max;
 },
 getAscendedStats : function (cityId){
  	 	var t = this;
		var ret = {};
		if (!Seed.cityData.city[cityId]) {
			ret.isPrestigeCity = false;
		} else {
  		if(Seed.cityData.city[cityId].isPrestigeCity){
  		 	ret.isPrestigeCity = true;
  		 	ret.prestigeLevel = parseInt(Seed.cityData.city[cityId].prestigeInfo.prestigeLevel);
	        ret.prestigeType = parseInt(Seed.cityData.city[cityId].prestigeInfo.prestigeType);
        	ret.blessings = parseInt(Seed.cityData.city[cityId].prestigeInfo.blessings);
  		} else {
  	 	 ret.isPrestigeCity = false;
  		}
	}
  		return ret;
  },
  currentrequests8:0,
  sendMarch : function (params, callback){
	var t = this;
	if(March.waittime > uW.unixtime()){
			logit('stalling marches to deal with captcha');
			return;
	};
	if (Options.crestRunning == false)
	 return;
	t.profiler = new uW.cm.Profiler("ResponseTime", "march.php");
	t.currentrequests++;
	new AjaxRequest(uW.g_ajaxpath + "ajax/march.php" + uW.g_ajaxsuffix, {
	 	 	method: "post",
	 	 	parameters: params,
	 	 	onSuccess: function (transport) {
                var t = March;
	 	 	    t.profiler.stop();
	 	 	    --t.currentrequests;
				var rslt = eval("(" + transport.responseText + ")");
	 	 	    if (rslt.ok) {
					  t.currentrequests8=0;
	 	 	     var timediff = parseInt(rslt.eta) - parseInt(rslt.initTS);
	 	 	     var rtimediff=parseInt(rslt.returnTS)-parseInt(rslt.initTS);
	 	 	     var ut = uW.unixtime();
	 	 	     var unitsarr = [];
            	 for (j in uW.unitcost) unitsarr.push(0);
	 	 	     for(i = 0; i <= unitsarr.length; i++)
	 	 	      if(params["u"+i])
	 	 	       unitsarr[i] = params["u"+i];
		  		var resources=[0,0,0,0,0,0,0,0,0,0,0,0,0];

	 	 		uW.attach_addoutgoingmarch(rslt.marchId, rslt.marchUnixTime, ut + timediff, params.xcoord, params.ycoord, unitsarr, params.type, params.kid, resources, rslt.tileId, rslt.tileType, rslt.tileLevel, params.cid, true,ut+rtimediff);
            	if (rslt.updateSeed)	  	uW.update_seed(rslt.updateSeed);
            		 		if(callback)	 	 	 callback(rslt);
	 	 	} else {

	 	 	if (rslt.error_code==8) {
				t.currentrequests8++;
				//actionLog("AutoTS","Erreur code 8 - " +t.currentrequests8);
				if (t.currentrequests8>15) reloadKOC();
				setTimeout (function(){t.sendMarch(params,callback);}, 3000);
				return;
			}
			if (rslt.error_code==0 || rslt.error_code==3) {
				//actionLog("AutoTS","Erreur code 0 - " + t.currentrequests);
				setTimeout (function(){t.sendMarch(params,callback);}, 3000);
				return;
			}
	 	 	if (rslt.user_action == "marchWarning") {
			 if (Options.LogsAutoTs)actionLog("AutoTS","marchWarning");
	 	 	 params.marchWarning = 1;
	 	 	 setTimeout (function(){t.sendMarch(params,callback);}, 5*1000);
	 	 	 return;
	 	 	}
	 	 	if (rslt.user_action == "marchCaptcha") {
	 	 	if (Options.LogsAutoTs)actionLog("AutoTS","CAPTCHA");
	 	 	March.waittime = Number(uW.unixtime()+120);
	 	 	if(!uW.Recaptcha){
				setTimeout (function(){t.sendMarch(params,callback);}, 5*2000);
				return;
		  	}
	 	 	if (t.captchawin == null) t.captchawin = new CPopup ('BAOmarch_captcha', 0, 0, 400, 300, true);
	 	 	t.captchawin.centerMe (mainPop.getMainDiv);
	 	 	var m = "<CENTER><SPAN class=boldRed>CAPTCHA ALERT! You have been sending too many attacks!</span></center><br \>";
	 	 	m += "<CENTER><div class=\"captcha_container\"><form id=bomarch_captchaform ></form></div></center>";
	 	 	t.captchawin.getMainDiv().innerHTML = m;
	 	 	t.captchawin.getTopDiv().innerHTML = "<CENTER><b>KOC BAO - ALERT CAPTCHA</b></center>";
	 	 	t.captchawin.show(true);

	 	 	uW.Recaptcha.create("6LcT7cQSAAAAAG4whvbBz60hGjJg0ON1wRIRv_iD", "bomarch_captchaform", {
	 	 	callback: function(){
	 	 	uW.Recaptcha.focus_response_field();
	 	 	$("bomarch_captchaform").addEventListener("submit", function(e){
	 	 	e.preventDefault();
	 	 	e.stopPropagation();
	 	 	params.marchWarning = 1;
	 	 	params.marchCaptcha_challenge = uW.Recaptcha.get_challenge();
	 	 	params.marchCaptcha_response = uW.Recaptcha.get_response();
	 	 	setTimeout (function(){t.sendMarch(params,callback);}, 5*6000);
	 	 	t.captchawin.destroy();
	 	 	}, false);
	 	 	},
	 	 	  theme: "white"
	 	 	 });
	 	 	 return;
	 	 	}
	 	 	setTimeout (function(){callback(rslt)}, 5*1000);
	 	 	return;
	 	 	}
	 	 	t.loop();
	 	 	},
	 onFailure: function (transport) {
	 	t.profiler.stop();

	 	--t.currentrequests;
	 	if(callback)
	 	 callback({ok:false});
	 	t.loop();
	   }
	});
  }
}

var tid = null,LastUnixTime = null;
Tabs.AutoRpt = {
  tabOrder : 18,
  tabLabel: lang.BoiteLabelAutoRpt,
  tabDisabled : false,
  cont:null,
  state : null,
  init : function (div){
    var t = Tabs.AutoRpt;
    if (GM_getValue('ScanTidTimer_'+getServerId(),'Offline') != "Online") {
      clearTimeout(tid);
    } else {
	  tid = setTimeout(t.handleHudSearch, GM_getValue('repScanTime_'+getServerId(),5000));
    }
    t.cont=div;

    t.getAllianceReports();

    t.cont.innerHTML = '<DIV class=boStat align="center">'+lang.autoRpt.title+'</div>\
   <DIV>\
            <table width="100%">\
            <tr>\
            <td colspan="4" class=xtab>'+lang.autoRpt.title2+'</td>\
            <TD width="20" class=xtab align="right">'+lang.autoRpt.delay+'<INPUT id=BOdelayField1 size="1" maxlength="3" type=text value="' + GM_getValue('delayField1_'+getServerId(),'') + '" /><SPAN> Min.</SPAN>\
            <td class=xtab align="right" colspan="2">'+lang.autoRpt.status+'<span id=idRepStatus></span></td>\
            </tr><tr><td width="97" class=xtab>'+lang.autoRpt.scan+'</td>\
            <td width="16" class=xtab><span id=idSpanNumPages text-color=#ffeecc></span></td>\
            <td width="225" class=xtab><INPUT name="idHudSelect" id="idHudSelect" size="1" maxlength="3" type=text value="' + GM_getValue('idHudSelect_'+getServerId(),'5') + '" /></td>\
            <TD width="89" class=xtab align="right"><INPUT id=idHudSearch type=submit value="'+lang.autoRpt.idHudSearch+'" /></td>\
            <TD width="89" class=xtab align="center"><INPUT id=idHudStart type=submit value="'+lang.autoRpt.idHudStart+'" /></td>\
            <TD width="45" class=xtab align="left"><INPUT id=idHudStop type=submit value="'+lang.autoRpt.idHudStop+'"></td>\
            <TD width="60" class=xtab align="right"><span id=repCountDown></span></td>\
            </tr></table>\
            </div>\
        <DIV id="hudResultsDiv" style="height:220px; max-height:220px; overflow:scroll;"></div><br>Beta Version.... Use at your risk ! <br>Version Beta... demandez a votre alliance avant d\'utiliser cette fonction ! MERCI POUR EUX<br>';

       ById('idHudSearch').addEventListener ('click', t.handleHudSearchOnce, false);
       ById('idHudStop').addEventListener ('click', t.abortTidTimer, false);
       ById('idHudStart').addEventListener ('click', t.startTidTimer, false);
       ById('idHudSelect').addEventListener ('change', t.handleHudSelect, false);
       ById('BOdelayField1').addEventListener ('change', t.repDelayChange, false);

    t.statusRepColorChanger();
    return this.cont;

  },
  DisplayReports : function (){
    var t = Tabs.AutoRpt;
    var data = t.data;
    var results=ById("hudResultsDiv");
    if(!t.data.length) {
       var todaysdate = Date();
       results.innerHTML = '<td><center><b> '+todaysdate+' '+lang.autoRpt.noattacks+'</b></center>';
       return;
    }
    var m = '<center><table><thead><th>Page #</th><th>Date</th><th>Attacker</th><th>Attacker<br>Coords</th><th>Alliance</th><th>Type</th><th>Target</th><th>Target<br>Coords</th></thead>';
    m += '<tbody>';
    for ( var i=0; i<t.data.length;i++) {
       var rpt = data[i];
       if (rpt.side0Name=='undefined')
          continue;

            m += '<tr><td>'+rpt.page+'</td><td>'+uW.formatDateByUnixTime(rpt.reportUnixTime)+'</td><td>'+rpt.side1Name+'</td>';
            m += "<td><a href='javascript:void(0)' onclick='cm.utils.CoordinateLinkController.onClick(event)' class='coordinateLink'>("+rpt.side1XCoord+","+rpt.side1YCoord+")</td>";
            m += ' <td>'+rpt.side1AllianceName+'</td><td>'+rpt.marchName+'</td><td>'+rpt.side0Name+'</td>';
            m += "<td><a href='javascript:void(0)' onclick='cm.utils.CoordinateLinkController.onClick(event)' class='coordinateLink'>("+rpt.side0XCoord+","+rpt.side0YCoord+")</td></tr>";
    }
    m += '</tbody></table></center>';
    results.innerHTML = m;
    for ( var i=0; i<t.data.length;i++) {
       var rpt = data[i];
          if (rpt.side0Name=='undefined')
          continue;
          if (LastUnixTime >= rpt.reportUnixTime)
          continue;
            var msg = "";
            msg += lang.autoRpt.msg;
            msg += ' Rpt:'+rpt.reportId+'';
     if (GM_getValue('TheOldMsg_'+getServerId(),'') != rpt.reportUnixTime)
     sendChat("/a " + msg); // Alliance chat
     GM_setValue('TheOldMsg_'+getServerId(),rpt.reportUnixTime)
     LastUnixTime = rpt.reportUnixTime
     }
  },

  handleHudSelect : function(rslt, page) {
    var t = Tabs.AutoRpt;
    t.maxPages=ById("idHudSelect").value;
    GM_setValue('idHudSelect_'+getServerId(),t.maxPages);
    if (parsintNan(t.maxPages)==99999)
       t.maxPages=t.totalPages;
  },
  handleHudSearchCB : function(rslt, page) {
    var t = Tabs.AutoRpt;
    if (rslt) {
       if (!rslt.ok) {
          if (ById("idSpanHudErrorMsg"))
           ById("idSpanHudErrorMsg").innerHTML = rslt.errorMsg;
          return;
       }
       t.totalPages=rslt.totalPages;
       if (rslt.arReports && page) {
         var ar = rslt.arReports;
         var rptkeys = uW.Object.keys(ar);
         var myAllianceId = getMyAlliance()[0];
         for (var i = 0; i < rptkeys.length; i++) {
              var rpt = ar[rptkeys[i]];
              rpt.page = page;
              var side0Name = rslt.arPlayerNames['p'+rpt.side0PlayerId];
              rpt.side0Name = side0Name;
              rpt.side1Name = rslt.arPlayerNames['p'+rpt.side1PlayerId];
              if (rpt.side0AllianceId > 0)
                rpt.side0AllianceName = rslt.arAllianceNames['a'+rpt.side0AllianceId];
              else
                rpt.side0AllianceName = 'unaligned';
              if (rpt.side1AllianceId > 0)
                rpt.side1AllianceName = rslt.arAllianceNames['a'+rpt.side1AllianceId];
              else
                rpt.side1AllianceName = 'unaligned';

              if (rpt.side0CityId > 0)
                rpt.side0CityName = rslt.arCityNames['c'+rpt.side0CityId];
              else
                rpt.side0CityName = 'none';
              if (rpt.side1CityId > 0)
                rpt.side1CityName = rslt.arCityNames['c'+rpt.side1CityId];
              else
                rpt.side1CityName = 'none';
              if (rpt.marchType == 1)
                  rpt.marchName = 'Transport';
              else if (rpt.marchType == 3)
                  rpt.marchName = 'Scout';
              else if (rpt.marchType == 2)
                  rpt.marchName = 'Reinforced ';
              else if (rpt.marchType == 4)
                  rpt.marchName = 'Attack';
              else rpt.marchName = 'unknown';
              if (myAllianceId != rpt.side1AllianceId)
                 t.data.push(rpt);
         }
       }
       if (parseInt(page)+1 <= t.maxPages) {
          var results=ById("hudResultsDiv");
          results.innerHTML = '<center><b>Search Page: '+(parseInt(page)+1)+'</b></center>';
          t.getAllianceReports(parseInt(page)+1);
       }
       else if (page)
           t.DisplayReports();
    }
  },
  maxPages:1,
  data:[],
  totalPages:0,
  handleHudSearch : function() {
    var t = Tabs.AutoRpt;
    tid = setTimeout(t.handleHudSearch, GM_getValue('repScanTime_'+getServerId(),120000));
    var results=ById("hudResultsDiv");
    t.maxPages=ById("idHudSelect").value;
    if ( t.maxPages==99999)
       t.maxPages=t.totalPages;
    results.innerHTML = '<center><b>Searching '+t.maxPages+' Pages!</b></center>';
    t.data=[];
    t.getAllianceReports(1);
  },
  handleHudSearchOnce : function() {
    var t = Tabs.AutoRpt;
    var results=ById("hudResultsDiv");
    t.maxPages=ById("idHudSelect").value;
    if ( t.maxPages==99999)
       t.maxPages=t.totalPages;
    results.innerHTML = '<center><b>Searching '+t.maxPages+' Pages!</b></center>';
    t.data=[];
    t.getAllianceReports(1);
  },
  startTidTimer : function() {
   var t = Tabs.AutoRpt;
   GM_setValue('ScanTidTimer_'+getServerId(),"Online");
   if (GM_getValue('delayField1_'+getServerId(),'') != "") {
    t.statusRepColorChanger();
    t.handleHudSearch();
   }
   if (GM_getValue('delayField1_'+getServerId(),'') == "") {
    alert("Enter a valid number in the Delay Box");
   }
  },
  repDelayChange : function() {
   var t = Tabs.AutoRpt;
   if (parseIntNan(ById("BOdelayField1").value)<2) ById("BOdelayField1").value=2;
   var repDelay=ById("BOdelayField1").value * 60000;
   GM_setValue('delayField1_'+getServerId(),ById("BOdelayField1").value);
   GM_setValue('repScanTime_'+getServerId(),repDelay);
  },
  abortTidTimer : function() { // to be called when you want to stop the timer
   var t = Tabs.AutoRpt;
   clearTimeout(tid);
   GM_setValue('ScanTidTimer_'+getServerId(),"Offline");
   t.statusRepColorChanger();
  },
  statusRepColorChanger : function() {
  var t = Tabs.AutoRpt;
  var selectorHud = GM_getValue('idHudSelect_'+getServerId(),'5');
  ById("idHudSelect").innerHTML = selectorHud;
  var ColorGreen = "<span style='color:Green'>" + GM_getValue('ScanTidTimer_'+getServerId(),'Offline') + "</span>";
  var ColorRed = "<span style='color:Red'>" + GM_getValue('ScanTidTimer_'+getServerId(),'Offline') + "</span>";
  if (GM_getValue('ScanTidTimer_'+getServerId(),'Offline') == "Online") {
  ById("idRepStatus").innerHTML = ColorGreen;
   }
  if (GM_getValue('ScanTidTimer_'+getServerId(),'Offline') == "Offline") {
  ById("idRepStatus").innerHTML = ColorRed;
   }
  },
  getAllianceReports : function (pageNum){
    var t = Tabs.AutoRpt;
    var params = uW.Object.clone(uW.g_ajaxparams);
    if (pageNum)
      params.pageNo = pageNum;
    params.group = "a";
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/listReports.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
          Tabs.AutoRpt.handleHudSearchCB (rslt, pageNum);
      },
      onFailure: function (rslt) {
          Tabs.AutoRpt.handleHudSearchCB (rslt, pageNum);
      },
    }, false);
  },
  show : function (){},
  hide : function (){},
};
function fixkabamlag () {
	var kfutime = Number(unsafeWindow.unixtime()+30);
	for (city in Seed.queue_atkp) {
	      var kabamhashX = [];
	      if(Seed.queue_atkp[city] != "")
	      for (march in Seed.queue_atkp[city]) {
	         if(Seed.queue_atkp[city][march].marchType)
	            if(Seed.queue_atkp[city][march].botMarchStatus == undefined && Seed.queue_atkp[city][march].marchStatus == 5) {
	               if (Seed.queue_atkp[city][march].returnUnixTime < kfutime) {
	                  for (var i=0;i<18;i++) {
	                     if (Seed.queue_atkp[city][march]['unit'+i+'Count'] > 0)
	                     if(Seed.queue_atkp[city][march]['unit'+i+'Return'] == 0 || Seed.queue_atkp[city][march]['unit'+i+'Return'] == undefined)
	                     Seed.queue_atkp[city][march]['unit'+i+'Return'] = Seed.queue_atkp[city][march]['unit'+i+'Count'];
	                  };
	                  Seed.queue_atkp[city][march].hasUpdated = true;
	                  Seed.queue_atkp[city][march].marchStatus = 8;
	               } else kabamhashX.push(Seed.queue_atkp[city][march].knightId);
	            } else kabamhashX.push(Seed.queue_atkp[city][march].knightId);
	      }
	      for (knight in Seed.knights[city]) {
	         if(Seed.knights[city][knight].knightStatus != 1)
	            if(kabamhashX.indexOf(Seed.knights[city][knight].knightId) == -1) {
	               Seed.knights[city][knight].knightStatus = 1;
	            }
	      }
   }
}


function BOcheckreq(L, A, n, E, currentcityid) {
    var z;
    if (E === 2) {
        z = uW.techcost2
    } else {
        z = uW.techcost
    }
    var F = n;
    if (L == "tch" && A != 17) {
        F = Math.min(n, 11)
    }
    var x = Math.pow(2, (F - 1));
    var l = new Array();
    for (var G = 0; G < 5; G++) {
        l[G] = new Array()
    }
    var u = new Array();
    if (L == "tch") {
        var D = z["tch" + A][8]
    } else {
        if (L == "bdg") {
            var D = uW.buildingcost["bdg" + A][8]
        } else {
            if (L == "unt") {
                var D = uW.unitcost["unt" + A][8]
            } else {
                if (L == "frt") {
                    var D = uW.fortcost["frt" + A][8]
                }
            }
        }
    }
    if (L == "bdg" && parseInt(n) > 10 && (parseInt(A) === 19 || parseInt(A) === 12 || parseInt(A) === 16 || parseInt(A) === 15 || parseInt(A) === 17 || parseInt(A) === 11 || parseInt(A) === 18 || parseInt(A) === 8 || parseInt(A) === 9 || parseInt(A) === 1 || parseInt(A) === 2 || parseInt(A) === 3 || parseInt(A) === 4)) {
        var y = getCityBuilding(currentcityid, 0).maxLevel;
        l[0].push(uW.g_js_strings.commonstr.construction);
        l[1].push(uW.g_js_strings.commonstr.lv + n + " " + uW.buildingcost.bdg0[0]);
        l[2].push(uW.g_js_strings.commonstr.lv + y + " " + uW.buildingcost.bdg0[0]);
        if (y >= parseInt(n)) {
            l[3].push(1)
        } else {
            l[3].push(0)
        }
    }
    if (D.length == null) {
        var e = Object.keys(D);
        var J = new Array();
        var v = Object.keys(Seed.buildings["city" + currentcityid]);
        for (var G = 0; G < v.length; G++) {
            var p = Seed.buildings["city" + currentcityid][v[G]];
            if (J["b" + p[0]] == null) {
                J["b" + p[0]] = parseInt(p[1])
            } else {
                J["b" + p[0]] = (p[1] > J["b" + p[0]]) ? p[1] : J["b" + p[0]]
            }
        }
        for (var G = 0; G < e.length; G++) {
            l[0].push(uW.g_js_strings.commonstr.construction);
            var K = e[G].split("b")[1];
            var d = 0;
            var s = (parseInt(J[e[G]]) > 0) ? (parseInt(J[e[G]])) : 0;
            var g = uW.buildingcost["bdg" + K][0];
            if (parseInt(D[e[G]][0]) == 1) {
                d = parseInt(D[e[G]][1])
            } else {
                d = Math.min(uW.buildingmaxlvl[K], n + parseInt(D[e[G]][1]))

            }
            if (L == "tch") {
                var t = [9, 15, 16, 17],
                    H = [5, 9, 12, 14];
                if (H.indexOf(parseInt(A)) != -1 && t.indexOf(parseInt(K)) != -1 && parseInt(n) == 11) {
                    d--
                } else {
                    if (parseInt(K) == 11) {
                        d = Math.max(d, n)
                    }
                }
            }
            l[1].push(uW.g_js_strings.commonstr.lv + d + " " + g);
            l[2].push(uW.g_js_strings.commonstr.lv + s + " " + g);
            if (s < d) {
                l[3].push(0)
            } else {
                l[3].push(1)
            }
            l[4].push(null)
        }
    }
    var I = new Array();
    if (L == "tch") {
        var a = z["tch" + A][9]
    } else {
        if (L == "bdg") {
            var a = uW.buildingcost["bdg" + A][9]
        } else {
            if (L == "unt") {
                var a = uW.unitcost["unt" + A][9]
            } else {
                if (L == "frt") {
                    var a = uW.fortcost["frt" + A][9]
                }
            }
        }
    }
    var j = Object.keys(a);
    if (a.length == null) {
        for (var G = 0; G < j.length; G++) {
            l[0].push(uW.g_js_strings.commonstr.research);
            var o = j[G].split("t")[1];
            var c = 0;
            var r = parseInt(Seed.tech["tch" + o]);
            var B = z["tch" + o][0];
            if (parseInt(a[j[G]][0]) == 1) {
                c = parseInt(a[j[G]][1])
            } else {
                c = n + parseInt(a[j[G]][1])
            }
            if (L == "bdg" && getCityBuilding(currentcityid, A).maxLevel === 10 && parseInt(A, 10) !== 18) {
                c = 10
            }
            l[1].push(uW.g_js_strings.commonstr.lv + c + " " + B);
            l[2].push(uW.g_js_strings.commonstr.lv + r + " " + B);
            if (r < c) {
                l[3].push(0)
            } else {
                l[3].push(1)
            }
            l[4].push(null)
        }
    }
    if (L == "tch") {
        var w = parseInt(z["tch" + A][5]) * x
    } else {
        if (L == "bdg") {
            var w = parseInt(uW.buildingcost["bdg" + A][5]) * x
        } else {
            if (L == "unt") {
                var w = parseInt(uW.unitcost["unt" + A][5]) * x
            } else {
                if (L == "frt") {
                    var w = parseInt(uW.fortcost["frt" + A][5]) * x
                }
            }
        }
    }
    if (w > 0) {
        l[0].push(uW.resourceinfo.rec0);
        var k = parseInt(Seed.citystats["city" + currentcityid].gold[0]);
        l[1].push(w);
        l[2].push(k);
        if (k < w) {
            l[3].push(0)
        } else {
            l[3].push(1)
        }
        l[4].push(null)
    }
    for (var G = 1; G < 5; G++) {
        if (L == "tch") {
            var m = parseInt(z["tch" + A][G]) * x * 3600
        } else {
            if (L == "bdg") {
                var m = parseInt(uW.buildingcost["bdg" + A][G]) * x * 3600
            } else {
                if (L == "unt") {
                    var h = uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().MORE_WITH_LESS, currentcityid, {
                        unitid: A
                    });
                    var m = Math.ceil(parseInt(uW.unitcost["unt" + A][G]) * h) * x * 3600
                } else {
                    if (L == "frt") {
                        var m = parseInt(uW.fortcost["frt" + A][G]) * x * 3600
                    }
                }
            }
        }
        if (m > 0) {
            l[0].push(uW.resourceinfo["rec" + G]);
            var f = parseInt(Seed.resources["city" + currentcityid]["rec" + G][0]);
            l[1].push(parseInt(parseInt(m) / 3600));
            l[2].push(parseInt(parseInt(f) / 3600));
            if (f < m) {
                l[3].push(0)
            } else {
                l[3].push(1)
            }
            switch (G) {
            case 1:
                l[4].push("Food");
                break;
            case 2:
                l[4].push("Wood");
                break;
            case 3:
                l[4].push("Stone");
                break;
            case 4:
                l[4].push("Ore");
                break
            }
        }
    }
    if (L == "tch") {
        var b = parseInt(z["tch" + A][6]) * x
    } else {
        if (L == "bdg") {
            var b = parseInt(uW.buildingcost["bdg" + A][6]) * x
        } else {
            if (L == "unt") {
                var q = uW.cm.BlessingSystemModel.applyBlessing(uW.cm.BlessingSystemModel.getBlessing().MORE_WITH_LESS, currentcityid, {
                    unitid: A
                });
                var b = Math.ceil(parseInt(uW.unitcost["unt" + A][6]) * q) * x
            } else {
                if (L == "frt") {
                    var b = parseInt(uW.fortcost["frt" + A][6]) * x
                }
            }
        }
    }
    if (b > 0) {
        l[0].push(uW.g_js_strings.commonstr.population);
        var C = parseInt(Seed.citystats["city" + currentcityid].pop[0]) - parseInt(Seed.citystats["city" + currentcityid].pop[3]);
        l[1].push(b);
        l[2].push(C);
        if (C < b) {
            l[3].push(0)
        } else {
            l[3].push(1)
        }
        l[4].push("Population")
    }
    return l
}

function fetchPlayerInfo(uid, notify){
   var uW = unsafeWindow;
   var CM = uW.cm;
   var Seed = uW.seed;
   var params = uW.Object.clone(uW.g_ajaxparams);
   params.uid = uid;
   new uW.Ajax.Request(uW.g_ajaxpath + "ajax/getUserGeneralInfo.php" + uW.g_ajaxsuffix, {
     method: "post",
     parameters: params,
     onSuccess: function (rslt) {
       fetchPlayerStatus (eval("(" + rslt.responseText + ")"),notify);
     },
     onFailure: function (rslt) {
       notify ({errorMsg:'AJAX error'});
     },
   });
};

function convertTime (datestr,AddHours){
  return parseInt (datestr.getTime() / 1000) + (AddHours*3600) + uW.g_timeoff;
}
function getDuration (datestr,AddHours){
  var Interval = convertTime(new Date(datestr.replace(" ","T")),AddHours) - uW.g_timeoff - unixTime();
  if (Interval >= 0) {
    return uW.timestr(Interval);
  }
  else {
    if (Interval > -43200) {
      return "Can't Truce for "+uW.timestr(43200 - (Interval*-1));
	}
	else {
		return "";
	}
  }
}

function fetchPlayerStatus (rsltInfo, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
	var uid = rsltInfo.userInfo[0].userId;
    params.checkArr = uid;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/getOnline.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
	    rsltInfo.online = rslt.data[uid];
        fetchCourtInfo (rsltInfo, notify);
        //notify (rsltInfo);
      },
      onFailure: function (rslt) {
        notify ({errorMsg:'AJAX error'});
      },
    });
}
function fetchCourtInfo (rsltInfo, notify){
    var params = uW.Object.clone(uW.g_ajaxparams);
	var uid = rsltInfo.userInfo[0].userId;
    params.pid = uid;
    new MyAjaxRequest(uW.g_ajaxpath + "ajax/viewCourt.php" + uW.g_ajaxsuffix, {
      method: "post",
      parameters: params,
      onSuccess: function (rslt) {
	    u = unixTime();
		f = convertTime(new Date(rslt.playerInfo.fogExpireTimestamp.replace(" ","T")),8);
	    rsltInfo.misted = (f >= u);
	    rsltInfo.fogExpireTimestamp = rslt.playerInfo.fogExpireTimestamp;
	    rsltInfo.warStatus = rslt.playerInfo.warStatus;
	    rsltInfo.truceExpireTimestamp = rslt.playerInfo.truceExpireTimestamp;
	    rsltInfo.lastLogin = rslt.playerInfo.lastLogin;
	    rsltInfo.cityCount = rslt.playerInfo.cityCount;
        notify (rsltInfo);
      },
      onFailure: function (rslt) {
        notify ({errorMsg:'AJAX error'});
      },
    });
}


/*********************************** Tableau de Board ***********************************/

function createDashboard (){
	var Dashboard = document.createElement('div');
	var beacon = ById('mod_cityinfo');
	Dashboard.id='Dash_div';
	Dashboard.style.zIndex="123450";
	Dashboard.style.position = 'relative';
	Dashboard.style.width= "400px";
  	if (Options.pbChatOnRight || Options.pbChatOnLeft) Dashboard.style.top = "-580px";
  	 else Dashboard.style.top = "-565px";
  	if (Options.pbChatOnRight) Dashboard.style.left ="1122px";
  	 else if (Options.pbChatOnLeft) Dashboard.style.left ="760px";
  	 else Dashboard.style.left ="760px";
  	if (Options.pbChatOnRight || Options.pbChatOnLeft) Dashboard.style.height = (Options.HauteurBoite)+"px";
  	 else Dashboard.style.height = (Options.HauteurBoite-70)+"px";
  	Dashboard.style.background = '#FFFFE6';
  	Dashboard.style.overflow = 'auto';

	beacon.parentNode.insertBefore(Dashboard, beacon);


}

 $.fn.drags = function(opt) {

        opt = $.extend({
            handle: "",
            cursor: "move",
            draggableClass: "draggable",
            activeHandleClass: "active-handle"
        }, opt);

        var $selected = null;
        var $elements = (opt.handle === "") ? this : this.find(opt.handle);

        $elements.css('cursor', opt.cursor).on("mousedown", function(e) {
            if(opt.handle === "") {
                $selected = $(this);
                $selected.addClass(opt.draggableClass);
            } else {
                $selected = $(this).parent();
                $selected.addClass(opt.draggableClass).find(opt.handle).addClass(opt.activeHandleClass);
            }
            var drg_h = $selected.outerHeight(),
                drg_w = $selected.outerWidth(),
                pos_y = $selected.offset().top + drg_h - e.pageY,
                pos_x = $selected.offset().left + drg_w - e.pageX;
            $(document).on("mousemove", function(e) {
                $selected.offset({
                    top: e.pageY + pos_y - drg_h,
                    left: e.pageX + pos_x - drg_w
                });
            }).on("mouseup", function() {
                $(this).off("mousemove"); // Unbind events from document
                if ($selected !== null) {
                    $selected.removeClass(opt.draggableClass);
                    $selected = null;
                }

            });
            e.preventDefault(); // disable selection
        }).on("mouseup", function() {
            if(opt.handle === "") {
                $selected.removeClass(opt.draggableClass);
            } else {
                $selected.removeClass(opt.draggableClass)
                    .find(opt.handle).removeClass(opt.activeHandleClass);
            }
            $selected = null;
             Options.DashX = $("#Dash_div").css("left");
             Options.DashY = $("#Dash_div").css("top");
             saveOptions();
        });

        return this;

    };

var Dashboard = {
    tabOrder: 800,
    tabLabel: 'Dashboard',
    myDiv : null,
    Alerts: [],
    showMarchesInfo: true,
    CityChange:false,
    summonFinishTime:0,
    init : function (div){
        var t = Dashboard;
        t.myDiv = div;
        uW.BODashCancelSacrifice=myBO.Attaque.CancelSacrifice;
        uW.BODashAddSacrifice=myBO.Attaque.addsacrifice;
        if (!DashboardOptions.showDashboard)
          return;
        createDashboard();
        var m = '<div class="boStat" id=dbHeader>'+lang.dashboard.title+'&nbsp;&nbsp;<img id=boclosedash src="'+CANCELBTN+'" border=0 title="Close"></div>';
	    m += '<DIV id=CityStatus></div>';
	    m += '<DIV id=ShowTrPresets></div>';
	    m += '<DIV id=ShowRP></div>';
	    m += '<DIV id=ShowTroops></div>';
	    m += '<DIV id=SacrificePlaceholder></div>';
	    m += '<DIV id=TowerAlertPlaceholder style="max-height:300px; height:300px; overflow-y:scroll"></div>';
        ById('Dash_div').innerHTML = m;
        ById('boclosedash').addEventListener('click', function () {
			DashboardOptions.showDashboard = false;
	    	saveDashboardOptions();
			if (ById('Dash_div')) ById('Dash_div').parentNode.removeChild(ById('Dash_div'));
			if (Options.BORac_DashBoard) updatebotbutton("Dashboard - OFF", 'bodashboardrac');
		},false);

		$("#Dash_div").drags({handle:"#dbHeader"});
		if (Options.DashX) {
				   $("#Dash_div").css({left:Options.DashX,top:Options.DashY});
	    }
    },
	showSacrifice: function(){
		var t = Dashboard;
		var now = unixTime();

		var NoSacrifice = true;
		for (var i=0;i<Seed.cities.length;i++) if (Seed.queue_sacr["city"+Seed.cities[i][0]][0]!=undefined) NoSacrifice = false;
    	if (NoSacrifice) {
    		ById('SacrificePlaceholder').innerHTML = "";
    		return;
    	}
		var msg = '<DIV class="boStat">Sacrifice</div><TABLE id=pbRPStats 100% class=pbTab>';
		for (var i=0;i<Seed.cities.length;i++){
			var cityID = Seed.cities[i][0];
			if (Seed.queue_sacr["city"+cityID][0]!=undefined) {
				 msg+='<TR><TD width=150px>'+Seed.cities[i][1]+' (1)</td><TD width=30px><img src='+gameurl+'/img/units/unit_'+Seed.queue_sacr["city"+cityID][0].unitType +'_30.jpg></td><TD width=75px>'+Seed.queue_sacr["city"+cityID][0].quantity+'</td><TD width=50px>'+timestr(Seed.queue_sacr["city"+cityID][0].eta-now)+' ('+timestr(Seed.queue_sacr["city"+cityID][0].eta-Seed.queue_sacr["city"+cityID][0].start)+')</td><td><img onclick="BODashCancelSacrifice('+cityID+',0);" src="'+CANCELBTN+'"></tr>';
				 timeleft=Seed.queue_sacr["city"+cityID][0].eta-now;
		         if(timeleft<0){ Seed.queue_sacr["city"+cityid].splice(0,1); }
			}
			if (Seed.queue_sacr["city"+cityID][1]!=undefined) {
				 msg+='<TR><TD width=150px>'+Seed.cities[i][1]+' (2)</td><TD width=30px><img src='+gameurl+'/img/units/unit_'+Seed.queue_sacr["city"+cityID][1].unitType +'_30.jpg></td><TD width=75px>'+Seed.queue_sacr["city"+cityID][1].quantity+'</td><TD width=50px>'+timestr(Seed.queue_sacr["city"+cityID][1].eta-now)+' ('+timestr(Seed.queue_sacr["city"+cityID][1].eta-Seed.queue_sacr["city"+cityID][1].start)+')</td><td><img onclick="BODashCancelSacrifice('+cityID+',1);" src="'+CANCELBTN+'"></tr></tr>';
			     timeleft=Seed.queue_sacr["city"+cityID][1].eta-now;
		         if(timeleft<0){ Seed.queue_sacr["city"+cityid].splice(1,1); }
			}


		}
		msg += '</table>';
		ById('SacrificePlaceholder').innerHTML = msg;
	},
    ShowRP: function (){
    	var t = Dashboard;
    	var msg = '<DIV class="boStat">'+uW.buildingcost.bdg12[0]+'</div><TABLE id=pbRPStats width=100% class=pbTab><TR>';
		for(i=0; i<Cities.numCities; i++) {
    		var niveauPointRall=March.RallyPoint(Cities.cities[i].id).maxSlots;
            var slots=March.RallyPoint(Cities.cities[i].id).marching;
			msg += '<TD>' + uW.roman[i] + ': (' + slots + '/' + niveauPointRall +')</td>';
			if ((i+1)%4==0) msg+='</tr><TR>';
		}
		ById('ShowRP').innerHTML = msg;
    },
    ShowTowerAlerts: function (){
    	var t = Dashboard;
    	var NoAttack = true;
    	for (k in Seed.queue_atkinc) if (Seed.queue_atkinc[k].marchType == 3 || Seed.queue_atkinc[k].marchType ==4) NoAttack = false;
    	if (NoAttack) {
    		ById('TowerAlertPlaceholder').innerHTML = "";
    		return;
    	}
    	ById('TowerAlertPlaceholder').innerHTML = '<BR><DIV class="boStatRed">'+uW.g_js_strings.modaltitles.impatks.toUpperCase()+'</div><DIV id=ShowTowerAlerts></div>'; //style="height: 100px; overflow: auto">
    	var msg = '';
    	var action = '';
    	var arrivalTime = 0;

        var sortem = [];
        for (var k in Seed.queue_atkinc)
          sortem.push (Seed.queue_atkinc[k]);

        sortem.sort (function (a,b){
          var x; if ((x = a.arrivalTime-b.arrivalTime)!=0)
            return x;
          return b.arrivalTime-a.arrivalTime;
        });
        var nb=0;
    	for (var ai=0; ai<sortem.length; ai++){
    		var now = unixTime();
    		var counter = 0;

			var m = sortem[ai];
			var zz="";
    		if (m.fromPlayerId != uW.tvuid && m.arrivalTime > now) {
				nb++;
				var aa=0;for (postcity in Seed.cities){aa++;if (Seed.cities[postcity][0] == m.toCityId) { cityName = '' + aa +'-'+Seed.cities[postcity][1];break;}}
				if (m.marchType == 3) action = uW.g_js_strings.commonstr.scout;
				if (m.marchType == 4) action = uW.g_js_strings.commonstr.attack;
				arrivalTime = m.arrivalTime - now;
				zz = cityName + ': ' + action + ' -- <a href="javascript:void(0);" onclick=boshowthrone('+m.pid+',"'+Seed.players['u'+m.pid].n+'","Calc");>'+Seed.players['u'+m.pid].n +'</a> -- ETA: ' + timestr(arrivalTime);
				zz +='<BR><TABLE class=pbTab width=100%><TR>';
				var nbunit=0;
				for (z in m.unts) {
				  if (parseIntNan(m.unts[z]) > 0) {
						if (counter%4==0) zz+='</tr><TR>';
						counter++;
						nbunit+=parseInt(m.unts[z]);
						var uid = parseInt(z.substr(1));
						zz+='<TD width=30px><img src='+gameurl+'img/units/unit_'+uid+'_30.jpg></td><TD width=80px>' + m.unts[z] + '</td>';
					}
				}
				zz+='</tr></table>';
				if (nbunit < DashboardOptions.TowerMin) zz="";
				msg += zz;

			}
		  if (nb>9)
		   break;
    	}
    	ById('ShowTowerAlerts').innerHTML = msg;
    },
    CityStatus: function (){
    	var t = Dashboard;
    	var msg = '<DIV class="boStat">'+lang.dashboard.status+'</div><TABLE id=pbRPStats width=100% class=pbTab><TR>';
    	for(b=0; b<Cities.numCities; b++) msg+= '<TD><INPUT type=submit id="cityDEF_' + Seed.cities[b][0] + '" value="'+uW.roman[b]+'"></td>';
    	ById('CityStatus').innerHTML = msg;
    	for(b=0; b<Cities.numCities; b++) {
    		if (parseInt(Seed.citystats["city" + Seed.cities[b][0]].gate) == 0) ById('cityDEF_' + Seed.cities[b][0]).style.backgroundColor  = "green";
    			else ById('cityDEF_' + Seed.cities[b][0]).style.backgroundColor  = "red";
    		ById('cityDEF_' + Seed.cities[b][0]).style.color  = "white";
    		ById('cityDEF_' + Seed.cities[b][0]).addEventListener ('click', function(){
	    		var city = this.id.substr(8);
	    		if (parseInt(Seed.citystats["city" + city].gate) == 0) t.ChangeDefMode(city,1);
	    		if (parseInt(Seed.citystats["city" + city].gate) == 1) t.ChangeDefMode(city,0);
      		},false);
    	}
    },

    ChangeDefMode : function (cityId, state){
    	var t = Dashboard;
        var params = uW.Object.clone(uW.g_ajaxparams);
        params.cid = cityId;
        params.state = state;
        new MyAjaxRequest(uW.g_ajaxpath + "ajax/gate.php" + uW.g_ajaxsuffix, {
            method: "post",
            parameters: params,
            onSuccess: function (rslt) {
                if (rslt.ok) {
                    Seed.citystats["city" + cityId].gate = state;
                    if(rslt.updateSeed){uW.update_seed(rslt.updateSeed)};
                }
            },
            onFailure: function () {
            }
        })
  	},
    ShowTroops: function (){
    	var t = Dashboard;
    	var msg = '<DIV class="boStat">'+uW.g_js_strings.commonstr.troops+'</div>';
    	msg+= '<SPAN id=dbCityCel></span>&nbsp&nbsp&nbsp<INPUT type=submit class=pbButton id="HideTroops" value="Hide"><BR><DIV id=dbCityInfo></div>';
    	ById('ShowTroops').innerHTML = msg;
    	t.tcp = new CdispCityPicker ('dbCityCelBut', ById('dbCityCel'), true, t.PaintTroops);
    	ById('HideTroops').addEventListener ('click', function(){ById('dbCityInfo').innerHTML = "";t.tcp = new CdispCityPicker ('dbCityCelBut', ById('dbCityCel'), true, t.PaintTroops)},false);
    },
    ShowTrPresets: function (){
	    	var t = Dashboard;
	    	var msg = '<DIV class="boStat">'+lang.dashboard.preset1+'</div><TABLE id=pbThroneTr width=100% class=pbTab><TR>';
	    	for (i=1;i<=8;i++) {
	    			var total = 0;
	    			var active =0;
	    			var what="";
	    			for (j=1;j<Tabs.Throne.EquipType.length;j++) {
	    				what = Tabs.Throne.EquipType[j];
	    				id = ThroneOptions.Presets[i][what.toLowerCase()];
	    				if (what == "Chair") what = uW.g_js_strings.throneRoom.chair;
						if (what == "Windows") what = uW.g_js_strings.throneRoom.window;
						if (what == "Table") what = uW.g_js_strings.throneRoom.table;
						if (what == "Trophy") what = uW.g_js_strings.throneRoom.trophy;
						if (what == "Advisor") what = uW.g_js_strings.throneRoom.advisor;
						if (what == "Candelabrum") what = uW.g_js_strings.throneRoom.candelabrum;
						if (what == "Hero") what = uW.g_js_strings.throneRoom.hero;
     			    	if (what == "Banner") what = uW.g_js_strings.throneRoom.banner;
	     				if (uW.kocThroneItems[id] != undefined && uW.kocThroneItems[id].isEquipped) active++;
	     				if (id > 0) total++;
	    			}
	    			if (active == total) msg+= '<TD align="center"><B>'+active+'/'+total+'</b></td>';
	    				else msg+= '<TD align="center">'+active+'/'+total+'</td>';
	    			var stats = renderLocalPresetStats(i);
	    			msg+= '<TD><a class=hasTooltip><INPUT type=submit class=pbButton id="Preset_' + i + '" value="'+ThroneOptions.BOPresetName[i]+'"><SPAN>'+stats+'</span></a></td>';
	    			if (i%4==0) msg+='</tr><TR>';
	    	}
	    	msg += '</tr></table>';
	    	msg += '<DIV class="boStat">'+lang.dashboard.preset2+'</div><TABLE class=pbTab><TR>';
	    	for (var i=1;i<=Seed.throne.slotNum;i++) {
	    		msg+='<TD style="width:30px"><a class=hasTooltip><INPUT type=submit class=pbButton id="KabamPreset_' + i + '" value="'+i+'-'+ThroneOptions.presetname[i]+'"><SPAN id="KabamPresetHover'+i+'"></span></a></td>';
	    		if (i%4==0) msg+='</tr><TR>';
	    	}
	    	msg += '</tr></table>';
	    	ById('ShowTrPresets').innerHTML = msg;
			for (i=1;i<=8;i++) ById('Preset_' + i).addEventListener ('click', function(){Tabs.Throne.EquipPreset(this.id.substr(7))},false);
			for (i=1;i<=Seed.throne.slotNum;i++) {
				if (ById('KabamPreset_'+i)) ById('KabamPreset_' + i).addEventListener ('click', function(){Tabs.Throne.doPreset(this.id.substr(12))},false);
				if (i==Seed.throne.activeSlot && ById('KabamPreset_'+i)) ById('KabamPreset_'+i).setAttribute("class", "pbButton_selected");
				renderKabamPresetStats(i);
			}
    },

    PaintTroops: function (){
    	var t = Dashboard;
    	uW.BOGoHome = Tabs.Marches.butSendHome;
    	var info ='Qte: <input type=text size=5 value="1000" id=BODashQteSac>&nbsp;<span id=BODashTimeSac></span><br><TABLE id=pbRPStats width=100% class=pbTab><TR>';
    	for (l in Seed.units['city' + t.tcp.city.id]) {
			if (l.substr(3)>0)
    	    	info+= '<TD style="width: 30px;"><img src='+gameurl+'img/units/unit_'+ l.substr(3) +'_30.jpg onclick=BODashAddSacrifice('+t.tcp.city.id+','+l.substr(3)+',document.getElementById("BODashQteSac").value);></td><TD style="vertical-align: middle;">' + addCommas(Seed.units['city' + t.tcp.city.id][l]) +'</td>';

    		if (l.substr(3)%4==0) info+='</tr><TR>';
    	}
    	// renforts
    	enc = {};
    	if(Seed && Seed.queue_atkinc) {
		       var sortem = [];
		       for (var k in Seed.queue_atkinc)
		          sortem.push (Seed.queue_atkinc[k]);

		        sortem.sort (function (a,b){
		          var x; if ((x = a.arrivalTime-b.arrivalTime)!=0)
		            return x;
		          return b.arrivalTime-a.arrivalTime;
       		 });
        for (i=0; i<sortem.length; i++){
		          var m = sortem[i];
		            if (m.marchType == 2){
				  	            city = m.toCityId;
				  	            from = m.fromPlayerId;
				  	            if (!enc[city])
				  	              enc[city] = {};
				  	            if (!enc[city][from])
				  	              enc[city][from] = [];
				  	            rr = {};
				  	            rr.from = from;
				  	            rr.city = city;
				  	            rr.knight = parseInt (m.knightCombat);
				  	            rr.marchId = k.substr(1);
				  	            rr.destinationUnixTime= m.destinationUnixTime;
				  	            rr.fromXCoord = m.fromXCoord;
				  	            rr.fromYCoord = m.fromYCoord;
				  	            rr.troops = [];
				  	            var pp=0;
				  	  		    for (y in uW.unitcost) {
				  	  				pp++;
				  	              if (parseInt (m['unit'+ pp +'Return'])>0)
				  	                rr.troops[pp] = parseInt (m['unit'+ pp +'Return']);
				  	              else
				  	                rr.troops[pp] = parseInt (m['unit'+ pp +'Count']);
				  	            }
				  	            enc[city][from].push (rr);
	          }
		  }
    	var emb = getCityBuilding(t.tcp.city.id, 8);
    	if (enc[t.tcp.city.id] && emb.count>0){
		info+= "</table><DIV id=BODBAmb class=boStat>"+lang.TowerAlerts.ambassy+"</div><table>";
			for (p in enc[t.tcp.city.id]){
			  try {
				 player = Seed.players['u'+p].n;
			  } catch (err){
				  player = '???';
	          }
			  for (m=0; m<enc[t.tcp.city.id][p].length; m++){
	                var march = enc[t.tcp.city.id][p][m];
	                if (march.knight > 0) kni=player +" ("+march.knight+")";
	                arrivedans = uW.timestr(parseInt(march.destinationUnixTime - unixTime()));
	  		        arrivedanssec = parseInt(march.destinationUnixTime - unixTime());
	           if (arrivedanssec<=0) {
				   butt='<img src="'+CANCELBTN+'" onclick="BOGoHome('+ march.marchId +')">';
			   }else{
				   butt=   arrivedans;
			   }

    	     info+= "<tr><td>"+butt+"</td><td>"+ kni +"</td><td>";
    	     var i=0;
    	     for (y in uW.unitcost) {
			 	 i++;
			    if (parseInt(march.troops[i]) > 0)
			 	  info+= ''+ addCommas(march.troops[i])  +' '+ uW.unitcost[y][0].substring(0,18) +'<br>';
	          }
    	     info+="</td></tr>";

		    }
	       }
	      }
	    }
    	ById('dbCityInfo').innerHTML = info;
    	ById("BODashTimeSac").innerHTML=uW.timestr((uW.cm.AltarModel.getBuffDuration(null, ById("BODashQteSac").value, uW.cm.TIME.SECONDS)).toFixed(0));
    	ById("BODashQteSac").addEventListener ('change', function() {
			ById("BODashTimeSac").innerHTML=uW.timestr((uW.cm.AltarModel.getBuffDuration(null, ById("BODashQteSac").value, uW.cm.TIME.SECONDS)).toFixed(0));
		}, false);
    },

    show: function (){},

    hide : function (){}
}
function renderKabamPresetStats(slot){
	var StatEffects = [];
	var m="";
	for (var k in uW.cm.thronestats.effects) StatEffects[k] = 0;
	for (var k in uW.kocThroneItems){
		y = uW.kocThroneItems[k];
    	for (var ii=0;ii<Seed.throne.slotEquip[slot].length;ii++) if(Seed.throne.slotEquip[slot][ii] == y.id) for (var i=1;i<=5;i++) {
		   id = y["effects"]["slot"+i]["id"];
		   tier = parseInt(y["effects"]["slot"+i]["tier"]);
		   level = y["level"];
		   if (uW.cm.thronestats.tiers[id][tier])p = uW.cm.thronestats.tiers[id][tier];
		   else p = uW.cm.thronestats.tiers[id][tier-1];
		   Current = p.base + ((level * level + level) * p.growth * 0.5);
		   if (i<=parseInt(y.quality)) StatEffects[id] += Current
		}
	}
	for (k=1;k<StatEffects.length;k++) if (StatEffects[k] != 0) m+= StatEffects[k] + '% '+uW.cm.thronestats["effects"][k]["1"]+ '<br>';
	if (ById('KabamPresetHover'+slot)) ById('KabamPresetHover'+slot).innerHTML = m;
	if (ById('KabamPresetHover_Chat'+slot)) ById('KabamPresetHover_Chat'+slot).innerHTML = m;
}

function renderLocalPresetStats(preset){
	var StatEffects = [];
	var m="";
	for (var k in uW.cm.thronestats.effects) StatEffects[k] = 0;
	for (var k in ThroneOptions.Presets[preset]){
		if (ThroneOptions.Presets[preset][k]!=0) {
			y = uW.kocThroneItems[ThroneOptions.Presets[preset][k]];
			if (y) {
	    	for (var i=1;i<=5;i++) {
			   id = y["effects"]["slot"+i]["id"];
			   tier = parseInt(y["effects"]["slot"+i]["tier"]);
			   level = y["level"];
			   if (uW.cm.thronestats.tiers[id][tier])p = uW.cm.thronestats.tiers[id][tier];
			   else p = uW.cm.thronestats.tiers[id][tier-1];
			   Current = p.base + ((level * level + level) * p.growth * 0.5);
			   if (i<=parseInt(y.quality)) StatEffects[id] += Current
			}
		}
		}
	}
	for (k=1;k<StatEffects.length;k++) if (StatEffects[k] != 0) m+= StatEffects[k] + '% '+uW.cm.thronestats["effects"][k]["1"]+ '<br>';
	return m;
}

function eachSecond (){
	Seconds++;
	//GMTclock
	if (Seconds%2==0 && Options.gmtClock) gmtClock.everySecond();
	// Refresh Every
	if (Seconds%5==0 && Options.pbEveryEnable) RefreshEvery.Paint();
	//Show Player & Might in map.
	if (Seconds%2==0 && Options.MapShowExtra) DrawLevelIcons();
	//Auto Build
	if (Seconds%5==0 && Options.buildStates.running ) Tabs.build.paintBusyDivs();
	// Dashboard
	if (DashboardOptions.showDashboard) {
	 //if ( DashboardOptions.showWarnings) Dashboard.CheckForAlerts();
	 if (Seconds%2==0 && DashboardOptions.showRP) Dashboard.ShowRP();
	 if (Seconds%2==0 && DashboardOptions.showStatus) Dashboard.CityStatus();
 	 if (Seconds%2==0 && DashboardOptions.showTower) Dashboard.ShowTowerAlerts();
 	 if (Seconds%2==0 && DashboardOptions.showSacrifice) Dashboard.showSacrifice();
 	 if (ById("BODBAmb") && Seconds%4==0) Dashboard.PaintTroops();
 	 if (Seconds==2){
		 	Dashboard.ShowTroops();
		 	if (DashboardOptions.ShowThrone) setTimeout(Dashboard.ShowTrPresets,1000);
	  }
    }
	// Tower Alert
	if (Seconds%2==0) Tabs.Options.eachSecond();
	// Crest Report !
	if (Options.crestRunning  && Options.crestreport && Seconds%60==0) Tabs.Crest.sendCrestReport();
	if (Seconds==5) Tabs.Crest.Rounds(1,0,0,0);
	// Ameliorations du tchat
	if ((Options.HelpRequest || Options.ChatRules || Options.DeleteRequest) && Seconds%3==0) ChatPane.HandleChatPane();
	// Throne Room Timers
	if (salvageData.salvageActive && Seconds%5==0) Tabs.Throne.S2doSalvage();
    if (ThroneOptions.Active && Seconds%5==0) Tabs.Throne.setActionTimer=setTimeout(Tabs.Throne.doAction,500);
    if (Seconds%2==0) Tabs.Throne.repairTimerUpdate();
	// Auto-delete Reports
	if (Seconds%(Options.DeleteTimerMinute*60)==0) DeleteReports.startdeletereports();
	if (Seconds == 10) DeleteReports.startdeletereports();
	// Fix Kabam Lag
	if (Seconds%60==0) new fixkabamlag();
	//Food Alert
	if (Seconds%120==0) FoodAlerts.e_eachMinute();
	//Apothecary Tab
	if (ApothecaryOptions.Active && Seconds%30==0) Tabs.Apothecary.loop();

	if (Seconds%320==0 && Options.RefreshSeed) RefreshSeed();

	if (Seconds%5==0 && Options.loginReward && ById("dailyRewardModalButton")) {
		 $("#dailyRewardModalButton").click();
	}
	var x = document.getElementsByClassName('cmModalContainer guardian_generic undefined cmModal1');
	if(!x) x = document.getElementsByClassName('cmModalContainer guardian_generic undefined cmModal2');
	if(!x) x = document.getElementsByClassName('cmModalContainer guardian_generic undefined cmModal3');
	if(x)
	 if(x.length > 0) {
						for(y = 0; y < x.length;y++) {
							if(String(x[y].innerHTML).indexOf("You have Kingdoms of Camelot open in a newer window. If you have multiple connections to the same world open, please use your most recent window for the best experience and close this one.") > -1){
								uW.cm.ModalManager.close();
							}
						};
	}
}


BAOStartup ();
function getMaxLoad(unitType,unitCount) {
    var load = 0;
    var techLoadBoost = parseInt(Seed.tech.tch10) * 0.1;
    var unit_number = unitCount;
    var loadEffectBoost = 0;
    if (Seed.playerEffects.loadExpire > unixTime()) loadEffectBoost = 0.25
    var TRload = uW.cm.ThroneController.effectBonus(6);
    if (unitType == 10 || unitType == 11 || unitType == 12) TRload += uW.cm.ThroneController.effectBonus(59) ;
     else if (unitType == 7 || unitType == 8) TRload += uW.cm.ThroneController.effectBonus(48);
	if (TRload > 500) TRload = 500;
    var loadBoost = (TRload * 0.01) + loadEffectBoost + techLoadBoost;
    load += unit_number * parseInt(uW.unitstats['unt'+unitType][5]) * (1 + loadBoost);
    return (parseInt(load));
};
function RefreshSeed(){
	var params = uW.Object.clone(uW.g_ajaxparams);

	new AjaxRequest(uW.g_ajaxpath + "/fb/e2/src/main_src.php?g=&y=0&n=nan001&l=nl_NL&messagebox=&standalone=0&res=1&iframe=1&lang=en&ts=1304248288.7067&s=250&appBar=" + uW.g_ajaxsuffix, {
	    method: "POST",
	    parameters: params,
	    onSuccess: function (rslt) {
	        var mainSrcHTMLCode = rslt.responseText;
	    	var myregexp = /var seed=\{.*?\};/;
	    	var match = myregexp.exec(mainSrcHTMLCode);
	    	if (match != null) {
	    		result = match[0];
	    		result = result.substr(4);
	    		var seed = eval(result);
	    		uW.document.seed = seed;
	    		Seed = seed;
	    		uW.seed = seed;
	    		updatebotbutton("Update OK :)", "BOSeedRefresh");
	    		setTimeout(unsafeWindow.update_seed_ajax, 250);
	    		setTimeout(function(){updatebotbutton('Refresh Seed', 'BOSeedRefresh')}, 5000);

	    	}
	    },
	    onFailure: function () {
	      if (notify != null)
	        notify(rslt.errorMsg);
	    },
	});
}