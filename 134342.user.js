// ==UserScript==
// @name                    MAM - features
// @namespace               tag:unwelcome@MAM,2012-5-25:MAM
// @description             Additions to MAM
// @version					0.2.1.21
// @include					http://www.myanonamouse.net/*
// @include					http://www.myanonamouse.net:84/*
// @include					https://www.myanonamouse.net/*
// @include					https://www.myanonamouse.net:84/*
// @downloadURL             https://userscripts.org/scripts/source/134342.user.js
// @updateURL               http://userscripts.org.nyud.net/scripts/source/134342.meta.js
// @grant                   GM_info
// @grant					GM_xmlhttpRequest
// ==/UserScript==
function cmpVersion(e,t){"use strict";if(e===t)return 0;var n=e.toString().split(".");var r=t.toString().split(".");var i;for(var s=0;s<n.length&&s<r.length;s++){i=parseInt(n[s],10)-parseInt(r[s],10);if(i>0){return 1}else if(i<0){return-1}}i=n.length-r.length;return i>0?1:i<0?-1:0}function openHTML(openURL,funct,XMLDoc,postData,postType){console.log(funct);var xmlHttp;if(window.XMLHttpRequest){xmlHttp=new XMLHttpRequest}else window.timeOut=4;if(window.timeOut>3){window.timeOut=3;if(typeof window.exStatus!="undefined"){var pts=/(\d+)/.exec(funct);exchangeErr(pts[1],"Communication Error: "+window.errType);return}if(typeof picks!="undefined"){var cycle=/\((\d),/.exec(funct)[1];var torrId=/,(\d+?),/.exec(funct)[1];var IDs=/,(\[.*?)\)/.exec(funct)[1];console.log("C: "+cycle+" Id: "+torrId+" IDs: "+IDs);applyFreeLeech(cycle,torrId,eval(IDs),1);return}if(typeof currHarvest!="undefined"){var remaining=/,(.*)\)/.exec(funct)[1];if(window.harvestErrArray.length<5)reapPicks(0,remaining,1);else alert("Connection Error. Try again later.");return}console.log("Connection Error");return}if(postData){xmlHttp.open("POST",openURL,true);if(postType==1){var boundary="---------------------------"+Math.random().toString().substr(4);var multipart="";xmlHttp.setRequestHeader("Content-type","multipart/form-data; boundary="+boundary);var name;for(i=0;i<postData.length;i++){if(postData[i][0]=="nfo"){name='name="nfo"; filename="'+postData[i][1]+'"\r\nContent-Type: application/octet-stream'}else name='name="'+postData[i][0]+'"';multipart+="--"+boundary+"\r\nContent-Disposition: form-data; "+name+"\r\n\r\n"+postData[i][1]+"\r\n"}multipart+="--"+boundary+"--\r\n";postData=multipart}else xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlHttp.setRequestHeader("Content-length",postData.length);xmlHttp.setRequestHeader("Connection","close")}else xmlHttp.open("GET",openURL,true);xmlHttp.onload=function(){if(xmlHttp.status==200){var blah=new Date;if(typeof XMLDoc=="string")eval(XMLDoc+"= ("+xmlHttp.responseText+")");else{try{XMLDoc.innerHTML=xmlHttp.responseText}catch(e){XMLDoc=xmlHttp.responseText}}var moo=new Date;console.log("time to load XMLDoc: "+(moo.getTime()-blah.getTime()));if(typeof window.exStatus!="undefined"&&postData&&!xmlHttp.getResponseHeader("refresh")){var pts=/(\d+)/.exec(funct);getBonusPts(0);exchangeErr(pts,"Not enough points.");return}window.timeOut=0;window.errType="Unknown";eval(funct)}else{window.timeOut++;window.errType=xmlHttp.status+"@"+xmlHttp.readyState+" - "+xmlHttp.getResponseHeader("Content-Type");console.log("err1");setTimeout(function(){openHTML(openURL,funct,XMLDoc,postData)},1500);return}};xmlHttp.onerror=function(){window.timeOut++;window.errType=xmlHttp.status+"@"+xmlHttp.readyState+" - "+xmlHttp.getResponseHeader("Content-Type");console.log("err2");setTimeout(function(){openHTML(openURL,funct,XMLDoc,postData)},1500);return};xmlHttp.send(postData)}function commafy(e){var t=(e+"").split("."),n=t[1]||"",e=t[0].replace(/(\d)(?=(\d{3})+\b)/g,"$1,");return n?e+"."+n:e}function editCookie(e){document.cookie="MAMFeatures="+e+"; expires=Fri, 31 Jan 2020 12:00:00 UTC; path=/"}function readCookie(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null}function outerHTML(e){return e.outerHTML||function(e){var t=document.createElement("div"),n;t.appendChild(e.cloneNode(true));n=t.innerHTML;t=null;return n}(e)}function _listValues(){var e=[];for(i=0;i<localStorage.length;i++){e[i]=localStorage.key(i)}return e}function _deleteValue(e){localStorage.removeItem(e)}function _setValue(e,t){localStorage.setItem(e,t)}function _getValue(e,t){var n=localStorage.getItem(e);if(!n)n=t;return n}function timestamp(){var e=new Date;var t=e.getMonth()+1;var n=e.getMinutes();if(n<10)n="0"+n;var r=e.getHours();var i;if(r>11)i="PM";else i="AM";if(r>12)r=r-12;if(r<10)r="0"+r;return r+":"+n+i+" "+t+"-"+e.getDate()}function htmlDecode(e){var t=document.createElement("textarea");t.innerHTML=e;return t.value}function bytesToSize(e,t){if(!t)t=0;var n=1024;var r=n*1024;var i=r*1024;var s=i*1024;if(e>=0&&e<n){return e+" B"}else if(e>=n&&e<r){return(e/n).toFixed(t)+" KB"}else if(e>=r&&e<i){return(e/r).toFixed(t)+" MB"}else if(e>=i&&e<s){return(e/i).toFixed(t)+" GB"}else if(e>=s){return(e/s).toFixed(t)+" TB"}else{return e+" B"}}function setuClass(e){if(e){window.uClass=parseInt(window.jsonLoad.class);_setValue("uClass",uClass);_setValue("uClassUpdateTime",now.getTime().toString())}else{window.uClass=_getValue("uClass",null);var t=_getValue("uClassUpdateTime",0);t=parseInt(t)+3600*1*1e3;if(now.getTime()>t||window.uClass==null){window.detailsXMLDoc=document.createElement("html");openHTML("/jsonLoad.php","setuClass(1)","window.jsonLoad")}}window.isStaff=window.uClass>=55}function startUpdateTorrList(){var torrListUpdateTime=_getValue("torrListUpdateTime",0);torrListUpdateTime=parseInt(torrListUpdateTime)+3600*2*1e3;window.torrList=[];if(now.getTime()>torrListUpdateTime){window.updateTorrListLeechXMLString={};window.updateTorrListSeedXMLString={};window.updateTorrListNoSeedXMLString={};window.updateTorrListDormantXMLString={};window.updateTorrListCount=0;openHTML("/snatched_detail.php?cat=AnyLeeching","updateTorrList('leech')",window.updateTorrListLeechXMLString);openHTML("/snatched_detail.php?day=-1&rat=-1&cat=Seed","updateTorrList('seed')",window.updateTorrListSeedXMLString);openHTML("/snatched_detail.php?day=-1&rat=-1&cat=NoSeed","updateTorrList('recent')",window.updateTorrListNoSeedXMLString);openHTML("/dormant_detail.php?day=-1&rat=-1&cat=NoSeed","updateTorrList('dormant')",window.updateTorrListDormantXMLString)}else window.torrList=eval("("+_getValue("torrList","[]")+")")}function updateTorrList(e){if(e=="leech"){var t=pullIdsFromSummaryPage(window.updateTorrListLeechXMLString,0);if(t==="err")window.updateTorrListCount=10}else if(e=="seed"){var t=pullIdsFromSummaryPage(window.updateTorrListSeedXMLString,1);if(t==="err")window.updateTorrListCount=10}else if(e=="recent"){var t=pullIdsFromSummaryPage(window.updateTorrListNoSeedXMLString,2);if(t==="err")window.updateTorrListCount=10}else if(e=="dormant"){var t=pullIdsFromSummaryPage(window.updateTorrListDormantXMLString,3);if(t==="err")window.updateTorrListCount=10}window.updateTorrListCount++;if(window.updateTorrListCount>4){_deleteValue("torrList");_setValue("torrListUpdateTime",now.getTime().toString())}if(window.updateTorrListCount==4){_setValue("torrList",JSON.stringify(window.torrList));_setValue("torrListUpdateTime",now.getTime().toString())}}function pullIdsFromSummaryPage(e,t){var n=new Date;var r=new RegExp("\\Wdetails\\.php\\?id=(\\d+)","gm");try{var i;while((i=r.exec(e.innerHTML))!=null){window.torrList[parseInt(i[1])]=t}}catch(s){console.log(s);return"err"}var o=new Date;console.log(o.getTime()-n.getTime());return}function createToggleSbBookmark(e,t){return function(){if(sbSavedBm==t){_setValue("sbBm",null);e.parentNode.parentNode.setAttribute("style","background-color: inherit;");window.history.go(0)}else{_setValue("sbBm",t);window.history.go(0)}}}function contextMenus(){var e=document.getElementsByTagName("a");var t="";var n;var r;for(i=0;i<e.length;i++){var s=/userdetails.php\?id=(\d+)$/.exec(e[i].href);if(s){t="";n=document.createElement("span");n.id="userLink"+i;n.setAttribute("contextmenu","contextMenu"+i);n.setAttribute("style","position:relative;");n.innerHTML=e[i].outerHTML;e[i].parentNode.replaceChild(n,e[i]);r=document.createElement("menu");r.type="context";r.id="contextMenu"+i;if(features.contextMenu2){e[i].addEventListener("contextmenu",createCMEvent(i,s[1]),false);t="<menuitem label='Snatch Summary' id='SS"+i+"' onClick=\"window.open('/snatch_summary.php?id="+s[1]+"', '_blank');\"></menuitem>"}if(features.contextMenu1)t+="<menuitem label='Send Message' onClick=\"window.open('/sendmessage.php?receiver="+s[1]+"', '_blank');\"></menuitem>";if(features.contextMenu1){var o=e[i].innerHTML.replace(/<.+?>|'|"/g,"");t+="<menuitem label='Gift 200pts' onClick=\"var pForm = document.createElement('form'); document.getElementsByTagName('body')[0].appendChild(pForm); pForm.setAttribute('method','post'); pForm.setAttribute('action','mybonus.php?exchange=1'); inA = document.createElement('input'); inA.setAttribute('name','option'); inA.setAttribute('value','7'); inB = inA.cloneNode(true); inB.name = 'art'; inB.setAttribute('value','gift_1'); inC = inA.cloneNode(true); inC.name = 'username'; inC.setAttribute('value','"+o+"'); inD = inA.cloneNode(true); inD.name = 'bonusgift'; inD.setAttribute('value','200.0'); pForm.appendChild(inA); pForm.appendChild(inB); pForm.appendChild(inC); pForm.appendChild(inD); pForm.submit()\"></menuitem>"}r.innerHTML=t;e[i].parentNode.appendChild(r)}}}function createCMEvent(e,t){return function(){openHTML("/jsonLoad.php?hnr=true&id="+t,"CMReds("+e+")","window.jsonLoad")}}function CMReds(e){var t=window.jsonLoad.hnr.toFixed(0);var n=parseInt(window.jsonLoad.totalTors);var r=parseInt(window.jsonLoad.seed_un);var i=parseInt(window.jsonLoad.inact_un);var s=parseInt(window.jsonLoad.dorm_un);var o=document.getElementById("userLink"+e);if(t>=0){var u=document.createElement("div");u.setAttribute("class","perDiv");var a=document.createElement("div");var f=document.createElement("div");var l=document.createElement("div");var c=document.createElement("div");var h=document.createElement("div");var p="rgba(100, 217, 40, 0.8)";var d="rgba(255, 230, 20, 0.8)";var v="rgba(232, 158, 48, 0.8)";var m="rgba(255, 0, 0, 0.8)";var g={top:-18,left:2};u.setAttribute("style","position:absolute; z-index: 100; top:"+g.top+"px; left:"+g.left+"px; line-height:18px; font-family: arial; height: 18px; font-size:11px; width:55px; text-align:center; font-weight:600; overflow:hidden; border-radius:2px;");a.setAttribute("style","display:inline; position:absolute; left:0px; top:0; z-index: 80; background-color:"+d+"; height: 18px;");f.setAttribute("style","position:absolute;  z-index: 80;  top:0; background-color:"+v+"; height: 18px; ");l.setAttribute("style","position:absolute; z-index: 80;  top:0; background-color:"+m+"; height: 18px;");c.setAttribute("style","position:absolute; z-index: 80;  top:0; background-color:"+p+"; height: 18px;");h.setAttribute("style","position:absolute; z-index: 90; width: 55px; top:0; height: left:0;");h.innerHTML=t+"% HnR";var y=55;a.style.width=(y*(r/n)).toFixed(0)+"px";f.style.width=(y*(i/n)).toFixed(0)+"px";f.style.left=a.style.width;l.style.width=(y*(s/n)).toFixed(0)+"px";l.style.left=parseInt(a.style.width.slice(0,-2))+parseInt(f.style.width.slice(0,-2))+"px";c.style.width=(y*(1-(s+i+r)/n)).toFixed(0)+"px";c.style.left=parseInt(a.style.width.slice(0,-2))+parseInt(f.style.width.slice(0,-2))+parseInt(l.style.width.slice(0,-2))+"px";if(n==0)u.style.backgroundColor="rgba(255,255,255, 0.8)";u.appendChild(a);u.appendChild(f);u.appendChild(l);u.appendChild(c);u.appendChild(h);o.appendChild(u);document.getElementsByTagName("body")[0].addEventListener("click",CMClose,false)}}function CMClose(){var e=document.getElementsByClassName("perDiv");while(e.length>0){e[0].parentNode.removeChild(e[0]);e=document.getElementsByClassName("perDiv")}document.getElementsByTagName("body")[0].removeEventListener("click",CMClose,false)}function optionsLink(){var e=document.getElementsByClassName("copyright")[0];e.innerHTML='Change "MAM Features" Options';e.setAttribute("style","color:#555; text-decoration:underline; cursor:pointer; font-weight:400; padding-left:6px; padding-right:.5em;");e.parentNode.parentNode.setAttribute("valign","center");e.parentNode.parentNode.style.width="15%";e.addEventListener("click",function(){changeOptions()},false);window.staffMsg2Td=document.createElement("td");window.staffMsg2Td.setAttribute("class","navpic");window.staffMsg2Td.setAttribute("nowrap","nowrap");window.staffMsg2Td.setAttribute("valign","center");window.staffMsg2Td.setAttribute("style","width:25%; text-align:center;");window.srchTd=window.staffMsg2Td.cloneNode(true);window.srchTd.setAttribute("style","width:25%");var t=window.staffMsg2Td.cloneNode(true);t.setAttribute("style","width:5%; text-align:center;");window.staffMsgTd=window.staffMsg2Td.cloneNode(true);window.staffMsgTd.setAttribute("style","width:30%; text-align:center;");e.parentNode.parentNode.parentNode.appendChild(window.staffMsg2Td);window.staffMsg2Td.parentNode.appendChild(window.srchTd);window.staffMsg2Td.parentNode.appendChild(t);window.staffMsg2Td.parentNode.appendChild(window.staffMsgTd);if(updateGM){var n=document.createElement("a");n.innerHTML="Please update Greasemonkey";n.setAttribute("style","padding-left:.4em; border-left: 1px solid black; color:maroon; font-size:10px;");n.href="https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/";e.parentNode.appendChild(n)}}function changeSearch(){var e=document.getElementById("srchSelect");var t=document.getElementById("usersearch");var n=new RegExp("(user|torrent|forum|deleted torrents|logs) search","i");if(e.selectedIndex==1&&n.test(t.value)){t.value="Forum Search"}else if(e.selectedIndex==0&&n.test(t.value)){t.value="User Search"}else if(e.selectedIndex==2&&n.test(t.value)){t.value="Torrent Search"}else if(e.selectedIndex==3&&n.test(t.value)){t.value="Deleted Torrents Search"}else if(e.selectedIndex==4&&n.test(t.value)){t.value="Logs Search"}_setValue("searchD",e.selectedIndex)}function searchBar(){window.srchForm=document.createElement("form");window.srchInput=document.createElement("input");window.srchSelect=document.createElement("select");var e=document.createElement("option");var t=document.createElement("option");var n=document.createElement("option");var r=document.createElement("option");var i=document.createElement("option");var s=document.createElement("div");var o=document.createElement("input");s.setAttribute("value","Search");s.innerHTML="Search";s.setAttribute("style","cursor:pointer; padding:1px 6px; margin:1px; border:1px solid lightgray; color:black; background-color:white; font-size:7.8pt; display:inline;");srchSelect.setAttribute("name","class");srchSelect.setAttribute("type","hidden");srchSelect.setAttribute("style","margin:0px 2px 0px 2px;");srchSelect.id="srchSelect";srchSelect.addEventListener("change",function(){changeSearch()},false);e.setAttribute("value","-");e.innerHTML="Users";t.setAttribute("value","0");t.innerHTML="Forums";n.setAttribute("value","");n.innerHTML="Torrents";r.setAttribute("value","");r.innerHTML="Del. Torrents";i.setAttribute("value","");i.innerHTML="Logs";srchInput.setAttribute("id","usersearch");srchInput.setAttribute("type","text");srchInput.setAttribute("name","search");srchInput.setAttribute("size","30");srchInput.setAttribute("style","text-align:center; color: grey;");srchInput.setAttribute("onClick","if (this.value == 'User Search' || this.value == 'Forum Search' || this.value == 'Torrent Search' || this.value == 'Deleted Torrents Search' || this.value == 'Logs Search') { this.value = ''; this.style.color = ''; }");srchInput.setAttribute("onBlur","if (this.value == '') { this.style.color = 'grey'; if (this.parentNode.class.selectedIndex == 0) { this.value = 'User Search'; } else if (this.parentNode.class.selectedIndex == 1) { this.value = 'Forum Search'; } else if (this.parentNode.class.selectedIndex == 2) { this.value = 'Torrent Search'; } else if (this.parentNode.class.selectedIndex == 3) { this.value = 'Deleted Torrents Search'; } else if (this.parentNode.class.selectedIndex == 4) { this.value = 'Logs Search';} }");srchForm.setAttribute("id","searchBar");srchForm.setAttribute("method","get");srchForm.setAttribute("onSubmit","return false");o.setAttribute("type","hidden");o.setAttribute("value","search");o.setAttribute("name","action");srchSelect.appendChild(e);srchSelect.appendChild(t);srchSelect.appendChild(n);if(window.isStaff)srchSelect.appendChild(r);if(window.uClass>62)srchSelect.appendChild(i);srchForm.appendChild(srchInput);srchForm.appendChild(srchSelect);srchForm.appendChild(s);srchForm.appendChild(o);window.srchTd.appendChild(srchForm);s.addEventListener("mouseup",function(e){searchBarSubmit(e)},false);srchInput.addEventListener("keyup",function(e){if(e.keyCode==13)searchBarSubmit()},false);document.addEventListener("keydown",function(e){if(e.keyCode==17)window.controlKey=true},true);document.addEventListener("keyup",function(e){if(e.keyCode==17)window.controlKey=false},true);srchSelect.selectedIndex=searchD;if(searchD==3)srchInput.setAttribute("value","Deleted Torrents Search");else if(searchD==2)srchInput.setAttribute("value","Torrent Search");else if(searchD==1)srchInput.setAttribute("value","Forum Search");else if(searchD==4)srchInput.setAttribute("value","Logs Search");else srchInput.setAttribute("value","User Search")}function searchBarSubmit(e){console.log(e);if(window.srchInput.value=="User Search"||window.srchInput.value=="Torrent Search"||window.srchInput.value=="Forum Search"||window.srchInput.value=="Deleted Torrents Search"||window.srchInput.value=="Logs Search")return;window.srchForm.setAttribute("onSubmit","");if(e)console.log(e.button);console.log(window.controlKey);var t=false;if(e&&e.button==1||window.controlKey){t=true;window.srchForm.target="_blank"}console.log(window.srchSelect.selectedIndex);if(window.srchSelect.selectedIndex==0){if(window.isStaff){window.srchInput.name="SEARCH";window.srchForm.action="/n_a/userQuickSearch.php?"}else window.srchForm.action="/users.php?"}else if(window.srchSelect.selectedIndex==1){window.srchInput.setAttribute("name","keywords");window.srchForm.action="/forums.php"}else if(window.srchSelect.selectedIndex==2)window.srchForm.action="/browse.php";else if(window.srchSelect.selectedIndex==3)window.srchForm.action="/browse-deleted.php";else if(window.srchSelect.selectedIndex==4){if(t)window.open("/n_a/searchlog.php?query="+window.srchInput.value.replace(/ /g,"+"),"_blank");else window.open("/n_a/searchlog.php?query="+window.srchInput.value.replace(/ /g,"+"),"_parent")}if((!e||e.button<2)&&window.srchSelect.selectedIndex!=4)window.srchForm.submit();window.srchForm.target=""}function navBar(){var e=[];var t,n,r,s;if(t=document.getElementById("staffMess"))e.push(t);if(n=document.getElementById("flsMess"))e.push(n);if(tmodMsg=document.getElementById("tmodMess"))e.push(tmodMsg);if(r=document.getElementById("reseedReqs")){r.firstElementChild.innerHTML=/(\d+)/.exec(r.firstElementChild.innerHTML)[1]+" reseed request(s)";e.push(r)}if(s=document.getElementById("millionInfo")){s.setAttribute("style","display:inline-block;padding-right:5px; color:green; font-weight:bold;");e.push(s)}var o;var u=e.length;for(i=0;i<u;i++){o=e[i].cloneNode(true);e[i].parentNode.removeChild(e[i]);switch(i){case 0:window.staffMsgTd.appendChild(o);break;case 1:window.staffMsg2Td.appendChild(o);break;case 2:document.body.appendChild(o);o.setAttribute("style","color: green; font-weight:bold; position:absolute;top:158px;right:0px; border-radius:3px; background-color:rgba(255, 255, 255, 0.65); padding:2px;");if(o.firstElementChild)o.firstElementChild.style.color="green";break;case 3:document.body.appendChild(o);o.setAttribute("style","color:green; font-weight:bold; position:absolute;top:158px;left:0px; border-radius:3px; background-color:rgba(255, 255, 255, 0.65); padding:2px;");if(o.firstElementChild)o.firstElementChild.style.color="green";break;case 4:document.body.appendChild(o);o.setAttribute("style","color:green; font-weight:bold; position:absolute; top:0px; right:0px; border-radius:3px; background-color:rgba(255, 255, 255, 0.65); padding:2px;");if(o.firstElementChild)o.firstElementChild.style.color="green";break;default:break}}if(!features.navLinks)window.navBarTrs[1].setAttribute("style","display:none");else{var a="<span id='navLinksSpan'>  ";if(features.homeLink)a+="<a href='/index.php'>Home</a> | ";if(features.rulesLink)a+="<a href='/rules.php'>Rules</a> | ";if(features.faqLink)a+="<a href='/faq.php'>FAQ</a> | ";if(features.forumsLink)a+="<a href='/forums.php'>Forums</a> | ";if(features.guidesLink)a+="<a href='/forums.php?action=viewforum&forumid=35'>Guides</a> | ";if(features.browseLink)a+="<a href='/browse.php'>Browse</a> | ";if(features.uploadLink)a+="<a href='/upload.php'>Upload</a> | ";if(features.rssLink)a+="<a href='/getrss.php'>RSS</a> | ";if(features.bookmarksLink)a+="<a href='/bookmarks.php'>Bookmarks</a> | ";if(features.pmsLink)a+="<a href='/messages.php?action=viewmailbox'>Messages</a> | ";if(features.friendsLink)a+="<a href='/friends.php'>Friends</a> | ";if(features.requestsLink)a+="<a href='/viewrequests.php'>Requests</a> | ";if(features.reseedsLink)a+="<a href='/forums.php?action=viewforum&forumid=29'>Reseeds</a> | ";if(features.blackjackLink)a+="<a href='/blackjack.php'>BlackJack</a> | ";if(features.dailyChallengeLink)a+="<a href='/forums.php?action=viewtopic&topicid=11186'>Daily Challenge</a> | ";if(features.flsBoxLink)a+="<a href='/contactfls.php'>Contact FLS</a> | ";if(features.staffBoxLink)a+="<a href='/contactstaff.php'>Contact Staff</a> | ";if(features.ircLink)a+="<a href='/chat.php'>IRC-Chat <span style='color:green;'>(Online)</span></a> | ";if(features.snatchesLink)a+="<a href='/snatch_summary.php'>Snatch Summary</a> | ";if(features.search){window.navBarTrs[1].firstElementChild.innerHTML=a.slice(0,-2)+"</span>"}else{window.navBarTrs[1].setAttribute("style","display:none");window.srchTd.innerHTML=a.slice(0,-2)+"</span>"}window.navBarTrs[1].firstElementChild.setAttribute("colspan",6)}var f=document.getElementById("hrnews");if(f){if(features.newsTicker)f.setAttribute("colspan",6);else f.parentNode.setAttribute("style","display:none")}}function userLevel(){var e=document.createElement("form");e.setAttribute("id","userlevel");e.setAttribute("style","display:none");e.setAttribute("action","setclass.php");e.setAttribute("method","get");var t=document.createElement("input");t.setAttribute("type","hidden");t.setAttribute("value","editclass");t.setAttribute("name","action");var n=t.cloneNode(true);n.value=url.substring(url.lastIndexOf("/")+1);n.setAttribute("name","returnto");var r=document.createElement("select");r.name="class";r.setAttribute("style","margin-top:-10px;");var i=document.createElement("option");i.value="0";i.innerHTML="Mouse";var s=document.createElement("option");s.value="5";s.innerHTML="User";var o=document.createElement("option");o.value="16";o.innerHTML="Power User";var u=document.createElement("option");u.value="32";u.innerHTML="VIP";var a=document.createElement("option");a.value="40";a.innerHTML="Elite VIP";var f=document.createElement("option");f.value="45";f.innerHTML="Elite";var l=document.createElement("option");l.value="47";l.innerHTML="Supporter";var c=document.createElement("option");c.value="49";c.innerHTML="Mouseketeer";var h=document.createElement("option");h.value="52";h.innerHTML="Uploader";var p=document.createElement("option");p.value="55";p.innerHTML="Entry Level Staff";var d=document.createElement("option");d.value="58";d.innerHTML="Support Staff";var v=document.createElement("option");v.value="60";v.innerHTML="Forum Mod";var m=document.createElement("option");m.value="62";m.innerHTML="Torrent Mod";var g=document.createElement("option");g.value="64";g.innerHTML="Moderator";var y=document.createElement("option");y.value="70";y.innerHTML="SR Moderator";var b=document.createElement("option");b.value="80";b.innerHTML="Administrator";var w=document.createElement("option");w.value="90";w.innerHTML="SR Administrator";var E=document.createElement("option");E.value="100";E.innerHTML="select one";E.setAttribute("selected","selected");r.appendChild(i);r.appendChild(s);r.appendChild(o);r.appendChild(u);r.appendChild(a);r.appendChild(f);r.appendChild(l);r.appendChild(c);r.appendChild(h);if(window.uClass>55)r.appendChild(p);if(window.uClass>58)r.appendChild(d);if(window.uClass>60)r.appendChild(v);if(window.uClass>62)r.appendChild(m);if(window.uClass>64)r.appendChild(g);if(window.uClass>70)r.appendChild(y);if(window.uClass>80)r.appendChild(b);if(window.uClass>90)r.appendChild(w);r.appendChild(E);e.appendChild(t);e.appendChild(n);e.appendChild(r);r.setAttribute("onChange","form.submit();");var S=userP.getElementsByTagName("table")[3].getElementsByTagName("tr");var x=document.createElement("span");x.setAttribute("style","color:#5284FF; text-decoration:underline; cursor: pointer");var T=false;var N=S[1].getElementsByTagName("a");if(N.length>0){T=true;S[1].firstChild.appendChild(e);x.innerHTML="Emulate A User Class";x.addEventListener("click",function(){document.getElementById("userlevel").setAttribute("style","dispaly:inline");this.setAttribute("style","display:none")},false);N[0].parentNode.removeChild(N[0])}if(S[1].firstChild.innerHTML&&!T){x.addEventListener("click",function(){window.location.assign("/restoreclass.php")},false);x.innerHTML="<br />Revert"}else{S[1].firstChild.appendChild(e);x.addEventListener("click",function(){document.getElementById("userlevel").setAttribute("style","dispaly: inline");this.setAttribute("style","display: none")},false);x.innerHTML="Emulate A User Class"}S[1].firstChild.appendChild(x);S[1].firstChild.setAttribute("style","border:none;")}function bonus(){var e=document.getElementById("bonusLink");var t=document.createElement("input");t.id="bonusBtn";t.setAttribute("style","margin:0; float:right;");t.setAttribute("type","button");t.setAttribute("value","500 pts");t.addEventListener("click",function(){e.innerHTML="Bonus: ---";openHTML("/json/bonusBuy.php?spendtype=upload&amount=1","getBonusPts(0)",window.noXMLDoc)},false);e.innerHTML="Bonus: "+commafy(e.innerHTML.split(":")[1]);e.parentNode.appendChild(t)}function numReds(user,cmID){if(user==0){var fontTags=contentTable.getElementsByTagName("font");var centerTags=contentTable.getElementsByTagName("center")}else if(user==uid){if(cmID){var fontTags=window.redsXMLDoc.getElementsByTagName("font");var centerTags=window.redsXMLDoc.getElementsByTagName("center")}else{var fontTags=warnXMLDoc.getElementsByTagName("font");var centerTags=warnXMLDoc.getElementsByTagName("center")}}else{var fontTags=redsXMLDoc.getElementsByTagName("font");var centerTags=redsXMLDoc.getElementsByTagName("center")}var reds=[];reds[0]=parseInt(window.redsXMLDoc.querySelector("#s00").innerHTML);reds[1]=parseInt(window.redsXMLDoc.querySelector("#s01").innerHTML);reds[2]=parseInt(window.redsXMLDoc.querySelector("#ns00").innerHTML);reds[3]=parseInt(window.redsXMLDoc.querySelector("#ns01").innerHTML);reds[4]=parseInt(window.redsXMLDoc.querySelector("#dns00").innerHTML);reds[5]=parseInt(window.redsXMLDoc.querySelector("#dns01").innerHTML);var totalRegEx=/^[\s]*[(]total/;var totals=[];var t;j=0;for(i=0;i<centerTags.length;i++){if(totalRegEx.test(centerTags[i].innerHTML)){t=i+4}if(i==t){totals[j]=parseInt(centerTags[i].innerHTML);j++;if(j>2)break}}totals[3]=eval(totals.join("+"));reds[6]=eval(reds.join("+"));redsPercent=Math.round(reds[6]/totals[3]*100);if(reds[6]===0)redsPercent=0;if(cmID)CMReds(redsPercent,cmID);if(user==uid||user==0){_setValue("warnRedsNum",reds[4]+reds[5]);_setValue("warnUpdateTime",now.getTime().toString());populateWarning()}else if(!cmID)userDetailsReds(reds,redsPercent)}function createWarning(){var e=userP.getElementsByTagName("tr")[11];var t=document.createElement("tr");window.userPRedsTd=document.createElement("td");userPRedsTd.setAttribute("id","userPRedsTd");userPRedsTd.setAttribute("colspan","2");userPRedsTd.setAttribute("style","background-color:white;border-radius:5px;border:4px solid red; text-align:center; display: none;");window.userPRedsSpan=document.createElement("span");userPRedsTd.appendChild(userPRedsSpan);t.appendChild(userPRedsTd);e.parentNode.appendChild(t);var n=userP.getElementsByTagName("a")[0];var r=n.href.split("=")[1];userPRedsSpan.addEventListener("click",function(){combineReds(0)},false);window.combinedRedsTable=document.createElement("table")}function populateWarning(){var e=_getValue("warnRedsNum","0");e=parseInt(e);var t=document.createElement("span");t.setAttribute("style","text-decoration:underline; color:black;");t.setAttribute("onmouseover","this.style.color='#611'");t.setAttribute("onmouseout","this.style.color='black'");t.setAttribute("id","userPRedsLink");var n=document.createElement("span");n.setAttribute("style","color:red;font-weight:bold;");n.setAttribute("id","userPRedsLinkNum");t.appendChild(n);n.innerHTML=e;t.innerHTML+=" torrent";if(e>1)t.innerHTML+="s";userPRedsSpan.innerHTML="You have ";userPRedsSpan.appendChild(t);userPRedsSpan.innerHTML+=" not seeded to site minimums.";userPRedsSpan.setAttribute("style","display:inline; cursor:pointer;");if(e>0)userPRedsTd.style.display="table-cell";var r=_getValue("warnUpdateTime",0);r=parseInt(r)+3*3600*1e3;if(now.getTime()>r){_setValue("warnUpdateTime",now.getTime().toString());window.warnXMLDoc=document.createElement("html");openHTML("/snatch_summary.php","numReds("+uid+")",warnXMLDoc)}}function combineReds(e){if(e==0){if(document.getElementById("combinedRedsDiv")){var t=document.getElementById("combinedRedsDiv");t.getElementsByTagName("table")[0].innerHTML="";t.parentNode.removeChild(t);return}userPRedsSpan.style.display="none";userPRedsTd.setAttribute("style",'background: url("'+warnWaitSrc+'") no-repeat center top; height:32px;');window.warnXMLDoc2=document.createElement("html");window.warnXMLDoc3=document.createElement("html");openHTML("/dormant_detail.php?day=0&rat=0&cat=NoSeed&id="+uid,"combineReds(1)",warnXMLDoc2)}else if(e==1){var n=warnXMLDoc2.getElementsByClassName("embedded")[0];if(!n.getElementsByTagName("h3")[0]){var r=document.createElement("tr");var i=document.createElement("td");i.appendChild(n);r.appendChild(i);combinedRedsTable.appendChild(r)}openHTML("/dormant_detail.php?day=1&rat=0&cat=NoSeed&id="+uid,"combineReds(2)",warnXMLDoc3)}else if(e==2){n=warnXMLDoc3.getElementsByClassName("embedded")[0];if(!n.getElementsByTagName("h3")[0]){var s=document.createElement("tr");var o=document.createElement("td");o.appendChild(n);s.appendChild(o);combinedRedsTable.appendChild(s)}var u=document.createElement("div");u.setAttribute("id","combinedRedsDiv");u.setAttribute("style","border: 3px solid black; border-radius:15px; background-color:#FFF; padding:15px; width:85%; margin-top:10px;");u.appendChild(combinedRedsTable);var a=document.createElement("img");a.setAttribute("src",genCloseSrc);a.setAttribute("style","height:25px; width:25px; cursor:pointer; margin-left:90%;");a.setAttribute("onClick","this.parentNode.setAttribute('style','display:none'); this.nextSibling.innerHTML = '';");var f=document.createElement("input");f.setAttribute("type","button");f.setAttribute("style","margin-left:8px;");f.value="Close";f.setAttribute("onClick","this.parentNode.parentNode.setAttribute('style','display:none'); this.parentNode.previousSibling.innerHTML = '';");var l=document.createElement("input");l.setAttribute("type","button");l.value="All Snatches";l.setAttribute("onClick","window.top.location = '/snatch_summary.php';");var c=document.createElement("div");c.setAttribute("style","margin-top:8px;");c.appendChild(l);c.appendChild(f);c.innerHTML+="<br><a href='/forums.php?action=viewtopic&topicid=12054' target='_blank' style='font-size:9px; color:darkblue; text-decoration: underline; top:3px; position:relative;'>Seed-only guide</a>";u.appendChild(c);u.insertBefore(a,u.firstChild);if(combinedRedsTable.getElementsByTagName("tr").length==0){var h=document.createElement("tr");var p=document.createElement("td");p.innerHTML="Sorry, that notice was in error. You have no dormant torrents in violation of our site minimums!";h.appendChild(p);combinedRedsTable.appendChild(h);reportReds(1)}userPRedsSpan.setAttribute("style","cursor:pointer;display:inline;");userPRedsTd.setAttribute("style","background-color:white; border-radius:5px;border:4px solid red; text-align:center;");contentTable.insertBefore(u,contentTable.firstChild)}}function createOptions(){window.optionsDiv=document.createElement("div");optionsDiv.setAttribute("style","padding:5px; display: inline;");optionsDiv.setAttribute("id","optionsDiv");optionsDiv.innerHTML="<span style='color:maroon; font-size:14pt; font-weight:600; position: relative; top:6px;'>Available Options<img src=\""+genCloseSrc+"\" style='vertical-align: middle; margin-top: -.1em; height:1.2em; width:1.2em; padding-left: 10px; cursor:pointer;' onClick=\"this.parentNode.parentNode.style.display= 'none';\"/></span><br />";var e=document.createElement("input");e.type="checkbox";e.id="cbHome";if(features.home)e.setAttribute("checked",true);var t=document.createElement("input");t.type="checkbox";t.id="cbSearch";if(features.search)t.setAttribute("checked",true);var n=document.createElement("input");n.type="checkbox";n.id="cbBonus";if(features.bonus)n.setAttribute("checked",true);var r=document.createElement("input");r.type="checkbox";r.id="cbMessages";if(features.messages)r.setAttribute("checked",true);var s=document.createElement("input");s.type="checkbox";s.id="cbContextMenu1";if(features.contextMenu1)s.setAttribute("checked",true);if(browser!=="Firefox"||browserVersion<8)s.disabled="disabled";var o=document.createElement("fieldset");o.setAttribute("style","width:45%; margin-top: .5em; border: 1px dashed #999; text-align:left");var u=document.createElement("legend");u.setAttribute("style","color:#747");u.innerHTML="General";o.appendChild(u);o.appendChild(e);o.innerHTML+="<span class='cbTextSpan'> Re-order home page</span><br />";o.appendChild(t);o.innerHTML+="<span class='cbTextSpan'> Search Bar </span>";o.innerHTML+="<br />";o.appendChild(n);o.innerHTML+="<span class='cbTextSpan'> Exchange 500pts button in User Panel</span><br />";o.appendChild(r);o.innerHTML+="<span class='cbTextSpan'> Catch and display PMs immediately</span><br />";o.appendChild(s);o.innerHTML+="<span class='cbTextSpan'> Right-click member to PM & gift points (Firefox 8 and above)</span><br />";var a=document.createElement("select");a.id="bannerSelect";var f=document.createElement("option");f.innerHTML="Donations";bs2=document.createElement("option");bs2.innerHTML="Home";bs3=document.createElement("option");bs3.innerHTML="Forums";bs4=document.createElement("option");bs4.innerHTML="Torrents";a.appendChild(f);a.appendChild(bs2);a.appendChild(bs3);a.appendChild(bs4);var l=document.createElement("input");l.type="checkbox";l.id="cbNewsTicker";if(features.newsTicker)l.setAttribute("checked",true);var c=document.createElement("input");c.type="checkbox";c.id="cbNavLinks";if(features.navLinks)c.setAttribute("checked",true);var h=document.createElement("input");h.type="checkbox";h.id="cbHomeLink";if(features.homeLink)h.setAttribute("checked",true);var p=document.createElement("input");p.type="checkbox";p.id="cbRulesLink";if(features.rulesLink)p.setAttribute("checked",true);var d=document.createElement("input");d.type="checkbox";d.id="cbFAQLink";if(features.faqLink)d.setAttribute("checked",true);var v=document.createElement("input");v.type="checkbox";v.id="cbForumsLink";if(features.forumsLink)v.setAttribute("checked",true);var m=document.createElement("input");m.type="checkbox";m.id="cbGuidesLink";if(features.guidesLink)m.setAttribute("checked",true);var g=document.createElement("input");g.type="checkbox";g.id="cbBrowseLink";if(features.browseLink)g.setAttribute("checked",true);var y=document.createElement("input");y.type="checkbox";y.id="cbUploadLink";if(features.uploadLink)y.setAttribute("checked",true);var b=document.createElement("input");b.type="checkbox";b.id="cbRSSLink";if(features.rssLink)b.setAttribute("checked",true);var w=document.createElement("input");w.type="checkbox";w.id="cbStaffBoxLink";if(features.staffBoxLink)w.setAttribute("checked",true);var E=document.createElement("input");E.type="checkbox";E.id="cbFLSBoxLink";if(features.flsBoxLink)E.setAttribute("checked",true);var S=document.createElement("input");S.type="checkbox";S.id="cbIRCLink";if(features.ircLink)S.setAttribute("checked",true);var x=document.createElement("input");x.type="checkbox";x.id="cbRequestsLink";if(features.requestsLink)x.setAttribute("checked",true);var T=document.createElement("input");T.type="checkbox";T.id="cbReseedsLink";if(features.reseedsLink)T.setAttribute("checked",true);var N=document.createElement("input");N.type="checkbox";N.id="cbPMsLink";if(features.pmsLink)N.setAttribute("checked",true);var C=document.createElement("input");C.type="checkbox";C.id="cbFriendsLink";if(features.friendsLink)C.setAttribute("checked",true);var k=document.createElement("input");k.type="checkbox";k.id="cbBookmarksLink";if(features.bookmarksLink)k.setAttribute("checked",true);var L=document.createElement("input");L.type="checkbox";L.id="cbBlackJackLink";if(features.blackjackLink)L.setAttribute("checked",true);var A=document.createElement("input");A.type="checkbox";A.id="cbDailyChallengeLink";if(features.dailyChallengeLink)A.setAttribute("checked",true);var O=document.createElement("input");O.type="checkbox";O.id="cbSnatchesLink";if(features.snatchesLink)O.setAttribute("checked",true);var M=document.createElement("fieldset");M.setAttribute("style","width:45%; margin-top: .5em; border: 1px dashed #999; text-align:left");var _=document.createElement("legend");_.setAttribute("style","color:#227");_.innerHTML="Site Header";M.appendChild(_);M.innerHTML+=" - Clicking on the site banner takes you: ";M.appendChild(a);M.innerHTML+="<br />";M.appendChild(l);M.innerHTML+="<span class='cbTextSpan'> Show news ticker</span><br />";M.appendChild(c);var D="<span class='cbTextSpan'> Show links in navigation bar. </span>Choose:<br /><table style='width:100%; text-align: left;' id='navLinksTable'><tbody><tr><td style='padding:2px;'>";D+=h.outerHTML;D+="<span class='cbTextSpan'> Home</span></td><td style='padding:2px;'>";D+=p.outerHTML;D+="<span class='cbTextSpan'> Rules</span></td><td style='padding:2px;'>";D+=d.outerHTML;D+="<span class='cbTextSpan'> FAQ</span></td><td style='padding:2px;'>";D+=v.outerHTML;D+="<span class='cbTextSpan'> Forums</span></td></tr><tr><td style='padding:2px;'>";D+=m.outerHTML;D+="<span class='cbTextSpan'> Guides</span></td><td style='padding:2px;'>";D+=g.outerHTML;D+="<span class='cbTextSpan'> Browse</span></td><td style='padding:2px;'>";D+=y.outerHTML;D+="<span class='cbTextSpan'> Upload</span></td><td style='padding:2px;'>";D+=b.outerHTML;D+="<span class='cbTextSpan'> RSS</span></td></tr><tr><td style='padding:2px;'>";D+=k.outerHTML;D+="<span class='cbTextSpan'> Bookmarks</span></td><td style='padding:2px;'>";D+=N.outerHTML;D+="<span class='cbTextSpan'> PMs</span></td><td style='padding:2px;'>";D+=C.outerHTML;D+="<span class='cbTextSpan'> Friends</span></td><td style='padding:2px;'>";D+=x.outerHTML;D+="<span class='cbTextSpan'> Requests</span></td></tr><tr><td style='padding:2px;'>";D+=T.outerHTML;D+="<span class='cbTextSpan'> Reseeds</span></td><td style='padding:2px;'>";D+=L.outerHTML;D+="<span class='cbTextSpan'> BlackJack</span></td><td style='padding:2px;'>";D+=A.outerHTML;D+="<span class='cbTextSpan'> Daily Challenge</span></td><td style='padding:2px;'>";D+=E.outerHTML;D+="<span class='cbTextSpan'> Contact FLS</span></td></tr><tr><td style='padding:2px;'>";D+=w.outerHTML;D+="<span class='cbTextSpan'> Contact Staff</span></td><td style='padding:2px;'>";D+=O.outerHTML;D+="<span class='cbTextSpan'> Snatched List</span></td><td style='padding:2px;'>";D+=S.outerHTML;D+="<span class='cbTextSpan'> IRC-Chat</span></td></tr></tbody></table>";M.innerHTML+=D;var P=document.createElement("input");P.type="checkbox";P.id="cbSlim";if(features.slim)P.setAttribute("checked",true);var H=document.createElement("input");H.type="checkbox";H.id="cbTorrMore";if(features.torrMore)H.setAttribute("checked",true);var B=document.createElement("fieldset");B.setAttribute("style","width:45%; margin-top: .5em; border: 1px dashed #999; text-align:left");var j=document.createElement("legend");j.setAttribute("style","color:#477");j.innerHTML="Torrent Details";B.appendChild(j);B.appendChild(P);B.innerHTML+="<span class='cbTextSpan'> Slim down Torrent Details pages</span><br />";B.appendChild(H);B.innerHTML+="<span class='cbTextSpan'> Add search links & torrent ID to details page</span><br />";var F=document.createElement("input");F.type="checkbox";F.id="cbUHAddLinks";if(features.UHAddLinks)F.setAttribute("checked",true);var I=document.createElement("input");I.type="checkbox";I.id="cbUHAddContents";if(features.UHAddContents)I.setAttribute("checked",true);var q=document.createElement("input");q.type="checkbox";q.id="cbUHReplaceTitle";if(features.UHReplaceTitle)q.setAttribute("checked",true);var R=document.createElement("input");R.type="checkbox";R.id="cbUHAutomate";if(features.UHAutomate)R.setAttribute("checked",true);var U=document.createElement("fieldset");U.setAttribute("style","width:45%; margin-top: .5em; border: 1px dashed #999; text-align:left");var z=document.createElement("legend");z.setAttribute("style","color:#398B51");z.innerHTML="Upload Helper";U.appendChild(z);U.appendChild(F);U.innerHTML+="<span class='cbTextSpan'> Append site links & ratings to descriptions</span><br />";U.appendChild(I);U.innerHTML+="<span class='cbTextSpan'> Prefix description with recognized filetypes</span><br />";U.appendChild(q);U.innerHTML+="<span class='cbTextSpan'> Replace torrent title with selected search result</span><br />";U.appendChild(R);U.innerHTML+="<span class='cbTextSpan'> Automate further (beta, defaults to fiction ebook)</span><br />";var W=document.createElement("input");W.type="checkbox";W.id="cbLeft";if(features.left)W.setAttribute("checked",true);var X=document.createElement("input");X.type="checkbox";X.id="cbEmulate";if(features.emulate)X.setAttribute("checked",true);var V=document.createElement("input");V.type="checkbox";V.id="cbWarning";if(features.warning)V.setAttribute("checked",true);var $=document.createElement("input");$.type="checkbox";$.id="cbSnatches";if(features.snatches)$.setAttribute("checked",true);var J=document.createElement("input");J.type="checkbox";J.id="cbHitList";if(features.hitList)J.setAttribute("checked",true);var K=document.createElement("input");K.type="checkbox";K.id="cbContextMenu2";if(features.contextMenu2)K.setAttribute("checked",true);if(browser!=="Firefox"||browserVersion<8)K.disabled="disabled";var Q=document.createElement("fieldset");Q.setAttribute("style","width:45%; margin-top: .5em; display: block; border: 1px dashed #999; text-align:left;");var G=document.createElement("legend");G.setAttribute("style","color:#774");G.innerHTML="Staff Options";Q.appendChild(G);Q.appendChild(W);Q.innerHTML+="<span class='cbTextSpan'> Re-order links on the left</span><br />";Q.appendChild(K);Q.innerHTML+="<span class='cbTextSpan'> Add Snatch Summary to right-click menu (Firefox 8 and later)</span><br />";Q.appendChild(X);Q.innerHTML+="<span class='cbTextSpan'> Emulate user class (for FLS)</span><br />";optionsDiv.appendChild(o);optionsDiv.appendChild(M);optionsDiv.appendChild(B);optionsDiv.appendChild(U);if(window.isStaff)optionsDiv.appendChild(Q);var Y=document.createElement("div");Y.setAttribute("style","position:relative; margin-top:8px");var Z=document.createElement("input");Z.type="button";Z.value="Change!";Z.setAttribute("style","font-size:14px;");Z.addEventListener("click",function(){changeOptions(1)},false);Y.appendChild(Z);var et=document.createElement("input");et.type="button";et.value="Reset";et.setAttribute("style","margin-left:15px;; margin-top:4px; position:absolute; font-size:10px;");et.addEventListener("click",function(){resetOptions()},false);Y.appendChild(et);optionsDiv.appendChild(Y);var tt=document.createElement("span");tt.innerHTML="<br />If you have any comments, suggestions or bugs, please PM me. <a href='/sendmessage.php?receiver=28091' style='font-weight:bold; cursor:pointer; text-decoration:underline; color:darkblue;'>Click Here</a>.";var nt=document.createElement("span");nt.setAttribute("style","font-size:9px; padding-top:2px;");nt.innerHTML="<br />(MAM Features v"+version+")";optionsDiv.appendChild(tt);optionsDiv.appendChild(nt);contentTable.insertBefore(optionsDiv,contentTable.firstChild);document.getElementById("bannerSelect").selectedIndex=features.banner||0;if(!document.getElementById("cbNavLinks").checked)document.getElementById("navLinksTable").style.display="none";var rt=document.getElementsByClassName("cbTextSpan");for(i=0;i<rt.length;i++){rt[i].addEventListener("click",function(){var e=this.previousSibling;if(!e.disabled)e.checked=!e.checked},false)}document.getElementById("cbNavLinks").addEventListener("change",function(){var e=document.getElementById("navLinksTable");if(this.checked==true)e.style.display="block";else e.style.display="none"},false)}function changeOptions(e){if(!e){if(typeof optionsDiv!="undefined"){if(optionsDiv.style.display=="inline"){optionsDiv.style.display="none"}else{optionsDiv.style.display="inline"}}else{createOptions();optionsDiv.style.display="inline"}}else{features.home=document.getElementById("cbHome").checked;features.search=document.getElementById("cbSearch").checked;features.bonus=document.getElementById("cbBonus").checked;features.messages=document.getElementById("cbMessages").checked;features.contextMenu1=document.getElementById("cbContextMenu1").checked;features.slim=document.getElementById("cbSlim").checked;features.torrMore=document.getElementById("cbTorrMore").checked;features.banner=document.getElementById("bannerSelect").selectedIndex;features.newsTicker=document.getElementById("cbNewsTicker").checked;features.navLinks=document.getElementById("cbNavLinks").checked;features.homeLink=document.getElementById("cbHomeLink").checked;features.rulesLink=document.getElementById("cbRulesLink").checked;features.faqLink=document.getElementById("cbFAQLink").checked;features.forumsLink=document.getElementById("cbForumsLink").checked;features.guidesLink=document.getElementById("cbGuidesLink").checked;features.browseLink=document.getElementById("cbBrowseLink").checked;features.uploadLink=document.getElementById("cbUploadLink").checked;features.rssLink=document.getElementById("cbRSSLink").checked;features.staffBoxLink=document.getElementById("cbStaffBoxLink").checked;features.flsBoxLink=document.getElementById("cbFLSBoxLink").checked;features.ircLink=document.getElementById("cbIRCLink").checked;features.requestsLink=document.getElementById("cbRequestsLink").checked;features.reseedsLink=document.getElementById("cbReseedsLink").checked;features.pmsLink=document.getElementById("cbPMsLink").checked;features.friendsLink=document.getElementById("cbFriendsLink").checked;features.bookmarksLink=document.getElementById("cbBookmarksLink").checked;features.blackjackLink=document.getElementById("cbBlackJackLink").checked;features.dailyChallengeLink=document.getElementById("cbDailyChallengeLink").checked;features.snatchesLink=document.getElementById("cbSnatchesLink").checked;features.UHAddLinks=document.getElementById("cbUHAddLinks").checked;features.UHAddContents=document.getElementById("cbUHAddContents").checked;features.UHReplaceTitle=document.getElementById("cbUHReplaceTitle").checked;features.UHAutomate=document.getElementById("cbUHAutomate").checked;if(window.isStaff){features.left=document.getElementById("cbLeft").checked;features.contextMenu2=document.getElementById("cbContextMenu2").checked;features.emulate=document.getElementById("cbEmulate").checked}_setValue("fSettings",JSON.stringify(features));window.scrollTo(0,top);history.go(0)}}function resetOptions(e){if(!e){var t=confirm("This will reset all options and saved data. Are you sure?");if(t){alert('If your browse notifies you that the script has "frozen" please let it continue a bit - there may be a lot of data to delete');resetOptions(1)}return}var n=_listValues();for(i=0;i<n.length;i++){_deleteValue(n[i])}features={};features.banner=1;features.search=features.bonus=features.messages=true;if(browser=="Firefox"&&browserVersion>=8)features.contextMenu1=true;features.newsTicker=true;features.navLinks=features.homeLink=features.rulesLink=features.faqLink=true;features.uploadLink=features.forumsLink=features.guidesLink=features.browseLink=true;features.rssLink=features.flsBoxLink=features.staffBoxLink=features.ircLink=true;features.torrMore=true;features.UHAddLinks=features.UHAddContents=features.UHReplaceTitle=true;_setValue("fSettings",JSON.stringify(features));window.scrollTo(0,top);history.go(0)}function displayPM(){if(window.jsonLoad.Error){pmExit.previousElementSibling.style.color="white";pmExit.previousElementSibling.innerHTML="Error fetching messages.";pmExit.style.display="none";return}var e=document.createElement("div");e.id="messageFrame";e.frameBorder="0";e.setAttribute("style","width:58%; max-height:275px; margin: 5px; display:none; text-align:left;overflow:auto;");e.src="";var t=[];var n;var r;var s="";for(i=0;i<window.jsonLoad.length;i++){if(i%2)r="#999";else r="#BBB";s+="<div style='background-color:"+r+"; color: #151B54; padding:2px 2px 0px 5px; border-top-left-radius:5px; border-top-right-radius:5px;'>";s+=window.jsonLoad[i].added+" GMT - <span style='font-weight:bold; color:darkred;'>"+decodeURIComponent(window.jsonLoad[i].subject.replace(/\+/g," "))+"</span> - From: ";if(window.jsonLoad[i].senderID!=0)s+="<a href='/userdetails.php?id="+window.jsonLoad[i].senderID+"' style='font-weight:bold; text-decoration:underline;' target='_top'>"+window.jsonLoad[i].senderName+"</a></div>";else s+="<span style='font-weight:bold; color:darkblue;'>"+window.jsonLoad[i].senderName+"</span></div>";s+="<div class ='message' style='padding-left:20px; padding-top: 2px; background: #EEE; border: 3px solid "+r+"; boder-top: 0px none; border-bottom:0px none;'>";try{s+=decodeURIComponent(window.jsonLoad[i].message.replace(/\+/g," ").replace(/%B5/g,"u")).replace(/<\/?(table|tbody|td|div|th).+?>/g,"").replace(/<\/?tr>/g,"p")+"</div>"}catch(o){try{s+=window.jsonLoad[i].message+"</div>"}catch(u){pmExit.parentNode.firstElementChild.innerHTML="Error reading PM - "+o+", "+u+" @ "+window.jsonLoad[i].added;pmExit.parentNode.firstElementChild.style.color="white";pmExit.parentNode.removeChild(pmExit);return}}s+="<div style='background-color:#EEE; padding: 5px 2px 2px 5px; border: 3px solid "+r+"; border-top: 0px none; border-bottom-left-radius:5px; border-bottom-right-radius:5px; margin-bottom:7px;'>";if(window.jsonLoad[i].senderID!=0)s+="<a href='/sendmessage.php?receiver="+window.jsonLoad[i].senderID+"&replyto="+window.jsonLoad[i].ID+"' style='font-weight:bold; text-decoration:underline;' target='_top' class='replyLink' pid='"+window.jsonLoad[i].ID+"'>Reply</a> | ";s+="<a href='/messages.php?action=deletemessage&box=1&did="+window.jsonLoad[i].ID+"' style='font-weight:bold; text-decoration:underline;' target='_top'>Delete</a></div>";t.push(parseInt(window.jsonLoad[i].ID))}s+="<style type='text/css'>p { margin: 0px; }</style>";e.innerHTML=s;e.style.display="block";pmExit.src=pmCloseSrc;pmExit.addEventListener("click",function(){e.style.display="none";pmNote.style.display="none";openHTML("/jsonLoadPM.php?box=-8&pid="+t.join(","),"checkMarkedRead("+t.length+")","window.jsonLoad")},false);pmNote.parentNode.insertBefore(e,pmNote.nextSibling);var a=document.getElementsByClassName("replyLink");console.log(a);for(i=0;i<a.length;i++){a[i].addEventListener("click",function(e){e.preventDefault();this.style.cursor="wait";openHTML("/jsonLoadPM.php?box=-8&pid="+this.getAttribute("pid"),"checkMarkedRead('"+this.href+"')","window.jsonLoad")},false)}}function checkMarkedRead(e){if(window.jsonLoad.markedRead!=e&&typeof e=="number")console.log("Error marking as read.");if(typeof e!="number")window.location.assign(e)}function invitee(e){if(!e){var t=document.getElementsByTagName("h2")[0].parentNode;window.inviteDiv=document.createElement("div");inviteDiv.setAttribute("style","text-align:left; padding-left: 10%; padding-top:20px; font-size: 14px; color: grey;");t.appendChild(inviteDiv);inviteDiv.innerHTML="Fetching info... ";window.inviteeXMLDoc=document.createElement("html");openHTML("invitees.php?id="+uid,"invitee(1)",inviteeXMLDoc)}else if(e==1){var n=inviteeXMLDoc.getElementsByClassName("row1");window.newInvitee=n[n.length-4];inviteDiv.innerHTML="New user found. ID: "+newInvitee.innerHTML+". Please wait.";inviteDiv.style.color="black";window.newInviteeTimeout=0;setTimeout(function(){openHTML(newInvitee.firstChild.href,"invitee(2)",inviteeXMLDoc)},3e4)}else if(e==2){if(newInviteeTimeout++>40){inviteDiv.innerHTML="Timed out.";inviteDiv.style.color="red";return}var r=(40-newInviteeTimeout)*15/60;var i=inviteeXMLDoc.getElementsByTagName("h1");if(!i[0]){inviteDiv.innerHTML="New user found. ID: "+newInvitee.innerHTML+". Not yet registered.";setTimeout(function(){openHTML(newInvitee.firstChild.href,"invitee(2)",inviteeXMLDoc)},15e3)}else{inviteDiv.innerHTML="User has registered with name: <a href='"+newInvitee.firstChild.href+"'>"+i[0].innerHTML+"</a>! ";inviteDiv.style.color="black";var s=inviteeXMLDoc.getElementsByClassName("rowhead");if(/never/i.test(s[1].nextSibling.innerHTML)){inviteDiv.innerHTML+="No login, yet.";setTimeout(function(){openHTML(newInvitee.firstChild.href,"invitee(2)",inviteeXMLDoc)},15e3)}else{inviteDiv.innerHTML="Success! User <a href='"+newInvitee.firstChild.href+"' style='color:blue; text-decoration:underline;'>"+i[0].innerHTML+"</a> has successfully registered and logged in!";inviteDiv.style.color="darkblue";return}}inviteDiv.innerHTML+="<br /><span style='font-size:10px;'>(timeout in "+r+"min)</span>"}}function createDD(e,t){return function(){ddOpen(e,t)}}function createEdit(e){return function(){window.location.assign("edit.php?id="+e+"")}}function createRS(e,t){return function(){window.rsXMLDoc=document.createElement("html");openHTML("details.php?id="+e,"allowReSeed("+e+","+t+")",rsXMLDoc)}}function allowReSeed(e,t){var n=rsXMLDoc.getElementsByTagName("input");if(n[2].disabled==true)alert("Re-seed was recently sent, already.");else{openHTML("takereseed.php",alert("Reseed request sent to last 10 downloaders."),noXMLDoc,"pm_what=last10&uploader="+t+"&reseedid="+e)}}function ddOpen(e,t){var n=t.getElementsByTagName("img");var r=false;for(i=0;i<n.length;i++){if(n[i].getAttribute("alt")==="vip")r=true}var s=t.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.getElementsByClassName("red");if(s.length>0){var o=confirm("This torrent is currently dead (no seeders). Do you still want to download it?");if(!o)return}if(r&&window.uClass<32){alert("You need to be a VIP to download this!");return}if(e==""){alert("Torrent was deleted.")}else window.open(e,"_top")}function checkPageForDupes(e){if(e&&typeof e=="number"){window.dupeCheckerNum++;if(window.dupeCheckerNum<window.dupeTds.length&&window.dupeCheckerNum<100){var t=Math.min(8e3,(parseFloat(e)*1e3+100).toFixed(0));setTimeout(createDupeChecker,t);if(t>500)window.dupeTds[window.dupeCheckerNum].innerHTML="waiting "+(t/1e3).toFixed(1)+" secs"}else{var n=document.getElementById("dupeCheckDiv");if(!n){indiDupeCheckerFinish();return}n.innerHTML="See results below!";n.style.color="blue";n.style.textDecoration="none"}return}var r=!!/viewrequests/.test(url);this.removeEventListener("click",checkPageForDupes,false);if(r)this.innerHTML="Checking requests!";else this.innerHTML="Checking torrents!";this.style.cursor="default";this.style.color="purple";window.dupeTds=document.querySelectorAll(".dupeTd");var s=document.querySelector("#dupeHeadingTd");if(s)s.style.display="";var o;for(i=0;i<window.dupeTds.length;i++){dupeTds[i].style.display="";if(i>99)dupeTds[i].innerHTML="Not checking this";else dupeTds[i].innerHTML="Queued";o=dupeTds[i].previousElementSibling.getElementsByTagName("a")[0];o.setAttribute("target","_blank");if(!r){o.href=o.href.replace(/hit/i,"filelist");o.firstElementChild.innerHTML=o.title;dupeTds[i].parentNode.lastElementChild.firstElementChild.setAttribute("target","_blank")}else{dupeTds[i].parentNode.lastElementChild.firstElementChild.setAttribute("target","_blank");dupeTds[i].parentNode.lastElementChild.previousElementSibling.firstElementChild.setAttribute("target","_blank")}}window.dupeCheckerNum=0;createDupeChecker()}function createDupeChecker(){if(window.eroticaAuthorsRegEx.test(window.dupeTds[window.dupeCheckerNum].title)){window.dupeTds[window.dupeCheckerNum].previousElementSibling.innerHTML+="<span style='background-color:#E80000; display:block; color:white; font-weight:bold; margin-left:10px; width: 25em; text-align:center; border-radius:2px; margin-top:1px;'>This author has written Erotica in the past.</span>"}window.dupeTds[window.dupeCheckerNum].innerHTML="Checking now";console.log(window.dupeTds[window.dupeCheckerNum].id);searchForDupes2(dupeTerms(window.dupeTds[window.dupeCheckerNum].title),window.dupeTds[window.dupeCheckerNum].id,window.dupeTds[window.dupeCheckerNum].getAttribute("cat"))}function prevDownloadedDiv(e){var t=document.createElement("div");t.setAttribute("style","display:inline; margin-left:.6em; text-align:center;");var n=shadow=l="";if(e==0){n="Leeching";shadow="0 0 0.2em #FF0000, 0 -1px 0.4em #FFFF33, 2px -1px 0.8em #FFDD33, -2px -4px 1.2em #FF8800, 3px -6px 1em #FF2200;";l="/snatched_detail.php?cat=AnyLeeching"}else if(e==1){n="Seeding";shadow="0 0 0.2em #AAFC00, 0 -1px 0.4em #D0FF0B, 2px -1px 0.8em #1CFC00, -2px -4px 1.2em #21BA00, 3px -6px 1em #BEBEBE";l="/snatched_detail.php?day=-1&rat=-1&cat=Seed"}else if(e>2){n="Downloaded";shadow="0 0 0.2em #00A4FC, 0 -1px 0.4em #3CDCBE, 2px -1px 0.8em #046EFF, -2px -4px 1.2em #0081ff";if(e=2)l="/snatched_detail.php?day=-1&rat=-1&cat=NoSeed";else l="/dormant_detail.php?day=-1&rat=-1&cat=NoSeed"}prevDownloadedA=document.createElement("a");prevDownloadedA.setAttribute("style","color:black; text-shadow:"+shadow);prevDownloadedA.innerHTML=n;prevDownloadedA.href=l;t.appendChild(prevDownloadedA);return t}function addReqDupeTds(){try{var e=contentTable.getElementsByTagName("form")[1];var t=e.getElementsByTagName("tr");trsL=t.length;var n=document.createElement("div");n.id="dupeCheckDiv";n.innerHTML="Check the requests on this page for dupes";n.setAttribute("style","font-size:1.3em; padding-top:3px; padding-bottom:7px; cursor:pointer; color:darkblue; text-decoration:underline; width: 22em;");n.addEventListener("click",checkPageForDupes,false);e.parentNode.insertBefore(n,e.previousElementSibling)}catch(r){console.log(r);return}var s=document.createElement("th");s.setAttribute("class","rowhead");s.setAttribute("align","center");s.setAttribute("style","display:none; text-align:center; width:8.5em;");s.setAttribute("id","dupeHeadingTd");s.innerHTML="Dupe Checker";t[0].insertBefore(s,t[0].firstElementChild.nextElementSibling.nextElementSibling);var o=[];for(i=1;i<trsL;i++){o[i]=document.createElement("td");o[i].id="dupeRTd"+i;o[i].setAttribute("class","row1 dupeTd");o[i].setAttribute("align","center");o[i].setAttribute("style","display:none; text-align:center");o[i].setAttribute("reqId",/id=(\d+)/.exec(t[i].firstElementChild.nextElementSibling.firstElementChild.href)[1]);o[i].setAttribute("cat",t[i].firstElementChild.firstElementChild.getAttribute("alt").slice(0,2));o[i].setAttribute("title",t[i].firstElementChild.nextElementSibling.firstElementChild.innerHTML);t[i].insertBefore(o[i],t[i].firstElementChild.nextElementSibling.nextElementSibling)}}function reqReseed(e,t){e=encodeURI(e);window.location.assign("/forums.php?action=newtopic&forumid=29&id="+t+"&t="+e)}function addStaffPick(e,t,n){var r=_getValue("staffPicksList","");_setValue("staffPicksList",r+"#"+t);_setValue(t,e);_setValue(t+"t",n);addStaffPickBtn.style.display="none";remStaffPickBtn.style.display="inline"}function remStaffPick(e,t){var n=_getValue("staffPicksList","");var r=n.split("#");r.splice(r.indexOf(e),1);_setValue("staffPicksList",r.join("#"));_deleteValue(e);_deleteValue(e+"t");if(t){addStaffPickBtn.style.display="inline";remStaffPickBtn.style.display="none"}}function viewStaffPicks(){var e=_getValue("staffPicksList","");var t=[];if(e)t=e.split("#");t.shift();var n=staffPicksText(t);var r=document.createElement("div");r.id="overlayDiv";r.setAttribute("style","position:fixed; height:100%; width: 100%; background-color: #000; margin: auto; top: 0; left: 0; z-index: 100; opacity: .7;");var i=window.innerWidth;var s=window.innerHeight;var o=s*.75/2;var u=s*.75;var a=i*.75/2;var f=i*.75;var l=document.createElement("div");l.id="staffPicksDiv";l.setAttribute("style","position: fixed; top:50%; left:50%; width:"+f+"px; height:"+u+"px; z-index: 150; opacity: 1; background-color: #FFF; margin-top:-"+o+"px; margin-left:-"+a+"px; padding: 5px; border: 3px solid grey; border-radius:5px;");var c=document.createElement("div");c.setAttribute("style","position: relative; margin-top:-3px; margin-right:-5px; text-align: left; display: block; visibility: visible;");var h=document.createElement("img");h.id="staffPicksCloseBtn";h.src=genCloseSrc;var p=s*.125+1;var d=i*.875-12.5-5;h.setAttribute("style","cursor: pointer; height: 25px; position:fixed; top:"+p+"px; left:"+d+"px;");h.addEventListener("click",function(){closeStaffPicks()},false);var v=document.createElement("input");v.type="button";v.value="Select All";v.id="staffPicksCopyBtn";v.setAttribute("style","cursor:pointer; border: 2px outset black;");if(t.length>0)v.setAttribute("onClick","document.getElementById('staffPicksTxt').select();");var m=document.createElement("input");m.type="button";m.value="Clear Entire List";m.id="staffPicksClearBtn";m.setAttribute("style","margin-left:5px; border: 2px outset black; cursor: pointer;");m.addEventListener("click",function(){clearStaffPicksList(t)},false);var g=document.createElement("input");g.type="button";g.value="Open Torrents";g.id="staffPicksOpenBtn";g.setAttribute("style","cursor:pointer; border: 2px outset black; margin-left:25px;");g.addEventListener("click",function(){openStaffPicks()},false);var y=document.createElement("input");y.type="text";y.id="openA";y.setAttribute("style","width:1.7em;");y.value="1";var b=document.createElement("input");b.type="text";b.id="openB";b.setAttribute("style","width:2.1em;");b.value=t.length;var w=document.createElement("input");w.type="checkbox";w.id="staffPicksRemoveOnOpenCb";c.appendChild(v);if(t.length>0){c.appendChild(m);c.appendChild(g);c.appendChild(y);var E=document.createElement("span");E.innerHTML=" to ";c.appendChild(E);c.appendChild(b);var S=document.createElement("span");S.innerHTML=".  Remove from list after opening:";c.appendChild(S);c.appendChild(w)}var x=document.createElement("span");x.setAttribute("style","font-size:9px; left:18px; Color: darkred; position: relative; top:3px;");x.innerHTML="<br />Please note: Edits made below will not be saved nor reflected anywhere. It's just generated gobbledy-gook. <a href='/forums.php?action=viewforum&forumid=14' target='_blank'>Click here for the staff forum.</a>";c.appendChild(x);var T=document.createElement("textarea");T.id="staffPicksTxt";T.setAttribute("style","border:0px; width: 100%; height:100%; overflow: auto; resize:none; display: none; margin-top:8px;");T.value=n[0];var N=document.createElement("div");N.setAttribute("style","border:0px; width: 50%; height:100%; overflow: auto; margin-top: 8px; display: none; text-align:left; float:left;");N.innerHTML=n[2];var C=document.createElement("div");C.setAttribute("style","border:0px; width: 50%; height:100%; overflow: auto; margin-top: 8px; display: none; text-align:right; float:right; padding-right:2px;");C.innerHTML=n[3];var k=document.createElement("span");k.setAttribute("style","cursor:pointer; color: darkblue; display:block; float: left; font-size:11px; line-height:20px; margin-top:2px;");k.innerHTML=n[1]+"/89 sections have torrents. Click to toggle.";k.addEventListener("click",function(){if(N.style.display==="none"){T.style.display="none";N.style.display="block";C.style.display="block";c.style.visibility="hidden";L.style.visibility="hidden";A.style.visibility="hidden"}else{T.style.display="block";N.style.display="none";C.style.display="none";c.style.visibility="visible";L.style.visibility="visible";A.style.visibility="visible"}},false);var L=document.createElement("input");L.type="button";L.value="Add Header & Footer";L.id="appendHF";L.setAttribute("style","margin-left:10px; float: left; border: 2px outset black; cursor: pointer; display: block; margin-bottom:5px; visibility: visible;");if(t.length>0)L.addEventListener("click",appendHF,false);var A=document.createElement("input");A.type="button";A.value="Make all Free Leech";A.id="freeBtn";A.setAttribute("style","margin-right:10px; float: right; border: 2px outset black; cursor: pointer; display: block; margin-bottom: 5px; visibility: visible;");if(t.length>0)A.addEventListener("click",function(){startFreeLeech(t)},false);l.appendChild(c);l.appendChild(h);l.appendChild(T);l.appendChild(N);l.appendChild(C);l.appendChild(k);if(window.uClass==100||uid==28091||uid==35348){l.appendChild(L);l.appendChild(A)}contentTable.appendChild(l);contentTable.appendChild(r);var O=u-c.offsetHeight-k.offsetHeight-5;var M=l.offsetWidth-20;T.style.height=O+"px";T.style.width=M+"px";T.style.display="block";N.style.height=O+"px";N.style.width=M/2+"px";C.style.height=O+"px";C.style.width=M/2+"px"}function appendHF(){var e=document.getElementById("staffPicksTxt");var t=new Date;var n=t.getDay();var r=t.getHours();var i;if(n==2&&r<2)i=0;else i=2-n;if(i<0)i+=7;t.setDate(t.getDate()+i);var s=["January","February","March","April","May","June","July","August","September","October","November","December"];var o=s[t.getMonth()]+" "+t.getDate();t.setDate(t.getDate()+6);var u=s[t.getMonth()]+" "+t.getDate();var a="Tuesday, "+o+" 00:01 GMT to Monday, "+u+" 23:30 GMT";var f="[b][size=2][color=Blue]Staff picks for Free Leech for the week of: "+a+"[/color][/size][/b]	\n\n[color=#ff0000][b][size=2]Free Leech = Your account is not charged for downloading but you do get credit for what you upload.[/size][/b][/color]	\n\n\n[img]http://www.myanonamouse.net/pic/freedownload.gif[/img] [url=http://www.myanonamouse.net/browse.php?incldead=3][size=4][b]Click HERE for all Free Leech on site[/b][/size][/url] [img]http://www.myanonamouse.net/pic/freedownload.gif[/img]	\n\n\n[b][color=#cc0000][size=3]Click Category Icons for Free Leech in Category [/size][/color][/b]	\n\n\n[b][color=#cc0000][size=3]Click Titles for Torrent Details Page[/size][/color][/b]\n\n\n";var l="\n\n\n[url=http://www.myanonamouse.net/browse.php?&cat=0&incldead=4][img]http://www.myanonamouse.net/pic/VIP.png[/img][/url][b]VIP[/b]	\n\n[b][color=#cc0000][size=3]All VIP Torrents are Always Free Leech[/size][/color][/b]";e.value=f+e.value+l;var c=document.getElementById("appendHF");c.style.display="none"}function staffPicksText(e){var t="";var n="";var r="";var s=false;var o=Object.keys(sections);var u=o.length;window.picks=[];for(i=0;i<e.length;i++){n=_getValue(e[i],"error");r=_getValue(e[i]+"t","error");if(n==="error"||r==="error")return["Empty list or error.",0,"Error."];for(j=0;j<u;j++){if(sections[j][0]==r||sections[j][0]==r.slice(0,-1)){picks[i]=[j,n,e[i]];break}}if(!picks[i])return["Encountered an error. Unwelcome probably spelled something incorrectly -- Please PM him the following:\n\n+"+i+"\n#"+e.join("#")+"\n\n     Thankee!",0,"Error."]}picks.sort(function(e,t){return e[0]-t[0]});var a=[];var f=[];var l=-1;for(i=0;i<picks.length;i++){if(l!=picks[i][0]){t+="\n\n[url="+sections[picks[i][0]][1]+"3][img]"+sections[picks[i][0]][2]+"[/img][/url][b]"+sections[picks[i][0]][0]+"[/b]\n";a.push(picks[i][0])}t+="[url=/details.php?id="+picks[i][2]+"][size=3][color=#3333ff]"+picks[i][1]+"[/color][/size][/url]\n";l=picks[i][0];if(f[picks[i][0]]){f[picks[i][0]][0]++;f[picks[i][0]][f[picks[i][0]][0]]=picks[i][2]}else{f[picks[i][0]]=[1];f[picks[i][0]][1]=picks[i][2]}}t=t.slice(2,-1);if(e.length===0)t="Nothing to see here.";var c;var h=a.length;for(i=0;i<h;i++){c=o.indexOf(a[i].toString());if(c>=0)o.splice(c,1)}var p="<h4 style='text-align:center;'>Sections not included in your picks</h4><br />";for(i=0;i<o.length;i++){p+="<a href='"+sections[o[i]][1]+"1' target='_blank' style='font-weight:bold;'><img src='"+sections[o[i]][2]+"' /><span style='font-weight:600; position: relative; top:-25px; left:3px;'>"+sections[o[i]][0]+"</span></a><br />"}p=p.slice(0,-6);if(h==89)p="<br /><h3 style='text-align:center'>You have picked at least one torrent from all sections.";var d="";if(h>0){d="<h4 style='text-align:center; margin-bottom:3px;'>Section totals</h4><span style='color:#C10983; text-align:right;'>Click to open all torrents<br />in that section.</span><br /><br />";var v="";for(i=0;i<u;i++){if(f[i]){v="";for(j=0;j<f[i][0];j++){v+="window.open('/details.php?id="+f[i][j+1]+"', '_blank'); "}d+="<span style='float:left; color:#5F5EC2; font-weight:600; margin-top:18px; margin-left:12px; cursor:pointer; font-size:10px; text-align:left;' onClick=\"window.open('"+sections[i][1]+"1','_blank')\">Click for more<br />"+sections[i][0]+'</span> <span onClick="javascript:'+v+"\" style='font-weight:bold; cursor:pointer; color: #C10983;'><span style='font-weight:600; position: relative; top:-25px; right:10px; font-size:12px;'>"+f[i][0]+"</span><img src='"+sections[i][2]+"' /></span><br />"}}}return[t,h,p,d]}function openStaffPicks(){var e=document.getElementById("openA").value;var t=document.getElementById("openB").value;var n=false;if(document.getElementById("staffPicksRemoveOnOpenCb").checked)n=true;try{var r=Math.round(t-e+1)}catch(s){alert("Enter valid integers, please.");return}if(!r||r<0||r>picks.length||t>picks.length){alert("Enter integers in a valid range, please.");return}var o=confirm("This will open up "+r+" tab(s). Are you sure?\n(p.s. check your pop-up blocker settings!)");if(!o)return;i=e-1;t=i+r;var u=setInterval(function(){if(i<t){window.open("/details.php?id="+picks[i][2],"_blank");if(n)remStaffPick(picks[i][3])}else window.clearInterval(u);i++},1e3)}function closeStaffPicks(){var e=document.getElementById("staffPicksDiv");if(!e)return;var t=document.getElementById("overlayDiv");e.parentNode.removeChild(e);t.parentNode.removeChild(t);if(torrId){staffPicksList=_getValue("staffPicksList","");staffPicksArray=[];if(staffPicksList)staffPicksArray=staffPicksList.split("#");staffPickExists=staffPicksArray.indexOf(torrId)>=0;if(staffPickExists){remStaffPickBtn.style.display="inline";addStaffPickBtn.style.display="none"}else{remStaffPickBtn.style.display="none";addStaffPickBtn.style.display="inline"}}}function clearStaffPicksList(e,t){if(e.length<=0){closeStaffPicks();return}if(!t){var n=confirm("This will remove all torrents from your list, are you sure?");if(!n)return}for(i=0;i<e.length;i++){_deleteValue(e[i]);_deleteValue(e[i]+"t")}_deleteValue("staffPicksList");closeStaffPicks()}function startFreeLeech(e){if(window.picks)closeStaffPicks();window.freeXMLDoc=document.createElement("html");window.freeLeechCount=0;window.freeLeechErrors=0;window.numPicks=e.length;window.freeLeechAbort=false;var t=document.createElement("div");t.id="overlayDiv2";t.setAttribute("style","position:fixed; height:100%; width: 100%; background-color: #000; margin: auto; top: 0; left: 0; z-index: 100; opacity: .7;");var n=window.innerWidth;var r=window.innerHeight;var i=r*.85/2;var s=r*.85;var o=n*.65/2;var u=n*.65;var a=document.createElement("div");a.id="freeLeechDiv";a.setAttribute("style","position: fixed; top:50%; left:50%; width:"+u+"px; height:"+s+"px; z-index: 150; opacity: 1; background-color: #FFF; margin-top:-"+i+"px; margin-left:-"+o+"px; padding: 5px; border: 3px solid #B59411; border-radius:5px;");var f=document.createElement("h3");f.innerHTML="Free Leech";f.setAttribute("style","line-height:15px;");var l=document.createElement("div");l.id="freeLeechTextDiv";l.innerHTML="Are you sure you want to make picks ("+window.numPicks+' total) free leech to all users? <br />Please note that by clicking "Yes" you are also unsetting the current staff picks off of freeleech.';l.setAttribute("style","padding-top:50px;padding-bottom:5px; width:80%; max-height: 50%; overflow:auto;");var c=document.createElement("input");c.setAttribute("type","button");c.setAttribute("style","cursor:pointer; border: 2px outset black; margin-top:4px; text-align: center;");c.value="Yes";c.addEventListener("click",function(){var t=confirm("Are you super sure you want to make all of these freeleech?");if(t){jsonFreeLeech(0,e);this.style.display="none"}},false);var h=document.createElement("input");h.type="button";h.id="freeLeechBackBtn";h.value="Back";var p=r*.15/2+10;h.setAttribute("style","margin-right: 10px; cursor:pointer; border: 2px outset black; margin-top:4px; text-align: center; position:fixed; bottom:"+p+"px; margin-left:-35px;");h.addEventListener("click",function(){closeFreeLeech(1)},false);a.appendChild(f);a.appendChild(l);a.appendChild(c);a.appendChild(h);contentTable.appendChild(a);contentTable.appendChild(t)}function closeFreeLeech(e){if(window.freeLeechCount>0){var t=confirm("No data from this view will be saved - any errors will be lost. Continue?");if(!t)return}var n=document.getElementById("freeLeechDiv");var r=document.getElementById("overlayDiv2");n.parentNode.removeChild(n);r.parentNode.removeChild(r);if(e){viewStaffPicks()}}function jsonFreeLeech(e,t){var n=document.getElementById("freeLeechTextDiv");if(!e){n.innerHTML="Processing. . .";openHTML("/json/admin/freeleech.php","jsonFreeLeech(1)","window.jsonLoad","newFree="+t.join(","))}else{if(window.jsonLoad.error){n.innerHTML="<strong>Error:</strong> "+window.jsonLoad.error;console.log(typeof window.jsonLoad.error)}else{n.innerHTML="Removed "+window.jsonLoad.removed+" past picks.";if(window.jsonLoad.succeeded)n.innerHTML+="<br /><br />Made "+window.jsonLoad.succeeded.split(",").length+" torrents free!";var r=window.jsonLoad.failed?window.jsonLoad.failed.split(","):undefined;if(r){n.innerHTML+="<br /> Failed to make the following torrents free leech:<br />";for(i=0;i<r.length;i++){var s=_getValue(r[i],"???");n.innerHTML+="<a href='/details.php?id="+r[i]+"' style='color:red;' target='_blank'>"+s+"</a><br />"}n.innerHTML+="</div>"}else n.innerHTML+="<br/>No errors."}}}function freeLeech(e){window.freeLeechCount++;if(e.length>0){if(window.freeLeechAbort)freeLeechProgress("","Abort",0,1);else applyFreeLeech(0,e.pop(),e)}else freeLeechProgress("","",0,1)}function freeLeechProgress(e,t,n,r){var i=document.getElementById("freeLeechStatusText");var s=document.getElementById("freeLeechStatusNum");if(r){var o=document.getElementById("freeLeechAbortBtn");o.style.display="none";var u=document.getElementById("freeLeechBackBtn");u.style.display="inline";var a=document.getElementById("freeLeechClose");a.style.display="inline";var f=document.getElementById("freeLeechCloseBtn2");f.style.display="inline";if(t==="Abort")i.innerHTML="Process aborted.";else i.innerHTML="Finished processing torrents.";if(window.freeLeechErrors>0)i.innerHTML+="<br /><span style='font-weight:bold; color: red;'>Encountered "+window.freeLeechErrors+" error(s). See below.</span>";return}var l=_getValue(e,"???");var c=_getValue(e+"t","???");s.innerHTML=window.freeLeechCount;i.innerHTML="<span style='color: #a66f00;'>"+l+" ("+e+") </span><br /><span style='color:grey;'>"+t+"</span>";if(!n){if(t==="Success!"){var h=document.getElementById("freeLeechCompletedText");h.innerHTML+="<a href='/details.php?id="+e+"' style='color:#1240ab;' target='_blank'>"+l+"</a> <img src='/pic/freedownload.gif'>"+"<br /><span style='font-size:9px; color: grey'>"+c+"</span><br /><br />"}}else{window.freeLeechErrors++;if(window.freeLeechErrors>10){window.freeLeechAbort=true;alert("Aborting operation. Too many errors.")}var p=document.getElementById("freeLeechErrorText");p.parentNode.style.display="block";p.innerHTML+="<a href='/details.php?id="+e+"' style='color:red;' target='_blank'>"+l+"</a> <br /><span style='color:grey;'>"+t+"</span><br /><br />"}}function applyFreeLeech(e,t,n,r){if(!e){freeLeechProgress(t,"Fetching torrent info...");openHTML("/details.php?id="+t,"applyFreeLeech(1,"+t+","+JSON.stringify(n)+")",freeXMLDoc)}else if(e==1){if(r){freeLeechProgress(t,"Error fetching torrent info. :(",1);freeLeech(n);return}freeLeechProgress(t,"Applying free leech...");var s=freeXMLDoc.getElementsByTagName("h1")[0];if(!s){freeLeechProgress(t,"Error. Deleted?",1);freeLeech(n);return}var o=s.nextSibling.nextSibling.getElementsByTagName("table")[0];var u=o.nextSibling.nextSibling;var a=u.getElementsByClassName("row2");var f="";for(i=0;i<11;i++){if(a[i].innerHTML.slice(0,4)=="Type"){var l=a[i].nextSibling.innerHTML;break}else if(a[i].innerHTML=="Description"){var c=a[i].nextSibling.innerHTML;if(a[i].parentNode.previousElementSibling.firstChild.innerHTML=="Small Description"){f=a[i].parentNode.previousElementSibling.firstChild.nextElementSibling.firstChild.nodeValue}}}var h=u.getElementsByTagName("img")[0].src;var p=s.firstChild.nodeValue;p=p.replace(/ /gi," ");console.log(c);c=c.replace(/(\s| )?/g,"");c=c.replace(/(\s| )?/g,"");c=c.replace(/ /gi," ");c=c.replace(/<p>\s+<\/p>/g,"\r\n");c=c.replace(/([^\.])\s{2,}/g,"$1 ");c=c.replace(/<br>(\n|\r)</gi,"<br><br>\r\n<");c=c.replace(/<br>(\n|\r)/gi,"\r\n");console.log("x");console.log(c);c+="<span style='color:#f7f7f7; font-size:0pt;'>"+now.getTime()+"</span>";var d=Object.keys(sections);for(i=0;i<d.length;i++){if(l===sections[i][0]){l=/&cat=(\d+?)&/.exec(sections[i][1])[1];break}}window.freeXMLDoc=document.createElement("html");openHTML("/takeedit.php/","applyFreeLeech(2,"+t+","+JSON.stringify(n)+")",freeXMLDoc,[[["id"],[t]],[["name"],[p]],[["description"],[f]],[["poster"],[h]],[["descr"],[c]],[["type"],[l]],[["visible"],["1"]],[["free"],["1"]]],1)}else{if(r){freeLeechProgress(t,"Error applying freeleech!",1);freeLeech(n);return}else{if(freeXMLDoc.getElementsByTagName("h2")[0])freeLeechProgress(t,"Error applying freeleech. Missing data.",1);else freeLeechProgress(t,"Success!")}freeLeech(n)}}function makeSearchString(e){e=e.replace(/\d{1,2}-\d{1,3}/gi,"");e=e.replace(/\s#?\d+(\s|$)/gi," ");e=e.replace(/[:,_\.(){}\-\[\]]/g," ");e=e.replace(/(\W|^)(epubs?|mobis?|kindle|lits?|html?|ipad|pdfs?|mp\d|flac|format|docx?|audios|(e[\s\-]?)?books?|ipod)(\W|$)/gi,"");for(i=0;i<3;i++){e=e.replace(/(\W|^)(audios?|read|the|that|for|and|of|a|at|from|req(uested)?|by chapter|by|complete|series|in|ua|(un)?abridged|(\d\u0040)?#?\d*(.\d+)?[mk]?)(\W|$)/gi," ")}e=e.replace(/\s{2,}/g," ");e=e.replace(/^\s+|\s+$/g,"");return e}function iFrameChecker(funct){if(document.getElementsByTagName("iframe")[0])eval(funct);else setTimeout(function(){iFrameChecker(funct)},250)}function fillReseed(e){if(e==1){var t=document.getElementById("body_ifr").contentDocument.getElementsByTagName("body")[0];var n="<p>I would like to request a reseed for:<br>		[url=/details.php?id="+reseedReq[1]+"]"+decodeURI(reseedReq[2])+"[/url]		</p><p><br></p><p>Thank you!</p>";t.innerHTML=n}else{var r=contentTable.getElementsByTagName("input");for(i=0;i<r.length;i++){if(r[i].name=="subject"){r[i].value=decodeURI(reseedReq[2]);r[i].setAttribute("onclick","this.select();");break}}iFrameChecker("fillReseed(1)")}}function userDetailsReds(e,t){var n=document.getElementById("snatchedTable");if(t>=0){n.style.visibility="visible";document.getElementById("snatch1").innerHTML=e[0];document.getElementById("snatch2").innerHTML=e[1];document.getElementById("snatch3").innerHTML=e[2];document.getElementById("snatch4").innerHTML=e[3];document.getElementById("snatch5").innerHTML=e[4];document.getElementById("snatch6").innerHTML=e[5];document.getElementById("per").innerHTML="Reds account for <strong>"+t+"%</strong> of torrents."}else{n.parentNode.parentNode.firstChild.setAttribute("colspan","2");n.parentNode.parentNode.removeChild(n.parentNode)}}function foobar(){noXMLDoc.querySelector("#modcomment").innerHTML="Moo\n"+noXMLDoc.querySelector("#modcomment").innerHTML;try{var e=noXMLDoc.getElementsByTagName("form")[1];e.submit}catch(t){console.log(t)}}function clickableIPs(){window.contentTable.innerHTML=window.contentTable.innerHTML.replace(/((\d+\.){3}\d+)/g,"<a target='_blank' href='http://www.ip-adress.com/ip_tracer/$1'>$1</a>")}function toggleExpandPMs(){var e=document.getElementById("expandPMsBtn");var t=contentTable.getElementsByTagName("div");if(/expand/i.test(e.value)){for(i=1;i<t.length-1;i++){if(!t[i].firstElementChild)break;t[i].style.display="block";try{t[i].parentNode.getElementsByTagName("img")[0].src="pic/minus.gif"}catch(n){console.log(n)}}e.value="Collapse All"}else{for(i=1;i<t.length-2;i++){if(!t[i].firstElementChild)break;t[i].style.display="none";try{t[i].parentNode.getElementsByTagName("img")[0].src="pic/plus.gif"}catch(n){}}e.value="Expand again! :-D Wheeeee"}}function harvestPicks(){var e=[];var t=contentTable.getElementsByTagName("a");var n=/\/details.php\?id=(\d+)/;var r;for(i=0;i<t.length;i++){if(r=n.exec(t[i].getAttribute("href"))){e.push(r[1])}}if(e.length<=0){alert("Nothing to reap");return}var s=document.createElement("div");s.id="hOverlayDiv";s.setAttribute("style","position:fixed; height:100%; width: 100%; background-color: #000; margin: auto; top: 0; left: 0; z-index: 100; opacity: .7;");var o=window.innerWidth;var u=window.innerHeight;var a=u*.75/2;var f=u*.75;var l=o*.75/2;var c=o*.75;var h=document.createElement("div");h.id="harvestDiv";h.setAttribute("style","position: fixed; top:50%; left:50%; width:"+c+"px; height:"+f+"px; z-index: 150; opacity: 1; background-color: #FFF; margin-top:-"+a+"px; margin-left:-"+l+"px; padding: 5px; border: 3px solid green; border-radius:5px;");var p=document.createElement("img");p.id="harvestClose";p.src=genCloseSrc;var d=u*.125+1;var v=o*.875-12.5-5;p.setAttribute("style","cursor: pointer; height: 25px; position:fixed; top:"+d+"px; left:"+v+"px;");p.addEventListener("click",function(){closeHarvest()},false);var m=document.createElement("h2");m.innerHTML="Harvesting...";window.harvestProgress=document.createElement("div");window.harvestProgress.setAttribute("style","max-height:200px; text-align:center; margin-top: 20px; overflow:auto; margin-bottom:8px;");h.appendChild(m);h.appendChild(window.harvestProgress);h.appendChild(p);contentTable.appendChild(s);contentTable.appendChild(h);var g=confirm("Proceed?");if(!g){closeHarvest();return}var y=_getValue("staffPicksList","");window.staffPicksArray=[];if(y)window.staffPicksArray=y.split("#");window.staffPicksArray.shift();if(window.staffPicksArray.length>0)g=confirm("Click 'Cancel' to clear your current list before proceeding.");if(!g){window.staffPicksArray=[];window.clearPicks=true}else window.clearPicks=false;window.harvestXMLDoc=document.createElement("html");window.harvestCount=0;window.harvestLength=e.length;window.currHarvest;window.harvestArray=[];window.harvestErrArray=[];window.abortHarvest=false;reapPicks(0,e)}function reOpenHarvest(){var e=document.getElementById("hOverlayDiv");var t=document.getElementById("harvestDiv");e.style.display="inline";t.style.display="inline"}function closeHarvest(){window.abortHarvest=true;var e=document.getElementById("hOverlayDiv");var t=document.getElementById("harvestDiv");e.style.display="none";t.style.display="none"}function reapPicks(cycle,remaining,error){remaining=eval(remaining);if(window.abortHarvest){harvestProgress(2);return}if(error){window.harvestErrArray.push([window.currHarvest,"Connection error."]);reapPicks(0,remaining);return}if(!cycle){if(remaining.length>0){window.harvestCount++;window.currHarvest=remaining.pop();harvestProgress();if(window.staffPicksArray.indexOf(window.currHarvest)>=0){window.harvestErrArray.push([window.currHarvest,"Torrent already on list."]);reapPicks(0,remaining);return}for(i=0;i<=window.harvestArray.length;i++){if(!window.harvestArray[i])break;if(window.harvestArray[i][0]==window.currHarvest){window.harvestErrArray.push([window.currHarvest,"Duplicate selection."]);reapPicks(0,remaining);return}}openHTML("/details.php?id="+window.currHarvest,"reapPicks(1,"+JSON.stringify(remaining)+")",window.harvestXMLDoc)}else harvestProgress(1)}else{var torrTitle=window.harvestXMLDoc.getElementsByTagName("h1")[0];if(!torrTitle){window.harvestErrArray.push([window.currHarvest,"Error. Deleted?"]);reapPicks(0,remaining);return}var type=window.harvestXMLDoc.querySelector("#cat").innerHTML;var title=torrTitle.firstChild.nodeValue;window.harvestArray.push([window.currHarvest,title,type]);reapPicks(0,remaining)}}function harvestProgress(e){if(e==1){window.harvestProgress.innerHTML="Adding picks...";if(window.clearPicks==true){for(i=0;i<window.staffPicksArray.length;i++){_deleteValue(window.staffPicksArray[i]);_deleteValue(window.staffPicksArray[i]+"t")}}var t=[];var n;for(i=0;i<window.harvestArray.length;i++){n=window.harvestArray[i][0];_setValue(n,window.harvestArray[i][1]);_setValue(n+"t",window.harvestArray[i][2]);t.push(n)}var r="#"+window.staffPicksArray.concat(t).join("#");_setValue("staffPicksList",r);var s=window.harvestCount-window.harvestErrArray.length;window.harvestProgress.innerHTML="Done! Secured "+s+" torrents.";if(window.harvestErrArray.length>0){window.harvestProgress.innerHTML+="<br /><br />The following torrent IDs were not added:";for(i=0;i<window.harvestErrArray.length;i++){window.harvestProgress.innerHTML+="<br />"+window.harvestErrArray[i][0]+" - "+window.harvestErrArray[i][1]}}else window.harvestProgress.innerHTML+=" No errors.";var o=document.createElement("input");o.type="button";o.value="View List & Apply Free Leech";o.addEventListener("click",function(){harvestBtn.removeEventListener("click",harvestPicks,false);harvestBtn.addEventListener("click",reOpenHarvest,false);closeHarvest();viewStaffPicks()},false);window.harvestProgress.parentNode.appendChild(document.createElement("br"));window.harvestProgress.parentNode.appendChild(o)}else if(e==2){alert("Your Staff Picks list was not altered.");return}else{window.harvestProgress.innerHTML="Harvesting pick "+window.currHarvest+" ("+window.harvestCount+" of "+window.harvestLength+")."}}function postPicksToThread(e){var t=_getValue("staffPicksList","");var n=[];if(t)n=t.split("#");n.shift();if(e==1){var r=confirm("Would you like to clear your Staff Picks list?");if(r)clearStaffPicksList(n,true);document.location.reload(true)}else{var i=document.getElementById("postPicksBtn");i.removeEventListener("click",postPicksToThread,false);i.style.cursor="wait";var s=/topicid=(\d+)/.exec(url)[1];openHTML("/forums.php/","postPicksToThread(1)",noXMLDoc,[[["action"],["post"]],[["topicid"],[s]],[["body"],[staffPicksText(n)[0].replace(/\n/gm,"<br>")]]],1)}}function startExchange(e){if(window.abortExchange)return;var t=document.getElementById("exSelect").selectedIndex;var n;if(t==0)n=500;else if(t==1)n=1e3;else if(t==2)n=1500;else n=5500;var r=20*60*1e3;if(e<n){window.exStatus.innerHTML="Waiting. Will check for more bonus points in:";console.log(window.exCounterCurr);if(window.exCounterCurr>0){var i=parseFloat(document.getElementsByTagName("nobr")[1].innerHTML)+window.exCounterCurr;var s=timestamp()+": "+window.exCounterCurr+" / "+i+" pts";window.exLog.value+=exLog.value?"\n"+s:s;window.exCounterCurr=0}exchangeTimer(r);return}openHTML("/json/bonusBuy.php?spendtype=upload&amount=5","processExchange("+e+")",noXMLDoc)}function processExchange(e){window.status.innerHTML="Exchanging points...";window.timeSpan.innerHTML="--:--";var t=parseInt(window.exCounter.innerHTML.replace(/,/g,""));t+=500;window.exCounter.innerHTML=commafy(t);window.exCounterCurr+=500;var n=document.getElementsByTagName("nobr")[1];var r=parseFloat(n.innerHTML.replace(/,/g,""))-500;n.innerHTML=r.toFixed(1);console.log(n.innerHTML);startExchange(e-500)}function exchangeTimer(e){if(abortExchange)return;var t=Math.round(e/1e3%60);if(t<10)t="0"+t;var n=Math.floor(e/6e4%60);if(n<10)n="0"+n;timeSpan.innerHTML=n+":"+t;if(e<1e3){getBonusPts(0,1)}else setTimeout(function(){exchangeTimer(e-1e3)},1e3)}function getBonusPts(e,t){if(!e){openHTML("/jsonLoad.php","getBonusPts(1,"+t+")","window.jsonLoad")}else{var n=document.getElementById("bonusLink");var r=document.getElementById("RatioTD");var i=document.getElementById("uploadedTD");var s=document.getElementById("downloadedTD");n.innerHTML="Bonus: "+commafy(window.jsonLoad.seedbonus);r.innerHTML="Ratio "+commafy((window.jsonLoad.uploaded/window.jsonLoad.downloaded).toFixed(2));i.innerHTML="<img src='/pic/arrowup.gif'> "+bytesToSize(window.jsonLoad.uploaded,2);s.innerHTML="<img src='/pic/arrowdown.gif'> "+bytesToSize(window.jsonLoad.downloaded,2);if(t==1){window.exStatus.setAttribute("style","font-size:13px;");startExchange(window.jsonLoad.seedbonus)}if(window.exStatus&&n.innerHTML.split(":")[1]!=" Click For Current"){setTimeout(function(){if(window.abortExchange)return;n.innerHTML="Bonus: Click For Current";n.setAttribute("href","javascript:void(0);");if(features.bonus)document.getElementById("bonusBtn").style.display="none";r.innerHTML="Ratio: N/A";i.innerHTML="<img src='/pic/arrowup.gif'>  N/A";s.innerHTML="<img src='/pic/arrowdown.gif'>  N/A";n.removeEventListener("click",clickCurr,false);n.addEventListener("click",clickCurr,false)},3e4)}if(features.bonus)document.getElementById("bonusBtn").style.display="inline"}}function clickCurr(){if(this.innerHTML!=" Click For Current")return;getBonusPts(0)}function exchangeErr(e,t){var n=Date(now);window.exStatus.innerHTML="Error exchanging bonus points. "+t+"<br />"+n;window.exStatus.setAttribute("style","color:red; font-size:14px;");window.timeSpan.innerHTML="--:--";document.getElementById("exCancel").setAttribute("style","display:none;");window.abortExchange=true;setTimeout(function(){window.abortExchange=false;getBonusPts(0,1)},9e5)}function giftMore(){giftSubmit.removeEventListener("click",giftMore,false);giftSubmit.value="Processing";giftSubmit.style.cursor="wait";if(giftSelect.selectedIndex<=4){console.log(window.username);if(window.username){var e;if(giftSelect.selectedIndex==0)e="20.0";else if(giftSelect.selectedIndex==1)e="50.0";else if(giftSelect.selectedIndex==2)e="100.0";else if(giftSelect.selectedIndex==3)e="200.0";else if(giftSelect.selectedIndex==4)e="500.0";else e="1000.0";if(parseInt(window.bonusPoints.innerHTML.replace(/,/,""))<e){alert("Insufficient karma.");return}openHTML("/mybonus.php?exchange=1","finishGiftMore(0,'',true)",noXMLDoc,"option=7&art=gift_1&username="+window.username+"&bonusgift="+e)}else{giftSubmit.parentNode.parentNode.previousElementSibling.getElementsByTagName("form")[0].submit()}}else{if(giftSelect.selectedIndex==5)var e=1e3;else if(giftSelect.selectedIndex==6)var e=5e3;else var e=9e3;if(parseInt(window.bonusPoints.innerHTML.replace(/,/,""))<e){alert("Insufficient karma.");return}if(!window.username){var t=giftSubmit.parentNode.parentNode.getElementsByTagName("input");window.username=t[0].value}else{var n=true}var r=e/500-1;openHTML("/mybonus.php?exchange=1","finishGiftMore("+r+",'"+window.username+"',"+n+")",noXMLDoc,"option=7&art=gift_1&username="+window.username+"&bonusgift=500.0")}}function finishGiftMore(e,t,n){e=parseInt(e);if(e==0){window.scrollTo(0,top);getBonusPts(0);giftSubmit.value="Gift Karma!";giftSubmit.style.cursor="default";giftSubmit.addEventListener("click",giftMore,false);if(n){sendKarmaDiv.style.display="none";alert("Gift given :-)")}return}e--;openHTML("/mybonus.php?exchange=1","finishGiftMore("+e+",'"+window.username+"',"+n+")",noXMLDoc,"option=7&art=gift_1&username="+window.username+"&bonusgift=500.0")}function fixBBCode(e,t,n){var r=0;var s=e.innerHTML;var o=e.getElementsByTagName("div");if(n==0)s=s.replace(/^[\s\r\n]+?([\w<])/,"$1");if(o.length>2){for(i=0;i<o.length-1;i++){if(o[i].parentNode.innerHTML.replace(/^\s+|\s+$/g,"")==o[i].outerHTML){o[i].outerHTML=o[i].innerHTML;r++}}}if(r>0)r="Removed "+r+" nested divs.\r\n";else r="";var u=s;s=s.replace(/<div.*?>/g,"<p>");s=s.replace(/<\/div>/g,"</p>");if(u!=s)r+="Replaced divs with paragraph tags.\r\n";tmpA=s;s=s.replace(/<p.*?>/g,"<br><br>");s=s.replace(/<\/p>/g,"<br><br>");if(u!=s)r+="Replaced paragraph tags with breaks.\r\n";u=s;s=s.replace(/^\s*(<br>\s*){1,2}|(\s*<br>){1,2}\s*$/g,"");if(t)s=s.replace(/^\s{0,4}(<span id="summary">.+?<\/span>)\s*(<br>){1,6}/,"$1");if(t)s=s.replace(/((\s| )*<br>(\s| )*){1,2}<br id="sp1">/,'<br id="sp1">');s=s.replace(/(\s*<br>\s*<br>){1,2}/g,"<br><br>");s=s.replace(/([^\.])\s{2,}/g,"$1 ");s=s.replace(/(<br>)?<blockquote>(\s*<br>\s*){0,2}(.+?)(\s*<br>\s*){0,3}<\/blockquote>/g,"<blockquote>$3</blockquote>");if(u!=s)r+="Fixed blockquote or removed extraneous spaces.\r\n";e.innerHTML=s;if(t){console.log(s);console.log(n+"\nWork done: "+r);n++;if(r!==""&&n<8)fixBBCode(e,true,n)}else{if(r=="")r="Nothing changed.";console.log(s);console.log(n+"\nWork done: "+r);var a=e.scrollHeight;document.getElementById("descr_ifr").style.height=a+"px";alert(r)}}function fixUploadIFrame(){var e=document.getElementById("descr_ifr");var t=e.contentDocument.getElementsByTagName("body")[0];var n=document.createElement("input");n.type="button";n.value="Fix various things (nested divs, blockquotes, etc.)";n.setAttribute("style","margin-left:15px;");n.addEventListener("click",function(){fixBBCode(t)},false);document.getElementById("descr_parent").parentNode.appendChild(n)}function searchingElipses(e){if(window.searchingElipsesAbort>window.sitesCount-1){window.uploadHelperBtn.innerHTML="Search for metadata";uploadHelperBtn.setAttribute("style","margin-left: 7px; background:blue; border-radius:3px; border:solid black 2px; color: white;");window.uploadHelperBtn.addEventListener("click",uploadHelper,false);if(features.UHAutomate)automateFurther();return}setTimeout(function(){if(e<4){window.uploadHelperBtn.innerHTML+=".";searchingElipses(e+1)}else{window.uploadHelperBtn.innerHTML="Searching";searchingElipses(0)}},400)}function automateFurther(state,data,data2,doubleCheck){if(!state){window.autoState=window.numPosters=0;try{if(window.UHSearchResults.length>0)eval(window.UHSearchResults.shift());else{automateFurtherErr("No info found");return}}catch(e){console.log(e);automateFurtherErr(e+" - Fetching info from "+data)}}else if(state==1){try{if(window.UHSearchResults.length>0)eval(window.UHSearchResults.shift());else{window.autoState=2;automateFurther(2,null,null,true)}}catch(e){console.log(e);automateFurtherErr(e+" - Fetching info from "+data)}}else if(state==2){if(!window.autoPosters)window.autoPosters=[];var needed=0;if(window.posterImgAmz.src)needed++;if(window.posterImgFF.src)needed++;if(window.posterImgGR.src)needed++;if(window.posterImgBN.src)needed++;if(window.posterImgWiki.src)needed++;if(window.posterImgUser.src)needed++;if(doubleCheck){if(!window.autoPosters.length)return;console.log("DoubleChecking ---");console.log(window.numPosters+" vs. "+needed+"\n"+window.autoPosters+"\n"+window.autoState);if(window.numPosters<needed||window.autoState<2)return}else{window.autoPosters.push([data,data2]);window.numPosters++;console.log(window.numPosters+" vs. "+needed+"\n"+window.autoPosters+"\n"+window.autoState);if(window.numPosters<needed||window.autoState!=2)return}if(window.posterImgUser.src)window.autoPosters.push([parseInt(window.posterImgUserDim.innerHTML.split("x")[1]),window.posterImgUser]);if(!window.autoPosters.length){automateFurtherErr("Error obtaining a suitable poster.");automateFurther(3);return}if(window.autoPosters.length>1)window.autoPosters.sort(function(e,t){var n=weight2=weight3=weight4=1;if(e[1]==window.posterImgGR)n=1.25;else if(e[1]==window.posterImgFF)n=1.18;if(e[0]>475)weight2=475/(1.12*e[0]);if(t[1]==window.posterImgGR)weight3=1.25;else if(t[1]==window.posterImgFF)weight3=1.18;if(t[0]>475)weight4=475/(1.12*t[0]);var r=t[0]*weight3*weight4-e[0]*n*weight2;console.log("Comparing "+e[1].src+" with weight "+n*weight2+" to "+t[1].src+" with weight "+weight3*weight4+"\nResult: "+r);return r});if(window.autoPosters[0][0]<=75){automateFurtherErr("Error obtaining a suitable poster.");automateFurther(3);return}window.posterImgAmz.style.border="none";window.posterImgAmz.style.maxHeight="200px";window.posterImgGR.style.border="none";window.posterImgGR.style.maxHeight="200px";window.posterImgFF.style.border="none";window.posterImgFF.style.maxHeight="200px";window.posterImgWiki.style.border="none";window.posterImgWiki.style.maxHeight="200px";window.posterImgBN.style.border="none";window.posterImgBN.style.maxHeight="200px";window.posterImgSMP.style.border="none";window.posterImgSMP.style.maxHeight="200px";window.posterImgUser.style.border="none";window.posterImgUser.style.maxHeight="200px";window.autoPosters[0][1].setAttribute("style","display:block; max-width:230px; max-height:197px; cursor: pointer; margin-left:5px; margin-right:5px; border: solid green 3px; border-radius: 3px");window.posterInput.value=autoPosters[0][1].src;window.autoState=3;automateFurther(3)}else if(state==3){var amz=window.AmzDescriptionDiv;var gr=window.GRDescriptionDiv;var ff=window.FFDescriptionDiv;var wiki=window.WikiDescriptionDiv;var bn=window.BNDescriptionDiv;var adbl=window.AdblDescriptionDiv;var descriptionSeries;var descriptionPages;if(adbl.innerHTML){if(/bridged/i.test(wiki.innerHTML)){if(!descriptionPages)descriptionPages=adbl}else if(!descriptionSeries)descriptionSeries=adbl}if(gr.innerHTML){if(/\d pages/i.test(gr.innerHTML)){if(!descriptionPages)descriptionPages=gr}else if(!descriptionSeries)descriptionSeries=gr}if(ff.innerHTML){if(/\d pages/i.test(ff.innerHTML)){if(!descriptionPages)descriptionPages=ff}else if(!descriptionSeries)descriptionSeries=ff}if(amz.innerHTML){if(/\d pages/i.test(amz.innerHTML)){if(!descriptionPages)descriptionPages=amz}else if(!descriptionSeries)descriptionSeries=amz}if(bn.innerHTML){if(/\d pages/i.test(bn.innerHTML)){if(!descriptionPages)descriptionPages=bn}else if(!descriptionSeries)descriptionSeries=bn}if(wiki.innerHTML){if(/\d pages/i.test(wiki.innerHTML)){if(!descriptionPages)descriptionPages=wiki}else if(!descriptionSeries)descriptionSeries=wiki}window.descriptionInput.value="";if(descriptionSeries)placeDescription(descriptionSeries);if(descriptionPages)placeDescription(descriptionPages,true);if(window.userDefFileTypes){var nextType;var typeRegEx;for(i=0;i<window.userDefFileTypes.length;i++){nextType=window.userDefFileTypes[i];typeRegEx=new RegExp(nextType,"ig");if(!typeRegEx.test(window.descriptionInput.value)){if(window.descriptionInput.value)window.descriptionInput.value+=", ";window.descriptionInput.value+=nextType}}}automateFurther(4)}else if(state==4){var longestSite;var sites=Object.keys(descrBody[0]);sites.sort(function(e,t){var n=descrBody[0][e].replace(/<.+?>|\s/gi,"").length;var r=descrBody[0][t].replace(/<.+?>|\s/gi,"").length;return r-n});if(descrBody[0][sites[0]].length>50){if(sites[0]=="Wikipedia"&&sites[1]!="User Defined")longestSite=sites[1];else longestSite=sites[0]}console.log(sites);console.log("Chosen longest site: "+longestSite);if(longestSite){loadDescr(longestSite,true)}else automateFurtherErr("No description available.");searchForDupes2(dupeTerms(window.titleInput.value),"dupeDiv",window.typeSelect.options[typeSelect.selectedIndex].innerHTML.slice(0,2));searchForRDupes2(dupeTerms(window.titleInput.value),"reqDiv",window.typeSelect.options[typeSelect.selectedIndex].innerHTML.slice(0,2))}}function automateFurtherErr(e){if(window.titleInst.style.display=="none")alert("Automation Failure:\n\n"+e);window.titleInst.style.color="red";window.titleInst.style.fontWeight="bold";window.titleInst.innerHTML=e}function uploadHelper(){if(window.titleInput.value==window.nameInit||window.titleInput.value==""){alert("Search terms needed.");return}window.uploadHelperBtn.removeEventListener("click",uploadHelper,false);window.uploadHelperBtn.innerHTML="Searching";window.uploadHelperBtn.style.width="8em";window.uploadHelperBtn.style.textAlign="left";window.searchingElipsesAbort=0;window.uploadHelperBtn.style.background="red";searchingElipses(0);window.titleInst.innerHTML='Click on matching title<span style="text-decoration:underline">s</span> (one per site):';titleInst.setAttribute("style","padding-bottom:2px; padding-top: 2px;font-size:small");if(descriptionInputOrig.parentNode.parentNode)descriptionInputOrig.parentNode.parentNode.replaceChild(window.descriptionTd,descriptionInputOrig.parentNode);var e=makeSearchString(window.titleInput.value);console.log(e);var t=false;window.sitesCount=0;if(window.fileTypes&&window.fileTypes.audio){if(window.fileTypes.audio>=2*window.fileTypes.ebook)t=true}else if(window.userDefFileTypes){var n=new RegExp(window.audioFormats);if(n.test(window.userDefFileTypes.join(" ")))t=true}if(t){_openHTML("http://www.amazon.com/s?url=node%3D368395011&field-keywords="+encodeURI(e),"Amazon.com");_openHTML("http://www.barnesandnoble.com/s/"+encodeURI(e)+"?store=book&aref=1518","Barns & Noble")}else{_openHTML("http://www.amazon.com/s?url=search-alias%3Dstripbooks&field-keywords="+encodeURI(e),"Amazon.com");_openHTML("http://www.barnesandnoble.com/s/"+encodeURI(e)+"?store=book","Barns & Noble")}window.sitesCount=2;if(t||window.editPage[1]!="upload"){_openHTML("http://www.audible.com/search/","Audible",null,encodeURI(e));window.sitesCount++}_openHTML("http://www.goodreads.com/search?query="+encodeURI(e),"goodreads");_openHTML("http://www.fantasticfiction.co.uk/db-search/v2/books/?bq=db:%27FF%27&q="+encodeURI(e)+"&start=0&size=4&rank=-visits_us&return-fields=title,authorsinfo,pfn","Fantastic Fiction");_openHTML("https://en.wikipedia.org/w/api.php?action=query&srlimit=6&format=json&srredirects=false&list=search&srprop=wordcount&srsearch="+encodeURI(e),"Wikipedia");window.sitesCount+=3;if(!features.UHAutomate||window.editPage[1]!="upload"){_openHTML("http://www.sheetmusicplus.com/search?q="+encodeURI(e),"Sheet Music Plus");window.sitesCount++}}function _openHTML(e,t,n,r){console.log(e);GM_xmlhttpRequest({method:r?"POST":"GET",data:"filterby=field-keywords&advsearchKeywords="+r,headers:{"Content-Type":r?"application/x-www-form-urlencoded":""},url:e,onload:function(r){var i=document.createElement("HTML");i.innerHTML=r.responseText;if(!n)parseSearchResults(i,t);else parseBookPage(t,i,e)},timeout:9e3,onerror:function(){if(!n){console.log("Connection error");window.titleInput.parentNode.firstElementChild.nextElementSibling.nextElementSibling.innerHTML="Connection Error.";window.searchingElipsesAbort=5}else manageTitleLists("timeout",window.titlePicks[t],t)},ontimeout:function(){console.log("In Timeout: "+n);if(!n){var e=document.createElement("div");e.id=t;var r=document.createElement("span");r.setAttribute("style","text-decoration:underline; display: block; padding-bottom:2px;");r.innerHTML=t;e.appendChild(r);var i=document.createElement("span");i.style.color="#FF00CB";i.innerHTML="No Results. Network error.";e.appendChild(i);var s=document.getElementById(t);if(s)s.parentNode.removeChild(s);window.titleResultsDiv.appendChild(e);window.searchingElipsesAbort++}else manageTitleLists("timeout",window.titlePicks[t],t)}})}function parseSearchResults(response,site){window.searchingElipsesAbort++;var matchFound;var results=[[],[],[],[]];if(site==="Amazon.com"){var curr;var currA;try{for(i=0;i<4;i++){curr=response.querySelector("#result_"+i);if(!curr)break;try{results[0][i]=curr.querySelector("a.title");results[1][i]=results[0][i].innerHTML;try{results[2][i]=/by\s(.+)/i.exec(results[0][i].parentNode.querySelector(".ptBrand").innerHTML.replace(/<.+?>/g,""))[1]}catch(e){results[2][i]="N/A"}results[3][i]=results[0][i].href}catch(e){if(curr.children.length<5)break;try{results[0][i]=curr.querySelector(".lrg");results[1][i]=results[0][i].innerHTML;try{results[2][i]=/by\s(.+)/i.exec(results[0][i].parentNode.nextElementSibling.innerHTML.replace(/<.+?>/g,""))[1]}catch(n){results[2][i]="N/A"}results[3][i]=results[0][i].parentNode.href}catch(f){console.log(e+"\n"+f)}}}}catch(g){console.log(g)}console.log(results);if(results[1][0])matchFound=true}else if(site==="goodreads"){console.log(response);results[0]=response.querySelectorAll("a.bookTitle");for(i=0;i<results[0].length&&i<4;i++){try{results[1][i]=results[0][i].firstElementChild.innerHTML;results[2][i]=results[0][i].nextElementSibling.nextElementSibling.nextElementSibling.firstElementChild.firstElementChild.innerHTML;results[3][i]=results[0][i].href.replace(/myanonamouse.net/,"goodreads.com")}catch(e){console.log(e);results[1][i]="Error Fetching";results[2][i]="";results[3][i]="127.0.0.0"}}if(response.querySelector("a.bookTitle"))matchFound=true}else if(site==="Fantastic Fiction"){var returned=response.getElementsByTagName("body")[0].innerHTML.slice(0,-33);eval(returned);for(i=0;i<json.hits.hit.length;i++){results[1][i]=json.hits.hit[i].data.title[0];results[2][i]=json.hits.hit[i].data.authorsinfo[0].split("|")[1];results[3][i]="http://www.fantasticfiction.co.uk/"+json.hits.hit[i].data.pfn[0]}if(json.hits.hit.length>0)matchFound=true}else if(site==="Wikipedia"){var returnedBody=response.getElementsByTagName("body")[0];var queryJSON=JSON.parse(returnedBody.innerHTML);for(i=0;i<queryJSON.query.search.length&&results[1].length<4;i++){if(queryJSON.query.search[i].wordcount>125){results[1].push(queryJSON.query.search[i].title);results[2].push("");results[3].push("http://www.en.wikipedia.org/wiki/"+encodeURI(queryJSON.query.search[i].title))}}if(results[1].length>0)matchFound=true}else if(site=="Barns & Noble"){for(i=0;i<4;i++){results[0][i]=response.querySelector("#search-result"+i);if(results[0][i]){var titleA;try{titleA=results[0][i].querySelector(".title");results[3][i]=titleA.getAttribute("data-bn-rel");if(!results[3][i])results[3][i]=titleA.href;if(titleA.firstElementChild)results[1][i]=titleA.firstElementChild.title;else results[1][i]=titleA.innerHTML;results[2][i]=results[0][i].querySelector(".contributor").innerHTML}catch(e){console.error(e)}}else break}if(results[1].length>0)matchFound=true}else if(site=="Sheet Music Plus"){var titles=response.querySelectorAll(".fs18");for(i=0;i<titles.length&&i<4;i++){results[1][i]=titles[i].firstElementChild.innerHTML;try{results[2][i]=/by\s(\w+\s\w\.[\s\w]+|[\w\s]+\W)/i.exec(titles[i].nextElementSibling.innerHTML)[1];results[2][i]=results[2][i].replace(/\W+$/,"")}catch(e){console.log(e)}results[3][i]=titles[i].firstElementChild.href}if(results[1][0])matchFound=true}else if(site=="Audible"){if(response.querySelector(".adbl-result-item")){var titles=response.querySelectorAll(".adbl-prod-title");for(i=0;i<titles.length&&i<4;i++){try{results[1][i]=titles[i].firstElementChild.innerHTML;results[3][i]="http://www.audible.com"+titles[i].firstElementChild.getAttribute("href");results[2][i]=titles[i].parentNode.getElementsByClassName("adbl-prod-author")[0].firstElementChild.innerHTML}catch(e){console.log(e)}}if(results[1][0])matchFound=true}}var siteResultsDiv=document.createElement("div");siteResultsDiv.id=site;siteResultsDiv.setAttribute("style","margin-top:5px;");var siteTitleSpan=document.createElement("span");siteTitleSpan.setAttribute("style","text-decoration:underline; display: block; padding-bottom:2px;");siteTitleSpan.innerHTML=site;siteResultsDiv.appendChild(siteTitleSpan);if(matchFound){var titleResultSpan;var titleResultSpan2;console.log(site+" Results: ");console.log(results);var k;for(k=0;k<results[1].length;k++){titleResultSpan=document.createElement("span");titleResultSpan2=document.createElement("span");titleResultSpan.setAttribute("style","display:block;");titleResultSpan2.setAttribute("style","cursor:pointer; font-weight:600; color:#1E4DB1; font-family: georgia;");titleResultSpan2.innerHTML=results[1][k];if(results[2][k])titleResultSpan2.innerHTML+=" - "+results[2][k];titleResultSpan2.addEventListener("click",createPageParser(results,k,site),false);titleResultSpan.appendChild(titleResultSpan2);siteResultsDiv.appendChild(titleResultSpan)}}else{var titleNullResultSpan=document.createElement("span");titleNullResultSpan.style.color="#FF00CB";titleNullResultSpan.innerHTML="No Results.";siteResultsDiv.appendChild(titleNullResultSpan)}var oldResults=document.getElementById(site);if(oldResults)oldResults.parentNode.removeChild(oldResults);window.titleResultsDiv.appendChild(siteResultsDiv)}function createPageParser(e,t,n){var r=e[3][t];if(n=="Amazon.com")r=r.replace(/\/ref=.+/i,"/");if(features.UHAutomate&&t==0)fillUHSearchResults(e,t,n,r);return function(){if(window.titlePicks[n]){if(window.titlePicks[n]==this||window.oldTitlePicks[n]==this){return}}manageTitleLists("loading",this,n);_openHTML(r,n,true)}}function fillUHSearchResults(e,t,n,r){try{var i=makeSearchString(e[1][t]).replace(/\W/g," ").split(" ")[0].toLowerCase();if(e[2][t]&&e[2][t]!="N/A"){try{var s=makeSearchString(e[2][t]).replace(/\W/g," ").split(" ");var o=s[0].toLowerCase();var u=s[1].toLowerCase()}catch(a){console.log("Single named author: "+a);var o=e[2][t];var u=""}}else if(n=="Wikipedia"){var f=makeSearchString(e[1][t]).replace(/\W/g," ").split(" ");if(f.length<2){console.log("Wiki title too short");return}else i=f[0]+".+?"+f[f.length-1]+"|"+f[f.length-1]+".+?"+f[0];var o=".";var u="."}else return;var l=new RegExp(i,"ig");var c=new RegExp(o,"ig");var h=new RegExp(u,"ig");console.log(l+"\n"+c+"\n"+h);if(l.test(window.titleInput.value)&&c.test(window.titleInput.value)&&h.test(window.titleInput.value)){window.UHSearchResults.push('_openHTML("'+r+'", "'+n+'",true); manageTitleLists("loading", document.getElementById(\''+n+"').firstElementChild.nextElementSibling.firstElementChild, \""+n+'")')}}catch(a){console.log(a);automateFurtherErr(a+" - Compiling search results")}console.log(window.UHSearchResults.join("\n"))}function manageTitleLists(e,t,n){if(e=="loading"){var r=document.createElement("img");r.setAttribute("style","width:10px; height: 10px; margin-left:2px;");r.src=warnWaitSrc;t.parentNode.appendChild(r);t.style.cursor="default";console.log("title arrays: "+window.titlePicks+"\n"+window.oldTitlePicks);if(window.titlePicks[n]){window.oldTitlePicks[n]=window.titlePicks[n]}window.titlePicks[n]=t}else if(e=="loaded"){console.log("oldTitlePicks: "+window.oldTitlePicks);if(window.oldTitlePicks[n]){try{window.oldTitlePicks[n].parentNode.removeChild(window.oldTitlePicks[n].nextElementSibling)}catch(i){console.log(i)}window.oldTitlePicks[n].style.color="purple";window.oldTitlePicks[n].style.cursor="pointer"}window.oldTitlePicks[n]=null;t.parentNode.removeChild(t.parentNode.lastElementChild);t.style.color="green";t.style.cursor="default";var s=document.createElement("img");s.src=pmCloseSrc;s.setAttribute("style","margin-left:2px; width:10px; height:10px; cursor: pointer;");s.addEventListener("click",function(){t.style.color="purple";t.style.cursor="pointer";this.parentNode.removeChild(this);window.oldTitlePicks[n]=null;removeBookInfo(t.parentNode.parentNode.id)},false);t.parentNode.appendChild(s);if(features.UHReplaceTitle){window.titleInput.value=htmlDecode(t.innerHTML);var o=document.getElementById("oldTitleSpan");if(o&&window.titleInput.value!=o.innerHTML)o.style.display="block"}}else if(e=="timeout"){t.parentNode.removeChild(t.parentNode.lastElementChild);t.innerHTML="Connection Error.";t.style.cursor="default";t.style.color="darkred";window.oldTitlePicks[n]=null}else if(e=="invalid"){var u=t.parentNode.parentNode;u.removeChild(t.parentNode);if(u.children.length<2){var a=document.createElement("span");a.style.color="#FF00CB";a.innerHTML="No Results.";u.appendChild(a)}}if(features.UHAutomate&&(e=="invalid"||e=="timeout")){automateFurther(1,n);var f;switch(n){case"Amazon.com":f=window.posterImgAmz;break;case"goodreads":f=window.posterImgGR;break;case"Fantastic Fiction":f=window.posterImgFF;break;case"Wikipedia":f=window.posterImgWiki;break;case"Barns & Noble":f=window.posterImgBN;break;case"Sheet Music Plus":f=window.posterImgSMP;break;case"Audible":f=window.posterImgAdbl;break;default:console.log("Site??");return}automateFurther(2,0,f)}}function removeBookInfo(e){window.descrBody[0][e]="";window.descrBody[1][e]="";delete window.descrBody[2][e];window.descrBody[3][e]="";window.titlePicks[e]=null;var t=contentTable.getElementsByTagName("select")[0];t.firstElementChild.selected=true;var n;if(e=="Amazon.com"){if(window.posterInput.value==window.posterImgAmz.src)window.posterInput.value="";window.posterImgAmz.setAttribute("style","");window.posterImgAmz.src="";window.posterImgAmzDim.innerHTML="";n=window.AmzDescriptionDiv.innerHTML;window.AmzDescriptionDiv.innerHTML="";window.descrAmzBtn.style.display="none"}else if(e=="goodreads"){if(window.posterInput.value==window.posterImgGR.src)window.posterInput.value="";window.posterImgGR.setAttribute("style","");window.posterImgGR.src="";window.posterImgGRDim.innerHTML="";n=window.GRDescriptionDiv.innerHTML;window.GRDescriptionDiv.innerHTML="";window.descrGRBtn.style.display="none"}else if(e=="Fantastic Fiction"){if(window.posterInput.value==window.posterImgFF.src)window.posterInput.value="";window.posterImgFF.setAttribute("style","");window.posterImgFF.src="";window.posterImgFFDim.innerHTML="";n=window.FFDescriptionDiv.innerHTML;window.FFDescriptionDiv.innerHTML="";window.descrFFBtn.style.display="none"}else if(e=="Wikipedia"){if(window.posterInput.value==window.posterImgWiki.src)window.posterInput.value="";window.posterImgWiki.setAttribute("style","");window.posterImgWiki.src="";window.posterImgWikiDim.innerHTML="";n=window.WikiDescriptionDiv.innerHTML;window.WikiDescriptionDiv.innerHTML="";window.descrWikiBtn.style.display="none"}else if(e=="Barns & Noble"){if(window.posterInput.value==window.posterImgBN.src)window.posterInput.value="";window.posterImgBN.setAttribute("style","");window.posterImgBN.src="";window.posterImgBNDim.innerHTML="";n=window.BNDescriptionDiv.innerHTML;window.BNDescriptionDiv.innerHTML="";window.descrBNBtn.style.display="none"}else if(e=="Sheet Music Plus"){if(window.posterInput.value==window.posterImgSMP.src)window.posterInput.value="";window.posterImgSMP.setAttribute("style","");window.posterImgSMP.src="";window.posterImgSMPDim.innerHTML="";n=window.SMPDescriptionDiv.innerHTML;window.SMPDescriptionDiv.innerHTML="";window.descrSMPBtn.style.display="none"}else if(e=="Audible"){if(window.posterInput.value==window.posterImgAdbl.src)window.posterInput.value="";window.posterImgAdbl.setAttribute("style","");window.posterImgAdbl.src="";window.posterImgAdblDim.innerHTML="";n=window.AdblDescriptionDiv.innerHTML;window.AdblDescriptionDiv.innerHTML="";window.descrAdblBtn.style.display="none"}placeDescription(null,null,n);if(window.descrBody[0]["Amazon.com"]&&e!="Amazon.com")loadDescr("Amazon.com");else if(window.descrBody[0]["goodreads"]&&e!="goodreads")loadDescr("goodreads");else if(window.descrBody[0]["Fantastic Fiction"]&&e!="Fantastic Fiction")loadDescr("Fantastic Fiction");else if(window.descrBody[0]["Wikipedia"]&&e!="Wikipedia")loadDescr("Wikipedia");else if(window.descrBody[0]["Barns & Noble"]&&e!="Barns & Noble")loadDescr("Barns & Noble");else if(window.descrBody[0]["Sheet Music Plus"]&&e!="Sheet Music Plus")loadDescr("Sheet Music Plus");else if(window.descrBody[0]["Audible"]&&e!="Audible")loadDescr("Audible");else loadDescr("User Defined");doGenres(e,true)}function parseBookPage(e,t,n){if(e==="Amazon.com"){try{var r=t.querySelector("#prodImage");if(!r)r=t.querySelector("#main-image");if(!r)r=document.querySelector("#imgBlkFront");var s=r.src;s=/(.+?)\.([^\.]+?).jpg/i.exec(s)[1]+".jpg"}catch(o){manageTitleLists("invalid",window.titlePicks[e],e);return}var u;var a=t.getElementsByClassName("byLinePipe");for(i=0;i<a.length;i++){if(/series/i.test(a[i].innerHTML)){u=a[i].nextElementSibling.innerHTML;u=u.replace(/\(/g,"- ");u=u.replace(/\)/g,"");break}}if(!u){var f=t.getElementsByClassName("productDescriptionSource");for(i=0;i<f.length;i++){if(/about the author/i.test(f[i].innerHTML)){var l=f[i].nextElementSibling.innerHTML;try{u=/((co)?author of.+?)([,\.\(]|and\s)/i.exec(l)[1]}catch(c){}}}if(f&&!u){try{u=/(grades?.+)\w/.exec(f[i].parentNode.innerHTML)[1]}catch(c){}}}if(!u){var h=t.getElementsByTagName("h2");for(i=0;i<h.length;i++){if(/Product/i.test(h[i].innerHTML)){try{u=/(\d+?)\spages/i.exec(h[i].nextElementSibling.innerHTML)[1]+" pages"}catch(o){}}}}var p;try{p=t.querySelector("#postBodyPS").innerHTML}catch(o){try{p=t.querySelector(".productDescriptionWrapper").innerHTML}catch(o){p=""}}var d;try{var v=t.getElementsByClassName("crAvgStars")[0];if(v.parentNode.getAttribute("class")=="tiny"){d=v.getElementsByClassName("swSprite")[0].firstElementChild.innerHTML;d+=" ("+v.getElementsByTagName("a")[v.getElementsByTagName("a").length-1].innerHTML+")"}}catch(c){d="No Ratings"}var h=t.getElementsByTagName("h2");var m=[];for(i=7;i<h.length;i++){if(h[i].innerHTML==="Look for Similar Items by Category"){var g=h[i].parentNode.getElementsByTagName("a");for(j=0;j<g.length;j++){if(!/(Books|Store|Science Fiction & Fantasy|Mystery, Thriller & Suspense|Literature & Fiction|Computer & Technology|Comics & Graphic Novels|Crafts, Hobbies & Home|Education & Reference|Gay & Lesbian| Health, Fitness & Dieting|Humor & Entertainment|Parenting & Relationships|Politics & Social Sciences|Professional & Technical|Religion & Spirituality|Science & Math)/i.test(g[j].innerHTML))m.push(g[j].innerHTML)}break}}}else if(e==="goodreads"){var r=t.querySelector("#coverImage");if(!r){if(!t.querySelectorAll("#imagecol")){manageTitleLists("invalid",window.titlePicks[e],e);return}}if(r)var s=r.src;else var s="";var u;var y=t.querySelectorAll(".infoBoxRowTitle");for(i=0;i<y.length;i++){if(y[i].innerHTML=="series"){u=y[i].nextElementSibling.firstElementChild.innerHTML||y[i].nextElementSibling.innerHTML}else if(y[i].innerHTML=="literary awards"){u=y[i].nextElementSibling.firstElementChild.innerHTML||y[i].nextElementSibling.innerHTML;break}}if(!u){var b=t.querySelectorAll(".row");try{if(b[0].lastElementChild!==b[0].firstElementChild)u=b[0].lastElementChild.innerHTML;if(/0 pages/i.test(u))throw"0 pages"}catch(o){try{console.log(o);u=b[1].innerHTML;if(/published\s*$/i.test(u))throw"small descr is 'published'"}catch(w){console.log(w);u=""}}}var p;try{var E=t.querySelector("#description").firstElementChild.nextElementSibling;var S=E.getElementsByTagName("a");E.removeChild(S[S.length-1]);p=E.innerHTML}catch(o){console.log(o);try{p=t.querySelector("#description span").innerHTML}catch(w){console.log(w)}}if(p)p=p.replace(/<(?!\/?(p|br)).*?>/g,"");var d;try{d=t.querySelector("#bookMeta").getElementsByClassName("value rating")[0].firstElementChild.innerHTML;if(d.slice(0,3)=="0.0")d="No Ratings";else{var x=t.querySelector(".value-title");if(x.getAttribute("itemprop")=="ratingCount")d+=" out of 5 stars ("+x.innerHTML+")"}}catch(o){d="No Ratings"}var m=[];var h=t.getElementsByTagName("h2");for(i=2;i<h.length;i++){try{if(h[i].firstElementChild&&h[i].firstElementChild.innerHTML=="Genres"){var T=h[i].parentNode.parentNode.querySelectorAll(".left");for(j=0;j<T.length;j++){m.push(T[j].lastElementChild.innerHTML)}break}}catch(o){console.log(o)}}}else if(e=="Fantastic Fiction"){try{var s=t.getElementsByTagName("td")[2].getElementsByTagName("img")[0].src}catch(o){console.log(o);manageTitleLists("invalid",window.titlePicks[e],e);return}var u;try{u=t.getElementsByTagName("td")[3].innerHTML.split("<br>")[1]}catch(o){}var p;try{p=t.getElementsByClassName("blurb")[0].innerHTML}catch(o){}var m=[];if(p){var N=p.split("<br><br>Genre:");if(N.length>1){p=N[0];try{m[0]=/>(.+)</.exec(N[1])[1]}catch(o){console.log(o)}}}}else if(e=="Wikipedia"){var p="";try{var C=t.querySelector("#mw-content-text");var k=C.childNodes.length;var L;for(i=0;i<k&&i<20;i++){if(C.childNodes[i].tagName=="P"){L=C.childNodes[i].innerHTML;if(p)p+="<br><br>";p+=L.replace(/<\/?a.*?>|<sup.+?\/sup>/g,"");if(p.split(" ").length>120)break}}}catch(o){console.log(o);manageTitleLists("invalid",window.titlePicks[e],e);return}if(!p){manageTitleLists("invalid",window.titlePicks[e],e);return}try{var A=t.querySelector("#mw-content-text").getElementsByClassName("infobox")[0];var s=A.getElementsByTagName("img")[0].src}catch(o){console.log(o)}var u;var m=[];if(A){try{var O=A.getElementsByTagName("th");for(i=0;i<O.length;i++){if(O[i].innerHTML.toLowerCase()=="Series".toLowerCase()){u=O[i].nextElementSibling.innerHTML}else if(/genre/i.test(O[i].innerHTML)){var g=O[i].nextElementSibling.getElementsByTagName("a");for(j=0;j<g.length;j++){m[j]=g[j].innerHTML}}}}catch(o){console.log(o)}}}else if(e==="Barns & Noble"){try{var s=t.getElementsByTagName("aside")[0].querySelector(".book").src;if(/00000000000/.test(s))s=""}catch(o){try{s=t.querySelector("#product-image").getElementsByTagName("img")[0].src;if(/see.inside/i.test(s))s=t.querySelector("#product-image").getElementsByTagName("img")[1].src}catch(w){try{s=t.getElementsByTagName("aside")[0].querySelector(".product-image img").src;if(/00000000000/.test(s))s=""}catch(M){console.log(o+"\n"+w+"\n"+M);manageTitleLists("invalid",window.titlePicks[e],e);return}}}var u;try{var _=t.querySelector("#product-commentaries-1");if(!_)_=t.querySelector("#tab-overview");var D=_.getElementsByTagName("h3");var P=null;for(i=0;i<D.length;i++){if((D[i].innerHTML=="Overview"||D[i].innerHTML=="Synopsis")&&P==null){P=D[i]}else if(D[i].innerHTML=="Product Details")var H=D[i]}var B=H.parentNode.getElementsByTagName("span");var u="";for(i=0;i<B.length;i++){if(/series/i.test(B[i].innerHTML)){u=B[i].parentNode.innerHTML.replace(/series:? ?/i,"");break}else if(/pages/i.test(B[i].innerHTML)){u=B[i].parentNode.innerHTML.replace(/pages:? ?/i,"");u+=" pages"}else if(pubD=/.*Time.+/i.exec(B[i].parentNode.innerHTML)){u=pubD[0]}else if(pubD=/.*date.+/i.exec(B[i].parentNode.innerHTML)){u=pubD[0]}}if(!u&&t.querySelector(".for-textbooks"))u="Textbook"}catch(o){console.log(o)}var p;try{var F=P.parentNode;F.removeChild(P);p=F.innerHTML.replace(/id=".+?"/g,"")}catch(o){try{if(!P){p=t.querySelector("#product-commentaries-1").getElementsByTagName("p")[0].parentNode.innerHTML}else p=""}catch(w){console.log(o+"\n"+w)}}try{p+=t.getElementsByClassName("product-commentary-scene-index")[0].getElementsByTagName("div")[0].innerHTML}catch(M){console.log(M)}console.log(p);try{p=p.replace(/<a.+?\/a>/,"");p=p.replace(/^\s+|\s+$/g,"");p=p.replace(/<h3>(.*?)<\/h3>(<p>\s*<\/p>|\s*)<p>(.+?)<\/p>/g,'<br><br><br><span style="font-size:medium;font-weight:bold;" _mce_style="font-size:medium;font-weight:bold;">$1</span><br><br>$3');p=p.replace(/<h3>(.*?)<\/h3>/g,'<br><br><span style="font-size:medium;font-weight:bold;" _mce_style="font-size:medium;font-weight:bold;">$1</span><br>')}catch(o){console.log(o)}var d;try{var I=t.querySelector("#reviews-average-rating-1");var q=I.getElementsByTagName("span");for(i=0;i<q.length;i++){if(q[i].getAttribute("itemProp")=="ratingValue")d=q[i].innerHTML;else if(q[i].getAttribute("itemProp")=="ratingCount"){d+=" of 5 stars ("+q[i].innerHTML+" reviewer";if(parseInt(q[i].innerHTML)<2)d+=")";else d+="s)"}}}catch(o){try{if(u=="Textbook")var R=t.querySelector(".numRatings");if(R){var x=/(\d+)/.exec(R.innerHTML)[1];var U=R.parentNode.previousElementSibling.firstElementChild.querySelector(".section_updateRating");d=/avg-(.+?) /i.exec(U.getAttribute("class"))[1].replace(/h/,".5");d+=" of 5 stars ("+x+" rating";if(x>1)d+="s)";else d+=")"}}catch(o){console.log(o)}}if(!d)d="No Ratings";var m=[];if(u=="Textbook")m[0]="Textbook";else{var z=t.getElementsByTagName("h6");for(i=0;i<z.length;i++){if(z[i].innerHTML=="Related Subjects"){var W=z[i];break}}if(W){var X=W.parentNode.getElementsByTagName("li");for(i=0;i<X.length;i++){m[i]=X[i].innerHTML.replace(/<.+?>/g,"")}}}}else if(e==="Sheet Music Plus"){var s="";try{s="http://d29ci68ykuu27r.cloudfront.net/product/Look-Inside/covers/"+/(\d+)$/.exec(n)[1]+".jpg"}catch(o){console.log(o)}var p;try{var V=t.querySelector("#detailed_desc_box");p=V.firstElementChild.innerHTML}catch(o){console.log(o)}if(!p){manageTitleLists("invalid",window.titlePicks[e],e);return}var u;try{u=t.querySelector(".pvn").innerHTML;if(/^\s?by\s/.test(u))u=""}catch(o){}if(!u){console.log(V.firstElementChild.innerHTML);var $=[];try{var $=/(for.+?\.)/i.exec(p);if($){u+=$[1];$=[]}}catch(o){console.log(o)}try{$=/\.\s([^\.]+?period\.)/i.exec(p);if($){if(u)u+=" ";u+=$[1];$=[]}}catch(o){console.log(o)}try{$=/\.(.+?series\.)/i.exec(p);if($){if(u)u+=" ";u+=$[1];$=[]}}catch(o){console.log(o)}}var d;try{var J=t.querySelector(".quick_review");d=J.firstElementChild.getAttribute("content");var K=J.nextElementSibling.firstElementChild.innerHTML;d+=" out of 5 stars ("+K+" reviewer"+(parseInt(K)>1?"s)":")")}catch(o){console.log(o);d="No Ratings"}m=[];try{var Q=t.querySelector(".mtm");formatAs=Q.getElementsByTagName("a");for(i=0;i<formatAs.length;i++){if(/formats/i.test(formatAs[i].href)){m[0]=formatAs[i].innerHTML;break}}}catch(o){console.log(o)}}else if(e=="Audible"){console.log(t);try{var G=t.querySelector(".adbl-prod-image-sample-cont");var s=G.getElementsByTagName("img")[0].src}catch(o){console.log(o);manageTitleLists("invalid",window.titlePicks[e],e);return}var Y=[];try{var Z=t.querySelector(".adbl-prod-meta");var et=Z.querySelectorAll(".adbl-prod-author");var tt;for(i=0;i<et.length;i++){if(et[i].previousElementSibling){if(/narr/i.test(et[i].previousElementSibling.innerHTML))var nt=et[i].innerHTML.replace(/<.+?>/g,"").replace(/^\s+|\s{2,}|\s+$/g," ").replace(/^\s+|\s+$/g,"")}else if(tt=/Series:(.+)/i.exec(et[i].innerHTML.replace(/<.+?>/g,"")))var rt=tt[1]}var it=releaseDate=prodVersion=null;if(releaseDate=t.querySelector(".adbl-date"))Y.push("Released: "+releaseDate.innerHTML.replace(/^\s+|\s+$/g,""));if(prodVersion=Z.querySelector(".adbl-prod-version")){try{Y.push(/\b(\w+?)\b/.exec(prodVersion.innerHTML)[1])}catch(o){console.log(o)}}if(it=t.querySelector(".adbl-run-time"))Y.push("Length: "+it.innerHTML);if(nt)Y.push("Narrated by: "+nt);if(rt)Y.push("Series: "+rt.replace(/^\s+|\s+$/g,""))}catch(o){console.log(o)}console.log(Y);var u;if(prodVersion)u=/\b(\w+?)\b/.exec(prodVersion.innerHTML)[1].toLowerCase();else if(nt)u="read by "+nt.innerHTML;else if(it)u=it.innerHTML;else if(rt)u=rt;else if(releaseDate)u=releaseDate.innerHTML;try{var p;if(Y)p="General Information<br>=================<br>"+Y.join("<br>");p+="<br><br>Book Description<br>=================<br>"+t.querySelector(".adbl-content").innerHTML.replace(/>(\(p\) and )?\u00A9.+?</i,"><").replace(/^\s*<p>(.+?)<\/p>/,"$1")}catch(o){console.log(o)}var d;try{var I=t.querySelector(".adbl-member-ratings");var st=I.querySelectorAll(".boldrating");if(st[0].innerHTML=="0")d="No Ratings";else{d="Overall - "+st[0].innerHTML+"/5 "+st[0].nextElementSibling.innerHTML;if(st[2].innerHTML!=="0")d+=", Performance - "+st[2].innerHTML+"/5 "+st[2].nextElementSibling.innerHTML}}catch(o){console.log(o);d="No Ratings"}var m=[];var ot=t.querySelector("#adbl_module_activityFeed");if(ot){console.log(ot);if(ot.getElementsByTagName("a"))m.push(ot.getElementsByTagName("a")[0].innerHTML)}}console.log([s,p,u,d,n,m].join("\n"));var V;var ut;var r;var at;switch(e){case"Amazon.com":V=window.AmzDescriptionDiv;r=window.posterImgAmz;at=window.posterImgAmzDim;break;case"goodreads":V=window.GRDescriptionDiv;r=window.posterImgGR;at=window.posterImgGRDim;break;case"Fantastic Fiction":V=window.FFDescriptionDiv;r=window.posterImgFF;at=window.posterImgFFDim;break;case"Wikipedia":V=window.WikiDescriptionDiv;r=window.posterImgWiki;at=window.posterImgWikiDim;break;case"Barns & Noble":V=window.BNDescriptionDiv;r=window.posterImgBN;at=window.posterImgBNDim;break;case"Sheet Music Plus":V=window.SMPDescriptionDiv;r=window.posterImgSMP;at=window.posterImgSMPDim;break;case"Audible":V=window.AdblDescriptionDiv;r=window.posterImgAdbl;at=window.posterImgAdblDim;break;default:console.log("Site??");return}if(s)loadPoster(r,at,s);else{if(features.UHAutomate)automateFurther(2,0,r)}if(u){u=u.replace(/<.+?>/g,"");u=u.replace(/, #/," #");u=u.replace(/\s{2,}/g," ");u=u.replace(/\s,\s/g,", ");u=u.replace(/^\((.+)\)$/,"$1");u=u.replace(/^\s+|\s+$/g,"");if(/a (novel|non fiction book) by/i.test(u))u="";if(ut=V.innerHTML){V.innerHTML=u;placeDescription(V,null,ut)}else{V.innerHTML=u;placeDescription(V)}}if(d){window.descrBody[2][e]="<span id='"+e+"Link'><a href='"+n+"'>"+e+"</a>: "+d+"</span>"}else{window.descrBody[2][e]="<a id='"+e+"Link"+"' href='"+n+"'>"+e+"</a>"}window.descrBody[3][e]=m||[];if(window.descrBody[0][e])doGenres(e,true);else doGenres(e);window.descrBody[0][e]=p||"";loadDescr(e,true);manageTitleLists("loaded",window.titlePicks[e],e);if(features.UHAutomate)automateFurther(1,e);else{searchForDupes2(dupeTerms(window.titleInput.value),"dupeDiv",window.typeSelect.options[typeSelect.selectedIndex].innerHTML.slice(0,2));searchForRDupes2(dupeTerms(window.titleInput.value),"reqDiv",window.typeSelect.options[typeSelect.selectedIndex].innerHTML.slice(0,2))}}function loadPoster(e,t,n){if(e.style.border){window.posterInput.value=""}var r=new Image;r.addEventListener("load",function(){try{t.innerHTML=r.naturalWidth+"x"+r.naturalHeight;console.log(r.naturalWidth+"x"+r.naturalHeight);e.src=n;if(e==window.posterImgUser){e.setAttribute("style","display:block; max-width:230px; max-height:197px; cursor: pointer; margin-left:5px; margin-right:5px; border: solid green 3px; border-radius: 3px")}else{e.setAttribute("style","display:block; max-width:230px; max-height:200px; cursor: pointer; margin-left:5px; margin-right:5px;")}t.setAttribute("style","text-align: center; margin-left: 5px; color:white; background-color:#444;");e.addEventListener("click",popUpImg,false);if(features.UHAutomate)automateFurther(2,r.naturalHeight,e)}catch(i){if(features.UHAutomate){automateFurtherErr("While sorting info - "+i)}console.log(i)}},false);r.addEventListener("error",function(){try{e.src=page.querySelector(".sample_viewer").firstElementChild.src}catch(n){try{e.src="http://d29ci68ykuu27r.cloudfront.net/product/Look-Inside/large/"+/(\d+)$/.exec(u)[1]+"_01.jpg"}catch(n){e.src="";t.innerHTML="";if(features.UHAutomate)automateFurther(2,0,e)}}},false);r.src=n}function popUpImg(){var e=this;this.removeEventListener("click",popUpImg,false);var t=document.createElement("div");t.setAttribute("style","position:fixed; height:100%; width: 100%; background-color: #000; margin: auto; top: 0; left: 0; z-index: 100; opacity: .7;");var n=document.getElementsByTagName("body")[0];n.appendChild(t);this.setAttribute("style","");var r=this.height/2;var i=this.width/2;var s=window.innerHeight/2-r;var o=window.innerWidth/2-i;this.setAttribute("style","position:fixed; z-index:150; top:0; left:0; z-index 200; margin-top:"+s+"px; margin-left:"+o+"px;");var u=document.createElement("button");u.type="button";if(window.posterInput.value==e.src)u.innerHTML="Keep as Selection";else u.innerHTML="Select";u.setAttribute("style","position: relative;");var a=document.createElement("button");a.type="button";a.setAttribute("style","position: absolute; top:0; float:right;");if(window.posterInput.value==e.src)a.innerHTML="Deselect";else a.innerHTML="Cancel";var f=document.createElement("div");f.appendChild(u);f.appendChild(a);n.appendChild(f);var l=window.innerHeight-s;var c=u.clientWidth+a.clientWidth;var h=o+i-c/2;f.setAttribute("style","position:fixed; top:0; left:0; z-index: 200; width: "+e.width+"; margin-left:"+h+"px; margin-top:"+l+"px;");u.addEventListener("click",function(){n.removeChild(t);n.removeChild(f);window.posterImgAmz.style.border="none";window.posterImgAmz.style.maxHeight="200px";window.posterImgGR.style.border="none";window.posterImgGR.style.maxHeight="200px";window.posterImgFF.style.border="none";window.posterImgFF.style.maxHeight="200px";window.posterImgWiki.style.border="none";window.posterImgWiki.style.maxHeight="200px";window.posterImgBN.style.border="none";window.posterImgBN.style.maxHeight="200px";window.posterImgSMP.style.border="none";window.posterImgSMP.style.maxHeight="200px";window.posterImgAdbl.style.border="none";window.posterImgAdbl.style.maxHeight="200px";window.posterImgUser.style.border="none";window.posterImgUser.style.maxHeight="200px";e.setAttribute("style","display:block; max-width:230px; max-height:197px; cursor: pointer; margin-left:5px; margin-right:5px; border: solid green 3px; border-radius: 3px;");e.addEventListener("click",popUpImg,false);window.posterInput.value=e.src},false);a.addEventListener("click",function(){n.removeChild(t);n.removeChild(f);e.setAttribute("style","display:block; max-width:230px; max-height:200px; cursor: pointer; margin-left:5px; margin-right:5px;");e.addEventListener("click",popUpImg,false);if(window.posterInput.value==e.src)window.posterInput.value=""},false)}function placeDescription(e,t,n){var r=window.AmzDescriptionDiv;var i=window.GRDescriptionDiv;var s=window.FFDescriptionDiv;var o=window.WikiDescriptionDiv;var u=window.BNDescriptionDiv;var a=window.SMPDescriptionDiv;var f=window.AdblDescriptionDiv;window.descriptionsSwitchSpan.style.display="none";r.style.display=i.style.display=s.style.display=s.style.display=u.style.display=a.style.display="none";if(n){var l=new RegExp("(,\\s)?"+htmlDecode(n).replace(/[\W]/g,".")+"(,\\s)?");window.descriptionInput.value=window.descriptionInput.value.replace(l,"")}if(window.descriptionInput.value==""&&e)window.descriptionInput.value=htmlDecode(e.innerHTML);else if(t){if(window.descriptionInput.value.slice(-1)!==" ")window.descriptionInput.value+=", ";window.descriptionInput.value+=htmlDecode(e.innerHTML)}var c=new RegExp(htmlDecode(r.innerHTML).replace(/[\W]/g,"."));var h=new RegExp(htmlDecode(i.innerHTML).replace(/[\W]/g,"."));var p=new RegExp(htmlDecode(s.innerHTML).replace(/[\W]/g,"."));var d=new RegExp(htmlDecode(o.innerHTML).replace(/[\W]g/,"."));var v=new RegExp(htmlDecode(u.innerHTML).replace(/[\W]g/,"."));var m=new RegExp(htmlDecode(a.innerHTML).replace(/[\W]g/,"."));var g=new RegExp(htmlDecode(f.innerHTML).replace(/[\W]g/,"."));if(!c.test(window.descriptionInput.value)){r.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}if(!h.test(window.descriptionInput.value)){i.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}if(!p.test(window.descriptionInput.value)){s.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}if(!d.test(window.descriptionInput.value)){o.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}if(!v.test(window.descriptionInput.value)){u.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}if(!m.test(window.descriptionInput.value)){a.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}if(!g.test(window.descriptionInput.value)){f.style.display="inline";window.descriptionsSwitchSpan.style.display="inline"}}function setupDescr(){window.descrBodyTag=document.getElementById("descr_ifr").contentDocument.getElementsByTagName("body")[0];var e=document.createElement("div");window.descrAmzBtn=document.createElement("input");window.descrAmzBtn.type="button";window.descrAmzBtn.setAttribute("style","margin:2px; display: none;");window.descrAmzBtn.value="Amazon Description";window.descrAmzBtn.addEventListener("click",function(){loadDescr("Amazon.com")},false);window.descrGRBtn=document.createElement("input");window.descrGRBtn.type="button";window.descrGRBtn.setAttribute("style","margin:2px; display: none;");window.descrGRBtn.value="goodreads Description";window.descrGRBtn.addEventListener("click",function(){loadDescr("goodreads")},false);window.descrFFBtn=document.createElement("input");window.descrFFBtn.type="button";window.descrFFBtn.setAttribute("style","margin:2px; display: none;");window.descrFFBtn.value="Fantastic Fiction Description";window.descrFFBtn.addEventListener("click",function(){loadDescr("Fantastic Fiction")},false);window.descrWikiBtn=document.createElement("input");window.descrWikiBtn.type="button";window.descrWikiBtn.setAttribute("style","margin:2px; display: none;");window.descrWikiBtn.value="Wikipedia";window.descrWikiBtn.addEventListener("click",function(){loadDescr("Wikipedia")},false);window.descrBNBtn=document.createElement("input");window.descrBNBtn.type="button";window.descrBNBtn.setAttribute("style","margin:2px; display: none;");window.descrBNBtn.value="Barns & Noble";window.descrBNBtn.addEventListener("click",function(){loadDescr("Barns & Noble")},false);window.descrSMPBtn=document.createElement("input");window.descrSMPBtn.type="button";window.descrSMPBtn.setAttribute("style","margin:2px; display: none;");window.descrSMPBtn.value="Sheet Music Plus";window.descrSMPBtn.addEventListener("click",function(){loadDescr("Sheet Music Plus")},false);window.descrAdblBtn=document.createElement("input");window.descrAdblBtn.type="button";window.descrAdblBtn.setAttribute("style","margin:2px; display: none;");window.descrAdblBtn.value="Audible";window.descrAdblBtn.addEventListener("click",function(){loadDescr("Audible")},false);window.descrUsrBtn=document.createElement("input");window.descrUsrBtn.type="button";window.descrUsrBtn.setAttribute("style","margin:2px; display: none;");window.descrUsrBtn.value="User Defined";window.descrUsrBtn.addEventListener("click",function(){loadDescr("User Defined")},false);window.resetDescrBtn=document.createElement("input");window.resetDescrBtn.type="button";window.resetDescrBtn.setAttribute("style","float:right; display: none;");window.resetDescrBtn.value="Reset Description";window.resetDescrBtn.addEventListener("click",function(){loadDescr(window.activeDescrSite,true)},false);window.descrBody[0]["User Defined"]=window.descrBodyTag.innerHTML;e.appendChild(window.descrAmzBtn);e.appendChild(window.descrGRBtn);e.appendChild(window.descrFFBtn);e.appendChild(window.descrWikiBtn);e.appendChild(window.descrBNBtn);e.appendChild(window.descrSMPBtn);e.appendChild(window.descrAdblBtn);e.appendChild(window.descrUsrBtn);document.getElementById("descr_parent").parentNode.appendChild(window.resetDescrBtn);var t=document.getElementById("descr");t.parentNode.insertBefore(e,t)}function loadDescr(e,t,n){if(!window.resetDescrBtn){alert(n);if(typeof n=="undefined"||!n)n=0;if(n>10){if(features.UHAutomate)automateFurtherErr("Site's being slow, try again in a bit");else return}else{n++;setTimeout(function(){loadDescr(e,t,n)},1e3);return}}window.resetDescrBtn.style.display="inline";window.descrAmzBtn.style.fontWeight="normal";window.descrGRBtn.style.fontWeight="normal";window.descrFFBtn.style.fontWeight="normal";window.descrWikiBtn.style.fontWeight="normal";window.descrBNBtn.style.fontWeight="normal";window.descrSMPBtn.style.fontWeight="normal";window.descrAdblBtn.style.fontWeight="normal";window.descrUsrBtn.style.fontWeight="normal";if(e=="Amazon.com"){window.descrAmzBtn.style.display="inline";window.descrAmzBtn.style.fontWeight="bold"}else if(e=="goodreads"){window.descrGRBtn.style.display="inline";window.descrGRBtn.style.fontWeight="bold"}else if(e=="Fantastic Fiction"){window.descrFFBtn.style.display="inline";window.descrFFBtn.style.fontWeight="bold"}else if(e=="Wikipedia"){window.descrWikiBtn.style.display="inline";window.descrWikiBtn.style.fontWeight="bold"}else if(e=="Barns & Noble"){window.descrBNBtn.style.display="inline";window.descrBNBtn.style.fontWeight="bold"}else if(e=="Sheet Music Plus"){window.descrSMPBtn.style.display="inline";window.descrSMPBtn.style.fontWeight="bold"}else if(e=="Audible"){window.descrAdblBtn.style.display="inline";window.descrAdblBtn.style.fontWeight="bold"}else{window.descrUsrBtn.style.display="inline";window.descrUsrBtn.style.fontWeight="bold"}if(!window.activeDescrSite)window.activeDescrSite="User Defined";window.descrBody[1][window.activeDescrSite]=window.descrBodyTag.innerHTML;console.log("Saved current: "+window.activeDescrSite);if(window.activeDescrSite=="User Defined"&&window.descrBodyTag.innerHTML.length>28)window.descrUsrBtn.style.display="inline";console.log("->Loading "+e+"... Forced: "+(t?"yes":"no"));if(t){console.log("->Creating new descr page.");window.descrBodyTag.innerHTML="";if(window.fileTypes&&window.fileTypes.summary&&features.UHAddContents){window.descrBodyTag.innerHTML='<span id="summary">'+window.fileTypes.summary+"<br><br></span>"}window.descrBodyTag.innerHTML+=window.descrBody[0][e];if(features.UHAddLinks&&e!="User Defined"){window.descrBodyTag.innerHTML+="<br id='sp1'/><br id='sp2'/><hr id='sp3'/>";window.descrBodyTag.innerHTML+=Object.keys(window.descrBody[2]).sort(function(e,t){console.log("Length of "+t+" link: "+descrBody[2][t].replace(/<.+?>/g,"").length);return descrBody[2][t].replace(/<.+?>/g,"").length-descrBody[2][e].replace(/<.+?>/g,"").length}).map(function(e){return window.descrBody[2][e]}).join("<br class='linkBR'>")}console.log("-->Calling fixBBCode");fixBBCode(window.descrBodyTag,true,0)}else{console.log("->Loading saved "+e+". Forced: "+(t?"yes":"no"));if(!window.descrBody[1][e]){console.log("Error finding saved "+e);return}window.descrBodyTag.innerHTML=window.descrBody[1][e];var r=window.descrBodyTag.ownerDocument;if(e!="User Defined"&&features.UHAddContents&&window.fileTypes&&window.fileTypes.summary){var i;if(i=r.getElementById("summary"))i.parentNode.removeChild(i);window.descrBodyTag.innerHTML='<span id="summary">'+window.fileTypes.summary+"<br><br></span>"+window.descrBodyTag.innerHTML}if(e!="User Defined"&&features.UHAddLinks){var s=GRLink=FFLink=WikiLink=BNLink=SMPLink=null;if(s=r.getElementById("Amazon.comLink"))s.parentNode.removeChild(s);if(GRLink=r.getElementById("goodreadsLink"))GRLink.parentNode.removeChild(GRLink);if(FFLink=r.getElementById("Fantastic FictionLink"))FFLink.parentNode.removeChild(FFLink);if(WikiLink=r.getElementById("WikipediaLink"))WikiLink.parentNode.removeChild(WikiLink);if(BNLink=r.getElementById("Barns & NobleLink"))BNLink.parentNode.removeChild(BNLink);if(SMPLink=r.getElementById("Sheet Music PlusLink"))SMPLink.parentNode.removeChild(SMPLink);if(AdblLink=r.getElementById("AudibleLink"))AdblLink.parentNode.removeChild(AdblLink);var o=r.getElementsByClassName("linkBR");var u=o.length;while(u--){o[u].parentNode.removeChild(o[u])}window.descrBodyTag.innerHTML+=Object.keys(window.descrBody[2]).sort(function(e,t){console.log("Length of "+t+" link: "+descrBody[2][t].replace(/<.+?>/g,"").length);return descrBody[2][t].replace(/<.+?>/g,"").length-descrBody[2][e].replace(/<.+?>/g,"").length}).map(function(e){return window.descrBody[2][e]}).join("<br class='linkBR'>")}}var a=window.descrBodyTag.scrollHeight;document.getElementById("descr_ifr").style.height=a+"px";window.activeDescrSite=e;console.log(window.descrBody)}function doGenres(e,t){var n=window.typeSelect.parentNode;var r=[];if(window.genreA.innerHTML!==""&&window.genreA.innerHTML!=="No suggestions, sorry."){r.push(window.genreA.innerHTML);if(window.genreB.innerHTML!==""){r.push(window.genreB.innerHTML);if(window.genreC.innerHTML!=="")r.push(window.genreC.innerHTML)}}if(t){console.log("Old Genres before redo of "+e+": "+r);var s=[];var o=[];if(window.descrBody[3]["Amazon.com"]&&e!=="Amazon.com"){s=s.concat(window.descrBody[3]["Amazon.com"])}if(window.descrBody[3]["goodreads"]&&e!=="goodreads"){s=s.concat(window.descrBody[3]["goodreads"])}if(window.descrBody[3]["Fantastic Fiction"]&&e!=="Fantastic Fiction"){s=s.concat(window.descrBody[3]["Fantastic Fiction"])}if(window.descrBody[3]["Wikipedia"]&&e!=="Wikipedia"){s=s.concat(window.descrBody[3]["Wikipedia"])}if(window.descrBody[3]["Barns & Noble"]&&e!=="Barns & Noble"){s=s.concat(window.descrBody[3]["Barns & Noble"])}if(window.descrBody[3]["Sheet Music Plus"]&&e!=="Sheet Music Plus"){s=s.concat(window.descrBody[3]["Sheet Music Plus"])}if(window.descrBody[3]["Audible"]&&e!=="Audible"){s=s.concat(window.descrBody[3]["Audible"])}console.log(s);for(i=0;i<r.length;i++){for(j=0;j<s.length;j++){console.log("olderTag: "+s[j]+"\ngenresOld: "+r[i]);if(s[j]==r[i]){console.log("match");o.push(s[j])}}}r=o}var u=window.descrBody[3][e].slice(0);console.log("Old: "+r);console.log("New: "+u);r=r.filter(function(e,t){return r.indexOf(e)==t});if(u)u=u.filter(function(e,t){return u.indexOf(e)==t});console.log("Old: "+r);console.log("New: "+u);var a=[];var f;for(i=0;i<r.length;i++){for(j=0;j<u.length&&r[i];j++){console.log(r[i]+" : "+u[j]);if(r[i].toLowerCase()==u[j].toLowerCase()){a.push(u[j]);console.log("Removed from new: "+u.splice(j,1));j--}}}console.log("Old: "+r);console.log("New: "+u);console.log("Best: "+a);for(i=0;i<a.length;i++){for(j=0;j<r.length;j++){if(a[i].toLowerCase()==r[j].toLowerCase()){console.log("Removed from old: "+r.splice(j,1))}}}console.log("Old: "+r);for(i=a.length;i<3;i++){try{if(i%2==0){f=r.shift();if(f)a.push(f);else a.push(u.shift());console.log("Trying from old: "+a+" <-"+f)}else{f=u.shift();if(f)a.push(f);else a.push(r.shift());console.log("Trying from new: "+a+" <-"+f)}}catch(l){console.log("Not enough genres.")}}console.log(a);window.genreA.innerHTML=a[0]||"No suggestions, sorry.";window.genreB.innerHTML=a[1]||"";window.genreC.innerHTML=a[2]||"";var c=window.typeSelect.options.length;var h=false;var p="unknown";if(window.editPage[1]=="upload"&&window.fileTypes){if(window.fileTypes.video)p="Concert Videos";else if(window.fileTypes.audio>2*window.fileTypes.ebook)p="audiobook";else if(window.fileTypes.ebook&&!window.fileTypes.audio)p="ebook";else if(window.userDefFileTypes)p="ebook"}else if(features.UHAutomate)p="ebook";var d=Object.keys(window.genreAssociations);var v;var m;for(i=0;i<3;i++){if(a[i]){if(!/fiction|adult|drama|general$/i.test(a[i].split(" ")[0])){var g=a[i];for(j=0;j<d.length;j++){v=window.genreAssociations[d[j]];for(k=0;k<v.length;k++){m=new RegExp(v[k],"i");if(m.test(g)){g=d[j];break}}if(g!==a[i])break}m=new RegExp(p+".+?("+g.replace(/\W|s$/g,".?")+")","ig");console.log(m);for(j=0;j<c;j++){if(m.test(window.typeSelect.options[j].innerHTML)){window.typeSelect.options[j].selected=true;h=true;break}}if(h)break}}else break}if(!h&&features.UHAutomate){if(window.editPage[1]=="upload")window.typeSelect.options[50].selected=true;else window.typeSelect.options[49].selected=true}console.log("Selecting option: "+window.typeSelect.selectedIndex)}function dupeTerms(e){e=makeSearchString(e);var t=[];var n=e.split(" ");return n}function searchForDupes2(terms,displayId,cat,cycle){console.log(terms);console.log(displayId+" "+cat);if(cat=="(c"||window.editPage&&window.editPage[1]!="upload")return;var dupeChecker=dupeList=dupeRChecker=false;if(displayId&&displayId.slice(0,6)=="dupeTd")dupeChecker=true;else if(displayId&&displayId.slice(0,8)=="dupeList")dupeList=true;else if(displayId&&displayId.slice(0,7)=="dupeRTd")dupeRChecker=true;if(!cycle){if(terms.length<2&&!dupeChecker&&!dupeRChecker)return;eval("window.dupeSearchResults"+displayId+" = {}");openHTML("/jsonSearch.php?SS="+terms.join("+"),"searchForDupes2("+JSON.stringify(terms.join("+"))+",'"+displayId+"','"+cat+"',1)","window.dupeSearchResults"+displayId)}else{var displayHTML="";var matches=[];var jsonSearch=eval("window.dupeSearchResults"+displayId);var displayObj=document.getElementById(displayId);console.log(jsonSearch);console.log(cat);var reqScore;if((dupeList||dupeChecker||dupeRChecker)&&jsonSearch.count>0){reqScore=jsonSearch.results[0].score;if(reqScore<17&&reqScore>10)reqScore=11;else if(reqScore>=17&&reqScore<23)reqScore=.62*reqScore;else if(reqScore>=23&&reqScore<28)reqScore=.5*reqScore;else if(reqScore>=28&&reqScore<35)reqScore=.5*reqScore;else if(reqScore>=35)reqScore=.4*reqScore}else reqScore=14.8;if(dupeRChecker)reqScore=reqScore*1.1;for(i=0;i<jsonSearch.count;i++){try{var catMatch=generalCategory(jsonSearch.results[i].category)}catch(e){console.log("ERROR : "+jsonSearch.results[i]);displayObj.innerHTML="<strong style=color:red'>ERROR, see log</strong>";return}try{console.log("need score > "+reqScore+", "+jsonSearch.results[i].score.toFixed(2)+" cat: "+catMatch+". "+decodeURIComponent(jsonSearch.results[i].name.replace(/%96/g,"-")))}catch(e){console.log("need score > "+reqScore+", "+jsonSearch.results[i].score.toFixed(2)+" cat: "+catMatch+". "+jsonSearch.results[i].name+" :: "+e)}if(displayObj.getAttribute("torrId")!=jsonSearch.results[i].id&&(cat=="Au"&&catMatch=="Au"||cat=="Eb"&&catMatch=="Eb"||cat&&cat!="Au"&&cat!="Eb"||!cat||cat=="undefined")&&jsonSearch.results[i].score>reqScore&&jsonSearch.results[i].size!=null){matches.push(jsonSearch.results[i]);console.log(jsonSearch.results[i])}}displayObj.setAttribute("searched","true");if(displayId=="dupeDiv"){if(matches.length)displayHTML="Possible duplicate! See <a style='color: blue; text-decoration:underline;' target='_blank' href=\"/browse2.php?search="+terms+'">here</a>.'}else if(displayId=="reqDupeDiv"){if(matches.length)displayHTML="Possible matches on site <a style='color: blue; text-decoration:underline;' target='_blank' href=\"/browse2.php?search="+terms+'">here</a>.'}else if(dupeList){if(matches.length)displayHTML="<tr><td class='colhead'>Possible Duplicates</td><td class='colhead'>Total Size</td></tr>"+matches.map(function(e){var t="<tr><td style='padding-left:10px; width:72%; height:2em;'><a href='/details.php?id="+e.id+"&filelist=1' target='_blank'>";try{t+=decodeURIComponent(e.name.replace(/%96/g,"-"))}catch(n){console.log(n);t+=e.name.replace(/%20/g," ").replace(/[\W0-9]+/g," ")}t+="</a></td><td style=''>"+bytesToSize(e.size,2)+"</td>";return t}).join("</tr>");else displayHTML="<tr><td style='font-weight:bold'>This torrent seems to be clear of dupes.</td></tr>"}else if(dupeChecker){if(matches.length){displayHTML="<a href='Javascript:void(0)' style='color: red; text-decoration:underline;'>Possible dupe</a>";displayObj.addEventListener("click",function(){var e;if(e=document.getElementById("res"+displayId)){if(e.parentNode.style.display=="none")e.parentNode.style.display="";else e.parentNode.style.display="none"}else{var t=document.createElement("tr");var n=document.createElement("td");n.id="res"+displayId;n.setAttribute("colspan","15");n.setAttribute("style","background-color: #DCDCDC; border: 2px inset darkgrey; padding-top:2px;");t.appendChild(n);n.innerHTML="<table style='width:100%'>"+matches.map(function(e){var t="<tr><td style='max-width:55px; width:55px; text-align:center;overflow:hidden;font-size:8pt;'>"+generalCategory(e.category,true).split(" ")[0]+"</td><td style='padding-left:10px; width:69%; height:2em;'><a href='/details.php?id="+e.id+"&filelist=1' target='_blank'>";try{t+=decodeURIComponent(e.name.replace(/%96/g,"-"))}catch(n){console.log(n);t+=e.name.replace(/%20/g," ").replace(/[\W0-9]+/g," ")}t+="</a></td><td style='align:left;'>"+bytesToSize(e.size,2)+"</td>";return t}).join("</tr>")+"</table>";this.parentNode.parentNode.insertBefore(t,this.parentNode.nextElementSibling)}},false)}else displayHTML="OK"}else if(dupeRChecker){if(matches.length){displayHTML="<a href='Javascript:void(0)' style='color: red; text-decoration:underline;'>Possibly on site</a>";displayObj.addEventListener("click",function(){var e;if(e=document.getElementById("res"+displayId)){if(e.parentNode.style.display=="none")e.parentNode.style.display="";else e.parentNode.style.display="none"}else{var t=document.createElement("tr");var n=document.createElement("td");n.id="res"+displayId;n.setAttribute("colspan","15");n.setAttribute("style","background-color: #DCDCDC; border: 2px inset darkgrey; padding-top:2px;");t.appendChild(n);n.innerHTML="<table style='width:100%'>"+matches.map(function(e){var t="<tr><td style='max-width:55px; width:55px; text-align:center;overflow:hidden;font-size:8pt;'>"+generalCategory(e.category,true).split(" ")[0]+"</td><td style='padding-left:10px; width:58%; height:2em;'><a href='/details.php?id="+e.id+"&filelist=1' target='_blank'>";try{t+=decodeURIComponent(e.name.replace(/%96/g,"-"))}catch(n){console.log(n);t+=e.name.replace(/%20/g," ").replace(/[\W0-9]+/g," ")}t+="</a></td><td style='align:left;'>Existing torrent</td>";return t}).join("</tr>")+"</table>";this.parentNode.parentNode.insertBefore(t,this.parentNode.nextElementSibling)}},false)}}displayObj.innerHTML=displayHTML;if(dupeChecker)checkPageForDupes(jsonSearch.time_taken);if(dupeRChecker){searchForRDupes2(dupeTerms(window.dupeTds[window.dupeCheckerNum].title),window.dupeTds[window.dupeCheckerNum].id,window.dupeTds[window.dupeCheckerNum].getAttribute("cat"))}}}function searchForRDupes2(terms,displayId,cat,cycle){if(cat=="(c"||window.editPage&&window.editPage[1]!="upload")return;var dupeRChecker=false;if(displayId&&displayId.slice(0,7)=="dupeRTd")dupeRChecker=true;if(!cycle){if(terms.length<2&&!dupeRChecker)return;eval("window.dupeSearchResults"+displayId+" = {}");openHTML("/jsonSearch.php?request=true&SS="+terms.join("+"),"searchForRDupes2("+JSON.stringify(terms.join("+"))+",'"+displayId+"','"+cat+"',1)","window.dupeSearchResults"+displayId)}else{var displayHTML="";var matches=[];var jsonSearch=eval("window.dupeSearchResults"+displayId);var displayObj=document.getElementById(displayId);console.log(jsonSearch);if(displayId=="reqDupeDiv2"){if(jsonSearch.count&&jsonSearch.results[0].score>10){displayHTML="Possible duplicate request! See <a style='color: blue; text-decoration:underline;' target='_blank' href=\"/viewrequests.php?category=0&filter=&search="+terms+'">here</a>.'}else displayHTML="";displayObj.innerHTML=displayHTML}else{var scoreMax=14;for(i=0;i<jsonSearch.count;i++){try{var catMatch=generalCategory(jsonSearch.results[i].category)}catch(e){console.log("ERROR : "+jsonSearch.results[i]);displayObj.innerHTML="<strong style='color:red'>ERROR, see log</strong>";return}try{console.log("R_need score > "+scoreMax+", "+jsonSearch.results[i].score.toFixed(2)+" cat: "+catMatch+". "+decodeURIComponent(jsonSearch.results[i].name.replace(/%96/g,"-")))}catch(e){console.log("R_need score > "+scoreMax+", "+jsonSearch.results[i].score.toFixed(2)+" cat: "+catMatch+". "+jsonSearch.results[i].name+" :: "+e)}if(jsonSearch.results[i].score>scoreMax){if(displayObj.getAttribute("reqId")!=jsonSearch.results[i].id&&(cat=="Au"&&catMatch=="Au"||cat=="Eb"&&catMatch=="Eb"||cat&&cat!="Au"&&cat!="Eb"&&catMatch!="Au"&&catMatch!="Eb"||!cat||cat=="undefined")){matches.push(jsonSearch.results[i])}}}if(displayId=="reqDiv"){if(matches.length){displayHTML="This title may match an active request! See <a style='color: blue; text-decoration:underline;' target='_blank' href=\"/viewrequests.php?category=0&filter=&search="+terms+'">here</a>.'}displayObj.innerHTML=displayHTML}else if(dupeRChecker){if(matches.length){if(displayObj.innerHTML!="")displayObj.innerHTML+="<br><br>";displayObj.innerHTML+="<a href='Javascript:void(0)' style='color: red; text-decoration:underline;'>Possible dupe request</a>";displayObj.addEventListener("click",function(){var e;if(e=document.getElementById("resR"+displayId)){if(e.parentNode.style.display=="none")e.parentNode.style.display="";else e.parentNode.style.display="none"}else{var t=document.createElement("tr");var n=document.createElement("td");n.id="resR"+displayId;n.setAttribute("colspan","15");n.setAttribute("style","background-color: #DCDCDC; border: 2px inset darkgrey; padding-top:2px;");t.appendChild(n);n.innerHTML="<table style='width:100%'>"+matches.map(function(e){var t="<tr><td style='max-width:55px; width:55px; text-align:center;overflow:hidden;font-size:8pt;'>"+generalCategory(e.category,true).split(" ")[0]+"</td><td style='padding-left:10px; width:58%; height:2em;'><a href='/reqdetails.php?id="+e.id+"' target='_blank'>";try{t+=decodeURIComponent(e.name.replace(/%96/g,"-"))}catch(n){console.log(n);t+=e.name.replace(/%20/g," ").replace(/[\W0-9]+/g," ")}t+="</a></td><td style='align:left;'>Request</td>";return t}).join("</tr>")+"</table>";this.parentNode.parentNode.insertBefore(t,this.parentNode.nextElementSibling)}},false)}else{if(displayObj.innerHTML=="")displayObj.innerHTML="OK"}}}if(dupeRChecker)checkPageForDupes(jsonSearch.time_taken)}}function generalCategory(e,t){var n=Object.keys(window.sections).length;var r;for(r=0;r<n;r++){if(window.sections[r][3]==e)break}var i=window.sections[r][0];if(t)return i;else return i.slice(0,2)}function readTorrent(e){window.fileTypes={audio:0,ebook:0,image:0,video:0,other:0,fileExts:[],summary:""};if(window.File&&window.FileReader&&window.FileList&&window.Blob){var t=e.files[0];var n=new FileReader;n.onload=function(e){console.log(e.target);var t=[];var n=[];var r=new RegExp("pathl(\\d+):","gm");var s=new RegExp("name(\\d+):");var o;var u;var a;while(o=r.exec(e.target.result)){try{fName=e.target.result.slice(o.index+o[0].length,o.index+o[0].length+parseInt(o[1]));u=/(.+?)(\.(\w+)$|$)/.exec(fName);if(o){n.push(u[1]);if(u[3])t.push(u[3])}}catch(e){console.log(e);break}}o=s.exec(e.target.result);console.log(o);if(o&&!t.length){try{fName=e.target.result.slice(o.index+o[0].length,o.index+o[0].length+parseInt(o[1]));o=/(.+?)(\.(\w+)$|$)/.exec(fName);console.log(fName);if(o){n.push(o[1]);if(o[3])t.push(o[3])}}catch(e){console.log(e)}}console.log(t);console.log(n);var f=new RegExp(window.ebookFormats,"i");var l=new RegExp(window.audioFormats,"i");var c=new RegExp(window.videoFormats,"i");var h=new RegExp(window.imageFormats,"i");for(i=0;i<t.length;i++){if(l.test(t[i]))window.fileTypes.audio++;else if(f.test(t[i]))window.fileTypes.ebook++;else if(h.test(t[i]))window.fileTypes.image++;else if(c.test(t[i]))window.fileTypes.video++;else window.fileTypes.other++}window.fileTypes["fileExts"]=t;var p;var d=[];for(i=0;i<window.fileTypes.fileExts.length;i++){p=window.fileTypes.fileExts[i].toUpperCase();d[p]=d[p]?d[p]+1:1}window.fileTypes.summary="<b>Format";var v=Object.keys(d);if(v.length>1)window.fileTypes.summary+="s";window.fileTypes.summary+="</b>: "+v.sort(function(e,t){console.log(d["MP3"]);return d[t]-d[e]}).map(function(e){if(!l.test(e)&&!f.test(e)&&!c.test(e))return;if(d[e]>1)return d[e]+" "+e+"s";else return e}).filter(function(e){return e?true:false}).join(", ");if(window.fileTypes.summary.slice(-1)==" ")window.fileTypes.summary="";console.log(window.fileTypes.summary);console.log(window.fileTypes);if(features.UHAutomate)uploadHelper()};n.onerror=function(e){console.log("error reading file");if(features.UHAutomate)uploadHelper()};n.readAsText(t)}else{console.log("File Reading not supported.");if(features.UHAutomate)uploadHelper()}}function freeleech(){var e=document.createElement("input");e.type="button";e.value="Make free leech";e.addEventListener("click",function(){var e=/id=(\d+?)(&|$)/.exec(url);openHTML("/details.php?id="+e[1],"torrentInfo()",noXMLDoc)},false);contentTable.insertBefore(e,contentTable.firstChild)}function torrentInfo(){var e=noXMLDoc.getElementsByTagName("h1")[0];var t="xxxx";var n=e.nextSibling.nextSibling.getElementsByTagName("table")[0];var r=n.nextSibling.nextSibling;var s=r.getElementsByClassName("row2");for(i=0;i<11;i++){if(s[i].innerHTML.slice(0,4)=="Type"){var o=s[i].nextSibling.innerHTML;break}else if(s[i].innerHTML=="Info hash")var u=s[i].parentNode.nextElementSibling.firstChild.nextElementSibling.firstChild.nodeValue;else if(s[i].innerHTML=="Description")var a=s[i].nextSibling.innerHTML}var f=r.getElementsByTagName("img")[0].src;var l=Object.keys(sections);var c;for(i=0;i<l.length;i++){if(o===sections[i][0]){o=/&cat=(\d+?)&/.exec(sections[i][1])[1];break}}a=a.replace(/(\s| )?/g,"");var h=document.createElement("div");h.innerHTML="<br />"+t+"<br /><br />"+name+"<br /><br />"+f+"<br /><br />"+u+"<br /><br /><hr>"+a+"<hr><br /><br />"+o+"<br />";contentTable.insertBefore(h,contentTable.firstChild)}function reDdFromUploads(){var e=contentTable.getElementsByTagName("img");var t;var n;var r=0;var s=[];var o=[];var u=[];var a=/torrent=(.+)/;var f=contentTable.getElementsByClassName("colhead");var l=f[2].parentNode.parentNode.parentNode.previousElementSibling;var c=document.createElement("div");c.id="dupeCheckDiv";c.innerHTML="Check the uploads on this page for dupes";c.setAttribute("style","font-size:1.3em; padding-top:3px; padding-bottom:7px; cursor:pointer; color:darkblue; text-decoration:underline; width: 22em;");c.addEventListener("click",checkPageForDupes,false);if(window.isStaff&&window.uClass>=62)l.parentNode.insertBefore(c,l);var h=f[2].cloneNode(true);h.innerHTML="Get";var p=h.cloneNode(true);p.innerHTML="Dupe Check";p.id="dupeHeadingTd";p.setAttribute("style","display:none; min-width:4.7em; text-align:center;");f[0].parentNode.insertBefore(h,f[2]);f[0].parentNode.insertBefore(p,h);if(window.uClass>=62&&!window.emulating){var d=f[4].cloneNode(true);f[3].parentNode.removeChild(f[4]);f[0].parentNode.appendChild(d)}f[window.uClass>=62?6:6].setAttribute("style","display:none");var v;var m;var g;var y;j=0;for(i=0;i<e.length;i++){if(e[i].getAttribute("title")==="Bookmark"){n=a.exec(e[i].parentNode.getAttribute("href"))[1];t=e[i].parentNode.parentNode.parentNode;if(window.torrList[n]){t.previousElementSibling.appendChild(prevDownloadedDiv(window.torrList[n]))}s[j]=document.createElement("td");s[j].setAttribute("class","row2");u[j]=document.createElement("img");try{oldDD=e[i].parentNode.nextElementSibling;tURL=oldDD.href;oldDD.parentNode.removeChild(oldDD)}catch(b){tURL="/download.php/"+n+"/"+n+".torrent"}if(t.nextElementSibling.innerHTML=="deleted")tURL="";else if(t.nextElementSibling.nextElementSibling.innerHTML=="deleted")tURL="";u[j].setAttribute("src",ddButtonSrc);u[j].addEventListener("click",createDD(tURL,t),false);u[j].setAttribute("style","height:20px;width:20px;cursor:pointer");s[j].appendChild(u[j]);t.parentNode.insertBefore(s[j],t.nextSibling);if(e[i].parentNode.previousElementSibling)e[i].parentNode.parentNode.removeChild(e[i].parentNode.previousElementSibling);if(window.uClass>=62&&!window.emulating){y=t.nextElementSibling.nextElementSibling.cloneNode(true);t.parentNode.removeChild(t.nextElementSibling.nextElementSibling);t.parentNode.appendChild(y);t.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.setAttribute("style","display:none;");o[j]=document.createElement("td");o[j].setAttribute("class","row2 dupeTd");o[j].id="dupeTd"+n;o[j].setAttribute("title",t.getElementsByTagName("a")[0].title);o[j].setAttribute("cat",t.previousElementSibling.firstElementChild.firstElementChild.title.slice(0,2));o[j].setAttribute("torrId",n);o[j].setAttribute("style","display:none; text-align:center;");t.parentNode.insertBefore(o[j],s[j])}else{t.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.setAttribute("style","display:none;")}j++}else if(e[i].getAttribute("alt")==="vip"){e[i].nextElementSibling.setAttribute("style","display:none;")}}}function fixSnatchesButtons(){var e=document.getElementsByClassName("embedded")[0];var t=e.getElementsByTagName("tr");var n;var r;var s;var o;var u;var a=false;var f=false;var l=document.createElement("th");l.innerHTML="Do things";l.setAttribute("class","colhead");t[0].appendChild(l);for(i=1;i<t.length;i++){n=document.createElement("td");n.setAttribute("class","row1");if(t[i].getElementsByClassName("row1-red").length>0||/leeching/i.test(url))f=true;else{u=t[i].getElementsByClassName("row1-yellow");for(j=0;j<u.length;j++){if(/\./.test(u[j].innerHTML))a=true;else if(/:/.test(u[j].innerHTML)){f=true;break}}}if(a){r=document.createElement("input");r.type="button";r.setAttribute("style","text-align:center; width: 9em;");r.value="Fix Ratio";r.addEventListener("click",ratioFix,false);n.appendChild(r)}if(f){s=document.createElement("input");s.type="button";s.setAttribute("style","text-align:center; margin-top: 2px; width: 9em;");s.value="Add 72h";s.addEventListener("click",seedTFix,false);n.appendChild(s)}o=document.createElement("input");o.type="button";o.setAttribute("style","text-align:center; margin-top: 2px; width: 9em;");o.value="Re-download";o.addEventListener("click",reDD,false);n.appendChild(o);t[i].appendChild(n);a=f=false}}function ratioFix(e,t,n){if(!t){try{var r=/id=(\d+)/.exec(this.parentNode.parentNode.getElementsByTagName("a")[0].getAttribute("href"))[1]}catch(i){alert("Error finding id.");return}var s=document.getElementById("bonusLink").innerHTML.split(":")[1].replace(/,/,"");if(s.innerHTML<500){alert("Insufficient karma.");return}this.removeEventListener("click",ratioFix,false);this.value="Processing";this.style.cursor="wait";openHTML("/mybonus.php?exchange=1","ratioFix(0,1)",noXMLDoc,"torrent_id="+r+"&option=10&art=ratio&submit=Exchange%21")}else{if(n){alert("err")}window.open(url,"_top")}}function seedTFix(e,t,n){if(!t){try{var r=/id=(\d+)/.exec(this.parentNode.parentNode.getElementsByTagName("a")[0].getAttribute("href"))[1]}catch(i){alert("Error finding id.");return}var s=document.getElementById("bonusLink").innerHTML.split(":")[1].replace(/,/,"");if(s.innerHTML<1e3){alert("Insufficient karma.");return}this.removeEventListener("click",seedTFix,false);this.value="Processing";this.style.cursor="wait";openHTML("/mybonus.php?exchange=1","seedTFix(0,1)",noXMLDoc,"torrent_id="+r+"&option=11&art=timebuy&submit=Exchange%21")}else{if(n){alert("err")}window.open(url,"_top")}}function reDD(){var e;try{e=/id=(\d+)/.exec(this.parentNode.parentNode.getElementsByTagName("a")[0].getAttribute("href"))[1]}catch(t){try{e=/id=(\d+)/.exec(this.parentNode.parentNode.getElementsByTagName("a")[1].getAttribute("href"))[1]}catch(t){try{e=/id=(\d+)/.exec(this.parentNode.parentNode.getElementsByTagName("a")[2].getAttribute("href"))[1]}catch(t){alert("Error finding id.");return}}}window.open("/download.php/"+e+"/"+e+".torrent","_top")}function pullReqGenre(e,t){if(!t){window.jsonQSearch={};openHTML("/jsonSearch.php?request=true&SS="+dupeTerms(e).join("+"),"pullReqGenre(null,true)","window.jsonQSearch")}else{try{var n=/id=(\d+)/.exec(url)[1];for(i=0;i<2;i++){if(window.jsonQSearch.results[i].id==n){var r=document.createElement("tr");var s=document.createElement("td");var o=document.createElement("td");s.setAttribute("class","row2");s.innerHTML="Category";o.setAttribute("class","row1");o.innerHTML=generalCategory(window.jsonQSearch.results[i].category,true);r.appendChild(s);r.appendChild(o);window.row1s[2].parentNode.parentNode.insertBefore(r,window.row1s[3].parentNode);break}}}catch(u){console.log(u)}}}function allReqsLink(e){if(e!=true){this.removeEventListener("click",allReqsLink,false);this.style.cursor="wait";window.quickUSearch=document.createElement("html");openHTML("/n_a/userQuickSearch.php?SEARCH="+window.reqUser,"allReqsLink(true)",window.quickUSearch)}else{try{var t=/receiver=(\d+)/.exec(window.quickUSearch.innerHTML)[1];window.open("/viewrequests.php?requestorid="+t,"_blank");var n=document.getElementById("reqUserAllReqsA");n.style.cursor="pointer";n.addEventListener("click",allReqsLink,false)}catch(r){console.log(r);alert("Error... is this you?")}}}function adjLog(){var e=contentTable.getElementsByClassName("tableb");var t;var n;var r;var s;for(i=1;i<e.length;i++){t=e[i].firstElementChild.nextElementSibling.nextElementSibling.firstElementChild;n=/Torrent.(\d+)/.exec(t.innerHTML);r=/(removed|uploaded|deleted|edited) by (\w+)/.exec(t.innerHTML);console.log(t.innerHTML);if(n){if(/was deleted by/.test(t.innerHTML))s="/det-deleted.php?id=";else s="/details.php?id=";t.innerHTML=t.innerHTML.replace(n[0],"<a style='color:black; text-decoration:none' target='_blank' href='"+s+n[1]+"&filelist=1&dupeCheck=1'>"+n[0]+"</a>");var o=/was deleted by.+?(\d{5,})/i.exec(t.innerHTML);if(o){console.log(o);var u=new RegExp("\\s(\\S*?"+o[1]+"\\S*?)","i");var a=u.exec(t.innerHTML);console.log(a);t.innerHTML=t.innerHTML.replace(a[1],"<a style='color:black; text-decoration:none;' target='_blank' href='/details.php?id="+o[1]+"&filelist=1&dupeCheck=1'>"+a[1]+"</a>")}}if(r){t.innerHTML=t.innerHTML.replace(r[2],"<a style='color:black; text-decoration:none' target='_blank' href='/n_a/userQuickSearch.php?SEARCH="+r[2]+"'>"+r[2]+"</a>")}}}function undelBtn(e,t){if(window.uClass<=70)return;if(t){window.location.assign("/details.php?id="+e);return}var n=contentTable.getElementsByTagName("h1")[0];var r=document.createElement("input");r.type="button";r.value="Restore this torrent";r.setAttribute("style","cursor:pointer");r.addEventListener("click",subUndel,false);n.parentNode.insertBefore(r,n.nextElementSibling)}function subUndel(){var e=undelIdRegRes[1];this.removeEventListener("click",subUndel,false);openHTML("/undeletetorrent.php?","undelBtn("+e+",true)",noXMLDoc,"torrent_id="+e);this.setAttribute("style","cursor:wait")}function missingSubjAlert(){var e=contentTable.getElementsByTagName("h1")[0].nextElementSibling;var t=contentTable.getElementsByTagName("input");var n;for(i=0;i<t.length;i++){if(t[i].getAttribute("name")=="subject"){n=t[i]}else if(t[i].getAttribute("type")=="submit"){subBtn=t[i];break}}e.addEventListener("submit",function(t){t.preventDefault();var r;r=document.getElementById("msg_ifr");if(!r)r=document.getElementById("pmMSG_ifr");var i;i=document.getElementById("msg");if(!i)i=document.getElementById("pmMSG");i.innerHTML=r.contentDocument.getElementsByTagName("body")[0].innerHTML;if(n.value){e.submit()}else{alert("Add a subject, please.")}},false)}function indiDupeChecker(){var e=document.getElementsByTagName("body")[0];document.title="Dupe Checker";var t=document.createElement("textarea");t.id="inNames";t.setAttribute("style","display:block; height: 7.3em; left:2.5em; margin-bottom: 8px; position:relative; width:70%;");var n=document.createElement("input");n.setAttribute("type","button");n.id="processBtn";n.setAttribute("style","display:default; margin-bottom: 2em;");n.value="Check For Duplicates";e.innerHTML="<table width='100%' border='0' cellpadding='2'> <tr> <th scope='col'>Input</th> <th scope='col'>Output</th> </tr> <tr> <td id='inTd' style='text-align:left; width:50%'>Separate titles with new lines (max. 100):<br /> </td> <td id='outTd' valign='top'><textarea id='outText' style='display:none; position:relative; top:1.3em; width:100%;'></textarea></td> </tr></table>";window.inTd=document.getElementById("inTd");window.inTd.appendChild(t);window.inTd.appendChild(n);window.inTd.innerHTML+="<form action='' style='display:inline;'><input id='cat' type='radio' name='cat' value='Eb' checked>Ebooks Only  <input type='radio' name='cat' value=''>All Formats</form>";var r=document.createElement("table");r.setAttribute("width","100%");r.id="processedTable";window.inTd.appendChild(r);document.getElementById("processBtn").addEventListener("click",indiDupeCheckerStart,false);document.getElementById("updateOutputBtn").addEventListener("click",updateOutputList,false)}function indiDupeCheckerStart(){var e=document.getElementById("inNames").value.split("\n");var t=document.getElementById("processedTable");if(e[0]==""&&e.length==1)return;t.innerHTML="<tr><th>Title</th><th>Dupe Check</th><th>Accept?</th></tr>";for(i=0;i<e.length;i++){if(!/^\s*$/.test(e[i])){t.innerHTML+="<tr><td>"+e[i]+"</td><td class='dupeTd' id='dupeTd"+i+"' title='"+e[i]+"' cat='"+(document.getElementById("cat").checked?"Eb":"")+"'>Queued</td><td><input type='checkbox'></td></tr>"}}window.dupeCheckerNum=0;window.dupeTds=document.querySelectorAll(".dupeTd");createDupeChecker()}function indiDupeCheckerFinish(e){console.log(e);var t=document.getElementById("outText");var n=document.getElementById("updateOutputBtn");t.innerHTML="";j=0;for(i=0;i<window.dupeTds.length;i++){if(!e){window.dupeTds[i].nextElementSibling.firstElementChild.addEventListener("click",function(){indiDupeCheckerFinish(true)},false);if(window.dupeTds[i].innerHTML=="OK"){window.dupeTds[i].nextElementSibling.firstElementChild.checked=true;t.innerHTML+=window.dupeTds[i].previousElementSibling.innerHTML+"\n";j++}}else if(window.dupeTds[i].nextElementSibling.firstElementChild.checked==true){t.innerHTML+=window.dupeTds[i].previousElementSibling.innerHTML+"\n";j++}}if(j>0){t.style.display="block";t.style.height=t.scrollHeight+"px"}else{t.style.display="none"}}var version=".2.1.21";var browserRegEx=/(Firefox|Iron|Chrome)\.?[\/\s](\d+\.\d+)/;var nav=browserRegEx.exec(navigator.userAgent);var browser=nav[1];var browserVersion=nav[2];if(browser==="Firefox"){if(browserVersion<4){alert("MAM Features Script requires Firefox version 4 or higher.");eval("return")}}else if(browser==="Iron"){if(browserVersion<16){alert("MAM Features Script requires SRWare Iron version 16 or higher.");eval("return")}}else if(browser==="Chrome"){if(browserVersion<5){alert("MAM Features Script requires Chrome version 5 or higher.");eval("return")}}else{alert("MAM features only runs on Firefox or SWRare Iron, at the moment.");eval("return")}var updateGM=false;if(browser==="Firefox"&&browserVersion>=14&&cmpVersion(GM_info.version,"1.10")<0){updateGM=true}ddButtonSrc="/imagebucket/download48[1].png";pmWaitSrc="/imagebucket/pmWait.gif";pmCloseSrc="/imagebucket/pmClose.png";genCloseSrc="/imagebucket/genClose.png";warnWaitSrc="/imagebucket/warnWait.gif";var xmlHttp,xmlHttpReady=false;window.timeOut=0;window.errType="Unknown";window.noXMLDoc=document.createElement("html");window.redsXMLDoc=document.createElement("html");window.jsonLoad={};var i,j,k,tbtText;var url=document.URL;var uid=readCookie("uid");var now=new Date;window.controlKey=false;features=_getValue("fSettings",null);if(features)features=eval("("+features+")");else resetOptions(1);window.eroticaAuthorsRegEx=new RegExp("maya banks|mari carr|vivian arend|kelly favor|cherrie lynn|raine miller|fifty shades|E[\\s\\.]\\s?L[\\s\\.]\\s?james|jaci burton|charlotte stein|cherise sinclare|olivia cunning|anne tenino|sylvain reynard|karin tabke|laurann dohner|anne rice|roquelaure|sylvia day|shayla black|lorelei james|pauline r.age|ana.s nin|samantha young|lauren dane|lora leigh|kristen ashley|cara mckenna|kallypso masters|megan hart|beth kery|lainey reese|kele moon|tymber dalton|tiffany reisz|melissa schroeder|charlotte featherstone|kate pearce|c[\\s\\.]\\s?j[\\s\\.]\\s?roberts|renee jones|joey( w.)? hill|lisa( marie)?rice|sydney croft|annmarie mckenna|lacey alexander|bella andre|sierra cartwright|larissa ione|lissa matthews|samantha kane|elizabeth amber|opal carew|jess michaels|elle kennedy|j[\\s\\.]\\s?r[\\s\\.]\\s?ward|m\\.?\\s leighton|jayne rylon|allyson james|damon suede|mathewson|gina( l\\.?)? maxwell|kit rocha|sophie renwick|eve berlin|lexi blake|soaphie oak|delphine dryden|nikita black|shelley bradley|margaret carter|Ell?ora.?s cave","i");window.bannedAuthorsRegEx=new RegExp("joan elliot|alan dart|sara gruen|anne perry|simon scarrow|tolkien","i");window.ebookFormats="docx?|txt|lit|html|chm|pdf|pdb|djvu|lrf|rtf|prc|mobi|epub|cbr|cbz|azw|azw3";window.audioFormats="mp3|ogg|m4a|wma|m4b|aac|flac";window.videoFormats="avi|mpe?g|xvid|divx|mpv|mkv|vob|mp4|m4v";window.imageFormats="jpe?g|png|gif|bmp";window.sections={0:["Audiobooks - Action/Adventure","http://www.myanonamouse.net/browse.php?subcat=0&cat=39&incldead=","http://www.myanonamouse.net/pic/aAdventure.png",39],1:["Audiobooks - Art","http://www.myanonamouse.net/browse.php?subcat=0&cat=49&incldead=","http://www.myanonamouse.net/pic/aArt.png",49],2:["Audiobooks - Biographical","http://www.myanonamouse.net/browse.php?subcat=0&cat=50&incldead=","http://www.myanonamouse.net/pic/aBio.png",50],3:["Audiobooks - Business","http://www.myanonamouse.net/browse.php?subcat=0&cat=83&incldead=","http://www.myanonamouse.net/pic/ab-business.jpg",83],4:["Audiobooks - Computer/Internet","http://www.myanonamouse.net/browse.php?subcat=0&cat=51&incldead=","http://www.myanonamouse.net/pic/aPC.png",51],5:["Audiobooks - Crafts","http://www.myanonamouse.net/browse.php?subcat=0&cat=97&incldead=","http://www.myanonamouse.net/pic/ab-crafts.jpg",97],6:["Audiobooks - Crime/Thriller","http://www.myanonamouse.net/browse.php?subcat=0&cat=40&incldead=","http://www.myanonamouse.net/pic/aCrime.png",40],7:["Audiobooks - Fantasy","http://www.myanonamouse.net/browse.php?subcat=0&cat=41&incldead=","http://www.myanonamouse.net/pic/aFantasy.png",41],8:["Audiobooks - Food","http://www.myanonamouse.net/browse.php?subcat=0&cat=106&incldead=","http://www.myanonamouse.net/pic/ab-cooking.jpg",106],9:["Audiobooks - General Fiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=42&incldead=","http://www.myanonamouse.net/pic/aGenFic.png",42],10:["Audiobooks - General Non-Fic","http://www.myanonamouse.net/browse.php?subcat=0&cat=52&incldead=","http://www.myanonamouse.net/pic/aGenNonFic.png",52],11:["Audiobooks - HistoricalFiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=98&incldead=","http://www.myanonamouse.net/pic/ab-historical_fiction.jpg",98],12:["Audiobooks - History","http://www.myanonamouse.net/browse.php?subcat=0&cat=54&incldead=","http://www.myanonamouse.net/pic/aHistory.png",54],13:["Audiobooks - Home/Garden","http://www.myanonamouse.net/browse.php?subcat=0&cat=55&incldead=","http://www.myanonamouse.net/pic/aHomeGarden.png",55],14:["Audiobooks - Horror","http://www.myanonamouse.net/browse.php?subcat=0&cat=43&incldead=","http://www.myanonamouse.net/pic/aHorror.png",43],15:["Audiobooks - Humor","http://www.myanonamouse.net/browse.php?subcat=0&cat=99&incldead=","http://www.myanonamouse.net/pic/ab-humor.jpg",99],16:["Audiobooks - Instructional","http://www.myanonamouse.net/browse.php?subcat=0&cat=84&incldead=","http://www.myanonamouse.net/pic/ab-instructional.jpg",84],17:["Audiobooks - Juvenile","http://www.myanonamouse.net/browse.php?subcat=0&cat=44&incldead=","http://www.myanonamouse.net/pic/aJuvenile.png",44],18:["Audiobooks - Language","http://www.myanonamouse.net/browse.php?subcat=0&cat=56&incldead=","http://www.myanonamouse.net/pic/aLanguage.png",56],19:["Audiobooks - Literary Classics","http://www.myanonamouse.net/browse.php?subcat=0&cat=45&incldead=","http://www.myanonamouse.net/pic/aClassics.png",45],20:["Audiobooks - Math/Science/Tech","http://www.myanonamouse.net/browse.php?subcat=0&cat=57&incldead=","http://www.myanonamouse.net/pic/aMST.png",57],21:["Audiobooks - Medical","http://www.myanonamouse.net/browse.php?subcat=0&cat=85&incldead=","http://www.myanonamouse.net/pic/ab-medical.jpg",85],22:["Audiobooks - Mystery","http://www.myanonamouse.net/browse.php?subcat=0&cat=87&incldead=","http://www.myanonamouse.net/pic/ab-mystery.jpg",87],23:["Audiobooks - Nature","http://www.myanonamouse.net/browse.php?subcat=0&cat=119&incldead=","http://www.myanonamouse.net/imagebucket/ab-nature.png",119],24:["Audiobooks - Philosophy","http://www.myanonamouse.net/browse.php?subcat=0&cat=88&incldead=","http://www.myanonamouse.net/pic/ab-philosophy.jpg",88],25:["Audiobooks - Pol/Soc/Relig","http://www.myanonamouse.net/browse.php?subcat=0&cat=58&incldead=","http://www.myanonamouse.net/pic/aPSR.png",58],26:["Audiobooks - Radio Drama/OTR","http://www.myanonamouse.net/browse.php?subcat=0&cat=29&incldead=","http://www.myanonamouse.net/pic/radiodrama.png",29],27:["Audiobooks - Recreation","http://www.myanonamouse.net/browse.php?subcat=0&cat=59&incldead=","http://www.myanonamouse.net/pic/aRecreation.png",59],28:["Audiobooks - Romance","http://www.myanonamouse.net/browse.php?subcat=0&cat=46&incldead=","http://www.myanonamouse.net/pic/aRomance.png",46],29:["Audiobooks - Science Fiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=47&incldead=","http://www.myanonamouse.net/pic/aSF.png",47],30:["Audiobooks - Self-Help","http://www.myanonamouse.net/browse.php?subcat=0&cat=53&incldead=","http://www.myanonamouse.net/pic/aHBM.png",53],31:["Audiobooks - Travel/Adventure","http://www.myanonamouse.net/browse.php?subcat=0&cat=89&incldead=","http://www.myanonamouse.net/pic/ab-travel-adventure.jpg",89],32:["Audiobooks - True Crime","http://www.myanonamouse.net/browse.php?subcat=0&cat=100&incldead=","http://www.myanonamouse.net/pic/ab-true_crime.jpg",100],33:["Audiobooks - Urban Fantasy","http://www.myanonamouse.net/browse.php?subcat=0&cat=108&incldead=","http://www.myanonamouse.net/pic/ab-urban_fantasy.jpg",108],34:["Audiobooks - Western","http://www.myanonamouse.net/browse.php?subcat=0&cat=48&incldead=","http://www.myanonamouse.net/pic/aWestern.png",48],35:["Audiobooks - Young Adult","http://www.myanonamouse.net/browse.php?subcat=0&cat=111&incldead=","http://www.myanonamouse.net/pic/ab-ya.jpg",111],36:["Complete Editions","http://www.myanonamouse.net/browse.php?subcat=0&cat=17&incldead=","http://www.myanonamouse.net/pic/completeeditions.png",17],37:["Concert Videos","http://www.myanonamouse.net/browse.php?subcat=0&cat=23&incldead=","http://www.myanonamouse.net/pic/concertvideo.png",23],38:["Ebooks - Action/Adventure","http://www.myanonamouse.net/browse.php?subcat=0&cat=60&incldead=","http://www.myanonamouse.net/pic/eAdventure.png",60],39:["Ebooks - Art","http://www.myanonamouse.net/browse.php?subcat=0&cat=71&incldead=","http://www.myanonamouse.net/pic/eArt.png",71],40:["Ebooks - Biographical","http://www.myanonamouse.net/browse.php?subcat=0&cat=72&incldead=","http://www.myanonamouse.net/pic/eBio.png",72],41:["Ebooks - Business","http://www.myanonamouse.net/browse.php?subcat=0&cat=90&incldead=","http://www.myanonamouse.net/pic/eb-business.jpg",90],42:["Ebooks - Comics/Graphic novels","http://www.myanonamouse.net/browse.php?subcat=0&cat=61&incldead=","http://www.myanonamouse.net/pic/eComics.png",61],43:["Ebooks - Computer/Internet","http://www.myanonamouse.net/browse.php?subcat=0&cat=73&incldead=","http://www.myanonamouse.net/pic/ePC.png",73],44:["Ebooks - Crafts","http://www.myanonamouse.net/browse.php?subcat=0&cat=101&incldead=","http://www.myanonamouse.net/pic/eb-crafts.jpg",101],45:["Ebooks - Crime/Thriller","http://www.myanonamouse.net/browse.php?subcat=0&cat=62&incldead=","http://www.myanonamouse.net/pic/eCrime.png",62],46:["Ebooks - Fantasy","http://www.myanonamouse.net/browse.php?subcat=0&cat=63&incldead=","http://www.myanonamouse.net/pic/eFantasy.png",63],47:["Ebooks - Food","http://www.myanonamouse.net/browse.php?subcat=0&cat=107&incldead=","http://www.myanonamouse.net/pic/eb-cooking.jpg",107],48:["Ebooks - General Fiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=64&incldead=","http://www.myanonamouse.net/pic/eGenFic.png",64],49:["Ebooks - General Non-Fiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=74&incldead=","http://www.myanonamouse.net/pic/eGenNonFic.png",74],50:["Ebooks - Historical Fiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=102&incldead=","http://www.myanonamouse.net/pic/eb-historical_fiction.jpg",102],51:["Ebooks - History","http://www.myanonamouse.net/browse.php?subcat=0&cat=76&incldead=","http://www.myanonamouse.net/pic/eHistory.png",76],52:["Ebooks - Home/Garden","http://www.myanonamouse.net/browse.php?subcat=0&cat=77&incldead=","http://www.myanonamouse.net/pic/eHomeGarden.png",77],53:["Ebooks - Horror","http://www.myanonamouse.net/browse.php?subcat=0&cat=65&incldead=","http://www.myanonamouse.net/pic/eHorror.png",65],54:["Ebooks - Humor","http://www.myanonamouse.net/browse.php?subcat=0&cat=103&incldead=","http://www.myanonamouse.net/pic/eb-humor.jpg",103],55:["Ebooks - Illusion/Magic","http://www.myanonamouse.net/browse.php?subcat=0&cat=115&incldead=","http://www.myanonamouse.net/pic/eb-magic.jpg",115],56:["Ebooks - Instructional","http://www.myanonamouse.net/browse.php?subcat=0&cat=91&incldead=","http://www.myanonamouse.net/pic/eb-instructional.jpg",91],57:["Ebooks - Juvenile","http://www.myanonamouse.net/browse.php?subcat=0&cat=66&incldead=","http://www.myanonamouse.net/pic/eJuvenile.png",66],58:["Ebooks - Language","http://www.myanonamouse.net/browse.php?subcat=0&cat=78&incldead=","http://www.myanonamouse.net/pic/eLanguage.png",78],59:["Ebooks - Literary Classics","http://www.myanonamouse.net/browse.php?subcat=0&cat=67&incldead=","http://www.myanonamouse.net/pic/eClassics.png",67],60:["Ebooks - Magazines/Newspapers","http://www.myanonamouse.net/browse.php?subcat=0&cat=79&incldead=","http://www.myanonamouse.net/pic/eNewspaper.png",79],61:["Ebooks - Math/Science/Tech","http://www.myanonamouse.net/browse.php?subcat=0&cat=80&incldead=","http://www.myanonamouse.net/pic/eMST.png",80],62:["Ebooks - Medical","http://www.myanonamouse.net/browse.php?subcat=0&cat=92&incldead=","http://www.myanonamouse.net/pic/eb-medical.jpg",92],63:["Ebooks - Mixed Collections","http://www.myanonamouse.net/browse.php?subcat=0&cat=118&incldead=","http://www.myanonamouse.net/pic/eb-mixed.jpg",118],64:["Ebooks - Mystery","http://www.myanonamouse.net/browse.php?subcat=0&cat=94&incldead=","http://www.myanonamouse.net/pic/eb-mystery.jpg",94],65:["Ebooks - Nature","http://www.myanonamouse.net/browse.php?subcat=0&cat=120&incldead=","http://www.myanonamouse.net/imagebucket/eNT.png",120],66:["Ebooks - Philosophy","http://www.myanonamouse.net/browse.php?subcat=0&cat=95&incldead=","http://www.myanonamouse.net/pic/eb-philosophy.jpg",95],67:["Ebooks - Pol/Soc/Relig","http://www.myanonamouse.net/browse.php?subcat=0&cat=81&incldead=","http://www.myanonamouse.net/pic/ePSR.png",81],68:["Ebooks - Recreation","http://www.myanonamouse.net/browse.php?subcat=0&cat=82&incldead=","http://www.myanonamouse.net/pic/eRecreation.png",82],69:["Ebooks - Romance","http://www.myanonamouse.net/browse.php?subcat=0&cat=68&incldead=","http://www.myanonamouse.net/pic/eRomance.png",68],70:["Ebooks - Science Fiction","http://www.myanonamouse.net/browse.php?subcat=0&cat=69&incldead=","http://www.myanonamouse.net/pic/eSF.png",69],71:["Ebooks - Self-Help","http://www.myanonamouse.net/browse.php?subcat=0&cat=75&incldead=","http://www.myanonamouse.net/pic/eHBM.png",75],72:["Ebooks - Travel/Adventure","http://www.myanonamouse.net/browse.php?subcat=0&cat=96&incldead=","http://www.myanonamouse.net/pic/eb-travel-adventure.jpg",96],73:["Ebooks - True Crime","http://www.myanonamouse.net/browse.php?subcat=0&cat=104&incldead=","http://www.myanonamouse.net/pic/eb-true_crime.jpg",104],74:["Ebooks - Urban Fantasy","http://www.myanonamouse.net/browse.php?subcat=0&cat=109&incldead=","http://www.myanonamouse.net/pic/eb-urban_fantasy.jpg",109],75:["Ebooks - Western","http://www.myanonamouse.net/browse.php?subcat=0&cat=70&incldead=","http://www.myanonamouse.net/pic/eWestern.png",70],76:["Ebooks - Young Adult","http://www.myanonamouse.net/browse.php?subcat=0&cat=112&incldead=","http://www.myanonamouse.net/pic/eb-ya.jpg",112],77:["All Other Formats","http://www.myanonamouse.net/browse.php?subcat=0&cat=6&incldead=","http://www.myanonamouse.net/pic/otherformats.png",6],78:["Guitar/Bass Tabs","http://www.myanonamouse.net/browse.php?subcat=0&cat=19&incldead=","http://www.myanonamouse.net/pic/tabs.png",19],79:["Individual Sheet","http://www.myanonamouse.net/browse.php?subcat=0&cat=20&incldead=","http://www.myanonamouse.net/pic/individual.png",20],80:["Individual Sheet MP3","http://www.myanonamouse.net/browse.php?subcat=0&cat=24&incldead=","http://www.myanonamouse.net/pic/individualmp3.png",24],81:["Instructional Media","http://www.myanonamouse.net/browse.php?subcat=0&cat=22&incldead=","http://www.myanonamouse.net/pic/instructionalmedia.png",22],82:["Lick Library - LTP/Jam With","http://www.myanonamouse.net/browse.php?subcat=0&cat=113&incldead=","http://www.myanonamouse.net/pic/LickLibraryIcon1.jpg",113],83:["Lick Library - Techniques/QL","http://www.myanonamouse.net/browse.php?subcat=0&cat=114&incldead=","http://www.myanonamouse.net/pic/LickLibraryIcon2.jpg",114],84:["Music Book","http://www.myanonamouse.net/browse.php?subcat=0&cat=26&incldead=","http://www.myanonamouse.net/pic/musicbook.png",26],85:["Music Book MP3","http://www.myanonamouse.net/browse.php?subcat=0&cat=27&incldead=","http://www.myanonamouse.net/pic/musicbookmp3.png",27],86:["Sheet Collection","http://www.myanonamouse.net/browse.php?subcat=0&cat=30&incldead=","http://www.myanonamouse.net/pic/collection.png",30],87:["Sheet Collection MP3","http://www.myanonamouse.net/browse.php?subcat=0&cat=31&incldead=","http://www.myanonamouse.net/pic/collectionmp3.png",31],88:["TV / Radio - Music Related","http://www.myanonamouse.net/browse.php?subcat=0&cat=35&incldead=","http://www.myanonamouse.net/pic/tvmusic.png",35],89:["Ebooks - with Video Tutorial","http://www.myanonamouse.net/browse.php?subcat=0&cat=121&incldead=","http://www.myanonamouse.net/pic/tvmusic.png",121],90:["Music - with Video Tutorial","http://www.myanonamouse.net/browse.php?subcat=0&cat=122&incldead=","http://www.myanonamouse.net/pic/tvmusic.png",122],91:["Instructional Videos Non-Music","http://www.myanonamouse.net/browse.php?subcat=0&cat=126&incldead=","http://www.myanonamouse.net/pic/tvmusic.png",126]};window.genreAssociations={Biographical:["Biograph","Leaders","Notable People","Rich & Famous","Memoir"],Business:["Business","Management","Economics","Econometrics","Job hunting","Careers"],"Computer/Internet":["Computer Science","Computers","Technology","programming","network programming","databases"],Crafts:["Origami","Paper folding","knitting","mache"],"Crime/Thriller":["thriller","suspense"],Fantasy:["sword.+?sorcery"],Food:["cooking","food","canning","recipe"],"General Fiction":["Fiction subjects","Speculative fiction","Poetry"],HistoricalFiction:["Historical Fiction","hysterical realism"],History:["Ancient","histories","vietnam","world war"],Humor:["humor"],Language:["Linguistics","semiotics","dictionar","thesaurus"],"Literary Classics":["Classics"],"Math/Science/Tech":["Quantum Physics","Science & Mathematics","Education & Reference","Engineering","Physics of","Basic sciences","Math"],Medical:["Medicine","Diagnosis","health science","health profession"],Mystery:["Mystery"],Philosophy:["Philosoph"],"Pol/Soc/Relig":["Social Sciences","Anthropology","Humanities","sociology","theology","religio","politic","spiritual"],Romance:["contemporary romance","other romance categories"],"Travel/Adventure":["travel"],"Science Fiction":["Science fiction","space opera"],"Urban Fantasy":["paranormal.+?romance"],"Young Adult":["teen"]};var featuresOld=readCookie("MAMFeatures");if(featuresOld)document.cookie="MAMFeatures=; expires=Fri, 31 Jan 2010 12:00:00 UTC; path=/";if(_getValue("Class",null))_deleteValue("uClass");if(_getValue("Staff",null))_deleteValue("Staff");if(_getValue("exInterval",null))_deleteValue("exInterval");if(typeof features.UHAddLinks=="undefined")features.UHAddLinks="true";if(typeof features.UHAddContents=="undefined")features.UHAddContents="true";if(typeof features.UHReplaceTitle=="undefined")features.UHReplaceTitle="true";if(typeof features.newsTicker=="undefined")features.newsTicker="true";if(window.top!==window.self){var sbCommentRows=document.getElementsByTagName("tr");var sbTimeStamp;var sbTime;var sbID;var sbBookmark;var sbSavedBm=_getValue("sbBm",null);for(i=0;i<sbCommentRows.length;i++){sbTimeStamp=sbCommentRows[i].firstElementChild.firstElementChild;sbTime=sbTimeStamp.firstElementChild.innerHTML;sbID=sbTimeStamp.parentNode.getElementsByTagName("a")[0].href.slice(-4);sbBookmark=sbTime+sbID;sbTimeStamp.style.cursor="pointer";sbTimeStamp.addEventListener("click",createToggleSbBookmark(sbTimeStamp,sbBookmark),false);if(sbSavedBm==sbBookmark)sbCommentRows[i].setAttribute("style","text-shadow: 0 0 .2em #ccc, 0 -1px .4em #ff3, 2px -2px .8em #fd3, -2px -4px 1.2em #f80, 2px -6px 2em #f20; background-color: C10000;")}if(features.contextMenu1||features.contextMenu2)contextMenus();eval("return")}var searchD=eval(_getValue("searchD",2));setuClass();startUpdateTorrList();window.isValidPage=true;window.tables=document.getElementsByTagName("table");try{window.navBarTrs=window.tables[1].getElementsByTagName("tr");window.userP=document.getElementById("bonusLink").parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;window.donations=window.userP.nextElementSibling;var tableHeads=document.getElementsByClassName("leftMenuHide");for(i=0;i<tableHeads.length;i++){tbtText=tableHeads[i].innerHTML;if(tbtText==="Admin")var adminBox=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="General")var general=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Torrents")var torrents=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Games")var games=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Personal")var personal=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Infos")var info=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Friends"){var friends=tableHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break}}var left=userP.parentNode;window.contentTable=tableHeads[tableHeads.length-1].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.nextSibling.nextSibling}catch(e){console.log(e);window.isValidPage=false}window.emulating=false;try{window.emulating=/^You are/.test(document.getElementsByClassName("coltable")[0].getElementsByTagName("a")[0].innerHTML)}catch(e){}if((features.contextMenu1||features.contextMenu2)&&window.isValidPage)contextMenus();if(features.banner>=0&&window.isValidPage){var banner=document.getElementsByTagName("a");if(banner[0].getAttribute("href")!="donatenew.php"&&banner[0].getAttribute("href")!="/")banner=banner[1];else banner=banner[0];if(features.banner==1){banner.setAttribute("href","/index.php")}else if(features.banner==2){banner.setAttribute("href","/forums.php")}else if(features.banner==3){banner.setAttribute("href","/browse.php")}else banner.setAttribute("href","/donatenew.php")}if(window.isValidPage)optionsLink();if(features.search&&window.isValidPage)searchBar();if(window.isValidPage)navBar();if(features.left&&window.isValidPage){left.insertBefore(torrents,general);left.insertBefore(personal,general);if(adminBox)left.insertBefore(adminBox,torrents);if(friends)friends.setAttribute("style","display: none");if(donations)donations.setAttribute("style","display: none")}if(features.emulate&&window.isValidPage)userLevel();if(features.bonus&&window.isValidPage)bonus();if(features.messages&&!/viewmailbox(&box=1)?$/i.test(url)&&window.isValidPage){var bolds=document.getElementsByTagName("b");var pmRegEx=/(\d+) new message/;var pmNote;for(i=0;i<bolds.length;i++){if(pmRegEx.test(bolds[i].innerHTML)){window.pmExit=document.createElement("img");pmExit.setAttribute("src",pmWaitSrc);pmExit.setAttribute("style","float:right;padding-left:7px;height:15 px;width:15px;cursor:pointer");pmExit.setAttribute("id","pmExit");bolds[i].setAttribute("style","padding-top:2px;");bolds[i].appendChild(pmExit);window.pmXMLDoc=document.createElement("html");openHTML("/jsonLoadPM.php?box=-9","displayPM()","window.jsonLoad");pmNote=bolds[i].parentNode.parentNode.parentNode.parentNode;pmNote.setAttribute("id","pmNote");break}}}if(/\/browse2?\.php/.test(url)){var images=contentTable.getElementsByTagName("img");var torrentTd;var torrentId;var uploaderID=0;var ddTd=[];var dupeTd=[];var ddImg=[];var idRegEx=/torrent=(.+)/;var browseHeadings=contentTable.getElementsByClassName("colhead");var paginationLinks=browseHeadings[2].parentNode.parentNode.parentNode.previousElementSibling;var dupeCheckDiv=document.createElement("div");dupeCheckDiv.id="dupeCheckDiv";dupeCheckDiv.innerHTML="Check the uploads on this page for dupes";dupeCheckDiv.setAttribute("style","font-size:1.3em; padding-top:3px; padding-bottom:7px; cursor:pointer; color:darkblue; text-decoration:underline; width: 22em;");dupeCheckDiv.addEventListener("click",checkPageForDupes,false);if(window.isStaff&&window.uClass>=62)paginationLinks.parentNode.insertBefore(dupeCheckDiv,paginationLinks);var ddHeadingTd=browseHeadings[2].cloneNode(true);ddHeadingTd.innerHTML="Get";var dupeHeadingTd=ddHeadingTd.cloneNode(true);dupeHeadingTd.innerHTML="Dupe Check";dupeHeadingTd.id="dupeHeadingTd";dupeHeadingTd.setAttribute("style","display:none; min-width:4.7em; text-align:center;");browseHeadings[0].parentNode.insertBefore(ddHeadingTd,browseHeadings[2]);browseHeadings[0].parentNode.insertBefore(dupeHeadingTd,ddHeadingTd);if(window.uClass>=62&&!window.emulating){var editHeading=browseHeadings[4].cloneNode(true);browseHeadings[3].parentNode.removeChild(browseHeadings[4]);browseHeadings[0].parentNode.appendChild(editHeading)}browseHeadings[window.uClass>=62?6:6].setAttribute("style","display:none");var rsBtn;var edBtn;var upTd;var edTd;var tURL;var oldDD;j=0;for(i=0;i<images.length;i++){if(images[i].getAttribute("title")==="Bookmark"){torrentId=idRegEx.exec(images[i].parentNode.getAttribute("href"))[1];torrentTd=images[i].parentNode.parentNode.parentNode;if(window.torrList[torrentId]){torrentTd.previousElementSibling.appendChild(prevDownloadedDiv(window.torrList[torrentId]))}ddTd[j]=document.createElement("td");ddTd[j].setAttribute("class","row2");ddImg[j]=document.createElement("img");try{oldDD=images[i].parentNode.nextElementSibling;tURL=oldDD.href;oldDD.parentNode.removeChild(oldDD)}catch(e){tURL="/download.php/"+torrentId+"/"+torrentId+".torrent"}ddImg[j].setAttribute("src",ddButtonSrc);ddImg[j].addEventListener("click",createDD(tURL,torrentTd),false);ddImg[j].setAttribute("style","height:20px;width:20px;cursor:pointer");ddTd[j].appendChild(ddImg[j]);torrentTd.parentNode.insertBefore(ddTd[j],torrentTd.nextSibling);images[i].parentNode.setAttribute("style","padding:2px; float: right; clear: both;");if(images[i].parentNode.previousElementSibling)images[i].parentNode.parentNode.removeChild(images[i].parentNode.previousElementSibling);if(window.uClass>=62&&!window.emulating){edTd=torrentTd.nextElementSibling.nextElementSibling.cloneNode(true);torrentTd.parentNode.removeChild(torrentTd.nextElementSibling.nextElementSibling);torrentTd.parentNode.appendChild(edTd);torrentTd.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.setAttribute("style","display:none;");dupeTd[j]=document.createElement("td");dupeTd[j].setAttribute("class","row2 dupeTd");dupeTd[j].id="dupeTd"+torrentId;dupeTd[j].setAttribute("title",torrentTd.getElementsByTagName("a")[0].title);dupeTd[j].setAttribute("cat",torrentTd.previousElementSibling.firstElementChild.firstElementChild.title.slice(0,2));dupeTd[j].setAttribute("torrId",torrentId);dupeTd[j].setAttribute("style","display:none; text-align:center;");torrentTd.parentNode.insertBefore(dupeTd[j],ddTd[j])}else{torrentTd.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.setAttribute("style","display:none;")}j++}else if(images[i].getAttribute("alt")==="vip"){images[i].nextElementSibling.setAttribute("style","display:none;")}}}if(/viewrequests/.test(url)&&window.uClass>=62){addReqDupeTds()}if(/\/details.php/.test(url)){var torrTitle=contentTable.getElementsByTagName("h1")[0];var torrId=/id=(\d+)/.exec(url)[1];var head=torrTitle.nextSibling.nextSibling.getElementsByTagName("table")[0];var contents=head.nextSibling.nextSibling;var cover=document.getElementById("posterImage");var detailsLinks=document.getElementById("download");var dlHistory=document.getElementById("DLhistory");var description=document.getElementById("smldesc");var type=document.getElementById("cat");var descr=document.getElementById("descr");var added=document.getElementById("Added");var snatched=document.getElementById("Snatched");var size=document.getElementById("size");var lastSeeder=document.getElementById("lastAct");var numFiles=document.getElementById("numFile");var fileList=document.getElementById("files");var peers=document.getElementById("peers");var visible=document.getElementById("visible");if(peers)numPeers=peers.innerHTML.slice(0,1);else numPeers=document.getElementById("seeds").firstElementChild.slice(0,1);var VIP=document.getElementById("VIP");var infohash=NFO=views=quality=ratings=Hits=bannedclient=banned=undefined;if(features.slim){head.setAttribute("style","visibility: hidden;");contents.setAttribute("style","margin-top:-45px;");cover.setAttribute("style","max-height:230px;max-width:300px; cursor: pointer;");cover.addEventListener("click",function(){if(this.style.maxHeight=="230px"){this.setAttribute("style","cursor: pointer;")}else this.setAttribute("style","max-height:230px;max-width:300px; cursor: pointer;")},false);if(infohash=document.getElementById("infohash"))infohash.parentNode.setAttribute("style","display:none;");if(NFO=document.getElementById("nfo"))NFO.parentNode.setAttribute("style","display:none;");if(views=document.getElementById("views"))views.parentNode.setAttribute("style","display:none;");if(quality=document.getElementById("quality"))quality.parentNode.setAttribute("style","display:none;");if(ratings=document.getElementById("ratings"))ratings.parentNode.setAttribute("style","display:none;");if(Hits=document.getElementById("Hits"))Hits.parentNode.setAttribute("style","display:none;");if(VIP)VIP.parentNode.setAttribute("style","display:none;");if(bannedclient=document.getElementById("bannedclient"))bannedclient.parentNode.setAttribute("style","display:none;");if(banned=document.getElementById("banned")){if(banned.innerHTML=="no")banned.parentNode.setAttribute("style","display:none;")}}if(window.torrList[torrId])detailsLinks.appendChild(prevDownloadedDiv(window.torrList[torrId]));if(features.torrMore){var searchString=contentTable.getElementsByTagName("h1")[0].firstChild.nodeValue;searchString=makeSearchString(searchString);searchString=encodeURIComponent(searchString);detailsLinks.innerHTML+='. See more book info: <a href="http://anonym.to/http://www.amazon.com/s?url=search-alias%3Daps&field-keywords='+searchString+"\" class='index'>Amazon</a>, <a href=\"http://anonym.to/http://www.fantasticfiction.co.uk/search/?searchfor=book&keywords="+searchString+"\" class='index'>Fantastic Fiction</a>, <a href=\"http://anonym.to/http://www.goodreads.com/search?query="+searchString+"\" class='index'>goodreads</a>, <a href=\"http://anonym.to/http://google.com/search?q="+searchString+"\" class='index'>Google</a> (<a href=\"http://anonym.to/http://google.com/search?btnI=1&q="+searchString+"\" class='index'>one-shot</a>).";if(description){description.innerHTML+=" -- <span style='font-weight:500;color:maroon;'>Torrent ID: <strong>"+torrId+"</strong></span>"}else detailsLinks.innerHTML+=" -- <span style='font-weight:500;color:maroon;'>Torrent ID: <strong>"+torrId+"</strong></span>"}if(numPeers==0||window.torrList[torrId]==1){var torrentLink=detailsLinks.getElementsByTagName("a")[0];var torrentURL=torrentLink.getAttribute("href");var newTorrentLink=document.createElement("span");newTorrentLink.setAttribute("style","font-weight:bold; color: rgb(68,85,136); cursor:pointer;");newTorrentLink.innerHTML="Torrent";newTorrentLink.addEventListener("click",function(){var e;if(numPeers==0)e=confirm("This torrent is currently dead (no seeders). Do you still want to download it?");else e=confirm("You are currently seeding this torrent. Do you still want to download it?");if(e==1)window.location.assign(torrentURL)},false);torrentLink.parentNode.replaceChild(newTorrentLink,torrentLink)}if(window.isStaff){var staffPicksList=_getValue("staffPicksList","");var staffPicksArray=[];if(staffPicksList)staffPicksArray=staffPicksList.split("#");var staffPickExists=true;if(staffPicksArray.indexOf(torrId)<0)staffPickExists=false;var addStaffPickBtn=document.createElement("input");addStaffPickBtn.type="button";addStaffPickBtn.value="Add to my Staff Picks list";addStaffPickBtn.setAttribute("style","margin-left:10px; display: none;");addStaffPickBtn.addEventListener("click",function(){addStaffPick(torrTitle.firstChild.nodeValue,torrId,type.innerHTML)},false);if(!staffPickExists)addStaffPickBtn.style.display="inline";var remStaffPickBtn=document.createElement("input");remStaffPickBtn.type="button";remStaffPickBtn.value="Remove from my Staff Picks list";remStaffPickBtn.setAttribute("style","margin-left:10px; display: none;");remStaffPickBtn.addEventListener("click",function(){remStaffPick(torrId,1)},false);if(staffPickExists)remStaffPickBtn.style.display="inline";var viewStaffPickBtn=document.createElement("input");viewStaffPickBtn.type="button";viewStaffPickBtn.value="View my Picks";viewStaffPickBtn.setAttribute("style","margin-left:10px; display:inline;");viewStaffPickBtn.addEventListener("click",function(){viewStaffPicks(torrId)},false);if(numPeers==0){var deadSpan=document.createElement("span");deadSpan.innerHTML="This torrent is dead.";deadSpan.setAttribute("style","font-weight:600; padding-left:10px;");added.appendChild(deadSpan)}else if(VIP){var VIPSpan=document.createElement("span");VIPSpan.innerHTML="This torrent is VIP.";VIPSpan.setAttribute("style","font-weight:600; padding-left:10px;");added.appendChild(VIPSpan)}else{added.appendChild(remStaffPickBtn);added.appendChild(addStaffPickBtn)}added.appendChild(viewStaffPickBtn);added.setAttribute("style","vertical-align:middle");var stamp=/>(\d+?)</.exec(descr.innerHTML.slice(-70));console.log("Stamp: "+stamp);if(stamp){var prevLeech=new Date(parseInt(stamp[1]));var diff=(now.getTime()-prevLeech)/(24*3600*1e3*7);var prevLeechSpan=document.createElement("span");prevLeechSpan.setAttribute("style","font-weight:600; padding-left:10px; color:black");if(diff<0)prevLeechSpan.innerHTML="This torrent is currently on Free Leech.";else if(diff<1)prevLeechSpan.innerHTML="This torrent was Free Leech last week.";else if(diff<3)prevLeechSpan.innerHTML="This torrent was Free Leech "+Math.round(diff)+" weeks ago.";else if(diff<7)prevLeechSpan.innerHTML="This torrent was Free Leech last month.";else if(diff<51)prevLeechSpan.innerHTML="This torrent was Free Leech "+Math.round(diff/4.3)+" months ago.";else prevLeechSpan.innerHTML="This torrent was last Free Leech more than a year ago.";console.log(now.getTime()+"   "+diff);if(diff<=3)prevLeechSpan.style.color="#cf0000";else if(diff<=7&&diff>3)prevLeechSpan.style.color="#CF5200";else if(diff<=14&&diff>7)prevLeechSpan.style.color="#936803";else if(diff<22)prevLeechSpan.style.color="#736701";else prevLeechSpan.style.color="darkgreen";added.appendChild(prevLeechSpan)}if(window.uClass>=62){if(/&filelist=1/.test(url)){if(/dupeCheck=1/.test(url)){fileList.firstElementChild.style.display="inline";var dupeListTableHTML="<table style='display:inline; maring-left:10px;' class='main' cellspacing='0' cellpadding='2' border='1'><tbody id='dupeListTBody' torrId='"+torrId+"'></tbody></table>";fileList.innerHTML+=dupeListTableHTML;searchForDupes2(dupeTerms(torrTitle.firstChild.nodeValue),"dupeListTBody",type.innerHTML.slice(0,2))}else{}added.innerHTML=added.innerHTML.replace(/((\d|-)+)/,"<span id='mainAdded' class='embiggen'>$1</span>");size.innerHTML=size.innerHTML.replace(/(\d.+?)\(/,"<span id='mainSize' class='embiggen'>$1</span> (");if(visible){lastSeeder.innerHTML=lastSeeder.innerHTML.replace(/(\d.+? )/,"<span id='mainLastSeeder' class='embiggen'>$1</span>")}var embiggenStyle="font-size:140%; font-weight:bold";document.getElementById("mainAdded").setAttribute("style",embiggenStyle);document.getElementById("mainSize").setAttribute("style",embiggenStyle);if(visible)document.getElementById("mainLastSeeder").setAttribute("style",embiggenStyle)}else numFiles.innerHTML+=" | <a style='font-weight:bold;' href='"+url.replace(/(id=\d+).*/,"$1")+"&filelist=1&dupeCheck=1#filelist"+"'>Check torrent for dupes</a>"}}}var reseedReqRegEx=/forums.php\?action=newtopic&forumid=29&id=(\d+)&t=(.*)/i;window.reseedReq=reseedReqRegEx.exec(url);if(reseedReq){fillReseed(0)}var userDetails=/userdetails.php.id=(\d+)/.exec(url);if(userDetails){id=userDetails[1];var giftSelect=document.createElement("select");giftSelect.id="giftSelect";var kOption20=document.createElement("option");kOption20.innerHTML="20 points";var kOption50=document.createElement("option");kOption50.innerHTML="50 points";var kOption100=document.createElement("option");kOption100.innerHTML="100 points";var kOption200=document.createElement("option");kOption200.innerHTML="200 points";kOption200.selected=true;var kOption500=document.createElement("option");kOption500.innerHTML="500 points";var kOption1k=document.createElement("option");kOption1k.innerHTML="1,000 points";giftSelect.appendChild(kOption20);giftSelect.appendChild(kOption50);giftSelect.appendChild(kOption100);giftSelect.appendChild(kOption200);giftSelect.appendChild(kOption500);giftSelect.appendChild(kOption1k);var giftSubmit=document.createElement("input");giftSubmit.id="giftSubmit";giftSubmit.style.marginLeft="5px";giftSubmit.type="button";giftSubmit.value="Gift Karma!";window.username=contentTable.getElementsByTagName("h1")[0].firstChild.textContent;giftSubmit.addEventListener("click",giftMore,false);var sendKarmaDiv=document.createElement("div");sendKarmaDiv.id="sendKarmaDiv";sendKarmaDiv.setAttribute("style","display:none; margin-top:6px;");sendKarmaDiv.appendChild(giftSelect);sendKarmaDiv.appendChild(giftSubmit);var sendP=contentTable.getElementsByTagName("p")[0];if(sendP.innerHTML.slice(-1)===")"){sendP.innerHTML=sendP.innerHTML+" - (<a href=\"javascript:void(0)\" onClick=\"var div = document.getElementById('sendKarmaDiv'); if (div.style.display == 'none') {div.style.display='block';} else {div.style.display='none';}\">Send some Karma</a>)"}var x="<input type='button' value='test' id='testbtn'></input>";document.getElementById("testbtn").addEventListener("click",function(){openHTML("userdetails.php?id=90457","foobar()",noXMLDoc)},false)}var snatchSummaryRegEx=new RegExp("/snatch_summary\\.php(.id="+uid+")?$");if(snatchSummaryRegEx.test(url)){}var mailboxRegRes;if(mailboxRegRes=/viewmailbox(.*)/.exec(url)){var jumpBox=document.getElementsByTagName("form");var pmButtons=contentTable.getElementsByTagName("input");pmButtons=pmButtons[pmButtons.length-3].parentNode;var inbox;jumpBox=jumpBox[jumpBox.length-1];var jumpBox2=jumpBox.cloneNode(true);jumpBox2.setAttribute("style","float:right; padding-bottom:5px;padding-top:-3px;");for(i=3;tableHeads.length;i++){if(tableHeads[i].getElementsByTagName("b")[0].innerHTML==="Inbox"||tableHeads[i].getElementsByTagName("b")[0].innerHTML==="Sentbox"){inbox=tableHeads[i].parentNode.parentNode.parentNode;break}}var pmButtonsDiv=pmButtons.cloneNode(true);pmButtonsDiv.setAttribute("style","float:left; margin-left: 10px; ");var expandPMsBtn=document.createElement("input");expandPMsBtn.id="expandPMsBtn";expandPMsBtn.type="button";expandPMsBtn.value="Expand Last 5 Days";expandPMsBtn.addEventListener("click",toggleExpandPMs,false);expandPMsBtn.setAttribute("style","margin-left: 30px;");if(mailboxRegRes[1]!="&box=-1")pmButtonsDiv.appendChild(expandPMsBtn);inbox.parentNode.insertBefore(pmButtonsDiv,inbox);inbox.parentNode.insertBefore(jumpBox2,inbox)}if(/\.net(:\d+)?\/?(index.php|#)?$/.test(url)&&features.home){var onlineRegEx=/Users Online/;var recentNewsRegEx=/Recent news/;var pollRegEx=/Poll/;var tbtHeads=document.getElementsByClassName("tbtbot");for(i=5;i<tbtHeads.length;i++){tbtText=tbtHeads[i].getElementsByTagName("b")[0].innerHTML;if(recentNewsRegEx.test(tbtText))var announcements=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(pollRegEx.test(tbtText))var poll=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtHeads[i].getElementsByTagName("a")[0])var shoutbox=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Last Forum Posts")var recPosts=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Last Torrents")var recTorrents=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(onlineRegEx.test(tbtText))var online=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if(tbtText==="Stats"){var stats=tbtHeads[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break}}var container=announcements.parentNode;var homePageCenterTags=document.getElementsByTagName("center");var homePageTimeStamp=homePageCenterTags[1];console.log(homePageTimeStamp);newMember=homePageCenterTags[2];container.insertBefore(newMember,announcements);container.insertBefore(shoutbox,announcements);container.insertBefore(recPosts,announcements);container.insertBefore(recTorrents,announcements);container.insertBefore(homePageTimeStamp,announcements);container.insertBefore(online,recTorrents)}if(/viewtopic/.test(url)){var postsTable=document.getElementsByTagName("h1")[0].nextSibling.nextSibling.nextSibling.nextSibling;postsTable.setAttribute("class","autopage");var title=contentTable.getElementsByTagName("h1")[0];if(/weekly free leech/i.test(title.innerHTML)&&window.isStaff){console.log(uid);if(window.uClass==100||uid==28091||uid==35348){var harvestBtn=document.createElement("input");harvestBtn.type="button";harvestBtn.value="Harvest Picks";harvestBtn.setAttribute("style","margin-left:15px; margin-bottom:4px; vertical-align:middle;");harvestBtn.addEventListener("click",harvestPicks,false);title.appendChild(harvestBtn)}var postPicksBtn=document.createElement("input");postPicksBtn.type="button";postPicksBtn.id="postPicksBtn";postPicksBtn.value="Post picks to thread";postPicksBtn.setAttribute("style","margin-left: 15px; margin-bottom:4px; vertical-align:middle;");postPicksBtn.addEventListener("click",postPicksToThread,false);title.appendChild(postPicksBtn)}}if(/mybonus.php$/.test(url)){window.abortExchange;window.exCounterCurr=0;var karmaHead=contentTable.getElementsByClassName("row1")[1];karmaHead.innerHTML=karmaHead.innerHTML.replace(/\s\[.+?\]\s/," ");var startExchangeBtn=document.createElement("input");startExchangeBtn.id="startExchangeBtn";startExchangeBtn.type="button";startExchangeBtn.value="Start Automated Exchange";startExchangeBtn.addEventListener("click",function(){autoExchangeDiv.style.display="inline";startExchangeBtn.style.display="none";window.abortExchange=false;var e=timestamp()+": Exchanger started.";window.exLog.value+=exLog.value?"\n"+e:e;getBonusPts(0,1)},false);var exSelect=document.createElement("select");exSelect.id="exSelect";exSelect.setAttribute("style","margin-top:5px;margin-right:5px;");var exOption1=document.createElement("option");var exOption2=document.createElement("option");var exOption3=document.createElement("option");var exOption4=document.createElement("option");exOption1.innerHTML="0pts";exOption2.innerHTML="500pts";exOption2.selected="selected";exOption3.innerHTML="1,000pts";exOption4.innerHTML="5,000pts";exSelect.appendChild(exOption1);exSelect.appendChild(exOption2);exSelect.appendChild(exOption3);exSelect.appendChild(exOption4);var karmaDiv=document.createElement("div");karmaDiv.setAttribute("style","float:right; margin-top:-5em; text-align:right;");karmaDiv.appendChild(startExchangeBtn);var br1=document.createElement("br");karmaDiv.appendChild(br1);var leaveTxt=document.createElement("span");leaveTxt.innerHTML="Leave me ";karmaDiv.appendChild(leaveTxt);karmaDiv.appendChild(exSelect);karmaHead.appendChild(karmaDiv);var autoExchangeDiv=document.createElement("div");autoExchangeDiv.style.display="none";autoExchangeDiv.id="autoExchangeDiv";window.exStatus=document.createElement("span");window.exStatus.id="exStatus";window.exStatus.setAttribute("style","font-size:13px;");window.exStatus.innerHTML="Checking bonus points...";var exTimer=document.createElement("span");exTimer.id="exTimer";exTimer.setAttribute("style","font-weight:600; font-size:12px; margin-top:8px; display:block;");window.timeSpan=document.createElement("span");window.timeSpan.innerHTML="--:--";exTimer.appendChild(timeSpan);var autoExchangeCancel=document.createElement("input");autoExchangeCancel.setAttribute("style","margin-top:10px; margin-bottom:5px;");autoExchangeCancel.value="Stop Exchanging";autoExchangeCancel.type="button";autoExchangeCancel.id="exCancel";autoExchangeCancel.addEventListener("click",function(){window.abortExchange=true;window.exCounter.innerHTML="0";var e=timestamp()+": Exchanger halted.";window.exLog.value+=exLog.value?"\n"+e:e;window.timeSpan.innerHTML="--:--";startExchangeBtn.style.display="inline";autoExchangeDiv.style.display="none";getBonusPts(0)},false);window.exCounter=document.createElement("span");window.exCounter.id="exCounter";window.exCounter.setAttribute("style","font-size: 11px; color:blue; cursor:pointer;");window.exCounter.innerHTML="0";window.exCounter.setAttribute("onClick","var exLog = document.getElementById('exLog'); if (exLog.style.display == 'none') exLog.style.display = 'block'; else exLog.style.display = 'none';");window.exLog=document.createElement("textarea");window.exLog.id="exLog";window.exLog.setAttribute("style","width: 32em; height: 50px; line-height:12px; font-size:10px; overflow:auto; display: none; padding:2px;");autoExchangeDiv.appendChild(exStatus);var br2=document.createElement("br");autoExchangeDiv.appendChild(br2);autoExchangeDiv.appendChild(exTimer);autoExchangeDiv.appendChild(autoExchangeCancel);var br3=document.createElement("br");autoExchangeDiv.appendChild(br3);var tot=document.createElement("span");tot.innerHTML=" Exchanged since start: ";autoExchangeDiv.appendChild(tot);autoExchangeDiv.appendChild(exCounter);var pt=document.createElement("span");pt.innerHTML=" pts<br />";autoExchangeDiv.appendChild(pt);autoExchangeDiv.appendChild(exLog);contentTable.insertBefore(autoExchangeDiv,contentTable.firstChild.nextSibling)}var editPageRegEx=/\/(edit[^r].+?id=\d{2,}(&r|$)|upload)/;window.editPage=editPageRegEx.exec(url);if(window.editPage){iFrameChecker("fixUploadIFrame(); setupDescr()");var uploadInputs=contentTable.getElementsByTagName("input");if(window.editPage[1]=="upload"){var fileInput=uploadInputs[1];window.titleInput=uploadInputs[2];window.posterInput=uploadInputs[3];descriptionInputOrig=uploadInputs[5]}else if(window.editPage[2]){window.titleInput=uploadInputs[2];window.posterInput=uploadInputs[4];descriptionInputOrig=uploadInputs[3]}else{if(/returnto/.test(url)){window.titleInput=uploadInputs[2];window.posterInput=uploadInputs[4];descriptionInputOrig=uploadInputs[3]}else{window.titleInput=uploadInputs[1];window.posterInput=uploadInputs[3];descriptionInputOrig=uploadInputs[2]}}window.uploadHelperBtn=document.createElement("button");uploadHelperBtn.id="uploadHelperBtn";uploadHelperBtn.type="button";uploadHelperBtn.innerHTML="Search for meta-data";uploadHelperBtn.setAttribute("style","margin-left: 7px; background:blue; border-radius:3px; border:solid black 2px; color: white; font-size:small;");uploadHelperBtn.addEventListener("click",uploadHelper,false);var titleTd=window.titleInput.parentNode;if(fileInput){titleTd.removeChild(window.titleInput.nextSibling);titleTd.removeChild(window.titleInput.nextSibling);titleTd.removeChild(window.titleInput.nextSibling);titleTd.removeChild(window.titleInput.nextSibling)}titleTd.appendChild(uploadHelperBtn);if(window.editPage[2]!="upload"){var oldTitleDiv=document.createElement("div");oldTitleDiv.style.display="block";var oldTitleSpan=document.createElement("span");oldTitleSpan.innerHTML=window.titleInput.value;oldTitleSpan.setAttribute("style","text-decoration:underline;color:blue;display:none;cursor:pointer;");oldTitleSpan.id="oldTitleSpan";oldTitleSpan.addEventListener("click",function(){window.titleInput.value=this.innerHTML;this.style.display="none"},false);oldTitleDiv.appendChild(oldTitleSpan);titleTd.appendChild(oldTitleDiv);window.titleInput.addEventListener("keyup",function(){var e=document.getElementById("oldTitleSpan");if(this.value==e.innerHTML)e.style.display="none";else e.style.display="inline-block"},false)}if(fileInput)fileInput.addEventListener("change",function(){var e=/([^\\]+).torrent$/;try{var t=e.exec(this.value)[1];window.titleInput.style.color="black";var n=new RegExp("\\W("+window.ebookFormats+")\\W?","ig");fileNameRegRes=t.match(n);console.log(fileNameRegRes);if(fileNameRegRes){for(i=0;i<fileNameRegRes.length;i++){fileNameRegRes[i]=fileNameRegRes[i].replace(/\W/ig,"")}window.userDefFileTypes=fileNameRegRes;console.log(window.userDefFileTypes)}t=t.replace(n,"");t=t.replace(/(\(v.{0,2}\d.*?\))|(v.{0,2}\d.?\d)/,"");t=t.replace(/\s{2,}|\.|_/g," ");t=t.replace(/\s{2,}/g," ");t=t.replace(/^\s+|\s+$/g,"");window.titleInput.value=t;readTorrent(fileInput)}catch(r){console.log(r);alert("Please upload a .torrent file.");fileInput.type="input";fileInput.type="file";return}},false);if(fileInput){window.titleInput.style.color="#777";window.nameInit="Extract search terms from .torrent above, or type your own.";if(window.titleInput.value=="")window.titleInput.value=window.nameInit;window.titleInput.addEventListener("click",function(){if(this.value==window.nameInit){this.value="";this.style.color="black"}},false);window.titleInput.addEventListener("blur",function(){if(this.value==""){this.value=window.nameInit;this.style.color="#777"}},false);window.titleInput.addEventListener("change",function(){if(this.value!==window.nameInit){this.style.color="black"}},false)}window.titleInput.addEventListener("keydown",function(e){this.form.setAttribute("onsubmit","return false");if(e.keyCode==13){uploadHelper()}},false);window.titleInput.addEventListener("blur",function(){this.form.setAttribute("onsubmit","")},false);window.UHSearchResults=[];window.titlePicks=[];window.oldTitlePicks=[];window.titleResultsDiv=document.createElement("div");window.titleInst=document.createElement("span");titleInst.id="titleInst";titleTd.appendChild(titleInst);titleTd.appendChild(window.titleResultsDiv);var posterTd=window.posterInput.parentNode;var postersDiv=document.createElement("div");postersDiv.setAttribute("style","padding-bottom:3px;");var GRPosterDiv=document.createElement("div");GRPosterDiv.style.display="inline-block";var FFPosterDiv=document.createElement("div");FFPosterDiv.style.display="inline-block";var AmzPosterDiv=document.createElement("div");AmzPosterDiv.style.display="inline-block";var WikiPosterDiv=document.createElement("div");WikiPosterDiv.style.display="inline-block";var BNPosterDiv=document.createElement("div");BNPosterDiv.style.display="inline-block";var SMPPosterDiv=document.createElement("div");SMPPosterDiv.style.display="inline-block";var AdblPosterDiv=document.createElement("div");AdblPosterDiv.style.display="inline-block";var userPosterDiv=document.createElement("div");userPosterDiv.style.display="inline-block";window.posterImgAmz=document.createElement("img");window.posterImgAmz.style.height="0px";window.posterImgGR=document.createElement("img");window.posterImgGR.style.height="0px";window.posterImgFF=document.createElement("img");window.posterImgFF.style.height="0px";window.posterImgWiki=document.createElement("img");window.posterImgWiki.style.height="0px";window.posterImgBN=document.createElement("img");window.posterImgBN.style.height="0px";window.posterImgSMP=document.createElement("img");window.posterImgSMP.style.height="0px";window.posterImgAdbl=document.createElement("img");window.posterImgAdbl.style.height="0px";window.posterImgUser=document.createElement("img");window.posterImgUser.style.height="0px";window.posterImgAmzDim=document.createElement("span");window.posterImgGRDim=document.createElement("span");window.posterImgFFDim=document.createElement("span");window.posterImgWikiDim=document.createElement("span");window.posterImgBNDim=document.createElement("span");window.posterImgSMPDim=document.createElement("span");window.posterImgAdblDim=document.createElement("span");window.posterImgUserDim=document.createElement("span");AmzPosterDiv.appendChild(window.posterImgAmzDim);AmzPosterDiv.appendChild(window.posterImgAmz);GRPosterDiv.appendChild(window.posterImgGRDim);GRPosterDiv.appendChild(window.posterImgGR);FFPosterDiv.appendChild(window.posterImgFFDim);FFPosterDiv.appendChild(window.posterImgFF);WikiPosterDiv.appendChild(window.posterImgWikiDim);WikiPosterDiv.appendChild(window.posterImgWiki);BNPosterDiv.appendChild(window.posterImgBNDim);BNPosterDiv.appendChild(window.posterImgBN);SMPPosterDiv.appendChild(window.posterImgSMPDim);SMPPosterDiv.appendChild(window.posterImgSMP);AdblPosterDiv.appendChild(window.posterImgAdblDim);AdblPosterDiv.appendChild(window.posterImgAdbl);userPosterDiv.appendChild(window.posterImgUserDim);userPosterDiv.appendChild(window.posterImgUser);postersDiv.appendChild(AmzPosterDiv);postersDiv.appendChild(GRPosterDiv);postersDiv.appendChild(FFPosterDiv);postersDiv.appendChild(WikiPosterDiv);postersDiv.appendChild(BNPosterDiv);postersDiv.appendChild(SMPPosterDiv);postersDiv.appendChild(AdblPosterDiv);postersDiv.appendChild(userPosterDiv);posterTd.insertBefore(postersDiv,posterTd.firstChild);if(window.editPage[1]!="upload")loadPoster(window.posterImgUser,window.posterImgUserDim,window.posterInput.value);window.descriptionTd=document.createElement("td");window.descriptionTd.setAttribute("class","row1");window.descriptionTd.vAlign="top";window.descriptionTd.align="left";var descriptionsDiv=document.createElement("div");descriptionsDiv.setAttribute("style","margin-top: 4px;");window.descriptionsSwitchSpan=document.createElement("span");window.descriptionsSwitchSpan.style.display="none";descriptionsSwitchSpan.innerHTML="Others: ";window.AmzDescriptionDiv=document.createElement("div");window.AmzDescriptionDiv.addEventListener("click",function(){placeDescription(window.AmzDescriptionDiv,true)},false);window.AmzDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");window.GRDescriptionDiv=document.createElement("div");window.GRDescriptionDiv.addEventListener("click",function(){placeDescription(window.GRDescriptionDiv,true)},false);window.GRDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");window.FFDescriptionDiv=document.createElement("div");window.FFDescriptionDiv.addEventListener("click",function(){placeDescription(window.FFDescriptionDiv,true)},false);window.FFDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");window.WikiDescriptionDiv=document.createElement("div");window.WikiDescriptionDiv.addEventListener("click",function(){placeDescription(window.WikiDescriptionDiv,true)},false);window.WikiDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");window.BNDescriptionDiv=document.createElement("div");window.BNDescriptionDiv.addEventListener("click",function(){placeDescription(window.BNDescriptionDiv,true)},false);window.BNDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");window.SMPDescriptionDiv=document.createElement("div");window.SMPDescriptionDiv.addEventListener("click",function(){placeDescription(window.SMPDescriptionDiv,true)},false);window.SMPDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");window.AdblDescriptionDiv=document.createElement("div");window.AdblDescriptionDiv.addEventListener("click",function(){placeDescription(window.AdblDescriptionDiv,true)},false);window.AdblDescriptionDiv.setAttribute("style","margin-right:1em; cursor: pointer; color: darkblue; text-decoration: underline; display: none;");descriptionsDiv.appendChild(window.descriptionsSwitchSpan);descriptionsDiv.appendChild(window.AmzDescriptionDiv);descriptionsDiv.appendChild(window.GRDescriptionDiv);descriptionsDiv.appendChild(window.FFDescriptionDiv);descriptionsDiv.appendChild(window.WikiDescriptionDiv);descriptionsDiv.appendChild(window.BNDescriptionDiv);descriptionsDiv.appendChild(window.SMPDescriptionDiv);descriptionsDiv.appendChild(AdblDescriptionDiv);window.descriptionInput=descriptionInputOrig.cloneNode(true);window.descriptionInput.addEventListener("keyup",function(){placeDescription(false)},false);window.descriptionTd.appendChild(window.descriptionInput);window.descriptionTd.appendChild(descriptionsDiv);window.descrBody=[[],[],[],[]];window.typeSelect=window.titleInput.form.getElementsByTagName("select")[0];var typeTd=window.typeSelect.parentNode;var genresDiv=document.createElement("div");genresDiv.setAttribute("style","display:inline; margin-left:.5em; color: darkred; font-weight: bold;");window.genreA=document.createElement("span");window.genreA.setAttribute("style","margin-right:1em;");window.genreB=document.createElement("span");window.genreB.setAttribute("style","margin-right:1em;");window.genreC=document.createElement("span");window.genreC.setAttribute("style","margin-right:1em;");genresDiv.appendChild(window.genreA);genresDiv.appendChild(window.genreB);genresDiv.appendChild(window.genreC);typeTd.appendChild(genresDiv);var dupeTd=contentTable.getElementsByClassName("btn")[0].parentNode;if(dupeTd){var dupeDiv=document.createElement("div");dupeDiv.setAttribute("style","display:inline; color: red; font-weight:bold; margin-left: 1em;");dupeDiv.id="dupeDiv";var reqDiv=document.createElement("div");reqDiv.setAttribute("style","display:block; color: black; font-weight:bold; margin-top:4px;");reqDiv.id="reqDiv";dupeTd.appendChild(dupeDiv);dupeTd.appendChild(reqDiv)}if(window.editPage[1]=="upload"){var genreSelect=typeTd.firstElementChild;genreSelect.addEventListener("change",function(){if(!dupeDiv.getAttribute("searched")&&window.titleInput.value!=window.nameInit&&window.titleInput.value.length>3){searchForDupes2(dupeTerms(window.titleInput.value),"dupeDiv",this.options[this.selectedIndex].innerHTML.slice(0,2));searchForRDupes2(dupeTerms(window.titleInput.value),"reqDiv",this.options[this.selectedIndex].innerHTML.slice(0,2))}},false)}var doItBtn=contentTable.querySelector(".btn");doItBtn.addEventListener("click",function(){if(document.activeElement==window.titleInput)return;this.form.setAttribute("onsubmit","return false");var e=true;if(window.bannedAuthorsRegEx.test(window.titleInput.value)){e=confirm("Please double check that you are not uploading a banned author!\nSee our rules.\n\nContinue anyways?");if(!e)return}if(window.eroticaAuthorsRegEx.test(window.titleInput.value)||/erotic|porn|bdsm|menage/i.test(window.genreA.innerHTML+" "+window.genreB.innerHTML+" "+window.genreC.innerHTML)){e=confirm("Please double check that you are not uploading an erotic or pornographic work!\n\nContinue anyways?");if(!e)return}if(window.posterInput.value==""&&titleInst.style.display!="none"){e=confirm("You have not selected a poster! Continue?");if(!e)return}if(window.fileTypes){var t=window.titleInput.form.getElementsByTagName("select")[0];var n=t.selectedIndex;if(n==0){alert("Pick a category.");return}else if(n>1&&n<=37){if(!window.fileTypes.audio||window.fileTypes.ebook>2*window.fileTypes.audio+3){var e=confirm("This doesn't seem like an audiobook to me... Continue?")}else if(window.fileTypes.video){var e=confirm("You've selected Audiobook and this torrent has a video in it. Continue?")}else if(window.userDefFileTypes){if(!window.fileTypes.audio)var e=confirm("You've selected Audiobook but your .torrent tile has "+window.userDefFileTypes.join(" and ")+"in it... nor are there audiofiles. \nContinue?");else var e=confirm("I suppose this could be an audiobook, but why did you label it with"+window.userDefFileTypes.join(" and ")+"?\n Continue?")}}else if(n==39){if(!window.fileTypes.video){var e=confirm("Please double-check the allowed video formats. Continue?")}}else if(n>=40&&n<=78){if(!window.fileTypes.ebook){var e=confirm("There's no ebook files in this torrent. Continue?")}else if(window.fileTypes.audio){if(window.descrAdblBtn.style.fontWeight=="bold")var e=confirm("This torrent contains "+window.fileTypes.audio+" audio files. Sure this is an e-book? I mean, you're also pulling in from Audible.com!");else var e=confirm("This torrent contains "+window.fileTypes.audio+" audio files. Sure this is an e-book?")}else if(window.fileTypes.video){var e=confirm("You've selected ebook and this torrent has a video in it. Continue?")}else if(window.descrAdblBtn.style.fontWeight=="bold"){var e=confirm("You sure you want to pull info from Audible.com for an ebook?")}}else if(n==81||n==86||n==88){if(!window.fileTypes.audio){var e=confirm("You selected a category that requires audio files but none are in this torrent. Continue?")}else if(window.fileTypes.video){var e=confirm("You've selected a category that shouldn't have video files but this torrent has "+window.fileTypes.video+". Continue?")}}else if(n==80||n==85||n==87){if(window.fileTypes.audio){var e=confirm("This torrent has "+window.fileTypes.audio+" audio files. Generally torrents in this category don't get audio files. Continue?")}else if(window.fileTypes.video){var e=confirm("You've selected a category that shouldn't have video files but this torrent has "+window.fileTypes.video+". Continue?")}}else if(n==89){if(!window.fileTypes.video&&!window.fileTypes.audio){var e=confirm("This torrent contains no audio or video files which doesn't jibe with with this category. Continue?")}}console.log(e);if(!e)return}document.getElementById("descr").innerHTML=window.descrBodyTag.innerHTML;this.form.setAttribute("onsubmit","");this.form.submit()},false);var indiDupeCheckerLink=document.createElement("a");indiDupeCheckerLink.innerHTML="Check multiple titles at once to see if they're already on the site.";indiDupeCheckerLink.href="dupechecker.gm";indiDupeCheckerLink.target="_blank";doItBtn.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(indiDupeCheckerLink)}if(/[^F](my|user)torrents/.test(url))reDdFromUploads();var snatchesTest=/id=(\d+)/.exec(url);if(/(snatched|dormant).detail/.test(url)&&(!snatchesTest||snatchesTest&&snatchesTest[1]&&snatchesTest[1]==uid))fixSnatchesButtons();if(/reqdetails/.test(url)){var searchString=contentTable.getElementsByTagName("h1")[0].innerHTML.split("Details Of ")[1];window.row1s=contentTable.querySelectorAll(".row1");if(window.isStaff){window.reqUser=window.row1s[window.row1s.length-3].innerHTML;var reqUserA=document.createElement("a");reqUserA.href="/n_a/userQuickSearch.php?SEARCH="+window.reqUser;reqUserA.innerHTML=window.reqUser;window.row1s[window.row1s.length-3].innerHTML="";window.row1s[window.row1s.length-3].appendChild(reqUserA);var reqUserAllReqsA=document.createElement("a");reqUserAllReqsA.href="javascript:void(0);";reqUserAllReqsA.id="reqUserAllReqsA";reqUserAllReqsA.innerHTML="See all requests from "+window.reqUser;reqUserAllReqsA.setAttribute("style","border-left:1px solid black; padding-left:1em; margin-left:1em;");reqUserAllReqsA.addEventListener("click",allReqsLink,false)}var reqDupeDiv=document.createElement("div");reqDupeDiv.setAttribute("style","display:inline-block; padding-left:.5em; padding-top:2px; font-weight:bold; color:red;");reqDupeDiv.id="reqDupeDiv";var fillReqBtn=contentTable.getElementsByTagName("input")[2];fillReqBtn.parentNode.insertBefore(reqDupeDiv,fillReqBtn.nextElementSibling);searchForDupes2(dupeTerms(searchString),"reqDupeDiv",window.row1s[3].innerHTML.slice(0,2))}if(/requests.php/.test(url)){var reqDupeDiv=document.createElement("div");reqDupeDiv.setAttribute("style","display:inline-block; padding-left:.5em; padding-top:2px; font-weight:bold; color:red;");reqDupeDiv.id="reqDupeDiv";var reqTop=contentTable.getElementsByTagName("input")[2];reqTop.parentNode.appendChild(reqDupeDiv);var reqDupeDiv2=document.createElement("div");reqDupeDiv2.setAttribute("style","display:inline-block; padding-left:.5em; padding-top:2px; font-weight:bold; color:red;");reqDupeDiv2.id="reqDupeDiv2";var reqSubmit=contentTable.getElementsByTagName("input")[4];reqSubmit.parentNode.appendChild(reqDupeDiv2);var requestTitleInput=contentTable.getElementsByTagName("input")[3];requestTitleInput.addEventListener("blur",function(){if(this.value){searchForDupes2(dupeTerms(this.value),"reqDupeDiv");searchForRDupes2(dupeTerms(this.value),"reqDupeDiv2")}else{if(reqDupeDiv.innerHTML){reqDupeDiv.innerHTML="";reqDupeDiv2.innerHTML=""}}},false)}if(/log.php/.test(url)&&window.isStaff){adjLog()}if(/(staff|fls)box.php\?action=answermessage/.test(url)&&window.isStaff){var sbSubj=contentTable.getElementsByTagName("h2")[0];console.log(sbSubj);sbSubj.innerHTML=sbSubj.innerHTML.replace(/by\s*<i>(\w+)<\/i>/,"by <a style='color:black; text-decoration:none; font-style:italic;' href='/n_a/userQuickSearch.php?SEARCH=$1'>$1</a>")}var undelIdRegRes=/det-deleted.php\?id=(\d+)/.exec(url);if(undelIdRegRes){undelBtn(undelIdRegRes[1])}if(/sendmessage\.php/.test(url))missingSubjAlert();if(/\/dupechecker\.gm$/i.test(url))indiDupeChecker()